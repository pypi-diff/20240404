# Comparing `tmp/mlrun-1.7.0rc6-py3-none-any.whl.zip` & `tmp/mlrun-1.7.0rc7-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,328 +1,332 @@
-Zip file size: 1050959 bytes, number of entries: 326
--rw-r--r--  2.0 unx     7248 b- defN 24-Mar-20 16:47 mlrun/__init__.py
--rw-r--r--  2.0 unx    49229 b- defN 24-Mar-20 16:47 mlrun/__main__.py
--rw-r--r--  2.0 unx    62775 b- defN 24-Mar-20 16:47 mlrun/config.py
--rw-r--r--  2.0 unx     7080 b- defN 24-Mar-20 16:47 mlrun/errors.py
--rw-r--r--  2.0 unx    40866 b- defN 24-Mar-20 16:47 mlrun/execution.py
--rw-r--r--  2.0 unx    15569 b- defN 24-Mar-20 16:47 mlrun/features.py
--rw-r--r--  2.0 unx     7023 b- defN 24-Mar-20 16:47 mlrun/k8s_utils.py
--rw-r--r--  2.0 unx    30481 b- defN 24-Mar-20 16:47 mlrun/kfpops.py
--rw-r--r--  2.0 unx     8286 b- defN 24-Mar-20 16:47 mlrun/lists.py
--rw-r--r--  2.0 unx    70583 b- defN 24-Mar-20 16:47 mlrun/model.py
--rw-r--r--  2.0 unx    13009 b- defN 24-Mar-20 16:47 mlrun/render.py
--rw-r--r--  2.0 unx    42822 b- defN 24-Mar-20 16:47 mlrun/run.py
--rw-r--r--  2.0 unx     7776 b- defN 24-Mar-20 16:47 mlrun/secrets.py
--rw-r--r--  2.0 unx    14211 b- defN 24-Mar-20 16:47 mlrun/api/schemas/__init__.py
--rw-r--r--  2.0 unx     1187 b- defN 24-Mar-20 16:47 mlrun/artifacts/__init__.py
--rw-r--r--  2.0 unx    34978 b- defN 24-Mar-20 16:47 mlrun/artifacts/base.py
--rw-r--r--  2.0 unx    22360 b- defN 24-Mar-20 16:47 mlrun/artifacts/dataset.py
--rw-r--r--  2.0 unx    14425 b- defN 24-Mar-20 16:47 mlrun/artifacts/manager.py
--rw-r--r--  2.0 unx    25205 b- defN 24-Mar-20 16:47 mlrun/artifacts/model.py
--rw-r--r--  2.0 unx    15860 b- defN 24-Mar-20 16:47 mlrun/artifacts/plots.py
--rw-r--r--  2.0 unx      571 b- defN 24-Mar-20 16:47 mlrun/common/__init__.py
--rw-r--r--  2.0 unx      745 b- defN 24-Mar-20 16:47 mlrun/common/constants.py
--rw-r--r--  2.0 unx     1087 b- defN 24-Mar-20 16:47 mlrun/common/helpers.py
--rw-r--r--  2.0 unx     5181 b- defN 24-Mar-20 16:47 mlrun/common/secrets.py
--rw-r--r--  2.0 unx      790 b- defN 24-Mar-20 16:47 mlrun/common/types.py
--rw-r--r--  2.0 unx      571 b- defN 24-Mar-20 16:47 mlrun/common/db/__init__.py
--rw-r--r--  2.0 unx     2659 b- defN 24-Mar-20 16:47 mlrun/common/db/sql_session.py
--rw-r--r--  2.0 unx      721 b- defN 24-Mar-20 16:47 mlrun/common/model_monitoring/__init__.py
--rw-r--r--  2.0 unx     4405 b- defN 24-Mar-20 16:47 mlrun/common/model_monitoring/helpers.py
--rw-r--r--  2.0 unx     4935 b- defN 24-Mar-20 16:47 mlrun/common/schemas/__init__.py
--rw-r--r--  2.0 unx     2344 b- defN 24-Mar-20 16:47 mlrun/common/schemas/api_gateway.py
--rw-r--r--  2.0 unx     2796 b- defN 24-Mar-20 16:47 mlrun/common/schemas/artifact.py
--rw-r--r--  2.0 unx     5970 b- defN 24-Mar-20 16:47 mlrun/common/schemas/auth.py
--rw-r--r--  2.0 unx     1707 b- defN 24-Mar-20 16:47 mlrun/common/schemas/background_task.py
--rw-r--r--  2.0 unx     2858 b- defN 24-Mar-20 16:47 mlrun/common/schemas/client_spec.py
--rw-r--r--  2.0 unx      888 b- defN 24-Mar-20 16:47 mlrun/common/schemas/clusterization_spec.py
--rw-r--r--  2.0 unx     1557 b- defN 24-Mar-20 16:47 mlrun/common/schemas/common.py
--rw-r--r--  2.0 unx     6476 b- defN 24-Mar-20 16:47 mlrun/common/schemas/constants.py
--rw-r--r--  2.0 unx      750 b- defN 24-Mar-20 16:47 mlrun/common/schemas/datastore_profile.py
--rw-r--r--  2.0 unx     1026 b- defN 24-Mar-20 16:47 mlrun/common/schemas/events.py
--rw-r--r--  2.0 unx     3717 b- defN 24-Mar-20 16:47 mlrun/common/schemas/feature_store.py
--rw-r--r--  2.0 unx     2418 b- defN 24-Mar-20 16:47 mlrun/common/schemas/frontend_spec.py
--rw-r--r--  2.0 unx     4577 b- defN 24-Mar-20 16:47 mlrun/common/schemas/function.py
--rw-r--r--  2.0 unx      705 b- defN 24-Mar-20 16:47 mlrun/common/schemas/http.py
--rw-r--r--  2.0 unx     4203 b- defN 24-Mar-20 16:47 mlrun/common/schemas/hub.py
--rw-r--r--  2.0 unx     1395 b- defN 24-Mar-20 16:47 mlrun/common/schemas/k8s.py
--rw-r--r--  2.0 unx      892 b- defN 24-Mar-20 16:47 mlrun/common/schemas/memory_reports.py
--rw-r--r--  2.0 unx     1768 b- defN 24-Mar-20 16:47 mlrun/common/schemas/notification.py
--rw-r--r--  2.0 unx     1980 b- defN 24-Mar-20 16:47 mlrun/common/schemas/object.py
--rw-r--r--  2.0 unx     1177 b- defN 24-Mar-20 16:47 mlrun/common/schemas/pipeline.py
--rw-r--r--  2.0 unx     4277 b- defN 24-Mar-20 16:47 mlrun/common/schemas/project.py
--rw-r--r--  2.0 unx      776 b- defN 24-Mar-20 16:47 mlrun/common/schemas/regex.py
--rw-r--r--  2.0 unx      745 b- defN 24-Mar-20 16:47 mlrun/common/schemas/runs.py
--rw-r--r--  2.0 unx     1554 b- defN 24-Mar-20 16:47 mlrun/common/schemas/runtime_resource.py
--rw-r--r--  2.0 unx     4287 b- defN 24-Mar-20 16:47 mlrun/common/schemas/schedule.py
--rw-r--r--  2.0 unx     1484 b- defN 24-Mar-20 16:47 mlrun/common/schemas/secret.py
--rw-r--r--  2.0 unx      884 b- defN 24-Mar-20 16:47 mlrun/common/schemas/tag.py
--rw-r--r--  2.0 unx     1823 b- defN 24-Mar-20 16:47 mlrun/common/schemas/workflow.py
--rw-r--r--  2.0 unx     1415 b- defN 24-Mar-20 16:47 mlrun/common/schemas/model_monitoring/__init__.py
--rw-r--r--  2.0 unx     7822 b- defN 24-Mar-20 16:47 mlrun/common/schemas/model_monitoring/constants.py
--rw-r--r--  2.0 unx     1431 b- defN 24-Mar-20 16:47 mlrun/common/schemas/model_monitoring/grafana.py
--rw-r--r--  2.0 unx    12000 b- defN 24-Mar-20 16:47 mlrun/common/schemas/model_monitoring/model_endpoints.py
--rw-r--r--  2.0 unx     1087 b- defN 24-Mar-20 16:47 mlrun/data_types/__init__.py
--rw-r--r--  2.0 unx     4647 b- defN 24-Mar-20 16:47 mlrun/data_types/data_types.py
--rw-r--r--  2.0 unx     6134 b- defN 24-Mar-20 16:47 mlrun/data_types/infer.py
--rw-r--r--  2.0 unx     9457 b- defN 24-Mar-20 16:47 mlrun/data_types/spark.py
--rw-r--r--  2.0 unx     9945 b- defN 24-Mar-20 16:47 mlrun/data_types/to_pandas.py
--rw-r--r--  2.0 unx     4118 b- defN 24-Mar-20 16:47 mlrun/datastore/__init__.py
--rw-r--r--  2.0 unx     9168 b- defN 24-Mar-20 16:47 mlrun/datastore/azure_blob.py
--rw-r--r--  2.0 unx    24175 b- defN 24-Mar-20 16:47 mlrun/datastore/base.py
--rw-r--r--  2.0 unx     9018 b- defN 24-Mar-20 16:47 mlrun/datastore/datastore.py
--rw-r--r--  2.0 unx    15985 b- defN 24-Mar-20 16:47 mlrun/datastore/datastore_profile.py
--rw-r--r--  2.0 unx     6634 b- defN 24-Mar-20 16:47 mlrun/datastore/dbfs_store.py
--rw-r--r--  2.0 unx     3767 b- defN 24-Mar-20 16:47 mlrun/datastore/filestore.py
--rw-r--r--  2.0 unx     6112 b- defN 24-Mar-20 16:47 mlrun/datastore/google_cloud_storage.py
--rw-r--r--  2.0 unx     1674 b- defN 24-Mar-20 16:47 mlrun/datastore/hdfs.py
--rw-r--r--  2.0 unx      622 b- defN 24-Mar-20 16:47 mlrun/datastore/helpers.py
--rw-r--r--  2.0 unx     2779 b- defN 24-Mar-20 16:47 mlrun/datastore/inmem.py
--rw-r--r--  2.0 unx     5575 b- defN 24-Mar-20 16:47 mlrun/datastore/redis.py
--rw-r--r--  2.0 unx     8110 b- defN 24-Mar-20 16:47 mlrun/datastore/s3.py
--rw-r--r--  2.0 unx    40160 b- defN 24-Mar-20 16:47 mlrun/datastore/sources.py
--rw-r--r--  2.0 unx     1498 b- defN 24-Mar-20 16:47 mlrun/datastore/spark_udf.py
--rw-r--r--  2.0 unx     1611 b- defN 24-Mar-20 16:47 mlrun/datastore/spark_utils.py
--rw-r--r--  2.0 unx     6839 b- defN 24-Mar-20 16:47 mlrun/datastore/store_resources.py
--rw-r--r--  2.0 unx    70714 b- defN 24-Mar-20 16:47 mlrun/datastore/targets.py
--rw-r--r--  2.0 unx     5227 b- defN 24-Mar-20 16:47 mlrun/datastore/utils.py
--rw-r--r--  2.0 unx     9252 b- defN 24-Mar-20 16:47 mlrun/datastore/v3io.py
--rw-r--r--  2.0 unx     1343 b- defN 24-Mar-20 16:47 mlrun/datastore/wasbfs/__init__.py
--rw-r--r--  2.0 unx     6151 b- defN 24-Mar-20 16:47 mlrun/datastore/wasbfs/fs.py
--rw-r--r--  2.0 unx     1163 b- defN 24-Mar-20 16:47 mlrun/db/__init__.py
--rw-r--r--  2.0 unx    18906 b- defN 24-Mar-20 16:47 mlrun/db/base.py
--rw-r--r--  2.0 unx     2397 b- defN 24-Mar-20 16:47 mlrun/db/factory.py
--rw-r--r--  2.0 unx   158600 b- defN 24-Mar-20 16:47 mlrun/db/httpdb.py
--rw-r--r--  2.0 unx    14814 b- defN 24-Mar-20 16:47 mlrun/db/nopdb.py
--rw-r--r--  2.0 unx     1584 b- defN 24-Mar-20 16:47 mlrun/feature_store/__init__.py
--rw-r--r--  2.0 unx    49480 b- defN 24-Mar-20 16:47 mlrun/feature_store/api.py
--rw-r--r--  2.0 unx    12853 b- defN 24-Mar-20 16:47 mlrun/feature_store/common.py
--rw-r--r--  2.0 unx    55295 b- defN 24-Mar-20 16:47 mlrun/feature_store/feature_set.py
--rw-r--r--  2.0 unx    43560 b- defN 24-Mar-20 16:47 mlrun/feature_store/feature_vector.py
--rw-r--r--  2.0 unx    11210 b- defN 24-Mar-20 16:47 mlrun/feature_store/ingestion.py
--rw-r--r--  2.0 unx    28882 b- defN 24-Mar-20 16:47 mlrun/feature_store/steps.py
--rw-r--r--  2.0 unx     1282 b- defN 24-Mar-20 16:47 mlrun/feature_store/retrieval/__init__.py
--rw-r--r--  2.0 unx    30004 b- defN 24-Mar-20 16:47 mlrun/feature_store/retrieval/base.py
--rw-r--r--  2.0 unx    11654 b- defN 24-Mar-20 16:47 mlrun/feature_store/retrieval/conversion.py
--rw-r--r--  2.0 unx     5491 b- defN 24-Mar-20 16:47 mlrun/feature_store/retrieval/dask_merger.py
--rw-r--r--  2.0 unx     8261 b- defN 24-Mar-20 16:47 mlrun/feature_store/retrieval/job.py
--rw-r--r--  2.0 unx     4429 b- defN 24-Mar-20 16:47 mlrun/feature_store/retrieval/local_merger.py
--rw-r--r--  2.0 unx    11165 b- defN 24-Mar-20 16:47 mlrun/feature_store/retrieval/spark_merger.py
--rw-r--r--  2.0 unx     6314 b- defN 24-Mar-20 16:47 mlrun/feature_store/retrieval/storey_merger.py
--rw-r--r--  2.0 unx      743 b- defN 24-Mar-20 16:47 mlrun/frameworks/__init__.py
--rw-r--r--  2.0 unx    11487 b- defN 24-Mar-20 16:47 mlrun/frameworks/parallel_coordinates.py
--rw-r--r--  2.0 unx      962 b- defN 24-Mar-20 16:47 mlrun/frameworks/_common/__init__.py
--rw-r--r--  2.0 unx     8497 b- defN 24-Mar-20 16:47 mlrun/frameworks/_common/artifacts_library.py
--rw-r--r--  2.0 unx    20999 b- defN 24-Mar-20 16:47 mlrun/frameworks/_common/mlrun_interface.py
--rw-r--r--  2.0 unx    55312 b- defN 24-Mar-20 16:47 mlrun/frameworks/_common/model_handler.py
--rw-r--r--  2.0 unx     3445 b- defN 24-Mar-20 16:47 mlrun/frameworks/_common/plan.py
--rw-r--r--  2.0 unx     5727 b- defN 24-Mar-20 16:47 mlrun/frameworks/_common/producer.py
--rw-r--r--  2.0 unx     9131 b- defN 24-Mar-20 16:47 mlrun/frameworks/_common/utils.py
--rw-r--r--  2.0 unx      750 b- defN 24-Mar-20 16:47 mlrun/frameworks/_dl_common/__init__.py
--rw-r--r--  2.0 unx     1151 b- defN 24-Mar-20 16:47 mlrun/frameworks/_dl_common/model_handler.py
--rw-r--r--  2.0 unx      996 b- defN 24-Mar-20 16:47 mlrun/frameworks/_dl_common/utils.py
--rw-r--r--  2.0 unx      787 b- defN 24-Mar-20 16:47 mlrun/frameworks/_dl_common/loggers/__init__.py
--rw-r--r--  2.0 unx    11477 b- defN 24-Mar-20 16:47 mlrun/frameworks/_dl_common/loggers/logger.py
--rw-r--r--  2.0 unx    14748 b- defN 24-Mar-20 16:47 mlrun/frameworks/_dl_common/loggers/mlrun_logger.py
--rw-r--r--  2.0 unx    27936 b- defN 24-Mar-20 16:47 mlrun/frameworks/_dl_common/loggers/tensorboard_logger.py
--rw-r--r--  2.0 unx      956 b- defN 24-Mar-20 16:47 mlrun/frameworks/_ml_common/__init__.py
--rw-r--r--  2.0 unx     3145 b- defN 24-Mar-20 16:47 mlrun/frameworks/_ml_common/artifacts_library.py
--rw-r--r--  2.0 unx    16885 b- defN 24-Mar-20 16:47 mlrun/frameworks/_ml_common/model_handler.py
--rw-r--r--  2.0 unx     2717 b- defN 24-Mar-20 16:47 mlrun/frameworks/_ml_common/pkl_model_server.py
--rw-r--r--  2.0 unx     4869 b- defN 24-Mar-20 16:47 mlrun/frameworks/_ml_common/plan.py
--rw-r--r--  2.0 unx     4061 b- defN 24-Mar-20 16:47 mlrun/frameworks/_ml_common/producer.py
--rw-r--r--  2.0 unx    10477 b- defN 24-Mar-20 16:47 mlrun/frameworks/_ml_common/utils.py
--rw-r--r--  2.0 unx      737 b- defN 24-Mar-20 16:47 mlrun/frameworks/_ml_common/loggers/__init__.py
--rw-r--r--  2.0 unx     5630 b- defN 24-Mar-20 16:47 mlrun/frameworks/_ml_common/loggers/logger.py
--rw-r--r--  2.0 unx     6406 b- defN 24-Mar-20 16:47 mlrun/frameworks/_ml_common/loggers/mlrun_logger.py
--rw-r--r--  2.0 unx      922 b- defN 24-Mar-20 16:47 mlrun/frameworks/_ml_common/plans/__init__.py
--rw-r--r--  2.0 unx     4894 b- defN 24-Mar-20 16:47 mlrun/frameworks/_ml_common/plans/calibration_curve_plan.py
--rw-r--r--  2.0 unx     6030 b- defN 24-Mar-20 16:47 mlrun/frameworks/_ml_common/plans/confusion_matrix_plan.py
--rw-r--r--  2.0 unx     6611 b- defN 24-Mar-20 16:47 mlrun/frameworks/_ml_common/plans/dataset_plan.py
--rw-r--r--  2.0 unx     5285 b- defN 24-Mar-20 16:47 mlrun/frameworks/_ml_common/plans/feature_importance_plan.py
--rw-r--r--  2.0 unx     6963 b- defN 24-Mar-20 16:47 mlrun/frameworks/_ml_common/plans/roc_curve_plan.py
--rw-r--r--  2.0 unx      706 b- defN 24-Mar-20 16:47 mlrun/frameworks/auto_mlrun/__init__.py
--rw-r--r--  2.0 unx    24074 b- defN 24-Mar-20 16:47 mlrun/frameworks/auto_mlrun/auto_mlrun.py
--rw-r--r--  2.0 unx      721 b- defN 24-Mar-20 16:47 mlrun/frameworks/huggingface/__init__.py
--rw-r--r--  2.0 unx     6043 b- defN 24-Mar-20 16:47 mlrun/frameworks/huggingface/model_server.py
--rw-r--r--  2.0 unx    15873 b- defN 24-Mar-20 16:47 mlrun/frameworks/lgbm/__init__.py
--rw-r--r--  2.0 unx    13791 b- defN 24-Mar-20 16:47 mlrun/frameworks/lgbm/model_handler.py
--rw-r--r--  2.0 unx     9156 b- defN 24-Mar-20 16:47 mlrun/frameworks/lgbm/model_server.py
--rw-r--r--  2.0 unx     8265 b- defN 24-Mar-20 16:47 mlrun/frameworks/lgbm/utils.py
--rw-r--r--  2.0 unx      857 b- defN 24-Mar-20 16:47 mlrun/frameworks/lgbm/callbacks/__init__.py
--rw-r--r--  2.0 unx     4081 b- defN 24-Mar-20 16:47 mlrun/frameworks/lgbm/callbacks/callback.py
--rw-r--r--  2.0 unx     5111 b- defN 24-Mar-20 16:47 mlrun/frameworks/lgbm/callbacks/logging_callback.py
--rw-r--r--  2.0 unx     4061 b- defN 24-Mar-20 16:47 mlrun/frameworks/lgbm/callbacks/mlrun_logging_callback.py
--rw-r--r--  2.0 unx      842 b- defN 24-Mar-20 16:47 mlrun/frameworks/lgbm/mlrun_interfaces/__init__.py
--rw-r--r--  2.0 unx     1531 b- defN 24-Mar-20 16:47 mlrun/frameworks/lgbm/mlrun_interfaces/booster_mlrun_interface.py
--rw-r--r--  2.0 unx    14221 b- defN 24-Mar-20 16:47 mlrun/frameworks/lgbm/mlrun_interfaces/mlrun_interface.py
--rw-r--r--  2.0 unx     1333 b- defN 24-Mar-20 16:47 mlrun/frameworks/lgbm/mlrun_interfaces/model_mlrun_interface.py
--rw-r--r--  2.0 unx      791 b- defN 24-Mar-20 16:47 mlrun/frameworks/onnx/__init__.py
--rw-r--r--  2.0 unx     6085 b- defN 24-Mar-20 16:47 mlrun/frameworks/onnx/dataset.py
--rw-r--r--  2.0 unx     2399 b- defN 24-Mar-20 16:47 mlrun/frameworks/onnx/mlrun_interface.py
--rw-r--r--  2.0 unx     6125 b- defN 24-Mar-20 16:47 mlrun/frameworks/onnx/model_handler.py
--rw-r--r--  2.0 unx     7021 b- defN 24-Mar-20 16:47 mlrun/frameworks/onnx/model_server.py
--rw-r--r--  2.0 unx    22037 b- defN 24-Mar-20 16:47 mlrun/frameworks/pytorch/__init__.py
--rw-r--r--  2.0 unx    27885 b- defN 24-Mar-20 16:47 mlrun/frameworks/pytorch/callbacks_handler.py
--rw-r--r--  2.0 unx    44621 b- defN 24-Mar-20 16:47 mlrun/frameworks/pytorch/mlrun_interface.py
--rw-r--r--  2.0 unx    22290 b- defN 24-Mar-20 16:47 mlrun/frameworks/pytorch/model_handler.py
--rw-r--r--  2.0 unx    10094 b- defN 24-Mar-20 16:47 mlrun/frameworks/pytorch/model_server.py
--rw-r--r--  2.0 unx     4515 b- defN 24-Mar-20 16:47 mlrun/frameworks/pytorch/utils.py
--rw-r--r--  2.0 unx      896 b- defN 24-Mar-20 16:47 mlrun/frameworks/pytorch/callbacks/__init__.py
--rw-r--r--  2.0 unx    11500 b- defN 24-Mar-20 16:47 mlrun/frameworks/pytorch/callbacks/callback.py
--rw-r--r--  2.0 unx    23126 b- defN 24-Mar-20 16:47 mlrun/frameworks/pytorch/callbacks/logging_callback.py
--rw-r--r--  2.0 unx     9239 b- defN 24-Mar-20 16:47 mlrun/frameworks/pytorch/callbacks/mlrun_logging_callback.py
--rw-r--r--  2.0 unx    26299 b- defN 24-Mar-20 16:47 mlrun/frameworks/pytorch/callbacks/tensorboard_logging_callback.py
--rw-r--r--  2.0 unx    10880 b- defN 24-Mar-20 16:47 mlrun/frameworks/sklearn/__init__.py
--rw-r--r--  2.0 unx     5840 b- defN 24-Mar-20 16:47 mlrun/frameworks/sklearn/estimator.py
--rw-r--r--  2.0 unx     7089 b- defN 24-Mar-20 16:47 mlrun/frameworks/sklearn/metric.py
--rw-r--r--  2.0 unx    12203 b- defN 24-Mar-20 16:47 mlrun/frameworks/sklearn/metrics_library.py
--rw-r--r--  2.0 unx    14054 b- defN 24-Mar-20 16:47 mlrun/frameworks/sklearn/mlrun_interface.py
--rw-r--r--  2.0 unx     4695 b- defN 24-Mar-20 16:47 mlrun/frameworks/sklearn/model_handler.py
--rw-r--r--  2.0 unx     1209 b- defN 24-Mar-20 16:47 mlrun/frameworks/sklearn/utils.py
--rw-r--r--  2.0 unx    10447 b- defN 24-Mar-20 16:47 mlrun/frameworks/tf_keras/__init__.py
--rw-r--r--  2.0 unx    16610 b- defN 24-Mar-20 16:47 mlrun/frameworks/tf_keras/mlrun_interface.py
--rw-r--r--  2.0 unx    28102 b- defN 24-Mar-20 16:47 mlrun/frameworks/tf_keras/model_handler.py
--rw-r--r--  2.0 unx     9529 b- defN 24-Mar-20 16:47 mlrun/frameworks/tf_keras/model_server.py
--rw-r--r--  2.0 unx     4284 b- defN 24-Mar-20 16:47 mlrun/frameworks/tf_keras/utils.py
--rw-r--r--  2.0 unx      844 b- defN 24-Mar-20 16:47 mlrun/frameworks/tf_keras/callbacks/__init__.py
--rw-r--r--  2.0 unx    21855 b- defN 24-Mar-20 16:47 mlrun/frameworks/tf_keras/callbacks/logging_callback.py
--rw-r--r--  2.0 unx     8701 b- defN 24-Mar-20 16:47 mlrun/frameworks/tf_keras/callbacks/mlrun_logging_callback.py
--rw-r--r--  2.0 unx    28419 b- defN 24-Mar-20 16:47 mlrun/frameworks/tf_keras/callbacks/tensorboard_logging_callback.py
--rw-r--r--  2.0 unx    10276 b- defN 24-Mar-20 16:47 mlrun/frameworks/xgboost/__init__.py
--rw-r--r--  2.0 unx      878 b- defN 24-Mar-20 16:47 mlrun/frameworks/xgboost/mlrun_interface.py
--rw-r--r--  2.0 unx    11530 b- defN 24-Mar-20 16:47 mlrun/frameworks/xgboost/model_handler.py
--rw-r--r--  2.0 unx     1069 b- defN 24-Mar-20 16:47 mlrun/frameworks/xgboost/utils.py
--rw-r--r--  2.0 unx      571 b- defN 24-Mar-20 16:47 mlrun/launcher/__init__.py
--rw-r--r--  2.0 unx    16432 b- defN 24-Mar-20 16:47 mlrun/launcher/base.py
--rw-r--r--  2.0 unx     6048 b- defN 24-Mar-20 16:47 mlrun/launcher/client.py
--rw-r--r--  2.0 unx     2338 b- defN 24-Mar-20 16:47 mlrun/launcher/factory.py
--rw-r--r--  2.0 unx    10909 b- defN 24-Mar-20 16:47 mlrun/launcher/local.py
--rw-r--r--  2.0 unx     7469 b- defN 24-Mar-20 16:47 mlrun/launcher/remote.py
--rw-r--r--  2.0 unx      915 b- defN 24-Mar-20 16:47 mlrun/model_monitoring/__init__.py
--rw-r--r--  2.0 unx    36535 b- defN 24-Mar-20 16:47 mlrun/model_monitoring/api.py
--rw-r--r--  2.0 unx    12504 b- defN 24-Mar-20 16:47 mlrun/model_monitoring/application.py
--rw-r--r--  2.0 unx    38184 b- defN 24-Mar-20 16:47 mlrun/model_monitoring/batch.py
--rw-r--r--  2.0 unx    27925 b- defN 24-Mar-20 16:47 mlrun/model_monitoring/controller.py
--rw-r--r--  2.0 unx     1336 b- defN 24-Mar-20 16:47 mlrun/model_monitoring/controller_handler.py
--rw-r--r--  2.0 unx     4824 b- defN 24-Mar-20 16:47 mlrun/model_monitoring/evidently_application.py
--rw-r--r--  2.0 unx    25308 b- defN 24-Mar-20 16:47 mlrun/model_monitoring/features_drift_table.py
--rw-r--r--  2.0 unx     9013 b- defN 24-Mar-20 16:47 mlrun/model_monitoring/helpers.py
--rw-r--r--  2.0 unx     3938 b- defN 24-Mar-20 16:47 mlrun/model_monitoring/model_endpoint.py
--rw-r--r--  2.0 unx     7578 b- defN 24-Mar-20 16:47 mlrun/model_monitoring/prometheus.py
--rw-r--r--  2.0 unx    48198 b- defN 24-Mar-20 16:47 mlrun/model_monitoring/stream_processing.py
--rw-r--r--  2.0 unx     5283 b- defN 24-Mar-20 16:47 mlrun/model_monitoring/tracking_policy.py
--rw-r--r--  2.0 unx     8669 b- defN 24-Mar-20 16:47 mlrun/model_monitoring/writer.py
--rw-r--r--  2.0 unx      569 b- defN 24-Mar-20 16:47 mlrun/model_monitoring/applications/__init__.py
--rw-r--r--  2.0 unx    11647 b- defN 24-Mar-20 16:47 mlrun/model_monitoring/applications/histogram_data_drift.py
--rw-r--r--  2.0 unx      569 b- defN 24-Mar-20 16:47 mlrun/model_monitoring/metrics/__init__.py
--rw-r--r--  2.0 unx     4724 b- defN 24-Mar-20 16:47 mlrun/model_monitoring/metrics/histogram_distance.py
--rw-r--r--  2.0 unx     4525 b- defN 24-Mar-20 16:47 mlrun/model_monitoring/stores/__init__.py
--rw-r--r--  2.0 unx    22222 b- defN 24-Mar-20 16:47 mlrun/model_monitoring/stores/kv_model_endpoint_store.py
--rw-r--r--  2.0 unx     5590 b- defN 24-Mar-20 16:47 mlrun/model_monitoring/stores/model_endpoint_store.py
--rw-r--r--  2.0 unx    16139 b- defN 24-Mar-20 16:47 mlrun/model_monitoring/stores/sql_model_endpoint_store.py
--rw-r--r--  2.0 unx     1111 b- defN 24-Mar-20 16:47 mlrun/model_monitoring/stores/models/__init__.py
--rw-r--r--  2.0 unx     2801 b- defN 24-Mar-20 16:47 mlrun/model_monitoring/stores/models/base.py
--rw-r--r--  2.0 unx     1131 b- defN 24-Mar-20 16:47 mlrun/model_monitoring/stores/models/mysql.py
--rw-r--r--  2.0 unx      765 b- defN 24-Mar-20 16:47 mlrun/model_monitoring/stores/models/sqlite.py
--rw-r--r--  2.0 unx     7082 b- defN 24-Mar-20 16:47 mlrun/package/__init__.py
--rw-r--r--  2.0 unx    14589 b- defN 24-Mar-20 16:47 mlrun/package/context_handler.py
--rw-r--r--  2.0 unx     1204 b- defN 24-Mar-20 16:47 mlrun/package/errors.py
--rw-r--r--  2.0 unx    15064 b- defN 24-Mar-20 16:47 mlrun/package/packager.py
--rw-r--r--  2.0 unx    37160 b- defN 24-Mar-20 16:47 mlrun/package/packagers_manager.py
--rw-r--r--  2.0 unx      769 b- defN 24-Mar-20 16:47 mlrun/package/packagers/__init__.py
--rw-r--r--  2.0 unx    26625 b- defN 24-Mar-20 16:47 mlrun/package/packagers/default_packager.py
--rw-r--r--  2.0 unx    25602 b- defN 24-Mar-20 16:47 mlrun/package/packagers/numpy_packagers.py
--rw-r--r--  2.0 unx    35761 b- defN 24-Mar-20 16:47 mlrun/package/packagers/pandas_packagers.py
--rw-r--r--  2.0 unx    22322 b- defN 24-Mar-20 16:47 mlrun/package/packagers/python_standard_library_packagers.py
--rw-r--r--  2.0 unx     1722 b- defN 24-Mar-20 16:47 mlrun/package/utils/__init__.py
--rw-r--r--  2.0 unx     7951 b- defN 24-Mar-20 16:47 mlrun/package/utils/_archiver.py
--rw-r--r--  2.0 unx     6373 b- defN 24-Mar-20 16:47 mlrun/package/utils/_formatter.py
--rw-r--r--  2.0 unx    10341 b- defN 24-Mar-20 16:47 mlrun/package/utils/_pickler.py
--rw-r--r--  2.0 unx     2357 b- defN 24-Mar-20 16:47 mlrun/package/utils/_supported_format.py
--rw-r--r--  2.0 unx     3696 b- defN 24-Mar-20 16:47 mlrun/package/utils/log_hint_utils.py
--rw-r--r--  2.0 unx    14695 b- defN 24-Mar-20 16:47 mlrun/package/utils/type_hint_utils.py
--rw-r--r--  2.0 unx     2352 b- defN 24-Mar-20 16:47 mlrun/platforms/__init__.py
--rw-r--r--  2.0 unx    19434 b- defN 24-Mar-20 16:47 mlrun/platforms/iguazio.py
--rw-r--r--  2.0 unx    11828 b- defN 24-Mar-20 16:47 mlrun/platforms/other.py
--rw-r--r--  2.0 unx     1153 b- defN 24-Mar-20 16:47 mlrun/projects/__init__.py
--rw-r--r--  2.0 unx    18538 b- defN 24-Mar-20 16:47 mlrun/projects/operations.py
--rw-r--r--  2.0 unx    40124 b- defN 24-Mar-20 16:47 mlrun/projects/pipelines.py
--rw-r--r--  2.0 unx   165058 b- defN 24-Mar-20 16:47 mlrun/projects/project.py
--rw-r--r--  2.0 unx     8289 b- defN 24-Mar-20 16:47 mlrun/runtimes/__init__.py
--rw-r--r--  2.0 unx    36572 b- defN 24-Mar-20 16:47 mlrun/runtimes/base.py
--rw-r--r--  2.0 unx     9513 b- defN 24-Mar-20 16:47 mlrun/runtimes/constants.py
--rw-r--r--  2.0 unx    19149 b- defN 24-Mar-20 16:47 mlrun/runtimes/daskjob.py
--rw-r--r--  2.0 unx    10508 b- defN 24-Mar-20 16:47 mlrun/runtimes/funcdoc.py
--rw-r--r--  2.0 unx     4918 b- defN 24-Mar-20 16:47 mlrun/runtimes/function_reference.py
--rw-r--r--  2.0 unx     7241 b- defN 24-Mar-20 16:47 mlrun/runtimes/generators.py
--rw-r--r--  2.0 unx    12500 b- defN 24-Mar-20 16:47 mlrun/runtimes/kubejob.py
--rw-r--r--  2.0 unx    21783 b- defN 24-Mar-20 16:47 mlrun/runtimes/local.py
--rw-r--r--  2.0 unx    58664 b- defN 24-Mar-20 16:47 mlrun/runtimes/pod.py
--rw-r--r--  2.0 unx     7326 b- defN 24-Mar-20 16:47 mlrun/runtimes/remotesparkjob.py
--rw-r--r--  2.0 unx    16004 b- defN 24-Mar-20 16:47 mlrun/runtimes/utils.py
--rw-r--r--  2.0 unx      569 b- defN 24-Mar-20 16:47 mlrun/runtimes/databricks_job/__init__.py
--rw-r--r--  2.0 unx     2245 b- defN 24-Mar-20 16:47 mlrun/runtimes/databricks_job/databricks_cancel_task.py
--rw-r--r--  2.0 unx    12749 b- defN 24-Mar-20 16:47 mlrun/runtimes/databricks_job/databricks_runtime.py
--rw-r--r--  2.0 unx     8679 b- defN 24-Mar-20 16:47 mlrun/runtimes/databricks_job/databricks_wrapper.py
--rw-r--r--  2.0 unx     1583 b- defN 24-Mar-20 16:47 mlrun/runtimes/mpijob/__init__.py
--rw-r--r--  2.0 unx     9161 b- defN 24-Mar-20 16:47 mlrun/runtimes/mpijob/abstract.py
--rw-r--r--  2.0 unx     3206 b- defN 24-Mar-20 16:47 mlrun/runtimes/mpijob/v1.py
--rw-r--r--  2.0 unx     1034 b- defN 24-Mar-20 16:47 mlrun/runtimes/mpijob/v1alpha1.py
--rw-r--r--  2.0 unx      794 b- defN 24-Mar-20 16:47 mlrun/runtimes/nuclio/__init__.py
--rw-r--r--  2.0 unx    10277 b- defN 24-Mar-20 16:47 mlrun/runtimes/nuclio/api_gateway.py
--rw-r--r--  2.0 unx    48990 b- defN 24-Mar-20 16:47 mlrun/runtimes/nuclio/function.py
--rw-r--r--  2.0 unx     2942 b- defN 24-Mar-20 16:47 mlrun/runtimes/nuclio/nuclio.py
--rw-r--r--  2.0 unx    30363 b- defN 24-Mar-20 16:47 mlrun/runtimes/nuclio/serving.py
--rw-r--r--  2.0 unx      614 b- defN 24-Mar-20 16:47 mlrun/runtimes/nuclio/application/__init__.py
--rw-r--r--  2.0 unx     9678 b- defN 24-Mar-20 16:47 mlrun/runtimes/nuclio/application/application.py
--rw-r--r--  2.0 unx     2920 b- defN 24-Mar-20 16:47 mlrun/runtimes/nuclio/application/reverse_proxy.go
--rw-r--r--  2.0 unx      709 b- defN 24-Mar-20 16:47 mlrun/runtimes/sparkjob/__init__.py
--rw-r--r--  2.0 unx    41189 b- defN 24-Mar-20 16:47 mlrun/runtimes/sparkjob/spark3job.py
--rw-r--r--  2.0 unx     1078 b- defN 24-Mar-20 16:47 mlrun/serving/__init__.py
--rw-r--r--  2.0 unx     6116 b- defN 24-Mar-20 16:47 mlrun/serving/merger.py
--rw-r--r--  2.0 unx    18010 b- defN 24-Mar-20 16:47 mlrun/serving/remote.py
--rw-r--r--  2.0 unx    54976 b- defN 24-Mar-20 16:47 mlrun/serving/routers.py
--rw-r--r--  2.0 unx    21161 b- defN 24-Mar-20 16:47 mlrun/serving/server.py
--rw-r--r--  2.0 unx      836 b- defN 24-Mar-20 16:47 mlrun/serving/serving_wrapper.py
--rw-r--r--  2.0 unx    55773 b- defN 24-Mar-20 16:47 mlrun/serving/states.py
--rw-r--r--  2.0 unx     3871 b- defN 24-Mar-20 16:47 mlrun/serving/utils.py
--rw-r--r--  2.0 unx    11805 b- defN 24-Mar-20 16:47 mlrun/serving/v1_serving.py
--rw-r--r--  2.0 unx    23559 b- defN 24-Mar-20 16:47 mlrun/serving/v2_serving.py
--rw-r--r--  2.0 unx      765 b- defN 24-Mar-20 16:47 mlrun/track/__init__.py
--rw-r--r--  2.0 unx     3541 b- defN 24-Mar-20 16:47 mlrun/track/tracker.py
--rw-r--r--  2.0 unx     5726 b- defN 24-Mar-20 16:47 mlrun/track/tracker_manager.py
--rw-r--r--  2.0 unx      569 b- defN 24-Mar-20 16:47 mlrun/track/trackers/__init__.py
--rw-r--r--  2.0 unx    23258 b- defN 24-Mar-20 16:47 mlrun/track/trackers/mlflow_tracker.py
--rw-r--r--  2.0 unx      826 b- defN 24-Mar-20 16:47 mlrun/utils/__init__.py
--rw-r--r--  2.0 unx    11092 b- defN 24-Mar-20 16:47 mlrun/utils/async_http.py
--rw-r--r--  2.0 unx     3450 b- defN 24-Mar-20 16:47 mlrun/utils/azure_vault.py
--rw-r--r--  2.0 unx     7361 b- defN 24-Mar-20 16:47 mlrun/utils/clones.py
--rw-r--r--  2.0 unx     1897 b- defN 24-Mar-20 16:47 mlrun/utils/condition_evaluator.py
--rw-r--r--  2.0 unx     1713 b- defN 24-Mar-20 16:47 mlrun/utils/db.py
--rw-r--r--  2.0 unx    51162 b- defN 24-Mar-20 16:47 mlrun/utils/helpers.py
--rw-r--r--  2.0 unx     8700 b- defN 24-Mar-20 16:47 mlrun/utils/http.py
--rw-r--r--  2.0 unx     8133 b- defN 24-Mar-20 16:47 mlrun/utils/logger.py
--rw-r--r--  2.0 unx     4581 b- defN 24-Mar-20 16:47 mlrun/utils/regex.py
--rw-r--r--  2.0 unx     7522 b- defN 24-Mar-20 16:47 mlrun/utils/retryer.py
--rw-r--r--  2.0 unx      869 b- defN 24-Mar-20 16:47 mlrun/utils/singleton.py
--rw-r--r--  2.0 unx     1284 b- defN 24-Mar-20 16:47 mlrun/utils/v3io_clients.py
--rw-r--r--  2.0 unx    10447 b- defN 24-Mar-20 16:47 mlrun/utils/vault.py
--rw-r--r--  2.0 unx      990 b- defN 24-Mar-20 16:47 mlrun/utils/notifications/__init__.py
--rw-r--r--  2.0 unx    21679 b- defN 24-Mar-20 16:47 mlrun/utils/notifications/notification_pusher.py
--rw-r--r--  2.0 unx     2092 b- defN 24-Mar-20 16:47 mlrun/utils/notifications/notification/__init__.py
--rw-r--r--  2.0 unx     2279 b- defN 24-Mar-20 16:47 mlrun/utils/notifications/notification/base.py
--rw-r--r--  2.0 unx     2532 b- defN 24-Mar-20 16:47 mlrun/utils/notifications/notification/console.py
--rw-r--r--  2.0 unx     5221 b- defN 24-Mar-20 16:47 mlrun/utils/notifications/notification/git.py
--rw-r--r--  2.0 unx     1955 b- defN 24-Mar-20 16:47 mlrun/utils/notifications/notification/ipython.py
--rw-r--r--  2.0 unx     3898 b- defN 24-Mar-20 16:47 mlrun/utils/notifications/notification/slack.py
--rw-r--r--  2.0 unx     2390 b- defN 24-Mar-20 16:47 mlrun/utils/notifications/notification/webhook.py
--rw-r--r--  2.0 unx      614 b- defN 24-Mar-20 16:47 mlrun/utils/version/__init__.py
--rw-r--r--  2.0 unx       88 b- defN 24-Mar-20 16:48 mlrun/utils/version/version.json
--rw-r--r--  2.0 unx     1878 b- defN 24-Mar-20 16:47 mlrun/utils/version/version.py
--rw-r--r--  2.0 unx    11357 b- defN 24-Mar-20 16:48 mlrun-1.7.0rc6.dist-info/LICENSE
--rw-r--r--  2.0 unx    18263 b- defN 24-Mar-20 16:48 mlrun-1.7.0rc6.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 24-Mar-20 16:48 mlrun-1.7.0rc6.dist-info/WHEEL
--rw-r--r--  2.0 unx       46 b- defN 24-Mar-20 16:48 mlrun-1.7.0rc6.dist-info/entry_points.txt
--rw-r--r--  2.0 unx        6 b- defN 24-Mar-20 16:48 mlrun-1.7.0rc6.dist-info/top_level.txt
--rw-rw-r--  2.0 unx    29941 b- defN 24-Mar-20 16:48 mlrun-1.7.0rc6.dist-info/RECORD
-326 files, 3847466 bytes uncompressed, 1003451 bytes compressed:  73.9%
+Zip file size: 1051048 bytes, number of entries: 330
+-rw-r--r--  2.0 unx     7248 b- defN 24-Apr-03 12:24 mlrun/__init__.py
+-rw-r--r--  2.0 unx    49229 b- defN 24-Apr-03 12:24 mlrun/__main__.py
+-rw-r--r--  2.0 unx    63044 b- defN 24-Apr-03 12:24 mlrun/config.py
+-rw-r--r--  2.0 unx     7080 b- defN 24-Apr-03 12:24 mlrun/errors.py
+-rw-r--r--  2.0 unx    40866 b- defN 24-Apr-03 12:24 mlrun/execution.py
+-rw-r--r--  2.0 unx    15569 b- defN 24-Apr-03 12:24 mlrun/features.py
+-rw-r--r--  2.0 unx     7023 b- defN 24-Apr-03 12:24 mlrun/k8s_utils.py
+-rw-r--r--  2.0 unx    30481 b- defN 24-Apr-03 12:24 mlrun/kfpops.py
+-rw-r--r--  2.0 unx     8286 b- defN 24-Apr-03 12:24 mlrun/lists.py
+-rw-r--r--  2.0 unx    70641 b- defN 24-Apr-03 12:24 mlrun/model.py
+-rw-r--r--  2.0 unx    13009 b- defN 24-Apr-03 12:24 mlrun/render.py
+-rw-r--r--  2.0 unx    42879 b- defN 24-Apr-03 12:24 mlrun/run.py
+-rw-r--r--  2.0 unx     7776 b- defN 24-Apr-03 12:24 mlrun/secrets.py
+-rw-r--r--  2.0 unx    14211 b- defN 24-Apr-03 12:24 mlrun/api/schemas/__init__.py
+-rw-r--r--  2.0 unx     1187 b- defN 24-Apr-03 12:24 mlrun/artifacts/__init__.py
+-rw-r--r--  2.0 unx    34978 b- defN 24-Apr-03 12:24 mlrun/artifacts/base.py
+-rw-r--r--  2.0 unx    22360 b- defN 24-Apr-03 12:24 mlrun/artifacts/dataset.py
+-rw-r--r--  2.0 unx    14425 b- defN 24-Apr-03 12:24 mlrun/artifacts/manager.py
+-rw-r--r--  2.0 unx    25205 b- defN 24-Apr-03 12:24 mlrun/artifacts/model.py
+-rw-r--r--  2.0 unx    15860 b- defN 24-Apr-03 12:24 mlrun/artifacts/plots.py
+-rw-r--r--  2.0 unx      571 b- defN 24-Apr-03 12:24 mlrun/common/__init__.py
+-rw-r--r--  2.0 unx      991 b- defN 24-Apr-03 12:24 mlrun/common/constants.py
+-rw-r--r--  2.0 unx     1087 b- defN 24-Apr-03 12:24 mlrun/common/helpers.py
+-rw-r--r--  2.0 unx     5181 b- defN 24-Apr-03 12:24 mlrun/common/secrets.py
+-rw-r--r--  2.0 unx      949 b- defN 24-Apr-03 12:24 mlrun/common/types.py
+-rw-r--r--  2.0 unx      571 b- defN 24-Apr-03 12:24 mlrun/common/db/__init__.py
+-rw-r--r--  2.0 unx     2659 b- defN 24-Apr-03 12:24 mlrun/common/db/sql_session.py
+-rw-r--r--  2.0 unx      721 b- defN 24-Apr-03 12:24 mlrun/common/model_monitoring/__init__.py
+-rw-r--r--  2.0 unx     4405 b- defN 24-Apr-03 12:24 mlrun/common/model_monitoring/helpers.py
+-rw-r--r--  2.0 unx     4984 b- defN 24-Apr-03 12:24 mlrun/common/schemas/__init__.py
+-rw-r--r--  2.0 unx     2344 b- defN 24-Apr-03 12:24 mlrun/common/schemas/api_gateway.py
+-rw-r--r--  2.0 unx     2796 b- defN 24-Apr-03 12:24 mlrun/common/schemas/artifact.py
+-rw-r--r--  2.0 unx     5970 b- defN 24-Apr-03 12:24 mlrun/common/schemas/auth.py
+-rw-r--r--  2.0 unx     1707 b- defN 24-Apr-03 12:24 mlrun/common/schemas/background_task.py
+-rw-r--r--  2.0 unx     2858 b- defN 24-Apr-03 12:24 mlrun/common/schemas/client_spec.py
+-rw-r--r--  2.0 unx      888 b- defN 24-Apr-03 12:24 mlrun/common/schemas/clusterization_spec.py
+-rw-r--r--  2.0 unx     1557 b- defN 24-Apr-03 12:24 mlrun/common/schemas/common.py
+-rw-r--r--  2.0 unx     6476 b- defN 24-Apr-03 12:24 mlrun/common/schemas/constants.py
+-rw-r--r--  2.0 unx      750 b- defN 24-Apr-03 12:24 mlrun/common/schemas/datastore_profile.py
+-rw-r--r--  2.0 unx     1026 b- defN 24-Apr-03 12:24 mlrun/common/schemas/events.py
+-rw-r--r--  2.0 unx     3717 b- defN 24-Apr-03 12:24 mlrun/common/schemas/feature_store.py
+-rw-r--r--  2.0 unx     2418 b- defN 24-Apr-03 12:24 mlrun/common/schemas/frontend_spec.py
+-rw-r--r--  2.0 unx     4577 b- defN 24-Apr-03 12:24 mlrun/common/schemas/function.py
+-rw-r--r--  2.0 unx      705 b- defN 24-Apr-03 12:24 mlrun/common/schemas/http.py
+-rw-r--r--  2.0 unx     4203 b- defN 24-Apr-03 12:24 mlrun/common/schemas/hub.py
+-rw-r--r--  2.0 unx     1395 b- defN 24-Apr-03 12:24 mlrun/common/schemas/k8s.py
+-rw-r--r--  2.0 unx      892 b- defN 24-Apr-03 12:24 mlrun/common/schemas/memory_reports.py
+-rw-r--r--  2.0 unx     1768 b- defN 24-Apr-03 12:24 mlrun/common/schemas/notification.py
+-rw-r--r--  2.0 unx     1980 b- defN 24-Apr-03 12:24 mlrun/common/schemas/object.py
+-rw-r--r--  2.0 unx     1177 b- defN 24-Apr-03 12:24 mlrun/common/schemas/pipeline.py
+-rw-r--r--  2.0 unx     4340 b- defN 24-Apr-03 12:24 mlrun/common/schemas/project.py
+-rw-r--r--  2.0 unx      776 b- defN 24-Apr-03 12:24 mlrun/common/schemas/regex.py
+-rw-r--r--  2.0 unx      745 b- defN 24-Apr-03 12:24 mlrun/common/schemas/runs.py
+-rw-r--r--  2.0 unx     1554 b- defN 24-Apr-03 12:24 mlrun/common/schemas/runtime_resource.py
+-rw-r--r--  2.0 unx     4287 b- defN 24-Apr-03 12:24 mlrun/common/schemas/schedule.py
+-rw-r--r--  2.0 unx     1484 b- defN 24-Apr-03 12:24 mlrun/common/schemas/secret.py
+-rw-r--r--  2.0 unx      884 b- defN 24-Apr-03 12:24 mlrun/common/schemas/tag.py
+-rw-r--r--  2.0 unx     1823 b- defN 24-Apr-03 12:24 mlrun/common/schemas/workflow.py
+-rw-r--r--  2.0 unx     1501 b- defN 24-Apr-03 12:24 mlrun/common/schemas/model_monitoring/__init__.py
+-rw-r--r--  2.0 unx     8322 b- defN 24-Apr-03 12:24 mlrun/common/schemas/model_monitoring/constants.py
+-rw-r--r--  2.0 unx     1431 b- defN 24-Apr-03 12:24 mlrun/common/schemas/model_monitoring/grafana.py
+-rw-r--r--  2.0 unx    12000 b- defN 24-Apr-03 12:24 mlrun/common/schemas/model_monitoring/model_endpoints.py
+-rw-r--r--  2.0 unx     1087 b- defN 24-Apr-03 12:24 mlrun/data_types/__init__.py
+-rw-r--r--  2.0 unx     4751 b- defN 24-Apr-03 12:24 mlrun/data_types/data_types.py
+-rw-r--r--  2.0 unx     6134 b- defN 24-Apr-03 12:24 mlrun/data_types/infer.py
+-rw-r--r--  2.0 unx     9457 b- defN 24-Apr-03 12:24 mlrun/data_types/spark.py
+-rw-r--r--  2.0 unx     9945 b- defN 24-Apr-03 12:24 mlrun/data_types/to_pandas.py
+-rw-r--r--  2.0 unx     4118 b- defN 24-Apr-03 12:24 mlrun/datastore/__init__.py
+-rw-r--r--  2.0 unx     4827 b- defN 24-Apr-03 12:24 mlrun/datastore/alibaba_oss.py
+-rw-r--r--  2.0 unx     9019 b- defN 24-Apr-03 12:24 mlrun/datastore/azure_blob.py
+-rw-r--r--  2.0 unx    24421 b- defN 24-Apr-03 12:24 mlrun/datastore/base.py
+-rw-r--r--  2.0 unx     9111 b- defN 24-Apr-03 12:24 mlrun/datastore/datastore.py
+-rw-r--r--  2.0 unx    15985 b- defN 24-Apr-03 12:24 mlrun/datastore/datastore_profile.py
+-rw-r--r--  2.0 unx     6634 b- defN 24-Apr-03 12:24 mlrun/datastore/dbfs_store.py
+-rw-r--r--  2.0 unx     3767 b- defN 24-Apr-03 12:24 mlrun/datastore/filestore.py
+-rw-r--r--  2.0 unx     6110 b- defN 24-Apr-03 12:24 mlrun/datastore/google_cloud_storage.py
+-rw-r--r--  2.0 unx     1674 b- defN 24-Apr-03 12:24 mlrun/datastore/hdfs.py
+-rw-r--r--  2.0 unx      622 b- defN 24-Apr-03 12:24 mlrun/datastore/helpers.py
+-rw-r--r--  2.0 unx     2779 b- defN 24-Apr-03 12:24 mlrun/datastore/inmem.py
+-rw-r--r--  2.0 unx     5575 b- defN 24-Apr-03 12:24 mlrun/datastore/redis.py
+-rw-r--r--  2.0 unx     8110 b- defN 24-Apr-03 12:24 mlrun/datastore/s3.py
+-rw-r--r--  2.0 unx    40125 b- defN 24-Apr-03 12:24 mlrun/datastore/sources.py
+-rw-r--r--  2.0 unx     1498 b- defN 24-Apr-03 12:24 mlrun/datastore/spark_udf.py
+-rw-r--r--  2.0 unx     1611 b- defN 24-Apr-03 12:24 mlrun/datastore/spark_utils.py
+-rw-r--r--  2.0 unx     6839 b- defN 24-Apr-03 12:24 mlrun/datastore/store_resources.py
+-rw-r--r--  2.0 unx    70714 b- defN 24-Apr-03 12:24 mlrun/datastore/targets.py
+-rw-r--r--  2.0 unx     5227 b- defN 24-Apr-03 12:24 mlrun/datastore/utils.py
+-rw-r--r--  2.0 unx     9252 b- defN 24-Apr-03 12:24 mlrun/datastore/v3io.py
+-rw-r--r--  2.0 unx     1343 b- defN 24-Apr-03 12:24 mlrun/datastore/wasbfs/__init__.py
+-rw-r--r--  2.0 unx     6151 b- defN 24-Apr-03 12:24 mlrun/datastore/wasbfs/fs.py
+-rw-r--r--  2.0 unx     1163 b- defN 24-Apr-03 12:24 mlrun/db/__init__.py
+-rw-r--r--  2.0 unx    19171 b- defN 24-Apr-03 12:24 mlrun/db/base.py
+-rw-r--r--  2.0 unx     2397 b- defN 24-Apr-03 12:24 mlrun/db/factory.py
+-rw-r--r--  2.0 unx   158765 b- defN 24-Apr-03 12:24 mlrun/db/httpdb.py
+-rw-r--r--  2.0 unx    14882 b- defN 24-Apr-03 12:24 mlrun/db/nopdb.py
+-rw-r--r--  2.0 unx     1584 b- defN 24-Apr-03 12:24 mlrun/feature_store/__init__.py
+-rw-r--r--  2.0 unx    49480 b- defN 24-Apr-03 12:24 mlrun/feature_store/api.py
+-rw-r--r--  2.0 unx    12853 b- defN 24-Apr-03 12:24 mlrun/feature_store/common.py
+-rw-r--r--  2.0 unx    55295 b- defN 24-Apr-03 12:24 mlrun/feature_store/feature_set.py
+-rw-r--r--  2.0 unx    43560 b- defN 24-Apr-03 12:24 mlrun/feature_store/feature_vector.py
+-rw-r--r--  2.0 unx    11210 b- defN 24-Apr-03 12:24 mlrun/feature_store/ingestion.py
+-rw-r--r--  2.0 unx    28882 b- defN 24-Apr-03 12:24 mlrun/feature_store/steps.py
+-rw-r--r--  2.0 unx     1282 b- defN 24-Apr-03 12:24 mlrun/feature_store/retrieval/__init__.py
+-rw-r--r--  2.0 unx    30004 b- defN 24-Apr-03 12:24 mlrun/feature_store/retrieval/base.py
+-rw-r--r--  2.0 unx    11654 b- defN 24-Apr-03 12:24 mlrun/feature_store/retrieval/conversion.py
+-rw-r--r--  2.0 unx     5491 b- defN 24-Apr-03 12:24 mlrun/feature_store/retrieval/dask_merger.py
+-rw-r--r--  2.0 unx     8261 b- defN 24-Apr-03 12:24 mlrun/feature_store/retrieval/job.py
+-rw-r--r--  2.0 unx     4429 b- defN 24-Apr-03 12:24 mlrun/feature_store/retrieval/local_merger.py
+-rw-r--r--  2.0 unx    11165 b- defN 24-Apr-03 12:24 mlrun/feature_store/retrieval/spark_merger.py
+-rw-r--r--  2.0 unx     6314 b- defN 24-Apr-03 12:24 mlrun/feature_store/retrieval/storey_merger.py
+-rw-r--r--  2.0 unx      743 b- defN 24-Apr-03 12:24 mlrun/frameworks/__init__.py
+-rw-r--r--  2.0 unx    11487 b- defN 24-Apr-03 12:24 mlrun/frameworks/parallel_coordinates.py
+-rw-r--r--  2.0 unx      962 b- defN 24-Apr-03 12:24 mlrun/frameworks/_common/__init__.py
+-rw-r--r--  2.0 unx     8497 b- defN 24-Apr-03 12:24 mlrun/frameworks/_common/artifacts_library.py
+-rw-r--r--  2.0 unx    20999 b- defN 24-Apr-03 12:24 mlrun/frameworks/_common/mlrun_interface.py
+-rw-r--r--  2.0 unx    55312 b- defN 24-Apr-03 12:24 mlrun/frameworks/_common/model_handler.py
+-rw-r--r--  2.0 unx     3445 b- defN 24-Apr-03 12:24 mlrun/frameworks/_common/plan.py
+-rw-r--r--  2.0 unx     5727 b- defN 24-Apr-03 12:24 mlrun/frameworks/_common/producer.py
+-rw-r--r--  2.0 unx     9131 b- defN 24-Apr-03 12:24 mlrun/frameworks/_common/utils.py
+-rw-r--r--  2.0 unx      750 b- defN 24-Apr-03 12:24 mlrun/frameworks/_dl_common/__init__.py
+-rw-r--r--  2.0 unx     1151 b- defN 24-Apr-03 12:24 mlrun/frameworks/_dl_common/model_handler.py
+-rw-r--r--  2.0 unx      996 b- defN 24-Apr-03 12:24 mlrun/frameworks/_dl_common/utils.py
+-rw-r--r--  2.0 unx      787 b- defN 24-Apr-03 12:24 mlrun/frameworks/_dl_common/loggers/__init__.py
+-rw-r--r--  2.0 unx    11477 b- defN 24-Apr-03 12:24 mlrun/frameworks/_dl_common/loggers/logger.py
+-rw-r--r--  2.0 unx    14748 b- defN 24-Apr-03 12:24 mlrun/frameworks/_dl_common/loggers/mlrun_logger.py
+-rw-r--r--  2.0 unx    27936 b- defN 24-Apr-03 12:24 mlrun/frameworks/_dl_common/loggers/tensorboard_logger.py
+-rw-r--r--  2.0 unx      956 b- defN 24-Apr-03 12:24 mlrun/frameworks/_ml_common/__init__.py
+-rw-r--r--  2.0 unx     3145 b- defN 24-Apr-03 12:24 mlrun/frameworks/_ml_common/artifacts_library.py
+-rw-r--r--  2.0 unx    16885 b- defN 24-Apr-03 12:24 mlrun/frameworks/_ml_common/model_handler.py
+-rw-r--r--  2.0 unx     2717 b- defN 24-Apr-03 12:24 mlrun/frameworks/_ml_common/pkl_model_server.py
+-rw-r--r--  2.0 unx     4869 b- defN 24-Apr-03 12:24 mlrun/frameworks/_ml_common/plan.py
+-rw-r--r--  2.0 unx     4061 b- defN 24-Apr-03 12:24 mlrun/frameworks/_ml_common/producer.py
+-rw-r--r--  2.0 unx    10477 b- defN 24-Apr-03 12:24 mlrun/frameworks/_ml_common/utils.py
+-rw-r--r--  2.0 unx      737 b- defN 24-Apr-03 12:24 mlrun/frameworks/_ml_common/loggers/__init__.py
+-rw-r--r--  2.0 unx     5630 b- defN 24-Apr-03 12:24 mlrun/frameworks/_ml_common/loggers/logger.py
+-rw-r--r--  2.0 unx     6406 b- defN 24-Apr-03 12:24 mlrun/frameworks/_ml_common/loggers/mlrun_logger.py
+-rw-r--r--  2.0 unx      922 b- defN 24-Apr-03 12:24 mlrun/frameworks/_ml_common/plans/__init__.py
+-rw-r--r--  2.0 unx     4894 b- defN 24-Apr-03 12:24 mlrun/frameworks/_ml_common/plans/calibration_curve_plan.py
+-rw-r--r--  2.0 unx     6030 b- defN 24-Apr-03 12:24 mlrun/frameworks/_ml_common/plans/confusion_matrix_plan.py
+-rw-r--r--  2.0 unx     6611 b- defN 24-Apr-03 12:24 mlrun/frameworks/_ml_common/plans/dataset_plan.py
+-rw-r--r--  2.0 unx     5285 b- defN 24-Apr-03 12:24 mlrun/frameworks/_ml_common/plans/feature_importance_plan.py
+-rw-r--r--  2.0 unx     6963 b- defN 24-Apr-03 12:24 mlrun/frameworks/_ml_common/plans/roc_curve_plan.py
+-rw-r--r--  2.0 unx      706 b- defN 24-Apr-03 12:24 mlrun/frameworks/auto_mlrun/__init__.py
+-rw-r--r--  2.0 unx    24074 b- defN 24-Apr-03 12:24 mlrun/frameworks/auto_mlrun/auto_mlrun.py
+-rw-r--r--  2.0 unx      721 b- defN 24-Apr-03 12:24 mlrun/frameworks/huggingface/__init__.py
+-rw-r--r--  2.0 unx     6043 b- defN 24-Apr-03 12:24 mlrun/frameworks/huggingface/model_server.py
+-rw-r--r--  2.0 unx    15873 b- defN 24-Apr-03 12:24 mlrun/frameworks/lgbm/__init__.py
+-rw-r--r--  2.0 unx    13791 b- defN 24-Apr-03 12:24 mlrun/frameworks/lgbm/model_handler.py
+-rw-r--r--  2.0 unx     9156 b- defN 24-Apr-03 12:24 mlrun/frameworks/lgbm/model_server.py
+-rw-r--r--  2.0 unx     8265 b- defN 24-Apr-03 12:24 mlrun/frameworks/lgbm/utils.py
+-rw-r--r--  2.0 unx      857 b- defN 24-Apr-03 12:24 mlrun/frameworks/lgbm/callbacks/__init__.py
+-rw-r--r--  2.0 unx     4081 b- defN 24-Apr-03 12:24 mlrun/frameworks/lgbm/callbacks/callback.py
+-rw-r--r--  2.0 unx     5111 b- defN 24-Apr-03 12:24 mlrun/frameworks/lgbm/callbacks/logging_callback.py
+-rw-r--r--  2.0 unx     4061 b- defN 24-Apr-03 12:24 mlrun/frameworks/lgbm/callbacks/mlrun_logging_callback.py
+-rw-r--r--  2.0 unx      842 b- defN 24-Apr-03 12:24 mlrun/frameworks/lgbm/mlrun_interfaces/__init__.py
+-rw-r--r--  2.0 unx     1531 b- defN 24-Apr-03 12:24 mlrun/frameworks/lgbm/mlrun_interfaces/booster_mlrun_interface.py
+-rw-r--r--  2.0 unx    14221 b- defN 24-Apr-03 12:24 mlrun/frameworks/lgbm/mlrun_interfaces/mlrun_interface.py
+-rw-r--r--  2.0 unx     1333 b- defN 24-Apr-03 12:24 mlrun/frameworks/lgbm/mlrun_interfaces/model_mlrun_interface.py
+-rw-r--r--  2.0 unx      791 b- defN 24-Apr-03 12:24 mlrun/frameworks/onnx/__init__.py
+-rw-r--r--  2.0 unx     6085 b- defN 24-Apr-03 12:24 mlrun/frameworks/onnx/dataset.py
+-rw-r--r--  2.0 unx     2399 b- defN 24-Apr-03 12:24 mlrun/frameworks/onnx/mlrun_interface.py
+-rw-r--r--  2.0 unx     6125 b- defN 24-Apr-03 12:24 mlrun/frameworks/onnx/model_handler.py
+-rw-r--r--  2.0 unx     7021 b- defN 24-Apr-03 12:24 mlrun/frameworks/onnx/model_server.py
+-rw-r--r--  2.0 unx    22037 b- defN 24-Apr-03 12:24 mlrun/frameworks/pytorch/__init__.py
+-rw-r--r--  2.0 unx    27885 b- defN 24-Apr-03 12:24 mlrun/frameworks/pytorch/callbacks_handler.py
+-rw-r--r--  2.0 unx    44621 b- defN 24-Apr-03 12:24 mlrun/frameworks/pytorch/mlrun_interface.py
+-rw-r--r--  2.0 unx    22290 b- defN 24-Apr-03 12:24 mlrun/frameworks/pytorch/model_handler.py
+-rw-r--r--  2.0 unx    10094 b- defN 24-Apr-03 12:24 mlrun/frameworks/pytorch/model_server.py
+-rw-r--r--  2.0 unx     4515 b- defN 24-Apr-03 12:24 mlrun/frameworks/pytorch/utils.py
+-rw-r--r--  2.0 unx      896 b- defN 24-Apr-03 12:24 mlrun/frameworks/pytorch/callbacks/__init__.py
+-rw-r--r--  2.0 unx    11500 b- defN 24-Apr-03 12:24 mlrun/frameworks/pytorch/callbacks/callback.py
+-rw-r--r--  2.0 unx    23126 b- defN 24-Apr-03 12:24 mlrun/frameworks/pytorch/callbacks/logging_callback.py
+-rw-r--r--  2.0 unx     9239 b- defN 24-Apr-03 12:24 mlrun/frameworks/pytorch/callbacks/mlrun_logging_callback.py
+-rw-r--r--  2.0 unx    26299 b- defN 24-Apr-03 12:24 mlrun/frameworks/pytorch/callbacks/tensorboard_logging_callback.py
+-rw-r--r--  2.0 unx    10880 b- defN 24-Apr-03 12:24 mlrun/frameworks/sklearn/__init__.py
+-rw-r--r--  2.0 unx     5840 b- defN 24-Apr-03 12:24 mlrun/frameworks/sklearn/estimator.py
+-rw-r--r--  2.0 unx     7089 b- defN 24-Apr-03 12:24 mlrun/frameworks/sklearn/metric.py
+-rw-r--r--  2.0 unx    12203 b- defN 24-Apr-03 12:24 mlrun/frameworks/sklearn/metrics_library.py
+-rw-r--r--  2.0 unx    14054 b- defN 24-Apr-03 12:24 mlrun/frameworks/sklearn/mlrun_interface.py
+-rw-r--r--  2.0 unx     4695 b- defN 24-Apr-03 12:24 mlrun/frameworks/sklearn/model_handler.py
+-rw-r--r--  2.0 unx     1209 b- defN 24-Apr-03 12:24 mlrun/frameworks/sklearn/utils.py
+-rw-r--r--  2.0 unx    10447 b- defN 24-Apr-03 12:24 mlrun/frameworks/tf_keras/__init__.py
+-rw-r--r--  2.0 unx    16610 b- defN 24-Apr-03 12:24 mlrun/frameworks/tf_keras/mlrun_interface.py
+-rw-r--r--  2.0 unx    28102 b- defN 24-Apr-03 12:24 mlrun/frameworks/tf_keras/model_handler.py
+-rw-r--r--  2.0 unx     9529 b- defN 24-Apr-03 12:24 mlrun/frameworks/tf_keras/model_server.py
+-rw-r--r--  2.0 unx     4284 b- defN 24-Apr-03 12:24 mlrun/frameworks/tf_keras/utils.py
+-rw-r--r--  2.0 unx      844 b- defN 24-Apr-03 12:24 mlrun/frameworks/tf_keras/callbacks/__init__.py
+-rw-r--r--  2.0 unx    21855 b- defN 24-Apr-03 12:24 mlrun/frameworks/tf_keras/callbacks/logging_callback.py
+-rw-r--r--  2.0 unx     8701 b- defN 24-Apr-03 12:24 mlrun/frameworks/tf_keras/callbacks/mlrun_logging_callback.py
+-rw-r--r--  2.0 unx    28419 b- defN 24-Apr-03 12:24 mlrun/frameworks/tf_keras/callbacks/tensorboard_logging_callback.py
+-rw-r--r--  2.0 unx    10276 b- defN 24-Apr-03 12:24 mlrun/frameworks/xgboost/__init__.py
+-rw-r--r--  2.0 unx      878 b- defN 24-Apr-03 12:24 mlrun/frameworks/xgboost/mlrun_interface.py
+-rw-r--r--  2.0 unx    11530 b- defN 24-Apr-03 12:24 mlrun/frameworks/xgboost/model_handler.py
+-rw-r--r--  2.0 unx     1069 b- defN 24-Apr-03 12:24 mlrun/frameworks/xgboost/utils.py
+-rw-r--r--  2.0 unx      571 b- defN 24-Apr-03 12:24 mlrun/launcher/__init__.py
+-rw-r--r--  2.0 unx    16432 b- defN 24-Apr-03 12:24 mlrun/launcher/base.py
+-rw-r--r--  2.0 unx     6048 b- defN 24-Apr-03 12:24 mlrun/launcher/client.py
+-rw-r--r--  2.0 unx     2338 b- defN 24-Apr-03 12:24 mlrun/launcher/factory.py
+-rw-r--r--  2.0 unx    10909 b- defN 24-Apr-03 12:24 mlrun/launcher/local.py
+-rw-r--r--  2.0 unx     7469 b- defN 24-Apr-03 12:24 mlrun/launcher/remote.py
+-rw-r--r--  2.0 unx      859 b- defN 24-Apr-03 12:24 mlrun/model_monitoring/__init__.py
+-rw-r--r--  2.0 unx    29276 b- defN 24-Apr-03 12:24 mlrun/model_monitoring/api.py
+-rw-r--r--  2.0 unx    12504 b- defN 24-Apr-03 12:24 mlrun/model_monitoring/application.py
+-rw-r--r--  2.0 unx    27745 b- defN 24-Apr-03 12:24 mlrun/model_monitoring/controller.py
+-rw-r--r--  2.0 unx     1336 b- defN 24-Apr-03 12:24 mlrun/model_monitoring/controller_handler.py
+-rw-r--r--  2.0 unx     4824 b- defN 24-Apr-03 12:24 mlrun/model_monitoring/evidently_application.py
+-rw-r--r--  2.0 unx    25308 b- defN 24-Apr-03 12:24 mlrun/model_monitoring/features_drift_table.py
+-rw-r--r--  2.0 unx     8925 b- defN 24-Apr-03 12:24 mlrun/model_monitoring/helpers.py
+-rw-r--r--  2.0 unx     3938 b- defN 24-Apr-03 12:24 mlrun/model_monitoring/model_endpoint.py
+-rw-r--r--  2.0 unx     7578 b- defN 24-Apr-03 12:24 mlrun/model_monitoring/prometheus.py
+-rw-r--r--  2.0 unx    49317 b- defN 24-Apr-03 12:24 mlrun/model_monitoring/stream_processing.py
+-rw-r--r--  2.0 unx     5502 b- defN 24-Apr-03 12:24 mlrun/model_monitoring/tracking_policy.py
+-rw-r--r--  2.0 unx     7309 b- defN 24-Apr-03 12:24 mlrun/model_monitoring/writer.py
+-rw-r--r--  2.0 unx      569 b- defN 24-Apr-03 12:24 mlrun/model_monitoring/applications/__init__.py
+-rw-r--r--  2.0 unx    11647 b- defN 24-Apr-03 12:24 mlrun/model_monitoring/applications/histogram_data_drift.py
+-rw-r--r--  2.0 unx      662 b- defN 24-Apr-03 12:24 mlrun/model_monitoring/db/__init__.py
+-rw-r--r--  2.0 unx     4305 b- defN 24-Apr-03 12:24 mlrun/model_monitoring/db/stores/__init__.py
+-rw-r--r--  2.0 unx      599 b- defN 24-Apr-03 12:24 mlrun/model_monitoring/db/stores/base/__init__.py
+-rw-r--r--  2.0 unx     7073 b- defN 24-Apr-03 12:24 mlrun/model_monitoring/db/stores/base/store.py
+-rw-r--r--  2.0 unx      569 b- defN 24-Apr-03 12:24 mlrun/model_monitoring/db/stores/sqldb/__init__.py
+-rw-r--r--  2.0 unx    27104 b- defN 24-Apr-03 12:24 mlrun/model_monitoring/db/stores/sqldb/sql_store.py
+-rw-r--r--  2.0 unx     2196 b- defN 24-Apr-03 12:24 mlrun/model_monitoring/db/stores/sqldb/models/__init__.py
+-rw-r--r--  2.0 unx     4413 b- defN 24-Apr-03 12:24 mlrun/model_monitoring/db/stores/sqldb/models/base.py
+-rw-r--r--  2.0 unx     2022 b- defN 24-Apr-03 12:24 mlrun/model_monitoring/db/stores/sqldb/models/mysql.py
+-rw-r--r--  2.0 unx      994 b- defN 24-Apr-03 12:24 mlrun/model_monitoring/db/stores/sqldb/models/sqlite.py
+-rw-r--r--  2.0 unx      569 b- defN 24-Apr-03 12:24 mlrun/model_monitoring/db/stores/v3io_kv/__init__.py
+-rw-r--r--  2.0 unx    27471 b- defN 24-Apr-03 12:24 mlrun/model_monitoring/db/stores/v3io_kv/kv_store.py
+-rw-r--r--  2.0 unx      569 b- defN 24-Apr-03 12:24 mlrun/model_monitoring/metrics/__init__.py
+-rw-r--r--  2.0 unx     4724 b- defN 24-Apr-03 12:24 mlrun/model_monitoring/metrics/histogram_distance.py
+-rw-r--r--  2.0 unx     7082 b- defN 24-Apr-03 12:24 mlrun/package/__init__.py
+-rw-r--r--  2.0 unx    14589 b- defN 24-Apr-03 12:24 mlrun/package/context_handler.py
+-rw-r--r--  2.0 unx     1204 b- defN 24-Apr-03 12:24 mlrun/package/errors.py
+-rw-r--r--  2.0 unx    15064 b- defN 24-Apr-03 12:24 mlrun/package/packager.py
+-rw-r--r--  2.0 unx    37160 b- defN 24-Apr-03 12:24 mlrun/package/packagers_manager.py
+-rw-r--r--  2.0 unx      769 b- defN 24-Apr-03 12:24 mlrun/package/packagers/__init__.py
+-rw-r--r--  2.0 unx    26625 b- defN 24-Apr-03 12:24 mlrun/package/packagers/default_packager.py
+-rw-r--r--  2.0 unx    25602 b- defN 24-Apr-03 12:24 mlrun/package/packagers/numpy_packagers.py
+-rw-r--r--  2.0 unx    35761 b- defN 24-Apr-03 12:24 mlrun/package/packagers/pandas_packagers.py
+-rw-r--r--  2.0 unx    22322 b- defN 24-Apr-03 12:24 mlrun/package/packagers/python_standard_library_packagers.py
+-rw-r--r--  2.0 unx     1722 b- defN 24-Apr-03 12:24 mlrun/package/utils/__init__.py
+-rw-r--r--  2.0 unx     7951 b- defN 24-Apr-03 12:24 mlrun/package/utils/_archiver.py
+-rw-r--r--  2.0 unx     6373 b- defN 24-Apr-03 12:24 mlrun/package/utils/_formatter.py
+-rw-r--r--  2.0 unx    10341 b- defN 24-Apr-03 12:24 mlrun/package/utils/_pickler.py
+-rw-r--r--  2.0 unx     2357 b- defN 24-Apr-03 12:24 mlrun/package/utils/_supported_format.py
+-rw-r--r--  2.0 unx     3696 b- defN 24-Apr-03 12:24 mlrun/package/utils/log_hint_utils.py
+-rw-r--r--  2.0 unx    14695 b- defN 24-Apr-03 12:24 mlrun/package/utils/type_hint_utils.py
+-rw-r--r--  2.0 unx     2352 b- defN 24-Apr-03 12:24 mlrun/platforms/__init__.py
+-rw-r--r--  2.0 unx    19434 b- defN 24-Apr-03 12:24 mlrun/platforms/iguazio.py
+-rw-r--r--  2.0 unx    11828 b- defN 24-Apr-03 12:24 mlrun/platforms/other.py
+-rw-r--r--  2.0 unx     1153 b- defN 24-Apr-03 12:24 mlrun/projects/__init__.py
+-rw-r--r--  2.0 unx    18538 b- defN 24-Apr-03 12:24 mlrun/projects/operations.py
+-rw-r--r--  2.0 unx    40567 b- defN 24-Apr-03 12:24 mlrun/projects/pipelines.py
+-rw-r--r--  2.0 unx   165818 b- defN 24-Apr-03 12:24 mlrun/projects/project.py
+-rw-r--r--  2.0 unx     8289 b- defN 24-Apr-03 12:24 mlrun/runtimes/__init__.py
+-rw-r--r--  2.0 unx    36683 b- defN 24-Apr-03 12:24 mlrun/runtimes/base.py
+-rw-r--r--  2.0 unx     9513 b- defN 24-Apr-03 12:24 mlrun/runtimes/constants.py
+-rw-r--r--  2.0 unx    19149 b- defN 24-Apr-03 12:24 mlrun/runtimes/daskjob.py
+-rw-r--r--  2.0 unx    10508 b- defN 24-Apr-03 12:24 mlrun/runtimes/funcdoc.py
+-rw-r--r--  2.0 unx     4918 b- defN 24-Apr-03 12:24 mlrun/runtimes/function_reference.py
+-rw-r--r--  2.0 unx     7241 b- defN 24-Apr-03 12:24 mlrun/runtimes/generators.py
+-rw-r--r--  2.0 unx    12500 b- defN 24-Apr-03 12:24 mlrun/runtimes/kubejob.py
+-rw-r--r--  2.0 unx    21783 b- defN 24-Apr-03 12:24 mlrun/runtimes/local.py
+-rw-r--r--  2.0 unx    59908 b- defN 24-Apr-03 12:24 mlrun/runtimes/pod.py
+-rw-r--r--  2.0 unx     7326 b- defN 24-Apr-03 12:24 mlrun/runtimes/remotesparkjob.py
+-rw-r--r--  2.0 unx    16004 b- defN 24-Apr-03 12:24 mlrun/runtimes/utils.py
+-rw-r--r--  2.0 unx      569 b- defN 24-Apr-03 12:24 mlrun/runtimes/databricks_job/__init__.py
+-rw-r--r--  2.0 unx     2245 b- defN 24-Apr-03 12:24 mlrun/runtimes/databricks_job/databricks_cancel_task.py
+-rw-r--r--  2.0 unx    12749 b- defN 24-Apr-03 12:24 mlrun/runtimes/databricks_job/databricks_runtime.py
+-rw-r--r--  2.0 unx     8679 b- defN 24-Apr-03 12:24 mlrun/runtimes/databricks_job/databricks_wrapper.py
+-rw-r--r--  2.0 unx     1583 b- defN 24-Apr-03 12:24 mlrun/runtimes/mpijob/__init__.py
+-rw-r--r--  2.0 unx     9161 b- defN 24-Apr-03 12:24 mlrun/runtimes/mpijob/abstract.py
+-rw-r--r--  2.0 unx     3206 b- defN 24-Apr-03 12:24 mlrun/runtimes/mpijob/v1.py
+-rw-r--r--  2.0 unx     1034 b- defN 24-Apr-03 12:24 mlrun/runtimes/mpijob/v1alpha1.py
+-rw-r--r--  2.0 unx      794 b- defN 24-Apr-03 12:24 mlrun/runtimes/nuclio/__init__.py
+-rw-r--r--  2.0 unx    14855 b- defN 24-Apr-03 12:24 mlrun/runtimes/nuclio/api_gateway.py
+-rw-r--r--  2.0 unx    49044 b- defN 24-Apr-03 12:24 mlrun/runtimes/nuclio/function.py
+-rw-r--r--  2.0 unx     2942 b- defN 24-Apr-03 12:24 mlrun/runtimes/nuclio/nuclio.py
+-rw-r--r--  2.0 unx    29745 b- defN 24-Apr-03 12:24 mlrun/runtimes/nuclio/serving.py
+-rw-r--r--  2.0 unx      614 b- defN 24-Apr-03 12:24 mlrun/runtimes/nuclio/application/__init__.py
+-rw-r--r--  2.0 unx     9678 b- defN 24-Apr-03 12:24 mlrun/runtimes/nuclio/application/application.py
+-rw-r--r--  2.0 unx     2920 b- defN 24-Apr-03 12:24 mlrun/runtimes/nuclio/application/reverse_proxy.go
+-rw-r--r--  2.0 unx      709 b- defN 24-Apr-03 12:24 mlrun/runtimes/sparkjob/__init__.py
+-rw-r--r--  2.0 unx    41189 b- defN 24-Apr-03 12:24 mlrun/runtimes/sparkjob/spark3job.py
+-rw-r--r--  2.0 unx     1078 b- defN 24-Apr-03 12:24 mlrun/serving/__init__.py
+-rw-r--r--  2.0 unx     6116 b- defN 24-Apr-03 12:24 mlrun/serving/merger.py
+-rw-r--r--  2.0 unx    18010 b- defN 24-Apr-03 12:24 mlrun/serving/remote.py
+-rw-r--r--  2.0 unx    54976 b- defN 24-Apr-03 12:24 mlrun/serving/routers.py
+-rw-r--r--  2.0 unx    21055 b- defN 24-Apr-03 12:24 mlrun/serving/server.py
+-rw-r--r--  2.0 unx      836 b- defN 24-Apr-03 12:24 mlrun/serving/serving_wrapper.py
+-rw-r--r--  2.0 unx    56265 b- defN 24-Apr-03 12:24 mlrun/serving/states.py
+-rw-r--r--  2.0 unx     3871 b- defN 24-Apr-03 12:24 mlrun/serving/utils.py
+-rw-r--r--  2.0 unx    11805 b- defN 24-Apr-03 12:24 mlrun/serving/v1_serving.py
+-rw-r--r--  2.0 unx    23559 b- defN 24-Apr-03 12:24 mlrun/serving/v2_serving.py
+-rw-r--r--  2.0 unx      765 b- defN 24-Apr-03 12:24 mlrun/track/__init__.py
+-rw-r--r--  2.0 unx     3541 b- defN 24-Apr-03 12:24 mlrun/track/tracker.py
+-rw-r--r--  2.0 unx     5726 b- defN 24-Apr-03 12:24 mlrun/track/tracker_manager.py
+-rw-r--r--  2.0 unx      569 b- defN 24-Apr-03 12:24 mlrun/track/trackers/__init__.py
+-rw-r--r--  2.0 unx    23258 b- defN 24-Apr-03 12:24 mlrun/track/trackers/mlflow_tracker.py
+-rw-r--r--  2.0 unx      826 b- defN 24-Apr-03 12:24 mlrun/utils/__init__.py
+-rw-r--r--  2.0 unx    11092 b- defN 24-Apr-03 12:24 mlrun/utils/async_http.py
+-rw-r--r--  2.0 unx     3450 b- defN 24-Apr-03 12:24 mlrun/utils/azure_vault.py
+-rw-r--r--  2.0 unx     7361 b- defN 24-Apr-03 12:24 mlrun/utils/clones.py
+-rw-r--r--  2.0 unx     1897 b- defN 24-Apr-03 12:24 mlrun/utils/condition_evaluator.py
+-rw-r--r--  2.0 unx     1713 b- defN 24-Apr-03 12:24 mlrun/utils/db.py
+-rw-r--r--  2.0 unx    52095 b- defN 24-Apr-03 12:24 mlrun/utils/helpers.py
+-rw-r--r--  2.0 unx     8700 b- defN 24-Apr-03 12:24 mlrun/utils/http.py
+-rw-r--r--  2.0 unx     8133 b- defN 24-Apr-03 12:24 mlrun/utils/logger.py
+-rw-r--r--  2.0 unx     4581 b- defN 24-Apr-03 12:24 mlrun/utils/regex.py
+-rw-r--r--  2.0 unx     7522 b- defN 24-Apr-03 12:24 mlrun/utils/retryer.py
+-rw-r--r--  2.0 unx      869 b- defN 24-Apr-03 12:24 mlrun/utils/singleton.py
+-rw-r--r--  2.0 unx     1284 b- defN 24-Apr-03 12:24 mlrun/utils/v3io_clients.py
+-rw-r--r--  2.0 unx    10447 b- defN 24-Apr-03 12:24 mlrun/utils/vault.py
+-rw-r--r--  2.0 unx      990 b- defN 24-Apr-03 12:24 mlrun/utils/notifications/__init__.py
+-rw-r--r--  2.0 unx    21679 b- defN 24-Apr-03 12:24 mlrun/utils/notifications/notification_pusher.py
+-rw-r--r--  2.0 unx     2092 b- defN 24-Apr-03 12:24 mlrun/utils/notifications/notification/__init__.py
+-rw-r--r--  2.0 unx     2279 b- defN 24-Apr-03 12:24 mlrun/utils/notifications/notification/base.py
+-rw-r--r--  2.0 unx     2532 b- defN 24-Apr-03 12:24 mlrun/utils/notifications/notification/console.py
+-rw-r--r--  2.0 unx     5221 b- defN 24-Apr-03 12:24 mlrun/utils/notifications/notification/git.py
+-rw-r--r--  2.0 unx     1955 b- defN 24-Apr-03 12:24 mlrun/utils/notifications/notification/ipython.py
+-rw-r--r--  2.0 unx     3898 b- defN 24-Apr-03 12:24 mlrun/utils/notifications/notification/slack.py
+-rw-r--r--  2.0 unx     2390 b- defN 24-Apr-03 12:24 mlrun/utils/notifications/notification/webhook.py
+-rw-r--r--  2.0 unx      614 b- defN 24-Apr-03 12:24 mlrun/utils/version/__init__.py
+-rw-r--r--  2.0 unx       88 b- defN 24-Apr-03 12:24 mlrun/utils/version/version.json
+-rw-r--r--  2.0 unx     1878 b- defN 24-Apr-03 12:24 mlrun/utils/version/version.py
+-rw-r--r--  2.0 unx    11357 b- defN 24-Apr-03 12:24 mlrun-1.7.0rc7.dist-info/LICENSE
+-rw-r--r--  2.0 unx    18719 b- defN 24-Apr-03 12:24 mlrun-1.7.0rc7.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 24-Apr-03 12:24 mlrun-1.7.0rc7.dist-info/WHEEL
+-rw-r--r--  2.0 unx       46 b- defN 24-Apr-03 12:24 mlrun-1.7.0rc7.dist-info/entry_points.txt
+-rw-r--r--  2.0 unx        6 b- defN 24-Apr-03 12:24 mlrun-1.7.0rc7.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx    30373 b- defN 24-Apr-03 12:24 mlrun-1.7.0rc7.dist-info/RECORD
+330 files, 3841218 bytes uncompressed, 1002818 bytes compressed:  73.9%
```

## zipnote {}

```diff
@@ -198,14 +198,17 @@
 
 Filename: mlrun/data_types/to_pandas.py
 Comment: 
 
 Filename: mlrun/datastore/__init__.py
 Comment: 
 
+Filename: mlrun/datastore/alibaba_oss.py
+Comment: 
+
 Filename: mlrun/datastore/azure_blob.py
 Comment: 
 
 Filename: mlrun/datastore/base.py
 Comment: 
 
 Filename: mlrun/datastore/datastore.py
@@ -600,17 +603,14 @@
 
 Filename: mlrun/model_monitoring/api.py
 Comment: 
 
 Filename: mlrun/model_monitoring/application.py
 Comment: 
 
-Filename: mlrun/model_monitoring/batch.py
-Comment: 
-
 Filename: mlrun/model_monitoring/controller.py
 Comment: 
 
 Filename: mlrun/model_monitoring/controller_handler.py
 Comment: 
 
 Filename: mlrun/model_monitoring/evidently_application.py
@@ -639,42 +639,54 @@
 
 Filename: mlrun/model_monitoring/applications/__init__.py
 Comment: 
 
 Filename: mlrun/model_monitoring/applications/histogram_data_drift.py
 Comment: 
 
-Filename: mlrun/model_monitoring/metrics/__init__.py
+Filename: mlrun/model_monitoring/db/__init__.py
 Comment: 
 
-Filename: mlrun/model_monitoring/metrics/histogram_distance.py
+Filename: mlrun/model_monitoring/db/stores/__init__.py
+Comment: 
+
+Filename: mlrun/model_monitoring/db/stores/base/__init__.py
 Comment: 
 
-Filename: mlrun/model_monitoring/stores/__init__.py
+Filename: mlrun/model_monitoring/db/stores/base/store.py
 Comment: 
 
-Filename: mlrun/model_monitoring/stores/kv_model_endpoint_store.py
+Filename: mlrun/model_monitoring/db/stores/sqldb/__init__.py
 Comment: 
 
-Filename: mlrun/model_monitoring/stores/model_endpoint_store.py
+Filename: mlrun/model_monitoring/db/stores/sqldb/sql_store.py
 Comment: 
 
-Filename: mlrun/model_monitoring/stores/sql_model_endpoint_store.py
+Filename: mlrun/model_monitoring/db/stores/sqldb/models/__init__.py
 Comment: 
 
-Filename: mlrun/model_monitoring/stores/models/__init__.py
+Filename: mlrun/model_monitoring/db/stores/sqldb/models/base.py
 Comment: 
 
-Filename: mlrun/model_monitoring/stores/models/base.py
+Filename: mlrun/model_monitoring/db/stores/sqldb/models/mysql.py
 Comment: 
 
-Filename: mlrun/model_monitoring/stores/models/mysql.py
+Filename: mlrun/model_monitoring/db/stores/sqldb/models/sqlite.py
 Comment: 
 
-Filename: mlrun/model_monitoring/stores/models/sqlite.py
+Filename: mlrun/model_monitoring/db/stores/v3io_kv/__init__.py
+Comment: 
+
+Filename: mlrun/model_monitoring/db/stores/v3io_kv/kv_store.py
+Comment: 
+
+Filename: mlrun/model_monitoring/metrics/__init__.py
+Comment: 
+
+Filename: mlrun/model_monitoring/metrics/histogram_distance.py
 Comment: 
 
 Filename: mlrun/package/__init__.py
 Comment: 
 
 Filename: mlrun/package/context_handler.py
 Comment: 
@@ -954,26 +966,26 @@
 
 Filename: mlrun/utils/version/version.json
 Comment: 
 
 Filename: mlrun/utils/version/version.py
 Comment: 
 
-Filename: mlrun-1.7.0rc6.dist-info/LICENSE
+Filename: mlrun-1.7.0rc7.dist-info/LICENSE
 Comment: 
 
-Filename: mlrun-1.7.0rc6.dist-info/METADATA
+Filename: mlrun-1.7.0rc7.dist-info/METADATA
 Comment: 
 
-Filename: mlrun-1.7.0rc6.dist-info/WHEEL
+Filename: mlrun-1.7.0rc7.dist-info/WHEEL
 Comment: 
 
-Filename: mlrun-1.7.0rc6.dist-info/entry_points.txt
+Filename: mlrun-1.7.0rc7.dist-info/entry_points.txt
 Comment: 
 
-Filename: mlrun-1.7.0rc6.dist-info/top_level.txt
+Filename: mlrun-1.7.0rc7.dist-info/top_level.txt
 Comment: 
 
-Filename: mlrun-1.7.0rc6.dist-info/RECORD
+Filename: mlrun-1.7.0rc7.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## mlrun/config.py

```diff
@@ -358,14 +358,16 @@
             #                  is set to ClusterIP
             #  ---------------------------------------------------------------------
             # Note: adding a mode requires special handling on
             # - mlrun.runtimes.constants.NuclioIngressAddTemplatedIngressModes
             # - mlrun.runtimes.nuclio.function.enrich_function_with_ingress
             "add_templated_ingress_host_mode": "never",
             "explicit_ack": "enabled",
+            # size of serving spec to move to config maps
+            "serving_spec_env_cutoff": 4096,
         },
         "logs": {
             "decode": {
                 # Replace with a replacement marker. Uses � (U+FFFD, the official REPLACEMENT CHARACTER).
                 # see https://docs.python.org/3/library/codecs.html#error-handlers for more info and options
                 "errors": "replace",
             },
@@ -475,14 +477,19 @@
         "nop_db": {
             # if set to true, will raise an error for trying to use run db functionality
             # if set to false, will use a nop db which will not preform any run db operations
             "raise_error": False,
             # if set to true, will log a warning for trying to use run db functionality while in nop db mode
             "verbose": True,
         },
+        "pagination_cache": {
+            "interval": 60,
+            "ttl": 3600,
+            "max_size": 10000,
+        },
     },
     "model_endpoint_monitoring": {
         "serving_stream_args": {"shard_count": 1, "retention_period_hours": 24},
         "application_stream_args": {"shard_count": 1, "retention_period_hours": 24},
         "drift_thresholds": {"default": {"possible_drift": 0.5, "drift_detected": 0.7}},
         # Store prefixes are used to handle model monitoring storing policies based on project and kind, such as events,
         # stream, and endpoints.
@@ -494,18 +501,17 @@
         # Offline storage path can be either relative or a full path. This path is used for general offline data
         # storage such as the parquet file which is generated from the monitoring stream function for the drift analysis
         "offline_storage_path": "model-endpoints/{kind}",
         # Default http path that points to the monitoring stream nuclio function. Will be used as a stream path
         # when the user is working in CE environment and has not provided any stream path.
         "default_http_sink": "http://nuclio-{project}-model-monitoring-stream.{namespace}.svc.cluster.local:8080",
         "default_http_sink_app": "http://nuclio-{project}-{application_name}.{namespace}.svc.cluster.local:8080",
-        "batch_processing_function_branch": "master",
         "parquet_batching_max_events": 10_000,
         "parquet_batching_timeout_secs": timedelta(minutes=1).total_seconds(),
-        # See mlrun.model_monitoring.stores.ModelEndpointStoreType for available options
+        # See mlrun.model_monitoring.db.stores.ObjectStoreFactory for available options
         "store_type": "v3io-nosql",
         "endpoint_store_connection": "",
     },
     "secret_stores": {
         # Use only in testing scenarios (such as integration tests) to avoid using k8s for secrets (will use in-memory
         # "secrets")
         "test_mode_mock_secrets": False,
@@ -612,16 +618,17 @@
         "release": "",
     },
     "debug": {
         "expose_internal_api_endpoints": False,
     },
     "workflows": {
         "default_workflow_runner_name": "workflow-runner-{}",
-        # Default timeout seconds for retrieving workflow id after execution:
-        "timeouts": {"local": 120, "kfp": 30, "remote": 90},
+        # Default timeout seconds for retrieving workflow id after execution
+        # Remote workflow timeout is the maximum between remote and the inner engine timeout
+        "timeouts": {"local": 120, "kfp": 60, "remote": 60 * 5},
     },
     "log_collector": {
         "address": "localhost:8282",
         # log collection mode can be one of: "sidecar", "legacy", "best-effort"
         # "sidecar" - use the sidecar to collect logs
         # "legacy" - use the legacy log collection method (logs are collected straight from the pod)
         # "best-effort" - use the sidecar, but if for some reason it's not available use the legacy method
```

## mlrun/model.py

```diff
@@ -67,14 +67,15 @@
             and not hasattr(param, "to_dict")
         ):
             raise ValueError(f"Parameter {name} must be a dict or object")
         if new_type and (isinstance(param, dict) or param is None):
             return new_type.from_dict(param)
         return param
 
+    @mlrun.utils.filter_warnings("ignore", FutureWarning)
     def to_dict(
         self, fields: list = None, exclude: list = None, strip: bool = False
     ) -> dict:
         """
         Convert the object to a dict
 
         :param fields:  A list of fields to include in the dictionary. If not provided, the default value is taken
```

## mlrun/run.py

```diff
@@ -843,14 +843,15 @@
     experiment=None,
     run=None,
     namespace=None,
     artifact_path=None,
     ops=None,
     url=None,
     cleanup_ttl=None,
+    timeout=60,
 ):
     """remote KubeFlow pipeline execution
 
     Submit a workflow task to KFP via mlrun API service
 
     :param pipeline:   KFP pipeline function or path to .yaml/.zip pipeline file
     :param arguments:  pipeline arguments
@@ -880,14 +881,15 @@
         arguments,
         experiment=experiment,
         run=run,
         namespace=namespace,
         ops=ops,
         artifact_path=artifact_path,
         cleanup_ttl=cleanup_ttl,
+        timeout=timeout,
     )
     logger.info(f"Pipeline run id={pipeline_run_id}, check UI for progress")
     return pipeline_run_id
 
 
 def wait_for_pipeline_completion(
     run_id,
@@ -957,15 +959,15 @@
         resp = client.wait_for_run_completion(run_id, timeout)
         if resp:
             resp = resp.to_dict()
             resp = format_summary_from_kfp_run(resp)
         show_kfp_run(resp)
 
     status = resp["run"]["status"] if resp else "unknown"
-    message = resp["run"].get("message", "")
+    message = resp["run"].get("message", "") if resp else ""
     if expected_statuses:
         if status not in expected_statuses:
             raise RuntimeError(
                 f"Pipeline run status {status}{', ' + message if message else ''}"
             )
 
     logger.debug(
```

## mlrun/common/constants.py

```diff
@@ -10,8 +10,14 @@
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 #
 IMAGE_NAME_ENRICH_REGISTRY_PREFIX = "."  # prefix for image name to enrich with registry
 MLRUN_CREATED_LABEL = "mlrun-created"
+MLRUN_MODEL_CONF = "model-conf"
+MLRUN_SERVING_SPEC_MOUNT_PATH = f"/tmp/mlrun/{MLRUN_MODEL_CONF}"
+MLRUN_SERVING_SPEC_FILENAME = "serving_spec.json"
+MLRUN_SERVING_SPEC_PATH = (
+    f"{MLRUN_SERVING_SPEC_MOUNT_PATH}/{MLRUN_SERVING_SPEC_FILENAME}"
+)
 MYSQL_MEDIUMBLOB_SIZE_BYTES = 16 * 1024 * 1024
```

## mlrun/common/types.py

```diff
@@ -7,19 +7,25 @@
 #   http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
-#
 
 import enum
 
 
 # TODO: From python 3.11 StrEnum is built-in and this will not be needed
 class StrEnum(str, enum.Enum):
     def __str__(self):
         return self.value
 
     def __repr__(self):
         return self.value
+
+
+# Partial backport from Python 3.11
+# https://docs.python.org/3/library/http.html#http.HTTPMethod
+class HTTPMethod(StrEnum):
+    GET = "GET"
+    POST = "POST"
```

## mlrun/common/schemas/__init__.py

```diff
@@ -120,14 +120,15 @@
 from .model_monitoring import (
     DriftStatus,
     EndpointType,
     EndpointUID,
     EventFieldType,
     EventKeyMetrics,
     Features,
+    FeatureSetFeatures,
     FeatureValues,
     GrafanaColumn,
     GrafanaDataPoint,
     GrafanaNumberColumn,
     GrafanaStringColumn,
     GrafanaTable,
     GrafanaTimeSeriesTarget,
@@ -135,14 +136,15 @@
     ModelEndpointList,
     ModelEndpointMetadata,
     ModelEndpointSpec,
     ModelEndpointStatus,
     ModelMonitoringMode,
     ModelMonitoringStoreKinds,
     MonitoringFunctionNames,
+    PrometheusEndpoints,
     TimeSeriesTarget,
 )
 from .notification import (
     Notification,
     NotificationKind,
     NotificationSeverity,
     NotificationStatus,
```

## mlrun/common/schemas/project.py

```diff
@@ -83,14 +83,15 @@
     source: typing.Optional[str] = None
     subpath: typing.Optional[str] = None
     origin_url: typing.Optional[str] = None
     desired_state: typing.Optional[ProjectDesiredState] = ProjectDesiredState.online
     custom_packagers: typing.Optional[list[tuple[str, bool]]] = None
     default_image: typing.Optional[str] = None
     build: typing.Optional[ImageBuilder] = None
+    default_function_node_selector: typing.Optional[dict] = {}
 
     class Config:
         extra = pydantic.Extra.allow
 
 
 class Project(pydantic.BaseModel):
     kind: ObjectKind = pydantic.Field(ObjectKind.project, const=True)
```

## mlrun/common/schemas/model_monitoring/__init__.py

```diff
@@ -18,24 +18,28 @@
     ControllerPolicy,
     DriftStatus,
     EndpointType,
     EndpointUID,
     EventFieldType,
     EventKeyMetrics,
     EventLiveStats,
+    FeatureSetFeatures,
     FileTargetKind,
     FunctionURI,
     ModelEndpointTarget,
     ModelMonitoringMode,
     ModelMonitoringStoreKinds,
     MonitoringFunctionNames,
     ProjectSecretKeys,
+    PrometheusEndpoints,
     PrometheusMetric,
+    SchedulingKeys,
     TimeSeriesTarget,
     VersionedModel,
+    WriterEvent,
 )
 from .grafana import (
     GrafanaColumn,
     GrafanaDataPoint,
     GrafanaNumberColumn,
     GrafanaStringColumn,
     GrafanaTable,
```

## mlrun/common/schemas/model_monitoring/constants.py

```diff
@@ -17,14 +17,20 @@
 from enum import Enum, IntEnum
 from typing import Optional
 
 import mlrun.common.helpers
 from mlrun.common.types import StrEnum
 
 
+class MonitoringStrEnum(StrEnum):
+    @classmethod
+    def list(cls):
+        return list(map(lambda c: c.value, cls))
+
+
 class EventFieldType:
     FUNCTION_URI = "function_uri"
     FUNCTION = "function"
     MODEL_URI = "model_uri"
     MODEL = "model"
     VERSION = "version"
     VERSIONED_MODEL = "versioned_model"
@@ -73,42 +79,52 @@
     ALGORITHM = "algorithm"
     VALUE = "value"
     DRIFT_DETECTED_THRESHOLD = "drift_detected_threshold"
     POSSIBLE_DRIFT_THRESHOLD = "possible_drift_threshold"
     SAMPLE_PARQUET_PATH = "sample_parquet_path"
 
 
+class FeatureSetFeatures(MonitoringStrEnum):
+    LATENCY = EventFieldType.LATENCY
+    ERROR_COUNT = EventFieldType.ERROR_COUNT
+    METRICS = EventFieldType.METRICS
+
+    @classmethod
+    def time_stamp(cls):
+        return EventFieldType.TIMESTAMP
+
+    @classmethod
+    def entity(cls):
+        return EventFieldType.ENDPOINT_ID
+
+
 class ApplicationEvent:
     APPLICATION_NAME = "application_name"
     CURRENT_STATS = "current_stats"
     FEATURE_STATS = "feature_stats"
     SAMPLE_PARQUET_PATH = "sample_parquet_path"
     START_INFER_TIME = "start_infer_time"
     END_INFER_TIME = "end_infer_time"
     LAST_REQUEST = "last_request"
     ENDPOINT_ID = "endpoint_id"
     OUTPUT_STREAM_URI = "output_stream_uri"
 
 
-class WriterEvent(StrEnum):
+class WriterEvent(MonitoringStrEnum):
     APPLICATION_NAME = "application_name"
     ENDPOINT_ID = "endpoint_id"
     START_INFER_TIME = "start_infer_time"
     END_INFER_TIME = "end_infer_time"
     RESULT_NAME = "result_name"
     RESULT_VALUE = "result_value"
     RESULT_KIND = "result_kind"
     RESULT_STATUS = "result_status"
     RESULT_EXTRA_DATA = "result_extra_data"
     CURRENT_STATS = "current_stats"
 
-    @classmethod
-    def list(cls):
-        return list(map(lambda c: c.value, cls))
-
 
 class EventLiveStats:
     LATENCY_AVG_5M = "latency_avg_5m"
     LATENCY_AVG_1H = "latency_avg_1h"
     PREDICTIONS_PER_SECOND = "predictions_per_second"
     PREDICTIONS_COUNT_5M = "predictions_count_5m"
     PREDICTIONS_COUNT_1H = "predictions_count_1h"
@@ -142,23 +158,28 @@
 class ModelMonitoringStoreKinds:
     ENDPOINTS = "endpoints"
     EVENTS = "events"
 
 
 class SchedulingKeys:
     LAST_ANALYZED = "last_analyzed"
+    ENDPOINT_ID = "endpoint_id"
+    APPLICATION_NAME = "application_name"
+    UID = "uid"
 
 
 class FileTargetKind:
     ENDPOINTS = "endpoints"
     EVENTS = "events"
     STREAM = "stream"
     PARQUET = "parquet"
     APPS_PARQUET = "apps_parquet"
     LOG_STREAM = "log_stream"
+    APP_RESULTS = "app_results"
+    MONITORING_SCHEDULES = "monitoring_schedules"
 
 
 class ModelMonitoringMode(str, Enum):
     enabled = "enabled"
     disabled = "disabled"
 
 
@@ -173,28 +194,24 @@
     MODEL_LATENCY_SECONDS = "model_latency_seconds"
     INCOME_FEATURES = "income_features"
     ERRORS_TOTAL = "errors_total"
     DRIFT_METRICS = "drift_metrics"
     DRIFT_STATUS = "drift_status"
 
 
-class MonitoringFunctionNames:
-    WRITER = "model-monitoring-writer"
-    BATCH = "model-monitoring-batch"
-    APPLICATION_CONTROLLER = "model-monitoring-controller"
-    STREAM = "model-monitoring-stream"
+class PrometheusEndpoints(MonitoringStrEnum):
+    MODEL_MONITORING_METRICS = "/model-monitoring-metrics"
+    MONITORING_BATCH_METRICS = "/monitoring-batch-metrics"
+    MONITORING_DRIFT_STATUS = "/monitoring-drift-status"
+
 
-    @staticmethod
-    def all():
-        return [
-            MonitoringFunctionNames.WRITER,
-            MonitoringFunctionNames.STREAM,
-            MonitoringFunctionNames.BATCH,
-            MonitoringFunctionNames.APPLICATION_CONTROLLER,
-        ]
+class MonitoringFunctionNames(MonitoringStrEnum):
+    STREAM = "model-monitoring-stream"
+    APPLICATION_CONTROLLER = "model-monitoring-controller"
+    WRITER = "model-monitoring-writer"
 
 
 @dataclass
 class FunctionURI:
     project: str
     function: str
     tag: Optional[str] = None
```

## mlrun/data_types/data_types.py

```diff
@@ -37,21 +37,23 @@
     FLOAT16 = "float16"
     FLOAT = "float32"
     DOUBLE = "float"
     BFLOAT16 = "bfloat16"
     BYTES = "bytes"
     STRING = "str"
     DATETIME = "datetime"
+    LIST = "List"
     BYTES_LIST = "List[bytes]"
     STRING_LIST = "List[string]"
     INT32_LIST = "List[int32]"
     INT64_LIST = "List[int]"
     DOUBLE_LIST = "List[float]"
     FLOAT_LIST = "List[float32]"
     BOOL_LIST = "List[bool]"
+    Tuple = "Tuple"
 
 
 def pd_schema_to_value_type(value):
     type_map = {
         "integer": ValueType.INT64,
         "string": ValueType.STRING,
         "number": ValueType.DOUBLE,
@@ -98,14 +100,16 @@
         "uint8": ValueType.INT32,
         "int8": ValueType.INT32,
         "bool": ValueType.BOOL,
         "timedelta": ValueType.INT64,
         "datetime64[ns]": ValueType.INT64,
         "datetime64[ns, tz]": ValueType.INT64,
         "category": ValueType.STRING,
+        "list": ValueType.LIST,
+        "tuple": ValueType.Tuple,
     }
 
     if type_name in type_map:
         return type_map[type_name]
 
 
 def spark_to_value_type(data_type):
```

## mlrun/datastore/azure_blob.py

```diff
@@ -154,26 +154,25 @@
                         else:
                             raise mlrun.errors.MLRunInvalidArgumentError(
                                 f"'{key}' from storage options does not match corresponding connection string"
                             )
                     st[key] = parsed_value
 
         account_name = st.get("account_name")
-        if not account_name:
-            raise mlrun.errors.MLRunInvalidArgumentError(
-                "Property 'account_name' is absent both in storage settings and connection string"
-            )
         if primary_url:
             if primary_url.startswith("http://"):
                 primary_url = primary_url[len("http://") :]
             if primary_url.startswith("https://"):
                 primary_url = primary_url[len("https://") :]
             host = primary_url
-        else:
+        elif account_name:
             host = f"{account_name}.{service}.core.windows.net"
+        else:
+            return res
+
         if "account_key" in st:
             res[f"spark.hadoop.fs.azure.account.key.{host}"] = st["account_key"]
 
         if "client_secret" in st or "client_id" in st or "tenant_id" in st:
             res[f"spark.hadoop.fs.azure.account.auth.type.{host}"] = "OAuth"
             res[f"spark.hadoop.fs.azure.account.oauth.provider.type.{host}"] = (
                 "org.apache.hadoop.fs.azurebfs.oauth2.ClientCredsTokenProvider"
```

## mlrun/datastore/base.py

```diff
@@ -23,25 +23,22 @@
 import pandas as pd
 import pyarrow
 import pytz
 import requests
 import urllib3
 from deprecated import deprecated
 
+import mlrun.config
 import mlrun.errors
 from mlrun.errors import err_to_str
 from mlrun.utils import StorePrefix, is_ipython, logger
 
 from .store_resources import is_store_uri, parse_store_uri
 from .utils import filter_df_start_end_time, select_columns_from_df
 
-verify_ssl = False
-if not verify_ssl:
-    urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)
-
 
 class FileStats:
     def __init__(self, size, modified, content_type=None):
         self.size = size
         self.modified = modified
         self.content_type = content_type
 
@@ -629,25 +626,14 @@
     username = user.encode("latin1")
     password = password.encode("latin1")
     base = b64encode(b":".join((username, password))).strip()
     authstr = "Basic " + base.decode("ascii")
     return {"Authorization": authstr}
 
 
-def http_get(url, headers=None, auth=None):
-    try:
-        response = requests.get(url, headers=headers, auth=auth, verify=verify_ssl)
-    except OSError as exc:
-        raise OSError(f"error: cannot connect to {url}: {err_to_str(exc)}")
-
-    mlrun.errors.raise_for_status(response)
-
-    return response.content
-
-
 class HttpStore(DataStore):
     def __init__(self, parent, schema, name, endpoint="", secrets: dict = None):
         super().__init__(parent, name, schema, endpoint, secrets)
         self._https_auth_token = None
         self._schema = schema
         self.auth = None
         self._headers = {}
@@ -667,15 +653,15 @@
     def upload(self, key, src_path):
         raise ValueError("unimplemented")
 
     def put(self, key, data, append=False):
         raise ValueError("unimplemented")
 
     def get(self, key, size=None, offset=0):
-        data = http_get(self.url + self._join(key), self._headers, self.auth)
+        data = self._http_get(self.url + self._join(key), self._headers, self.auth)
         if offset:
             data = data[offset:]
         if size:
             data = data[:size]
         return data
 
     def _enrich_https_token(self):
@@ -687,14 +673,34 @@
     def _validate_https_token(self):
         if self._https_auth_token and self._schema in ["http"]:
             logger.warn(
                 f"A AUTH TOKEN should not be provided while using {self._schema} "
                 f"schema as it is not secure and is not recommended."
             )
 
+    def _http_get(
+        self,
+        url,
+        headers=None,
+        auth=None,
+    ):
+        # import here to prevent import cycle
+        from mlrun.config import config as mlconf
+
+        verify_ssl = mlconf.httpdb.http.verify
+        try:
+            if not verify_ssl:
+                urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)
+            response = requests.get(url, headers=headers, auth=auth, verify=verify_ssl)
+        except OSError as exc:
+            raise OSError(f"error: cannot connect to {url}: {err_to_str(exc)}")
+
+        mlrun.errors.raise_for_status(response)
+        return response.content
+
 
 # This wrapper class is designed to extract the 'ds' schema and profile name from URL-formatted paths.
 # Within fsspec, the AbstractFileSystem::_strip_protocol() internal method is used to handle complete URL paths.
 # As an example, it converts an S3 URL 's3://s3bucket/path' to just 's3bucket/path'.
 # Since 'ds' schemas are not inherently processed by fsspec, we have adapted the _strip_protocol()
 # method specifically to strip away the 'ds' schema as required.
 def makeDatastoreSchemaSanitizer(cls, using_bucket=False, *args, **kwargs):
```

## mlrun/datastore/datastore.py

```diff
@@ -94,14 +94,18 @@
         from .dbfs_store import DBFSStore
 
         return DBFSStore
     elif schema == "hdfs":
         from .hdfs import HdfsStore
 
         return HdfsStore
+    elif schema == "oss":
+        from .alibaba_oss import OSSStore
+
+        return OSSStore
     else:
         raise ValueError(f"unsupported store scheme ({schema})")
 
 
 def uri_to_ipython(link):
     schema, endpoint, parsed_url = parse_url(link)
     if schema in [DB_SCHEMA, "memory"]:
```

## mlrun/datastore/google_cloud_storage.py

```diff
@@ -128,15 +128,15 @@
         return files
 
     def rm(self, path, recursive=False, maxdepth=None):
         path = self._make_path(path)
         self.filesystem.rm(path=path, recursive=recursive, maxdepth=maxdepth)
 
     def get_spark_options(self):
-        res = None
+        res = {}
         st = self.get_storage_options()
         if "token" in st:
             res = {"spark.hadoop.google.cloud.auth.service.account.enable": "true"}
             if isinstance(st["token"], str):
                 # Token is a filename, read json from it
                 with open(st["token"]) as file:
                     credentials = json.load(file)
```

## mlrun/datastore/sources.py

```diff
@@ -850,20 +850,19 @@
             "shards": shards,
             "retention_in_hours": retention_in_hours,
             "extra_attributes": extra_attributes or {},
         }
         super().__init__(name, attributes=attrs, **kwargs)
 
     def add_nuclio_trigger(self, function):
-        store, path, url = mlrun.store_manager.get_or_create_store(self.path)
+        store, _, url = mlrun.store_manager.get_or_create_store(self.path)
         if store.kind != "v3io":
             raise mlrun.errors.MLRunInvalidArgumentError(
                 "Only profiles that reference the v3io datastore can be used with StreamSource"
             )
-        path = "v3io:/" + path
         storage_options = store.get_storage_options()
         access_key = storage_options.get("v3io_access_key")
         endpoint, stream_path = parse_path(url)
         v3io_client = v3io.dataplane.Client(endpoint=endpoint, access_key=access_key)
         container, stream_path = split_path(stream_path)
         res = v3io_client.stream.create(
             container=container,
@@ -879,15 +878,15 @@
         if hasattr(function.spec, "graph") and function.spec.graph.engine:
             engine = function.spec.graph.engine
         if mlrun.mlconf.is_explicit_ack() and engine == "async":
             kwargs["explicit_ack_mode"] = "explicitOnly"
             kwargs["worker_allocation_mode"] = "static"
 
         function.add_v3io_stream_trigger(
-            path,
+            url,
             self.name,
             self.attributes["group"],
             self.attributes["seek_to"],
             self.attributes["shards"],
             extra_attributes=self.attributes.get("extra_attributes", {}),
             **kwargs,
         )
```

## mlrun/db/base.py

```diff
@@ -13,15 +13,15 @@
 # limitations under the License.
 
 import datetime
 from abc import ABC, abstractmethod
 from typing import Optional, Union
 
 import mlrun.common.schemas
-import mlrun.model_monitoring.model_endpoint
+import mlrun.model_monitoring
 
 
 class RunDBError(Exception):
     pass
 
 
 class RunDBInterface(ABC):
@@ -505,17 +505,15 @@
         pass
 
     @abstractmethod
     def create_model_endpoint(
         self,
         project: str,
         endpoint_id: str,
-        model_endpoint: Union[
-            mlrun.model_monitoring.model_endpoint.ModelEndpoint, dict
-        ],
+        model_endpoint: Union[mlrun.model_monitoring.ModelEndpoint, dict],
     ):
         pass
 
     @abstractmethod
     def delete_model_endpoint(
         self,
         project: str,
@@ -628,14 +626,18 @@
     def list_api_gateways(self, project=None) -> mlrun.common.schemas.APIGatewaysOutput:
         pass
 
     @abstractmethod
     def get_api_gateway(self, name, project=None) -> mlrun.common.schemas.APIGateway:
         pass
 
+    @abstractmethod
+    def delete_api_gateway(self, name, project=None):
+        pass
+
     def get_builder_status(
         self,
         func: "mlrun.runtimes.BaseRuntime",
         offset: int = 0,
         logs: bool = True,
         last_log_timestamp: float = 0.0,
         verbose: bool = False,
@@ -720,9 +722,15 @@
         pass
 
     def enable_model_monitoring(
         self,
         project: str,
         base_period: int = 10,
         image: str = "mlrun/mlrun",
-    ):
-        pass
+        deploy_histogram_data_drift_app: bool = True,
+    ) -> None:
+        raise NotImplementedError
+
+    def deploy_histogram_data_drift_app(
+        self, project: str, image: str = "mlrun/mlrun"
+    ) -> None:
+        raise NotImplementedError
```

## mlrun/db/httpdb.py

```diff
@@ -29,9885 +29,9895 @@
 000001c0: 7072 6573 7320 6f72 2069 6d70 6c69 6564  press or implied
 000001d0: 2e0a 2320 5365 6520 7468 6520 4c69 6365  ..# See the Lice
 000001e0: 6e73 6520 666f 7220 7468 6520 7370 6563  nse for the spec
 000001f0: 6966 6963 206c 616e 6775 6167 6520 676f  ific language go
 00000200: 7665 726e 696e 6720 7065 726d 6973 7369  verning permissi
 00000210: 6f6e 7320 616e 640a 2320 6c69 6d69 7461  ons and.# limita
 00000220: 7469 6f6e 7320 756e 6465 7220 7468 6520  tions under the 
-00000230: 4c69 6365 6e73 652e 0a69 6d70 6f72 7420  License..import 
-00000240: 656e 756d 0a69 6d70 6f72 7420 6874 7470  enum.import http
-00000250: 0a69 6d70 6f72 7420 7265 0a69 6d70 6f72  .import re.impor
-00000260: 7420 7465 6d70 6669 6c65 0a69 6d70 6f72  t tempfile.impor
-00000270: 7420 7469 6d65 0a69 6d70 6f72 7420 7472  t time.import tr
-00000280: 6163 6562 6163 6b0a 696d 706f 7274 2074  aceback.import t
-00000290: 7970 696e 670a 696d 706f 7274 2077 6172  yping.import war
-000002a0: 6e69 6e67 730a 6672 6f6d 2064 6174 6574  nings.from datet
-000002b0: 696d 6520 696d 706f 7274 2064 6174 6574  ime import datet
-000002c0: 696d 652c 2074 696d 6564 656c 7461 0a66  ime, timedelta.f
-000002d0: 726f 6d20 6f73 2069 6d70 6f72 7420 7061  rom os import pa
-000002e0: 7468 2c20 7265 6d6f 7665 0a66 726f 6d20  th, remove.from 
-000002f0: 7479 7069 6e67 2069 6d70 6f72 7420 4f70  typing import Op
-00000300: 7469 6f6e 616c 2c20 556e 696f 6e0a 6672  tional, Union.fr
-00000310: 6f6d 2075 726c 6c69 622e 7061 7273 6520  om urllib.parse 
-00000320: 696d 706f 7274 2075 726c 7061 7273 650a  import urlparse.
-00000330: 0a69 6d70 6f72 7420 6b66 700a 696d 706f  .import kfp.impo
-00000340: 7274 2072 6571 7565 7374 730a 696d 706f  rt requests.impo
-00000350: 7274 2073 656d 7665 720a 0a69 6d70 6f72  rt semver..impor
-00000360: 7420 6d6c 7275 6e0a 696d 706f 7274 206d  t mlrun.import m
-00000370: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
-00000380: 6d61 730a 696d 706f 7274 206d 6c72 756e  mas.import mlrun
-00000390: 2e6d 6f64 656c 5f6d 6f6e 6974 6f72 696e  .model_monitorin
-000003a0: 672e 6d6f 6465 6c5f 656e 6470 6f69 6e74  g.model_endpoint
-000003b0: 0a69 6d70 6f72 7420 6d6c 7275 6e2e 706c  .import mlrun.pl
-000003c0: 6174 666f 726d 730a 696d 706f 7274 206d  atforms.import m
-000003d0: 6c72 756e 2e70 726f 6a65 6374 730a 696d  lrun.projects.im
-000003e0: 706f 7274 206d 6c72 756e 2e72 756e 7469  port mlrun.runti
-000003f0: 6d65 732e 6e75 636c 696f 2e61 7069 5f67  mes.nuclio.api_g
-00000400: 6174 6577 6179 0a66 726f 6d20 6d6c 7275  ateway.from mlru
-00000410: 6e2e 6572 726f 7273 2069 6d70 6f72 7420  n.errors import 
-00000420: 4d4c 5275 6e49 6e76 616c 6964 4172 6775  MLRunInvalidArgu
-00000430: 6d65 6e74 4572 726f 722c 2065 7272 5f74  mentError, err_t
-00000440: 6f5f 7374 720a 0a66 726f 6d20 2e2e 6172  o_str..from ..ar
-00000450: 7469 6661 6374 7320 696d 706f 7274 2041  tifacts import A
-00000460: 7274 6966 6163 740a 6672 6f6d 202e 2e63  rtifact.from ..c
-00000470: 6f6e 6669 6720 696d 706f 7274 2063 6f6e  onfig import con
-00000480: 6669 670a 6672 6f6d 202e 2e64 6174 6173  fig.from ..datas
-00000490: 746f 7265 2e64 6174 6173 746f 7265 5f70  tore.datastore_p
-000004a0: 726f 6669 6c65 2069 6d70 6f72 7420 4461  rofile import Da
-000004b0: 7461 7374 6f72 6550 726f 6669 6c65 324a  tastoreProfile2J
-000004c0: 736f 6e0a 6672 6f6d 202e 2e66 6561 7475  son.from ..featu
-000004d0: 7265 5f73 746f 7265 2069 6d70 6f72 7420  re_store import 
-000004e0: 4665 6174 7572 6553 6574 2c20 4665 6174  FeatureSet, Feat
-000004f0: 7572 6556 6563 746f 720a 6672 6f6d 202e  ureVector.from .
-00000500: 2e6c 6973 7473 2069 6d70 6f72 7420 4172  .lists import Ar
-00000510: 7469 6661 6374 4c69 7374 2c20 5275 6e4c  tifactList, RunL
-00000520: 6973 740a 6672 6f6d 202e 2e72 756e 7469  ist.from ..runti
-00000530: 6d65 7320 696d 706f 7274 2042 6173 6552  mes import BaseR
-00000540: 756e 7469 6d65 0a66 726f 6d20 2e2e 7574  untime.from ..ut
-00000550: 696c 7320 696d 706f 7274 2028 0a20 2020  ils import (.   
-00000560: 2064 6174 6574 696d 655f 746f 5f69 736f   datetime_to_iso
-00000570: 2c0a 2020 2020 6469 6374 5f74 6f5f 6a73  ,.    dict_to_js
-00000580: 6f6e 2c0a 2020 2020 6c6f 6767 6572 2c0a  on,.    logger,.
-00000590: 2020 2020 6e65 775f 7069 7065 5f6d 6574      new_pipe_met
-000005a0: 6164 6174 612c 0a20 2020 206e 6f72 6d61  adata,.    norma
-000005b0: 6c69 7a65 5f6e 616d 652c 0a20 2020 2076  lize_name,.    v
-000005c0: 6572 7369 6f6e 2c0a 290a 6672 6f6d 202e  ersion,.).from .
-000005d0: 6261 7365 2069 6d70 6f72 7420 5275 6e44  base import RunD
-000005e0: 4245 7272 6f72 2c20 5275 6e44 4249 6e74  BError, RunDBInt
-000005f0: 6572 6661 6365 0a0a 5f61 7274 6966 6163  erface.._artifac
-00000600: 745f 6b65 7973 203d 205b 0a20 2020 2022  t_keys = [.    "
-00000610: 666f 726d 6174 222c 0a20 2020 2022 696e  format",.    "in
-00000620: 6c69 6e65 222c 0a20 2020 2022 6b65 7922  line",.    "key"
-00000630: 2c0a 2020 2020 2273 7263 5f70 6174 6822  ,.    "src_path"
-00000640: 2c0a 2020 2020 2274 6172 6765 745f 7061  ,.    "target_pa
-00000650: 7468 222c 0a20 2020 2022 7669 6577 6572  th",.    "viewer
-00000660: 222c 0a5d 0a0a 0a64 6566 2062 6f6f 6c32  ",.]...def bool2
-00000670: 7374 7228 7661 6c29 3a0a 2020 2020 7265  str(val):.    re
-00000680: 7475 726e 2022 7965 7322 2069 6620 7661  turn "yes" if va
-00000690: 6c20 656c 7365 2022 6e6f 220a 0a0a 636c  l else "no"...cl
-000006a0: 6173 7320 4854 5450 5275 6e44 4228 5275  ass HTTPRunDB(Ru
-000006b0: 6e44 4249 6e74 6572 6661 6365 293a 0a20  nDBInterface):. 
-000006c0: 2020 2022 2222 496e 7465 7266 6163 6520     """Interface 
-000006d0: 666f 7220 6163 6365 7373 696e 6720 616e  for accessing an
-000006e0: 6420 6d61 6e69 7075 6c61 7469 6e67 2074  d manipulating t
-000006f0: 6865 203a 7079 3a6d 6f64 3a60 6d6c 7275  he :py:mod:`mlru
-00000700: 6e60 2070 6572 7369 7374 656e 7420 7374  n` persistent st
-00000710: 6f72 652c 206d 6169 6e74 6169 6e69 6e67  ore, maintaining
-00000720: 2074 6865 2066 756c 6c20 7374 6174 650a   the full state.
-00000730: 2020 2020 616e 6420 6361 7461 6c6f 6720      and catalog 
-00000740: 6f66 206f 626a 6563 7473 2074 6861 7420  of objects that 
-00000750: 4d4c 5275 6e20 7573 6573 2e20 5468 6520  MLRun uses. The 
-00000760: 3a70 793a 636c 6173 733a 6048 5454 5052  :py:class:`HTTPR
-00000770: 756e 4442 6020 636c 6173 7320 7365 7276  unDB` class serv
-00000780: 6573 2061 7320 6120 636c 6965 6e74 2d73  es as a client-s
-00000790: 6964 6520 7072 6f78 7920 746f 2074 6865  ide proxy to the
-000007a0: 204d 4c52 756e 0a20 2020 2041 5049 2073   MLRun.    API s
-000007b0: 6572 7669 6365 2077 6869 6368 206d 6169  ervice which mai
-000007c0: 6e74 6169 6e73 2074 6865 2061 6374 7561  ntains the actua
-000007d0: 6c20 6461 7461 2d73 746f 7265 2c20 6163  l data-store, ac
-000007e0: 6365 7373 6573 2074 6865 2073 6572 7665  cesses the serve
-000007f0: 7220 7468 726f 7567 6820 5245 5354 2041  r through REST A
-00000800: 5049 732e 0a0a 2020 2020 5468 6520 636c  PIs...    The cl
-00000810: 6173 7320 7072 6f76 6964 6573 2066 756e  ass provides fun
-00000820: 6374 696f 6e73 2066 6f72 2061 6363 6573  ctions for acces
-00000830: 7369 6e67 2061 6e64 206d 6f64 6966 7969  sing and modifyi
-00000840: 6e67 2074 6865 2076 6172 696f 7573 206f  ng the various o
-00000850: 626a 6563 7473 2074 6861 7420 6172 6520  bjects that are 
-00000860: 7573 6564 2062 7920 4d4c 5275 6e20 696e  used by MLRun in
-00000870: 2069 7473 0a20 2020 206f 7065 7261 7469   its.    operati
-00000880: 6f6e 2e20 5468 6520 6675 6e63 7469 6f6e  on. The function
-00000890: 7320 7072 6f76 6964 6564 2066 6f6c 6c6f  s provided follo
-000008a0: 7720 736f 6d65 2073 7461 6e64 6172 6420  w some standard 
-000008b0: 6775 6964 656c 696e 6573 2c20 7768 6963  guidelines, whic
-000008c0: 6820 6172 653a 0a0a 2020 2020 2d20 4576  h are:..    - Ev
-000008d0: 6572 7920 6f62 6a65 6374 2069 6e20 4d4c  ery object in ML
-000008e0: 5275 6e20 6578 6973 7473 2069 6e20 7468  Run exists in th
-000008f0: 6520 636f 6e74 6578 7420 6f66 2061 2070  e context of a p
-00000900: 726f 6a65 6374 2028 6578 6365 7074 2070  roject (except p
-00000910: 726f 6a65 6374 7320 7468 656d 7365 6c76  rojects themselv
-00000920: 6573 292e 2057 6865 6e20 7265 6665 7265  es). When refere
-00000930: 6e63 696e 6720 616e 206f 626a 6563 740a  ncing an object.
-00000940: 2020 2020 2020 7468 726f 7567 6820 616e        through an
-00000950: 7920 4150 492c 2061 2070 726f 6a65 6374  y API, a project
-00000960: 206e 616d 6520 6d75 7374 2062 6520 7072   name must be pr
-00000970: 6f76 6964 6564 2e20 5468 6520 6465 6661  ovided. The defa
-00000980: 756c 7420 666f 7220 6d6f 7374 2041 5049  ult for most API
-00000990: 7320 6973 2066 6f72 2061 6e20 656d 7074  s is for an empt
-000009a0: 7920 7072 6f6a 6563 7420 6e61 6d65 2c20  y project name, 
-000009b0: 7768 6963 680a 2020 2020 2020 7769 6c6c  which.      will
-000009c0: 2062 6520 7265 706c 6163 6564 2062 7920   be replaced by 
-000009d0: 7468 6520 6e61 6d65 206f 6620 7468 6520  the name of the 
-000009e0: 6465 6661 756c 7420 7072 6f6a 6563 7420  default project 
-000009f0: 2875 7375 616c 6c79 2060 6064 6566 6175  (usually ``defau
-00000a00: 6c74 6060 292e 2054 6865 7265 666f 7265  lt``). Therefore
-00000a10: 2c20 6966 2070 6572 666f 726d 696e 6720  , if performing 
-00000a20: 616e 2041 5049 2074 6f0a 2020 2020 2020  an API to.      
-00000a30: 6c69 7374 2066 756e 6374 696f 6e73 2c20  list functions, 
-00000a40: 666f 7220 6578 616d 706c 652c 2061 6e64  for example, and
-00000a50: 206e 6f74 2070 726f 7669 6469 6e67 2061   not providing a
-00000a60: 2070 726f 6a65 6374 206e 616d 6520 2d20   project name - 
-00000a70: 7468 6520 7265 7375 6c74 2077 696c 6c20  the result will 
-00000a80: 6e6f 7420 6265 2066 756e 6374 696f 6e73  not be functions
-00000a90: 2066 726f 6d20 616c 6c0a 2020 2020 2020   from all.      
-00000aa0: 7072 6f6a 6563 7473 2062 7574 2072 6174  projects but rat
-00000ab0: 6865 7220 6672 6f6d 2074 6865 2060 6064  her from the ``d
-00000ac0: 6566 6175 6c74 6060 2070 726f 6a65 6374  efault`` project
-00000ad0: 2e0a 2020 2020 2d20 4d61 6e79 206f 626a  ..    - Many obj
-00000ae0: 6563 7473 2063 616e 2062 6520 6173 7369  ects can be assi
-00000af0: 676e 6564 206c 6162 656c 732c 2061 6e64  gned labels, and
-00000b00: 206c 6973 7465 642f 7175 6572 6965 6420   listed/queried 
-00000b10: 6279 206c 6162 656c 2e20 5468 6520 6c61  by label. The la
-00000b20: 6265 6c20 7061 7261 6d65 7465 7220 666f  bel parameter fo
-00000b30: 7220 7175 6572 7920 4150 4973 2061 6c6c  r query APIs all
-00000b40: 6f77 7320 666f 720a 2020 2020 2020 6c69  ows for.      li
-00000b50: 7374 696e 6720 6f62 6a65 6374 7320 7468  sting objects th
-00000b60: 6174 3a0a 0a20 2020 2020 202d 2048 6176  at:..      - Hav
-00000b70: 6520 6120 7370 6563 6966 6963 206c 6162  e a specific lab
-00000b80: 656c 2c20 6279 2061 736b 696e 6720 666f  el, by asking fo
-00000b90: 7220 6060 6c61 6265 6c3d 223c 6c61 6265  r ``label="<labe
-00000ba0: 6c5f 6e61 6d65 3e22 6060 2e20 496e 2074  l_name>"``. In t
-00000bb0: 6869 7320 6361 7365 2074 6865 2061 6374  his case the act
-00000bc0: 7561 6c20 7661 6c75 6520 6f66 2074 6865  ual value of the
-00000bd0: 206c 6162 656c 0a20 2020 2020 2020 2064   label.        d
-00000be0: 6f65 736e 2774 206d 6174 7465 7220 616e  oesn't matter an
-00000bf0: 6420 6576 6572 7920 6f62 6a65 6374 2077  d every object w
-00000c00: 6974 6820 7468 6174 206c 6162 656c 2077  ith that label w
-00000c10: 696c 6c20 6265 2072 6574 7572 6e65 640a  ill be returned.
-00000c20: 2020 2020 2020 2d20 4861 7665 2061 206c        - Have a l
-00000c30: 6162 656c 2077 6974 6820 6120 7370 6563  abel with a spec
-00000c40: 6966 6963 2076 616c 7565 2e20 5468 6973  ific value. This
-00000c50: 2069 7320 646f 6e65 2062 7920 7370 6563   is done by spec
-00000c60: 6966 7969 6e67 2060 606c 6162 656c 3d22  ifying ``label="
-00000c70: 3c6c 6162 656c 5f6e 616d 653e 3d3c 6c61  <label_name>=<la
-00000c80: 6265 6c5f 7661 6c75 653e 2260 602e 2049  bel_value>"``. I
-00000c90: 6e20 7468 6973 0a20 2020 2020 2020 2063  n this.        c
-00000ca0: 6173 6520 6f6e 6c79 206f 626a 6563 7473  ase only objects
-00000cb0: 2077 686f 7365 206c 6162 656c 206d 6174   whose label mat
-00000cc0: 6368 6573 2074 6865 2076 616c 7565 2077  ches the value w
-00000cd0: 696c 6c20 6265 2072 6574 7572 6e65 640a  ill be returned.
-00000ce0: 0a20 2020 202d 204d 6f73 7420 6f62 6a65  .    - Most obje
-00000cf0: 6374 7320 6861 7665 2061 2060 6063 7265  cts have a ``cre
-00000d00: 6174 6560 6020 6d65 7468 6f64 2061 7320  ate`` method as 
-00000d10: 7765 6c6c 2061 7320 6120 6060 7374 6f72  well as a ``stor
-00000d20: 6560 6020 6d65 7468 6f64 2e20 4372 6561  e`` method. Crea
-00000d30: 7465 2063 616e 206f 6e6c 7920 6265 2063  te can only be c
-00000d40: 616c 6c65 6420 7768 656e 2073 7563 6820  alled when such 
-00000d50: 616e 0a20 2020 2020 2064 6f65 7320 6e6f  an.      does no
-00000d60: 7420 6578 6973 7420 7965 742c 2077 6869  t exist yet, whi
-00000d70: 6c65 2073 746f 7265 2061 6c6c 6f77 7320  le store allows 
-00000d80: 666f 7220 6569 7468 6572 2063 7265 6174  for either creat
-00000d90: 696e 6720 6120 6e65 7720 6f62 6a65 6374  ing a new object
-00000da0: 206f 7220 6f76 6572 7772 6974 696e 6720   or overwriting 
-00000db0: 616e 2065 7869 7374 696e 6720 6f62 6a65  an existing obje
-00000dc0: 6374 2e0a 2020 2020 2d20 536f 6d65 206f  ct..    - Some o
-00000dd0: 626a 6563 7473 2068 6176 6520 6120 6060  bjects have a ``
-00000de0: 7665 7273 696f 6e65 6460 6020 6f70 7469  versioned`` opti
-00000df0: 6f6e 2c20 696e 2077 6869 6368 2063 6173  on, in which cas
-00000e00: 6520 6f76 6572 7772 6974 696e 6720 7468  e overwriting th
-00000e10: 6520 7361 6d65 206f 626a 6563 7420 7769  e same object wi
-00000e20: 7468 2061 2064 6966 6665 7265 6e74 2076  th a different v
-00000e30: 6572 7369 6f6e 206f 660a 2020 2020 2020  ersion of.      
-00000e40: 6974 2064 6f65 7320 6e6f 7420 6465 6c65  it does not dele
-00000e50: 7465 2074 6865 2070 7265 7669 6f75 7320  te the previous 
-00000e60: 7665 7273 696f 6e2c 2062 7574 2072 6174  version, but rat
-00000e70: 6865 7220 6372 6561 7465 7320 6120 6e65  her creates a ne
-00000e80: 7720 7665 7273 696f 6e20 6f66 2074 6865  w version of the
-00000e90: 206f 626a 6563 7420 616e 6420 6b65 6570   object and keep
-00000ea0: 7320 626f 7468 2076 6572 7369 6f6e 732e  s both versions.
-00000eb0: 0a20 2020 2020 2056 6572 7369 6f6e 6564  .      Versioned
-00000ec0: 206f 626a 6563 7473 2075 7375 616c 6c79   objects usually
-00000ed0: 2068 6176 6520 6120 6060 7569 6460 6020   have a ``uid`` 
-00000ee0: 7072 6f70 6572 7479 2077 6869 6368 2069  property which i
-00000ef0: 7320 6261 7365 6420 6f6e 2074 6865 6972  s based on their
-00000f00: 2063 6f6e 7465 6e74 2061 6e64 2061 6c6c   content and all
-00000f10: 6f77 7320 746f 2072 6566 6572 656e 6365  ows to reference
-00000f20: 2061 0a20 2020 2020 2073 7065 6369 6669   a.      specifi
-00000f30: 6320 7665 7273 696f 6e20 6f66 2061 6e20  c version of an 
-00000f40: 6f62 6a65 6374 2028 6f74 6865 7220 7468  object (other th
-00000f50: 616e 2074 6167 6769 6e67 206f 626a 6563  an tagging objec
-00000f60: 7473 2c20 7768 6963 6820 616c 736f 2061  ts, which also a
-00000f70: 6c6c 6f77 7320 666f 7220 6561 7379 2072  llows for easy r
-00000f80: 6566 6572 656e 6369 6e67 292e 0a20 2020  eferencing)..   
-00000f90: 202d 204d 616e 7920 6f62 6a65 6374 7320   - Many objects 
-00000fa0: 6861 7665 2062 6f74 6820 6120 6060 7374  have both a ``st
-00000fb0: 6f72 6560 6020 6675 6e63 7469 6f6e 2061  ore`` function a
-00000fc0: 6e64 2061 2060 6070 6174 6368 6060 2066  nd a ``patch`` f
-00000fd0: 756e 6374 696f 6e2e 2054 6865 7365 2061  unction. These a
-00000fe0: 7265 2075 7365 6420 696e 2074 6865 2073  re used in the s
-00000ff0: 616d 6520 7761 7920 6173 2074 6865 0a20  ame way as the. 
-00001000: 2020 2020 2063 6f72 7265 7370 6f6e 6469       correspondi
-00001010: 6e67 2052 4553 5420 7665 7262 7320 2d20  ng REST verbs - 
-00001020: 6120 6060 7374 6f72 6560 6020 6973 2070  a ``store`` is p
-00001030: 6173 7365 6420 6120 6675 6c6c 206f 626a  assed a full obj
-00001040: 6563 7420 616e 6420 7769 6c6c 2062 6173  ect and will bas
-00001050: 6963 616c 6c79 2070 6572 666f 726d 2061  ically perform a
-00001060: 2050 5554 206f 7065 7261 7469 6f6e 2c0a   PUT operation,.
-00001070: 2020 2020 2020 7265 706c 6163 696e 6720        replacing 
-00001080: 7468 6520 6675 6c6c 206f 626a 6563 7420  the full object 
-00001090: 2869 6620 6974 2065 7869 7374 7329 2077  (if it exists) w
-000010a0: 6869 6c65 2060 6070 6174 6368 6060 2072  hile ``patch`` r
-000010b0: 6563 6569 7665 7320 6a75 7374 2061 2064  eceives just a d
-000010c0: 6963 7469 6f6e 6172 7920 636f 6e74 6169  ictionary contai
-000010d0: 6e69 6e67 2074 6865 2064 6966 6665 7265  ning the differe
-000010e0: 6e63 6573 2074 6f0a 2020 2020 2020 6265  nces to.      be
-000010f0: 2061 7070 6c69 6564 2074 6f20 7468 6520   applied to the 
-00001100: 6f62 6a65 6374 2c20 616e 6420 7769 6c6c  object, and will
-00001110: 206d 6572 6765 2074 686f 7365 2063 6861   merge those cha
-00001120: 6e67 6573 2074 6f20 7468 6520 6578 6973  nges to the exis
-00001130: 7469 6e67 206f 626a 6563 742e 2054 6865  ting object. The
-00001140: 2060 6070 6174 6368 6060 0a20 2020 2020   ``patch``.     
-00001150: 206f 7065 7261 7469 6f6e 2061 6c73 6f20   operation also 
-00001160: 6861 7320 6120 7374 7261 7465 6779 2061  has a strategy a
-00001170: 7373 6967 6e65 6420 746f 2069 7420 7768  ssigned to it wh
-00001180: 6963 6820 6465 7465 726d 696e 6573 2068  ich determines h
-00001190: 6f77 2074 6865 206d 6572 6765 206c 6f67  ow the merge log
-000011a0: 6963 2073 686f 756c 6420 6265 6861 7665  ic should behave
-000011b0: 2e0a 2020 2020 2020 5468 6520 7374 7261  ..      The stra
-000011c0: 7465 6779 2063 616e 2062 6520 6569 7468  tegy can be eith
-000011d0: 6572 2060 6072 6570 6c61 6365 6060 206f  er ``replace`` o
-000011e0: 7220 6060 6164 6469 7469 7665 6060 2e20  r ``additive``. 
-000011f0: 466f 7220 6675 7274 6865 7220 6465 7461  For further deta
-00001200: 696c 7320 6f6e 2074 686f 7365 2073 7472  ils on those str
-00001210: 6174 6567 6965 732c 2072 6566 6572 0a20  ategies, refer. 
-00001220: 2020 2020 2074 6f20 6874 7470 733a 2f2f       to https://
-00001230: 7079 7069 2e6f 7267 2f70 726f 6a65 6374  pypi.org/project
-00001240: 2f6d 6572 6765 6465 6570 2f0a 2020 2020  /mergedeep/.    
-00001250: 2222 220a 0a20 2020 206b 696e 6420 3d20  """..    kind = 
-00001260: 2268 7474 7022 0a20 2020 2023 2062 7920  "http".    # by 
-00001270: 6465 6661 756c 7420 7765 2064 6f6e 2774  default we don't
-00001280: 2072 6574 7279 206f 6e20 504f 5354 2072   retry on POST r
-00001290: 6571 7565 7374 2061 7320 7468 6579 2061  equest as they a
-000012a0: 7265 2075 7375 616c 6c79 206e 6f74 2069  re usually not i
-000012b0: 6465 6d70 6f74 656e 740a 2020 2020 2320  dempotent.    # 
-000012c0: 6865 7265 2069 7320 6120 6c69 7374 206f  here is a list o
-000012d0: 6620 6964 656e 7469 6669 6564 2050 4f53  f identified POS
-000012e0: 5420 7265 7175 6573 7473 2074 6861 7420  T requests that 
-000012f0: 6172 6520 6964 656d 706f 7465 6e74 2028  are idempotent (
-00001300: 2773 746f 7265 2720 7673 2027 6372 6561  'store' vs 'crea
-00001310: 7465 2729 2061 6e64 2063 616e 2062 6520  te') and can be 
-00001320: 7265 7472 6965 640a 2020 2020 5245 5452  retried.    RETR
-00001330: 4941 424c 455f 504f 5354 5f50 4154 4853  IABLE_POST_PATHS
-00001340: 203d 205b 0a20 2020 2020 2020 2072 225c   = [.        r"\
-00001350: 2f3f 7072 6f6a 6563 7473 5c2f 2e2b 5c2f  /?projects\/.+\/
-00001360: 6172 7469 6661 6374 735c 2f2e 2b5c 2f2e  artifacts\/.+\/.
-00001370: 2b22 2c0a 2020 2020 2020 2020 7222 5c2f  +",.        r"\/
-00001380: 3f72 756e 5c2f 2e2b 5c2f 2e2b 222c 0a20  ?run\/.+\/.+",. 
-00001390: 2020 205d 0a0a 2020 2020 6465 6620 5f5f     ]..    def __
-000013a0: 696e 6974 5f5f 2873 656c 662c 2075 726c  init__(self, url
-000013b0: 293a 0a20 2020 2020 2020 2073 656c 662e  ):.        self.
-000013c0: 7365 7276 6572 5f76 6572 7369 6f6e 203d  server_version =
-000013d0: 2022 220a 2020 2020 2020 2020 7365 6c66   "".        self
-000013e0: 2e73 6573 7369 6f6e 203d 204e 6f6e 650a  .session = None.
-000013f0: 2020 2020 2020 2020 7365 6c66 2e5f 7761          self._wa
-00001400: 6974 5f66 6f72 5f70 726f 6a65 6374 5f74  it_for_project_t
-00001410: 6572 6d69 6e61 6c5f 7374 6174 655f 7265  erminal_state_re
-00001420: 7472 795f 696e 7465 7276 616c 203d 2033  try_interval = 3
-00001430: 0a20 2020 2020 2020 2073 656c 662e 5f77  .        self._w
-00001440: 6169 745f 666f 725f 6261 636b 6772 6f75  ait_for_backgrou
-00001450: 6e64 5f74 6173 6b5f 7465 726d 696e 616c  nd_task_terminal
-00001460: 5f73 7461 7465 5f72 6574 7279 5f69 6e74  _state_retry_int
-00001470: 6572 7661 6c20 3d20 330a 2020 2020 2020  erval = 3.      
-00001480: 2020 7365 6c66 2e5f 7761 6974 5f66 6f72    self._wait_for
-00001490: 5f70 726f 6a65 6374 5f64 656c 6574 696f  _project_deletio
-000014a0: 6e5f 696e 7465 7276 616c 203d 2033 0a20  n_interval = 3. 
-000014b0: 2020 2020 2020 2073 656c 662e 636c 6965         self.clie
-000014c0: 6e74 5f76 6572 7369 6f6e 203d 2076 6572  nt_version = ver
-000014d0: 7369 6f6e 2e56 6572 7369 6f6e 2829 2e67  sion.Version().g
-000014e0: 6574 2829 5b22 7665 7273 696f 6e22 5d0a  et()["version"].
-000014f0: 2020 2020 2020 2020 7365 6c66 2e70 7974          self.pyt
-00001500: 686f 6e5f 7665 7273 696f 6e20 3d20 7374  hon_version = st
-00001510: 7228 7665 7273 696f 6e2e 5665 7273 696f  r(version.Versio
-00001520: 6e28 292e 6765 745f 7079 7468 6f6e 5f76  n().get_python_v
-00001530: 6572 7369 6f6e 2829 290a 0a20 2020 2020  ersion())..     
-00001540: 2020 2073 656c 662e 5f65 6e72 6963 685f     self._enrich_
-00001550: 616e 645f 7661 6c69 6461 7465 2875 726c  and_validate(url
-00001560: 290a 0a20 2020 2064 6566 205f 656e 7269  )..    def _enri
-00001570: 6368 5f61 6e64 5f76 616c 6964 6174 6528  ch_and_validate(
-00001580: 7365 6c66 2c20 7572 6c29 3a0a 2020 2020  self, url):.    
-00001590: 2020 2020 7061 7273 6564 5f75 726c 203d      parsed_url =
-000015a0: 2075 726c 7061 7273 6528 7572 6c29 0a20   urlparse(url). 
-000015b0: 2020 2020 2020 2073 6368 656d 6520 3d20         scheme = 
-000015c0: 7061 7273 6564 5f75 726c 2e73 6368 656d  parsed_url.schem
-000015d0: 652e 6c6f 7765 7228 290a 2020 2020 2020  e.lower().      
-000015e0: 2020 6966 2073 6368 656d 6520 6e6f 7420    if scheme not 
-000015f0: 696e 2028 2268 7474 7022 2c20 2268 7474  in ("http", "htt
-00001600: 7073 2229 3a0a 2020 2020 2020 2020 2020  ps"):.          
-00001610: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-00001620: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-00001630: 2020 2020 6622 496e 7661 6c69 6420 5552      f"Invalid UR
-00001640: 4c20 7363 6865 6d65 207b 7363 6865 6d65  L scheme {scheme
-00001650: 7d20 666f 7220 4854 5450 5275 6e44 422c  } for HTTPRunDB,
-00001660: 206f 6e6c 7920 6874 7470 2873 2920 6973   only http(s) is
-00001670: 2073 7570 706f 7274 6564 220a 2020 2020   supported".    
-00001680: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-00001690: 2020 2065 6e64 706f 696e 7420 3d20 7061     endpoint = pa
-000016a0: 7273 6564 5f75 726c 2e68 6f73 746e 616d  rsed_url.hostnam
-000016b0: 650a 2020 2020 2020 2020 6966 2070 6172  e.        if par
-000016c0: 7365 645f 7572 6c2e 706f 7274 3a0a 2020  sed_url.port:.  
-000016d0: 2020 2020 2020 2020 2020 656e 6470 6f69            endpoi
-000016e0: 6e74 202b 3d20 6622 3a7b 7061 7273 6564  nt += f":{parsed
-000016f0: 5f75 726c 2e70 6f72 747d 220a 2020 2020  _url.port}".    
-00001700: 2020 2020 6261 7365 5f75 726c 203d 2066      base_url = f
-00001710: 227b 7061 7273 6564 5f75 726c 2e73 6368  "{parsed_url.sch
-00001720: 656d 657d 3a2f 2f7b 656e 6470 6f69 6e74  eme}://{endpoint
-00001730: 7d7b 7061 7273 6564 5f75 726c 2e70 6174  }{parsed_url.pat
-00001740: 687d 220a 0a20 2020 2020 2020 2075 7365  h}"..        use
-00001750: 726e 616d 6520 3d20 7061 7273 6564 5f75  rname = parsed_u
-00001760: 726c 2e75 7365 726e 616d 6520 6f72 2063  rl.username or c
-00001770: 6f6e 6669 672e 6874 7470 6462 2e75 7365  onfig.httpdb.use
-00001780: 720a 2020 2020 2020 2020 7061 7373 776f  r.        passwo
-00001790: 7264 203d 2070 6172 7365 645f 7572 6c2e  rd = parsed_url.
-000017a0: 7061 7373 776f 7264 206f 7220 636f 6e66  password or conf
-000017b0: 6967 2e68 7474 7064 622e 7061 7373 776f  ig.httpdb.passwo
-000017c0: 7264 0a0a 2020 2020 2020 2020 7573 6572  rd..        user
-000017d0: 6e61 6d65 2c20 7061 7373 776f 7264 2c20  name, password, 
-000017e0: 746f 6b65 6e20 3d20 6d6c 7275 6e2e 706c  token = mlrun.pl
-000017f0: 6174 666f 726d 732e 6164 645f 6f72 5f72  atforms.add_or_r
-00001800: 6566 7265 7368 5f63 7265 6465 6e74 6961  efresh_credentia
-00001810: 6c73 280a 2020 2020 2020 2020 2020 2020  ls(.            
-00001820: 7061 7273 6564 5f75 726c 2e68 6f73 746e  parsed_url.hostn
-00001830: 616d 652c 2075 7365 726e 616d 652c 2070  ame, username, p
-00001840: 6173 7377 6f72 642c 2063 6f6e 6669 672e  assword, config.
-00001850: 6874 7470 6462 2e74 6f6b 656e 0a20 2020  httpdb.token.   
-00001860: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-00001870: 7365 6c66 2e62 6173 655f 7572 6c20 3d20  self.base_url = 
-00001880: 6261 7365 5f75 726c 0a20 2020 2020 2020  base_url.       
-00001890: 2073 656c 662e 7573 6572 203d 2075 7365   self.user = use
-000018a0: 726e 616d 650a 2020 2020 2020 2020 7365  rname.        se
-000018b0: 6c66 2e70 6173 7377 6f72 6420 3d20 7061  lf.password = pa
-000018c0: 7373 776f 7264 0a20 2020 2020 2020 2073  ssword.        s
-000018d0: 656c 662e 746f 6b65 6e20 3d20 746f 6b65  elf.token = toke
-000018e0: 6e0a 0a20 2020 2064 6566 205f 5f72 6570  n..    def __rep
-000018f0: 725f 5f28 7365 6c66 293a 0a20 2020 2020  r__(self):.     
-00001900: 2020 2063 6c73 203d 2073 656c 662e 5f5f     cls = self.__
-00001910: 636c 6173 735f 5f2e 5f5f 6e61 6d65 5f5f  class__.__name__
-00001920: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00001930: 6622 7b63 6c73 7d28 7b73 656c 662e 6261  f"{cls}({self.ba
-00001940: 7365 5f75 726c 2172 7d29 220a 0a20 2020  se_url!r})"..   
-00001950: 2040 7374 6174 6963 6d65 7468 6f64 0a20   @staticmethod. 
-00001960: 2020 2064 6566 2067 6574 5f61 7069 5f70     def get_api_p
-00001970: 6174 685f 7072 6566 6978 2876 6572 7369  ath_prefix(versi
-00001980: 6f6e 3a20 7374 7220 3d20 4e6f 6e65 2920  on: str = None) 
-00001990: 2d3e 2073 7472 3a0a 2020 2020 2020 2020  -> str:.        
-000019a0: 2222 220a 2020 2020 2020 2020 3a70 6172  """.        :par
-000019b0: 616d 2076 6572 7369 6f6e 3a20 4150 4920  am version: API 
-000019c0: 7665 7273 696f 6e20 746f 2075 7365 2c20  version to use, 
-000019d0: 4e6f 6e65 2028 7468 6520 6465 6661 756c  None (the defaul
-000019e0: 7429 2077 696c 6c20 6d65 616e 2074 6f20  t) will mean to 
-000019f0: 7573 6520 7468 6520 6465 6661 756c 7420  use the default 
-00001a00: 7661 6c75 6520 6672 6f6d 206d 6c72 756e  value from mlrun
-00001a10: 2e63 6f6e 6669 672c 0a20 2020 2020 2020  .config,.       
-00001a20: 2020 666f 7220 756e 2d76 6572 7369 6f6e    for un-version
-00001a30: 6564 2061 7069 2073 6574 2061 6e20 656d  ed api set an em
-00001a40: 7074 7920 7374 7269 6e67 2e0a 2020 2020  pty string..    
-00001a50: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00001a60: 6966 2076 6572 7369 6f6e 2069 7320 6e6f  if version is no
-00001a70: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-00001a80: 2020 2020 7265 7475 726e 2066 2261 7069      return f"api
-00001a90: 2f7b 7665 7273 696f 6e7d 2220 6966 2076  /{version}" if v
-00001aa0: 6572 7369 6f6e 2065 6c73 6520 2261 7069  ersion else "api
-00001ab0: 220a 0a20 2020 2020 2020 2061 7069 5f76  "..        api_v
-00001ac0: 6572 7369 6f6e 5f70 6174 6820 3d20 280a  ersion_path = (.
-00001ad0: 2020 2020 2020 2020 2020 2020 6622 6170              f"ap
-00001ae0: 692f 7b63 6f6e 6669 672e 6170 695f 6261  i/{config.api_ba
-00001af0: 7365 5f76 6572 7369 6f6e 7d22 2069 6620  se_version}" if 
-00001b00: 636f 6e66 6967 2e61 7069 5f62 6173 655f  config.api_base_
-00001b10: 7665 7273 696f 6e20 656c 7365 2022 6170  version else "ap
-00001b20: 6922 0a20 2020 2020 2020 2029 0a20 2020  i".        ).   
-00001b30: 2020 2020 2072 6574 7572 6e20 6170 695f       return api_
-00001b40: 7665 7273 696f 6e5f 7061 7468 0a0a 2020  version_path..  
-00001b50: 2020 6465 6620 6765 745f 6261 7365 5f61    def get_base_a
-00001b60: 7069 5f75 726c 2873 656c 662c 2070 6174  pi_url(self, pat
-00001b70: 683a 2073 7472 2c20 7665 7273 696f 6e3a  h: str, version:
-00001b80: 2073 7472 203d 204e 6f6e 6529 202d 3e20   str = None) -> 
-00001b90: 7374 723a 0a20 2020 2020 2020 2070 6174  str:.        pat
-00001ba0: 685f 7072 6566 6978 203d 2073 656c 662e  h_prefix = self.
-00001bb0: 6765 745f 6170 695f 7061 7468 5f70 7265  get_api_path_pre
-00001bc0: 6669 7828 7665 7273 696f 6e29 0a20 2020  fix(version).   
-00001bd0: 2020 2020 2075 726c 203d 2066 227b 7365       url = f"{se
-00001be0: 6c66 2e62 6173 655f 7572 6c7d 2f7b 7061  lf.base_url}/{pa
-00001bf0: 7468 5f70 7265 6669 787d 2f7b 7061 7468  th_prefix}/{path
-00001c00: 7d22 0a20 2020 2020 2020 2072 6574 7572  }".        retur
-00001c10: 6e20 7572 6c0a 0a20 2020 2064 6566 2061  n url..    def a
-00001c20: 7069 5f63 616c 6c28 0a20 2020 2020 2020  pi_call(.       
-00001c30: 2073 656c 662c 0a20 2020 2020 2020 206d   self,.        m
-00001c40: 6574 686f 642c 0a20 2020 2020 2020 2070  ethod,.        p
-00001c50: 6174 682c 0a20 2020 2020 2020 2065 7272  ath,.        err
-00001c60: 6f72 3d4e 6f6e 652c 0a20 2020 2020 2020  or=None,.       
-00001c70: 2070 6172 616d 733d 4e6f 6e65 2c0a 2020   params=None,.  
-00001c80: 2020 2020 2020 626f 6479 3d4e 6f6e 652c        body=None,
-00001c90: 0a20 2020 2020 2020 206a 736f 6e3d 4e6f  .        json=No
-00001ca0: 6e65 2c0a 2020 2020 2020 2020 6865 6164  ne,.        head
-00001cb0: 6572 733d 4e6f 6e65 2c0a 2020 2020 2020  ers=None,.      
-00001cc0: 2020 7469 6d65 6f75 743d 3435 2c0a 2020    timeout=45,.  
-00001cd0: 2020 2020 2020 7665 7273 696f 6e3d 4e6f        version=No
-00001ce0: 6e65 2c0a 2020 2020 293a 0a20 2020 2020  ne,.    ):.     
-00001cf0: 2020 2022 2222 5065 7266 6f72 6d20 6120     """Perform a 
-00001d00: 6469 7265 6374 2052 4553 5420 4150 4920  direct REST API 
-00001d10: 6361 6c6c 206f 6e20 7468 6520 3a70 793a  call on the :py:
-00001d20: 6d6f 643a 606d 6c72 756e 6020 4150 4920  mod:`mlrun` API 
-00001d30: 7365 7276 6572 2e0a 0a20 2020 2020 2020  server...       
-00001d40: 2043 6175 7469 6f6e 3a0a 2020 2020 2020   Caution:.      
-00001d50: 2020 2020 2020 466f 7220 6164 7661 6e63        For advanc
-00001d60: 6564 2075 7361 6765 202d 2070 7265 6665  ed usage - prefe
-00001d70: 7220 7573 696e 6720 7468 6520 7661 7269  r using the vari
-00001d80: 6f75 7320 4150 4973 2065 7870 6f73 6564  ous APIs exposed
-00001d90: 2074 6872 6f75 6768 2074 6869 7320 636c   through this cl
-00001da0: 6173 732c 2072 6174 6865 7220 7468 616e  ass, rather than
-00001db0: 0a20 2020 2020 2020 2020 2020 2064 6972  .            dir
-00001dc0: 6563 746c 7920 696e 766f 6b69 6e67 2052  ectly invoking R
-00001dd0: 4553 5420 6361 6c6c 732e 0a0a 2020 2020  EST calls...    
-00001de0: 2020 2020 3a70 6172 616d 206d 6574 686f      :param metho
-00001df0: 643a 2052 4553 5420 6d65 7468 6f64 2028  d: REST method (
-00001e00: 504f 5354 2c20 4745 542c 2050 5554 2e2e  POST, GET, PUT..
-00001e10: 2e29 0a20 2020 2020 2020 203a 7061 7261  .).        :para
-00001e20: 6d20 7061 7468 3a20 5061 7468 2074 6f20  m path: Path to 
-00001e30: 656e 6470 6f69 6e74 2065 7865 6375 7465  endpoint execute
-00001e40: 642c 2066 6f72 2065 7861 6d70 6c65 2060  d, for example `
-00001e50: 6022 7072 6f6a 6563 7473 2260 600a 2020  `"projects"``.  
-00001e60: 2020 2020 2020 3a70 6172 616d 2065 7272        :param err
-00001e70: 6f72 3a20 4572 726f 7220 746f 2072 6574  or: Error to ret
-00001e80: 7572 6e20 6966 2041 5049 2069 6e76 6f63  urn if API invoc
-00001e90: 6174 696f 6e20 6661 696c 730a 2020 2020  ation fails.    
-00001ea0: 2020 2020 3a70 6172 616d 2070 6172 616d      :param param
-00001eb0: 733a 2052 6573 7420 7061 7261 6d65 7465  s: Rest paramete
-00001ec0: 7273 2c20 7061 7373 6564 2061 7320 6120  rs, passed as a 
-00001ed0: 6469 6374 696f 6e61 7279 3a20 6060 7b22  dictionary: ``{"
-00001ee0: 3c70 6172 616d 2d6e 616d 653e 223a 203c  <param-name>": <
-00001ef0: 2270 6172 616d 2d76 616c 7565 223e 7d60  "param-value">}`
-00001f00: 600a 2020 2020 2020 2020 3a70 6172 616d  `.        :param
-00001f10: 2062 6f64 793a 2050 6179 6c6f 6164 2074   body: Payload t
-00001f20: 6f20 6265 2070 6173 7365 6420 696e 2074  o be passed in t
-00001f30: 6865 2063 616c 6c2e 2049 6620 7573 696e  he call. If usin
-00001f40: 6720 4a53 4f4e 206f 626a 6563 7473 2c20  g JSON objects, 
-00001f50: 7072 6566 6572 2075 7369 6e67 2074 6865  prefer using the
-00001f60: 2060 606a 736f 6e60 6020 7061 7261 6d0a   ``json`` param.
-00001f70: 2020 2020 2020 2020 3a70 6172 616d 206a          :param j
-00001f80: 736f 6e3a 204a 534f 4e20 7061 796c 6f61  son: JSON payloa
-00001f90: 6420 746f 2062 6520 7061 7373 6564 2069  d to be passed i
-00001fa0: 6e20 7468 6520 6361 6c6c 0a20 2020 2020  n the call.     
-00001fb0: 2020 203a 7061 7261 6d20 6865 6164 6572     :param header
-00001fc0: 733a 2052 4553 5420 6865 6164 6572 732c  s: REST headers,
-00001fd0: 2070 6173 7365 6420 6173 2061 2064 6963   passed as a dic
-00001fe0: 7469 6f6e 6172 793a 2060 607b 223c 6865  tionary: ``{"<he
-00001ff0: 6164 6572 2d6e 616d 653e 223a 2022 3c68  ader-name>": "<h
-00002000: 6561 6465 722d 7661 6c75 653e 227d 6060  eader-value>"}``
-00002010: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00002020: 7469 6d65 6f75 743a 2041 5049 2063 616c  timeout: API cal
-00002030: 6c20 7469 6d65 6f75 740a 2020 2020 2020  l timeout.      
-00002040: 2020 3a70 6172 616d 2076 6572 7369 6f6e    :param version
-00002050: 3a20 4150 4920 7665 7273 696f 6e20 746f  : API version to
-00002060: 2075 7365 2c20 4e6f 6e65 2028 7468 6520   use, None (the 
-00002070: 6465 6661 756c 7429 2077 696c 6c20 6d65  default) will me
-00002080: 616e 2074 6f20 7573 6520 7468 6520 6465  an to use the de
-00002090: 6661 756c 7420 7661 6c75 6520 6672 6f6d  fault value from
-000020a0: 2063 6f6e 6669 672c 0a20 2020 2020 2020   config,.       
-000020b0: 2020 666f 7220 756e 2d76 6572 7369 6f6e    for un-version
-000020c0: 6564 2061 7069 2073 6574 2061 6e20 656d  ed api set an em
-000020d0: 7074 7920 7374 7269 6e67 2e0a 0a20 2020  pty string...   
-000020e0: 2020 2020 203a 7265 7475 726e 3a20 5079       :return: Py
-000020f0: 7468 6f6e 2048 5454 5020 7265 7370 6f6e  thon HTTP respon
-00002100: 7365 206f 626a 6563 740a 2020 2020 2020  se object.      
-00002110: 2020 2222 220a 2020 2020 2020 2020 7572    """.        ur
-00002120: 6c20 3d20 7365 6c66 2e67 6574 5f62 6173  l = self.get_bas
-00002130: 655f 6170 695f 7572 6c28 7061 7468 2c20  e_api_url(path, 
-00002140: 7665 7273 696f 6e29 0a20 2020 2020 2020  version).       
-00002150: 206b 7720 3d20 7b0a 2020 2020 2020 2020   kw = {.        
-00002160: 2020 2020 6b65 793a 2076 616c 7565 0a20      key: value. 
-00002170: 2020 2020 2020 2020 2020 2066 6f72 206b             for k
-00002180: 6579 2c20 7661 6c75 6520 696e 2028 0a20  ey, value in (. 
-00002190: 2020 2020 2020 2020 2020 2020 2020 2028                 (
-000021a0: 2270 6172 616d 7322 2c20 7061 7261 6d73  "params", params
-000021b0: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-000021c0: 2020 2028 2264 6174 6122 2c20 626f 6479     ("data", body
-000021d0: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-000021e0: 2020 2028 226a 736f 6e22 2c20 6a73 6f6e     ("json", json
-000021f0: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-00002200: 2020 2028 2268 6561 6465 7273 222c 2068     ("headers", h
-00002210: 6561 6465 7273 292c 0a20 2020 2020 2020  eaders),.       
-00002220: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-00002230: 2020 2069 6620 7661 6c75 6520 6973 206e     if value is n
-00002240: 6f74 204e 6f6e 650a 2020 2020 2020 2020  ot None.        
-00002250: 7d0a 0a20 2020 2020 2020 2069 6620 7365  }..        if se
-00002260: 6c66 2e75 7365 723a 0a20 2020 2020 2020  lf.user:.       
-00002270: 2020 2020 206b 775b 2261 7574 6822 5d20       kw["auth"] 
-00002280: 3d20 2873 656c 662e 7573 6572 2c20 7365  = (self.user, se
-00002290: 6c66 2e70 6173 7377 6f72 6429 0a20 2020  lf.password).   
-000022a0: 2020 2020 2065 6c69 6620 7365 6c66 2e74       elif self.t
-000022b0: 6f6b 656e 3a0a 2020 2020 2020 2020 2020  oken:.          
-000022c0: 2020 2320 4967 7561 7a69 6f20 6175 7468    # Iguazio auth
-000022d0: 2064 6f65 736e 2774 2073 7570 706f 7274   doesn't support
-000022e0: 2070 6173 7369 6e67 2074 6f6b 656e 2074   passing token t
-000022f0: 6872 6f75 6768 2062 6561 7265 722c 2073  hrough bearer, s
-00002300: 6f20 7573 6520 636f 6f6b 6965 2069 6e73  o use cookie ins
-00002310: 7465 6164 0a20 2020 2020 2020 2020 2020  tead.           
-00002320: 2069 6620 6d6c 7275 6e2e 706c 6174 666f   if mlrun.platfo
-00002330: 726d 732e 6967 7561 7a69 6f2e 6973 5f69  rms.iguazio.is_i
-00002340: 6775 617a 696f 5f73 6573 7369 6f6e 2873  guazio_session(s
-00002350: 656c 662e 746f 6b65 6e29 3a0a 2020 2020  elf.token):.    
-00002360: 2020 2020 2020 2020 2020 2020 7365 7373              sess
-00002370: 696f 6e5f 636f 6f6b 6965 203d 2066 276a  ion_cookie = f'j
-00002380: 3a7b 7b22 7369 6422 3a20 227b 7365 6c66  :{{"sid": "{self
-00002390: 2e74 6f6b 656e 7d22 7d7d 270a 2020 2020  .token}"}}'.    
-000023a0: 2020 2020 2020 2020 2020 2020 636f 6f6b              cook
-000023b0: 6965 7320 3d20 7b0a 2020 2020 2020 2020  ies = {.        
-000023c0: 2020 2020 2020 2020 2020 2020 2273 6573              "ses
-000023d0: 7369 6f6e 223a 2073 6573 7369 6f6e 5f63  sion": session_c
-000023e0: 6f6f 6b69 652c 0a20 2020 2020 2020 2020  ookie,.         
-000023f0: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
-00002400: 2020 2020 2020 2020 206b 775b 2263 6f6f           kw["coo
-00002410: 6b69 6573 225d 203d 2063 6f6f 6b69 6573  kies"] = cookies
-00002420: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-00002430: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00002440: 2020 2069 6620 2241 7574 686f 7269 7a61     if "Authoriza
-00002450: 7469 6f6e 2220 6e6f 7420 696e 206b 772e  tion" not in kw.
-00002460: 7365 7464 6566 6175 6c74 2822 6865 6164  setdefault("head
-00002470: 6572 7322 2c20 7b7d 293a 0a20 2020 2020  ers", {}):.     
-00002480: 2020 2020 2020 2020 2020 2020 2020 206b                 k
-00002490: 775b 2268 6561 6465 7273 225d 2e75 7064  w["headers"].upd
-000024a0: 6174 6528 7b22 4175 7468 6f72 697a 6174  ate({"Authorizat
-000024b0: 696f 6e22 3a20 2242 6561 7265 7220 2220  ion": "Bearer " 
-000024c0: 2b20 7365 6c66 2e74 6f6b 656e 7d29 0a0a  + self.token})..
-000024d0: 2020 2020 2020 2020 6966 206d 6c72 756e          if mlrun
-000024e0: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
-000024f0: 4865 6164 6572 4e61 6d65 732e 636c 6965  HeaderNames.clie
-00002500: 6e74 5f76 6572 7369 6f6e 206e 6f74 2069  nt_version not i
-00002510: 6e20 6b77 2e73 6574 6465 6661 756c 7428  n kw.setdefault(
-00002520: 0a20 2020 2020 2020 2020 2020 2022 6865  .            "he
-00002530: 6164 6572 7322 2c20 7b7d 0a20 2020 2020  aders", {}.     
-00002540: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
-00002550: 2020 6b77 5b22 6865 6164 6572 7322 5d2e    kw["headers"].
-00002560: 7570 6461 7465 280a 2020 2020 2020 2020  update(.        
-00002570: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
-00002580: 2020 2020 2020 2020 2020 2020 2020 6d6c                ml
-00002590: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
-000025a0: 6173 2e48 6561 6465 724e 616d 6573 2e63  as.HeaderNames.c
-000025b0: 6c69 656e 745f 7665 7273 696f 6e3a 2073  lient_version: s
-000025c0: 656c 662e 636c 6965 6e74 5f76 6572 7369  elf.client_versi
-000025d0: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
-000025e0: 2020 2020 2020 2020 6d6c 7275 6e2e 636f          mlrun.co
-000025f0: 6d6d 6f6e 2e73 6368 656d 6173 2e48 6561  mmon.schemas.Hea
-00002600: 6465 724e 616d 6573 2e70 7974 686f 6e5f  derNames.python_
-00002610: 7665 7273 696f 6e3a 2073 656c 662e 7079  version: self.py
-00002620: 7468 6f6e 5f76 6572 7369 6f6e 2c0a 2020  thon_version,.  
-00002630: 2020 2020 2020 2020 2020 2020 2020 7d0a                }.
-00002640: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-00002650: 2020 2020 2020 2023 2072 6571 7565 7374         # request
-00002660: 7320 6e6f 206c 6f6e 6765 7220 7375 7070  s no longer supp
-00002670: 6f72 7473 2068 6561 6465 7220 7661 6c75  orts header valu
-00002680: 6573 2074 6f20 6265 2065 6e75 6d20 2868  es to be enum (h
-00002690: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
-000026a0: 6d2f 7073 662f 7265 7175 6573 7473 2f70  m/psf/requests/p
-000026b0: 756c 6c2f 3631 3534 290a 2020 2020 2020  ull/6154).      
-000026c0: 2020 2320 636f 6e76 6572 7420 746f 2073    # convert to s
-000026d0: 7472 696e 6773 2e20 446f 2074 6865 2073  trings. Do the s
-000026e0: 616d 6520 666f 7220 7061 7261 6d73 2066  ame for params f
-000026f0: 6f72 206e 6963 656e 6573 730a 2020 2020  or niceness.    
-00002700: 2020 2020 666f 7220 6469 6374 5f20 696e      for dict_ in
-00002710: 205b 6865 6164 6572 732c 2070 6172 616d   [headers, param
-00002720: 735d 3a0a 2020 2020 2020 2020 2020 2020  s]:.            
-00002730: 6966 2064 6963 745f 2069 7320 6e6f 7420  if dict_ is not 
-00002740: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-00002750: 2020 2020 2020 666f 7220 6b65 7920 696e        for key in
-00002760: 2064 6963 745f 2e6b 6579 7328 293a 0a20   dict_.keys():. 
-00002770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002780: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-00002790: 2864 6963 745f 5b6b 6579 5d2c 2065 6e75  (dict_[key], enu
-000027a0: 6d2e 456e 756d 293a 0a20 2020 2020 2020  m.Enum):.       
-000027b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000027c0: 2064 6963 745f 5b6b 6579 5d20 3d20 6469   dict_[key] = di
-000027d0: 6374 5f5b 6b65 795d 2e76 616c 7565 0a0a  ct_[key].value..
-000027e0: 2020 2020 2020 2020 2320 6966 2074 6865          # if the
-000027f0: 206d 6574 686f 6420 6973 2050 4f53 542c   method is POST,
-00002800: 2077 6520 6e65 6564 2074 6f20 7570 6461   we need to upda
-00002810: 7465 2074 6865 2073 6573 7369 6f6e 2077  te the session w
-00002820: 6974 6820 7468 6520 6170 7072 6f70 7269  ith the appropri
-00002830: 6174 6520 7265 7472 7920 706f 6c69 6379  ate retry policy
-00002840: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-00002850: 7365 6c66 2e73 6573 7369 6f6e 206f 7220  self.session or 
-00002860: 6d65 7468 6f64 203d 3d20 2250 4f53 5422  method == "POST"
-00002870: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00002880: 7472 795f 6f6e 5f70 6f73 7420 3d20 7365  try_on_post = se
-00002890: 6c66 2e5f 6973 5f72 6574 7279 5f6f 6e5f  lf._is_retry_on_
-000028a0: 706f 7374 5f61 6c6c 6f77 6564 286d 6574  post_allowed(met
-000028b0: 686f 642c 2070 6174 6829 0a20 2020 2020  hod, path).     
-000028c0: 2020 2020 2020 2073 656c 662e 7365 7373         self.sess
-000028d0: 696f 6e20 3d20 7365 6c66 2e5f 696e 6974  ion = self._init
-000028e0: 5f73 6573 7369 6f6e 2872 6574 7279 5f6f  _session(retry_o
-000028f0: 6e5f 706f 7374 290a 0a20 2020 2020 2020  n_post)..       
-00002900: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
-00002910: 2020 7265 7370 6f6e 7365 203d 2073 656c    response = sel
-00002920: 662e 7365 7373 696f 6e2e 7265 7175 6573  f.session.reques
-00002930: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
-00002940: 2020 206d 6574 686f 642c 0a20 2020 2020     method,.     
-00002950: 2020 2020 2020 2020 2020 2075 726c 2c0a             url,.
-00002960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002970: 7469 6d65 6f75 743d 7469 6d65 6f75 742c  timeout=timeout,
-00002980: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00002990: 2076 6572 6966 793d 636f 6e66 6967 2e68   verify=config.h
-000029a0: 7474 7064 622e 6874 7470 2e76 6572 6966  ttpdb.http.verif
-000029b0: 792c 0a20 2020 2020 2020 2020 2020 2020  y,.             
-000029c0: 2020 202a 2a6b 772c 0a20 2020 2020 2020     **kw,.       
-000029d0: 2020 2020 2029 0a20 2020 2020 2020 2065       ).        e
-000029e0: 7863 6570 7420 7265 7175 6573 7473 2e52  xcept requests.R
-000029f0: 6571 7565 7374 4578 6365 7074 696f 6e20  equestException 
-00002a00: 6173 2065 7863 3a0a 2020 2020 2020 2020  as exc:.        
-00002a10: 2020 2020 6572 726f 7220 3d20 6622 7b65      error = f"{e
-00002a20: 7272 5f74 6f5f 7374 7228 6578 6329 7d3a  rr_to_str(exc)}:
-00002a30: 207b 6572 726f 727d 2220 6966 2065 7272   {error}" if err
-00002a40: 6f72 2065 6c73 6520 6572 725f 746f 5f73  or else err_to_s
-00002a50: 7472 2865 7863 290a 2020 2020 2020 2020  tr(exc).        
-00002a60: 2020 2020 7261 6973 6520 6d6c 7275 6e2e      raise mlrun.
-00002a70: 6572 726f 7273 2e4d 4c52 756e 5275 6e74  errors.MLRunRunt
-00002a80: 696d 6545 7272 6f72 2865 7272 6f72 2920  imeError(error) 
-00002a90: 6672 6f6d 2065 7863 0a0a 2020 2020 2020  from exc..      
-00002aa0: 2020 6966 206e 6f74 2072 6573 706f 6e73    if not respons
-00002ab0: 652e 6f6b 3a0a 2020 2020 2020 2020 2020  e.ok:.          
-00002ac0: 2020 6966 2072 6573 706f 6e73 652e 636f    if response.co
-00002ad0: 6e74 656e 743a 0a20 2020 2020 2020 2020  ntent:.         
-00002ae0: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
-00002af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002b00: 6461 7461 203d 2072 6573 706f 6e73 652e  data = response.
-00002b10: 6a73 6f6e 2829 0a20 2020 2020 2020 2020  json().         
-00002b20: 2020 2020 2020 2020 2020 2065 7272 6f72             error
-00002b30: 5f64 6574 6169 6c73 203d 2064 6174 612e  _details = data.
-00002b40: 6765 7428 2264 6574 6169 6c22 2c20 7b7d  get("detail", {}
-00002b50: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00002b60: 2020 2020 2020 6966 206e 6f74 2065 7272        if not err
-00002b70: 6f72 5f64 6574 6169 6c73 3a0a 2020 2020  or_details:.    
-00002b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002b90: 2020 2020 6c6f 6767 6572 2e77 6172 6e69      logger.warni
-00002ba0: 6e67 2822 4661 696c 6564 2070 6172 7369  ng("Failed parsi
-00002bb0: 6e67 2065 7272 6f72 2072 6573 706f 6e73  ng error respons
-00002bc0: 6520 626f 6479 222c 2064 6174 613d 6461  e body", data=da
-00002bd0: 7461 290a 2020 2020 2020 2020 2020 2020  ta).            
-00002be0: 2020 2020 6578 6365 7074 2045 7863 6570      except Excep
-00002bf0: 7469 6f6e 3a0a 2020 2020 2020 2020 2020  tion:.          
-00002c00: 2020 2020 2020 2020 2020 6572 726f 725f            error_
-00002c10: 6465 7461 696c 7320 3d20 2222 0a20 2020  details = "".   
-00002c20: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00002c30: 6572 726f 725f 6465 7461 696c 733a 0a20  error_details:. 
-00002c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002c50: 2020 2065 7272 6f72 5f64 6574 6169 6c73     error_details
-00002c60: 203d 2066 2264 6574 6169 6c73 3a20 7b65   = f"details: {e
-00002c70: 7272 6f72 5f64 6574 6169 6c73 7d22 0a20  rror_details}". 
-00002c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002c90: 2020 2065 7272 6f72 203d 2066 227b 6572     error = f"{er
-00002ca0: 726f 727d 207b 6572 726f 725f 6465 7461  ror} {error_deta
-00002cb0: 696c 737d 2220 6966 2065 7272 6f72 2065  ils}" if error e
-00002cc0: 6c73 6520 6572 726f 725f 6465 7461 696c  lse error_detail
-00002cd0: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
-00002ce0: 2020 2020 2020 6d6c 7275 6e2e 6572 726f        mlrun.erro
-00002cf0: 7273 2e72 6169 7365 5f66 6f72 5f73 7461  rs.raise_for_sta
-00002d00: 7475 7328 7265 7370 6f6e 7365 2c20 6572  tus(response, er
-00002d10: 726f 7229 0a0a 2020 2020 2020 2020 2020  ror)..          
-00002d20: 2020 6d6c 7275 6e2e 6572 726f 7273 2e72    mlrun.errors.r
-00002d30: 6169 7365 5f66 6f72 5f73 7461 7475 7328  aise_for_status(
-00002d40: 7265 7370 6f6e 7365 2c20 6572 726f 7229  response, error)
-00002d50: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00002d60: 2072 6573 706f 6e73 650a 0a20 2020 2064   response..    d
-00002d70: 6566 205f 696e 6974 5f73 6573 7369 6f6e  ef _init_session
-00002d80: 2873 656c 662c 2072 6574 7279 5f6f 6e5f  (self, retry_on_
-00002d90: 706f 7374 3a20 626f 6f6c 203d 2046 616c  post: bool = Fal
-00002da0: 7365 293a 0a20 2020 2020 2020 2072 6574  se):.        ret
-00002db0: 7572 6e20 6d6c 7275 6e2e 7574 696c 732e  urn mlrun.utils.
-00002dc0: 4854 5450 5365 7373 696f 6e57 6974 6852  HTTPSessionWithR
-00002dd0: 6574 7279 280a 2020 2020 2020 2020 2020  etry(.          
-00002de0: 2020 7265 7472 795f 6f6e 5f65 7863 6570    retry_on_excep
-00002df0: 7469 6f6e 3d63 6f6e 6669 672e 6874 7470  tion=config.http
-00002e00: 6462 2e72 6574 7279 5f61 7069 5f63 616c  db.retry_api_cal
-00002e10: 6c5f 6f6e 5f65 7863 6570 7469 6f6e 0a20  l_on_exception. 
-00002e20: 2020 2020 2020 2020 2020 203d 3d20 6d6c             == ml
-00002e30: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
-00002e40: 6173 2e48 5454 5053 6573 7369 6f6e 5265  as.HTTPSessionRe
-00002e50: 7472 794d 6f64 652e 656e 6162 6c65 642e  tryMode.enabled.
-00002e60: 7661 6c75 652c 0a20 2020 2020 2020 2020  value,.         
-00002e70: 2020 2072 6574 7279 5f6f 6e5f 706f 7374     retry_on_post
-00002e80: 3d72 6574 7279 5f6f 6e5f 706f 7374 2c0a  =retry_on_post,.
-00002e90: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
-00002ea0: 6566 205f 7061 7468 5f6f 6628 7365 6c66  ef _path_of(self
-00002eb0: 2c20 7265 736f 7572 6365 2c20 7072 6f6a  , resource, proj
-00002ec0: 6563 742c 2075 6964 3d4e 6f6e 6529 3a0a  ect, uid=None):.
-00002ed0: 2020 2020 2020 2020 7072 6f6a 6563 7420          project 
-00002ee0: 3d20 7072 6f6a 6563 7420 6f72 2063 6f6e  = project or con
-00002ef0: 6669 672e 6465 6661 756c 745f 7072 6f6a  fig.default_proj
-00002f00: 6563 740a 2020 2020 2020 2020 5f70 6174  ect.        _pat
-00002f10: 6820 3d20 6622 7072 6f6a 6563 7473 2f7b  h = f"projects/{
-00002f20: 7072 6f6a 6563 747d 2f7b 7265 736f 7572  project}/{resour
-00002f30: 6365 7d22 0a20 2020 2020 2020 2069 6620  ce}".        if 
-00002f40: 7569 643a 0a20 2020 2020 2020 2020 2020  uid:.           
-00002f50: 205f 7061 7468 202b 3d20 6622 2f7b 7569   _path += f"/{ui
-00002f60: 647d 220a 2020 2020 2020 2020 7265 7475  d}".        retu
-00002f70: 726e 205f 7061 7468 0a0a 2020 2020 6465  rn _path..    de
-00002f80: 6620 5f69 735f 7265 7472 795f 6f6e 5f70  f _is_retry_on_p
-00002f90: 6f73 745f 616c 6c6f 7765 6428 7365 6c66  ost_allowed(self
-00002fa0: 2c20 6d65 7468 6f64 2c20 7061 7468 3a20  , method, path: 
-00002fb0: 7374 7229 3a0a 2020 2020 2020 2020 2222  str):.        ""
-00002fc0: 220a 2020 2020 2020 2020 4368 6563 6b20  ".        Check 
-00002fd0: 6966 2074 6865 2067 6976 656e 2070 6174  if the given pat
-00002fe0: 6820 6973 2061 6c6c 6f77 6564 2074 6f20  h is allowed to 
-00002ff0: 6265 2072 6574 7269 6564 206f 6e20 504f  be retried on PO
-00003000: 5354 206d 6574 686f 640a 2020 2020 2020  ST method.      
-00003010: 2020 3a70 6172 616d 206d 6574 686f 643a    :param method:
-00003020: 2020 7573 6564 2074 6f20 7665 7269 6679    used to verify
-00003030: 2074 6861 7420 7468 6520 6d65 7468 6f64   that the method
-00003040: 2069 7320 504f 5354 2073 696e 6365 2069   is POST since i
-00003050: 6620 7468 6572 6520 6973 206e 6f20 7365  f there is no se
-00003060: 7373 696f 6e20 696e 6974 6961 6c69 7a65  ssion initialize
-00003070: 6420 7468 6572 6520 6973 206e 6f0a 2020  d there is no.  
-00003080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003090: 2020 2020 2020 6e65 6564 2074 6f20 696e        need to in
-000030a0: 6974 6961 6c69 7a65 2069 7420 7769 7468  itialize it with
-000030b0: 2072 6574 7279 2070 6f6c 6963 7920 666f   retry policy fo
-000030c0: 7220 504f 5354 2077 6865 6e20 7468 6520  r POST when the 
-000030d0: 6d65 7468 6f64 2069 7320 6e6f 7420 504f  method is not PO
-000030e0: 5354 0a20 2020 2020 2020 203a 7061 7261  ST.        :para
-000030f0: 6d20 7061 7468 3a20 2020 2074 6865 2070  m path:    the p
-00003100: 6174 6820 746f 2063 6865 636b 0a20 2020  ath to check.   
-00003110: 2020 2020 203a 7265 7475 726e 3a20 2020       :return:   
-00003120: 2020 2020 2054 7275 6520 6966 2074 6865       True if the
-00003130: 2070 6174 6820 6973 2061 6c6c 6f77 6564   path is allowed
-00003140: 2074 6f20 6265 2072 6574 7269 6564 206f   to be retried o
-00003150: 6e20 504f 5354 206d 6574 686f 6420 616e  n POST method an
-00003160: 6420 6d65 7468 6f64 2069 7320 504f 5354  d method is POST
-00003170: 2c20 4661 6c73 6520 6f74 6865 7277 6973  , False otherwis
-00003180: 650a 2020 2020 2020 2020 2222 220a 2020  e.        """.  
-00003190: 2020 2020 2020 7265 7475 726e 206d 6574        return met
-000031a0: 686f 6420 3d3d 2022 504f 5354 2220 616e  hod == "POST" an
-000031b0: 6420 616e 7928 0a20 2020 2020 2020 2020  d any(.         
-000031c0: 2020 2072 652e 6d61 7463 6828 7265 6765     re.match(rege
-000031d0: 782c 2070 6174 6829 2066 6f72 2072 6567  x, path) for reg
-000031e0: 6578 2069 6e20 7365 6c66 2e52 4554 5249  ex in self.RETRI
-000031f0: 4142 4c45 5f50 4f53 545f 5041 5448 530a  ABLE_POST_PATHS.
-00003200: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
-00003210: 6566 2063 6f6e 6e65 6374 2873 656c 662c  ef connect(self,
-00003220: 2073 6563 7265 7473 3d4e 6f6e 6529 3a0a   secrets=None):.
-00003230: 2020 2020 2020 2020 2222 2243 6f6e 6e65          """Conne
-00003240: 6374 2074 6f20 7468 6520 4d4c 5275 6e20  ct to the MLRun 
-00003250: 4150 4920 7365 7276 6572 2e20 4d75 7374  API server. Must
-00003260: 2062 6520 6361 6c6c 6564 2070 7269 6f72   be called prior
-00003270: 2074 6f20 6578 6563 7574 696e 6720 616e   to executing an
-00003280: 7920 6f74 6865 7220 6d65 7468 6f64 2e0a  y other method..
-00003290: 2020 2020 2020 2020 5468 6520 636f 6465          The code
-000032a0: 2075 7469 6c69 7a65 7320 7468 6520 5552   utilizes the UR
-000032b0: 4c20 666f 7220 7468 6520 4150 4920 7365  L for the API se
-000032c0: 7276 6572 2066 726f 6d20 7468 6520 636f  rver from the co
-000032d0: 6e66 6967 7572 6174 696f 6e20 2d20 6060  nfiguration - ``
-000032e0: 636f 6e66 6967 2e64 6270 6174 6860 602e  config.dbpath``.
-000032f0: 0a0a 2020 2020 2020 2020 466f 7220 6578  ..        For ex
-00003300: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
-00003310: 2020 2020 2063 6f6e 6669 672e 6462 7061       config.dbpa
-00003320: 7468 203d 2063 6f6e 6669 672e 6462 7061  th = config.dbpa
-00003330: 7468 206f 7220 2768 7474 703a 2f2f 6d6c  th or 'http://ml
-00003340: 7275 6e2d 6170 693a 3830 3830 270a 2020  run-api:8080'.  
-00003350: 2020 2020 2020 2020 2020 6462 203d 2067            db = g
-00003360: 6574 5f72 756e 5f64 6228 292e 636f 6e6e  et_run_db().conn
-00003370: 6563 7428 290a 2020 2020 2020 2020 2222  ect().        ""
-00003380: 220a 2020 2020 2020 2020 2320 6861 636b  ".        # hack
-00003390: 2074 6f20 616c 6c6f 7720 756e 6974 2074   to allow unit t
-000033a0: 6573 7473 2074 6f20 696e 7374 616e 7469  ests to instanti
-000033b0: 6174 6520 4854 5450 5275 6e44 4220 7769  ate HTTPRunDB wi
-000033c0: 7468 6f75 7420 6120 7265 616c 2073 6572  thout a real ser
-000033d0: 7665 7220 6265 6869 6e64 0a20 2020 2020  ver behind.     
-000033e0: 2020 2069 6620 226d 6f63 6b2d 7365 7276     if "mock-serv
-000033f0: 6572 2220 696e 2073 656c 662e 6261 7365  er" in self.base
-00003400: 5f75 726c 3a0a 2020 2020 2020 2020 2020  _url:.          
-00003410: 2020 7265 7475 726e 0a20 2020 2020 2020    return.       
-00003420: 2072 6573 7020 3d20 7365 6c66 2e61 7069   resp = self.api
-00003430: 5f63 616c 6c28 2247 4554 222c 2022 636c  _call("GET", "cl
-00003440: 6965 6e74 2d73 7065 6322 2c20 7469 6d65  ient-spec", time
-00003450: 6f75 743d 3529 0a20 2020 2020 2020 2074  out=5).        t
-00003460: 7279 3a0a 2020 2020 2020 2020 2020 2020  ry:.            
-00003470: 7365 7276 6572 5f63 6667 203d 2072 6573  server_cfg = res
-00003480: 702e 6a73 6f6e 2829 0a20 2020 2020 2020  p.json().       
-00003490: 2020 2020 2073 656c 662e 7365 7276 6572       self.server
-000034a0: 5f76 6572 7369 6f6e 203d 2073 6572 7665  _version = serve
-000034b0: 725f 6366 675b 2276 6572 7369 6f6e 225d  r_cfg["version"]
-000034c0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-000034d0: 662e 5f76 616c 6964 6174 655f 7665 7273  f._validate_vers
-000034e0: 696f 6e5f 636f 6d70 6174 6962 696c 6974  ion_compatibilit
-000034f0: 7928 7365 6c66 2e73 6572 7665 725f 7665  y(self.server_ve
-00003500: 7273 696f 6e2c 2063 6f6e 6669 672e 7665  rsion, config.ve
-00003510: 7273 696f 6e29 0a20 2020 2020 2020 2020  rsion).         
-00003520: 2020 2063 6f6e 6669 672e 6e61 6d65 7370     config.namesp
-00003530: 6163 6520 3d20 636f 6e66 6967 2e6e 616d  ace = config.nam
-00003540: 6573 7061 6365 206f 7220 7365 7276 6572  espace or server
-00003550: 5f63 6667 2e67 6574 2822 6e61 6d65 7370  _cfg.get("namesp
-00003560: 6163 6522 290a 2020 2020 2020 2020 2020  ace").          
-00003570: 2020 6966 2028 0a20 2020 2020 2020 2020    if (.         
-00003580: 2020 2020 2020 2022 6e61 6d65 7370 6163         "namespac
-00003590: 6522 2069 6e20 7365 7276 6572 5f63 6667  e" in server_cfg
-000035a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000035b0: 2061 6e64 2073 6572 7665 725f 6366 675b   and server_cfg[
-000035c0: 226e 616d 6573 7061 6365 225d 2021 3d20  "namespace"] != 
-000035d0: 636f 6e66 6967 2e6e 616d 6573 7061 6365  config.namespace
-000035e0: 0a20 2020 2020 2020 2020 2020 2029 3a0a  .            ):.
-000035f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003600: 6c6f 6767 6572 2e77 6172 6e69 6e67 280a  logger.warning(.
-00003610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003620: 2020 2020 6622 7761 726e 696e 6721 2c20      f"warning!, 
-00003630: 7365 7276 6572 2028 7b73 6572 7665 725f  server ({server_
-00003640: 6366 675b 276e 616d 6573 7061 6365 275d  cfg['namespace']
-00003650: 7d29 2061 6e64 2063 6c69 656e 7420 287b  }) and client ({
-00003660: 636f 6e66 6967 2e6e 616d 6573 7061 6365  config.namespace
-00003670: 7d29 220a 2020 2020 2020 2020 2020 2020  })".            
-00003680: 2020 2020 2020 2020 2220 6e61 6d65 7370          " namesp
-00003690: 6163 6520 646f 6e27 7420 6d61 7463 6822  ace don't match"
-000036a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000036b0: 2029 0a20 2020 2020 2020 2020 2020 2063   ).            c
-000036c0: 6f6e 6669 672e 6365 203d 2073 6572 7665  onfig.ce = serve
-000036d0: 725f 6366 672e 6765 7428 2263 6522 2920  r_cfg.get("ce") 
-000036e0: 6f72 2063 6f6e 6669 672e 6365 0a0a 2020  or config.ce..  
-000036f0: 2020 2020 2020 2020 2020 2320 6765 7420            # get 
-00003700: 6465 6661 756c 7473 2066 726f 6d20 7265  defaults from re
-00003710: 6d6f 7465 2073 6572 7665 720a 2020 2020  mote server.    
-00003720: 2020 2020 2020 2020 636f 6e66 6967 2e72          config.r
-00003730: 656d 6f74 655f 686f 7374 203d 2063 6f6e  emote_host = con
-00003740: 6669 672e 7265 6d6f 7465 5f68 6f73 7420  fig.remote_host 
-00003750: 6f72 2073 6572 7665 725f 6366 672e 6765  or server_cfg.ge
-00003760: 7428 2272 656d 6f74 655f 686f 7374 2229  t("remote_host")
-00003770: 0a20 2020 2020 2020 2020 2020 2063 6f6e  .            con
-00003780: 6669 672e 6d70 696a 6f62 5f63 7264 5f76  fig.mpijob_crd_v
-00003790: 6572 7369 6f6e 203d 2063 6f6e 6669 672e  ersion = config.
-000037a0: 6d70 696a 6f62 5f63 7264 5f76 6572 7369  mpijob_crd_versi
-000037b0: 6f6e 206f 7220 7365 7276 6572 5f63 6667  on or server_cfg
-000037c0: 2e67 6574 280a 2020 2020 2020 2020 2020  .get(.          
-000037d0: 2020 2020 2020 226d 7069 6a6f 625f 6372        "mpijob_cr
-000037e0: 645f 7665 7273 696f 6e22 0a20 2020 2020  d_version".     
-000037f0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00003800: 2020 2020 2063 6f6e 6669 672e 7569 2e75       config.ui.u
-00003810: 726c 203d 2063 6f6e 6669 672e 7265 736f  rl = config.reso
-00003820: 6c76 655f 7569 5f75 726c 2829 206f 7220  lve_ui_url() or 
-00003830: 7365 7276 6572 5f63 6667 2e67 6574 2822  server_cfg.get("
-00003840: 7569 5f75 726c 2229 0a20 2020 2020 2020  ui_url").       
-00003850: 2020 2020 2063 6f6e 6669 672e 6172 7469       config.arti
-00003860: 6661 6374 5f70 6174 6820 3d20 636f 6e66  fact_path = conf
-00003870: 6967 2e61 7274 6966 6163 745f 7061 7468  ig.artifact_path
-00003880: 206f 7220 7365 7276 6572 5f63 6667 2e67   or server_cfg.g
-00003890: 6574 280a 2020 2020 2020 2020 2020 2020  et(.            
-000038a0: 2020 2020 2261 7274 6966 6163 745f 7061      "artifact_pa
-000038b0: 7468 220a 2020 2020 2020 2020 2020 2020  th".            
-000038c0: 290a 2020 2020 2020 2020 2020 2020 636f  ).            co
-000038d0: 6e66 6967 2e73 7061 726b 5f61 7070 5f69  nfig.spark_app_i
-000038e0: 6d61 6765 203d 2063 6f6e 6669 672e 7370  mage = config.sp
-000038f0: 6172 6b5f 6170 705f 696d 6167 6520 6f72  ark_app_image or
-00003900: 2073 6572 7665 725f 6366 672e 6765 7428   server_cfg.get(
-00003910: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00003920: 2022 7370 6172 6b5f 6170 705f 696d 6167   "spark_app_imag
-00003930: 6522 0a20 2020 2020 2020 2020 2020 2029  e".            )
-00003940: 0a20 2020 2020 2020 2020 2020 2063 6f6e  .            con
-00003950: 6669 672e 7370 6172 6b5f 6170 705f 696d  fig.spark_app_im
-00003960: 6167 655f 7461 6720 3d20 636f 6e66 6967  age_tag = config
-00003970: 2e73 7061 726b 5f61 7070 5f69 6d61 6765  .spark_app_image
-00003980: 5f74 6167 206f 7220 7365 7276 6572 5f63  _tag or server_c
-00003990: 6667 2e67 6574 280a 2020 2020 2020 2020  fg.get(.        
-000039a0: 2020 2020 2020 2020 2273 7061 726b 5f61          "spark_a
-000039b0: 7070 5f69 6d61 6765 5f74 6167 220a 2020  pp_image_tag".  
-000039c0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-000039d0: 2020 2020 2020 2020 636f 6e66 6967 2e73          config.s
-000039e0: 7061 726b 5f68 6973 746f 7279 5f73 6572  park_history_ser
-000039f0: 7665 725f 7061 7468 203d 2028 0a20 2020  ver_path = (.   
-00003a00: 2020 2020 2020 2020 2020 2020 2063 6f6e               con
-00003a10: 6669 672e 7370 6172 6b5f 6869 7374 6f72  fig.spark_histor
-00003a20: 795f 7365 7276 6572 5f70 6174 680a 2020  y_server_path.  
-00003a30: 2020 2020 2020 2020 2020 2020 2020 6f72                or
-00003a40: 2073 6572 7665 725f 6366 672e 6765 7428   server_cfg.get(
-00003a50: 2273 7061 726b 5f68 6973 746f 7279 5f73  "spark_history_s
-00003a60: 6572 7665 725f 7061 7468 2229 0a20 2020  erver_path").   
-00003a70: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00003a80: 2020 2020 2020 2063 6f6e 6669 672e 6874         config.ht
-00003a90: 7470 6462 2e62 7569 6c64 6572 2e64 6f63  tpdb.builder.doc
-00003aa0: 6b65 725f 7265 6769 7374 7279 203d 2028  ker_registry = (
-00003ab0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00003ac0: 2063 6f6e 6669 672e 6874 7470 6462 2e62   config.httpdb.b
-00003ad0: 7569 6c64 6572 2e64 6f63 6b65 725f 7265  uilder.docker_re
-00003ae0: 6769 7374 7279 0a20 2020 2020 2020 2020  gistry.         
-00003af0: 2020 2020 2020 206f 7220 7365 7276 6572         or server
-00003b00: 5f63 6667 2e67 6574 2822 646f 636b 6572  _cfg.get("docker
-00003b10: 5f72 6567 6973 7472 7922 290a 2020 2020  _registry").    
-00003b20: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00003b30: 2020 2020 2020 636f 6e66 6967 2e68 7474        config.htt
-00003b40: 7064 622e 6170 695f 7572 6c20 3d20 636f  pdb.api_url = co
-00003b50: 6e66 6967 2e68 7474 7064 622e 6170 695f  nfig.httpdb.api_
-00003b60: 7572 6c20 6f72 2073 6572 7665 725f 6366  url or server_cf
-00003b70: 672e 6765 7428 2261 7069 5f75 726c 2229  g.get("api_url")
-00003b80: 0a20 2020 2020 2020 2020 2020 2063 6f6e  .            con
-00003b90: 6669 672e 6e75 636c 696f 5f76 6572 7369  fig.nuclio_versi
-00003ba0: 6f6e 203d 2063 6f6e 6669 672e 6e75 636c  on = config.nucl
-00003bb0: 696f 5f76 6572 7369 6f6e 206f 7220 7365  io_version or se
-00003bc0: 7276 6572 5f63 6667 2e67 6574 280a 2020  rver_cfg.get(.  
-00003bd0: 2020 2020 2020 2020 2020 2020 2020 226e                "n
-00003be0: 7563 6c69 6f5f 7665 7273 696f 6e22 0a20  uclio_version". 
-00003bf0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00003c00: 2020 2020 2020 2020 2063 6f6e 6669 672e           config.
-00003c10: 6465 6661 756c 745f 6675 6e63 7469 6f6e  default_function
-00003c20: 5f70 7269 6f72 6974 795f 636c 6173 735f  _priority_class_
-00003c30: 6e61 6d65 203d 2028 0a20 2020 2020 2020  name = (.       
-00003c40: 2020 2020 2020 2020 2063 6f6e 6669 672e           config.
-00003c50: 6465 6661 756c 745f 6675 6e63 7469 6f6e  default_function
-00003c60: 5f70 7269 6f72 6974 795f 636c 6173 735f  _priority_class_
-00003c70: 6e61 6d65 0a20 2020 2020 2020 2020 2020  name.           
-00003c80: 2020 2020 206f 7220 7365 7276 6572 5f63       or server_c
-00003c90: 6667 2e67 6574 2822 6465 6661 756c 745f  fg.get("default_
-00003ca0: 6675 6e63 7469 6f6e 5f70 7269 6f72 6974  function_priorit
-00003cb0: 795f 636c 6173 735f 6e61 6d65 2229 0a20  y_class_name"). 
-00003cc0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00003cd0: 2020 2020 2020 2020 2063 6f6e 6669 672e           config.
-00003ce0: 7661 6c69 645f 6675 6e63 7469 6f6e 5f70  valid_function_p
-00003cf0: 7269 6f72 6974 795f 636c 6173 735f 6e61  riority_class_na
-00003d00: 6d65 7320 3d20 280a 2020 2020 2020 2020  mes = (.        
-00003d10: 2020 2020 2020 2020 636f 6e66 6967 2e76          config.v
-00003d20: 616c 6964 5f66 756e 6374 696f 6e5f 7072  alid_function_pr
-00003d30: 696f 7269 7479 5f63 6c61 7373 5f6e 616d  iority_class_nam
-00003d40: 6573 0a20 2020 2020 2020 2020 2020 2020  es.             
-00003d50: 2020 206f 7220 7365 7276 6572 5f63 6667     or server_cfg
-00003d60: 2e67 6574 2822 7661 6c69 645f 6675 6e63  .get("valid_func
-00003d70: 7469 6f6e 5f70 7269 6f72 6974 795f 636c  tion_priority_cl
-00003d80: 6173 735f 6e61 6d65 7322 290a 2020 2020  ass_names").    
-00003d90: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00003da0: 2020 2020 2020 636f 6e66 6967 2e61 7274        config.art
-00003db0: 6966 6163 7473 2e63 616c 6375 6c61 7465  ifacts.calculate
-00003dc0: 5f68 6173 6820 3d20 280a 2020 2020 2020  _hash = (.      
-00003dd0: 2020 2020 2020 2020 2020 636f 6e66 6967            config
-00003de0: 2e61 7274 6966 6163 7473 2e63 616c 6375  .artifacts.calcu
-00003df0: 6c61 7465 5f68 6173 680a 2020 2020 2020  late_hash.      
-00003e00: 2020 2020 2020 2020 2020 6966 2063 6f6e            if con
-00003e10: 6669 672e 6172 7469 6661 6374 732e 6361  fig.artifacts.ca
-00003e20: 6c63 756c 6174 655f 6861 7368 2069 7320  lculate_hash is 
-00003e30: 6e6f 7420 4e6f 6e65 0a20 2020 2020 2020  not None.       
-00003e40: 2020 2020 2020 2020 2065 6c73 6520 7365           else se
-00003e50: 7276 6572 5f63 6667 2e67 6574 2822 6361  rver_cfg.get("ca
-00003e60: 6c63 756c 6174 655f 6172 7469 6661 6374  lculate_artifact
-00003e70: 5f68 6173 6822 290a 2020 2020 2020 2020  _hash").        
-00003e80: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-00003e90: 2020 636f 6e66 6967 2e61 7274 6966 6163    config.artifac
-00003ea0: 7473 2e67 656e 6572 6174 655f 7461 7267  ts.generate_targ
-00003eb0: 6574 5f70 6174 685f 6672 6f6d 5f61 7274  et_path_from_art
-00003ec0: 6966 6163 745f 6861 7368 203d 2028 0a20  ifact_hash = (. 
-00003ed0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00003ee0: 6f6e 6669 672e 6172 7469 6661 6374 732e  onfig.artifacts.
-00003ef0: 6765 6e65 7261 7465 5f74 6172 6765 745f  generate_target_
-00003f00: 7061 7468 5f66 726f 6d5f 6172 7469 6661  path_from_artifa
-00003f10: 6374 5f68 6173 680a 2020 2020 2020 2020  ct_hash.        
-00003f20: 2020 2020 2020 2020 6966 2063 6f6e 6669          if confi
-00003f30: 672e 6172 7469 6661 6374 732e 6765 6e65  g.artifacts.gene
-00003f40: 7261 7465 5f74 6172 6765 745f 7061 7468  rate_target_path
-00003f50: 5f66 726f 6d5f 6172 7469 6661 6374 5f68  _from_artifact_h
-00003f60: 6173 6820 6973 206e 6f74 204e 6f6e 650a  ash is not None.
-00003f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003f80: 656c 7365 2073 6572 7665 725f 6366 672e  else server_cfg.
-00003f90: 6765 7428 2267 656e 6572 6174 655f 6172  get("generate_ar
-00003fa0: 7469 6661 6374 5f74 6172 6765 745f 7061  tifact_target_pa
-00003fb0: 7468 5f66 726f 6d5f 6172 7469 6661 6374  th_from_artifact
-00003fc0: 5f68 6173 6822 290a 2020 2020 2020 2020  _hash").        
-00003fd0: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
-00003fe0: 2020 2063 6f6e 6669 672e 7265 6469 732e     config.redis.
-00003ff0: 7572 6c20 3d20 636f 6e66 6967 2e72 6564  url = config.red
-00004000: 6973 2e75 726c 206f 7220 7365 7276 6572  is.url or server
-00004010: 5f63 6667 2e67 6574 2822 7265 6469 735f  _cfg.get("redis_
-00004020: 7572 6c22 290a 2020 2020 2020 2020 2020  url").          
-00004030: 2020 2320 616c 6c6f 7720 636c 6965 6e74    # allow client
-00004040: 2074 6f20 7365 7420 7468 6520 6465 6661   to set the defa
-00004050: 756c 7420 7061 7274 6961 6c20 5741 2066  ult partial WA f
-00004060: 6f72 206c 6163 6b20 6f66 2073 7570 706f  or lack of suppo
-00004070: 7274 206f 6620 7065 722d 7461 7267 6574  rt of per-target
-00004080: 2061 7578 696c 6961 7279 206f 7074 696f   auxiliary optio
-00004090: 6e73 0a20 2020 2020 2020 2020 2020 2063  ns.            c
-000040a0: 6f6e 6669 672e 7265 6469 732e 7479 7065  onfig.redis.type
-000040b0: 203d 2063 6f6e 6669 672e 7265 6469 732e   = config.redis.
-000040c0: 7479 7065 206f 7220 7365 7276 6572 5f63  type or server_c
-000040d0: 6667 2e67 6574 2822 7265 6469 735f 7479  fg.get("redis_ty
-000040e0: 7065 2229 0a0a 2020 2020 2020 2020 2020  pe")..          
-000040f0: 2020 636f 6e66 6967 2e73 716c 2e75 726c    config.sql.url
-00004100: 203d 2063 6f6e 6669 672e 7371 6c2e 7572   = config.sql.ur
-00004110: 6c20 6f72 2073 6572 7665 725f 6366 672e  l or server_cfg.
-00004120: 6765 7428 2273 716c 5f75 726c 2229 0a20  get("sql_url"). 
-00004130: 2020 2020 2020 2020 2020 2023 2054 6865             # The
-00004140: 7365 2068 6176 6520 6120 6465 6661 756c  se have a defaul
-00004150: 7420 7661 6c75 652c 2074 6865 7265 666f  t value, therefo
-00004160: 7265 206c 6f63 616c 2063 6f6e 6669 6720  re local config 
-00004170: 7769 6c6c 2061 6c77 6179 7320 6861 7665  will always have
-00004180: 2061 2076 616c 7565 2c20 7072 696f 7269   a value, priori
-00004190: 7469 7a65 2074 6865 0a20 2020 2020 2020  tize the.       
-000041a0: 2020 2020 2023 2041 5049 2076 616c 7565       # API value
-000041b0: 2066 6972 7374 0a20 2020 2020 2020 2020   first.         
-000041c0: 2020 2063 6f6e 6669 672e 7569 2e70 726f     config.ui.pro
-000041d0: 6a65 6374 735f 7072 6566 6978 203d 2028  jects_prefix = (
-000041e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000041f0: 2073 6572 7665 725f 6366 672e 6765 7428   server_cfg.get(
-00004200: 2275 695f 7072 6f6a 6563 7473 5f70 7265  "ui_projects_pre
-00004210: 6669 7822 2920 6f72 2063 6f6e 6669 672e  fix") or config.
-00004220: 7569 2e70 726f 6a65 6374 735f 7072 6566  ui.projects_pref
-00004230: 6978 0a20 2020 2020 2020 2020 2020 2029  ix.            )
-00004240: 0a20 2020 2020 2020 2020 2020 2063 6f6e  .            con
-00004250: 6669 672e 6b66 705f 696d 6167 6520 3d20  fig.kfp_image = 
-00004260: 7365 7276 6572 5f63 6667 2e67 6574 2822  server_cfg.get("
-00004270: 6b66 705f 696d 6167 6522 2920 6f72 2063  kfp_image") or c
-00004280: 6f6e 6669 672e 6b66 705f 696d 6167 650a  onfig.kfp_image.
-00004290: 2020 2020 2020 2020 2020 2020 636f 6e66              conf
-000042a0: 6967 2e6b 6670 5f75 726c 203d 2073 6572  ig.kfp_url = ser
-000042b0: 7665 725f 6366 672e 6765 7428 226b 6670  ver_cfg.get("kfp
-000042c0: 5f75 726c 2229 206f 7220 636f 6e66 6967  _url") or config
-000042d0: 2e6b 6670 5f75 726c 0a20 2020 2020 2020  .kfp_url.       
-000042e0: 2020 2020 2063 6f6e 6669 672e 6461 736b       config.dask
-000042f0: 5f6b 6670 5f69 6d61 6765 203d 2028 0a20  _kfp_image = (. 
-00004300: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00004310: 6572 7665 725f 6366 672e 6765 7428 2264  erver_cfg.get("d
-00004320: 6173 6b5f 6b66 705f 696d 6167 6522 2920  ask_kfp_image") 
-00004330: 6f72 2063 6f6e 6669 672e 6461 736b 5f6b  or config.dask_k
-00004340: 6670 5f69 6d61 6765 0a20 2020 2020 2020  fp_image.       
-00004350: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-00004360: 2020 2063 6f6e 6669 672e 7363 7261 7065     config.scrape
-00004370: 5f6d 6574 7269 6373 203d 2028 0a20 2020  _metrics = (.   
-00004380: 2020 2020 2020 2020 2020 2020 2073 6572               ser
-00004390: 7665 725f 6366 672e 6765 7428 2273 6372  ver_cfg.get("scr
-000043a0: 6170 655f 6d65 7472 6963 7322 290a 2020  ape_metrics").  
-000043b0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-000043c0: 2073 6572 7665 725f 6366 672e 6765 7428   server_cfg.get(
-000043d0: 2273 6372 6170 655f 6d65 7472 6963 7322  "scrape_metrics"
-000043e0: 2920 6973 206e 6f74 204e 6f6e 650a 2020  ) is not None.  
-000043f0: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00004400: 7365 2063 6f6e 6669 672e 7363 7261 7065  se config.scrape
-00004410: 5f6d 6574 7269 6373 0a20 2020 2020 2020  _metrics.       
-00004420: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-00004430: 2020 2063 6f6e 6669 672e 6465 6661 756c     config.defaul
-00004440: 745f 6675 6e63 7469 6f6e 5f6e 6f64 655f  t_function_node_
-00004450: 7365 6c65 6374 6f72 203d 2028 0a20 2020  selector = (.   
-00004460: 2020 2020 2020 2020 2020 2020 2073 6572               ser
-00004470: 7665 725f 6366 672e 6765 7428 2264 6566  ver_cfg.get("def
-00004480: 6175 6c74 5f66 756e 6374 696f 6e5f 6e6f  ault_function_no
-00004490: 6465 5f73 656c 6563 746f 7222 290a 2020  de_selector").  
-000044a0: 2020 2020 2020 2020 2020 2020 2020 6f72                or
-000044b0: 2063 6f6e 6669 672e 6465 6661 756c 745f   config.default_
-000044c0: 6675 6e63 7469 6f6e 5f6e 6f64 655f 7365  function_node_se
-000044d0: 6c65 6374 6f72 0a20 2020 2020 2020 2020  lector.         
-000044e0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-000044f0: 2063 6f6e 6669 672e 6967 7a5f 7665 7273   config.igz_vers
-00004500: 696f 6e20 3d20 7365 7276 6572 5f63 6667  ion = server_cfg
-00004510: 2e67 6574 2822 6967 7a5f 7665 7273 696f  .get("igz_versio
-00004520: 6e22 2920 6f72 2063 6f6e 6669 672e 6967  n") or config.ig
-00004530: 7a5f 7665 7273 696f 6e0a 2020 2020 2020  z_version.      
-00004540: 2020 2020 2020 636f 6e66 6967 2e73 746f        config.sto
-00004550: 7261 6765 2e61 7574 6f5f 6d6f 756e 745f  rage.auto_mount_
-00004560: 7479 7065 203d 2028 0a20 2020 2020 2020  type = (.       
-00004570: 2020 2020 2020 2020 2073 6572 7665 725f           server_
-00004580: 6366 672e 6765 7428 2261 7574 6f5f 6d6f  cfg.get("auto_mo
-00004590: 756e 745f 7479 7065 2229 206f 7220 636f  unt_type") or co
-000045a0: 6e66 6967 2e73 746f 7261 6765 2e61 7574  nfig.storage.aut
-000045b0: 6f5f 6d6f 756e 745f 7479 7065 0a20 2020  o_mount_type.   
-000045c0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-000045d0: 2020 2020 2020 2063 6f6e 6669 672e 7374         config.st
-000045e0: 6f72 6167 652e 6175 746f 5f6d 6f75 6e74  orage.auto_mount
-000045f0: 5f70 6172 616d 7320 3d20 280a 2020 2020  _params = (.    
-00004600: 2020 2020 2020 2020 2020 2020 7365 7276              serv
-00004610: 6572 5f63 6667 2e67 6574 2822 6175 746f  er_cfg.get("auto
-00004620: 5f6d 6f75 6e74 5f70 6172 616d 7322 2920  _mount_params") 
-00004630: 6f72 2063 6f6e 6669 672e 7374 6f72 6167  or config.storag
-00004640: 652e 6175 746f 5f6d 6f75 6e74 5f70 6172  e.auto_mount_par
-00004650: 616d 730a 2020 2020 2020 2020 2020 2020  ams.            
-00004660: 290a 2020 2020 2020 2020 2020 2020 636f  ).            co
-00004670: 6e66 6967 2e73 7061 726b 5f6f 7065 7261  nfig.spark_opera
-00004680: 746f 725f 7665 7273 696f 6e20 3d20 280a  tor_version = (.
-00004690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000046a0: 7365 7276 6572 5f63 6667 2e67 6574 2822  server_cfg.get("
-000046b0: 7370 6172 6b5f 6f70 6572 6174 6f72 5f76  spark_operator_v
-000046c0: 6572 7369 6f6e 2229 0a20 2020 2020 2020  ersion").       
-000046d0: 2020 2020 2020 2020 206f 7220 636f 6e66           or conf
-000046e0: 6967 2e73 7061 726b 5f6f 7065 7261 746f  ig.spark_operato
-000046f0: 725f 7665 7273 696f 6e0a 2020 2020 2020  r_version.      
-00004700: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00004710: 2020 2020 636f 6e66 6967 2e64 6566 6175      config.defau
-00004720: 6c74 5f74 656e 736f 7262 6f61 7264 5f6c  lt_tensorboard_l
-00004730: 6f67 735f 7061 7468 203d 2028 0a20 2020  ogs_path = (.   
-00004740: 2020 2020 2020 2020 2020 2020 2073 6572               ser
-00004750: 7665 725f 6366 672e 6765 7428 2264 6566  ver_cfg.get("def
-00004760: 6175 6c74 5f74 656e 736f 7262 6f61 7264  ault_tensorboard
-00004770: 5f6c 6f67 735f 7061 7468 2229 0a20 2020  _logs_path").   
-00004780: 2020 2020 2020 2020 2020 2020 206f 7220               or 
-00004790: 636f 6e66 6967 2e64 6566 6175 6c74 5f74  config.default_t
-000047a0: 656e 736f 7262 6f61 7264 5f6c 6f67 735f  ensorboard_logs_
-000047b0: 7061 7468 0a20 2020 2020 2020 2020 2020  path.           
-000047c0: 2029 0a20 2020 2020 2020 2020 2020 2063   ).            c
-000047d0: 6f6e 6669 672e 6465 6661 756c 745f 6675  onfig.default_fu
-000047e0: 6e63 7469 6f6e 5f70 6f64 5f72 6573 6f75  nction_pod_resou
-000047f0: 7263 6573 203d 2028 0a20 2020 2020 2020  rces = (.       
-00004800: 2020 2020 2020 2020 2073 6572 7665 725f           server_
-00004810: 6366 672e 6765 7428 2264 6566 6175 6c74  cfg.get("default
-00004820: 5f66 756e 6374 696f 6e5f 706f 645f 7265  _function_pod_re
-00004830: 736f 7572 6365 7322 290a 2020 2020 2020  sources").      
-00004840: 2020 2020 2020 2020 2020 6f72 2063 6f6e            or con
-00004850: 6669 672e 6465 6661 756c 745f 6675 6e63  fig.default_func
-00004860: 7469 6f6e 5f70 6f64 5f72 6573 6f75 7263  tion_pod_resourc
-00004870: 6573 0a20 2020 2020 2020 2020 2020 2029  es.            )
-00004880: 0a20 2020 2020 2020 2020 2020 2063 6f6e  .            con
-00004890: 6669 672e 6675 6e63 7469 6f6e 5f64 6566  fig.function_def
-000048a0: 6175 6c74 732e 7072 6565 6d70 7469 6f6e  aults.preemption
-000048b0: 5f6d 6f64 6520 3d20 280a 2020 2020 2020  _mode = (.      
-000048c0: 2020 2020 2020 2020 2020 7365 7276 6572            server
-000048d0: 5f63 6667 2e67 6574 2822 6465 6661 756c  _cfg.get("defaul
-000048e0: 745f 7072 6565 6d70 7469 6f6e 5f6d 6f64  t_preemption_mod
-000048f0: 6522 290a 2020 2020 2020 2020 2020 2020  e").            
-00004900: 2020 2020 6f72 2063 6f6e 6669 672e 6675      or config.fu
-00004910: 6e63 7469 6f6e 5f64 6566 6175 6c74 732e  nction_defaults.
-00004920: 7072 6565 6d70 7469 6f6e 5f6d 6f64 650a  preemption_mode.
-00004930: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00004940: 2020 2020 2020 2020 2020 636f 6e66 6967            config
-00004950: 2e70 7265 656d 7074 6962 6c65 5f6e 6f64  .preemptible_nod
-00004960: 6573 2e6e 6f64 655f 7365 6c65 6374 6f72  es.node_selector
-00004970: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
-00004980: 2020 2020 2073 6572 7665 725f 6366 672e       server_cfg.
-00004990: 6765 7428 2270 7265 656d 7074 6962 6c65  get("preemptible
-000049a0: 5f6e 6f64 6573 5f6e 6f64 655f 7365 6c65  _nodes_node_sele
-000049b0: 6374 6f72 2229 0a20 2020 2020 2020 2020  ctor").         
-000049c0: 2020 2020 2020 206f 7220 636f 6e66 6967         or config
-000049d0: 2e70 7265 656d 7074 6962 6c65 5f6e 6f64  .preemptible_nod
-000049e0: 6573 2e6e 6f64 655f 7365 6c65 6374 6f72  es.node_selector
-000049f0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-00004a00: 2020 2020 2020 2020 2020 2063 6f6e 6669             confi
-00004a10: 672e 7072 6565 6d70 7469 626c 655f 6e6f  g.preemptible_no
-00004a20: 6465 732e 746f 6c65 7261 7469 6f6e 7320  des.tolerations 
-00004a30: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
-00004a40: 2020 2020 7365 7276 6572 5f63 6667 2e67      server_cfg.g
-00004a50: 6574 2822 7072 6565 6d70 7469 626c 655f  et("preemptible_
-00004a60: 6e6f 6465 735f 746f 6c65 7261 7469 6f6e  nodes_toleration
-00004a70: 7322 290a 2020 2020 2020 2020 2020 2020  s").            
-00004a80: 2020 2020 6f72 2063 6f6e 6669 672e 7072      or config.pr
-00004a90: 6565 6d70 7469 626c 655f 6e6f 6465 732e  eemptible_nodes.
-00004aa0: 746f 6c65 7261 7469 6f6e 730a 2020 2020  tolerations.    
-00004ab0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00004ac0: 2020 2020 2020 636f 6e66 6967 2e66 6f72        config.for
-00004ad0: 6365 5f72 756e 5f6c 6f63 616c 203d 2028  ce_run_local = (
-00004ae0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00004af0: 2073 6572 7665 725f 6366 672e 6765 7428   server_cfg.get(
-00004b00: 2266 6f72 6365 5f72 756e 5f6c 6f63 616c  "force_run_local
-00004b10: 2229 206f 7220 636f 6e66 6967 2e66 6f72  ") or config.for
-00004b20: 6365 5f72 756e 5f6c 6f63 616c 0a20 2020  ce_run_local.   
-00004b30: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00004b40: 2020 2020 2020 2063 6f6e 6669 672e 6675         config.fu
-00004b50: 6e63 7469 6f6e 203d 2073 6572 7665 725f  nction = server_
-00004b60: 6366 672e 6765 7428 2266 756e 6374 696f  cfg.get("functio
-00004b70: 6e22 2920 6f72 2063 6f6e 6669 672e 6675  n") or config.fu
-00004b80: 6e63 7469 6f6e 0a20 2020 2020 2020 2020  nction.         
-00004b90: 2020 2063 6f6e 6669 672e 6874 7470 6462     config.httpdb
-00004ba0: 2e6c 6f67 7320 3d20 7365 7276 6572 5f63  .logs = server_c
-00004bb0: 6667 2e67 6574 2822 6c6f 6773 2229 206f  fg.get("logs") o
-00004bc0: 7220 636f 6e66 6967 2e68 7474 7064 622e  r config.httpdb.
-00004bd0: 6c6f 6773 0a20 2020 2020 2020 2020 2020  logs.           
-00004be0: 2063 6f6e 6669 672e 6578 7465 726e 616c   config.external
-00004bf0: 5f70 6c61 7466 6f72 6d5f 7472 6163 6b69  _platform_tracki
-00004c00: 6e67 203d 2028 0a20 2020 2020 2020 2020  ng = (.         
-00004c10: 2020 2020 2020 2073 6572 7665 725f 6366         server_cf
-00004c20: 672e 6765 7428 2265 7874 6572 6e61 6c5f  g.get("external_
-00004c30: 706c 6174 666f 726d 5f74 7261 636b 696e  platform_trackin
-00004c40: 6722 290a 2020 2020 2020 2020 2020 2020  g").            
-00004c50: 2020 2020 6f72 2063 6f6e 6669 672e 6578      or config.ex
-00004c60: 7465 726e 616c 5f70 6c61 7466 6f72 6d5f  ternal_platform_
-00004c70: 7472 6163 6b69 6e67 0a20 2020 2020 2020  tracking.       
-00004c80: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-00004c90: 2020 2063 6f6e 6669 672e 6d6f 6465 6c5f     config.model_
-00004ca0: 656e 6470 6f69 6e74 5f6d 6f6e 6974 6f72  endpoint_monitor
-00004cb0: 696e 672e 7374 6f72 655f 7479 7065 203d  ing.store_type =
-00004cc0: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
-00004cd0: 2020 2073 6572 7665 725f 6366 672e 6765     server_cfg.ge
-00004ce0: 7428 226d 6f64 656c 5f65 6e64 706f 696e  t("model_endpoin
-00004cf0: 745f 6d6f 6e69 746f 7269 6e67 5f73 746f  t_monitoring_sto
-00004d00: 7265 5f74 7970 6522 290a 2020 2020 2020  re_type").      
-00004d10: 2020 2020 2020 2020 2020 6f72 2063 6f6e            or con
-00004d20: 6669 672e 6d6f 6465 6c5f 656e 6470 6f69  fig.model_endpoi
-00004d30: 6e74 5f6d 6f6e 6974 6f72 696e 672e 7374  nt_monitoring.st
-00004d40: 6f72 655f 7479 7065 0a20 2020 2020 2020  ore_type.       
-00004d50: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-00004d60: 2020 2063 6f6e 6669 672e 6d6f 6465 6c5f     config.model_
-00004d70: 656e 6470 6f69 6e74 5f6d 6f6e 6974 6f72  endpoint_monitor
-00004d80: 696e 672e 656e 6470 6f69 6e74 5f73 746f  ing.endpoint_sto
-00004d90: 7265 5f63 6f6e 6e65 6374 696f 6e20 3d20  re_connection = 
-00004da0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00004db0: 2020 7365 7276 6572 5f63 6667 2e67 6574    server_cfg.get
-00004dc0: 2822 6d6f 6465 6c5f 656e 6470 6f69 6e74  ("model_endpoint
-00004dd0: 5f6d 6f6e 6974 6f72 696e 675f 656e 6470  _monitoring_endp
-00004de0: 6f69 6e74 5f73 746f 7265 5f63 6f6e 6e65  oint_store_conne
-00004df0: 6374 696f 6e22 290a 2020 2020 2020 2020  ction").        
-00004e00: 2020 2020 2020 2020 6f72 2063 6f6e 6669          or confi
-00004e10: 672e 6d6f 6465 6c5f 656e 6470 6f69 6e74  g.model_endpoint
-00004e20: 5f6d 6f6e 6974 6f72 696e 672e 656e 6470  _monitoring.endp
+00000230: 4c69 6365 6e73 652e 0a0a 696d 706f 7274  License...import
+00000240: 2065 6e75 6d0a 696d 706f 7274 2068 7474   enum.import htt
+00000250: 700a 696d 706f 7274 2072 650a 696d 706f  p.import re.impo
+00000260: 7274 2074 656d 7066 696c 650a 696d 706f  rt tempfile.impo
+00000270: 7274 2074 696d 650a 696d 706f 7274 2074  rt time.import t
+00000280: 7261 6365 6261 636b 0a69 6d70 6f72 7420  raceback.import 
+00000290: 7479 7069 6e67 0a69 6d70 6f72 7420 7761  typing.import wa
+000002a0: 726e 696e 6773 0a66 726f 6d20 6461 7465  rnings.from date
+000002b0: 7469 6d65 2069 6d70 6f72 7420 6461 7465  time import date
+000002c0: 7469 6d65 2c20 7469 6d65 6465 6c74 610a  time, timedelta.
+000002d0: 6672 6f6d 206f 7320 696d 706f 7274 2070  from os import p
+000002e0: 6174 682c 2072 656d 6f76 650a 6672 6f6d  ath, remove.from
+000002f0: 2074 7970 696e 6720 696d 706f 7274 204f   typing import O
+00000300: 7074 696f 6e61 6c2c 2055 6e69 6f6e 0a66  ptional, Union.f
+00000310: 726f 6d20 7572 6c6c 6962 2e70 6172 7365  rom urllib.parse
+00000320: 2069 6d70 6f72 7420 7572 6c70 6172 7365   import urlparse
+00000330: 0a0a 696d 706f 7274 206b 6670 0a69 6d70  ..import kfp.imp
+00000340: 6f72 7420 7265 7175 6573 7473 0a69 6d70  ort requests.imp
+00000350: 6f72 7420 7365 6d76 6572 0a0a 696d 706f  ort semver..impo
+00000360: 7274 206d 6c72 756e 0a69 6d70 6f72 7420  rt mlrun.import 
+00000370: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+00000380: 656d 6173 0a69 6d70 6f72 7420 6d6c 7275  emas.import mlru
+00000390: 6e2e 636f 6d6d 6f6e 2e74 7970 6573 0a69  n.common.types.i
+000003a0: 6d70 6f72 7420 6d6c 7275 6e2e 6d6f 6465  mport mlrun.mode
+000003b0: 6c5f 6d6f 6e69 746f 7269 6e67 2e6d 6f64  l_monitoring.mod
+000003c0: 656c 5f65 6e64 706f 696e 740a 696d 706f  el_endpoint.impo
+000003d0: 7274 206d 6c72 756e 2e70 6c61 7466 6f72  rt mlrun.platfor
+000003e0: 6d73 0a69 6d70 6f72 7420 6d6c 7275 6e2e  ms.import mlrun.
+000003f0: 7072 6f6a 6563 7473 0a69 6d70 6f72 7420  projects.import 
+00000400: 6d6c 7275 6e2e 7275 6e74 696d 6573 2e6e  mlrun.runtimes.n
+00000410: 7563 6c69 6f2e 6170 695f 6761 7465 7761  uclio.api_gatewa
+00000420: 790a 696d 706f 7274 206d 6c72 756e 2e75  y.import mlrun.u
+00000430: 7469 6c73 0a66 726f 6d20 6d6c 7275 6e2e  tils.from mlrun.
+00000440: 6572 726f 7273 2069 6d70 6f72 7420 4d4c  errors import ML
+00000450: 5275 6e49 6e76 616c 6964 4172 6775 6d65  RunInvalidArgume
+00000460: 6e74 4572 726f 722c 2065 7272 5f74 6f5f  ntError, err_to_
+00000470: 7374 720a 0a66 726f 6d20 2e2e 6172 7469  str..from ..arti
+00000480: 6661 6374 7320 696d 706f 7274 2041 7274  facts import Art
+00000490: 6966 6163 740a 6672 6f6d 202e 2e63 6f6e  ifact.from ..con
+000004a0: 6669 6720 696d 706f 7274 2063 6f6e 6669  fig import confi
+000004b0: 670a 6672 6f6d 202e 2e64 6174 6173 746f  g.from ..datasto
+000004c0: 7265 2e64 6174 6173 746f 7265 5f70 726f  re.datastore_pro
+000004d0: 6669 6c65 2069 6d70 6f72 7420 4461 7461  file import Data
+000004e0: 7374 6f72 6550 726f 6669 6c65 324a 736f  storeProfile2Jso
+000004f0: 6e0a 6672 6f6d 202e 2e66 6561 7475 7265  n.from ..feature
+00000500: 5f73 746f 7265 2069 6d70 6f72 7420 4665  _store import Fe
+00000510: 6174 7572 6553 6574 2c20 4665 6174 7572  atureSet, Featur
+00000520: 6556 6563 746f 720a 6672 6f6d 202e 2e6c  eVector.from ..l
+00000530: 6973 7473 2069 6d70 6f72 7420 4172 7469  ists import Arti
+00000540: 6661 6374 4c69 7374 2c20 5275 6e4c 6973  factList, RunLis
+00000550: 740a 6672 6f6d 202e 2e72 756e 7469 6d65  t.from ..runtime
+00000560: 7320 696d 706f 7274 2042 6173 6552 756e  s import BaseRun
+00000570: 7469 6d65 0a66 726f 6d20 2e2e 7574 696c  time.from ..util
+00000580: 7320 696d 706f 7274 2028 0a20 2020 2064  s import (.    d
+00000590: 6174 6574 696d 655f 746f 5f69 736f 2c0a  atetime_to_iso,.
+000005a0: 2020 2020 6469 6374 5f74 6f5f 6a73 6f6e      dict_to_json
+000005b0: 2c0a 2020 2020 6c6f 6767 6572 2c0a 2020  ,.    logger,.  
+000005c0: 2020 6e65 775f 7069 7065 5f6d 6574 6164    new_pipe_metad
+000005d0: 6174 612c 0a20 2020 206e 6f72 6d61 6c69  ata,.    normali
+000005e0: 7a65 5f6e 616d 652c 0a20 2020 2076 6572  ze_name,.    ver
+000005f0: 7369 6f6e 2c0a 290a 6672 6f6d 202e 6261  sion,.).from .ba
+00000600: 7365 2069 6d70 6f72 7420 5275 6e44 4245  se import RunDBE
+00000610: 7272 6f72 2c20 5275 6e44 4249 6e74 6572  rror, RunDBInter
+00000620: 6661 6365 0a0a 5f61 7274 6966 6163 745f  face.._artifact_
+00000630: 6b65 7973 203d 205b 0a20 2020 2022 666f  keys = [.    "fo
+00000640: 726d 6174 222c 0a20 2020 2022 696e 6c69  rmat",.    "inli
+00000650: 6e65 222c 0a20 2020 2022 6b65 7922 2c0a  ne",.    "key",.
+00000660: 2020 2020 2273 7263 5f70 6174 6822 2c0a      "src_path",.
+00000670: 2020 2020 2274 6172 6765 745f 7061 7468      "target_path
+00000680: 222c 0a20 2020 2022 7669 6577 6572 222c  ",.    "viewer",
+00000690: 0a5d 0a0a 0a64 6566 2062 6f6f 6c32 7374  .]...def bool2st
+000006a0: 7228 7661 6c29 3a0a 2020 2020 7265 7475  r(val):.    retu
+000006b0: 726e 2022 7965 7322 2069 6620 7661 6c20  rn "yes" if val 
+000006c0: 656c 7365 2022 6e6f 220a 0a0a 636c 6173  else "no"...clas
+000006d0: 7320 4854 5450 5275 6e44 4228 5275 6e44  s HTTPRunDB(RunD
+000006e0: 4249 6e74 6572 6661 6365 293a 0a20 2020  BInterface):.   
+000006f0: 2022 2222 496e 7465 7266 6163 6520 666f   """Interface fo
+00000700: 7220 6163 6365 7373 696e 6720 616e 6420  r accessing and 
+00000710: 6d61 6e69 7075 6c61 7469 6e67 2074 6865  manipulating the
+00000720: 203a 7079 3a6d 6f64 3a60 6d6c 7275 6e60   :py:mod:`mlrun`
+00000730: 2070 6572 7369 7374 656e 7420 7374 6f72   persistent stor
+00000740: 652c 206d 6169 6e74 6169 6e69 6e67 2074  e, maintaining t
+00000750: 6865 2066 756c 6c20 7374 6174 650a 2020  he full state.  
+00000760: 2020 616e 6420 6361 7461 6c6f 6720 6f66    and catalog of
+00000770: 206f 626a 6563 7473 2074 6861 7420 4d4c   objects that ML
+00000780: 5275 6e20 7573 6573 2e20 5468 6520 3a70  Run uses. The :p
+00000790: 793a 636c 6173 733a 6048 5454 5052 756e  y:class:`HTTPRun
+000007a0: 4442 6020 636c 6173 7320 7365 7276 6573  DB` class serves
+000007b0: 2061 7320 6120 636c 6965 6e74 2d73 6964   as a client-sid
+000007c0: 6520 7072 6f78 7920 746f 2074 6865 204d  e proxy to the M
+000007d0: 4c52 756e 0a20 2020 2041 5049 2073 6572  LRun.    API ser
+000007e0: 7669 6365 2077 6869 6368 206d 6169 6e74  vice which maint
+000007f0: 6169 6e73 2074 6865 2061 6374 7561 6c20  ains the actual 
+00000800: 6461 7461 2d73 746f 7265 2c20 6163 6365  data-store, acce
+00000810: 7373 6573 2074 6865 2073 6572 7665 7220  sses the server 
+00000820: 7468 726f 7567 6820 5245 5354 2041 5049  through REST API
+00000830: 732e 0a0a 2020 2020 5468 6520 636c 6173  s...    The clas
+00000840: 7320 7072 6f76 6964 6573 2066 756e 6374  s provides funct
+00000850: 696f 6e73 2066 6f72 2061 6363 6573 7369  ions for accessi
+00000860: 6e67 2061 6e64 206d 6f64 6966 7969 6e67  ng and modifying
+00000870: 2074 6865 2076 6172 696f 7573 206f 626a   the various obj
+00000880: 6563 7473 2074 6861 7420 6172 6520 7573  ects that are us
+00000890: 6564 2062 7920 4d4c 5275 6e20 696e 2069  ed by MLRun in i
+000008a0: 7473 0a20 2020 206f 7065 7261 7469 6f6e  ts.    operation
+000008b0: 2e20 5468 6520 6675 6e63 7469 6f6e 7320  . The functions 
+000008c0: 7072 6f76 6964 6564 2066 6f6c 6c6f 7720  provided follow 
+000008d0: 736f 6d65 2073 7461 6e64 6172 6420 6775  some standard gu
+000008e0: 6964 656c 696e 6573 2c20 7768 6963 6820  idelines, which 
+000008f0: 6172 653a 0a0a 2020 2020 2d20 4576 6572  are:..    - Ever
+00000900: 7920 6f62 6a65 6374 2069 6e20 4d4c 5275  y object in MLRu
+00000910: 6e20 6578 6973 7473 2069 6e20 7468 6520  n exists in the 
+00000920: 636f 6e74 6578 7420 6f66 2061 2070 726f  context of a pro
+00000930: 6a65 6374 2028 6578 6365 7074 2070 726f  ject (except pro
+00000940: 6a65 6374 7320 7468 656d 7365 6c76 6573  jects themselves
+00000950: 292e 2057 6865 6e20 7265 6665 7265 6e63  ). When referenc
+00000960: 696e 6720 616e 206f 626a 6563 740a 2020  ing an object.  
+00000970: 2020 2020 7468 726f 7567 6820 616e 7920      through any 
+00000980: 4150 492c 2061 2070 726f 6a65 6374 206e  API, a project n
+00000990: 616d 6520 6d75 7374 2062 6520 7072 6f76  ame must be prov
+000009a0: 6964 6564 2e20 5468 6520 6465 6661 756c  ided. The defaul
+000009b0: 7420 666f 7220 6d6f 7374 2041 5049 7320  t for most APIs 
+000009c0: 6973 2066 6f72 2061 6e20 656d 7074 7920  is for an empty 
+000009d0: 7072 6f6a 6563 7420 6e61 6d65 2c20 7768  project name, wh
+000009e0: 6963 680a 2020 2020 2020 7769 6c6c 2062  ich.      will b
+000009f0: 6520 7265 706c 6163 6564 2062 7920 7468  e replaced by th
+00000a00: 6520 6e61 6d65 206f 6620 7468 6520 6465  e name of the de
+00000a10: 6661 756c 7420 7072 6f6a 6563 7420 2875  fault project (u
+00000a20: 7375 616c 6c79 2060 6064 6566 6175 6c74  sually ``default
+00000a30: 6060 292e 2054 6865 7265 666f 7265 2c20  ``). Therefore, 
+00000a40: 6966 2070 6572 666f 726d 696e 6720 616e  if performing an
+00000a50: 2041 5049 2074 6f0a 2020 2020 2020 6c69   API to.      li
+00000a60: 7374 2066 756e 6374 696f 6e73 2c20 666f  st functions, fo
+00000a70: 7220 6578 616d 706c 652c 2061 6e64 206e  r example, and n
+00000a80: 6f74 2070 726f 7669 6469 6e67 2061 2070  ot providing a p
+00000a90: 726f 6a65 6374 206e 616d 6520 2d20 7468  roject name - th
+00000aa0: 6520 7265 7375 6c74 2077 696c 6c20 6e6f  e result will no
+00000ab0: 7420 6265 2066 756e 6374 696f 6e73 2066  t be functions f
+00000ac0: 726f 6d20 616c 6c0a 2020 2020 2020 7072  rom all.      pr
+00000ad0: 6f6a 6563 7473 2062 7574 2072 6174 6865  ojects but rathe
+00000ae0: 7220 6672 6f6d 2074 6865 2060 6064 6566  r from the ``def
+00000af0: 6175 6c74 6060 2070 726f 6a65 6374 2e0a  ault`` project..
+00000b00: 2020 2020 2d20 4d61 6e79 206f 626a 6563      - Many objec
+00000b10: 7473 2063 616e 2062 6520 6173 7369 676e  ts can be assign
+00000b20: 6564 206c 6162 656c 732c 2061 6e64 206c  ed labels, and l
+00000b30: 6973 7465 642f 7175 6572 6965 6420 6279  isted/queried by
+00000b40: 206c 6162 656c 2e20 5468 6520 6c61 6265   label. The labe
+00000b50: 6c20 7061 7261 6d65 7465 7220 666f 7220  l parameter for 
+00000b60: 7175 6572 7920 4150 4973 2061 6c6c 6f77  query APIs allow
+00000b70: 7320 666f 720a 2020 2020 2020 6c69 7374  s for.      list
+00000b80: 696e 6720 6f62 6a65 6374 7320 7468 6174  ing objects that
+00000b90: 3a0a 0a20 2020 2020 202d 2048 6176 6520  :..      - Have 
+00000ba0: 6120 7370 6563 6966 6963 206c 6162 656c  a specific label
+00000bb0: 2c20 6279 2061 736b 696e 6720 666f 7220  , by asking for 
+00000bc0: 6060 6c61 6265 6c3d 223c 6c61 6265 6c5f  ``label="<label_
+00000bd0: 6e61 6d65 3e22 6060 2e20 496e 2074 6869  name>"``. In thi
+00000be0: 7320 6361 7365 2074 6865 2061 6374 7561  s case the actua
+00000bf0: 6c20 7661 6c75 6520 6f66 2074 6865 206c  l value of the l
+00000c00: 6162 656c 0a20 2020 2020 2020 2064 6f65  abel.        doe
+00000c10: 736e 2774 206d 6174 7465 7220 616e 6420  sn't matter and 
+00000c20: 6576 6572 7920 6f62 6a65 6374 2077 6974  every object wit
+00000c30: 6820 7468 6174 206c 6162 656c 2077 696c  h that label wil
+00000c40: 6c20 6265 2072 6574 7572 6e65 640a 2020  l be returned.  
+00000c50: 2020 2020 2d20 4861 7665 2061 206c 6162      - Have a lab
+00000c60: 656c 2077 6974 6820 6120 7370 6563 6966  el with a specif
+00000c70: 6963 2076 616c 7565 2e20 5468 6973 2069  ic value. This i
+00000c80: 7320 646f 6e65 2062 7920 7370 6563 6966  s done by specif
+00000c90: 7969 6e67 2060 606c 6162 656c 3d22 3c6c  ying ``label="<l
+00000ca0: 6162 656c 5f6e 616d 653e 3d3c 6c61 6265  abel_name>=<labe
+00000cb0: 6c5f 7661 6c75 653e 2260 602e 2049 6e20  l_value>"``. In 
+00000cc0: 7468 6973 0a20 2020 2020 2020 2063 6173  this.        cas
+00000cd0: 6520 6f6e 6c79 206f 626a 6563 7473 2077  e only objects w
+00000ce0: 686f 7365 206c 6162 656c 206d 6174 6368  hose label match
+00000cf0: 6573 2074 6865 2076 616c 7565 2077 696c  es the value wil
+00000d00: 6c20 6265 2072 6574 7572 6e65 640a 0a20  l be returned.. 
+00000d10: 2020 202d 204d 6f73 7420 6f62 6a65 6374     - Most object
+00000d20: 7320 6861 7665 2061 2060 6063 7265 6174  s have a ``creat
+00000d30: 6560 6020 6d65 7468 6f64 2061 7320 7765  e`` method as we
+00000d40: 6c6c 2061 7320 6120 6060 7374 6f72 6560  ll as a ``store`
+00000d50: 6020 6d65 7468 6f64 2e20 4372 6561 7465  ` method. Create
+00000d60: 2063 616e 206f 6e6c 7920 6265 2063 616c   can only be cal
+00000d70: 6c65 6420 7768 656e 2073 7563 6820 616e  led when such an
+00000d80: 0a20 2020 2020 2064 6f65 7320 6e6f 7420  .      does not 
+00000d90: 6578 6973 7420 7965 742c 2077 6869 6c65  exist yet, while
+00000da0: 2073 746f 7265 2061 6c6c 6f77 7320 666f   store allows fo
+00000db0: 7220 6569 7468 6572 2063 7265 6174 696e  r either creatin
+00000dc0: 6720 6120 6e65 7720 6f62 6a65 6374 206f  g a new object o
+00000dd0: 7220 6f76 6572 7772 6974 696e 6720 616e  r overwriting an
+00000de0: 2065 7869 7374 696e 6720 6f62 6a65 6374   existing object
+00000df0: 2e0a 2020 2020 2d20 536f 6d65 206f 626a  ..    - Some obj
+00000e00: 6563 7473 2068 6176 6520 6120 6060 7665  ects have a ``ve
+00000e10: 7273 696f 6e65 6460 6020 6f70 7469 6f6e  rsioned`` option
+00000e20: 2c20 696e 2077 6869 6368 2063 6173 6520  , in which case 
+00000e30: 6f76 6572 7772 6974 696e 6720 7468 6520  overwriting the 
+00000e40: 7361 6d65 206f 626a 6563 7420 7769 7468  same object with
+00000e50: 2061 2064 6966 6665 7265 6e74 2076 6572   a different ver
+00000e60: 7369 6f6e 206f 660a 2020 2020 2020 6974  sion of.      it
+00000e70: 2064 6f65 7320 6e6f 7420 6465 6c65 7465   does not delete
+00000e80: 2074 6865 2070 7265 7669 6f75 7320 7665   the previous ve
+00000e90: 7273 696f 6e2c 2062 7574 2072 6174 6865  rsion, but rathe
+00000ea0: 7220 6372 6561 7465 7320 6120 6e65 7720  r creates a new 
+00000eb0: 7665 7273 696f 6e20 6f66 2074 6865 206f  version of the o
+00000ec0: 626a 6563 7420 616e 6420 6b65 6570 7320  bject and keeps 
+00000ed0: 626f 7468 2076 6572 7369 6f6e 732e 0a20  both versions.. 
+00000ee0: 2020 2020 2056 6572 7369 6f6e 6564 206f       Versioned o
+00000ef0: 626a 6563 7473 2075 7375 616c 6c79 2068  bjects usually h
+00000f00: 6176 6520 6120 6060 7569 6460 6020 7072  ave a ``uid`` pr
+00000f10: 6f70 6572 7479 2077 6869 6368 2069 7320  operty which is 
+00000f20: 6261 7365 6420 6f6e 2074 6865 6972 2063  based on their c
+00000f30: 6f6e 7465 6e74 2061 6e64 2061 6c6c 6f77  ontent and allow
+00000f40: 7320 746f 2072 6566 6572 656e 6365 2061  s to reference a
+00000f50: 0a20 2020 2020 2073 7065 6369 6669 6320  .      specific 
+00000f60: 7665 7273 696f 6e20 6f66 2061 6e20 6f62  version of an ob
+00000f70: 6a65 6374 2028 6f74 6865 7220 7468 616e  ject (other than
+00000f80: 2074 6167 6769 6e67 206f 626a 6563 7473   tagging objects
+00000f90: 2c20 7768 6963 6820 616c 736f 2061 6c6c  , which also all
+00000fa0: 6f77 7320 666f 7220 6561 7379 2072 6566  ows for easy ref
+00000fb0: 6572 656e 6369 6e67 292e 0a20 2020 202d  erencing)..    -
+00000fc0: 204d 616e 7920 6f62 6a65 6374 7320 6861   Many objects ha
+00000fd0: 7665 2062 6f74 6820 6120 6060 7374 6f72  ve both a ``stor
+00000fe0: 6560 6020 6675 6e63 7469 6f6e 2061 6e64  e`` function and
+00000ff0: 2061 2060 6070 6174 6368 6060 2066 756e   a ``patch`` fun
+00001000: 6374 696f 6e2e 2054 6865 7365 2061 7265  ction. These are
+00001010: 2075 7365 6420 696e 2074 6865 2073 616d   used in the sam
+00001020: 6520 7761 7920 6173 2074 6865 0a20 2020  e way as the.   
+00001030: 2020 2063 6f72 7265 7370 6f6e 6469 6e67     corresponding
+00001040: 2052 4553 5420 7665 7262 7320 2d20 6120   REST verbs - a 
+00001050: 6060 7374 6f72 6560 6020 6973 2070 6173  ``store`` is pas
+00001060: 7365 6420 6120 6675 6c6c 206f 626a 6563  sed a full objec
+00001070: 7420 616e 6420 7769 6c6c 2062 6173 6963  t and will basic
+00001080: 616c 6c79 2070 6572 666f 726d 2061 2050  ally perform a P
+00001090: 5554 206f 7065 7261 7469 6f6e 2c0a 2020  UT operation,.  
+000010a0: 2020 2020 7265 706c 6163 696e 6720 7468      replacing th
+000010b0: 6520 6675 6c6c 206f 626a 6563 7420 2869  e full object (i
+000010c0: 6620 6974 2065 7869 7374 7329 2077 6869  f it exists) whi
+000010d0: 6c65 2060 6070 6174 6368 6060 2072 6563  le ``patch`` rec
+000010e0: 6569 7665 7320 6a75 7374 2061 2064 6963  eives just a dic
+000010f0: 7469 6f6e 6172 7920 636f 6e74 6169 6e69  tionary containi
+00001100: 6e67 2074 6865 2064 6966 6665 7265 6e63  ng the differenc
+00001110: 6573 2074 6f0a 2020 2020 2020 6265 2061  es to.      be a
+00001120: 7070 6c69 6564 2074 6f20 7468 6520 6f62  pplied to the ob
+00001130: 6a65 6374 2c20 616e 6420 7769 6c6c 206d  ject, and will m
+00001140: 6572 6765 2074 686f 7365 2063 6861 6e67  erge those chang
+00001150: 6573 2074 6f20 7468 6520 6578 6973 7469  es to the existi
+00001160: 6e67 206f 626a 6563 742e 2054 6865 2060  ng object. The `
+00001170: 6070 6174 6368 6060 0a20 2020 2020 206f  `patch``.      o
+00001180: 7065 7261 7469 6f6e 2061 6c73 6f20 6861  peration also ha
+00001190: 7320 6120 7374 7261 7465 6779 2061 7373  s a strategy ass
+000011a0: 6967 6e65 6420 746f 2069 7420 7768 6963  igned to it whic
+000011b0: 6820 6465 7465 726d 696e 6573 2068 6f77  h determines how
+000011c0: 2074 6865 206d 6572 6765 206c 6f67 6963   the merge logic
+000011d0: 2073 686f 756c 6420 6265 6861 7665 2e0a   should behave..
+000011e0: 2020 2020 2020 5468 6520 7374 7261 7465        The strate
+000011f0: 6779 2063 616e 2062 6520 6569 7468 6572  gy can be either
+00001200: 2060 6072 6570 6c61 6365 6060 206f 7220   ``replace`` or 
+00001210: 6060 6164 6469 7469 7665 6060 2e20 466f  ``additive``. Fo
+00001220: 7220 6675 7274 6865 7220 6465 7461 696c  r further detail
+00001230: 7320 6f6e 2074 686f 7365 2073 7472 6174  s on those strat
+00001240: 6567 6965 732c 2072 6566 6572 0a20 2020  egies, refer.   
+00001250: 2020 2074 6f20 6874 7470 733a 2f2f 7079     to https://py
+00001260: 7069 2e6f 7267 2f70 726f 6a65 6374 2f6d  pi.org/project/m
+00001270: 6572 6765 6465 6570 2f0a 2020 2020 2222  ergedeep/.    ""
+00001280: 220a 0a20 2020 206b 696e 6420 3d20 2268  "..    kind = "h
+00001290: 7474 7022 0a20 2020 2023 2062 7920 6465  ttp".    # by de
+000012a0: 6661 756c 7420 7765 2064 6f6e 2774 2072  fault we don't r
+000012b0: 6574 7279 206f 6e20 504f 5354 2072 6571  etry on POST req
+000012c0: 7565 7374 2061 7320 7468 6579 2061 7265  uest as they are
+000012d0: 2075 7375 616c 6c79 206e 6f74 2069 6465   usually not ide
+000012e0: 6d70 6f74 656e 740a 2020 2020 2320 6865  mpotent.    # he
+000012f0: 7265 2069 7320 6120 6c69 7374 206f 6620  re is a list of 
+00001300: 6964 656e 7469 6669 6564 2050 4f53 5420  identified POST 
+00001310: 7265 7175 6573 7473 2074 6861 7420 6172  requests that ar
+00001320: 6520 6964 656d 706f 7465 6e74 2028 2773  e idempotent ('s
+00001330: 746f 7265 2720 7673 2027 6372 6561 7465  tore' vs 'create
+00001340: 2729 2061 6e64 2063 616e 2062 6520 7265  ') and can be re
+00001350: 7472 6965 640a 2020 2020 5245 5452 4941  tried.    RETRIA
+00001360: 424c 455f 504f 5354 5f50 4154 4853 203d  BLE_POST_PATHS =
+00001370: 205b 0a20 2020 2020 2020 2072 225c 2f3f   [.        r"\/?
+00001380: 7072 6f6a 6563 7473 5c2f 2e2b 5c2f 6172  projects\/.+\/ar
+00001390: 7469 6661 6374 735c 2f2e 2b5c 2f2e 2b22  tifacts\/.+\/.+"
+000013a0: 2c0a 2020 2020 2020 2020 7222 5c2f 3f72  ,.        r"\/?r
+000013b0: 756e 5c2f 2e2b 5c2f 2e2b 222c 0a20 2020  un\/.+\/.+",.   
+000013c0: 205d 0a0a 2020 2020 6465 6620 5f5f 696e   ]..    def __in
+000013d0: 6974 5f5f 2873 656c 662c 2075 726c 293a  it__(self, url):
+000013e0: 0a20 2020 2020 2020 2073 656c 662e 7365  .        self.se
+000013f0: 7276 6572 5f76 6572 7369 6f6e 203d 2022  rver_version = "
+00001400: 220a 2020 2020 2020 2020 7365 6c66 2e73  ".        self.s
+00001410: 6573 7369 6f6e 203d 204e 6f6e 650a 2020  ession = None.  
+00001420: 2020 2020 2020 7365 6c66 2e5f 7761 6974        self._wait
+00001430: 5f66 6f72 5f70 726f 6a65 6374 5f74 6572  _for_project_ter
+00001440: 6d69 6e61 6c5f 7374 6174 655f 7265 7472  minal_state_retr
+00001450: 795f 696e 7465 7276 616c 203d 2033 0a20  y_interval = 3. 
+00001460: 2020 2020 2020 2073 656c 662e 5f77 6169         self._wai
+00001470: 745f 666f 725f 6261 636b 6772 6f75 6e64  t_for_background
+00001480: 5f74 6173 6b5f 7465 726d 696e 616c 5f73  _task_terminal_s
+00001490: 7461 7465 5f72 6574 7279 5f69 6e74 6572  tate_retry_inter
+000014a0: 7661 6c20 3d20 330a 2020 2020 2020 2020  val = 3.        
+000014b0: 7365 6c66 2e5f 7761 6974 5f66 6f72 5f70  self._wait_for_p
+000014c0: 726f 6a65 6374 5f64 656c 6574 696f 6e5f  roject_deletion_
+000014d0: 696e 7465 7276 616c 203d 2033 0a20 2020  interval = 3.   
+000014e0: 2020 2020 2073 656c 662e 636c 6965 6e74       self.client
+000014f0: 5f76 6572 7369 6f6e 203d 2076 6572 7369  _version = versi
+00001500: 6f6e 2e56 6572 7369 6f6e 2829 2e67 6574  on.Version().get
+00001510: 2829 5b22 7665 7273 696f 6e22 5d0a 2020  ()["version"].  
+00001520: 2020 2020 2020 7365 6c66 2e70 7974 686f        self.pytho
+00001530: 6e5f 7665 7273 696f 6e20 3d20 7374 7228  n_version = str(
+00001540: 7665 7273 696f 6e2e 5665 7273 696f 6e28  version.Version(
+00001550: 292e 6765 745f 7079 7468 6f6e 5f76 6572  ).get_python_ver
+00001560: 7369 6f6e 2829 290a 0a20 2020 2020 2020  sion())..       
+00001570: 2073 656c 662e 5f65 6e72 6963 685f 616e   self._enrich_an
+00001580: 645f 7661 6c69 6461 7465 2875 726c 290a  d_validate(url).
+00001590: 0a20 2020 2064 6566 205f 656e 7269 6368  .    def _enrich
+000015a0: 5f61 6e64 5f76 616c 6964 6174 6528 7365  _and_validate(se
+000015b0: 6c66 2c20 7572 6c29 3a0a 2020 2020 2020  lf, url):.      
+000015c0: 2020 7061 7273 6564 5f75 726c 203d 2075    parsed_url = u
+000015d0: 726c 7061 7273 6528 7572 6c29 0a20 2020  rlparse(url).   
+000015e0: 2020 2020 2073 6368 656d 6520 3d20 7061       scheme = pa
+000015f0: 7273 6564 5f75 726c 2e73 6368 656d 652e  rsed_url.scheme.
+00001600: 6c6f 7765 7228 290a 2020 2020 2020 2020  lower().        
+00001610: 6966 2073 6368 656d 6520 6e6f 7420 696e  if scheme not in
+00001620: 2028 2268 7474 7022 2c20 2268 7474 7073   ("http", "https
+00001630: 2229 3a0a 2020 2020 2020 2020 2020 2020  "):.            
+00001640: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+00001650: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00001660: 2020 6622 496e 7661 6c69 6420 5552 4c20    f"Invalid URL 
+00001670: 7363 6865 6d65 207b 7363 6865 6d65 7d20  scheme {scheme} 
+00001680: 666f 7220 4854 5450 5275 6e44 422c 206f  for HTTPRunDB, o
+00001690: 6e6c 7920 6874 7470 2873 2920 6973 2073  nly http(s) is s
+000016a0: 7570 706f 7274 6564 220a 2020 2020 2020  upported".      
+000016b0: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+000016c0: 2065 6e64 706f 696e 7420 3d20 7061 7273   endpoint = pars
+000016d0: 6564 5f75 726c 2e68 6f73 746e 616d 650a  ed_url.hostname.
+000016e0: 2020 2020 2020 2020 6966 2070 6172 7365          if parse
+000016f0: 645f 7572 6c2e 706f 7274 3a0a 2020 2020  d_url.port:.    
+00001700: 2020 2020 2020 2020 656e 6470 6f69 6e74          endpoint
+00001710: 202b 3d20 6622 3a7b 7061 7273 6564 5f75   += f":{parsed_u
+00001720: 726c 2e70 6f72 747d 220a 2020 2020 2020  rl.port}".      
+00001730: 2020 6261 7365 5f75 726c 203d 2066 227b    base_url = f"{
+00001740: 7061 7273 6564 5f75 726c 2e73 6368 656d  parsed_url.schem
+00001750: 657d 3a2f 2f7b 656e 6470 6f69 6e74 7d7b  e}://{endpoint}{
+00001760: 7061 7273 6564 5f75 726c 2e70 6174 687d  parsed_url.path}
+00001770: 220a 0a20 2020 2020 2020 2075 7365 726e  "..        usern
+00001780: 616d 6520 3d20 7061 7273 6564 5f75 726c  ame = parsed_url
+00001790: 2e75 7365 726e 616d 6520 6f72 2063 6f6e  .username or con
+000017a0: 6669 672e 6874 7470 6462 2e75 7365 720a  fig.httpdb.user.
+000017b0: 2020 2020 2020 2020 7061 7373 776f 7264          password
+000017c0: 203d 2070 6172 7365 645f 7572 6c2e 7061   = parsed_url.pa
+000017d0: 7373 776f 7264 206f 7220 636f 6e66 6967  ssword or config
+000017e0: 2e68 7474 7064 622e 7061 7373 776f 7264  .httpdb.password
+000017f0: 0a0a 2020 2020 2020 2020 7573 6572 6e61  ..        userna
+00001800: 6d65 2c20 7061 7373 776f 7264 2c20 746f  me, password, to
+00001810: 6b65 6e20 3d20 6d6c 7275 6e2e 706c 6174  ken = mlrun.plat
+00001820: 666f 726d 732e 6164 645f 6f72 5f72 6566  forms.add_or_ref
+00001830: 7265 7368 5f63 7265 6465 6e74 6961 6c73  resh_credentials
+00001840: 280a 2020 2020 2020 2020 2020 2020 7061  (.            pa
+00001850: 7273 6564 5f75 726c 2e68 6f73 746e 616d  rsed_url.hostnam
+00001860: 652c 2075 7365 726e 616d 652c 2070 6173  e, username, pas
+00001870: 7377 6f72 642c 2063 6f6e 6669 672e 6874  sword, config.ht
+00001880: 7470 6462 2e74 6f6b 656e 0a20 2020 2020  tpdb.token.     
+00001890: 2020 2029 0a0a 2020 2020 2020 2020 7365     )..        se
+000018a0: 6c66 2e62 6173 655f 7572 6c20 3d20 6261  lf.base_url = ba
+000018b0: 7365 5f75 726c 0a20 2020 2020 2020 2073  se_url.        s
+000018c0: 656c 662e 7573 6572 203d 2075 7365 726e  elf.user = usern
+000018d0: 616d 650a 2020 2020 2020 2020 7365 6c66  ame.        self
+000018e0: 2e70 6173 7377 6f72 6420 3d20 7061 7373  .password = pass
+000018f0: 776f 7264 0a20 2020 2020 2020 2073 656c  word.        sel
+00001900: 662e 746f 6b65 6e20 3d20 746f 6b65 6e0a  f.token = token.
+00001910: 0a20 2020 2064 6566 205f 5f72 6570 725f  .    def __repr_
+00001920: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
+00001930: 2063 6c73 203d 2073 656c 662e 5f5f 636c   cls = self.__cl
+00001940: 6173 735f 5f2e 5f5f 6e61 6d65 5f5f 0a20  ass__.__name__. 
+00001950: 2020 2020 2020 2072 6574 7572 6e20 6622         return f"
+00001960: 7b63 6c73 7d28 7b73 656c 662e 6261 7365  {cls}({self.base
+00001970: 5f75 726c 2172 7d29 220a 0a20 2020 2040  _url!r})"..    @
+00001980: 7374 6174 6963 6d65 7468 6f64 0a20 2020  staticmethod.   
+00001990: 2064 6566 2067 6574 5f61 7069 5f70 6174   def get_api_pat
+000019a0: 685f 7072 6566 6978 2876 6572 7369 6f6e  h_prefix(version
+000019b0: 3a20 7374 7220 3d20 4e6f 6e65 2920 2d3e  : str = None) ->
+000019c0: 2073 7472 3a0a 2020 2020 2020 2020 2222   str:.        ""
+000019d0: 220a 2020 2020 2020 2020 3a70 6172 616d  ".        :param
+000019e0: 2076 6572 7369 6f6e 3a20 4150 4920 7665   version: API ve
+000019f0: 7273 696f 6e20 746f 2075 7365 2c20 4e6f  rsion to use, No
+00001a00: 6e65 2028 7468 6520 6465 6661 756c 7429  ne (the default)
+00001a10: 2077 696c 6c20 6d65 616e 2074 6f20 7573   will mean to us
+00001a20: 6520 7468 6520 6465 6661 756c 7420 7661  e the default va
+00001a30: 6c75 6520 6672 6f6d 206d 6c72 756e 2e63  lue from mlrun.c
+00001a40: 6f6e 6669 672c 0a20 2020 2020 2020 2020  onfig,.         
+00001a50: 666f 7220 756e 2d76 6572 7369 6f6e 6564  for un-versioned
+00001a60: 2061 7069 2073 6574 2061 6e20 656d 7074   api set an empt
+00001a70: 7920 7374 7269 6e67 2e0a 2020 2020 2020  y string..      
+00001a80: 2020 2222 220a 2020 2020 2020 2020 6966    """.        if
+00001a90: 2076 6572 7369 6f6e 2069 7320 6e6f 7420   version is not 
+00001aa0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00001ab0: 2020 7265 7475 726e 2066 2261 7069 2f7b    return f"api/{
+00001ac0: 7665 7273 696f 6e7d 2220 6966 2076 6572  version}" if ver
+00001ad0: 7369 6f6e 2065 6c73 6520 2261 7069 220a  sion else "api".
+00001ae0: 0a20 2020 2020 2020 2061 7069 5f76 6572  .        api_ver
+00001af0: 7369 6f6e 5f70 6174 6820 3d20 280a 2020  sion_path = (.  
+00001b00: 2020 2020 2020 2020 2020 6622 6170 692f            f"api/
+00001b10: 7b63 6f6e 6669 672e 6170 695f 6261 7365  {config.api_base
+00001b20: 5f76 6572 7369 6f6e 7d22 2069 6620 636f  _version}" if co
+00001b30: 6e66 6967 2e61 7069 5f62 6173 655f 7665  nfig.api_base_ve
+00001b40: 7273 696f 6e20 656c 7365 2022 6170 6922  rsion else "api"
+00001b50: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+00001b60: 2020 2072 6574 7572 6e20 6170 695f 7665     return api_ve
+00001b70: 7273 696f 6e5f 7061 7468 0a0a 2020 2020  rsion_path..    
+00001b80: 6465 6620 6765 745f 6261 7365 5f61 7069  def get_base_api
+00001b90: 5f75 726c 2873 656c 662c 2070 6174 683a  _url(self, path:
+00001ba0: 2073 7472 2c20 7665 7273 696f 6e3a 2073   str, version: s
+00001bb0: 7472 203d 204e 6f6e 6529 202d 3e20 7374  tr = None) -> st
+00001bc0: 723a 0a20 2020 2020 2020 2070 6174 685f  r:.        path_
+00001bd0: 7072 6566 6978 203d 2073 656c 662e 6765  prefix = self.ge
+00001be0: 745f 6170 695f 7061 7468 5f70 7265 6669  t_api_path_prefi
+00001bf0: 7828 7665 7273 696f 6e29 0a20 2020 2020  x(version).     
+00001c00: 2020 2075 726c 203d 2066 227b 7365 6c66     url = f"{self
+00001c10: 2e62 6173 655f 7572 6c7d 2f7b 7061 7468  .base_url}/{path
+00001c20: 5f70 7265 6669 787d 2f7b 7061 7468 7d22  _prefix}/{path}"
+00001c30: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00001c40: 7572 6c0a 0a20 2020 2064 6566 2061 7069  url..    def api
+00001c50: 5f63 616c 6c28 0a20 2020 2020 2020 2073  _call(.        s
+00001c60: 656c 662c 0a20 2020 2020 2020 206d 6574  elf,.        met
+00001c70: 686f 642c 0a20 2020 2020 2020 2070 6174  hod,.        pat
+00001c80: 682c 0a20 2020 2020 2020 2065 7272 6f72  h,.        error
+00001c90: 3d4e 6f6e 652c 0a20 2020 2020 2020 2070  =None,.        p
+00001ca0: 6172 616d 733d 4e6f 6e65 2c0a 2020 2020  arams=None,.    
+00001cb0: 2020 2020 626f 6479 3d4e 6f6e 652c 0a20      body=None,. 
+00001cc0: 2020 2020 2020 206a 736f 6e3d 4e6f 6e65         json=None
+00001cd0: 2c0a 2020 2020 2020 2020 6865 6164 6572  ,.        header
+00001ce0: 733d 4e6f 6e65 2c0a 2020 2020 2020 2020  s=None,.        
+00001cf0: 7469 6d65 6f75 743d 3435 2c0a 2020 2020  timeout=45,.    
+00001d00: 2020 2020 7665 7273 696f 6e3d 4e6f 6e65      version=None
+00001d10: 2c0a 2020 2020 2920 2d3e 2072 6571 7565  ,.    ) -> reque
+00001d20: 7374 732e 5265 7370 6f6e 7365 3a0a 2020  sts.Response:.  
+00001d30: 2020 2020 2020 2222 2250 6572 666f 726d        """Perform
+00001d40: 2061 2064 6972 6563 7420 5245 5354 2041   a direct REST A
+00001d50: 5049 2063 616c 6c20 6f6e 2074 6865 203a  PI call on the :
+00001d60: 7079 3a6d 6f64 3a60 6d6c 7275 6e60 2041  py:mod:`mlrun` A
+00001d70: 5049 2073 6572 7665 722e 0a0a 2020 2020  PI server...    
+00001d80: 2020 2020 4361 7574 696f 6e3a 0a20 2020      Caution:.   
+00001d90: 2020 2020 2020 2020 2046 6f72 2061 6476           For adv
+00001da0: 616e 6365 6420 7573 6167 6520 2d20 7072  anced usage - pr
+00001db0: 6566 6572 2075 7369 6e67 2074 6865 2076  efer using the v
+00001dc0: 6172 696f 7573 2041 5049 7320 6578 706f  arious APIs expo
+00001dd0: 7365 6420 7468 726f 7567 6820 7468 6973  sed through this
+00001de0: 2063 6c61 7373 2c20 7261 7468 6572 2074   class, rather t
+00001df0: 6861 6e0a 2020 2020 2020 2020 2020 2020  han.            
+00001e00: 6469 7265 6374 6c79 2069 6e76 6f6b 696e  directly invokin
+00001e10: 6720 5245 5354 2063 616c 6c73 2e0a 0a20  g REST calls... 
+00001e20: 2020 2020 2020 203a 7061 7261 6d20 6d65         :param me
+00001e30: 7468 6f64 3a20 5245 5354 206d 6574 686f  thod: REST metho
+00001e40: 6420 2850 4f53 542c 2047 4554 2c20 5055  d (POST, GET, PU
+00001e50: 542e 2e2e 290a 2020 2020 2020 2020 3a70  T...).        :p
+00001e60: 6172 616d 2070 6174 683a 2050 6174 6820  aram path: Path 
+00001e70: 746f 2065 6e64 706f 696e 7420 6578 6563  to endpoint exec
+00001e80: 7574 6564 2c20 666f 7220 6578 616d 706c  uted, for exampl
+00001e90: 6520 6060 2270 726f 6a65 6374 7322 6060  e ``"projects"``
+00001ea0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00001eb0: 6572 726f 723a 2045 7272 6f72 2074 6f20  error: Error to 
+00001ec0: 7265 7475 726e 2069 6620 4150 4920 696e  return if API in
+00001ed0: 766f 6361 7469 6f6e 2066 6169 6c73 0a20  vocation fails. 
+00001ee0: 2020 2020 2020 203a 7061 7261 6d20 7061         :param pa
+00001ef0: 7261 6d73 3a20 5265 7374 2070 6172 616d  rams: Rest param
+00001f00: 6574 6572 732c 2070 6173 7365 6420 6173  eters, passed as
+00001f10: 2061 2064 6963 7469 6f6e 6172 793a 2060   a dictionary: `
+00001f20: 607b 223c 7061 7261 6d2d 6e61 6d65 3e22  `{"<param-name>"
+00001f30: 3a20 3c22 7061 7261 6d2d 7661 6c75 6522  : <"param-value"
+00001f40: 3e7d 6060 0a20 2020 2020 2020 203a 7061  >}``.        :pa
+00001f50: 7261 6d20 626f 6479 3a20 5061 796c 6f61  ram body: Payloa
+00001f60: 6420 746f 2062 6520 7061 7373 6564 2069  d to be passed i
+00001f70: 6e20 7468 6520 6361 6c6c 2e20 4966 2075  n the call. If u
+00001f80: 7369 6e67 204a 534f 4e20 6f62 6a65 6374  sing JSON object
+00001f90: 732c 2070 7265 6665 7220 7573 696e 6720  s, prefer using 
+00001fa0: 7468 6520 6060 6a73 6f6e 6060 2070 6172  the ``json`` par
+00001fb0: 616d 0a20 2020 2020 2020 203a 7061 7261  am.        :para
+00001fc0: 6d20 6a73 6f6e 3a20 4a53 4f4e 2070 6179  m json: JSON pay
+00001fd0: 6c6f 6164 2074 6f20 6265 2070 6173 7365  load to be passe
+00001fe0: 6420 696e 2074 6865 2063 616c 6c0a 2020  d in the call.  
+00001ff0: 2020 2020 2020 3a70 6172 616d 2068 6561        :param hea
+00002000: 6465 7273 3a20 5245 5354 2068 6561 6465  ders: REST heade
+00002010: 7273 2c20 7061 7373 6564 2061 7320 6120  rs, passed as a 
+00002020: 6469 6374 696f 6e61 7279 3a20 6060 7b22  dictionary: ``{"
+00002030: 3c68 6561 6465 722d 6e61 6d65 3e22 3a20  <header-name>": 
+00002040: 223c 6865 6164 6572 2d76 616c 7565 3e22  "<header-value>"
+00002050: 7d60 600a 2020 2020 2020 2020 3a70 6172  }``.        :par
+00002060: 616d 2074 696d 656f 7574 3a20 4150 4920  am timeout: API 
+00002070: 6361 6c6c 2074 696d 656f 7574 0a20 2020  call timeout.   
+00002080: 2020 2020 203a 7061 7261 6d20 7665 7273       :param vers
+00002090: 696f 6e3a 2041 5049 2076 6572 7369 6f6e  ion: API version
+000020a0: 2074 6f20 7573 652c 204e 6f6e 6520 2874   to use, None (t
+000020b0: 6865 2064 6566 6175 6c74 2920 7769 6c6c  he default) will
+000020c0: 206d 6561 6e20 746f 2075 7365 2074 6865   mean to use the
+000020d0: 2064 6566 6175 6c74 2076 616c 7565 2066   default value f
+000020e0: 726f 6d20 636f 6e66 6967 2c0a 2020 2020  rom config,.    
+000020f0: 2020 2020 2066 6f72 2075 6e2d 7665 7273       for un-vers
+00002100: 696f 6e65 6420 6170 6920 7365 7420 616e  ioned api set an
+00002110: 2065 6d70 7479 2073 7472 696e 672e 0a0a   empty string...
+00002120: 2020 2020 2020 2020 3a72 6574 7572 6e3a          :return:
+00002130: 2060 7265 7175 6573 7473 2e52 6573 706f   `requests.Respo
+00002140: 6e73 6560 2048 5454 5020 7265 7370 6f6e  nse` HTTP respon
+00002150: 7365 206f 626a 6563 740a 2020 2020 2020  se object.      
+00002160: 2020 2222 220a 2020 2020 2020 2020 7572    """.        ur
+00002170: 6c20 3d20 7365 6c66 2e67 6574 5f62 6173  l = self.get_bas
+00002180: 655f 6170 695f 7572 6c28 7061 7468 2c20  e_api_url(path, 
+00002190: 7665 7273 696f 6e29 0a20 2020 2020 2020  version).       
+000021a0: 206b 7720 3d20 7b0a 2020 2020 2020 2020   kw = {.        
+000021b0: 2020 2020 6b65 793a 2076 616c 7565 0a20      key: value. 
+000021c0: 2020 2020 2020 2020 2020 2066 6f72 206b             for k
+000021d0: 6579 2c20 7661 6c75 6520 696e 2028 0a20  ey, value in (. 
+000021e0: 2020 2020 2020 2020 2020 2020 2020 2028                 (
+000021f0: 2270 6172 616d 7322 2c20 7061 7261 6d73  "params", params
+00002200: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+00002210: 2020 2028 2264 6174 6122 2c20 626f 6479     ("data", body
+00002220: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+00002230: 2020 2028 226a 736f 6e22 2c20 6a73 6f6e     ("json", json
+00002240: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+00002250: 2020 2028 2268 6561 6465 7273 222c 2068     ("headers", h
+00002260: 6561 6465 7273 292c 0a20 2020 2020 2020  eaders),.       
+00002270: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+00002280: 2020 2069 6620 7661 6c75 6520 6973 206e     if value is n
+00002290: 6f74 204e 6f6e 650a 2020 2020 2020 2020  ot None.        
+000022a0: 7d0a 0a20 2020 2020 2020 2069 6620 7365  }..        if se
+000022b0: 6c66 2e75 7365 723a 0a20 2020 2020 2020  lf.user:.       
+000022c0: 2020 2020 206b 775b 2261 7574 6822 5d20       kw["auth"] 
+000022d0: 3d20 2873 656c 662e 7573 6572 2c20 7365  = (self.user, se
+000022e0: 6c66 2e70 6173 7377 6f72 6429 0a20 2020  lf.password).   
+000022f0: 2020 2020 2065 6c69 6620 7365 6c66 2e74       elif self.t
+00002300: 6f6b 656e 3a0a 2020 2020 2020 2020 2020  oken:.          
+00002310: 2020 2320 4967 7561 7a69 6f20 6175 7468    # Iguazio auth
+00002320: 2064 6f65 736e 2774 2073 7570 706f 7274   doesn't support
+00002330: 2070 6173 7369 6e67 2074 6f6b 656e 2074   passing token t
+00002340: 6872 6f75 6768 2062 6561 7265 722c 2073  hrough bearer, s
+00002350: 6f20 7573 6520 636f 6f6b 6965 2069 6e73  o use cookie ins
+00002360: 7465 6164 0a20 2020 2020 2020 2020 2020  tead.           
+00002370: 2069 6620 6d6c 7275 6e2e 706c 6174 666f   if mlrun.platfo
+00002380: 726d 732e 6967 7561 7a69 6f2e 6973 5f69  rms.iguazio.is_i
+00002390: 6775 617a 696f 5f73 6573 7369 6f6e 2873  guazio_session(s
+000023a0: 656c 662e 746f 6b65 6e29 3a0a 2020 2020  elf.token):.    
+000023b0: 2020 2020 2020 2020 2020 2020 7365 7373              sess
+000023c0: 696f 6e5f 636f 6f6b 6965 203d 2066 276a  ion_cookie = f'j
+000023d0: 3a7b 7b22 7369 6422 3a20 227b 7365 6c66  :{{"sid": "{self
+000023e0: 2e74 6f6b 656e 7d22 7d7d 270a 2020 2020  .token}"}}'.    
+000023f0: 2020 2020 2020 2020 2020 2020 636f 6f6b              cook
+00002400: 6965 7320 3d20 7b0a 2020 2020 2020 2020  ies = {.        
+00002410: 2020 2020 2020 2020 2020 2020 2273 6573              "ses
+00002420: 7369 6f6e 223a 2073 6573 7369 6f6e 5f63  sion": session_c
+00002430: 6f6f 6b69 652c 0a20 2020 2020 2020 2020  ookie,.         
+00002440: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
+00002450: 2020 2020 2020 2020 206b 775b 2263 6f6f           kw["coo
+00002460: 6b69 6573 225d 203d 2063 6f6f 6b69 6573  kies"] = cookies
+00002470: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+00002480: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00002490: 2020 2069 6620 2241 7574 686f 7269 7a61     if "Authoriza
+000024a0: 7469 6f6e 2220 6e6f 7420 696e 206b 772e  tion" not in kw.
+000024b0: 7365 7464 6566 6175 6c74 2822 6865 6164  setdefault("head
+000024c0: 6572 7322 2c20 7b7d 293a 0a20 2020 2020  ers", {}):.     
+000024d0: 2020 2020 2020 2020 2020 2020 2020 206b                 k
+000024e0: 775b 2268 6561 6465 7273 225d 2e75 7064  w["headers"].upd
+000024f0: 6174 6528 7b22 4175 7468 6f72 697a 6174  ate({"Authorizat
+00002500: 696f 6e22 3a20 2242 6561 7265 7220 2220  ion": "Bearer " 
+00002510: 2b20 7365 6c66 2e74 6f6b 656e 7d29 0a0a  + self.token})..
+00002520: 2020 2020 2020 2020 6966 206d 6c72 756e          if mlrun
+00002530: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
+00002540: 4865 6164 6572 4e61 6d65 732e 636c 6965  HeaderNames.clie
+00002550: 6e74 5f76 6572 7369 6f6e 206e 6f74 2069  nt_version not i
+00002560: 6e20 6b77 2e73 6574 6465 6661 756c 7428  n kw.setdefault(
+00002570: 0a20 2020 2020 2020 2020 2020 2022 6865  .            "he
+00002580: 6164 6572 7322 2c20 7b7d 0a20 2020 2020  aders", {}.     
+00002590: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
+000025a0: 2020 6b77 5b22 6865 6164 6572 7322 5d2e    kw["headers"].
+000025b0: 7570 6461 7465 280a 2020 2020 2020 2020  update(.        
+000025c0: 2020 2020 2020 2020 7b0a 2020 2020 2020          {.      
+000025d0: 2020 2020 2020 2020 2020 2020 2020 6d6c                ml
+000025e0: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
+000025f0: 6173 2e48 6561 6465 724e 616d 6573 2e63  as.HeaderNames.c
+00002600: 6c69 656e 745f 7665 7273 696f 6e3a 2073  lient_version: s
+00002610: 656c 662e 636c 6965 6e74 5f76 6572 7369  elf.client_versi
+00002620: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
+00002630: 2020 2020 2020 2020 6d6c 7275 6e2e 636f          mlrun.co
+00002640: 6d6d 6f6e 2e73 6368 656d 6173 2e48 6561  mmon.schemas.Hea
+00002650: 6465 724e 616d 6573 2e70 7974 686f 6e5f  derNames.python_
+00002660: 7665 7273 696f 6e3a 2073 656c 662e 7079  version: self.py
+00002670: 7468 6f6e 5f76 6572 7369 6f6e 2c0a 2020  thon_version,.  
+00002680: 2020 2020 2020 2020 2020 2020 2020 7d0a                }.
+00002690: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+000026a0: 2020 2020 2020 2023 2072 6571 7565 7374         # request
+000026b0: 7320 6e6f 206c 6f6e 6765 7220 7375 7070  s no longer supp
+000026c0: 6f72 7473 2068 6561 6465 7220 7661 6c75  orts header valu
+000026d0: 6573 2074 6f20 6265 2065 6e75 6d20 2868  es to be enum (h
+000026e0: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
+000026f0: 6d2f 7073 662f 7265 7175 6573 7473 2f70  m/psf/requests/p
+00002700: 756c 6c2f 3631 3534 290a 2020 2020 2020  ull/6154).      
+00002710: 2020 2320 636f 6e76 6572 7420 746f 2073    # convert to s
+00002720: 7472 696e 6773 2e20 446f 2074 6865 2073  trings. Do the s
+00002730: 616d 6520 666f 7220 7061 7261 6d73 2066  ame for params f
+00002740: 6f72 206e 6963 656e 6573 730a 2020 2020  or niceness.    
+00002750: 2020 2020 666f 7220 6469 6374 5f20 696e      for dict_ in
+00002760: 205b 6865 6164 6572 732c 2070 6172 616d   [headers, param
+00002770: 735d 3a0a 2020 2020 2020 2020 2020 2020  s]:.            
+00002780: 6966 2064 6963 745f 2069 7320 6e6f 7420  if dict_ is not 
+00002790: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+000027a0: 2020 2020 2020 666f 7220 6b65 7920 696e        for key in
+000027b0: 2064 6963 745f 2e6b 6579 7328 293a 0a20   dict_.keys():. 
+000027c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000027d0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+000027e0: 2864 6963 745f 5b6b 6579 5d2c 2065 6e75  (dict_[key], enu
+000027f0: 6d2e 456e 756d 293a 0a20 2020 2020 2020  m.Enum):.       
+00002800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002810: 2064 6963 745f 5b6b 6579 5d20 3d20 6469   dict_[key] = di
+00002820: 6374 5f5b 6b65 795d 2e76 616c 7565 0a0a  ct_[key].value..
+00002830: 2020 2020 2020 2020 2320 6966 2074 6865          # if the
+00002840: 206d 6574 686f 6420 6973 2050 4f53 542c   method is POST,
+00002850: 2077 6520 6e65 6564 2074 6f20 7570 6461   we need to upda
+00002860: 7465 2074 6865 2073 6573 7369 6f6e 2077  te the session w
+00002870: 6974 6820 7468 6520 6170 7072 6f70 7269  ith the appropri
+00002880: 6174 6520 7265 7472 7920 706f 6c69 6379  ate retry policy
+00002890: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
+000028a0: 7365 6c66 2e73 6573 7369 6f6e 206f 7220  self.session or 
+000028b0: 6d65 7468 6f64 203d 3d20 2250 4f53 5422  method == "POST"
+000028c0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+000028d0: 7472 795f 6f6e 5f70 6f73 7420 3d20 7365  try_on_post = se
+000028e0: 6c66 2e5f 6973 5f72 6574 7279 5f6f 6e5f  lf._is_retry_on_
+000028f0: 706f 7374 5f61 6c6c 6f77 6564 286d 6574  post_allowed(met
+00002900: 686f 642c 2070 6174 6829 0a20 2020 2020  hod, path).     
+00002910: 2020 2020 2020 2073 656c 662e 7365 7373         self.sess
+00002920: 696f 6e20 3d20 7365 6c66 2e5f 696e 6974  ion = self._init
+00002930: 5f73 6573 7369 6f6e 2872 6574 7279 5f6f  _session(retry_o
+00002940: 6e5f 706f 7374 290a 0a20 2020 2020 2020  n_post)..       
+00002950: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
+00002960: 2020 7265 7370 6f6e 7365 203d 2073 656c    response = sel
+00002970: 662e 7365 7373 696f 6e2e 7265 7175 6573  f.session.reques
+00002980: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
+00002990: 2020 206d 6574 686f 642c 0a20 2020 2020     method,.     
+000029a0: 2020 2020 2020 2020 2020 2075 726c 2c0a             url,.
+000029b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000029c0: 7469 6d65 6f75 743d 7469 6d65 6f75 742c  timeout=timeout,
+000029d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000029e0: 2076 6572 6966 793d 636f 6e66 6967 2e68   verify=config.h
+000029f0: 7474 7064 622e 6874 7470 2e76 6572 6966  ttpdb.http.verif
+00002a00: 792c 0a20 2020 2020 2020 2020 2020 2020  y,.             
+00002a10: 2020 202a 2a6b 772c 0a20 2020 2020 2020     **kw,.       
+00002a20: 2020 2020 2029 0a20 2020 2020 2020 2065       ).        e
+00002a30: 7863 6570 7420 7265 7175 6573 7473 2e52  xcept requests.R
+00002a40: 6571 7565 7374 4578 6365 7074 696f 6e20  equestException 
+00002a50: 6173 2065 7863 3a0a 2020 2020 2020 2020  as exc:.        
+00002a60: 2020 2020 6572 726f 7220 3d20 6622 7b65      error = f"{e
+00002a70: 7272 5f74 6f5f 7374 7228 6578 6329 7d3a  rr_to_str(exc)}:
+00002a80: 207b 6572 726f 727d 2220 6966 2065 7272   {error}" if err
+00002a90: 6f72 2065 6c73 6520 6572 725f 746f 5f73  or else err_to_s
+00002aa0: 7472 2865 7863 290a 2020 2020 2020 2020  tr(exc).        
+00002ab0: 2020 2020 7261 6973 6520 6d6c 7275 6e2e      raise mlrun.
+00002ac0: 6572 726f 7273 2e4d 4c52 756e 5275 6e74  errors.MLRunRunt
+00002ad0: 696d 6545 7272 6f72 2865 7272 6f72 2920  imeError(error) 
+00002ae0: 6672 6f6d 2065 7863 0a0a 2020 2020 2020  from exc..      
+00002af0: 2020 6966 206e 6f74 2072 6573 706f 6e73    if not respons
+00002b00: 652e 6f6b 3a0a 2020 2020 2020 2020 2020  e.ok:.          
+00002b10: 2020 6966 2072 6573 706f 6e73 652e 636f    if response.co
+00002b20: 6e74 656e 743a 0a20 2020 2020 2020 2020  ntent:.         
+00002b30: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
+00002b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002b50: 6461 7461 203d 2072 6573 706f 6e73 652e  data = response.
+00002b60: 6a73 6f6e 2829 0a20 2020 2020 2020 2020  json().         
+00002b70: 2020 2020 2020 2020 2020 2065 7272 6f72             error
+00002b80: 5f64 6574 6169 6c73 203d 2064 6174 612e  _details = data.
+00002b90: 6765 7428 2264 6574 6169 6c22 2c20 7b7d  get("detail", {}
+00002ba0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00002bb0: 2020 2020 2020 6966 206e 6f74 2065 7272        if not err
+00002bc0: 6f72 5f64 6574 6169 6c73 3a0a 2020 2020  or_details:.    
+00002bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002be0: 2020 2020 6c6f 6767 6572 2e77 6172 6e69      logger.warni
+00002bf0: 6e67 2822 4661 696c 6564 2070 6172 7369  ng("Failed parsi
+00002c00: 6e67 2065 7272 6f72 2072 6573 706f 6e73  ng error respons
+00002c10: 6520 626f 6479 222c 2064 6174 613d 6461  e body", data=da
+00002c20: 7461 290a 2020 2020 2020 2020 2020 2020  ta).            
+00002c30: 2020 2020 6578 6365 7074 2045 7863 6570      except Excep
+00002c40: 7469 6f6e 3a0a 2020 2020 2020 2020 2020  tion:.          
+00002c50: 2020 2020 2020 2020 2020 6572 726f 725f            error_
+00002c60: 6465 7461 696c 7320 3d20 2222 0a20 2020  details = "".   
+00002c70: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00002c80: 6572 726f 725f 6465 7461 696c 733a 0a20  error_details:. 
+00002c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002ca0: 2020 2065 7272 6f72 5f64 6574 6169 6c73     error_details
+00002cb0: 203d 2066 2264 6574 6169 6c73 3a20 7b65   = f"details: {e
+00002cc0: 7272 6f72 5f64 6574 6169 6c73 7d22 0a20  rror_details}". 
+00002cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002ce0: 2020 2065 7272 6f72 203d 2066 227b 6572     error = f"{er
+00002cf0: 726f 727d 207b 6572 726f 725f 6465 7461  ror} {error_deta
+00002d00: 696c 737d 2220 6966 2065 7272 6f72 2065  ils}" if error e
+00002d10: 6c73 6520 6572 726f 725f 6465 7461 696c  lse error_detail
+00002d20: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
+00002d30: 2020 2020 2020 6d6c 7275 6e2e 6572 726f        mlrun.erro
+00002d40: 7273 2e72 6169 7365 5f66 6f72 5f73 7461  rs.raise_for_sta
+00002d50: 7475 7328 7265 7370 6f6e 7365 2c20 6572  tus(response, er
+00002d60: 726f 7229 0a0a 2020 2020 2020 2020 2020  ror)..          
+00002d70: 2020 6d6c 7275 6e2e 6572 726f 7273 2e72    mlrun.errors.r
+00002d80: 6169 7365 5f66 6f72 5f73 7461 7475 7328  aise_for_status(
+00002d90: 7265 7370 6f6e 7365 2c20 6572 726f 7229  response, error)
+00002da0: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00002db0: 2072 6573 706f 6e73 650a 0a20 2020 2064   response..    d
+00002dc0: 6566 205f 696e 6974 5f73 6573 7369 6f6e  ef _init_session
+00002dd0: 2873 656c 662c 2072 6574 7279 5f6f 6e5f  (self, retry_on_
+00002de0: 706f 7374 3a20 626f 6f6c 203d 2046 616c  post: bool = Fal
+00002df0: 7365 293a 0a20 2020 2020 2020 2072 6574  se):.        ret
+00002e00: 7572 6e20 6d6c 7275 6e2e 7574 696c 732e  urn mlrun.utils.
+00002e10: 4854 5450 5365 7373 696f 6e57 6974 6852  HTTPSessionWithR
+00002e20: 6574 7279 280a 2020 2020 2020 2020 2020  etry(.          
+00002e30: 2020 7265 7472 795f 6f6e 5f65 7863 6570    retry_on_excep
+00002e40: 7469 6f6e 3d63 6f6e 6669 672e 6874 7470  tion=config.http
+00002e50: 6462 2e72 6574 7279 5f61 7069 5f63 616c  db.retry_api_cal
+00002e60: 6c5f 6f6e 5f65 7863 6570 7469 6f6e 0a20  l_on_exception. 
+00002e70: 2020 2020 2020 2020 2020 203d 3d20 6d6c             == ml
+00002e80: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
+00002e90: 6173 2e48 5454 5053 6573 7369 6f6e 5265  as.HTTPSessionRe
+00002ea0: 7472 794d 6f64 652e 656e 6162 6c65 642e  tryMode.enabled.
+00002eb0: 7661 6c75 652c 0a20 2020 2020 2020 2020  value,.         
+00002ec0: 2020 2072 6574 7279 5f6f 6e5f 706f 7374     retry_on_post
+00002ed0: 3d72 6574 7279 5f6f 6e5f 706f 7374 2c0a  =retry_on_post,.
+00002ee0: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
+00002ef0: 6566 205f 7061 7468 5f6f 6628 7365 6c66  ef _path_of(self
+00002f00: 2c20 7265 736f 7572 6365 2c20 7072 6f6a  , resource, proj
+00002f10: 6563 742c 2075 6964 3d4e 6f6e 6529 3a0a  ect, uid=None):.
+00002f20: 2020 2020 2020 2020 7072 6f6a 6563 7420          project 
+00002f30: 3d20 7072 6f6a 6563 7420 6f72 2063 6f6e  = project or con
+00002f40: 6669 672e 6465 6661 756c 745f 7072 6f6a  fig.default_proj
+00002f50: 6563 740a 2020 2020 2020 2020 5f70 6174  ect.        _pat
+00002f60: 6820 3d20 6622 7072 6f6a 6563 7473 2f7b  h = f"projects/{
+00002f70: 7072 6f6a 6563 747d 2f7b 7265 736f 7572  project}/{resour
+00002f80: 6365 7d22 0a20 2020 2020 2020 2069 6620  ce}".        if 
+00002f90: 7569 643a 0a20 2020 2020 2020 2020 2020  uid:.           
+00002fa0: 205f 7061 7468 202b 3d20 6622 2f7b 7569   _path += f"/{ui
+00002fb0: 647d 220a 2020 2020 2020 2020 7265 7475  d}".        retu
+00002fc0: 726e 205f 7061 7468 0a0a 2020 2020 6465  rn _path..    de
+00002fd0: 6620 5f69 735f 7265 7472 795f 6f6e 5f70  f _is_retry_on_p
+00002fe0: 6f73 745f 616c 6c6f 7765 6428 7365 6c66  ost_allowed(self
+00002ff0: 2c20 6d65 7468 6f64 2c20 7061 7468 3a20  , method, path: 
+00003000: 7374 7229 3a0a 2020 2020 2020 2020 2222  str):.        ""
+00003010: 220a 2020 2020 2020 2020 4368 6563 6b20  ".        Check 
+00003020: 6966 2074 6865 2067 6976 656e 2070 6174  if the given pat
+00003030: 6820 6973 2061 6c6c 6f77 6564 2074 6f20  h is allowed to 
+00003040: 6265 2072 6574 7269 6564 206f 6e20 504f  be retried on PO
+00003050: 5354 206d 6574 686f 640a 2020 2020 2020  ST method.      
+00003060: 2020 3a70 6172 616d 206d 6574 686f 643a    :param method:
+00003070: 2020 7573 6564 2074 6f20 7665 7269 6679    used to verify
+00003080: 2074 6861 7420 7468 6520 6d65 7468 6f64   that the method
+00003090: 2069 7320 504f 5354 2073 696e 6365 2069   is POST since i
+000030a0: 6620 7468 6572 6520 6973 206e 6f20 7365  f there is no se
+000030b0: 7373 696f 6e20 696e 6974 6961 6c69 7a65  ssion initialize
+000030c0: 6420 7468 6572 6520 6973 206e 6f0a 2020  d there is no.  
+000030d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000030e0: 2020 2020 2020 6e65 6564 2074 6f20 696e        need to in
+000030f0: 6974 6961 6c69 7a65 2069 7420 7769 7468  itialize it with
+00003100: 2072 6574 7279 2070 6f6c 6963 7920 666f   retry policy fo
+00003110: 7220 504f 5354 2077 6865 6e20 7468 6520  r POST when the 
+00003120: 6d65 7468 6f64 2069 7320 6e6f 7420 504f  method is not PO
+00003130: 5354 0a20 2020 2020 2020 203a 7061 7261  ST.        :para
+00003140: 6d20 7061 7468 3a20 2020 2074 6865 2070  m path:    the p
+00003150: 6174 6820 746f 2063 6865 636b 0a20 2020  ath to check.   
+00003160: 2020 2020 203a 7265 7475 726e 3a20 2020       :return:   
+00003170: 2020 2020 2054 7275 6520 6966 2074 6865       True if the
+00003180: 2070 6174 6820 6973 2061 6c6c 6f77 6564   path is allowed
+00003190: 2074 6f20 6265 2072 6574 7269 6564 206f   to be retried o
+000031a0: 6e20 504f 5354 206d 6574 686f 6420 616e  n POST method an
+000031b0: 6420 6d65 7468 6f64 2069 7320 504f 5354  d method is POST
+000031c0: 2c20 4661 6c73 6520 6f74 6865 7277 6973  , False otherwis
+000031d0: 650a 2020 2020 2020 2020 2222 220a 2020  e.        """.  
+000031e0: 2020 2020 2020 7265 7475 726e 206d 6574        return met
+000031f0: 686f 6420 3d3d 2022 504f 5354 2220 616e  hod == "POST" an
+00003200: 6420 616e 7928 0a20 2020 2020 2020 2020  d any(.         
+00003210: 2020 2072 652e 6d61 7463 6828 7265 6765     re.match(rege
+00003220: 782c 2070 6174 6829 2066 6f72 2072 6567  x, path) for reg
+00003230: 6578 2069 6e20 7365 6c66 2e52 4554 5249  ex in self.RETRI
+00003240: 4142 4c45 5f50 4f53 545f 5041 5448 530a  ABLE_POST_PATHS.
+00003250: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
+00003260: 6566 2063 6f6e 6e65 6374 2873 656c 662c  ef connect(self,
+00003270: 2073 6563 7265 7473 3d4e 6f6e 6529 3a0a   secrets=None):.
+00003280: 2020 2020 2020 2020 2222 2243 6f6e 6e65          """Conne
+00003290: 6374 2074 6f20 7468 6520 4d4c 5275 6e20  ct to the MLRun 
+000032a0: 4150 4920 7365 7276 6572 2e20 4d75 7374  API server. Must
+000032b0: 2062 6520 6361 6c6c 6564 2070 7269 6f72   be called prior
+000032c0: 2074 6f20 6578 6563 7574 696e 6720 616e   to executing an
+000032d0: 7920 6f74 6865 7220 6d65 7468 6f64 2e0a  y other method..
+000032e0: 2020 2020 2020 2020 5468 6520 636f 6465          The code
+000032f0: 2075 7469 6c69 7a65 7320 7468 6520 5552   utilizes the UR
+00003300: 4c20 666f 7220 7468 6520 4150 4920 7365  L for the API se
+00003310: 7276 6572 2066 726f 6d20 7468 6520 636f  rver from the co
+00003320: 6e66 6967 7572 6174 696f 6e20 2d20 6060  nfiguration - ``
+00003330: 636f 6e66 6967 2e64 6270 6174 6860 602e  config.dbpath``.
+00003340: 0a0a 2020 2020 2020 2020 466f 7220 6578  ..        For ex
+00003350: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
+00003360: 2020 2020 2063 6f6e 6669 672e 6462 7061       config.dbpa
+00003370: 7468 203d 2063 6f6e 6669 672e 6462 7061  th = config.dbpa
+00003380: 7468 206f 7220 2768 7474 703a 2f2f 6d6c  th or 'http://ml
+00003390: 7275 6e2d 6170 693a 3830 3830 270a 2020  run-api:8080'.  
+000033a0: 2020 2020 2020 2020 2020 6462 203d 2067            db = g
+000033b0: 6574 5f72 756e 5f64 6228 292e 636f 6e6e  et_run_db().conn
+000033c0: 6563 7428 290a 2020 2020 2020 2020 2222  ect().        ""
+000033d0: 220a 2020 2020 2020 2020 2320 6861 636b  ".        # hack
+000033e0: 2074 6f20 616c 6c6f 7720 756e 6974 2074   to allow unit t
+000033f0: 6573 7473 2074 6f20 696e 7374 616e 7469  ests to instanti
+00003400: 6174 6520 4854 5450 5275 6e44 4220 7769  ate HTTPRunDB wi
+00003410: 7468 6f75 7420 6120 7265 616c 2073 6572  thout a real ser
+00003420: 7665 7220 6265 6869 6e64 0a20 2020 2020  ver behind.     
+00003430: 2020 2069 6620 226d 6f63 6b2d 7365 7276     if "mock-serv
+00003440: 6572 2220 696e 2073 656c 662e 6261 7365  er" in self.base
+00003450: 5f75 726c 3a0a 2020 2020 2020 2020 2020  _url:.          
+00003460: 2020 7265 7475 726e 0a20 2020 2020 2020    return.       
+00003470: 2072 6573 7020 3d20 7365 6c66 2e61 7069   resp = self.api
+00003480: 5f63 616c 6c28 2247 4554 222c 2022 636c  _call("GET", "cl
+00003490: 6965 6e74 2d73 7065 6322 2c20 7469 6d65  ient-spec", time
+000034a0: 6f75 743d 3529 0a20 2020 2020 2020 2074  out=5).        t
+000034b0: 7279 3a0a 2020 2020 2020 2020 2020 2020  ry:.            
+000034c0: 7365 7276 6572 5f63 6667 203d 2072 6573  server_cfg = res
+000034d0: 702e 6a73 6f6e 2829 0a20 2020 2020 2020  p.json().       
+000034e0: 2020 2020 2073 656c 662e 7365 7276 6572       self.server
+000034f0: 5f76 6572 7369 6f6e 203d 2073 6572 7665  _version = serve
+00003500: 725f 6366 675b 2276 6572 7369 6f6e 225d  r_cfg["version"]
+00003510: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00003520: 662e 5f76 616c 6964 6174 655f 7665 7273  f._validate_vers
+00003530: 696f 6e5f 636f 6d70 6174 6962 696c 6974  ion_compatibilit
+00003540: 7928 7365 6c66 2e73 6572 7665 725f 7665  y(self.server_ve
+00003550: 7273 696f 6e2c 2063 6f6e 6669 672e 7665  rsion, config.ve
+00003560: 7273 696f 6e29 0a20 2020 2020 2020 2020  rsion).         
+00003570: 2020 2063 6f6e 6669 672e 6e61 6d65 7370     config.namesp
+00003580: 6163 6520 3d20 636f 6e66 6967 2e6e 616d  ace = config.nam
+00003590: 6573 7061 6365 206f 7220 7365 7276 6572  espace or server
+000035a0: 5f63 6667 2e67 6574 2822 6e61 6d65 7370  _cfg.get("namesp
+000035b0: 6163 6522 290a 2020 2020 2020 2020 2020  ace").          
+000035c0: 2020 6966 2028 0a20 2020 2020 2020 2020    if (.         
+000035d0: 2020 2020 2020 2022 6e61 6d65 7370 6163         "namespac
+000035e0: 6522 2069 6e20 7365 7276 6572 5f63 6667  e" in server_cfg
+000035f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00003600: 2061 6e64 2073 6572 7665 725f 6366 675b   and server_cfg[
+00003610: 226e 616d 6573 7061 6365 225d 2021 3d20  "namespace"] != 
+00003620: 636f 6e66 6967 2e6e 616d 6573 7061 6365  config.namespace
+00003630: 0a20 2020 2020 2020 2020 2020 2029 3a0a  .            ):.
+00003640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003650: 6c6f 6767 6572 2e77 6172 6e69 6e67 280a  logger.warning(.
+00003660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003670: 2020 2020 6622 7761 726e 696e 6721 2c20      f"warning!, 
+00003680: 7365 7276 6572 2028 7b73 6572 7665 725f  server ({server_
+00003690: 6366 675b 276e 616d 6573 7061 6365 275d  cfg['namespace']
+000036a0: 7d29 2061 6e64 2063 6c69 656e 7420 287b  }) and client ({
+000036b0: 636f 6e66 6967 2e6e 616d 6573 7061 6365  config.namespace
+000036c0: 7d29 220a 2020 2020 2020 2020 2020 2020  })".            
+000036d0: 2020 2020 2020 2020 2220 6e61 6d65 7370          " namesp
+000036e0: 6163 6520 646f 6e27 7420 6d61 7463 6822  ace don't match"
+000036f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00003700: 2029 0a20 2020 2020 2020 2020 2020 2063   ).            c
+00003710: 6f6e 6669 672e 6365 203d 2073 6572 7665  onfig.ce = serve
+00003720: 725f 6366 672e 6765 7428 2263 6522 2920  r_cfg.get("ce") 
+00003730: 6f72 2063 6f6e 6669 672e 6365 0a0a 2020  or config.ce..  
+00003740: 2020 2020 2020 2020 2020 2320 6765 7420            # get 
+00003750: 6465 6661 756c 7473 2066 726f 6d20 7265  defaults from re
+00003760: 6d6f 7465 2073 6572 7665 720a 2020 2020  mote server.    
+00003770: 2020 2020 2020 2020 636f 6e66 6967 2e72          config.r
+00003780: 656d 6f74 655f 686f 7374 203d 2063 6f6e  emote_host = con
+00003790: 6669 672e 7265 6d6f 7465 5f68 6f73 7420  fig.remote_host 
+000037a0: 6f72 2073 6572 7665 725f 6366 672e 6765  or server_cfg.ge
+000037b0: 7428 2272 656d 6f74 655f 686f 7374 2229  t("remote_host")
+000037c0: 0a20 2020 2020 2020 2020 2020 2063 6f6e  .            con
+000037d0: 6669 672e 6d70 696a 6f62 5f63 7264 5f76  fig.mpijob_crd_v
+000037e0: 6572 7369 6f6e 203d 2063 6f6e 6669 672e  ersion = config.
+000037f0: 6d70 696a 6f62 5f63 7264 5f76 6572 7369  mpijob_crd_versi
+00003800: 6f6e 206f 7220 7365 7276 6572 5f63 6667  on or server_cfg
+00003810: 2e67 6574 280a 2020 2020 2020 2020 2020  .get(.          
+00003820: 2020 2020 2020 226d 7069 6a6f 625f 6372        "mpijob_cr
+00003830: 645f 7665 7273 696f 6e22 0a20 2020 2020  d_version".     
+00003840: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00003850: 2020 2020 2063 6f6e 6669 672e 7569 2e75       config.ui.u
+00003860: 726c 203d 2063 6f6e 6669 672e 7265 736f  rl = config.reso
+00003870: 6c76 655f 7569 5f75 726c 2829 206f 7220  lve_ui_url() or 
+00003880: 7365 7276 6572 5f63 6667 2e67 6574 2822  server_cfg.get("
+00003890: 7569 5f75 726c 2229 0a20 2020 2020 2020  ui_url").       
+000038a0: 2020 2020 2063 6f6e 6669 672e 6172 7469       config.arti
+000038b0: 6661 6374 5f70 6174 6820 3d20 636f 6e66  fact_path = conf
+000038c0: 6967 2e61 7274 6966 6163 745f 7061 7468  ig.artifact_path
+000038d0: 206f 7220 7365 7276 6572 5f63 6667 2e67   or server_cfg.g
+000038e0: 6574 280a 2020 2020 2020 2020 2020 2020  et(.            
+000038f0: 2020 2020 2261 7274 6966 6163 745f 7061      "artifact_pa
+00003900: 7468 220a 2020 2020 2020 2020 2020 2020  th".            
+00003910: 290a 2020 2020 2020 2020 2020 2020 636f  ).            co
+00003920: 6e66 6967 2e73 7061 726b 5f61 7070 5f69  nfig.spark_app_i
+00003930: 6d61 6765 203d 2063 6f6e 6669 672e 7370  mage = config.sp
+00003940: 6172 6b5f 6170 705f 696d 6167 6520 6f72  ark_app_image or
+00003950: 2073 6572 7665 725f 6366 672e 6765 7428   server_cfg.get(
+00003960: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00003970: 2022 7370 6172 6b5f 6170 705f 696d 6167   "spark_app_imag
+00003980: 6522 0a20 2020 2020 2020 2020 2020 2029  e".            )
+00003990: 0a20 2020 2020 2020 2020 2020 2063 6f6e  .            con
+000039a0: 6669 672e 7370 6172 6b5f 6170 705f 696d  fig.spark_app_im
+000039b0: 6167 655f 7461 6720 3d20 636f 6e66 6967  age_tag = config
+000039c0: 2e73 7061 726b 5f61 7070 5f69 6d61 6765  .spark_app_image
+000039d0: 5f74 6167 206f 7220 7365 7276 6572 5f63  _tag or server_c
+000039e0: 6667 2e67 6574 280a 2020 2020 2020 2020  fg.get(.        
+000039f0: 2020 2020 2020 2020 2273 7061 726b 5f61          "spark_a
+00003a00: 7070 5f69 6d61 6765 5f74 6167 220a 2020  pp_image_tag".  
+00003a10: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00003a20: 2020 2020 2020 2020 636f 6e66 6967 2e73          config.s
+00003a30: 7061 726b 5f68 6973 746f 7279 5f73 6572  park_history_ser
+00003a40: 7665 725f 7061 7468 203d 2028 0a20 2020  ver_path = (.   
+00003a50: 2020 2020 2020 2020 2020 2020 2063 6f6e               con
+00003a60: 6669 672e 7370 6172 6b5f 6869 7374 6f72  fig.spark_histor
+00003a70: 795f 7365 7276 6572 5f70 6174 680a 2020  y_server_path.  
+00003a80: 2020 2020 2020 2020 2020 2020 2020 6f72                or
+00003a90: 2073 6572 7665 725f 6366 672e 6765 7428   server_cfg.get(
+00003aa0: 2273 7061 726b 5f68 6973 746f 7279 5f73  "spark_history_s
+00003ab0: 6572 7665 725f 7061 7468 2229 0a20 2020  erver_path").   
+00003ac0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00003ad0: 2020 2020 2020 2063 6f6e 6669 672e 6874         config.ht
+00003ae0: 7470 6462 2e62 7569 6c64 6572 2e64 6f63  tpdb.builder.doc
+00003af0: 6b65 725f 7265 6769 7374 7279 203d 2028  ker_registry = (
+00003b00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00003b10: 2063 6f6e 6669 672e 6874 7470 6462 2e62   config.httpdb.b
+00003b20: 7569 6c64 6572 2e64 6f63 6b65 725f 7265  uilder.docker_re
+00003b30: 6769 7374 7279 0a20 2020 2020 2020 2020  gistry.         
+00003b40: 2020 2020 2020 206f 7220 7365 7276 6572         or server
+00003b50: 5f63 6667 2e67 6574 2822 646f 636b 6572  _cfg.get("docker
+00003b60: 5f72 6567 6973 7472 7922 290a 2020 2020  _registry").    
+00003b70: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00003b80: 2020 2020 2020 636f 6e66 6967 2e68 7474        config.htt
+00003b90: 7064 622e 6170 695f 7572 6c20 3d20 636f  pdb.api_url = co
+00003ba0: 6e66 6967 2e68 7474 7064 622e 6170 695f  nfig.httpdb.api_
+00003bb0: 7572 6c20 6f72 2073 6572 7665 725f 6366  url or server_cf
+00003bc0: 672e 6765 7428 2261 7069 5f75 726c 2229  g.get("api_url")
+00003bd0: 0a20 2020 2020 2020 2020 2020 2063 6f6e  .            con
+00003be0: 6669 672e 6e75 636c 696f 5f76 6572 7369  fig.nuclio_versi
+00003bf0: 6f6e 203d 2063 6f6e 6669 672e 6e75 636c  on = config.nucl
+00003c00: 696f 5f76 6572 7369 6f6e 206f 7220 7365  io_version or se
+00003c10: 7276 6572 5f63 6667 2e67 6574 280a 2020  rver_cfg.get(.  
+00003c20: 2020 2020 2020 2020 2020 2020 2020 226e                "n
+00003c30: 7563 6c69 6f5f 7665 7273 696f 6e22 0a20  uclio_version". 
+00003c40: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00003c50: 2020 2020 2020 2020 2063 6f6e 6669 672e           config.
+00003c60: 6465 6661 756c 745f 6675 6e63 7469 6f6e  default_function
+00003c70: 5f70 7269 6f72 6974 795f 636c 6173 735f  _priority_class_
+00003c80: 6e61 6d65 203d 2028 0a20 2020 2020 2020  name = (.       
+00003c90: 2020 2020 2020 2020 2063 6f6e 6669 672e           config.
+00003ca0: 6465 6661 756c 745f 6675 6e63 7469 6f6e  default_function
+00003cb0: 5f70 7269 6f72 6974 795f 636c 6173 735f  _priority_class_
+00003cc0: 6e61 6d65 0a20 2020 2020 2020 2020 2020  name.           
+00003cd0: 2020 2020 206f 7220 7365 7276 6572 5f63       or server_c
+00003ce0: 6667 2e67 6574 2822 6465 6661 756c 745f  fg.get("default_
+00003cf0: 6675 6e63 7469 6f6e 5f70 7269 6f72 6974  function_priorit
+00003d00: 795f 636c 6173 735f 6e61 6d65 2229 0a20  y_class_name"). 
+00003d10: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00003d20: 2020 2020 2020 2020 2063 6f6e 6669 672e           config.
+00003d30: 7661 6c69 645f 6675 6e63 7469 6f6e 5f70  valid_function_p
+00003d40: 7269 6f72 6974 795f 636c 6173 735f 6e61  riority_class_na
+00003d50: 6d65 7320 3d20 280a 2020 2020 2020 2020  mes = (.        
+00003d60: 2020 2020 2020 2020 636f 6e66 6967 2e76          config.v
+00003d70: 616c 6964 5f66 756e 6374 696f 6e5f 7072  alid_function_pr
+00003d80: 696f 7269 7479 5f63 6c61 7373 5f6e 616d  iority_class_nam
+00003d90: 6573 0a20 2020 2020 2020 2020 2020 2020  es.             
+00003da0: 2020 206f 7220 7365 7276 6572 5f63 6667     or server_cfg
+00003db0: 2e67 6574 2822 7661 6c69 645f 6675 6e63  .get("valid_func
+00003dc0: 7469 6f6e 5f70 7269 6f72 6974 795f 636c  tion_priority_cl
+00003dd0: 6173 735f 6e61 6d65 7322 290a 2020 2020  ass_names").    
+00003de0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00003df0: 2020 2020 2020 636f 6e66 6967 2e61 7274        config.art
+00003e00: 6966 6163 7473 2e63 616c 6375 6c61 7465  ifacts.calculate
+00003e10: 5f68 6173 6820 3d20 280a 2020 2020 2020  _hash = (.      
+00003e20: 2020 2020 2020 2020 2020 636f 6e66 6967            config
+00003e30: 2e61 7274 6966 6163 7473 2e63 616c 6375  .artifacts.calcu
+00003e40: 6c61 7465 5f68 6173 680a 2020 2020 2020  late_hash.      
+00003e50: 2020 2020 2020 2020 2020 6966 2063 6f6e            if con
+00003e60: 6669 672e 6172 7469 6661 6374 732e 6361  fig.artifacts.ca
+00003e70: 6c63 756c 6174 655f 6861 7368 2069 7320  lculate_hash is 
+00003e80: 6e6f 7420 4e6f 6e65 0a20 2020 2020 2020  not None.       
+00003e90: 2020 2020 2020 2020 2065 6c73 6520 7365           else se
+00003ea0: 7276 6572 5f63 6667 2e67 6574 2822 6361  rver_cfg.get("ca
+00003eb0: 6c63 756c 6174 655f 6172 7469 6661 6374  lculate_artifact
+00003ec0: 5f68 6173 6822 290a 2020 2020 2020 2020  _hash").        
+00003ed0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+00003ee0: 2020 636f 6e66 6967 2e61 7274 6966 6163    config.artifac
+00003ef0: 7473 2e67 656e 6572 6174 655f 7461 7267  ts.generate_targ
+00003f00: 6574 5f70 6174 685f 6672 6f6d 5f61 7274  et_path_from_art
+00003f10: 6966 6163 745f 6861 7368 203d 2028 0a20  ifact_hash = (. 
+00003f20: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00003f30: 6f6e 6669 672e 6172 7469 6661 6374 732e  onfig.artifacts.
+00003f40: 6765 6e65 7261 7465 5f74 6172 6765 745f  generate_target_
+00003f50: 7061 7468 5f66 726f 6d5f 6172 7469 6661  path_from_artifa
+00003f60: 6374 5f68 6173 680a 2020 2020 2020 2020  ct_hash.        
+00003f70: 2020 2020 2020 2020 6966 2063 6f6e 6669          if confi
+00003f80: 672e 6172 7469 6661 6374 732e 6765 6e65  g.artifacts.gene
+00003f90: 7261 7465 5f74 6172 6765 745f 7061 7468  rate_target_path
+00003fa0: 5f66 726f 6d5f 6172 7469 6661 6374 5f68  _from_artifact_h
+00003fb0: 6173 6820 6973 206e 6f74 204e 6f6e 650a  ash is not None.
+00003fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003fd0: 656c 7365 2073 6572 7665 725f 6366 672e  else server_cfg.
+00003fe0: 6765 7428 2267 656e 6572 6174 655f 6172  get("generate_ar
+00003ff0: 7469 6661 6374 5f74 6172 6765 745f 7061  tifact_target_pa
+00004000: 7468 5f66 726f 6d5f 6172 7469 6661 6374  th_from_artifact
+00004010: 5f68 6173 6822 290a 2020 2020 2020 2020  _hash").        
+00004020: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
+00004030: 2020 2063 6f6e 6669 672e 7265 6469 732e     config.redis.
+00004040: 7572 6c20 3d20 636f 6e66 6967 2e72 6564  url = config.red
+00004050: 6973 2e75 726c 206f 7220 7365 7276 6572  is.url or server
+00004060: 5f63 6667 2e67 6574 2822 7265 6469 735f  _cfg.get("redis_
+00004070: 7572 6c22 290a 2020 2020 2020 2020 2020  url").          
+00004080: 2020 2320 616c 6c6f 7720 636c 6965 6e74    # allow client
+00004090: 2074 6f20 7365 7420 7468 6520 6465 6661   to set the defa
+000040a0: 756c 7420 7061 7274 6961 6c20 5741 2066  ult partial WA f
+000040b0: 6f72 206c 6163 6b20 6f66 2073 7570 706f  or lack of suppo
+000040c0: 7274 206f 6620 7065 722d 7461 7267 6574  rt of per-target
+000040d0: 2061 7578 696c 6961 7279 206f 7074 696f   auxiliary optio
+000040e0: 6e73 0a20 2020 2020 2020 2020 2020 2063  ns.            c
+000040f0: 6f6e 6669 672e 7265 6469 732e 7479 7065  onfig.redis.type
+00004100: 203d 2063 6f6e 6669 672e 7265 6469 732e   = config.redis.
+00004110: 7479 7065 206f 7220 7365 7276 6572 5f63  type or server_c
+00004120: 6667 2e67 6574 2822 7265 6469 735f 7479  fg.get("redis_ty
+00004130: 7065 2229 0a0a 2020 2020 2020 2020 2020  pe")..          
+00004140: 2020 636f 6e66 6967 2e73 716c 2e75 726c    config.sql.url
+00004150: 203d 2063 6f6e 6669 672e 7371 6c2e 7572   = config.sql.ur
+00004160: 6c20 6f72 2073 6572 7665 725f 6366 672e  l or server_cfg.
+00004170: 6765 7428 2273 716c 5f75 726c 2229 0a20  get("sql_url"). 
+00004180: 2020 2020 2020 2020 2020 2023 2054 6865             # The
+00004190: 7365 2068 6176 6520 6120 6465 6661 756c  se have a defaul
+000041a0: 7420 7661 6c75 652c 2074 6865 7265 666f  t value, therefo
+000041b0: 7265 206c 6f63 616c 2063 6f6e 6669 6720  re local config 
+000041c0: 7769 6c6c 2061 6c77 6179 7320 6861 7665  will always have
+000041d0: 2061 2076 616c 7565 2c20 7072 696f 7269   a value, priori
+000041e0: 7469 7a65 2074 6865 0a20 2020 2020 2020  tize the.       
+000041f0: 2020 2020 2023 2041 5049 2076 616c 7565       # API value
+00004200: 2066 6972 7374 0a20 2020 2020 2020 2020   first.         
+00004210: 2020 2063 6f6e 6669 672e 7569 2e70 726f     config.ui.pro
+00004220: 6a65 6374 735f 7072 6566 6978 203d 2028  jects_prefix = (
+00004230: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00004240: 2073 6572 7665 725f 6366 672e 6765 7428   server_cfg.get(
+00004250: 2275 695f 7072 6f6a 6563 7473 5f70 7265  "ui_projects_pre
+00004260: 6669 7822 2920 6f72 2063 6f6e 6669 672e  fix") or config.
+00004270: 7569 2e70 726f 6a65 6374 735f 7072 6566  ui.projects_pref
+00004280: 6978 0a20 2020 2020 2020 2020 2020 2029  ix.            )
+00004290: 0a20 2020 2020 2020 2020 2020 2063 6f6e  .            con
+000042a0: 6669 672e 6b66 705f 696d 6167 6520 3d20  fig.kfp_image = 
+000042b0: 7365 7276 6572 5f63 6667 2e67 6574 2822  server_cfg.get("
+000042c0: 6b66 705f 696d 6167 6522 2920 6f72 2063  kfp_image") or c
+000042d0: 6f6e 6669 672e 6b66 705f 696d 6167 650a  onfig.kfp_image.
+000042e0: 2020 2020 2020 2020 2020 2020 636f 6e66              conf
+000042f0: 6967 2e6b 6670 5f75 726c 203d 2073 6572  ig.kfp_url = ser
+00004300: 7665 725f 6366 672e 6765 7428 226b 6670  ver_cfg.get("kfp
+00004310: 5f75 726c 2229 206f 7220 636f 6e66 6967  _url") or config
+00004320: 2e6b 6670 5f75 726c 0a20 2020 2020 2020  .kfp_url.       
+00004330: 2020 2020 2063 6f6e 6669 672e 6461 736b       config.dask
+00004340: 5f6b 6670 5f69 6d61 6765 203d 2028 0a20  _kfp_image = (. 
+00004350: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00004360: 6572 7665 725f 6366 672e 6765 7428 2264  erver_cfg.get("d
+00004370: 6173 6b5f 6b66 705f 696d 6167 6522 2920  ask_kfp_image") 
+00004380: 6f72 2063 6f6e 6669 672e 6461 736b 5f6b  or config.dask_k
+00004390: 6670 5f69 6d61 6765 0a20 2020 2020 2020  fp_image.       
+000043a0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+000043b0: 2020 2063 6f6e 6669 672e 7363 7261 7065     config.scrape
+000043c0: 5f6d 6574 7269 6373 203d 2028 0a20 2020  _metrics = (.   
+000043d0: 2020 2020 2020 2020 2020 2020 2073 6572               ser
+000043e0: 7665 725f 6366 672e 6765 7428 2273 6372  ver_cfg.get("scr
+000043f0: 6170 655f 6d65 7472 6963 7322 290a 2020  ape_metrics").  
+00004400: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00004410: 2073 6572 7665 725f 6366 672e 6765 7428   server_cfg.get(
+00004420: 2273 6372 6170 655f 6d65 7472 6963 7322  "scrape_metrics"
+00004430: 2920 6973 206e 6f74 204e 6f6e 650a 2020  ) is not None.  
+00004440: 2020 2020 2020 2020 2020 2020 2020 656c                el
+00004450: 7365 2063 6f6e 6669 672e 7363 7261 7065  se config.scrape
+00004460: 5f6d 6574 7269 6373 0a20 2020 2020 2020  _metrics.       
+00004470: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+00004480: 2020 2063 6f6e 6669 672e 6465 6661 756c     config.defaul
+00004490: 745f 6675 6e63 7469 6f6e 5f6e 6f64 655f  t_function_node_
+000044a0: 7365 6c65 6374 6f72 203d 2028 0a20 2020  selector = (.   
+000044b0: 2020 2020 2020 2020 2020 2020 2073 6572               ser
+000044c0: 7665 725f 6366 672e 6765 7428 2264 6566  ver_cfg.get("def
+000044d0: 6175 6c74 5f66 756e 6374 696f 6e5f 6e6f  ault_function_no
+000044e0: 6465 5f73 656c 6563 746f 7222 290a 2020  de_selector").  
+000044f0: 2020 2020 2020 2020 2020 2020 2020 6f72                or
+00004500: 2063 6f6e 6669 672e 6465 6661 756c 745f   config.default_
+00004510: 6675 6e63 7469 6f6e 5f6e 6f64 655f 7365  function_node_se
+00004520: 6c65 6374 6f72 0a20 2020 2020 2020 2020  lector.         
+00004530: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+00004540: 2063 6f6e 6669 672e 6967 7a5f 7665 7273   config.igz_vers
+00004550: 696f 6e20 3d20 7365 7276 6572 5f63 6667  ion = server_cfg
+00004560: 2e67 6574 2822 6967 7a5f 7665 7273 696f  .get("igz_versio
+00004570: 6e22 2920 6f72 2063 6f6e 6669 672e 6967  n") or config.ig
+00004580: 7a5f 7665 7273 696f 6e0a 2020 2020 2020  z_version.      
+00004590: 2020 2020 2020 636f 6e66 6967 2e73 746f        config.sto
+000045a0: 7261 6765 2e61 7574 6f5f 6d6f 756e 745f  rage.auto_mount_
+000045b0: 7479 7065 203d 2028 0a20 2020 2020 2020  type = (.       
+000045c0: 2020 2020 2020 2020 2073 6572 7665 725f           server_
+000045d0: 6366 672e 6765 7428 2261 7574 6f5f 6d6f  cfg.get("auto_mo
+000045e0: 756e 745f 7479 7065 2229 206f 7220 636f  unt_type") or co
+000045f0: 6e66 6967 2e73 746f 7261 6765 2e61 7574  nfig.storage.aut
+00004600: 6f5f 6d6f 756e 745f 7479 7065 0a20 2020  o_mount_type.   
+00004610: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00004620: 2020 2020 2020 2063 6f6e 6669 672e 7374         config.st
+00004630: 6f72 6167 652e 6175 746f 5f6d 6f75 6e74  orage.auto_mount
+00004640: 5f70 6172 616d 7320 3d20 280a 2020 2020  _params = (.    
+00004650: 2020 2020 2020 2020 2020 2020 7365 7276              serv
+00004660: 6572 5f63 6667 2e67 6574 2822 6175 746f  er_cfg.get("auto
+00004670: 5f6d 6f75 6e74 5f70 6172 616d 7322 2920  _mount_params") 
+00004680: 6f72 2063 6f6e 6669 672e 7374 6f72 6167  or config.storag
+00004690: 652e 6175 746f 5f6d 6f75 6e74 5f70 6172  e.auto_mount_par
+000046a0: 616d 730a 2020 2020 2020 2020 2020 2020  ams.            
+000046b0: 290a 2020 2020 2020 2020 2020 2020 636f  ).            co
+000046c0: 6e66 6967 2e73 7061 726b 5f6f 7065 7261  nfig.spark_opera
+000046d0: 746f 725f 7665 7273 696f 6e20 3d20 280a  tor_version = (.
+000046e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000046f0: 7365 7276 6572 5f63 6667 2e67 6574 2822  server_cfg.get("
+00004700: 7370 6172 6b5f 6f70 6572 6174 6f72 5f76  spark_operator_v
+00004710: 6572 7369 6f6e 2229 0a20 2020 2020 2020  ersion").       
+00004720: 2020 2020 2020 2020 206f 7220 636f 6e66           or conf
+00004730: 6967 2e73 7061 726b 5f6f 7065 7261 746f  ig.spark_operato
+00004740: 725f 7665 7273 696f 6e0a 2020 2020 2020  r_version.      
+00004750: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00004760: 2020 2020 636f 6e66 6967 2e64 6566 6175      config.defau
+00004770: 6c74 5f74 656e 736f 7262 6f61 7264 5f6c  lt_tensorboard_l
+00004780: 6f67 735f 7061 7468 203d 2028 0a20 2020  ogs_path = (.   
+00004790: 2020 2020 2020 2020 2020 2020 2073 6572               ser
+000047a0: 7665 725f 6366 672e 6765 7428 2264 6566  ver_cfg.get("def
+000047b0: 6175 6c74 5f74 656e 736f 7262 6f61 7264  ault_tensorboard
+000047c0: 5f6c 6f67 735f 7061 7468 2229 0a20 2020  _logs_path").   
+000047d0: 2020 2020 2020 2020 2020 2020 206f 7220               or 
+000047e0: 636f 6e66 6967 2e64 6566 6175 6c74 5f74  config.default_t
+000047f0: 656e 736f 7262 6f61 7264 5f6c 6f67 735f  ensorboard_logs_
+00004800: 7061 7468 0a20 2020 2020 2020 2020 2020  path.           
+00004810: 2029 0a20 2020 2020 2020 2020 2020 2063   ).            c
+00004820: 6f6e 6669 672e 6465 6661 756c 745f 6675  onfig.default_fu
+00004830: 6e63 7469 6f6e 5f70 6f64 5f72 6573 6f75  nction_pod_resou
+00004840: 7263 6573 203d 2028 0a20 2020 2020 2020  rces = (.       
+00004850: 2020 2020 2020 2020 2073 6572 7665 725f           server_
+00004860: 6366 672e 6765 7428 2264 6566 6175 6c74  cfg.get("default
+00004870: 5f66 756e 6374 696f 6e5f 706f 645f 7265  _function_pod_re
+00004880: 736f 7572 6365 7322 290a 2020 2020 2020  sources").      
+00004890: 2020 2020 2020 2020 2020 6f72 2063 6f6e            or con
+000048a0: 6669 672e 6465 6661 756c 745f 6675 6e63  fig.default_func
+000048b0: 7469 6f6e 5f70 6f64 5f72 6573 6f75 7263  tion_pod_resourc
+000048c0: 6573 0a20 2020 2020 2020 2020 2020 2029  es.            )
+000048d0: 0a20 2020 2020 2020 2020 2020 2063 6f6e  .            con
+000048e0: 6669 672e 6675 6e63 7469 6f6e 5f64 6566  fig.function_def
+000048f0: 6175 6c74 732e 7072 6565 6d70 7469 6f6e  aults.preemption
+00004900: 5f6d 6f64 6520 3d20 280a 2020 2020 2020  _mode = (.      
+00004910: 2020 2020 2020 2020 2020 7365 7276 6572            server
+00004920: 5f63 6667 2e67 6574 2822 6465 6661 756c  _cfg.get("defaul
+00004930: 745f 7072 6565 6d70 7469 6f6e 5f6d 6f64  t_preemption_mod
+00004940: 6522 290a 2020 2020 2020 2020 2020 2020  e").            
+00004950: 2020 2020 6f72 2063 6f6e 6669 672e 6675      or config.fu
+00004960: 6e63 7469 6f6e 5f64 6566 6175 6c74 732e  nction_defaults.
+00004970: 7072 6565 6d70 7469 6f6e 5f6d 6f64 650a  preemption_mode.
+00004980: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00004990: 2020 2020 2020 2020 2020 636f 6e66 6967            config
+000049a0: 2e70 7265 656d 7074 6962 6c65 5f6e 6f64  .preemptible_nod
+000049b0: 6573 2e6e 6f64 655f 7365 6c65 6374 6f72  es.node_selector
+000049c0: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
+000049d0: 2020 2020 2073 6572 7665 725f 6366 672e       server_cfg.
+000049e0: 6765 7428 2270 7265 656d 7074 6962 6c65  get("preemptible
+000049f0: 5f6e 6f64 6573 5f6e 6f64 655f 7365 6c65  _nodes_node_sele
+00004a00: 6374 6f72 2229 0a20 2020 2020 2020 2020  ctor").         
+00004a10: 2020 2020 2020 206f 7220 636f 6e66 6967         or config
+00004a20: 2e70 7265 656d 7074 6962 6c65 5f6e 6f64  .preemptible_nod
+00004a30: 6573 2e6e 6f64 655f 7365 6c65 6374 6f72  es.node_selector
+00004a40: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00004a50: 2020 2020 2020 2020 2020 2063 6f6e 6669             confi
+00004a60: 672e 7072 6565 6d70 7469 626c 655f 6e6f  g.preemptible_no
+00004a70: 6465 732e 746f 6c65 7261 7469 6f6e 7320  des.tolerations 
+00004a80: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
+00004a90: 2020 2020 7365 7276 6572 5f63 6667 2e67      server_cfg.g
+00004aa0: 6574 2822 7072 6565 6d70 7469 626c 655f  et("preemptible_
+00004ab0: 6e6f 6465 735f 746f 6c65 7261 7469 6f6e  nodes_toleration
+00004ac0: 7322 290a 2020 2020 2020 2020 2020 2020  s").            
+00004ad0: 2020 2020 6f72 2063 6f6e 6669 672e 7072      or config.pr
+00004ae0: 6565 6d70 7469 626c 655f 6e6f 6465 732e  eemptible_nodes.
+00004af0: 746f 6c65 7261 7469 6f6e 730a 2020 2020  tolerations.    
+00004b00: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00004b10: 2020 2020 2020 636f 6e66 6967 2e66 6f72        config.for
+00004b20: 6365 5f72 756e 5f6c 6f63 616c 203d 2028  ce_run_local = (
+00004b30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00004b40: 2073 6572 7665 725f 6366 672e 6765 7428   server_cfg.get(
+00004b50: 2266 6f72 6365 5f72 756e 5f6c 6f63 616c  "force_run_local
+00004b60: 2229 206f 7220 636f 6e66 6967 2e66 6f72  ") or config.for
+00004b70: 6365 5f72 756e 5f6c 6f63 616c 0a20 2020  ce_run_local.   
+00004b80: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00004b90: 2020 2020 2020 2063 6f6e 6669 672e 6675         config.fu
+00004ba0: 6e63 7469 6f6e 203d 2073 6572 7665 725f  nction = server_
+00004bb0: 6366 672e 6765 7428 2266 756e 6374 696f  cfg.get("functio
+00004bc0: 6e22 2920 6f72 2063 6f6e 6669 672e 6675  n") or config.fu
+00004bd0: 6e63 7469 6f6e 0a20 2020 2020 2020 2020  nction.         
+00004be0: 2020 2063 6f6e 6669 672e 6874 7470 6462     config.httpdb
+00004bf0: 2e6c 6f67 7320 3d20 7365 7276 6572 5f63  .logs = server_c
+00004c00: 6667 2e67 6574 2822 6c6f 6773 2229 206f  fg.get("logs") o
+00004c10: 7220 636f 6e66 6967 2e68 7474 7064 622e  r config.httpdb.
+00004c20: 6c6f 6773 0a20 2020 2020 2020 2020 2020  logs.           
+00004c30: 2063 6f6e 6669 672e 6578 7465 726e 616c   config.external
+00004c40: 5f70 6c61 7466 6f72 6d5f 7472 6163 6b69  _platform_tracki
+00004c50: 6e67 203d 2028 0a20 2020 2020 2020 2020  ng = (.         
+00004c60: 2020 2020 2020 2073 6572 7665 725f 6366         server_cf
+00004c70: 672e 6765 7428 2265 7874 6572 6e61 6c5f  g.get("external_
+00004c80: 706c 6174 666f 726d 5f74 7261 636b 696e  platform_trackin
+00004c90: 6722 290a 2020 2020 2020 2020 2020 2020  g").            
+00004ca0: 2020 2020 6f72 2063 6f6e 6669 672e 6578      or config.ex
+00004cb0: 7465 726e 616c 5f70 6c61 7466 6f72 6d5f  ternal_platform_
+00004cc0: 7472 6163 6b69 6e67 0a20 2020 2020 2020  tracking.       
+00004cd0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+00004ce0: 2020 2063 6f6e 6669 672e 6d6f 6465 6c5f     config.model_
+00004cf0: 656e 6470 6f69 6e74 5f6d 6f6e 6974 6f72  endpoint_monitor
+00004d00: 696e 672e 7374 6f72 655f 7479 7065 203d  ing.store_type =
+00004d10: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
+00004d20: 2020 2073 6572 7665 725f 6366 672e 6765     server_cfg.ge
+00004d30: 7428 226d 6f64 656c 5f65 6e64 706f 696e  t("model_endpoin
+00004d40: 745f 6d6f 6e69 746f 7269 6e67 5f73 746f  t_monitoring_sto
+00004d50: 7265 5f74 7970 6522 290a 2020 2020 2020  re_type").      
+00004d60: 2020 2020 2020 2020 2020 6f72 2063 6f6e            or con
+00004d70: 6669 672e 6d6f 6465 6c5f 656e 6470 6f69  fig.model_endpoi
+00004d80: 6e74 5f6d 6f6e 6974 6f72 696e 672e 7374  nt_monitoring.st
+00004d90: 6f72 655f 7479 7065 0a20 2020 2020 2020  ore_type.       
+00004da0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+00004db0: 2020 2063 6f6e 6669 672e 6d6f 6465 6c5f     config.model_
+00004dc0: 656e 6470 6f69 6e74 5f6d 6f6e 6974 6f72  endpoint_monitor
+00004dd0: 696e 672e 656e 6470 6f69 6e74 5f73 746f  ing.endpoint_sto
+00004de0: 7265 5f63 6f6e 6e65 6374 696f 6e20 3d20  re_connection = 
+00004df0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00004e00: 2020 7365 7276 6572 5f63 6667 2e67 6574    server_cfg.get
+00004e10: 2822 6d6f 6465 6c5f 656e 6470 6f69 6e74  ("model_endpoint
+00004e20: 5f6d 6f6e 6974 6f72 696e 675f 656e 6470  _monitoring_endp
 00004e30: 6f69 6e74 5f73 746f 7265 5f63 6f6e 6e65  oint_store_conne
-00004e40: 6374 696f 6e0a 2020 2020 2020 2020 2020  ction.          
-00004e50: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-00004e60: 636f 6e66 6967 2e70 6163 6b61 6765 7273  config.packagers
-00004e70: 203d 2073 6572 7665 725f 6366 672e 6765   = server_cfg.ge
-00004e80: 7428 2270 6163 6b61 6765 7273 2229 206f  t("packagers") o
-00004e90: 7220 636f 6e66 6967 2e70 6163 6b61 6765  r config.package
-00004ea0: 7273 0a20 2020 2020 2020 2020 2020 2073  rs.            s
-00004eb0: 6572 7665 725f 6461 7461 5f70 7265 6669  erver_data_prefi
-00004ec0: 7865 7320 3d20 7365 7276 6572 5f63 6667  xes = server_cfg
-00004ed0: 2e67 6574 2822 6665 6174 7572 655f 7374  .get("feature_st
-00004ee0: 6f72 655f 6461 7461 5f70 7265 6669 7865  ore_data_prefixe
-00004ef0: 7322 2920 6f72 207b 7d0a 2020 2020 2020  s") or {}.      
-00004f00: 2020 2020 2020 666f 7220 7072 6566 6978        for prefix
-00004f10: 2069 6e20 5b22 6465 6661 756c 7422 2c20   in ["default", 
-00004f20: 226e 6f73 716c 222c 2022 7265 6469 736e  "nosql", "redisn
-00004f30: 6f73 716c 225d 3a0a 2020 2020 2020 2020  osql"]:.        
-00004f40: 2020 2020 2020 2020 7365 7276 6572 5f70          server_p
-00004f50: 7265 6669 785f 7661 6c75 6520 3d20 7365  refix_value = se
-00004f60: 7276 6572 5f64 6174 615f 7072 6566 6978  rver_data_prefix
-00004f70: 6573 2e67 6574 2870 7265 6669 7829 0a20  es.get(prefix). 
-00004f80: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00004f90: 6620 7365 7276 6572 5f70 7265 6669 785f  f server_prefix_
-00004fa0: 7661 6c75 6520 6973 206e 6f74 204e 6f6e  value is not Non
-00004fb0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00004fc0: 2020 2020 2020 2073 6574 6174 7472 280a         setattr(.
-00004fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004fe0: 2020 2020 2020 2020 636f 6e66 6967 2e66          config.f
-00004ff0: 6561 7475 7265 5f73 746f 7265 2e64 6174  eature_store.dat
-00005000: 615f 7072 6566 6978 6573 2c20 7072 6566  a_prefixes, pref
-00005010: 6978 2c20 7365 7276 6572 5f70 7265 6669  ix, server_prefi
-00005020: 785f 7661 6c75 650a 2020 2020 2020 2020  x_value.        
-00005030: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00005040: 2020 2020 2020 2020 2020 636f 6e66 6967            config
-00005050: 2e66 6561 7475 7265 5f73 746f 7265 2e64  .feature_store.d
-00005060: 6566 6175 6c74 5f74 6172 6765 7473 203d  efault_targets =
-00005070: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
-00005080: 2020 2073 6572 7665 725f 6366 672e 6765     server_cfg.ge
-00005090: 7428 2266 6561 7475 7265 5f73 746f 7265  t("feature_store
-000050a0: 5f64 6566 6175 6c74 5f74 6172 6765 7473  _default_targets
-000050b0: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
-000050c0: 2020 206f 7220 636f 6e66 6967 2e66 6561     or config.fea
-000050d0: 7475 7265 5f73 746f 7265 2e64 6566 6175  ture_store.defau
-000050e0: 6c74 5f74 6172 6765 7473 0a20 2020 2020  lt_targets.     
-000050f0: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-00005100: 2020 6578 6365 7074 2045 7863 6570 7469    except Excepti
-00005110: 6f6e 2061 7320 6578 633a 0a20 2020 2020  on as exc:.     
-00005120: 2020 2020 2020 206c 6f67 6765 722e 7761         logger.wa
-00005130: 726e 696e 6728 0a20 2020 2020 2020 2020  rning(.         
-00005140: 2020 2020 2020 2022 4661 696c 6564 2073         "Failed s
-00005150: 796e 6369 6e67 2063 6f6e 6669 6720 6672  yncing config fr
-00005160: 6f6d 2073 6572 7665 7222 2c0a 2020 2020  om server",.    
-00005170: 2020 2020 2020 2020 2020 2020 6578 633d              exc=
-00005180: 6572 725f 746f 5f73 7472 2865 7863 292c  err_to_str(exc),
-00005190: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000051a0: 2074 7261 6365 6261 636b 3d74 7261 6365   traceback=trace
-000051b0: 6261 636b 2e66 6f72 6d61 745f 6578 6328  back.format_exc(
-000051c0: 292c 0a20 2020 2020 2020 2020 2020 2029  ),.            )
-000051d0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000051e0: 7365 6c66 0a0a 2020 2020 6465 6620 7374  self..    def st
-000051f0: 6f72 655f 6c6f 6728 7365 6c66 2c20 7569  ore_log(self, ui
-00005200: 642c 2070 726f 6a65 6374 3d22 222c 2062  d, project="", b
-00005210: 6f64 793d 4e6f 6e65 2c20 6170 7065 6e64  ody=None, append
-00005220: 3d46 616c 7365 293a 0a20 2020 2020 2020  =False):.       
-00005230: 2022 2222 5361 7665 2061 206c 6f67 2070   """Save a log p
-00005240: 6572 7369 7374 656e 746c 792e 0a0a 2020  ersistently...  
-00005250: 2020 2020 2020 3a70 6172 616d 2075 6964        :param uid
-00005260: 3a20 4c6f 6720 756e 6971 7565 2049 440a  : Log unique ID.
-00005270: 2020 2020 2020 2020 3a70 6172 616d 2070          :param p
-00005280: 726f 6a65 6374 3a20 5072 6f6a 6563 7420  roject: Project 
-00005290: 6e61 6d65 2066 6f72 2077 6869 6368 2074  name for which t
-000052a0: 6869 7320 6c6f 6720 6265 6c6f 6e67 730a  his log belongs.
-000052b0: 2020 2020 2020 2020 3a70 6172 616d 2062          :param b
-000052c0: 6f64 793a 2054 6865 2061 6374 7561 6c20  ody: The actual 
-000052d0: 6c6f 6720 746f 2073 746f 7265 0a20 2020  log to store.   
-000052e0: 2020 2020 203a 7061 7261 6d20 6170 7065       :param appe
-000052f0: 6e64 3a20 5768 6574 6865 7220 746f 2061  nd: Whether to a
-00005300: 7070 656e 6420 7468 6520 6c6f 6720 7072  ppend the log pr
-00005310: 6f76 6964 6564 2069 6e20 6060 626f 6479  ovided in ``body
-00005320: 6060 2074 6f20 616e 2065 7869 7374 696e  `` to an existin
-00005330: 6720 6c6f 6720 7769 7468 2074 6865 2073  g log with the s
-00005340: 616d 6520 6060 7569 6460 6020 6f72 2074  ame ``uid`` or t
-00005350: 6f0a 2020 2020 2020 2020 2020 2020 6372  o.            cr
-00005360: 6561 7465 2061 206e 6577 206c 6f67 2e20  eate a new log. 
-00005370: 4966 2073 6574 2074 6f20 6060 4661 6c73  If set to ``Fals
-00005380: 6560 602c 2061 6e20 6578 6973 7469 6e67  e``, an existing
-00005390: 206c 6f67 2077 6974 6820 7361 6d65 2060   log with same `
-000053a0: 6075 6964 6060 2077 696c 6c20 6265 206f  `uid`` will be o
-000053b0: 7665 7277 7269 7474 656e 0a20 2020 2020  verwritten.     
-000053c0: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
-000053d0: 6966 206e 6f74 2062 6f64 793a 0a20 2020  if not body:.   
-000053e0: 2020 2020 2020 2020 2072 6574 7572 6e0a           return.
-000053f0: 0a20 2020 2020 2020 2070 6174 6820 3d20  .        path = 
-00005400: 7365 6c66 2e5f 7061 7468 5f6f 6628 226c  self._path_of("l
-00005410: 6f67 7322 2c20 7072 6f6a 6563 742c 2075  ogs", project, u
-00005420: 6964 290a 2020 2020 2020 2020 7061 7261  id).        para
-00005430: 6d73 203d 207b 2261 7070 656e 6422 3a20  ms = {"append": 
-00005440: 626f 6f6c 3273 7472 2861 7070 656e 6429  bool2str(append)
-00005450: 7d0a 2020 2020 2020 2020 6572 726f 7220  }.        error 
-00005460: 3d20 6622 7374 6f72 6520 6c6f 6720 7b70  = f"store log {p
-00005470: 726f 6a65 6374 7d2f 7b75 6964 7d22 0a20  roject}/{uid}". 
-00005480: 2020 2020 2020 2073 656c 662e 6170 695f         self.api_
-00005490: 6361 6c6c 2822 504f 5354 222c 2070 6174  call("POST", pat
-000054a0: 682c 2065 7272 6f72 2c20 7061 7261 6d73  h, error, params
-000054b0: 2c20 626f 6479 290a 0a20 2020 2064 6566  , body)..    def
-000054c0: 2067 6574 5f6c 6f67 2873 656c 662c 2075   get_log(self, u
-000054d0: 6964 2c20 7072 6f6a 6563 743d 2222 2c20  id, project="", 
-000054e0: 6f66 6673 6574 3d30 2c20 7369 7a65 3d4e  offset=0, size=N
-000054f0: 6f6e 6529 3a0a 2020 2020 2020 2020 2222  one):.        ""
-00005500: 2252 6574 7269 6576 6520 3120 4d42 2064  "Retrieve 1 MB d
-00005510: 6174 6120 6f66 206c 6f67 2e0a 0a20 2020  ata of log...   
-00005520: 2020 2020 203a 7061 7261 6d20 7569 643a       :param uid:
-00005530: 204c 6f67 2075 6e69 7175 6520 4944 0a20   Log unique ID. 
-00005540: 2020 2020 2020 203a 7061 7261 6d20 7072         :param pr
-00005550: 6f6a 6563 743a 2050 726f 6a65 6374 206e  oject: Project n
-00005560: 616d 6520 666f 7220 7768 6963 6820 7468  ame for which th
-00005570: 6520 6c6f 6720 6265 6c6f 6e67 730a 2020  e log belongs.  
-00005580: 2020 2020 2020 3a70 6172 616d 206f 6666        :param off
-00005590: 7365 743a 2052 6574 7269 6576 6520 7061  set: Retrieve pa
-000055a0: 7274 6961 6c20 6c6f 672c 2067 6574 2075  rtial log, get u
-000055b0: 7020 746f 2060 6073 697a 6560 6020 6279  p to ``size`` by
-000055c0: 7465 7320 7374 6172 7469 6e67 2061 7420  tes starting at 
-000055d0: 6f66 6673 6574 2060 606f 6666 7365 7460  offset ``offset`
-000055e0: 600a 2020 2020 2020 2020 2020 2020 6672  `.            fr
-000055f0: 6f6d 2062 6567 696e 6e69 6e67 206f 6620  om beginning of 
-00005600: 6c6f 6720 286d 7573 7420 6265 203e 3d20  log (must be >= 
-00005610: 3029 0a20 2020 2020 2020 203a 7061 7261  0).        :para
-00005620: 6d20 7369 7a65 3a20 4966 2073 6574 2074  m size: If set t
-00005630: 6f20 6060 2d31 6060 2077 696c 6c20 7265  o ``-1`` will re
-00005640: 7472 6965 7665 2061 6e64 2070 7269 6e74  trieve and print
-00005650: 2061 6c6c 2064 6174 6120 746f 2065 6e64   all data to end
-00005660: 206f 6620 7468 6520 6c6f 6720 6279 2063   of the log by c
-00005670: 6875 6e6b 7320 6f66 2031 4d42 2065 6163  hunks of 1MB eac
-00005680: 682e 0a20 2020 2020 2020 203a 7265 7475  h..        :retu
-00005690: 726e 733a 2054 6865 2066 6f6c 6c6f 7769  rns: The followi
-000056a0: 6e67 206f 626a 6563 7473 3a0a 0a20 2020  ng objects:..   
-000056b0: 2020 2020 2020 2020 202d 2073 7461 7465           - state
-000056c0: 202d 2054 6865 2073 7461 7465 206f 6620   - The state of 
-000056d0: 7468 6520 7275 6e74 696d 6520 6f62 6a65  the runtime obje
-000056e0: 6374 2077 6869 6368 2067 656e 6572 6174  ct which generat
-000056f0: 6573 2074 6869 7320 6c6f 672c 2069 6620  es this log, if 
-00005700: 6974 2065 7869 7374 732e 2049 6e20 6361  it exists. In ca
-00005710: 7365 206e 6f20 6b6e 6f77 6e20 7374 6174  se no known stat
-00005720: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-00005730: 6578 6973 7473 2c20 7468 6973 2077 696c  exists, this wil
-00005740: 6c20 6265 2060 6075 6e6b 6e6f 776e 6060  l be ``unknown``
-00005750: 2e0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
-00005760: 636f 6e74 656e 7420 2d20 5468 6520 6163  content - The ac
-00005770: 7475 616c 206c 6f67 2063 6f6e 7465 6e74  tual log content
-00005780: 2e0a 0a20 2020 2020 2020 2020 2020 202a  ...            *
-00005790: 2069 6e20 6361 7365 2073 697a 6520 3d20   in case size = 
-000057a0: 2d31 2c20 7265 7475 726e 2074 6865 2073  -1, return the s
-000057b0: 7461 7465 2061 6e64 2074 6865 2066 696e  tate and the fin
-000057c0: 616c 206f 6666 7365 740a 2020 2020 2020  al offset.      
-000057d0: 2020 2222 220a 2020 2020 2020 2020 6966    """.        if
-000057e0: 206f 6666 7365 7420 3c20 303a 0a20 2020   offset < 0:.   
-000057f0: 2020 2020 2020 2020 2072 6169 7365 204d           raise M
-00005800: 4c52 756e 496e 7661 6c69 6441 7267 756d  LRunInvalidArgum
-00005810: 656e 7445 7272 6f72 2822 4f66 6673 6574  entError("Offset
-00005820: 2063 616e 6e6f 7420 6265 206e 6567 6174   cannot be negat
-00005830: 6976 6522 290a 2020 2020 2020 2020 6966  ive").        if
-00005840: 2073 697a 6520 6973 204e 6f6e 653a 0a20   size is None:. 
-00005850: 2020 2020 2020 2020 2020 2073 697a 6520             size 
-00005860: 3d20 696e 7428 636f 6e66 6967 2e68 7474  = int(config.htt
-00005870: 7064 622e 6c6f 6773 2e70 756c 6c5f 6c6f  pdb.logs.pull_lo
-00005880: 6773 5f64 6566 6175 6c74 5f73 697a 655f  gs_default_size_
-00005890: 6c69 6d69 7429 0a20 2020 2020 2020 2065  limit).        e
-000058a0: 6c69 6620 7369 7a65 203d 3d20 2d31 3a0a  lif size == -1:.
-000058b0: 2020 2020 2020 2020 2020 2020 6c6f 6767              logg
-000058c0: 6572 2e77 6172 6e69 6e67 280a 2020 2020  er.warning(.    
-000058d0: 2020 2020 2020 2020 2020 2020 2252 6574              "Ret
-000058e0: 7269 6576 696e 6720 616c 6c20 6c6f 6773  rieving all logs
-000058f0: 2e20 5468 6973 206d 6179 2062 6520 696e  . This may be in
-00005900: 6566 6669 6369 656e 7420 616e 6420 6361  efficient and ca
-00005910: 6e20 7265 7375 6c74 2069 6e20 6120 6c61  n result in a la
-00005920: 7267 6520 6c6f 672e 220a 2020 2020 2020  rge log.".      
-00005930: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00005940: 2020 2020 7374 6174 652c 206f 6666 7365      state, offse
-00005950: 7420 3d20 7365 6c66 2e77 6174 6368 5f6c  t = self.watch_l
-00005960: 6f67 2875 6964 2c20 7072 6f6a 6563 742c  og(uid, project,
-00005970: 2077 6174 6368 3d46 616c 7365 2c20 6f66   watch=False, of
-00005980: 6673 6574 3d6f 6666 7365 7429 0a20 2020  fset=offset).   
-00005990: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-000059a0: 7374 6174 652c 206f 6666 7365 740a 0a20  state, offset.. 
-000059b0: 2020 2020 2020 2070 6172 616d 7320 3d20         params = 
-000059c0: 7b22 6f66 6673 6574 223a 206f 6666 7365  {"offset": offse
-000059d0: 742c 2022 7369 7a65 223a 2073 697a 657d  t, "size": size}
-000059e0: 0a20 2020 2020 2020 2070 6174 6820 3d20  .        path = 
-000059f0: 7365 6c66 2e5f 7061 7468 5f6f 6628 226c  self._path_of("l
-00005a00: 6f67 7322 2c20 7072 6f6a 6563 742c 2075  ogs", project, u
-00005a10: 6964 290a 2020 2020 2020 2020 6572 726f  id).        erro
-00005a20: 7220 3d20 6622 6765 7420 6c6f 6720 7b70  r = f"get log {p
-00005a30: 726f 6a65 6374 7d2f 7b75 6964 7d22 0a20  roject}/{uid}". 
-00005a40: 2020 2020 2020 2072 6573 7020 3d20 7365         resp = se
-00005a50: 6c66 2e61 7069 5f63 616c 6c28 2247 4554  lf.api_call("GET
-00005a60: 222c 2070 6174 682c 2065 7272 6f72 2c20  ", path, error, 
-00005a70: 7061 7261 6d73 3d70 6172 616d 7329 0a20  params=params). 
-00005a80: 2020 2020 2020 2069 6620 7265 7370 2e68         if resp.h
-00005a90: 6561 6465 7273 3a0a 2020 2020 2020 2020  eaders:.        
-00005aa0: 2020 2020 7374 6174 6520 3d20 7265 7370      state = resp
-00005ab0: 2e68 6561 6465 7273 2e67 6574 2822 782d  .headers.get("x-
-00005ac0: 6d6c 7275 6e2d 7275 6e2d 7374 6174 6522  mlrun-run-state"
-00005ad0: 2c20 2222 290a 2020 2020 2020 2020 2020  , "").          
-00005ae0: 2020 7265 7475 726e 2073 7461 7465 2e6c    return state.l
-00005af0: 6f77 6572 2829 2c20 7265 7370 2e63 6f6e  ower(), resp.con
-00005b00: 7465 6e74 0a0a 2020 2020 2020 2020 7265  tent..        re
-00005b10: 7475 726e 2022 756e 6b6e 6f77 6e22 2c20  turn "unknown", 
-00005b20: 7265 7370 2e63 6f6e 7465 6e74 0a0a 2020  resp.content..  
-00005b30: 2020 6465 6620 6765 745f 6c6f 675f 7369    def get_log_si
-00005b40: 7a65 2873 656c 662c 2075 6964 2c20 7072  ze(self, uid, pr
-00005b50: 6f6a 6563 743d 2222 293a 0a20 2020 2020  oject=""):.     
-00005b60: 2020 2022 2222 5265 7472 6965 7665 206c     """Retrieve l
-00005b70: 6f67 2073 697a 6520 696e 2062 7974 6573  og size in bytes
-00005b80: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
-00005b90: 6d20 7569 643a 2052 756e 2055 4944 0a20  m uid: Run UID. 
-00005ba0: 2020 2020 2020 203a 7061 7261 6d20 7072         :param pr
-00005bb0: 6f6a 6563 743a 2050 726f 6a65 6374 206e  oject: Project n
-00005bc0: 616d 6520 666f 7220 7768 6963 6820 7468  ame for which th
-00005bd0: 6520 6c6f 6720 6265 6c6f 6e67 730a 2020  e log belongs.  
-00005be0: 2020 2020 2020 3a72 6574 7572 6e73 3a20        :returns: 
-00005bf0: 5468 6520 6c6f 6720 6669 6c65 2073 697a  The log file siz
-00005c00: 6520 696e 2062 7974 6573 2066 6f72 2074  e in bytes for t
-00005c10: 6865 2067 6976 656e 2072 756e 2055 4944  he given run UID
-00005c20: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00005c30: 2020 2020 2020 7061 7468 203d 2073 656c        path = sel
-00005c40: 662e 5f70 6174 685f 6f66 2822 6c6f 6773  f._path_of("logs
-00005c50: 222c 2070 726f 6a65 6374 2c20 7569 6429  ", project, uid)
-00005c60: 0a20 2020 2020 2020 2070 6174 6820 2b3d  .        path +=
-00005c70: 2022 2f73 697a 6522 0a20 2020 2020 2020   "/size".       
-00005c80: 2065 7272 6f72 203d 2066 2267 6574 206c   error = f"get l
-00005c90: 6f67 2073 697a 6520 7b70 726f 6a65 6374  og size {project
-00005ca0: 7d2f 7b75 6964 7d22 0a20 2020 2020 2020  }/{uid}".       
-00005cb0: 2072 6573 7020 3d20 7365 6c66 2e61 7069   resp = self.api
-00005cc0: 5f63 616c 6c28 2247 4554 222c 2070 6174  _call("GET", pat
-00005cd0: 682c 2065 7272 6f72 290a 2020 2020 2020  h, error).      
-00005ce0: 2020 7265 7475 726e 2072 6573 702e 6a73    return resp.js
-00005cf0: 6f6e 2829 5b22 7369 7a65 225d 0a0a 2020  on()["size"]..  
-00005d00: 2020 6465 6620 7761 7463 685f 6c6f 6728    def watch_log(
-00005d10: 7365 6c66 2c20 7569 642c 2070 726f 6a65  self, uid, proje
-00005d20: 6374 3d22 222c 2077 6174 6368 3d54 7275  ct="", watch=Tru
-00005d30: 652c 206f 6666 7365 743d 3029 3a0a 2020  e, offset=0):.  
-00005d40: 2020 2020 2020 2222 2252 6574 7269 6576        """Retriev
-00005d50: 6520 6c6f 6773 206f 6620 6120 7275 6e6e  e logs of a runn
-00005d60: 696e 6720 7072 6f63 6573 7320 6279 2063  ing process by c
-00005d70: 6875 6e6b 7320 6f66 2031 4d42 2c20 616e  hunks of 1MB, an
-00005d80: 6420 7761 7463 6820 7468 6520 7072 6f67  d watch the prog
-00005d90: 7265 7373 206f 6620 7468 6520 6578 6563  ress of the exec
-00005da0: 7574 696f 6e20 756e 7469 6c20 6974 0a20  ution until it. 
-00005db0: 2020 2020 2020 2063 6f6d 706c 6574 6573         completes
-00005dc0: 2e20 5468 6973 206d 6574 686f 6420 7769  . This method wi
-00005dd0: 6c6c 2070 7269 6e74 206f 7574 2074 6865  ll print out the
-00005de0: 206c 6f67 7320 616e 6420 636f 6e74 696e   logs and contin
-00005df0: 7565 2074 6f20 7065 7269 6f64 6963 616c  ue to periodical
-00005e00: 6c79 2070 6f6c 6c20 666f 722c 2061 6e64  ly poll for, and
-00005e10: 2070 7269 6e74 2c0a 2020 2020 2020 2020   print,.        
-00005e20: 6e65 7720 6c6f 6773 2061 7320 6c6f 6e67  new logs as long
-00005e30: 2061 7320 7468 6520 7374 6174 6520 6f66   as the state of
-00005e40: 2074 6865 2072 756e 7469 6d65 2077 6869   the runtime whi
-00005e50: 6368 2067 656e 6572 6174 6573 2074 6869  ch generates thi
-00005e60: 7320 6c6f 6720 6973 2065 6974 6865 7220  s log is either 
-00005e70: 6060 7065 6e64 696e 6760 6020 6f72 2060  ``pending`` or `
-00005e80: 6072 756e 6e69 6e67 6060 2e0a 0a20 2020  `running``...   
-00005e90: 2020 2020 203a 7061 7261 6d20 7569 643a       :param uid:
-00005ea0: 2054 6865 2075 6964 206f 6620 7468 6520   The uid of the 
-00005eb0: 6c6f 6720 6f62 6a65 6374 2074 6f20 7761  log object to wa
-00005ec0: 7463 682e 0a20 2020 2020 2020 203a 7061  tch..        :pa
-00005ed0: 7261 6d20 7072 6f6a 6563 743a 2050 726f  ram project: Pro
-00005ee0: 6a65 6374 2074 6861 7420 7468 6520 6c6f  ject that the lo
-00005ef0: 6720 6265 6c6f 6e67 7320 746f 2e0a 2020  g belongs to..  
-00005f00: 2020 2020 2020 3a70 6172 616d 2077 6174        :param wat
-00005f10: 6368 3a20 4966 2073 6574 2074 6f20 6060  ch: If set to ``
-00005f20: 5472 7565 6060 2077 696c 6c20 636f 6e74  True`` will cont
-00005f30: 696e 7565 2074 7261 636b 696e 6720 7468  inue tracking th
-00005f40: 6520 6c6f 6720 6173 2064 6573 6372 6962  e log as describ
-00005f50: 6564 2061 626f 7665 2e20 4f74 6865 7277  ed above. Otherw
-00005f60: 6973 6520 7468 6973 2066 756e 6374 696f  ise this functio
-00005f70: 6e0a 2020 2020 2020 2020 2020 2020 6973  n.            is
-00005f80: 2070 7261 6374 6963 616c 6c79 2065 7175   practically equ
-00005f90: 6976 616c 656e 7420 746f 2074 6865 203a  ivalent to the :
-00005fa0: 7079 3a66 756e 633a 607e 6765 745f 6c6f  py:func:`~get_lo
-00005fb0: 6760 2066 756e 6374 696f 6e2e 0a20 2020  g` function..   
-00005fc0: 2020 2020 203a 7061 7261 6d20 6f66 6673       :param offs
-00005fd0: 6574 3a20 4d69 6e69 6d61 6c20 6f66 6673  et: Minimal offs
-00005fe0: 6574 2069 6e20 7468 6520 6c6f 6720 746f  et in the log to
-00005ff0: 2077 6174 6368 2e0a 2020 2020 2020 2020   watch..        
-00006000: 3a72 6574 7572 6e73 3a20 5468 6520 6669  :returns: The fi
-00006010: 6e61 6c20 7374 6174 6520 6f66 2074 6865  nal state of the
-00006020: 206c 6f67 2062 6569 6e67 2077 6174 6368   log being watch
-00006030: 6564 2061 6e64 2074 6865 2066 696e 616c  ed and the final
-00006040: 206f 6666 7365 742e 0a20 2020 2020 2020   offset..       
-00006050: 2022 2222 0a0a 2020 2020 2020 2020 7374   """..        st
-00006060: 6174 652c 2074 6578 7420 3d20 7365 6c66  ate, text = self
-00006070: 2e67 6574 5f6c 6f67 2875 6964 2c20 7072  .get_log(uid, pr
-00006080: 6f6a 6563 742c 206f 6666 7365 743d 6f66  oject, offset=of
-00006090: 6673 6574 290a 2020 2020 2020 2020 6966  fset).        if
-000060a0: 2074 6578 743a 0a20 2020 2020 2020 2020   text:.         
-000060b0: 2020 2070 7269 6e74 2874 6578 742e 6465     print(text.de
-000060c0: 636f 6465 2865 7272 6f72 733d 636f 6e66  code(errors=conf
-000060d0: 6967 2e68 7474 7064 622e 6c6f 6773 2e64  ig.httpdb.logs.d
-000060e0: 6563 6f64 652e 6572 726f 7273 2929 0a20  ecode.errors)). 
-000060f0: 2020 2020 2020 206e 696c 5f72 6573 7020         nil_resp 
-00006100: 3d20 300a 2020 2020 2020 2020 7768 696c  = 0.        whil
-00006110: 6520 5472 7565 3a0a 2020 2020 2020 2020  e True:.        
-00006120: 2020 2020 6f66 6673 6574 202b 3d20 6c65      offset += le
-00006130: 6e28 7465 7874 290a 2020 2020 2020 2020  n(text).        
-00006140: 2020 2020 2320 6966 2077 6520 6765 7420      # if we get 
-00006150: 3320 6e69 6c20 7265 7370 6f6e 7365 7320  3 nil responses 
-00006160: 696e 2061 2072 6f77 2c20 696e 6372 6561  in a row, increa
-00006170: 7365 2074 6865 2073 6c65 6570 2074 696d  se the sleep tim
-00006180: 6520 746f 2031 3020 7365 636f 6e64 730a  e to 10 seconds.
-00006190: 2020 2020 2020 2020 2020 2020 2320 544f              # TO
-000061a0: 444f 3a20 7265 6661 6374 6f72 2074 6869  DO: refactor thi
-000061b0: 7320 746f 2075 7365 2061 2063 6f6e 6469  s to use a condi
-000061c0: 7469 6f6e 616c 2062 6163 6b6f 6666 206d  tional backoff m
-000061d0: 6563 6861 6e69 736d 0a20 2020 2020 2020  echanism.       
-000061e0: 2020 2020 2069 6620 6e69 6c5f 7265 7370       if nil_resp
-000061f0: 203c 2033 3a0a 2020 2020 2020 2020 2020   < 3:.          
-00006200: 2020 2020 2020 7469 6d65 2e73 6c65 6570        time.sleep
-00006210: 2869 6e74 2863 6f6e 6669 672e 6874 7470  (int(config.http
-00006220: 6462 2e6c 6f67 732e 7075 6c6c 5f6c 6f67  db.logs.pull_log
-00006230: 735f 6465 6661 756c 745f 696e 7465 7276  s_default_interv
-00006240: 616c 2929 0a20 2020 2020 2020 2020 2020  al)).           
-00006250: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00006260: 2020 2020 2020 2074 696d 652e 736c 6565         time.slee
-00006270: 7028 0a20 2020 2020 2020 2020 2020 2020  p(.             
-00006280: 2020 2020 2020 2069 6e74 2863 6f6e 6669         int(confi
-00006290: 672e 6874 7470 6462 2e6c 6f67 732e 7075  g.httpdb.logs.pu
-000062a0: 6c6c 5f6c 6f67 735f 6261 636b 6f66 665f  ll_logs_backoff_
-000062b0: 6e6f 5f6c 6f67 735f 6465 6661 756c 745f  no_logs_default_
-000062c0: 696e 7465 7276 616c 290a 2020 2020 2020  interval).      
-000062d0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-000062e0: 2020 2020 2020 2020 7374 6174 652c 2074          state, t
-000062f0: 6578 7420 3d20 7365 6c66 2e67 6574 5f6c  ext = self.get_l
-00006300: 6f67 2875 6964 2c20 7072 6f6a 6563 742c  og(uid, project,
-00006310: 206f 6666 7365 743d 6f66 6673 6574 290a   offset=offset).
-00006320: 2020 2020 2020 2020 2020 2020 6966 2074              if t
-00006330: 6578 743a 0a20 2020 2020 2020 2020 2020  ext:.           
-00006340: 2020 2020 206e 696c 5f72 6573 7020 3d20       nil_resp = 
-00006350: 300a 2020 2020 2020 2020 2020 2020 2020  0.              
-00006360: 2020 7072 696e 7428 0a20 2020 2020 2020    print(.       
-00006370: 2020 2020 2020 2020 2020 2020 2074 6578               tex
-00006380: 742e 6465 636f 6465 2865 7272 6f72 733d  t.decode(errors=
-00006390: 636f 6e66 6967 2e68 7474 7064 622e 6c6f  config.httpdb.lo
-000063a0: 6773 2e64 6563 6f64 652e 6572 726f 7273  gs.decode.errors
-000063b0: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-000063c0: 2020 2020 2020 2065 6e64 3d22 222c 0a20         end="",. 
-000063d0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-000063e0: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-000063f0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00006400: 2020 206e 696c 5f72 6573 7020 2b3d 2031     nil_resp += 1
-00006410: 0a0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-00006420: 2077 6174 6368 2061 6e64 2073 7461 7465   watch and state
-00006430: 2069 6e20 5b0a 2020 2020 2020 2020 2020   in [.          
-00006440: 2020 2020 2020 6d6c 7275 6e2e 7275 6e74        mlrun.runt
-00006450: 696d 6573 2e63 6f6e 7374 616e 7473 2e52  imes.constants.R
-00006460: 756e 5374 6174 6573 2e70 656e 6469 6e67  unStates.pending
-00006470: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00006480: 2020 6d6c 7275 6e2e 7275 6e74 696d 6573    mlrun.runtimes
-00006490: 2e63 6f6e 7374 616e 7473 2e52 756e 5374  .constants.RunSt
-000064a0: 6174 6573 2e72 756e 6e69 6e67 2c0a 2020  ates.running,.  
-000064b0: 2020 2020 2020 2020 2020 2020 2020 6d6c                ml
-000064c0: 7275 6e2e 7275 6e74 696d 6573 2e63 6f6e  run.runtimes.con
-000064d0: 7374 616e 7473 2e52 756e 5374 6174 6573  stants.RunStates
-000064e0: 2e63 7265 6174 6564 2c0a 2020 2020 2020  .created,.      
-000064f0: 2020 2020 2020 2020 2020 6d6c 7275 6e2e            mlrun.
-00006500: 7275 6e74 696d 6573 2e63 6f6e 7374 616e  runtimes.constan
-00006510: 7473 2e52 756e 5374 6174 6573 2e61 626f  ts.RunStates.abo
-00006520: 7274 696e 672c 0a20 2020 2020 2020 2020  rting,.         
-00006530: 2020 205d 3a0a 2020 2020 2020 2020 2020     ]:.          
-00006540: 2020 2020 2020 636f 6e74 696e 7565 0a20        continue. 
-00006550: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00006560: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006570: 2023 2074 6865 2077 686f 6c65 206c 6f67   # the whole log
-00006580: 2077 6173 2072 6574 7269 6576 6564 0a20   was retrieved. 
-00006590: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000065a0: 6620 6c65 6e28 7465 7874 2920 3d3d 2030  f len(text) == 0
-000065b0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000065c0: 2020 2020 2020 6272 6561 6b0a 0a20 2020        break..   
-000065d0: 2020 2020 2072 6574 7572 6e20 7374 6174       return stat
-000065e0: 652c 206f 6666 7365 740a 0a20 2020 2064  e, offset..    d
-000065f0: 6566 2073 746f 7265 5f72 756e 2873 656c  ef store_run(sel
-00006600: 662c 2073 7472 7563 742c 2075 6964 2c20  f, struct, uid, 
-00006610: 7072 6f6a 6563 743d 2222 2c20 6974 6572  project="", iter
-00006620: 3d30 293a 0a20 2020 2020 2020 2022 2222  =0):.        """
-00006630: 5374 6f72 6520 7275 6e20 6465 7461 696c  Store run detail
-00006640: 7320 696e 2074 6865 2044 422e 2054 6869  s in the DB. Thi
-00006650: 7320 6d65 7468 6f64 2069 7320 7573 7561  s method is usua
-00006660: 6c6c 7920 6361 6c6c 6564 2066 726f 6d20  lly called from 
-00006670: 7769 7468 696e 206f 7468 6572 203a 7079  within other :py
-00006680: 3a6d 6f64 3a60 6d6c 7275 6e60 2066 6c6f  :mod:`mlrun` flo
-00006690: 7773 0a20 2020 2020 2020 2061 6e64 206e  ws.        and n
-000066a0: 6f74 2063 616c 6c65 6420 6469 7265 6374  ot called direct
-000066b0: 6c79 2062 7920 7468 6520 7573 6572 2e22  ly by the user."
-000066c0: 2222 0a0a 2020 2020 2020 2020 7061 7468  ""..        path
-000066d0: 203d 2073 656c 662e 5f70 6174 685f 6f66   = self._path_of
-000066e0: 2822 7275 6e73 222c 2070 726f 6a65 6374  ("runs", project
-000066f0: 2c20 7569 6429 0a20 2020 2020 2020 2070  , uid).        p
-00006700: 6172 616d 7320 3d20 7b22 6974 6572 223a  arams = {"iter":
-00006710: 2069 7465 727d 0a20 2020 2020 2020 2065   iter}.        e
-00006720: 7272 6f72 203d 2066 2273 746f 7265 2072  rror = f"store r
-00006730: 756e 207b 7072 6f6a 6563 747d 2f7b 7569  un {project}/{ui
-00006740: 647d 220a 2020 2020 2020 2020 626f 6479  d}".        body
-00006750: 203d 205f 6173 5f6a 736f 6e28 7374 7275   = _as_json(stru
-00006760: 6374 290a 2020 2020 2020 2020 7365 6c66  ct).        self
-00006770: 2e61 7069 5f63 616c 6c28 2250 4f53 5422  .api_call("POST"
-00006780: 2c20 7061 7468 2c20 6572 726f 722c 2070  , path, error, p
-00006790: 6172 616d 733d 7061 7261 6d73 2c20 626f  arams=params, bo
-000067a0: 6479 3d62 6f64 7929 0a0a 2020 2020 6465  dy=body)..    de
-000067b0: 6620 7570 6461 7465 5f72 756e 2873 656c  f update_run(sel
-000067c0: 662c 2075 7064 6174 6573 3a20 6469 6374  f, updates: dict
-000067d0: 2c20 7569 642c 2070 726f 6a65 6374 3d22  , uid, project="
-000067e0: 222c 2069 7465 723d 302c 2074 696d 656f  ", iter=0, timeo
-000067f0: 7574 3d34 3529 3a0a 2020 2020 2020 2020  ut=45):.        
-00006800: 2222 2255 7064 6174 6520 7468 6520 6465  """Update the de
-00006810: 7461 696c 7320 6f66 2061 2073 746f 7265  tails of a store
-00006820: 6420 7275 6e20 696e 2074 6865 2044 422e  d run in the DB.
-00006830: 2222 220a 0a20 2020 2020 2020 2070 6174  """..        pat
-00006840: 6820 3d20 7365 6c66 2e5f 7061 7468 5f6f  h = self._path_o
-00006850: 6628 2272 756e 7322 2c20 7072 6f6a 6563  f("runs", projec
-00006860: 742c 2075 6964 290a 2020 2020 2020 2020  t, uid).        
-00006870: 7061 7261 6d73 203d 207b 2269 7465 7222  params = {"iter"
-00006880: 3a20 6974 6572 7d0a 2020 2020 2020 2020  : iter}.        
-00006890: 6572 726f 7220 3d20 6622 7570 6461 7465  error = f"update
-000068a0: 2072 756e 207b 7072 6f6a 6563 747d 2f7b   run {project}/{
-000068b0: 7569 647d 220a 2020 2020 2020 2020 626f  uid}".        bo
-000068c0: 6479 203d 205f 6173 5f6a 736f 6e28 7570  dy = _as_json(up
-000068d0: 6461 7465 7329 0a20 2020 2020 2020 2073  dates).        s
-000068e0: 656c 662e 6170 695f 6361 6c6c 2822 5041  elf.api_call("PA
-000068f0: 5443 4822 2c20 7061 7468 2c20 6572 726f  TCH", path, erro
-00006900: 722c 2070 6172 616d 733d 7061 7261 6d73  r, params=params
-00006910: 2c20 626f 6479 3d62 6f64 792c 2074 696d  , body=body, tim
-00006920: 656f 7574 3d74 696d 656f 7574 290a 0a20  eout=timeout).. 
-00006930: 2020 2064 6566 2061 626f 7274 5f72 756e     def abort_run
-00006940: 2873 656c 662c 2075 6964 2c20 7072 6f6a  (self, uid, proj
-00006950: 6563 743d 2222 2c20 6974 6572 3d30 2c20  ect="", iter=0, 
-00006960: 7469 6d65 6f75 743d 3435 2c20 7374 6174  timeout=45, stat
-00006970: 7573 5f74 6578 743d 2222 293a 0a20 2020  us_text=""):.   
-00006980: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00006990: 2041 626f 7274 2061 2072 756e 6e69 6e67   Abort a running
-000069a0: 2072 756e 202d 2077 696c 6c20 7265 6d6f   run - will remo
-000069b0: 7665 2074 6865 2072 756e 2773 2072 756e  ve the run's run
-000069c0: 7469 6d65 2072 6573 6f75 7263 6573 2061  time resources a
-000069d0: 6e64 206d 6172 6b20 6974 7320 7374 6174  nd mark its stat
-000069e0: 6520 6173 2061 626f 7274 6564 2e0a 2020  e as aborted..  
-000069f0: 2020 2020 2020 3a72 6574 7572 6e73 3a20        :returns: 
-00006a00: 3a70 793a 636c 6173 733a 607e 6d6c 7275  :py:class:`~mlru
-00006a10: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
-00006a20: 2e42 6163 6b67 726f 756e 6454 6173 6b60  .BackgroundTask`
-00006a30: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00006a40: 2020 2020 2020 7072 6f6a 6563 7420 3d20        project = 
-00006a50: 7072 6f6a 6563 7420 6f72 2063 6f6e 6669  project or confi
-00006a60: 672e 6465 6661 756c 745f 7072 6f6a 6563  g.default_projec
-00006a70: 740a 2020 2020 2020 2020 7061 7261 6d73  t.        params
-00006a80: 203d 207b 2269 7465 7222 3a20 6974 6572   = {"iter": iter
-00006a90: 7d0a 2020 2020 2020 2020 7570 6461 7465  }.        update
-00006aa0: 7320 3d20 7b7d 0a20 2020 2020 2020 2069  s = {}.        i
-00006ab0: 6620 7374 6174 7573 5f74 6578 743a 0a20  f status_text:. 
-00006ac0: 2020 2020 2020 2020 2020 2075 7064 6174             updat
-00006ad0: 6573 5b22 7374 6174 7573 2e73 7461 7475  es["status.statu
-00006ae0: 735f 7465 7874 225d 203d 2073 7461 7475  s_text"] = statu
-00006af0: 735f 7465 7874 0a20 2020 2020 2020 2062  s_text.        b
-00006b00: 6f64 7920 3d20 5f61 735f 6a73 6f6e 2875  ody = _as_json(u
-00006b10: 7064 6174 6573 290a 0a20 2020 2020 2020  pdates)..       
-00006b20: 2072 6573 706f 6e73 6520 3d20 7365 6c66   response = self
-00006b30: 2e61 7069 5f63 616c 6c28 0a20 2020 2020  .api_call(.     
-00006b40: 2020 2020 2020 2022 504f 5354 222c 0a20         "POST",. 
-00006b50: 2020 2020 2020 2020 2020 2070 6174 683d             path=
-00006b60: 6622 7072 6f6a 6563 7473 2f7b 7072 6f6a  f"projects/{proj
-00006b70: 6563 747d 2f72 756e 732f 7b75 6964 7d2f  ect}/runs/{uid}/
-00006b80: 6162 6f72 7422 2c0a 2020 2020 2020 2020  abort",.        
-00006b90: 2020 2020 6572 726f 723d 2246 6169 6c65      error="Faile
-00006ba0: 6420 7275 6e20 6162 6f72 7469 6f6e 222c  d run abortion",
-00006bb0: 0a20 2020 2020 2020 2020 2020 2070 6172  .            par
-00006bc0: 616d 733d 7061 7261 6d73 2c0a 2020 2020  ams=params,.    
-00006bd0: 2020 2020 2020 2020 626f 6479 3d62 6f64          body=bod
-00006be0: 792c 0a20 2020 2020 2020 2020 2020 2074  y,.            t
-00006bf0: 696d 656f 7574 3d74 696d 656f 7574 2c0a  imeout=timeout,.
-00006c00: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00006c10: 2020 6966 2072 6573 706f 6e73 652e 7374    if response.st
-00006c20: 6174 7573 5f63 6f64 6520 3d3d 2068 7474  atus_code == htt
-00006c30: 702e 4854 5450 5374 6174 7573 2e41 4343  p.HTTPStatus.ACC
-00006c40: 4550 5445 443a 0a20 2020 2020 2020 2020  EPTED:.         
-00006c50: 2020 2062 6163 6b67 726f 756e 645f 7461     background_ta
-00006c60: 736b 203d 206d 6c72 756e 2e63 6f6d 6d6f  sk = mlrun.commo
-00006c70: 6e2e 7363 6865 6d61 732e 4261 636b 6772  n.schemas.Backgr
-00006c80: 6f75 6e64 5461 736b 282a 2a72 6573 706f  oundTask(**respo
-00006c90: 6e73 652e 6a73 6f6e 2829 290a 2020 2020  nse.json()).    
-00006ca0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00006cb0: 656c 662e 5f77 6169 745f 666f 725f 6261  elf._wait_for_ba
-00006cc0: 636b 6772 6f75 6e64 5f74 6173 6b5f 746f  ckground_task_to
-00006cd0: 5f72 6561 6368 5f74 6572 6d69 6e61 6c5f  _reach_terminal_
-00006ce0: 7374 6174 6528 0a20 2020 2020 2020 2020  state(.         
-00006cf0: 2020 2020 2020 2062 6163 6b67 726f 756e         backgroun
-00006d00: 645f 7461 736b 2e6d 6574 6164 6174 612e  d_task.metadata.
-00006d10: 6e61 6d65 2c20 7072 6f6a 6563 743d 7072  name, project=pr
-00006d20: 6f6a 6563 740a 2020 2020 2020 2020 2020  oject.          
-00006d30: 2020 290a 2020 2020 2020 2020 7265 7475    ).        retu
-00006d40: 726e 204e 6f6e 650a 0a20 2020 2064 6566  rn None..    def
-00006d50: 2072 6561 645f 7275 6e28 7365 6c66 2c20   read_run(self, 
-00006d60: 7569 642c 2070 726f 6a65 6374 3d22 222c  uid, project="",
-00006d70: 2069 7465 723d 3029 3a0a 2020 2020 2020   iter=0):.      
-00006d80: 2020 2222 2252 6561 6420 7468 6520 6465    """Read the de
-00006d90: 7461 696c 7320 6f66 2061 2073 746f 7265  tails of a store
-00006da0: 6420 7275 6e20 6672 6f6d 2074 6865 2044  d run from the D
-00006db0: 422e 0a0a 2020 2020 2020 2020 3a70 6172  B...        :par
-00006dc0: 616d 2075 6964 3a20 5468 6520 7275 6e27  am uid: The run'
-00006dd0: 7320 756e 6971 7565 2049 442e 0a20 2020  s unique ID..   
-00006de0: 2020 2020 203a 7061 7261 6d20 7072 6f6a       :param proj
-00006df0: 6563 743a 2050 726f 6a65 6374 206e 616d  ect: Project nam
-00006e00: 652e 0a20 2020 2020 2020 203a 7061 7261  e..        :para
-00006e10: 6d20 6974 6572 3a20 4974 6572 6174 696f  m iter: Iteratio
-00006e20: 6e20 7769 7468 696e 2061 2073 7065 6369  n within a speci
-00006e30: 6669 6320 6578 6563 7574 696f 6e2e 0a20  fic execution.. 
-00006e40: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
-00006e50: 2020 2020 7061 7468 203d 2073 656c 662e      path = self.
-00006e60: 5f70 6174 685f 6f66 2822 7275 6e73 222c  _path_of("runs",
-00006e70: 2070 726f 6a65 6374 2c20 7569 6429 0a20   project, uid). 
-00006e80: 2020 2020 2020 2070 6172 616d 7320 3d20         params = 
-00006e90: 7b22 6974 6572 223a 2069 7465 727d 0a20  {"iter": iter}. 
-00006ea0: 2020 2020 2020 2065 7272 6f72 203d 2066         error = f
-00006eb0: 2267 6574 2072 756e 207b 7072 6f6a 6563  "get run {projec
-00006ec0: 747d 2f7b 7569 647d 220a 2020 2020 2020  t}/{uid}".      
-00006ed0: 2020 7265 7370 203d 2073 656c 662e 6170    resp = self.ap
-00006ee0: 695f 6361 6c6c 2822 4745 5422 2c20 7061  i_call("GET", pa
-00006ef0: 7468 2c20 6572 726f 722c 2070 6172 616d  th, error, param
-00006f00: 733d 7061 7261 6d73 290a 2020 2020 2020  s=params).      
-00006f10: 2020 7265 7475 726e 2072 6573 702e 6a73    return resp.js
-00006f20: 6f6e 2829 5b22 6461 7461 225d 0a0a 2020  on()["data"]..  
-00006f30: 2020 6465 6620 6465 6c5f 7275 6e28 7365    def del_run(se
-00006f40: 6c66 2c20 7569 642c 2070 726f 6a65 6374  lf, uid, project
-00006f50: 3d22 222c 2069 7465 723d 3029 3a0a 2020  ="", iter=0):.  
-00006f60: 2020 2020 2020 2222 2244 656c 6574 6520        """Delete 
-00006f70: 6465 7461 696c 7320 6f66 2061 2073 7065  details of a spe
-00006f80: 6369 6669 6320 7275 6e20 6672 6f6d 2044  cific run from D
-00006f90: 422e 0a0a 2020 2020 2020 2020 3a70 6172  B...        :par
-00006fa0: 616d 2075 6964 3a20 556e 6971 7565 2049  am uid: Unique I
-00006fb0: 4420 666f 7220 7468 6520 7370 6563 6966  D for the specif
-00006fc0: 6963 2072 756e 2074 6f20 6465 6c65 7465  ic run to delete
-00006fd0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00006fe0: 2070 726f 6a65 6374 3a20 5072 6f6a 6563   project: Projec
-00006ff0: 7420 7468 6174 2074 6865 2072 756e 2062  t that the run b
-00007000: 656c 6f6e 6773 2074 6f2e 0a20 2020 2020  elongs to..     
-00007010: 2020 203a 7061 7261 6d20 6974 6572 3a20     :param iter: 
-00007020: 4974 6572 6174 696f 6e20 7769 7468 696e  Iteration within
-00007030: 2061 2073 7065 6369 6669 6320 7461 736b   a specific task
-00007040: 2e0a 2020 2020 2020 2020 2222 220a 0a20  ..        """.. 
-00007050: 2020 2020 2020 2070 6174 6820 3d20 7365         path = se
-00007060: 6c66 2e5f 7061 7468 5f6f 6628 2272 756e  lf._path_of("run
-00007070: 7322 2c20 7072 6f6a 6563 742c 2075 6964  s", project, uid
-00007080: 290a 2020 2020 2020 2020 7061 7261 6d73  ).        params
-00007090: 203d 207b 2269 7465 7222 3a20 6974 6572   = {"iter": iter
-000070a0: 7d0a 2020 2020 2020 2020 6572 726f 7220  }.        error 
-000070b0: 3d20 6622 6465 6c20 7275 6e20 7b70 726f  = f"del run {pro
-000070c0: 6a65 6374 7d2f 7b75 6964 7d22 0a20 2020  ject}/{uid}".   
-000070d0: 2020 2020 2073 656c 662e 6170 695f 6361       self.api_ca
-000070e0: 6c6c 2822 4445 4c45 5445 222c 2070 6174  ll("DELETE", pat
-000070f0: 682c 2065 7272 6f72 2c20 7061 7261 6d73  h, error, params
-00007100: 3d70 6172 616d 7329 0a0a 2020 2020 6465  =params)..    de
-00007110: 6620 6c69 7374 5f72 756e 7328 0a20 2020  f list_runs(.   
-00007120: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-00007130: 2020 206e 616d 653a 204f 7074 696f 6e61     name: Optiona
-00007140: 6c5b 7374 725d 203d 204e 6f6e 652c 0a20  l[str] = None,. 
-00007150: 2020 2020 2020 2075 6964 3a20 4f70 7469         uid: Opti
-00007160: 6f6e 616c 5b55 6e69 6f6e 5b73 7472 2c20  onal[Union[str, 
-00007170: 6c69 7374 5b73 7472 5d5d 5d20 3d20 4e6f  list[str]]] = No
-00007180: 6e65 2c0a 2020 2020 2020 2020 7072 6f6a  ne,.        proj
-00007190: 6563 743a 204f 7074 696f 6e61 6c5b 7374  ect: Optional[st
-000071a0: 725d 203d 204e 6f6e 652c 0a20 2020 2020  r] = None,.     
-000071b0: 2020 206c 6162 656c 733a 204f 7074 696f     labels: Optio
-000071c0: 6e61 6c5b 556e 696f 6e5b 7374 722c 206c  nal[Union[str, l
-000071d0: 6973 745b 7374 725d 5d5d 203d 204e 6f6e  ist[str]]] = Non
-000071e0: 652c 0a20 2020 2020 2020 2073 7461 7465  e,.        state
-000071f0: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
-00007200: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-00007210: 736f 7274 3a20 626f 6f6c 203d 2054 7275  sort: bool = Tru
-00007220: 652c 0a20 2020 2020 2020 206c 6173 743a  e,.        last:
-00007230: 2069 6e74 203d 2030 2c0a 2020 2020 2020   int = 0,.      
-00007240: 2020 6974 6572 3a20 626f 6f6c 203d 2046    iter: bool = F
-00007250: 616c 7365 2c0a 2020 2020 2020 2020 7374  alse,.        st
-00007260: 6172 745f 7469 6d65 5f66 726f 6d3a 204f  art_time_from: O
-00007270: 7074 696f 6e61 6c5b 6461 7465 7469 6d65  ptional[datetime
-00007280: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
-00007290: 2020 7374 6172 745f 7469 6d65 5f74 6f3a    start_time_to:
-000072a0: 204f 7074 696f 6e61 6c5b 6461 7465 7469   Optional[dateti
-000072b0: 6d65 5d20 3d20 4e6f 6e65 2c0a 2020 2020  me] = None,.    
-000072c0: 2020 2020 6c61 7374 5f75 7064 6174 655f      last_update_
-000072d0: 7469 6d65 5f66 726f 6d3a 204f 7074 696f  time_from: Optio
-000072e0: 6e61 6c5b 6461 7465 7469 6d65 5d20 3d20  nal[datetime] = 
-000072f0: 4e6f 6e65 2c0a 2020 2020 2020 2020 6c61  None,.        la
-00007300: 7374 5f75 7064 6174 655f 7469 6d65 5f74  st_update_time_t
-00007310: 6f3a 204f 7074 696f 6e61 6c5b 6461 7465  o: Optional[date
-00007320: 7469 6d65 5d20 3d20 4e6f 6e65 2c0a 2020  time] = None,.  
-00007330: 2020 2020 2020 7061 7274 6974 696f 6e5f        partition_
-00007340: 6279 3a20 4f70 7469 6f6e 616c 5b0a 2020  by: Optional[.  
-00007350: 2020 2020 2020 2020 2020 556e 696f 6e5b            Union[
-00007360: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-00007370: 656d 6173 2e52 756e 5061 7274 6974 696f  emas.RunPartitio
-00007380: 6e42 7946 6965 6c64 2c20 7374 725d 0a20  nByField, str]. 
-00007390: 2020 2020 2020 205d 203d 204e 6f6e 652c         ] = None,
-000073a0: 0a20 2020 2020 2020 2072 6f77 735f 7065  .        rows_pe
-000073b0: 725f 7061 7274 6974 696f 6e3a 2069 6e74  r_partition: int
-000073c0: 203d 2031 2c0a 2020 2020 2020 2020 7061   = 1,.        pa
-000073d0: 7274 6974 696f 6e5f 736f 7274 5f62 793a  rtition_sort_by:
-000073e0: 204f 7074 696f 6e61 6c5b 556e 696f 6e5b   Optional[Union[
-000073f0: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-00007400: 656d 6173 2e53 6f72 7446 6965 6c64 2c20  emas.SortField, 
-00007410: 7374 725d 5d20 3d20 4e6f 6e65 2c0a 2020  str]] = None,.  
-00007420: 2020 2020 2020 7061 7274 6974 696f 6e5f        partition_
-00007430: 6f72 6465 723a 2055 6e69 6f6e 5b0a 2020  order: Union[.  
-00007440: 2020 2020 2020 2020 2020 6d6c 7275 6e2e            mlrun.
-00007450: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e4f  common.schemas.O
-00007460: 7264 6572 5479 7065 2c20 7374 720a 2020  rderType, str.  
-00007470: 2020 2020 2020 5d20 3d20 6d6c 7275 6e2e        ] = mlrun.
-00007480: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e4f  common.schemas.O
-00007490: 7264 6572 5479 7065 2e64 6573 632c 0a20  rderType.desc,. 
-000074a0: 2020 2020 2020 206d 6178 5f70 6172 7469         max_parti
-000074b0: 7469 6f6e 733a 2069 6e74 203d 2030 2c0a  tions: int = 0,.
-000074c0: 2020 2020 2020 2020 7769 7468 5f6e 6f74          with_not
-000074d0: 6966 6963 6174 696f 6e73 3a20 626f 6f6c  ifications: bool
-000074e0: 203d 2046 616c 7365 2c0a 2020 2020 2920   = False,.    ) 
-000074f0: 2d3e 2052 756e 4c69 7374 3a0a 2020 2020  -> RunList:.    
-00007500: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00007510: 5265 7472 6965 7665 2061 206c 6973 7420  Retrieve a list 
-00007520: 6f66 2072 756e 732c 2066 696c 7465 7265  of runs, filtere
-00007530: 6420 6279 2076 6172 696f 7573 206f 7074  d by various opt
-00007540: 696f 6e73 2e0a 2020 2020 2020 2020 4966  ions..        If
-00007550: 206e 6f20 6669 6c74 6572 2069 7320 7072   no filter is pr
-00007560: 6f76 6964 6564 2c20 7769 6c6c 2072 6574  ovided, will ret
-00007570: 7572 6e20 7275 6e73 2066 726f 6d20 7468  urn runs from th
-00007580: 6520 6c61 7374 2077 6565 6b2e 0a0a 2020  e last week...  
-00007590: 2020 2020 2020 4578 616d 706c 653a 3a0a        Example::.
-000075a0: 0a20 2020 2020 2020 2020 2020 2072 756e  .            run
-000075b0: 7320 3d20 6462 2e6c 6973 745f 7275 6e73  s = db.list_runs
-000075c0: 286e 616d 653d 2764 6f77 6e6c 6f61 6427  (name='download'
-000075d0: 2c20 7072 6f6a 6563 743d 2769 7269 7327  , project='iris'
-000075e0: 2c20 6c61 6265 6c73 3d5b 276f 776e 6572  , labels=['owner
-000075f0: 3d61 646d 696e 272c 2027 6b69 6e64 3d6a  =admin', 'kind=j
-00007600: 6f62 275d 290a 2020 2020 2020 2020 2020  ob']).          
-00007610: 2020 2320 4966 2072 756e 6e69 6e67 2069    # If running i
-00007620: 6e20 4a75 7079 7465 722c 2063 616e 2075  n Jupyter, can u
-00007630: 7365 2074 6865 202e 7368 6f77 2829 2066  se the .show() f
-00007640: 756e 6374 696f 6e20 746f 2064 6973 706c  unction to displ
-00007650: 6179 2074 6865 2072 6573 756c 7473 0a20  ay the results. 
-00007660: 2020 2020 2020 2020 2020 2064 622e 6c69             db.li
-00007670: 7374 5f72 756e 7328 6e61 6d65 3d27 272c  st_runs(name='',
-00007680: 2070 726f 6a65 6374 3d70 726f 6a65 6374   project=project
-00007690: 5f6e 616d 6529 2e73 686f 7728 290a 0a0a  _name).show()...
-000076a0: 2020 2020 2020 2020 3a70 6172 616d 206e          :param n
-000076b0: 616d 653a 204e 616d 6520 6f66 2074 6865  ame: Name of the
-000076c0: 2072 756e 2074 6f20 7265 7472 6965 7665   run to retrieve
-000076d0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-000076e0: 2075 6964 3a20 556e 6971 7565 2049 4420   uid: Unique ID 
-000076f0: 6f66 2074 6865 2072 756e 2c20 6f72 2061  of the run, or a
-00007700: 206c 6973 7420 6f66 2072 756e 2055 4944   list of run UID
-00007710: 732e 0a20 2020 2020 2020 203a 7061 7261  s..        :para
-00007720: 6d20 7072 6f6a 6563 743a 2050 726f 6a65  m project: Proje
-00007730: 6374 2074 6861 7420 7468 6520 7275 6e73  ct that the runs
-00007740: 2062 656c 6f6e 6773 2074 6f2e 0a20 2020   belongs to..   
-00007750: 2020 2020 203a 7061 7261 6d20 6c61 6265       :param labe
-00007760: 6c73 3a20 4120 6c69 7374 206f 6620 6c61  ls: A list of la
-00007770: 6265 6c73 2074 6f20 6669 6c74 6572 2062  bels to filter b
-00007780: 792e 204c 6162 656c 2066 696c 7465 7273  y. Label filters
-00007790: 2077 6f72 6b20 6279 2065 6974 6865 7220   work by either 
-000077a0: 6669 6c74 6572 696e 6720 6120 7370 6563  filtering a spec
-000077b0: 6966 6963 2076 616c 7565 0a20 2020 2020  ific value.     
-000077c0: 2020 2020 2020 206f 6620 6120 6c61 6265         of a labe
-000077d0: 6c20 2869 2e65 2e20 6c69 7374 2822 6b65  l (i.e. list("ke
-000077e0: 793d 7661 6c75 6522 2929 206f 7220 6279  y=value")) or by
-000077f0: 206c 6f6f 6b69 6e67 2066 6f72 2074 6865   looking for the
-00007800: 2065 7869 7374 656e 6365 206f 6620 6120   existence of a 
-00007810: 6769 7665 6e0a 2020 2020 2020 2020 2020  given.          
-00007820: 2020 6b65 7920 2869 2e65 2e20 226b 6579    key (i.e. "key
-00007830: 2229 2e0a 2020 2020 2020 2020 3a70 6172  ")..        :par
-00007840: 616d 2073 7461 7465 3a20 4c69 7374 206f  am state: List o
-00007850: 6e6c 7920 7275 6e73 2077 686f 7365 2073  nly runs whose s
-00007860: 7461 7465 2069 7320 7370 6563 6966 6965  tate is specifie
-00007870: 642e 0a20 2020 2020 2020 203a 7061 7261  d..        :para
-00007880: 6d20 736f 7274 3a20 5768 6574 6865 7220  m sort: Whether 
-00007890: 746f 2073 6f72 7420 7468 6520 7265 7375  to sort the resu
-000078a0: 6c74 2061 6363 6f72 6469 6e67 2074 6f20  lt according to 
-000078b0: 7468 6569 7220 7374 6172 7420 7469 6d65  their start time
-000078c0: 2e20 4f74 6865 7277 6973 652c 2072 6573  . Otherwise, res
-000078d0: 756c 7473 2077 696c 6c20 6265 0a20 2020  ults will be.   
-000078e0: 2020 2020 2020 2020 2072 6574 7572 6e65           returne
-000078f0: 6420 6279 2074 6865 6972 2069 6e74 6572  d by their inter
-00007900: 6e61 6c20 6f72 6465 7220 696e 2074 6865  nal order in the
-00007910: 2044 4220 286f 7264 6572 2077 696c 6c20   DB (order will 
-00007920: 6e6f 7420 6265 2067 7561 7261 6e74 6565  not be guarantee
-00007930: 6429 2e0a 2020 2020 2020 2020 3a70 6172  d)..        :par
-00007940: 616d 206c 6173 743a 2044 6570 7265 6361  am last: Depreca
-00007950: 7465 6420 2d20 6375 7272 656e 746c 7920  ted - currently 
-00007960: 6e6f 7420 7573 6564 2028 7769 6c6c 2062  not used (will b
-00007970: 6520 7265 6d6f 7665 6420 696e 2031 2e38  e removed in 1.8
-00007980: 2e30 292e 0a20 2020 2020 2020 203a 7061  .0)..        :pa
-00007990: 7261 6d20 6974 6572 3a20 4966 2060 6054  ram iter: If ``T
-000079a0: 7275 6560 6020 7265 7475 726e 2072 756e  rue`` return run
-000079b0: 7320 6672 6f6d 2061 6c6c 2069 7465 7261  s from all itera
-000079c0: 7469 6f6e 732e 204f 7468 6572 7769 7365  tions. Otherwise
-000079d0: 2c20 7265 7475 726e 206f 6e6c 7920 7275  , return only ru
-000079e0: 6e73 2077 686f 7365 2060 6069 7465 7260  ns whose ``iter`
-000079f0: 6020 6973 2030 2e0a 2020 2020 2020 2020  ` is 0..        
-00007a00: 3a70 6172 616d 2073 7461 7274 5f74 696d  :param start_tim
-00007a10: 655f 6672 6f6d 3a20 4669 6c74 6572 2062  e_from: Filter b
-00007a20: 7920 7275 6e20 7374 6172 7420 7469 6d65  y run start time
-00007a30: 2069 6e20 6060 5b73 7461 7274 5f74 696d   in ``[start_tim
-00007a40: 655f 6672 6f6d 2c20 7374 6172 745f 7469  e_from, start_ti
-00007a50: 6d65 5f74 6f5d 6060 2e0a 2020 2020 2020  me_to]``..      
-00007a60: 2020 3a70 6172 616d 2073 7461 7274 5f74    :param start_t
-00007a70: 696d 655f 746f 3a20 4669 6c74 6572 2062  ime_to: Filter b
-00007a80: 7920 7275 6e20 7374 6172 7420 7469 6d65  y run start time
-00007a90: 2069 6e20 6060 5b73 7461 7274 5f74 696d   in ``[start_tim
-00007aa0: 655f 6672 6f6d 2c20 7374 6172 745f 7469  e_from, start_ti
-00007ab0: 6d65 5f74 6f5d 6060 2e0a 2020 2020 2020  me_to]``..      
-00007ac0: 2020 3a70 6172 616d 206c 6173 745f 7570    :param last_up
-00007ad0: 6461 7465 5f74 696d 655f 6672 6f6d 3a20  date_time_from: 
-00007ae0: 4669 6c74 6572 2062 7920 7275 6e20 6c61  Filter by run la
-00007af0: 7374 2075 7064 6174 6520 7469 6d65 2069  st update time i
-00007b00: 6e20 6060 286c 6173 745f 7570 6461 7465  n ``(last_update
-00007b10: 5f74 696d 655f 6672 6f6d 2c0a 2020 2020  _time_from,.    
-00007b20: 2020 2020 2020 2020 6c61 7374 5f75 7064          last_upd
-00007b30: 6174 655f 7469 6d65 5f74 6f29 6060 2e0a  ate_time_to)``..
-00007b40: 2020 2020 2020 2020 3a70 6172 616d 206c          :param l
-00007b50: 6173 745f 7570 6461 7465 5f74 696d 655f  ast_update_time_
-00007b60: 746f 3a20 4669 6c74 6572 2062 7920 7275  to: Filter by ru
-00007b70: 6e20 6c61 7374 2075 7064 6174 6520 7469  n last update ti
-00007b80: 6d65 2069 6e20 6060 286c 6173 745f 7570  me in ``(last_up
-00007b90: 6461 7465 5f74 696d 655f 6672 6f6d 2c20  date_time_from, 
-00007ba0: 6c61 7374 5f75 7064 6174 655f 7469 6d65  last_update_time
-00007bb0: 5f74 6f29 6060 2e0a 2020 2020 2020 2020  _to)``..        
-00007bc0: 3a70 6172 616d 2070 6172 7469 7469 6f6e  :param partition
-00007bd0: 5f62 793a 2046 6965 6c64 2074 6f20 6772  _by: Field to gr
-00007be0: 6f75 7020 7265 7375 6c74 7320 6279 2e20  oup results by. 
-00007bf0: 4f6e 6c79 2061 6c6c 6f77 6564 2076 616c  Only allowed val
-00007c00: 7565 2069 7320 606e 616d 6560 2e20 5768  ue is `name`. Wh
-00007c10: 656e 2060 7061 7274 6974 696f 6e5f 6279  en `partition_by
-00007c20: 6020 6973 2073 7065 6369 6669 6564 2c0a  ` is specified,.
-00007c30: 2020 2020 2020 2020 2020 2020 7468 6520              the 
-00007c40: 6070 6172 7469 7469 6f6e 5f73 6f72 745f  `partition_sort_
-00007c50: 6279 6020 7061 7261 6d65 7465 7220 6d75  by` parameter mu
-00007c60: 7374 2062 6520 7072 6f76 6964 6564 2061  st be provided a
-00007c70: 7320 7765 6c6c 2e0a 2020 2020 2020 2020  s well..        
-00007c80: 3a70 6172 616d 2072 6f77 735f 7065 725f  :param rows_per_
-00007c90: 7061 7274 6974 696f 6e3a 2048 6f77 206d  partition: How m
-00007ca0: 616e 7920 746f 7020 726f 7773 2028 7065  any top rows (pe
-00007cb0: 7220 736f 7274 696e 6720 6465 6669 6e65  r sorting define
-00007cc0: 6420 6279 2060 7061 7274 6974 696f 6e5f  d by `partition_
-00007cd0: 736f 7274 5f62 7960 2061 6e64 2060 7061  sort_by` and `pa
-00007ce0: 7274 6974 696f 6e5f 6f72 6465 7260 290a  rtition_order`).
-00007cf0: 2020 2020 2020 2020 2020 2020 746f 2072              to r
-00007d00: 6574 7572 6e20 7065 7220 6772 6f75 702e  eturn per group.
-00007d10: 2044 6566 6175 6c74 2076 616c 7565 2069   Default value i
-00007d20: 7320 312e 0a20 2020 2020 2020 203a 7061  s 1..        :pa
-00007d30: 7261 6d20 7061 7274 6974 696f 6e5f 736f  ram partition_so
-00007d40: 7274 5f62 793a 2057 6861 7420 6669 656c  rt_by: What fiel
-00007d50: 6420 746f 2073 6f72 7420 7468 6520 7265  d to sort the re
-00007d60: 7375 6c74 7320 6279 2c20 7769 7468 696e  sults by, within
-00007d70: 2065 6163 6820 7061 7274 6974 696f 6e20   each partition 
-00007d80: 6465 6669 6e65 6420 6279 2060 7061 7274  defined by `part
-00007d90: 6974 696f 6e5f 6279 602e 0a20 2020 2020  ition_by`..     
-00007da0: 2020 2020 2020 2043 7572 7265 6e74 6c79         Currently
-00007db0: 2074 6865 206f 6e6c 7920 616c 6c6f 7765   the only allowe
-00007dc0: 6420 7661 6c75 6573 2061 7265 2060 6372  d values are `cr
-00007dd0: 6561 7465 6460 2061 6e64 2060 7570 6461  eated` and `upda
-00007de0: 7465 6460 2e0a 2020 2020 2020 2020 3a70  ted`..        :p
-00007df0: 6172 616d 2070 6172 7469 7469 6f6e 5f6f  aram partition_o
-00007e00: 7264 6572 3a20 4f72 6465 7220 6f66 2073  rder: Order of s
-00007e10: 6f72 7469 6e67 2077 6974 6869 6e20 7061  orting within pa
-00007e20: 7274 6974 696f 6e73 202d 2060 6173 6360  rtitions - `asc`
-00007e30: 206f 7220 6064 6573 6360 2e20 4465 6661   or `desc`. Defa
-00007e40: 756c 7420 6973 2060 6465 7363 602e 0a20  ult is `desc`.. 
-00007e50: 2020 2020 2020 203a 7061 7261 6d20 6d61         :param ma
-00007e60: 785f 7061 7274 6974 696f 6e73 3a20 4d61  x_partitions: Ma
-00007e70: 7869 6d61 6c20 6e75 6d62 6572 206f 6620  ximal number of 
-00007e80: 7061 7274 6974 696f 6e73 2074 6f20 696e  partitions to in
-00007e90: 636c 7564 6520 696e 2074 6865 2072 6573  clude in the res
-00007ea0: 756c 742e 2044 6566 6175 6c74 2069 7320  ult. Default is 
-00007eb0: 6030 6020 7768 6963 6820 6d65 616e 7320  `0` which means 
-00007ec0: 6e6f 0a20 2020 2020 2020 2020 2020 206c  no.            l
-00007ed0: 696d 6974 2e0a 2020 2020 2020 2020 3a70  imit..        :p
-00007ee0: 6172 616d 2077 6974 685f 6e6f 7469 6669  aram with_notifi
-00007ef0: 6361 7469 6f6e 733a 2052 6574 7572 6e20  cations: Return 
-00007f00: 7275 6e73 2077 6974 6820 6e6f 7469 6669  runs with notifi
-00007f10: 6361 7469 6f6e 732c 2061 6e64 206a 6f69  cations, and joi
-00007f20: 6e20 7468 656d 2074 6f20 7468 6520 7265  n them to the re
-00007f30: 7370 6f6e 7365 2e20 4465 6661 756c 7420  sponse. Default 
-00007f40: 6973 2060 4661 6c73 6560 2e0a 2020 2020  is `False`..    
-00007f50: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
-00007f60: 2070 726f 6a65 6374 203d 2070 726f 6a65   project = proje
-00007f70: 6374 206f 7220 636f 6e66 6967 2e64 6566  ct or config.def
-00007f80: 6175 6c74 5f70 726f 6a65 6374 0a20 2020  ault_project.   
-00007f90: 2020 2020 2069 6620 7769 7468 5f6e 6f74       if with_not
-00007fa0: 6966 6963 6174 696f 6e73 3a0a 2020 2020  ifications:.    
-00007fb0: 2020 2020 2020 2020 6c6f 6767 6572 2e77          logger.w
-00007fc0: 6172 6e69 6e67 280a 2020 2020 2020 2020  arning(.        
-00007fd0: 2020 2020 2020 2020 224c 6f63 616c 2072          "Local r
-00007fe0: 756e 206e 6f74 6966 6963 6174 696f 6e73  un notifications
-00007ff0: 2061 7265 206e 6f74 2070 6572 7369 7374   are not persist
-00008000: 6564 2069 6e20 7468 6520 4442 2c20 7468  ed in the DB, th
-00008010: 6572 6566 6f72 6520 6c6f 6361 6c20 7275  erefore local ru
-00008020: 6e73 2077 696c 6c20 6e6f 7420 6265 2072  ns will not be r
-00008030: 6574 7572 6e65 6420 7768 656e 2022 0a20  eturned when ". 
-00008040: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00008050: 7573 696e 6720 7468 6520 6077 6974 685f  using the `with_
-00008060: 6e6f 7469 6669 6361 7469 6f6e 7360 2066  notifications` f
-00008070: 6c61 672e 220a 2020 2020 2020 2020 2020  lag.".          
-00008080: 2020 290a 0a20 2020 2020 2020 2069 6620    )..        if 
-00008090: 6c61 7374 3a0a 2020 2020 2020 2020 2020  last:.          
-000080a0: 2020 2320 544f 444f 3a20 5265 6d6f 7665    # TODO: Remove
-000080b0: 2074 6869 7320 696e 2031 2e38 2e30 0a20   this in 1.8.0. 
-000080c0: 2020 2020 2020 2020 2020 2077 6172 6e69             warni
-000080d0: 6e67 732e 7761 726e 280a 2020 2020 2020  ngs.warn(.      
-000080e0: 2020 2020 2020 2020 2020 2227 6c61 7374            "'last
-000080f0: 2720 6973 2064 6570 7265 6361 7465 6420  ' is deprecated 
-00008100: 616e 6420 7769 6c6c 2062 6520 7265 6d6f  and will be remo
-00008110: 7665 6420 696e 2031 2e38 2e30 2e22 2c0a  ved in 1.8.0.",.
-00008120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008130: 4675 7475 7265 5761 726e 696e 672c 0a20  FutureWarning,. 
-00008140: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-00008150: 2020 2020 2020 6966 2028 0a20 2020 2020        if (.     
-00008160: 2020 2020 2020 206e 6f74 206e 616d 650a         not name.
-00008170: 2020 2020 2020 2020 2020 2020 616e 6420              and 
-00008180: 6e6f 7420 7569 640a 2020 2020 2020 2020  not uid.        
-00008190: 2020 2020 616e 6420 6e6f 7420 6c61 6265      and not labe
-000081a0: 6c73 0a20 2020 2020 2020 2020 2020 2061  ls.            a
-000081b0: 6e64 206e 6f74 2073 7461 7465 0a20 2020  nd not state.   
-000081c0: 2020 2020 2020 2020 2061 6e64 206e 6f74           and not
-000081d0: 206c 6173 740a 2020 2020 2020 2020 2020   last.          
-000081e0: 2020 616e 6420 6e6f 7420 7374 6172 745f    and not start_
-000081f0: 7469 6d65 5f66 726f 6d0a 2020 2020 2020  time_from.      
-00008200: 2020 2020 2020 616e 6420 6e6f 7420 7374        and not st
-00008210: 6172 745f 7469 6d65 5f74 6f0a 2020 2020  art_time_to.    
-00008220: 2020 2020 2020 2020 616e 6420 6e6f 7420          and not 
-00008230: 6c61 7374 5f75 7064 6174 655f 7469 6d65  last_update_time
-00008240: 5f66 726f 6d0a 2020 2020 2020 2020 2020  _from.          
-00008250: 2020 616e 6420 6e6f 7420 6c61 7374 5f75    and not last_u
-00008260: 7064 6174 655f 7469 6d65 5f74 6f0a 2020  pdate_time_to.  
-00008270: 2020 2020 2020 2020 2020 616e 6420 6e6f            and no
-00008280: 7420 7061 7274 6974 696f 6e5f 6279 0a20  t partition_by. 
-00008290: 2020 2020 2020 2020 2020 2061 6e64 206e             and n
-000082a0: 6f74 2070 6172 7469 7469 6f6e 5f73 6f72  ot partition_sor
-000082b0: 745f 6279 0a20 2020 2020 2020 2020 2020  t_by.           
-000082c0: 2061 6e64 206e 6f74 2069 7465 720a 2020   and not iter.  
-000082d0: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
-000082e0: 2020 2020 2023 2064 6566 6175 6c74 2074       # default t
-000082f0: 6f20 6c61 7374 2077 6565 6b20 6f6e 206e  o last week on n
-00008300: 6f20 6669 6c74 6572 0a20 2020 2020 2020  o filter.       
-00008310: 2020 2020 2073 7461 7274 5f74 696d 655f       start_time_
-00008320: 6672 6f6d 203d 2064 6174 6574 696d 652e  from = datetime.
-00008330: 6e6f 7728 2920 2d20 7469 6d65 6465 6c74  now() - timedelt
-00008340: 6128 6461 7973 3d37 290a 2020 2020 2020  a(days=7).      
-00008350: 2020 2020 2020 7061 7274 6974 696f 6e5f        partition_
-00008360: 6279 203d 206d 6c72 756e 2e63 6f6d 6d6f  by = mlrun.commo
-00008370: 6e2e 7363 6865 6d61 732e 5275 6e50 6172  n.schemas.RunPar
-00008380: 7469 7469 6f6e 4279 4669 656c 642e 6e61  titionByField.na
-00008390: 6d65 0a20 2020 2020 2020 2020 2020 2070  me.            p
-000083a0: 6172 7469 7469 6f6e 5f73 6f72 745f 6279  artition_sort_by
-000083b0: 203d 206d 6c72 756e 2e63 6f6d 6d6f 6e2e   = mlrun.common.
-000083c0: 7363 6865 6d61 732e 536f 7274 4669 656c  schemas.SortFiel
-000083d0: 642e 7570 6461 7465 640a 0a20 2020 2020  d.updated..     
-000083e0: 2020 2070 6172 616d 7320 3d20 7b0a 2020     params = {.  
-000083f0: 2020 2020 2020 2020 2020 226e 616d 6522            "name"
-00008400: 3a20 6e61 6d65 2c0a 2020 2020 2020 2020  : name,.        
-00008410: 2020 2020 2275 6964 223a 2075 6964 2c0a      "uid": uid,.
-00008420: 2020 2020 2020 2020 2020 2020 226c 6162              "lab
-00008430: 656c 223a 206c 6162 656c 7320 6f72 205b  el": labels or [
-00008440: 5d2c 0a20 2020 2020 2020 2020 2020 2022  ],.            "
-00008450: 7374 6174 6522 3a20 7374 6174 652c 0a20  state": state,. 
-00008460: 2020 2020 2020 2020 2020 2022 736f 7274             "sort
-00008470: 223a 2062 6f6f 6c32 7374 7228 736f 7274  ": bool2str(sort
-00008480: 292c 0a20 2020 2020 2020 2020 2020 2022  ),.            "
-00008490: 6974 6572 223a 2062 6f6f 6c32 7374 7228  iter": bool2str(
-000084a0: 6974 6572 292c 0a20 2020 2020 2020 2020  iter),.         
-000084b0: 2020 2022 7374 6172 745f 7469 6d65 5f66     "start_time_f
-000084c0: 726f 6d22 3a20 6461 7465 7469 6d65 5f74  rom": datetime_t
-000084d0: 6f5f 6973 6f28 7374 6172 745f 7469 6d65  o_iso(start_time
-000084e0: 5f66 726f 6d29 2c0a 2020 2020 2020 2020  _from),.        
-000084f0: 2020 2020 2273 7461 7274 5f74 696d 655f      "start_time_
-00008500: 746f 223a 2064 6174 6574 696d 655f 746f  to": datetime_to
-00008510: 5f69 736f 2873 7461 7274 5f74 696d 655f  _iso(start_time_
-00008520: 746f 292c 0a20 2020 2020 2020 2020 2020  to),.           
-00008530: 2022 6c61 7374 5f75 7064 6174 655f 7469   "last_update_ti
-00008540: 6d65 5f66 726f 6d22 3a20 6461 7465 7469  me_from": dateti
-00008550: 6d65 5f74 6f5f 6973 6f28 6c61 7374 5f75  me_to_iso(last_u
-00008560: 7064 6174 655f 7469 6d65 5f66 726f 6d29  pdate_time_from)
-00008570: 2c0a 2020 2020 2020 2020 2020 2020 226c  ,.            "l
-00008580: 6173 745f 7570 6461 7465 5f74 696d 655f  ast_update_time_
-00008590: 746f 223a 2064 6174 6574 696d 655f 746f  to": datetime_to
-000085a0: 5f69 736f 286c 6173 745f 7570 6461 7465  _iso(last_update
-000085b0: 5f74 696d 655f 746f 292c 0a20 2020 2020  _time_to),.     
-000085c0: 2020 2020 2020 2022 7769 7468 2d6e 6f74         "with-not
-000085d0: 6966 6963 6174 696f 6e73 223a 2077 6974  ifications": wit
-000085e0: 685f 6e6f 7469 6669 6361 7469 6f6e 732c  h_notifications,
-000085f0: 0a20 2020 2020 2020 207d 0a0a 2020 2020  .        }..    
-00008600: 2020 2020 6966 2070 6172 7469 7469 6f6e      if partition
-00008610: 5f62 793a 0a20 2020 2020 2020 2020 2020  _by:.           
-00008620: 2070 6172 616d 732e 7570 6461 7465 280a   params.update(.
-00008630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008640: 7365 6c66 2e5f 6765 6e65 7261 7465 5f70  self._generate_p
-00008650: 6172 7469 7469 6f6e 5f62 795f 7061 7261  artition_by_para
-00008660: 6d73 280a 2020 2020 2020 2020 2020 2020  ms(.            
-00008670: 2020 2020 2020 2020 6d6c 7275 6e2e 636f          mlrun.co
-00008680: 6d6d 6f6e 2e73 6368 656d 6173 2e52 756e  mmon.schemas.Run
-00008690: 5061 7274 6974 696f 6e42 7946 6965 6c64  PartitionByField
-000086a0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000086b0: 2020 2020 2020 7061 7274 6974 696f 6e5f        partition_
-000086c0: 6279 2c0a 2020 2020 2020 2020 2020 2020  by,.            
-000086d0: 2020 2020 2020 2020 726f 7773 5f70 6572          rows_per
-000086e0: 5f70 6172 7469 7469 6f6e 2c0a 2020 2020  _partition,.    
-000086f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008700: 7061 7274 6974 696f 6e5f 736f 7274 5f62  partition_sort_b
-00008710: 792c 0a20 2020 2020 2020 2020 2020 2020  y,.             
-00008720: 2020 2020 2020 2070 6172 7469 7469 6f6e         partition
-00008730: 5f6f 7264 6572 2c0a 2020 2020 2020 2020  _order,.        
-00008740: 2020 2020 2020 2020 2020 2020 6d61 785f              max_
-00008750: 7061 7274 6974 696f 6e73 2c0a 2020 2020  partitions,.    
-00008760: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00008770: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00008780: 2020 2020 6572 726f 7220 3d20 226c 6973      error = "lis
-00008790: 7420 7275 6e73 220a 2020 2020 2020 2020  t runs".        
-000087a0: 5f70 6174 6820 3d20 7365 6c66 2e5f 7061  _path = self._pa
-000087b0: 7468 5f6f 6628 2272 756e 7322 2c20 7072  th_of("runs", pr
-000087c0: 6f6a 6563 7429 0a20 2020 2020 2020 2072  oject).        r
-000087d0: 6573 7020 3d20 7365 6c66 2e61 7069 5f63  esp = self.api_c
-000087e0: 616c 6c28 2247 4554 222c 205f 7061 7468  all("GET", _path
-000087f0: 2c20 6572 726f 722c 2070 6172 616d 733d  , error, params=
-00008800: 7061 7261 6d73 290a 2020 2020 2020 2020  params).        
-00008810: 7265 7475 726e 2052 756e 4c69 7374 2872  return RunList(r
-00008820: 6573 702e 6a73 6f6e 2829 5b22 7275 6e73  esp.json()["runs
-00008830: 225d 290a 0a20 2020 2064 6566 2064 656c  "])..    def del
-00008840: 5f72 756e 7328 7365 6c66 2c20 6e61 6d65  _runs(self, name
-00008850: 3d4e 6f6e 652c 2070 726f 6a65 6374 3d4e  =None, project=N
-00008860: 6f6e 652c 206c 6162 656c 733d 4e6f 6e65  one, labels=None
-00008870: 2c20 7374 6174 653d 4e6f 6e65 2c20 6461  , state=None, da
-00008880: 7973 5f61 676f 3d30 293a 0a20 2020 2020  ys_ago=0):.     
-00008890: 2020 2022 2222 4465 6c65 7465 2061 2067     """Delete a g
-000088a0: 726f 7570 206f 6620 7275 6e73 2069 6465  roup of runs ide
-000088b0: 6e74 6966 6965 6420 6279 2074 6865 2070  ntified by the p
-000088c0: 6172 616d 6574 6572 7320 6f66 2074 6865  arameters of the
-000088d0: 2066 756e 6374 696f 6e2e 0a0a 2020 2020   function...    
-000088e0: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
-000088f0: 2020 2020 2020 2020 2020 2064 622e 6465             db.de
-00008900: 6c5f 7275 6e73 2873 7461 7465 3d27 636f  l_runs(state='co
-00008910: 6d70 6c65 7465 6427 290a 0a20 2020 2020  mpleted')..     
-00008920: 2020 203a 7061 7261 6d20 6e61 6d65 3a20     :param name: 
-00008930: 4e61 6d65 206f 6620 7468 6520 7461 736b  Name of the task
-00008940: 2077 6869 6368 2074 6865 2072 756e 7320   which the runs 
-00008950: 6265 6c6f 6e67 2074 6f2e 0a20 2020 2020  belong to..     
-00008960: 2020 203a 7061 7261 6d20 7072 6f6a 6563     :param projec
-00008970: 743a 2050 726f 6a65 6374 2074 6f20 7768  t: Project to wh
-00008980: 6963 6820 7468 6520 7275 6e73 2062 656c  ich the runs bel
-00008990: 6f6e 672e 0a20 2020 2020 2020 203a 7061  ong..        :pa
-000089a0: 7261 6d20 6c61 6265 6c73 3a20 4669 6c74  ram labels: Filt
-000089b0: 6572 2072 756e 7320 7468 6174 2061 7265  er runs that are
-000089c0: 206c 6162 656c 6564 2075 7369 6e67 2074   labeled using t
-000089d0: 6865 7365 2073 7065 6369 6669 6320 6c61  hese specific la
-000089e0: 6265 6c20 7661 6c75 6573 2e0a 2020 2020  bel values..    
-000089f0: 2020 2020 3a70 6172 616d 2073 7461 7465      :param state
-00008a00: 3a20 4669 6c74 6572 206f 6e6c 7920 7275  : Filter only ru
-00008a10: 6e73 2077 6869 6368 2061 7265 2069 6e20  ns which are in 
-00008a20: 7468 6973 2073 7461 7465 2e0a 2020 2020  this state..    
-00008a30: 2020 2020 3a70 6172 616d 2064 6179 735f      :param days_
-00008a40: 6167 6f3a 2046 696c 7465 7220 7275 6e73  ago: Filter runs
-00008a50: 2077 686f 7365 2073 7461 7274 2074 696d   whose start tim
-00008a60: 6520 6973 206e 6577 6572 2074 6861 6e20  e is newer than 
-00008a70: 7468 6973 2070 6172 616d 6574 6572 2e0a  this parameter..
-00008a80: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
-00008a90: 2020 2020 2070 726f 6a65 6374 203d 2070       project = p
-00008aa0: 726f 6a65 6374 206f 7220 636f 6e66 6967  roject or config
-00008ab0: 2e64 6566 6175 6c74 5f70 726f 6a65 6374  .default_project
-00008ac0: 0a20 2020 2020 2020 2070 6172 616d 7320  .        params 
-00008ad0: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
-00008ae0: 226e 616d 6522 3a20 6e61 6d65 2c0a 2020  "name": name,.  
-00008af0: 2020 2020 2020 2020 2020 2270 726f 6a65            "proje
-00008b00: 6374 223a 2070 726f 6a65 6374 2c0a 2020  ct": project,.  
-00008b10: 2020 2020 2020 2020 2020 226c 6162 656c            "label
-00008b20: 223a 206c 6162 656c 7320 6f72 205b 5d2c  ": labels or [],
-00008b30: 0a20 2020 2020 2020 2020 2020 2022 7374  .            "st
-00008b40: 6174 6522 3a20 7374 6174 652c 0a20 2020  ate": state,.   
-00008b50: 2020 2020 2020 2020 2022 6461 7973 5f61           "days_a
-00008b60: 676f 223a 2073 7472 2864 6179 735f 6167  go": str(days_ag
-00008b70: 6f29 2c0a 2020 2020 2020 2020 7d0a 2020  o),.        }.  
-00008b80: 2020 2020 2020 6572 726f 7220 3d20 2264        error = "d
-00008b90: 656c 2072 756e 7322 0a20 2020 2020 2020  el runs".       
-00008ba0: 205f 7061 7468 203d 2073 656c 662e 5f70   _path = self._p
-00008bb0: 6174 685f 6f66 2822 7275 6e73 222c 2070  ath_of("runs", p
-00008bc0: 726f 6a65 6374 290a 2020 2020 2020 2020  roject).        
-00008bd0: 7365 6c66 2e61 7069 5f63 616c 6c28 2244  self.api_call("D
-00008be0: 454c 4554 4522 2c20 5f70 6174 682c 2065  ELETE", _path, e
-00008bf0: 7272 6f72 2c20 7061 7261 6d73 3d70 6172  rror, params=par
-00008c00: 616d 7329 0a0a 2020 2020 6465 6620 7374  ams)..    def st
-00008c10: 6f72 655f 6172 7469 6661 6374 280a 2020  ore_artifact(.  
-00008c20: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-00008c30: 2020 2020 6b65 792c 0a20 2020 2020 2020      key,.       
-00008c40: 2061 7274 6966 6163 742c 0a20 2020 2020   artifact,.     
-00008c50: 2020 2023 2054 4f44 4f3a 2064 6570 7265     # TODO: depre
-00008c60: 6361 7465 642c 2072 656d 6f76 6520 696e  cated, remove in
-00008c70: 2031 2e38 2e30 0a20 2020 2020 2020 2075   1.8.0.        u
-00008c80: 6964 3d4e 6f6e 652c 0a20 2020 2020 2020  id=None,.       
-00008c90: 2069 7465 723d 4e6f 6e65 2c0a 2020 2020   iter=None,.    
-00008ca0: 2020 2020 7461 673d 4e6f 6e65 2c0a 2020      tag=None,.  
-00008cb0: 2020 2020 2020 7072 6f6a 6563 743d 2222        project=""
-00008cc0: 2c0a 2020 2020 2020 2020 7472 6565 3d4e  ,.        tree=N
-00008cd0: 6f6e 652c 0a20 2020 2029 3a0a 2020 2020  one,.    ):.    
-00008ce0: 2020 2020 2222 2253 746f 7265 2061 6e20      """Store an 
-00008cf0: 6172 7469 6661 6374 2069 6e20 7468 6520  artifact in the 
-00008d00: 4442 2e0a 0a20 2020 2020 2020 203a 7061  DB...        :pa
-00008d10: 7261 6d20 6b65 793a 2049 6465 6e74 6966  ram key: Identif
-00008d20: 7969 6e67 206b 6579 206f 6620 7468 6520  ying key of the 
-00008d30: 6172 7469 6661 6374 2e0a 2020 2020 2020  artifact..      
-00008d40: 2020 3a70 6172 616d 2061 7274 6966 6163    :param artifac
-00008d50: 743a 2054 6865 203a 7079 3a63 6c61 7373  t: The :py:class
-00008d60: 3a60 7e6d 6c72 756e 2e61 7274 6966 6163  :`~mlrun.artifac
-00008d70: 7473 2e41 7274 6966 6163 7460 2074 6f20  ts.Artifact` to 
-00008d80: 7374 6f72 652e 0a20 2020 2020 2020 203a  store..        :
-00008d90: 7061 7261 6d20 7569 643a 2041 2075 6e69  param uid: A uni
-00008da0: 7175 6520 4944 2066 6f72 2074 6869 7320  que ID for this 
-00008db0: 7370 6563 6966 6963 2076 6572 7369 6f6e  specific version
-00008dc0: 206f 6620 7468 6520 6172 7469 6661 6374   of the artifact
-00008dd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008de0: 2020 2020 2028 6465 7072 6563 6174 6564       (deprecated
-00008df0: 2c20 6172 7469 6661 6374 2075 6964 2069  , artifact uid i
-00008e00: 7320 6765 6e65 7261 7465 6420 696e 2074  s generated in t
-00008e10: 6865 2062 6163 6b65 6e64 2075 7365 2060  he backend use `
-00008e20: 7472 6565 6020 696e 7374 6561 6429 0a20  tree` instead). 
-00008e30: 2020 2020 2020 203a 7061 7261 6d20 6974         :param it
-00008e40: 6572 3a20 5468 6520 7461 736b 2069 7465  er: The task ite
-00008e50: 7261 7469 6f6e 2077 6869 6368 2067 656e  ration which gen
-00008e60: 6572 6174 6564 2074 6869 7320 6172 7469  erated this arti
-00008e70: 6661 6374 2e20 4966 2060 6069 7465 7260  fact. If ``iter`
-00008e80: 6020 6973 206e 6f74 2060 604e 6f6e 6560  ` is not ``None`
-00008e90: 6020 7468 6520 6974 6572 6174 696f 6e20  ` the iteration 
-00008ea0: 7769 6c6c 0a20 2020 2020 2020 2020 2020  will.           
-00008eb0: 2062 6520 6164 6465 6420 746f 2074 6865   be added to the
-00008ec0: 206b 6579 2070 726f 7669 6465 6420 746f   key provided to
-00008ed0: 2067 656e 6572 6174 6520 6120 756e 6971   generate a uniq
-00008ee0: 7565 206b 6579 2066 6f72 2074 6865 2061  ue key for the a
-00008ef0: 7274 6966 6163 7420 6f66 2074 6865 2073  rtifact of the s
-00008f00: 7065 6369 6669 6320 6974 6572 6174 696f  pecific iteratio
-00008f10: 6e2e 0a20 2020 2020 2020 203a 7061 7261  n..        :para
-00008f20: 6d20 7461 673a 2054 6167 206f 6620 7468  m tag: Tag of th
-00008f30: 6520 6172 7469 6661 6374 2e0a 2020 2020  e artifact..    
-00008f40: 2020 2020 3a70 6172 616d 2070 726f 6a65      :param proje
-00008f50: 6374 3a20 5072 6f6a 6563 7420 7468 6174  ct: Project that
-00008f60: 2074 6865 2061 7274 6966 6163 7420 6265   the artifact be
-00008f70: 6c6f 6e67 7320 746f 2e0a 2020 2020 2020  longs to..      
-00008f80: 2020 3a70 6172 616d 2074 7265 653a 2054    :param tree: T
-00008f90: 6865 2074 7265 6520 2870 726f 6475 6365  he tree (produce
-00008fa0: 7220 6964 2920 7768 6963 6820 6765 6e65  r id) which gene
-00008fb0: 7261 7465 6420 7468 6973 2061 7274 6966  rated this artif
-00008fc0: 6163 742e 0a20 2020 2020 2020 2022 2222  act..        """
-00008fd0: 0a20 2020 2020 2020 2069 6620 7569 643a  .        if uid:
-00008fe0: 0a20 2020 2020 2020 2020 2020 2077 6172  .            war
-00008ff0: 6e69 6e67 732e 7761 726e 280a 2020 2020  nings.warn(.    
-00009000: 2020 2020 2020 2020 2020 2020 2227 7569              "'ui
-00009010: 6427 2069 7320 6465 7072 6563 6174 6564  d' is deprecated
-00009020: 2069 6e20 312e 362e 3020 616e 6420 7769   in 1.6.0 and wi
-00009030: 6c6c 2062 6520 7265 6d6f 7665 6420 696e  ll be removed in
-00009040: 2031 2e38 2e30 2c20 7573 6520 2774 7265   1.8.0, use 'tre
-00009050: 6527 2069 6e73 7465 6164 2e22 2c0a 2020  e' instead.",.  
-00009060: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-00009070: 544f 444f 3a20 5265 6d6f 7665 2074 6869  TODO: Remove thi
-00009080: 7320 696e 2031 2e38 2e30 0a20 2020 2020  s in 1.8.0.     
-00009090: 2020 2020 2020 2020 2020 2046 7574 7572             Futur
-000090a0: 6557 6172 6e69 6e67 2c0a 2020 2020 2020  eWarning,.      
-000090b0: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-000090c0: 2023 2077 6520 646f 2074 6869 7320 6265   # we do this be
-000090d0: 6361 7573 6520 7072 6576 696f 7573 6c79  cause previously
-000090e0: 2074 6865 2027 7569 6427 206e 616d 6520   the 'uid' name 
-000090f0: 7761 7320 7573 6564 2066 6f72 2074 6865  was used for the
-00009100: 2027 7472 6565 2720 7061 7261 6d65 7465   'tree' paramete
-00009110: 720a 2020 2020 2020 2020 7472 6565 203d  r.        tree =
-00009120: 2074 7265 6520 6f72 2075 6964 0a0a 2020   tree or uid..  
-00009130: 2020 2020 2020 656e 6470 6f69 6e74 5f70        endpoint_p
-00009140: 6174 6820 3d20 6622 7072 6f6a 6563 7473  ath = f"projects
-00009150: 2f7b 7072 6f6a 6563 747d 2f61 7274 6966  /{project}/artif
-00009160: 6163 7473 2f7b 6b65 797d 220a 0a20 2020  acts/{key}"..   
-00009170: 2020 2020 2065 7272 6f72 203d 2066 2273       error = f"s
-00009180: 746f 7265 2061 7274 6966 6163 7420 7b70  tore artifact {p
-00009190: 726f 6a65 6374 7d2f 7b6b 6579 7d22 0a0a  roject}/{key}"..
-000091a0: 2020 2020 2020 2020 7061 7261 6d73 203d          params =
-000091b0: 207b 7d0a 2020 2020 2020 2020 6966 2069   {}.        if i
-000091c0: 7465 723a 0a20 2020 2020 2020 2020 2020  ter:.           
-000091d0: 2070 6172 616d 735b 2269 7465 7222 5d20   params["iter"] 
-000091e0: 3d20 7374 7228 6974 6572 290a 2020 2020  = str(iter).    
-000091f0: 2020 2020 6966 2074 6167 3a0a 2020 2020      if tag:.    
-00009200: 2020 2020 2020 2020 7061 7261 6d73 5b22          params["
-00009210: 7461 6722 5d20 3d20 7461 670a 2020 2020  tag"] = tag.    
-00009220: 2020 2020 6966 2074 7265 653a 0a20 2020      if tree:.   
-00009230: 2020 2020 2020 2020 2070 6172 616d 735b           params[
-00009240: 2274 7265 6522 5d20 3d20 7472 6565 0a0a  "tree"] = tree..
-00009250: 2020 2020 2020 2020 626f 6479 203d 205f          body = _
-00009260: 6173 5f6a 736f 6e28 6172 7469 6661 6374  as_json(artifact
-00009270: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
-00009280: 7069 5f63 616c 6c28 0a20 2020 2020 2020  pi_call(.       
-00009290: 2020 2020 2022 5055 5422 2c20 656e 6470       "PUT", endp
-000092a0: 6f69 6e74 5f70 6174 682c 2065 7272 6f72  oint_path, error
-000092b0: 2c20 626f 6479 3d62 6f64 792c 2070 6172  , body=body, par
-000092c0: 616d 733d 7061 7261 6d73 2c20 7665 7273  ams=params, vers
-000092d0: 696f 6e3d 2276 3222 0a20 2020 2020 2020  ion="v2".       
-000092e0: 2029 0a0a 2020 2020 6465 6620 7265 6164   )..    def read
-000092f0: 5f61 7274 6966 6163 7428 0a20 2020 2020  _artifact(.     
-00009300: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-00009310: 206b 6579 2c0a 2020 2020 2020 2020 7461   key,.        ta
-00009320: 673d 4e6f 6e65 2c0a 2020 2020 2020 2020  g=None,.        
-00009330: 6974 6572 3d4e 6f6e 652c 0a20 2020 2020  iter=None,.     
-00009340: 2020 2070 726f 6a65 6374 3d22 222c 0a20     project="",. 
-00009350: 2020 2020 2020 2074 7265 653d 4e6f 6e65         tree=None
-00009360: 2c0a 2020 2020 2020 2020 7569 643d 4e6f  ,.        uid=No
-00009370: 6e65 2c0a 2020 2020 293a 0a20 2020 2020  ne,.    ):.     
-00009380: 2020 2022 2222 5265 6164 2061 6e20 6172     """Read an ar
-00009390: 7469 6661 6374 2c20 6964 656e 7469 6669  tifact, identifi
-000093a0: 6564 2062 7920 6974 7320 6b65 792c 2074  ed by its key, t
-000093b0: 6167 2c20 7472 6565 2061 6e64 2069 7465  ag, tree and ite
-000093c0: 7261 7469 6f6e 2e0a 0a20 2020 2020 2020  ration...       
-000093d0: 203a 7061 7261 6d20 6b65 793a 2049 6465   :param key: Ide
-000093e0: 6e74 6966 7969 6e67 206b 6579 206f 6620  ntifying key of 
-000093f0: 7468 6520 6172 7469 6661 6374 2e0a 2020  the artifact..  
-00009400: 2020 2020 2020 3a70 6172 616d 2074 6167        :param tag
-00009410: 3a20 5461 6720 6f66 2074 6865 2061 7274  : Tag of the art
-00009420: 6966 6163 742e 0a20 2020 2020 2020 203a  ifact..        :
-00009430: 7061 7261 6d20 6974 6572 3a20 5468 6520  param iter: The 
-00009440: 6974 6572 6174 696f 6e20 7768 6963 6820  iteration which 
-00009450: 6765 6e65 7261 7465 6420 7468 6973 2061  generated this a
-00009460: 7274 6966 6163 7420 2877 6865 7265 2060  rtifact (where `
-00009470: 6069 7465 723d 3060 6020 6d65 616e 7320  `iter=0`` means 
-00009480: 7468 6520 726f 6f74 2069 7465 7261 7469  the root iterati
-00009490: 6f6e 292e 0a20 2020 2020 2020 203a 7061  on)..        :pa
-000094a0: 7261 6d20 7072 6f6a 6563 743a 2050 726f  ram project: Pro
-000094b0: 6a65 6374 2074 6861 7420 7468 6520 6172  ject that the ar
-000094c0: 7469 6661 6374 2062 656c 6f6e 6773 2074  tifact belongs t
-000094d0: 6f2e 0a20 2020 2020 2020 203a 7061 7261  o..        :para
-000094e0: 6d20 7472 6565 3a20 5468 6520 7472 6565  m tree: The tree
-000094f0: 2077 6869 6368 2067 656e 6572 6174 6564   which generated
-00009500: 2074 6869 7320 6172 7469 6661 6374 2e0a   this artifact..
-00009510: 2020 2020 2020 2020 3a70 6172 616d 2075          :param u
-00009520: 6964 3a20 4120 756e 6971 7565 2049 4420  id: A unique ID 
-00009530: 666f 7220 7468 6973 2073 7065 6369 6669  for this specifi
-00009540: 6320 7665 7273 696f 6e20 6f66 2074 6865  c version of the
-00009550: 2061 7274 6966 6163 7420 2874 6865 2075   artifact (the u
-00009560: 6964 2074 6861 7420 7761 7320 6765 6e65  id that was gene
-00009570: 7261 7465 6420 696e 2074 6865 2062 6163  rated in the bac
-00009580: 6b65 6e64 290a 2020 2020 2020 2020 2222  kend).        ""
-00009590: 220a 0a20 2020 2020 2020 2070 726f 6a65  "..        proje
-000095a0: 6374 203d 2070 726f 6a65 6374 206f 7220  ct = project or 
-000095b0: 636f 6e66 6967 2e64 6566 6175 6c74 5f70  config.default_p
-000095c0: 726f 6a65 6374 0a20 2020 2020 2020 2074  roject.        t
-000095d0: 6167 203d 2074 6167 206f 7220 226c 6174  ag = tag or "lat
-000095e0: 6573 7422 0a20 2020 2020 2020 2065 6e64  est".        end
-000095f0: 706f 696e 745f 7061 7468 203d 2066 2270  point_path = f"p
-00009600: 726f 6a65 6374 732f 7b70 726f 6a65 6374  rojects/{project
-00009610: 7d2f 6172 7469 6661 6374 732f 7b6b 6579  }/artifacts/{key
-00009620: 7d22 0a20 2020 2020 2020 2065 7272 6f72  }".        error
-00009630: 203d 2066 2272 6561 6420 6172 7469 6661   = f"read artifa
-00009640: 6374 207b 7072 6f6a 6563 747d 2f7b 6b65  ct {project}/{ke
-00009650: 797d 220a 2020 2020 2020 2020 2320 6578  y}".        # ex
-00009660: 706c 6963 6974 6c79 2073 6574 2061 7274  plicitly set art
-00009670: 6966 6163 7473 2066 6f72 6d61 7420 746f  ifacts format to
-00009680: 2027 6675 6c6c 2720 7369 6e63 6520 6f6c   'full' since ol
-00009690: 6420 7365 7276 6572 7320 6d61 7920 6465  d servers may de
-000096a0: 6661 756c 7420 746f 2027 6c65 6761 6379  fault to 'legacy
-000096b0: 270a 2020 2020 2020 2020 7061 7261 6d73  '.        params
-000096c0: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
-000096d0: 2022 666f 726d 6174 223a 206d 6c72 756e   "format": mlrun
-000096e0: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
-000096f0: 4172 7469 6661 6374 7346 6f72 6d61 742e  ArtifactsFormat.
-00009700: 6675 6c6c 2e76 616c 7565 2c0a 2020 2020  full.value,.    
-00009710: 2020 2020 2020 2020 2274 6167 223a 2074          "tag": t
-00009720: 6167 2c0a 2020 2020 2020 2020 2020 2020  ag,.            
-00009730: 2274 7265 6522 3a20 7472 6565 2c0a 2020  "tree": tree,.  
-00009740: 2020 2020 2020 2020 2020 2275 6964 223a            "uid":
-00009750: 2075 6964 2c0a 2020 2020 2020 2020 7d0a   uid,.        }.
-00009760: 2020 2020 2020 2020 6966 2069 7465 723a          if iter:
-00009770: 0a20 2020 2020 2020 2020 2020 2070 6172  .            par
-00009780: 616d 735b 2269 7465 7222 5d20 3d20 7374  ams["iter"] = st
-00009790: 7228 6974 6572 290a 2020 2020 2020 2020  r(iter).        
-000097a0: 7265 7370 203d 2073 656c 662e 6170 695f  resp = self.api_
-000097b0: 6361 6c6c 2822 4745 5422 2c20 656e 6470  call("GET", endp
-000097c0: 6f69 6e74 5f70 6174 682c 2065 7272 6f72  oint_path, error
-000097d0: 2c20 7061 7261 6d73 3d70 6172 616d 732c  , params=params,
-000097e0: 2076 6572 7369 6f6e 3d22 7632 2229 0a20   version="v2"). 
-000097f0: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
-00009800: 7370 2e6a 736f 6e28 290a 0a20 2020 2064  sp.json()..    d
-00009810: 6566 2064 656c 5f61 7274 6966 6163 7428  ef del_artifact(
-00009820: 7365 6c66 2c20 6b65 792c 2074 6167 3d4e  self, key, tag=N
-00009830: 6f6e 652c 2070 726f 6a65 6374 3d22 222c  one, project="",
-00009840: 2074 7265 653d 4e6f 6e65 2c20 7569 643d   tree=None, uid=
-00009850: 4e6f 6e65 293a 0a20 2020 2020 2020 2022  None):.        "
-00009860: 2222 4465 6c65 7465 2061 6e20 6172 7469  ""Delete an arti
-00009870: 6661 6374 2e0a 0a20 2020 2020 2020 203a  fact...        :
-00009880: 7061 7261 6d20 6b65 793a 2049 6465 6e74  param key: Ident
-00009890: 6966 7969 6e67 206b 6579 206f 6620 7468  ifying key of th
-000098a0: 6520 6172 7469 6661 6374 2e0a 2020 2020  e artifact..    
-000098b0: 2020 2020 3a70 6172 616d 2074 6167 3a20      :param tag: 
-000098c0: 5461 6720 6f66 2074 6865 2061 7274 6966  Tag of the artif
-000098d0: 6163 742e 0a20 2020 2020 2020 203a 7061  act..        :pa
-000098e0: 7261 6d20 7072 6f6a 6563 743a 2050 726f  ram project: Pro
-000098f0: 6a65 6374 2074 6861 7420 7468 6520 6172  ject that the ar
-00009900: 7469 6661 6374 2062 656c 6f6e 6773 2074  tifact belongs t
-00009910: 6f2e 0a20 2020 2020 2020 203a 7061 7261  o..        :para
-00009920: 6d20 7472 6565 3a20 5468 6520 7472 6565  m tree: The tree
-00009930: 2077 6869 6368 2067 656e 6572 6174 6564   which generated
-00009940: 2074 6869 7320 6172 7469 6661 6374 2e0a   this artifact..
-00009950: 2020 2020 2020 2020 3a70 6172 616d 2075          :param u
-00009960: 6964 3a20 4120 756e 6971 7565 2049 4420  id: A unique ID 
-00009970: 666f 7220 7468 6973 2073 7065 6369 6669  for this specifi
-00009980: 6320 7665 7273 696f 6e20 6f66 2074 6865  c version of the
-00009990: 2061 7274 6966 6163 7420 2874 6865 2075   artifact (the u
-000099a0: 6964 2074 6861 7420 7761 7320 6765 6e65  id that was gene
-000099b0: 7261 7465 6420 696e 2074 6865 2062 6163  rated in the bac
-000099c0: 6b65 6e64 290a 2020 2020 2020 2020 2222  kend).        ""
-000099d0: 220a 0a20 2020 2020 2020 2065 6e64 706f  "..        endpo
-000099e0: 696e 745f 7061 7468 203d 2066 2270 726f  int_path = f"pro
-000099f0: 6a65 6374 732f 7b70 726f 6a65 6374 7d2f  jects/{project}/
-00009a00: 6172 7469 6661 6374 732f 7b6b 6579 7d22  artifacts/{key}"
-00009a10: 0a20 2020 2020 2020 2070 6172 616d 7320  .        params 
-00009a20: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
-00009a30: 226b 6579 223a 206b 6579 2c0a 2020 2020  "key": key,.    
-00009a40: 2020 2020 2020 2020 2274 6167 223a 2074          "tag": t
-00009a50: 6167 2c0a 2020 2020 2020 2020 2020 2020  ag,.            
-00009a60: 2274 7265 6522 3a20 7472 6565 2c0a 2020  "tree": tree,.  
-00009a70: 2020 2020 2020 2020 2020 2275 6964 223a            "uid":
-00009a80: 2075 6964 2c0a 2020 2020 2020 2020 7d0a   uid,.        }.
-00009a90: 2020 2020 2020 2020 6572 726f 7220 3d20          error = 
-00009aa0: 6622 6465 6c20 6172 7469 6661 6374 207b  f"del artifact {
-00009ab0: 7072 6f6a 6563 747d 2f7b 6b65 797d 220a  project}/{key}".
-00009ac0: 2020 2020 2020 2020 7365 6c66 2e61 7069          self.api
-00009ad0: 5f63 616c 6c28 2244 454c 4554 4522 2c20  _call("DELETE", 
-00009ae0: 656e 6470 6f69 6e74 5f70 6174 682c 2065  endpoint_path, e
-00009af0: 7272 6f72 2c20 7061 7261 6d73 3d70 6172  rror, params=par
-00009b00: 616d 732c 2076 6572 7369 6f6e 3d22 7632  ams, version="v2
-00009b10: 2229 0a0a 2020 2020 6465 6620 6c69 7374  ")..    def list
-00009b20: 5f61 7274 6966 6163 7473 280a 2020 2020  _artifacts(.    
-00009b30: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-00009b40: 2020 6e61 6d65 3d4e 6f6e 652c 0a20 2020    name=None,.   
-00009b50: 2020 2020 2070 726f 6a65 6374 3d4e 6f6e       project=Non
-00009b60: 652c 0a20 2020 2020 2020 2074 6167 3d4e  e,.        tag=N
-00009b70: 6f6e 652c 0a20 2020 2020 2020 206c 6162  one,.        lab
-00009b80: 656c 733a 204f 7074 696f 6e61 6c5b 556e  els: Optional[Un
-00009b90: 696f 6e5b 6469 6374 5b73 7472 2c20 7374  ion[dict[str, st
-00009ba0: 725d 2c20 6c69 7374 5b73 7472 5d5d 5d20  r], list[str]]] 
-00009bb0: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-00009bc0: 7369 6e63 653d 4e6f 6e65 2c0a 2020 2020  since=None,.    
-00009bd0: 2020 2020 756e 7469 6c3d 4e6f 6e65 2c0a      until=None,.
-00009be0: 2020 2020 2020 2020 6974 6572 3a20 696e          iter: in
-00009bf0: 7420 3d20 4e6f 6e65 2c0a 2020 2020 2020  t = None,.      
-00009c00: 2020 6265 7374 5f69 7465 7261 7469 6f6e    best_iteration
-00009c10: 3a20 626f 6f6c 203d 2046 616c 7365 2c0a  : bool = False,.
-00009c20: 2020 2020 2020 2020 6b69 6e64 3a20 7374          kind: st
-00009c30: 7220 3d20 4e6f 6e65 2c0a 2020 2020 2020  r = None,.      
-00009c40: 2020 6361 7465 676f 7279 3a20 556e 696f    category: Unio
-00009c50: 6e5b 7374 722c 206d 6c72 756e 2e63 6f6d  n[str, mlrun.com
-00009c60: 6d6f 6e2e 7363 6865 6d61 732e 4172 7469  mon.schemas.Arti
-00009c70: 6661 6374 4361 7465 676f 7269 6573 5d20  factCategories] 
-00009c80: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-00009c90: 7472 6565 3a20 7374 7220 3d20 4e6f 6e65  tree: str = None
-00009ca0: 2c0a 2020 2020 2920 2d3e 2041 7274 6966  ,.    ) -> Artif
-00009cb0: 6163 744c 6973 743a 0a20 2020 2020 2020  actList:.       
-00009cc0: 2022 2222 4c69 7374 2061 7274 6966 6163   """List artifac
-00009cd0: 7473 2066 696c 7465 7265 6420 6279 2076  ts filtered by v
-00009ce0: 6172 696f 7573 2070 6172 616d 6574 6572  arious parameter
-00009cf0: 732e 0a0a 2020 2020 2020 2020 4578 616d  s...        Exam
-00009d00: 706c 6573 3a3a 0a0a 2020 2020 2020 2020  ples::..        
-00009d10: 2020 2020 2320 5368 6f77 206c 6174 6573      # Show lates
-00009d20: 7420 7665 7273 696f 6e20 6f66 2061 6c6c  t version of all
-00009d30: 2061 7274 6966 6163 7473 2069 6e20 7072   artifacts in pr
-00009d40: 6f6a 6563 740a 2020 2020 2020 2020 2020  oject.          
-00009d50: 2020 6c61 7465 7374 5f61 7274 6966 6163    latest_artifac
-00009d60: 7473 203d 2064 622e 6c69 7374 5f61 7274  ts = db.list_art
-00009d70: 6966 6163 7473 2827 272c 2074 6167 3d27  ifacts('', tag='
-00009d80: 6c61 7465 7374 272c 2070 726f 6a65 6374  latest', project
-00009d90: 3d27 6972 6973 2729 0a20 2020 2020 2020  ='iris').       
-00009da0: 2020 2020 2023 2063 6865 636b 2064 6966       # check dif
-00009db0: 6665 7265 6e74 2061 7274 6966 6163 7420  ferent artifact 
-00009dc0: 7665 7273 696f 6e73 2066 6f72 2061 2073  versions for a s
-00009dd0: 7065 6369 6669 6320 6172 7469 6661 6374  pecific artifact
-00009de0: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
-00009df0: 756c 745f 7665 7273 696f 6e73 203d 2064  ult_versions = d
-00009e00: 622e 6c69 7374 5f61 7274 6966 6163 7473  b.list_artifacts
-00009e10: 2827 7265 7375 6c74 7327 2c20 7461 673d  ('results', tag=
-00009e20: 272a 272c 2070 726f 6a65 6374 3d27 6972  '*', project='ir
-00009e30: 6973 2729 0a20 2020 2020 2020 2020 2020  is').           
-00009e40: 2023 2053 686f 7720 6172 7469 6661 6374   # Show artifact
-00009e50: 7320 7769 7468 206c 6162 656c 2066 696c  s with label fil
-00009e60: 7465 7273 202d 2062 6f74 6820 7570 6c6f  ters - both uplo
-00009e70: 6164 6564 2061 6e64 206f 6620 6269 6e61  aded and of bina
-00009e80: 7279 2074 7970 650a 2020 2020 2020 2020  ry type.        
-00009e90: 2020 2020 7265 7375 6c74 5f6c 6162 656c      result_label
-00009ea0: 7320 3d20 6462 2e6c 6973 745f 6172 7469  s = db.list_arti
-00009eb0: 6661 6374 7328 2772 6573 756c 7473 272c  facts('results',
-00009ec0: 2074 6167 3d27 2a27 2c20 7072 6f6a 6563   tag='*', projec
-00009ed0: 743d 2769 7269 7327 2c20 6c61 6265 6c73  t='iris', labels
-00009ee0: 3d5b 2775 706c 6f61 6465 6427 2c20 2774  =['uploaded', 't
-00009ef0: 7970 653d 6269 6e61 7279 275d 290a 0a20  ype=binary']).. 
-00009f00: 2020 2020 2020 203a 7061 7261 6d20 6e61         :param na
-00009f10: 6d65 3a20 4e61 6d65 206f 6620 6172 7469  me: Name of arti
-00009f20: 6661 6374 7320 746f 2072 6574 7269 6576  facts to retriev
-00009f30: 652e 204e 616d 6520 7769 7468 2027 7e27  e. Name with '~'
-00009f40: 2070 7265 6669 7820 6973 2075 7365 6420   prefix is used 
-00009f50: 6173 2061 206c 696b 6520 7175 6572 792c  as a like query,
-00009f60: 2061 6e64 2069 7320 6e6f 740a 2020 2020   and is not.    
-00009f70: 2020 2020 2020 2020 6361 7365 2d73 656e          case-sen
-00009f80: 7369 7469 7665 2e20 5468 6973 206d 6561  sitive. This mea
-00009f90: 6e73 2074 6861 7420 7175 6572 7969 6e67  ns that querying
-00009fa0: 2066 6f72 2060 607e 6e61 6d65 6060 206d   for ``~name`` m
-00009fb0: 6179 2072 6574 7572 6e20 6172 7469 6661  ay return artifa
-00009fc0: 6374 7320 6e61 6d65 640a 2020 2020 2020  cts named.      
-00009fd0: 2020 2020 2020 6060 6d79 5f4e 616d 655f        ``my_Name_
-00009fe0: 3160 6020 6f72 2060 6073 7572 6e61 6d65  1`` or ``surname
-00009ff0: 6060 2e0a 2020 2020 2020 2020 3a70 6172  ``..        :par
-0000a000: 616d 2070 726f 6a65 6374 3a20 5072 6f6a  am project: Proj
-0000a010: 6563 7420 6e61 6d65 2e0a 2020 2020 2020  ect name..      
-0000a020: 2020 3a70 6172 616d 2074 6167 3a20 5265    :param tag: Re
-0000a030: 7475 726e 2061 7274 6966 6163 7473 2061  turn artifacts a
-0000a040: 7373 6967 6e65 6420 7468 6973 2074 6167  ssigned this tag
-0000a050: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-0000a060: 206c 6162 656c 733a 2052 6574 7572 6e20   labels: Return 
-0000a070: 6172 7469 6661 6374 7320 7468 6174 2068  artifacts that h
-0000a080: 6176 6520 7468 6573 6520 6c61 6265 6c73  ave these labels
-0000a090: 2e20 4c61 6265 6c73 2063 616e 2065 6974  . Labels can eit
-0000a0a0: 6865 7220 6265 2061 2064 6963 7469 6f6e  her be a diction
-0000a0b0: 6172 7920 7b22 6c61 6265 6c22 3a20 2276  ary {"label": "v
-0000a0c0: 616c 7565 227d 206f 720a 2020 2020 2020  alue"} or.      
-0000a0d0: 2020 2020 2020 6120 6c69 7374 206f 6620        a list of 
-0000a0e0: 226c 6162 656c 3d76 616c 7565 2220 286d  "label=value" (m
-0000a0f0: 6174 6368 206c 6162 656c 206b 6579 2061  atch label key a
-0000a100: 6e64 2076 616c 7565 2920 6f72 2022 6c61  nd value) or "la
-0000a110: 6265 6c22 2028 6d61 7463 6820 6a75 7374  bel" (match just
-0000a120: 206c 6162 656c 206b 6579 2920 7374 7269   label key) stri
-0000a130: 6e67 732e 0a20 2020 2020 2020 203a 7061  ngs..        :pa
-0000a140: 7261 6d20 7369 6e63 653a 204e 6f74 2069  ram since: Not i
-0000a150: 6e20 7573 6520 696e 203a 7079 3a63 6c61  n use in :py:cla
-0000a160: 7373 3a60 4854 5450 5275 6e44 4260 2e0a  ss:`HTTPRunDB`..
-0000a170: 2020 2020 2020 2020 3a70 6172 616d 2075          :param u
-0000a180: 6e74 696c 3a20 4e6f 7420 696e 2075 7365  ntil: Not in use
-0000a190: 2069 6e20 3a70 793a 636c 6173 733a 6048   in :py:class:`H
-0000a1a0: 5454 5052 756e 4442 602e 0a20 2020 2020  TTPRunDB`..     
-0000a1b0: 2020 203a 7061 7261 6d20 6974 6572 3a20     :param iter: 
-0000a1c0: 5265 7475 726e 2061 7274 6966 6163 7473  Return artifacts
-0000a1d0: 2066 726f 6d20 6120 7370 6563 6966 6963   from a specific
-0000a1e0: 2069 7465 7261 7469 6f6e 2028 7768 6572   iteration (wher
-0000a1f0: 6520 6060 6974 6572 3d30 6060 206d 6561  e ``iter=0`` mea
-0000a200: 6e73 2074 6865 2072 6f6f 7420 6974 6572  ns the root iter
-0000a210: 6174 696f 6e29 2e20 4966 0a20 2020 2020  ation). If.     
-0000a220: 2020 2020 2020 2060 604e 6f6e 6560 6020         ``None`` 
-0000a230: 2864 6566 6175 6c74 2920 7265 7475 726e  (default) return
-0000a240: 2061 7274 6966 6163 7473 2066 726f 6d20   artifacts from 
-0000a250: 616c 6c20 6974 6572 6174 696f 6e73 2e0a  all iterations..
-0000a260: 2020 2020 2020 2020 3a70 6172 616d 2062          :param b
-0000a270: 6573 745f 6974 6572 6174 696f 6e3a 2052  est_iteration: R
-0000a280: 6574 7572 6e73 2074 6865 2061 7274 6966  eturns the artif
-0000a290: 6163 7420 7768 6963 6820 6265 6c6f 6e67  act which belong
-0000a2a0: 7320 746f 2074 6865 2062 6573 7420 6974  s to the best it
-0000a2b0: 6572 6174 696f 6e20 6f66 2061 2067 6976  eration of a giv
-0000a2c0: 656e 2072 756e 2c20 696e 2074 6865 2063  en run, in the c
-0000a2d0: 6173 6520 6f66 0a20 2020 2020 2020 2020  ase of.         
-0000a2e0: 2020 2061 7274 6966 6163 7473 2067 656e     artifacts gen
-0000a2f0: 6572 6174 6564 2066 726f 6d20 6120 6879  erated from a hy
-0000a300: 7065 722d 7061 7261 6d20 7275 6e2e 2049  per-param run. I
-0000a310: 6620 6f6e 6c79 2061 2073 696e 676c 6520  f only a single 
-0000a320: 6974 6572 6174 696f 6e20 6578 6973 7473  iteration exists
-0000a330: 2c20 7769 6c6c 2072 6574 7572 6e20 7468  , will return th
-0000a340: 6520 6172 7469 6661 6374 0a20 2020 2020  e artifact.     
-0000a350: 2020 2020 2020 2066 726f 6d20 7468 6174         from that
-0000a360: 2069 7465 7261 7469 6f6e 2e20 4966 2075   iteration. If u
-0000a370: 7369 6e67 2060 6062 6573 745f 6974 6572  sing ``best_iter
-0000a380: 6060 2c20 7468 6520 6060 6974 6572 6060  ``, the ``iter``
-0000a390: 2070 6172 616d 6574 6572 206d 7573 7420   parameter must 
-0000a3a0: 6e6f 7420 6265 2075 7365 642e 0a20 2020  not be used..   
-0000a3b0: 2020 2020 203a 7061 7261 6d20 6b69 6e64       :param kind
-0000a3c0: 3a20 5265 7475 726e 2061 7274 6966 6163  : Return artifac
-0000a3d0: 7473 206f 6620 7468 6520 7265 7175 6573  ts of the reques
-0000a3e0: 7465 6420 6b69 6e64 2e0a 2020 2020 2020  ted kind..      
-0000a3f0: 2020 3a70 6172 616d 2063 6174 6567 6f72    :param categor
-0000a400: 793a 2052 6574 7572 6e20 6172 7469 6661  y: Return artifa
-0000a410: 6374 7320 6f66 2074 6865 2072 6571 7565  cts of the reque
-0000a420: 7374 6564 2063 6174 6567 6f72 792e 0a20  sted category.. 
-0000a430: 2020 2020 2020 203a 7061 7261 6d20 7472         :param tr
-0000a440: 6565 3a20 5265 7475 726e 2061 7274 6966  ee: Return artif
-0000a450: 6163 7473 206f 6620 7468 6520 7265 7175  acts of the requ
-0000a460: 6573 7465 6420 7472 6565 2e0a 2020 2020  ested tree..    
-0000a470: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
-0000a480: 2070 726f 6a65 6374 203d 2070 726f 6a65   project = proje
-0000a490: 6374 206f 7220 636f 6e66 6967 2e64 6566  ct or config.def
-0000a4a0: 6175 6c74 5f70 726f 6a65 6374 0a0a 2020  ault_project..  
-0000a4b0: 2020 2020 2020 6c61 6265 6c73 203d 206c        labels = l
-0000a4c0: 6162 656c 7320 6f72 205b 5d0a 2020 2020  abels or [].    
-0000a4d0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-0000a4e0: 6528 6c61 6265 6c73 2c20 6469 6374 293a  e(labels, dict):
-0000a4f0: 0a20 2020 2020 2020 2020 2020 206c 6162  .            lab
-0000a500: 656c 7320 3d20 5b66 227b 6b65 797d 3d7b  els = [f"{key}={
-0000a510: 7661 6c75 657d 2220 666f 7220 6b65 792c  value}" for key,
-0000a520: 2076 616c 7565 2069 6e20 6c61 6265 6c73   value in labels
-0000a530: 2e69 7465 6d73 2829 5d0a 0a20 2020 2020  .items()]..     
-0000a540: 2020 2070 6172 616d 7320 3d20 7b0a 2020     params = {.  
-0000a550: 2020 2020 2020 2020 2020 226e 616d 6522            "name"
-0000a560: 3a20 6e61 6d65 2c0a 2020 2020 2020 2020  : name,.        
-0000a570: 2020 2020 2274 6167 223a 2074 6167 2c0a      "tag": tag,.
-0000a580: 2020 2020 2020 2020 2020 2020 226c 6162              "lab
-0000a590: 656c 223a 206c 6162 656c 732c 0a20 2020  el": labels,.   
-0000a5a0: 2020 2020 2020 2020 2022 6974 6572 223a           "iter":
-0000a5b0: 2069 7465 722c 0a20 2020 2020 2020 2020   iter,.         
-0000a5c0: 2020 2022 6265 7374 2d69 7465 7261 7469     "best-iterati
-0000a5d0: 6f6e 223a 2062 6573 745f 6974 6572 6174  on": best_iterat
-0000a5e0: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
-0000a5f0: 2022 6b69 6e64 223a 206b 696e 642c 0a20   "kind": kind,. 
-0000a600: 2020 2020 2020 2020 2020 2022 6361 7465             "cate
-0000a610: 676f 7279 223a 2063 6174 6567 6f72 792c  gory": category,
-0000a620: 0a20 2020 2020 2020 2020 2020 2022 7472  .            "tr
-0000a630: 6565 223a 2074 7265 652c 0a20 2020 2020  ee": tree,.     
-0000a640: 2020 2020 2020 2022 666f 726d 6174 223a         "format":
-0000a650: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
-0000a660: 6865 6d61 732e 4172 7469 6661 6374 7346  hemas.ArtifactsF
-0000a670: 6f72 6d61 742e 6675 6c6c 2e76 616c 7565  ormat.full.value
-0000a680: 2c0a 2020 2020 2020 2020 7d0a 2020 2020  ,.        }.    
-0000a690: 2020 2020 6572 726f 7220 3d20 226c 6973      error = "lis
-0000a6a0: 7420 6172 7469 6661 6374 7322 0a20 2020  t artifacts".   
-0000a6b0: 2020 2020 2065 6e64 706f 696e 745f 7061       endpoint_pa
-0000a6c0: 7468 203d 2066 2270 726f 6a65 6374 732f  th = f"projects/
-0000a6d0: 7b70 726f 6a65 6374 7d2f 6172 7469 6661  {project}/artifa
-0000a6e0: 6374 7322 0a20 2020 2020 2020 2072 6573  cts".        res
-0000a6f0: 7020 3d20 7365 6c66 2e61 7069 5f63 616c  p = self.api_cal
-0000a700: 6c28 2247 4554 222c 2065 6e64 706f 696e  l("GET", endpoin
-0000a710: 745f 7061 7468 2c20 6572 726f 722c 2070  t_path, error, p
-0000a720: 6172 616d 733d 7061 7261 6d73 2c20 7665  arams=params, ve
-0000a730: 7273 696f 6e3d 2276 3222 290a 2020 2020  rsion="v2").    
-0000a740: 2020 2020 7661 6c75 6573 203d 2041 7274      values = Art
-0000a750: 6966 6163 744c 6973 7428 7265 7370 2e6a  ifactList(resp.j
-0000a760: 736f 6e28 295b 2261 7274 6966 6163 7473  son()["artifacts
-0000a770: 225d 290a 2020 2020 2020 2020 7661 6c75  "]).        valu
-0000a780: 6573 2e74 6167 203d 2074 6167 0a20 2020  es.tag = tag.   
-0000a790: 2020 2020 2072 6574 7572 6e20 7661 6c75       return valu
-0000a7a0: 6573 0a0a 2020 2020 6465 6620 6465 6c5f  es..    def del_
-0000a7b0: 6172 7469 6661 6374 7328 0a20 2020 2020  artifacts(.     
-0000a7c0: 2020 2073 656c 662c 206e 616d 653d 4e6f     self, name=No
-0000a7d0: 6e65 2c20 7072 6f6a 6563 743d 4e6f 6e65  ne, project=None
-0000a7e0: 2c20 7461 673d 4e6f 6e65 2c20 6c61 6265  , tag=None, labe
-0000a7f0: 6c73 3d4e 6f6e 652c 2064 6179 735f 6167  ls=None, days_ag
-0000a800: 6f3d 302c 2074 7265 653d 4e6f 6e65 0a20  o=0, tree=None. 
-0000a810: 2020 2029 3a0a 2020 2020 2020 2020 2222     ):.        ""
-0000a820: 2244 656c 6574 6520 6172 7469 6661 6374  "Delete artifact
-0000a830: 7320 7265 6665 7265 6e63 6564 2062 7920  s referenced by 
-0000a840: 7468 6520 7061 7261 6d65 7465 7273 2e0a  the parameters..
-0000a850: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0000a860: 6e61 6d65 3a20 4e61 6d65 206f 6620 6172  name: Name of ar
-0000a870: 7469 6661 6374 7320 746f 2064 656c 6574  tifacts to delet
-0000a880: 652e 204e 6f74 6520 7468 6174 2074 6869  e. Note that thi
-0000a890: 7320 6973 2061 206c 696b 6520 7175 6572  s is a like quer
-0000a8a0: 792c 2061 6e64 2069 7320 6361 7365 2d69  y, and is case-i
-0000a8b0: 6e73 656e 7369 7469 7665 2e20 5365 650a  nsensitive. See.
-0000a8c0: 2020 2020 2020 2020 2020 2020 3a70 793a              :py:
-0000a8d0: 6675 6e63 3a60 7e6c 6973 745f 6172 7469  func:`~list_arti
-0000a8e0: 6661 6374 7360 2066 6f72 206d 6f72 6520  facts` for more 
-0000a8f0: 6465 7461 696c 732e 0a20 2020 2020 2020  details..       
-0000a900: 203a 7061 7261 6d20 7072 6f6a 6563 743a   :param project:
-0000a910: 2050 726f 6a65 6374 2074 6861 7420 6172   Project that ar
-0000a920: 7469 6661 6374 7320 6265 6c6f 6e67 2074  tifacts belong t
-0000a930: 6f2e 0a20 2020 2020 2020 203a 7061 7261  o..        :para
-0000a940: 6d20 7461 673a 2043 686f 6f73 6520 6172  m tag: Choose ar
-0000a950: 7469 6661 6374 7320 7768 6f20 6172 6520  tifacts who are 
-0000a960: 6173 7369 676e 6564 2074 6869 7320 7461  assigned this ta
-0000a970: 672e 0a20 2020 2020 2020 203a 7061 7261  g..        :para
-0000a980: 6d20 6c61 6265 6c73 3a20 4368 6f6f 7365  m labels: Choose
-0000a990: 2061 7274 6966 6163 7473 2077 6869 6368   artifacts which
-0000a9a0: 2061 7265 206c 6162 656c 6564 2e0a 2020   are labeled..  
-0000a9b0: 2020 2020 2020 3a70 6172 616d 2064 6179        :param day
-0000a9c0: 735f 6167 6f3a 2054 6869 7320 7061 7261  s_ago: This para
-0000a9d0: 6d65 7465 7220 6973 2064 6570 7265 6361  meter is depreca
-0000a9e0: 7465 6420 616e 6420 6e6f 7420 7573 6564  ted and not used
-0000a9f0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-0000aa00: 2020 2020 2020 7072 6f6a 6563 7420 3d20        project = 
-0000aa10: 7072 6f6a 6563 7420 6f72 2063 6f6e 6669  project or confi
-0000aa20: 672e 6465 6661 756c 745f 7072 6f6a 6563  g.default_projec
-0000aa30: 740a 2020 2020 2020 2020 7061 7261 6d73  t.        params
-0000aa40: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
-0000aa50: 2022 6e61 6d65 223a 206e 616d 652c 0a20   "name": name,. 
-0000aa60: 2020 2020 2020 2020 2020 2022 7461 6722             "tag"
-0000aa70: 3a20 7461 672c 0a20 2020 2020 2020 2020  : tag,.         
-0000aa80: 2020 2022 7472 6565 223a 2074 7265 652c     "tree": tree,
-0000aa90: 0a20 2020 2020 2020 2020 2020 2022 6c61  .            "la
-0000aaa0: 6265 6c22 3a20 6c61 6265 6c73 206f 7220  bel": labels or 
-0000aab0: 5b5d 2c0a 2020 2020 2020 2020 2020 2020  [],.            
-0000aac0: 2264 6179 735f 6167 6f22 3a20 7374 7228  "days_ago": str(
-0000aad0: 6461 7973 5f61 676f 292c 0a20 2020 2020  days_ago),.     
-0000aae0: 2020 207d 0a20 2020 2020 2020 2065 7272     }.        err
-0000aaf0: 6f72 203d 2022 6465 6c20 6172 7469 6661  or = "del artifa
-0000ab00: 6374 7322 0a20 2020 2020 2020 2065 6e64  cts".        end
-0000ab10: 706f 696e 745f 7061 7468 203d 2066 2270  point_path = f"p
-0000ab20: 726f 6a65 6374 732f 7b70 726f 6a65 6374  rojects/{project
-0000ab30: 7d2f 6172 7469 6661 6374 7322 0a20 2020  }/artifacts".   
-0000ab40: 2020 2020 2073 656c 662e 6170 695f 6361       self.api_ca
-0000ab50: 6c6c 2822 4445 4c45 5445 222c 2065 6e64  ll("DELETE", end
-0000ab60: 706f 696e 745f 7061 7468 2c20 6572 726f  point_path, erro
-0000ab70: 722c 2070 6172 616d 733d 7061 7261 6d73  r, params=params
-0000ab80: 2c20 7665 7273 696f 6e3d 2276 3222 290a  , version="v2").
-0000ab90: 0a20 2020 2064 6566 206c 6973 745f 6172  .    def list_ar
-0000aba0: 7469 6661 6374 5f74 6167 7328 0a20 2020  tifact_tags(.   
-0000abb0: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-0000abc0: 2020 2070 726f 6a65 6374 3d4e 6f6e 652c     project=None,
-0000abd0: 0a20 2020 2020 2020 2063 6174 6567 6f72  .        categor
-0000abe0: 793a 2055 6e69 6f6e 5b73 7472 2c20 6d6c  y: Union[str, ml
-0000abf0: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
-0000ac00: 6173 2e41 7274 6966 6163 7443 6174 6567  as.ArtifactCateg
-0000ac10: 6f72 6965 735d 203d 204e 6f6e 652c 0a20  ories] = None,. 
-0000ac20: 2020 2029 202d 3e20 6c69 7374 5b73 7472     ) -> list[str
-0000ac30: 5d3a 0a20 2020 2020 2020 2022 2222 5265  ]:.        """Re
-0000ac40: 7475 726e 2061 206c 6973 7420 6f66 2061  turn a list of a
-0000ac50: 6c6c 2074 6865 2074 6167 7320 6173 7369  ll the tags assi
-0000ac60: 676e 6564 2074 6f20 6172 7469 6661 6374  gned to artifact
-0000ac70: 7320 696e 2074 6865 2073 636f 7065 206f  s in the scope o
-0000ac80: 6620 7468 6520 6769 7665 6e20 7072 6f6a  f the given proj
-0000ac90: 6563 742e 2222 220a 0a20 2020 2020 2020  ect."""..       
-0000aca0: 2070 726f 6a65 6374 203d 2070 726f 6a65   project = proje
-0000acb0: 6374 206f 7220 636f 6e66 6967 2e64 6566  ct or config.def
-0000acc0: 6175 6c74 5f70 726f 6a65 6374 0a20 2020  ault_project.   
-0000acd0: 2020 2020 2065 7272 6f72 5f6d 6573 7361       error_messa
-0000ace0: 6765 203d 2066 2246 6169 6c65 6420 6c69  ge = f"Failed li
-0000acf0: 7374 696e 6720 6172 7469 6661 6374 2074  sting artifact t
-0000ad00: 6167 732e 2070 726f 6a65 6374 3d7b 7072  ags. project={pr
-0000ad10: 6f6a 6563 747d 220a 2020 2020 2020 2020  oject}".        
-0000ad20: 7061 7261 6d73 203d 207b 2263 6174 6567  params = {"categ
-0000ad30: 6f72 7922 3a20 6361 7465 676f 7279 7d20  ory": category} 
-0000ad40: 6966 2063 6174 6567 6f72 7920 656c 7365  if category else
-0000ad50: 207b 7d0a 0a20 2020 2020 2020 2072 6573   {}..        res
-0000ad60: 706f 6e73 6520 3d20 7365 6c66 2e61 7069  ponse = self.api
-0000ad70: 5f63 616c 6c28 0a20 2020 2020 2020 2020  _call(.         
-0000ad80: 2020 2022 4745 5422 2c20 6622 7072 6f6a     "GET", f"proj
-0000ad90: 6563 7473 2f7b 7072 6f6a 6563 747d 2f61  ects/{project}/a
-0000ada0: 7274 6966 6163 742d 7461 6773 222c 2065  rtifact-tags", e
-0000adb0: 7272 6f72 5f6d 6573 7361 6765 2c20 7061  rror_message, pa
-0000adc0: 7261 6d73 3d70 6172 616d 730a 2020 2020  rams=params.    
-0000add0: 2020 2020 290a 2020 2020 2020 2020 7265      ).        re
-0000ade0: 7475 726e 2072 6573 706f 6e73 652e 6a73  turn response.js
-0000adf0: 6f6e 2829 5b22 7461 6773 225d 0a0a 2020  on()["tags"]..  
-0000ae00: 2020 6465 6620 7374 6f72 655f 6675 6e63    def store_func
-0000ae10: 7469 6f6e 280a 2020 2020 2020 2020 7365  tion(.        se
-0000ae20: 6c66 2c0a 2020 2020 2020 2020 6675 6e63  lf,.        func
-0000ae30: 7469 6f6e 3a20 7479 7069 6e67 2e55 6e69  tion: typing.Uni
-0000ae40: 6f6e 5b6d 6c72 756e 2e72 756e 7469 6d65  on[mlrun.runtime
-0000ae50: 732e 4261 7365 5275 6e74 696d 652c 2064  s.BaseRuntime, d
-0000ae60: 6963 745d 2c0a 2020 2020 2020 2020 6e61  ict],.        na
-0000ae70: 6d65 2c0a 2020 2020 2020 2020 7072 6f6a  me,.        proj
-0000ae80: 6563 743d 2222 2c0a 2020 2020 2020 2020  ect="",.        
-0000ae90: 7461 673d 4e6f 6e65 2c0a 2020 2020 2020  tag=None,.      
-0000aea0: 2020 7665 7273 696f 6e65 643d 4661 6c73    versioned=Fals
-0000aeb0: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
-0000aec0: 2020 2222 2253 746f 7265 2061 2066 756e    """Store a fun
-0000aed0: 6374 696f 6e20 6f62 6a65 6374 2e20 4675  ction object. Fu
-0000aee0: 6e63 7469 6f6e 2069 7320 6964 656e 7469  nction is identi
-0000aef0: 6669 6564 2062 7920 6974 7320 6e61 6d65  fied by its name
-0000af00: 2061 6e64 2074 6167 2c20 616e 6420 6361   and tag, and ca
-0000af10: 6e20 6265 2076 6572 7369 6f6e 6564 2e22  n be versioned."
-0000af20: 2222 0a20 2020 2020 2020 206e 616d 6520  "".        name 
-0000af30: 3d20 6d6c 7275 6e2e 7574 696c 732e 6e6f  = mlrun.utils.no
-0000af40: 726d 616c 697a 655f 6e61 6d65 286e 616d  rmalize_name(nam
-0000af50: 6529 0a20 2020 2020 2020 2069 6620 6861  e).        if ha
-0000af60: 7361 7474 7228 6675 6e63 7469 6f6e 2c20  sattr(function, 
-0000af70: 2274 6f5f 6469 6374 2229 3a0a 2020 2020  "to_dict"):.    
-0000af80: 2020 2020 2020 2020 6675 6e63 7469 6f6e          function
-0000af90: 203d 2066 756e 6374 696f 6e2e 746f 5f64   = function.to_d
-0000afa0: 6963 7428 290a 0a20 2020 2020 2020 2070  ict()..        p
-0000afb0: 6172 616d 7320 3d20 7b22 7461 6722 3a20  arams = {"tag": 
-0000afc0: 7461 672c 2022 7665 7273 696f 6e65 6422  tag, "versioned"
-0000afd0: 3a20 7665 7273 696f 6e65 647d 0a20 2020  : versioned}.   
-0000afe0: 2020 2020 2070 726f 6a65 6374 203d 2070       project = p
-0000aff0: 726f 6a65 6374 206f 7220 636f 6e66 6967  roject or config
-0000b000: 2e64 6566 6175 6c74 5f70 726f 6a65 6374  .default_project
-0000b010: 0a20 2020 2020 2020 2070 6174 6820 3d20  .        path = 
-0000b020: 6622 7072 6f6a 6563 7473 2f7b 7072 6f6a  f"projects/{proj
-0000b030: 6563 747d 2f66 756e 6374 696f 6e73 2f7b  ect}/functions/{
-0000b040: 6e61 6d65 7d22 0a0a 2020 2020 2020 2020  name}"..        
-0000b050: 6572 726f 7220 3d20 6622 7374 6f72 6520  error = f"store 
-0000b060: 6675 6e63 7469 6f6e 207b 7072 6f6a 6563  function {projec
-0000b070: 747d 2f7b 6e61 6d65 7d22 0a20 2020 2020  t}/{name}".     
-0000b080: 2020 2072 6573 7020 3d20 7365 6c66 2e61     resp = self.a
-0000b090: 7069 5f63 616c 6c28 0a20 2020 2020 2020  pi_call(.       
-0000b0a0: 2020 2020 2022 504f 5354 222c 2070 6174       "POST", pat
-0000b0b0: 682c 2065 7272 6f72 2c20 7061 7261 6d73  h, error, params
-0000b0c0: 3d70 6172 616d 732c 2062 6f64 793d 6469  =params, body=di
-0000b0d0: 6374 5f74 6f5f 6a73 6f6e 2866 756e 6374  ct_to_json(funct
-0000b0e0: 696f 6e29 0a20 2020 2020 2020 2029 0a0a  ion).        )..
-0000b0f0: 2020 2020 2020 2020 2320 6861 7368 206b          # hash k
-0000b100: 6579 206f 7074 696f 6e61 6c20 746f 2062  ey optional to b
-0000b110: 6520 6261 636b 7761 7264 7320 636f 6d70  e backwards comp
-0000b120: 6174 6962 6c65 2074 6f20 4150 4920 763c  atible to API v<
-0000b130: 302e 342e 3130 2069 6e20 7768 6963 6820  0.4.10 in which 
-0000b140: 6974 2077 6173 6e27 7420 696e 2074 6865  it wasn't in the
-0000b150: 2072 6573 706f 6e73 650a 2020 2020 2020   response.      
-0000b160: 2020 7265 7475 726e 2072 6573 702e 6a73    return resp.js
-0000b170: 6f6e 2829 2e67 6574 2822 6861 7368 5f6b  on().get("hash_k
-0000b180: 6579 2229 0a0a 2020 2020 6465 6620 6765  ey")..    def ge
-0000b190: 745f 6675 6e63 7469 6f6e 2873 656c 662c  t_function(self,
-0000b1a0: 206e 616d 652c 2070 726f 6a65 6374 3d22   name, project="
-0000b1b0: 222c 2074 6167 3d4e 6f6e 652c 2068 6173  ", tag=None, has
-0000b1c0: 685f 6b65 793d 2222 293a 0a20 2020 2020  h_key=""):.     
-0000b1d0: 2020 2022 2222 5265 7472 6965 7665 2064     """Retrieve d
-0000b1e0: 6574 6169 6c73 206f 6620 6120 7370 6563  etails of a spec
-0000b1f0: 6966 6963 2066 756e 6374 696f 6e2c 2069  ific function, i
-0000b200: 6465 6e74 6966 6965 6420 6279 2069 7473  dentified by its
-0000b210: 206e 616d 6520 616e 6420 706f 7465 6e74   name and potent
-0000b220: 6961 6c6c 7920 6120 7461 6720 6f72 2066  ially a tag or f
-0000b230: 756e 6374 696f 6e20 6861 7368 2e22 2222  unction hash."""
-0000b240: 0a0a 2020 2020 2020 2020 7061 7261 6d73  ..        params
-0000b250: 203d 207b 2274 6167 223a 2074 6167 2c20   = {"tag": tag, 
-0000b260: 2268 6173 685f 6b65 7922 3a20 6861 7368  "hash_key": hash
-0000b270: 5f6b 6579 7d0a 2020 2020 2020 2020 7072  _key}.        pr
-0000b280: 6f6a 6563 7420 3d20 7072 6f6a 6563 7420  oject = project 
-0000b290: 6f72 2063 6f6e 6669 672e 6465 6661 756c  or config.defaul
-0000b2a0: 745f 7072 6f6a 6563 740a 2020 2020 2020  t_project.      
-0000b2b0: 2020 7061 7468 203d 2066 2270 726f 6a65    path = f"proje
-0000b2c0: 6374 732f 7b70 726f 6a65 6374 7d2f 6675  cts/{project}/fu
-0000b2d0: 6e63 7469 6f6e 732f 7b6e 616d 657d 220a  nctions/{name}".
-0000b2e0: 2020 2020 2020 2020 6572 726f 7220 3d20          error = 
-0000b2f0: 6622 6765 7420 6675 6e63 7469 6f6e 207b  f"get function {
-0000b300: 7072 6f6a 6563 747d 2f7b 6e61 6d65 7d22  project}/{name}"
-0000b310: 0a20 2020 2020 2020 2072 6573 7020 3d20  .        resp = 
-0000b320: 7365 6c66 2e61 7069 5f63 616c 6c28 2247  self.api_call("G
-0000b330: 4554 222c 2070 6174 682c 2065 7272 6f72  ET", path, error
-0000b340: 2c20 7061 7261 6d73 3d70 6172 616d 7329  , params=params)
-0000b350: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0000b360: 7265 7370 2e6a 736f 6e28 295b 2266 756e  resp.json()["fun
-0000b370: 6322 5d0a 0a20 2020 2064 6566 2064 656c  c"]..    def del
-0000b380: 6574 655f 6675 6e63 7469 6f6e 2873 656c  ete_function(sel
-0000b390: 662c 206e 616d 653a 2073 7472 2c20 7072  f, name: str, pr
-0000b3a0: 6f6a 6563 743a 2073 7472 203d 2022 2229  oject: str = "")
-0000b3b0: 3a0a 2020 2020 2020 2020 2222 2244 656c  :.        """Del
-0000b3c0: 6574 6520 6120 6675 6e63 7469 6f6e 2062  ete a function b
-0000b3d0: 656c 6f6e 6769 6e67 2074 6f20 6120 7370  elonging to a sp
-0000b3e0: 6563 6966 6963 2070 726f 6a65 6374 2e22  ecific project."
-0000b3f0: 2222 0a0a 2020 2020 2020 2020 7072 6f6a  ""..        proj
-0000b400: 6563 7420 3d20 7072 6f6a 6563 7420 6f72  ect = project or
-0000b410: 2063 6f6e 6669 672e 6465 6661 756c 745f   config.default_
-0000b420: 7072 6f6a 6563 740a 2020 2020 2020 2020  project.        
-0000b430: 7061 7468 203d 2066 2270 726f 6a65 6374  path = f"project
-0000b440: 732f 7b70 726f 6a65 6374 7d2f 6675 6e63  s/{project}/func
-0000b450: 7469 6f6e 732f 7b6e 616d 657d 220a 2020  tions/{name}".  
-0000b460: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
-0000b470: 6167 6520 3d20 6622 4661 696c 6564 2064  age = f"Failed d
-0000b480: 656c 6574 696e 6720 6675 6e63 7469 6f6e  eleting function
-0000b490: 207b 7072 6f6a 6563 747d 2f7b 6e61 6d65   {project}/{name
-0000b4a0: 7d22 0a20 2020 2020 2020 2073 656c 662e  }".        self.
-0000b4b0: 6170 695f 6361 6c6c 2822 4445 4c45 5445  api_call("DELETE
-0000b4c0: 222c 2070 6174 682c 2065 7272 6f72 5f6d  ", path, error_m
-0000b4d0: 6573 7361 6765 290a 0a20 2020 2064 6566  essage)..    def
-0000b4e0: 206c 6973 745f 6675 6e63 7469 6f6e 7328   list_functions(
-0000b4f0: 7365 6c66 2c20 6e61 6d65 3d4e 6f6e 652c  self, name=None,
-0000b500: 2070 726f 6a65 6374 3d4e 6f6e 652c 2074   project=None, t
-0000b510: 6167 3d4e 6f6e 652c 206c 6162 656c 733d  ag=None, labels=
-0000b520: 4e6f 6e65 293a 0a20 2020 2020 2020 2022  None):.        "
-0000b530: 2222 5265 7472 6965 7665 2061 206c 6973  ""Retrieve a lis
-0000b540: 7420 6f66 2066 756e 6374 696f 6e73 2c20  t of functions, 
-0000b550: 6669 6c74 6572 6564 2062 7920 7370 6563  filtered by spec
-0000b560: 6966 6963 2063 7269 7465 7269 612e 0a0a  ific criteria...
-0000b570: 2020 2020 2020 2020 3a70 6172 616d 206e          :param n
-0000b580: 616d 653a 2052 6574 7572 6e20 6f6e 6c79  ame: Return only
-0000b590: 2066 756e 6374 696f 6e73 2077 6974 6820   functions with 
-0000b5a0: 6120 7370 6563 6966 6963 206e 616d 652e  a specific name.
-0000b5b0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0000b5c0: 7072 6f6a 6563 743a 2052 6574 7572 6e20  project: Return 
-0000b5d0: 6675 6e63 7469 6f6e 7320 6265 6c6f 6e67  functions belong
-0000b5e0: 696e 6720 746f 2074 6869 7320 7072 6f6a  ing to this proj
-0000b5f0: 6563 742e 2049 6620 6e6f 7420 7370 6563  ect. If not spec
-0000b600: 6966 6965 642c 2074 6865 2064 6566 6175  ified, the defau
-0000b610: 6c74 2070 726f 6a65 6374 2069 7320 7573  lt project is us
-0000b620: 6564 2e0a 2020 2020 2020 2020 3a70 6172  ed..        :par
-0000b630: 616d 2074 6167 3a20 5265 7475 726e 2066  am tag: Return f
-0000b640: 756e 6374 696f 6e20 7665 7273 696f 6e73  unction versions
-0000b650: 2077 6974 6820 7370 6563 6966 6963 2074   with specific t
-0000b660: 6167 732e 0a20 2020 2020 2020 203a 7061  ags..        :pa
-0000b670: 7261 6d20 6c61 6265 6c73 3a20 5265 7475  ram labels: Retu
-0000b680: 726e 2066 756e 6374 696f 6e73 2074 6861  rn functions tha
-0000b690: 7420 6861 7665 2073 7065 6369 6669 6320  t have specific 
-0000b6a0: 6c61 6265 6c73 2061 7373 6967 6e65 6420  labels assigned 
-0000b6b0: 746f 2074 6865 6d2e 0a20 2020 2020 2020  to them..       
-0000b6c0: 203a 7265 7475 726e 733a 204c 6973 7420   :returns: List 
-0000b6d0: 6f66 2066 756e 6374 696f 6e20 6f62 6a65  of function obje
-0000b6e0: 6374 7320 2861 7320 6469 6374 696f 6e61  cts (as dictiona
-0000b6f0: 7279 292e 0a20 2020 2020 2020 2022 2222  ry)..        """
-0000b700: 0a20 2020 2020 2020 2070 726f 6a65 6374  .        project
-0000b710: 203d 2070 726f 6a65 6374 206f 7220 636f   = project or co
-0000b720: 6e66 6967 2e64 6566 6175 6c74 5f70 726f  nfig.default_pro
-0000b730: 6a65 6374 0a20 2020 2020 2020 2070 6172  ject.        par
-0000b740: 616d 7320 3d20 7b0a 2020 2020 2020 2020  ams = {.        
-0000b750: 2020 2020 226e 616d 6522 3a20 6e61 6d65      "name": name
-0000b760: 2c0a 2020 2020 2020 2020 2020 2020 2274  ,.            "t
-0000b770: 6167 223a 2074 6167 2c0a 2020 2020 2020  ag": tag,.      
-0000b780: 2020 2020 2020 226c 6162 656c 223a 206c        "label": l
-0000b790: 6162 656c 7320 6f72 205b 5d2c 0a20 2020  abels or [],.   
-0000b7a0: 2020 2020 207d 0a20 2020 2020 2020 2065       }.        e
-0000b7b0: 7272 6f72 203d 2022 6c69 7374 2066 756e  rror = "list fun
-0000b7c0: 6374 696f 6e73 220a 2020 2020 2020 2020  ctions".        
-0000b7d0: 7061 7468 203d 2066 2270 726f 6a65 6374  path = f"project
-0000b7e0: 732f 7b70 726f 6a65 6374 7d2f 6675 6e63  s/{project}/func
-0000b7f0: 7469 6f6e 7322 0a20 2020 2020 2020 2072  tions".        r
-0000b800: 6573 7020 3d20 7365 6c66 2e61 7069 5f63  esp = self.api_c
-0000b810: 616c 6c28 2247 4554 222c 2070 6174 682c  all("GET", path,
-0000b820: 2065 7272 6f72 2c20 7061 7261 6d73 3d70   error, params=p
-0000b830: 6172 616d 7329 0a20 2020 2020 2020 2072  arams).        r
-0000b840: 6574 7572 6e20 7265 7370 2e6a 736f 6e28  eturn resp.json(
-0000b850: 295b 2266 756e 6373 225d 0a0a 2020 2020  )["funcs"]..    
-0000b860: 6465 6620 6c69 7374 5f72 756e 7469 6d65  def list_runtime
-0000b870: 5f72 6573 6f75 7263 6573 280a 2020 2020  _resources(.    
-0000b880: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-0000b890: 2020 7072 6f6a 6563 743a 204f 7074 696f    project: Optio
-0000b8a0: 6e61 6c5b 7374 725d 203d 204e 6f6e 652c  nal[str] = None,
-0000b8b0: 0a20 2020 2020 2020 206c 6162 656c 5f73  .        label_s
-0000b8c0: 656c 6563 746f 723a 204f 7074 696f 6e61  elector: Optiona
-0000b8d0: 6c5b 7374 725d 203d 204e 6f6e 652c 0a20  l[str] = None,. 
-0000b8e0: 2020 2020 2020 206b 696e 643a 204f 7074         kind: Opt
-0000b8f0: 696f 6e61 6c5b 7374 725d 203d 204e 6f6e  ional[str] = Non
-0000b900: 652c 0a20 2020 2020 2020 206f 626a 6563  e,.        objec
-0000b910: 745f 6964 3a20 4f70 7469 6f6e 616c 5b73  t_id: Optional[s
-0000b920: 7472 5d20 3d20 4e6f 6e65 2c0a 2020 2020  tr] = None,.    
-0000b930: 2020 2020 6772 6f75 705f 6279 3a20 4f70      group_by: Op
-0000b940: 7469 6f6e 616c 5b0a 2020 2020 2020 2020  tional[.        
-0000b950: 2020 2020 6d6c 7275 6e2e 636f 6d6d 6f6e      mlrun.common
-0000b960: 2e73 6368 656d 6173 2e4c 6973 7452 756e  .schemas.ListRun
-0000b970: 7469 6d65 5265 736f 7572 6365 7347 726f  timeResourcesGro
-0000b980: 7570 4279 4669 656c 640a 2020 2020 2020  upByField.      
-0000b990: 2020 5d20 3d20 4e6f 6e65 2c0a 2020 2020    ] = None,.    
-0000b9a0: 2920 2d3e 2055 6e69 6f6e 5b0a 2020 2020  ) -> Union[.    
-0000b9b0: 2020 2020 6d6c 7275 6e2e 636f 6d6d 6f6e      mlrun.common
-0000b9c0: 2e73 6368 656d 6173 2e52 756e 7469 6d65  .schemas.Runtime
-0000b9d0: 5265 736f 7572 6365 734f 7574 7075 742c  ResourcesOutput,
-0000b9e0: 0a20 2020 2020 2020 206d 6c72 756e 2e63  .        mlrun.c
-0000b9f0: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 4772  ommon.schemas.Gr
-0000ba00: 6f75 7065 6442 794a 6f62 5275 6e74 696d  oupedByJobRuntim
-0000ba10: 6552 6573 6f75 7263 6573 4f75 7470 7574  eResourcesOutput
-0000ba20: 2c0a 2020 2020 2020 2020 6d6c 7275 6e2e  ,.        mlrun.
-0000ba30: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e47  common.schemas.G
-0000ba40: 726f 7570 6564 4279 5072 6f6a 6563 7452  roupedByProjectR
-0000ba50: 756e 7469 6d65 5265 736f 7572 6365 734f  untimeResourcesO
-0000ba60: 7574 7075 742c 0a20 2020 205d 3a0a 2020  utput,.    ]:.  
-0000ba70: 2020 2020 2020 2222 224c 6973 7420 6375        """List cu
-0000ba80: 7272 656e 7420 7275 6e74 696d 6520 7265  rrent runtime re
-0000ba90: 736f 7572 6365 732c 2077 6869 6368 2061  sources, which a
-0000baa0: 7265 2075 7375 616c 6c79 2028 6275 7420  re usually (but 
-0000bab0: 6e6f 7420 6c69 6d69 7465 6420 746f 2920  not limited to) 
-0000bac0: 4b75 6265 726e 6574 6573 2070 6f64 7320  Kubernetes pods 
-0000bad0: 6f72 2043 5244 732e 0a20 2020 2020 2020  or CRDs..       
-0000bae0: 2046 756e 6374 696f 6e20 6170 706c 6965   Function applie
-0000baf0: 7320 666f 7220 7275 6e73 206f 6620 7479  s for runs of ty
-0000bb00: 7065 2060 5b27 6461 736b 272c 2027 6a6f  pe `['dask', 'jo
-0000bb10: 6227 2c20 2773 7061 726b 272c 2027 7265  b', 'spark', 're
-0000bb20: 6d6f 7465 2d73 7061 726b 272c 2027 6d70  mote-spark', 'mp
-0000bb30: 696a 6f62 275d 602c 2061 6e64 2077 696c  ijob']`, and wil
-0000bb40: 6c20 7265 7475 726e 2070 6572 0a20 2020  l return per.   
-0000bb50: 2020 2020 2072 756e 7469 6d65 206b 696e       runtime kin
-0000bb60: 6420 6120 6c69 7374 206f 6620 7468 6520  d a list of the 
-0000bb70: 7275 6e74 696d 6520 7265 736f 7572 6365  runtime resource
-0000bb80: 7320 2877 6869 6368 206d 6179 2068 6176  s (which may hav
-0000bb90: 6520 616c 7265 6164 7920 636f 6d70 6c65  e already comple
-0000bba0: 7465 6420 7468 6569 7220 6578 6563 7574  ted their execut
-0000bbb0: 696f 6e29 2e0a 0a20 2020 2020 2020 203a  ion)...        :
-0000bbc0: 7061 7261 6d20 7072 6f6a 6563 743a 2047  param project: G
-0000bbd0: 6574 206f 6e6c 7920 7275 6e74 696d 6520  et only runtime 
-0000bbe0: 7265 736f 7572 6365 7320 6f66 2061 2073  resources of a s
-0000bbf0: 7065 6369 6669 6320 7072 6f6a 6563 742c  pecific project,
-0000bc00: 2062 7920 6465 6661 756c 7420 4e6f 6e65   by default None
-0000bc10: 2c20 7768 6963 6820 7769 6c6c 2072 6574  , which will ret
-0000bc20: 7572 6e20 6f6e 6c79 2074 6865 0a20 2020  urn only the.   
-0000bc30: 2020 2020 2020 2020 2070 726f 6a65 6374           project
-0000bc40: 7320 796f 7527 7265 2061 7574 686f 7269  s you're authori
-0000bc50: 7a65 6420 746f 2073 6565 2e0a 2020 2020  zed to see..    
-0000bc60: 2020 2020 3a70 6172 616d 206c 6162 656c      :param label
-0000bc70: 5f73 656c 6563 746f 723a 2041 206c 6162  _selector: A lab
-0000bc80: 656c 2066 696c 7465 7220 7468 6174 2077  el filter that w
-0000bc90: 696c 6c20 6265 2070 6173 7365 6420 746f  ill be passed to
-0000bca0: 204b 7562 6572 6e65 7465 7320 666f 7220   Kubernetes for 
-0000bcb0: 6669 6c74 6572 696e 6720 7468 6520 7265  filtering the re
-0000bcc0: 7375 6c74 7320 6163 636f 7264 696e 670a  sults according.
-0000bcd0: 2020 2020 2020 2020 2020 2020 746f 2074              to t
-0000bce0: 6865 6972 206c 6162 656c 732e 0a20 2020  heir labels..   
-0000bcf0: 2020 2020 203a 7061 7261 6d20 6b69 6e64       :param kind
-0000bd00: 3a20 5468 6520 6b69 6e64 206f 6620 7275  : The kind of ru
-0000bd10: 6e74 696d 6520 746f 2071 7565 7279 2e20  ntime to query. 
-0000bd20: 4d61 7920 6265 206f 6e65 206f 6620 605b  May be one of `[
-0000bd30: 2764 6173 6b27 2c20 276a 6f62 272c 2027  'dask', 'job', '
-0000bd40: 7370 6172 6b27 2c20 2772 656d 6f74 652d  spark', 'remote-
-0000bd50: 7370 6172 6b27 2c20 276d 7069 6a6f 6227  spark', 'mpijob'
-0000bd60: 5d60 0a20 2020 2020 2020 203a 7061 7261  ]`.        :para
-0000bd70: 6d20 6f62 6a65 6374 5f69 643a 2054 6865  m object_id: The
-0000bd80: 2069 6465 6e74 6966 6965 7220 6f66 2074   identifier of t
-0000bd90: 6865 206d 6c72 756e 206f 626a 6563 7420  he mlrun object 
-0000bda0: 746f 2071 7565 7279 2069 7473 2072 756e  to query its run
-0000bdb0: 7469 6d65 2072 6573 6f75 7263 6573 2e20  time resources. 
-0000bdc0: 666f 7220 6d6f 7374 2066 756e 6374 696f  for most functio
-0000bdd0: 6e20 7275 6e74 696d 6573 2c0a 2020 2020  n runtimes,.    
-0000bde0: 2020 2020 2020 2020 7275 6e74 696d 6520          runtime 
-0000bdf0: 7265 736f 7572 6365 7320 6172 6520 7065  resources are pe
-0000be00: 7220 5275 6e2c 2066 6f72 2077 6869 6368  r Run, for which
-0000be10: 2074 6865 2069 6465 6e74 6966 6965 7220   the identifier 
-0000be20: 6973 2074 6865 2052 756e 2773 2055 4944  is the Run's UID
-0000be30: 2e20 466f 7220 6461 736b 2072 756e 7469  . For dask runti
-0000be40: 6d65 2c20 7468 6520 7275 6e74 696d 650a  me, the runtime.
-0000be50: 2020 2020 2020 2020 2020 2020 7265 736f              reso
-0000be60: 7572 6365 7320 6172 6520 7065 7220 4675  urces are per Fu
-0000be70: 6e63 7469 6f6e 2c20 666f 7220 7768 6963  nction, for whic
-0000be80: 6820 7468 6520 6964 656e 7469 6669 6572  h the identifier
-0000be90: 2069 7320 7468 6520 4675 6e63 7469 6f6e   is the Function
-0000bea0: 2773 206e 616d 652e 0a20 2020 2020 2020  's name..       
-0000beb0: 203a 7061 7261 6d20 6772 6f75 705f 6279   :param group_by
-0000bec0: 3a20 4f62 6a65 6374 2074 6f20 6772 6f75  : Object to grou
-0000bed0: 7020 7265 7375 6c74 7320 6279 2e20 416c  p results by. Al
-0000bee0: 6c6f 7765 6420 7661 6c75 6573 2061 7265  lowed values are
-0000bef0: 2060 6a6f 6260 2061 6e64 2060 7072 6f6a   `job` and `proj
-0000bf00: 6563 7460 2e0a 2020 2020 2020 2020 2222  ect`..        ""
-0000bf10: 220a 2020 2020 2020 2020 7061 7261 6d73  ".        params
-0000bf20: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
-0000bf30: 2022 6c61 6265 6c2d 7365 6c65 6374 6f72   "label-selector
-0000bf40: 223a 206c 6162 656c 5f73 656c 6563 746f  ": label_selecto
-0000bf50: 722c 0a20 2020 2020 2020 2020 2020 2022  r,.            "
-0000bf60: 6772 6f75 702d 6279 223a 2067 726f 7570  group-by": group
-0000bf70: 5f62 792c 0a20 2020 2020 2020 2020 2020  _by,.           
-0000bf80: 2022 6b69 6e64 223a 206b 696e 642c 0a20   "kind": kind,. 
-0000bf90: 2020 2020 2020 2020 2020 2022 6f62 6a65             "obje
-0000bfa0: 6374 2d69 6422 3a20 6f62 6a65 6374 5f69  ct-id": object_i
-0000bfb0: 642c 0a20 2020 2020 2020 207d 0a20 2020  d,.        }.   
-0000bfc0: 2020 2020 2070 726f 6a65 6374 5f70 6174       project_pat
-0000bfd0: 6820 3d20 7072 6f6a 6563 7420 6966 2070  h = project if p
-0000bfe0: 726f 6a65 6374 2065 6c73 6520 222a 220a  roject else "*".
-0000bff0: 2020 2020 2020 2020 6572 726f 7220 3d20          error = 
-0000c000: 2246 6169 6c65 6420 6c69 7374 696e 6720  "Failed listing 
-0000c010: 7275 6e74 696d 6520 7265 736f 7572 6365  runtime resource
-0000c020: 7322 0a20 2020 2020 2020 2072 6573 706f  s".        respo
-0000c030: 6e73 6520 3d20 7365 6c66 2e61 7069 5f63  nse = self.api_c
-0000c040: 616c 6c28 0a20 2020 2020 2020 2020 2020  all(.           
-0000c050: 2022 4745 5422 2c20 6622 7072 6f6a 6563   "GET", f"projec
-0000c060: 7473 2f7b 7072 6f6a 6563 745f 7061 7468  ts/{project_path
-0000c070: 7d2f 7275 6e74 696d 652d 7265 736f 7572  }/runtime-resour
-0000c080: 6365 7322 2c20 6572 726f 722c 2070 6172  ces", error, par
-0000c090: 616d 733d 7061 7261 6d73 0a20 2020 2020  ams=params.     
-0000c0a0: 2020 2029 0a20 2020 2020 2020 2069 6620     ).        if 
-0000c0b0: 6772 6f75 705f 6279 2069 7320 4e6f 6e65  group_by is None
-0000c0c0: 3a0a 2020 2020 2020 2020 2020 2020 7374  :.            st
-0000c0d0: 7275 6374 7572 6564 5f6c 6973 7420 3d20  ructured_list = 
-0000c0e0: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
-0000c0f0: 2020 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73    mlrun.common.s
-0000c100: 6368 656d 6173 2e4b 696e 6452 756e 7469  chemas.KindRunti
-0000c110: 6d65 5265 736f 7572 6365 7328 2a2a 6b69  meResources(**ki
-0000c120: 6e64 5f72 756e 7469 6d65 5f72 6573 6f75  nd_runtime_resou
-0000c130: 7263 6573 290a 2020 2020 2020 2020 2020  rces).          
-0000c140: 2020 2020 2020 666f 7220 6b69 6e64 5f72        for kind_r
-0000c150: 756e 7469 6d65 5f72 6573 6f75 7263 6573  untime_resources
-0000c160: 2069 6e20 7265 7370 6f6e 7365 2e6a 736f   in response.jso
-0000c170: 6e28 290a 2020 2020 2020 2020 2020 2020  n().            
-0000c180: 5d0a 2020 2020 2020 2020 2020 2020 7265  ].            re
-0000c190: 7475 726e 2073 7472 7563 7475 7265 645f  turn structured_
-0000c1a0: 6c69 7374 0a20 2020 2020 2020 2065 6c69  list.        eli
-0000c1b0: 6620 6772 6f75 705f 6279 203d 3d20 6d6c  f group_by == ml
-0000c1c0: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
-0000c1d0: 6173 2e4c 6973 7452 756e 7469 6d65 5265  as.ListRuntimeRe
-0000c1e0: 736f 7572 6365 7347 726f 7570 4279 4669  sourcesGroupByFi
-0000c1f0: 656c 642e 6a6f 623a 0a20 2020 2020 2020  eld.job:.       
-0000c200: 2020 2020 2073 7472 7563 7475 7265 645f       structured_
-0000c210: 6469 6374 203d 207b 7d0a 2020 2020 2020  dict = {}.      
-0000c220: 2020 2020 2020 666f 7220 7072 6f6a 6563        for projec
-0000c230: 742c 206a 6f62 5f72 756e 7469 6d65 5f72  t, job_runtime_r
-0000c240: 6573 6f75 7263 6573 5f6d 6170 2069 6e20  esources_map in 
-0000c250: 7265 7370 6f6e 7365 2e6a 736f 6e28 292e  response.json().
-0000c260: 6974 656d 7328 293a 0a20 2020 2020 2020  items():.       
-0000c270: 2020 2020 2020 2020 2066 6f72 206a 6f62           for job
-0000c280: 5f69 642c 2072 756e 7469 6d65 5f72 6573  _id, runtime_res
-0000c290: 6f75 7263 6573 2069 6e20 6a6f 625f 7275  ources in job_ru
-0000c2a0: 6e74 696d 655f 7265 736f 7572 6365 735f  ntime_resources_
-0000c2b0: 6d61 702e 6974 656d 7328 293a 0a20 2020  map.items():.   
-0000c2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c2d0: 2073 7472 7563 7475 7265 645f 6469 6374   structured_dict
-0000c2e0: 2e73 6574 6465 6661 756c 7428 7072 6f6a  .setdefault(proj
-0000c2f0: 6563 742c 207b 7d29 5b6a 6f62 5f69 645d  ect, {})[job_id]
-0000c300: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
-0000c310: 2020 2020 2020 2020 2020 2020 206d 6c72               mlr
-0000c320: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
-0000c330: 732e 5275 6e74 696d 6552 6573 6f75 7263  s.RuntimeResourc
-0000c340: 6573 282a 2a72 756e 7469 6d65 5f72 6573  es(**runtime_res
-0000c350: 6f75 7263 6573 290a 2020 2020 2020 2020  ources).        
-0000c360: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0000c370: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0000c380: 2073 7472 7563 7475 7265 645f 6469 6374   structured_dict
-0000c390: 0a20 2020 2020 2020 2065 6c69 6620 6772  .        elif gr
-0000c3a0: 6f75 705f 6279 203d 3d20 6d6c 7275 6e2e  oup_by == mlrun.
-0000c3b0: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e4c  common.schemas.L
-0000c3c0: 6973 7452 756e 7469 6d65 5265 736f 7572  istRuntimeResour
-0000c3d0: 6365 7347 726f 7570 4279 4669 656c 642e  cesGroupByField.
-0000c3e0: 7072 6f6a 6563 743a 0a20 2020 2020 2020  project:.       
-0000c3f0: 2020 2020 2073 7472 7563 7475 7265 645f       structured_
-0000c400: 6469 6374 203d 207b 7d0a 2020 2020 2020  dict = {}.      
-0000c410: 2020 2020 2020 666f 7220 7072 6f6a 6563        for projec
-0000c420: 742c 206b 696e 645f 7275 6e74 696d 655f  t, kind_runtime_
-0000c430: 7265 736f 7572 6365 735f 6d61 7020 696e  resources_map in
-0000c440: 2072 6573 706f 6e73 652e 6a73 6f6e 2829   response.json()
-0000c450: 2e69 7465 6d73 2829 3a0a 2020 2020 2020  .items():.      
-0000c460: 2020 2020 2020 2020 2020 666f 7220 6b69            for ki
-0000c470: 6e64 2c20 7275 6e74 696d 655f 7265 736f  nd, runtime_reso
-0000c480: 7572 6365 7320 696e 206b 696e 645f 7275  urces in kind_ru
-0000c490: 6e74 696d 655f 7265 736f 7572 6365 735f  ntime_resources_
-0000c4a0: 6d61 702e 6974 656d 7328 293a 0a20 2020  map.items():.   
-0000c4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c4c0: 2073 7472 7563 7475 7265 645f 6469 6374   structured_dict
-0000c4d0: 2e73 6574 6465 6661 756c 7428 7072 6f6a  .setdefault(proj
-0000c4e0: 6563 742c 207b 7d29 5b6b 696e 645d 203d  ect, {})[kind] =
-0000c4f0: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
-0000c500: 2020 2020 2020 2020 2020 206d 6c72 756e             mlrun
-0000c510: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
-0000c520: 5275 6e74 696d 6552 6573 6f75 7263 6573  RuntimeResources
-0000c530: 282a 2a72 756e 7469 6d65 5f72 6573 6f75  (**runtime_resou
-0000c540: 7263 6573 290a 2020 2020 2020 2020 2020  rces).          
-0000c550: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0000c560: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0000c570: 7472 7563 7475 7265 645f 6469 6374 0a20  tructured_dict. 
-0000c580: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0000c590: 2020 2020 2020 2020 2072 6169 7365 204e           raise N
-0000c5a0: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
-0000c5b0: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-0000c5c0: 2020 2020 6622 5072 6f76 6964 6564 2067      f"Provided g
-0000c5d0: 726f 7570 2062 7920 6669 656c 6420 6973  roup by field is
-0000c5e0: 206e 6f74 2073 7570 706f 7274 6564 2e20   not supported. 
-0000c5f0: 6772 6f75 705f 6279 3d7b 6772 6f75 705f  group_by={group_
-0000c600: 6279 7d22 0a20 2020 2020 2020 2020 2020  by}".           
-0000c610: 2029 0a0a 2020 2020 6465 6620 6465 6c65   )..    def dele
-0000c620: 7465 5f72 756e 7469 6d65 5f72 6573 6f75  te_runtime_resou
-0000c630: 7263 6573 280a 2020 2020 2020 2020 7365  rces(.        se
-0000c640: 6c66 2c0a 2020 2020 2020 2020 7072 6f6a  lf,.        proj
-0000c650: 6563 743a 204f 7074 696f 6e61 6c5b 7374  ect: Optional[st
-0000c660: 725d 203d 204e 6f6e 652c 0a20 2020 2020  r] = None,.     
-0000c670: 2020 206c 6162 656c 5f73 656c 6563 746f     label_selecto
-0000c680: 723a 204f 7074 696f 6e61 6c5b 7374 725d  r: Optional[str]
-0000c690: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-0000c6a0: 206b 696e 643a 204f 7074 696f 6e61 6c5b   kind: Optional[
-0000c6b0: 7374 725d 203d 204e 6f6e 652c 0a20 2020  str] = None,.   
-0000c6c0: 2020 2020 206f 626a 6563 745f 6964 3a20       object_id: 
-0000c6d0: 4f70 7469 6f6e 616c 5b73 7472 5d20 3d20  Optional[str] = 
-0000c6e0: 4e6f 6e65 2c0a 2020 2020 2020 2020 666f  None,.        fo
-0000c6f0: 7263 653a 2062 6f6f 6c20 3d20 4661 6c73  rce: bool = Fals
-0000c700: 652c 0a20 2020 2020 2020 2067 7261 6365  e,.        grace
-0000c710: 5f70 6572 696f 643a 2069 6e74 203d 204e  _period: int = N
-0000c720: 6f6e 652c 0a20 2020 2029 202d 3e20 6d6c  one,.    ) -> ml
-0000c730: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
-0000c740: 6173 2e47 726f 7570 6564 4279 5072 6f6a  as.GroupedByProj
-0000c750: 6563 7452 756e 7469 6d65 5265 736f 7572  ectRuntimeResour
-0000c760: 6365 734f 7574 7075 743a 0a20 2020 2020  cesOutput:.     
-0000c770: 2020 2022 2222 4465 6c65 7465 2061 6c6c     """Delete all
-0000c780: 2072 756e 7469 6d65 2072 6573 6f75 7263   runtime resourc
-0000c790: 6573 2077 6869 6368 2061 7265 2069 6e20  es which are in 
-0000c7a0: 7465 726d 696e 616c 2073 7461 7465 2e0a  terminal state..
-0000c7b0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0000c7c0: 7072 6f6a 6563 743a 2044 656c 6574 6520  project: Delete 
-0000c7d0: 6f6e 6c79 2072 756e 7469 6d65 2072 6573  only runtime res
-0000c7e0: 6f75 7263 6573 206f 6620 6120 7370 6563  ources of a spec
-0000c7f0: 6966 6963 2070 726f 6a65 6374 2c20 6279  ific project, by
-0000c800: 2064 6566 6175 6c74 204e 6f6e 652c 2077   default None, w
-0000c810: 6869 6368 2077 696c 6c20 6465 6c65 7465  hich will delete
-0000c820: 206f 6e6c 790a 2020 2020 2020 2020 2020   only.          
-0000c830: 2020 6672 6f6d 2074 6865 2070 726f 6a65    from the proje
-0000c840: 6374 7320 796f 7527 7265 2061 7574 686f  cts you're autho
-0000c850: 7269 7a65 6420 746f 2064 656c 6574 6520  rized to delete 
-0000c860: 6672 6f6d 2e0a 2020 2020 2020 2020 3a70  from..        :p
-0000c870: 6172 616d 206c 6162 656c 5f73 656c 6563  aram label_selec
-0000c880: 746f 723a 2044 656c 6574 6520 6f6e 6c79  tor: Delete only
-0000c890: 2072 756e 7469 6d65 2072 6573 6f75 7263   runtime resourc
-0000c8a0: 6573 206d 6174 6368 696e 6720 7468 6520  es matching the 
-0000c8b0: 6c61 6265 6c20 7365 6c65 6374 6f72 2e0a  label selector..
-0000c8c0: 2020 2020 2020 2020 3a70 6172 616d 206b          :param k
-0000c8d0: 696e 643a 2054 6865 206b 696e 6420 6f66  ind: The kind of
-0000c8e0: 2072 756e 7469 6d65 2074 6f20 6465 6c65   runtime to dele
-0000c8f0: 7465 2e20 4d61 7920 6265 206f 6e65 206f  te. May be one o
-0000c900: 6620 605b 2764 6173 6b27 2c20 276a 6f62  f `['dask', 'job
-0000c910: 272c 2027 7370 6172 6b27 2c20 2772 656d  ', 'spark', 'rem
-0000c920: 6f74 652d 7370 6172 6b27 2c20 276d 7069  ote-spark', 'mpi
-0000c930: 6a6f 6227 5d60 0a20 2020 2020 2020 203a  job']`.        :
-0000c940: 7061 7261 6d20 6f62 6a65 6374 5f69 643a  param object_id:
-0000c950: 2054 6865 2069 6465 6e74 6966 6965 7220   The identifier 
-0000c960: 6f66 2074 6865 206d 6c72 756e 206f 626a  of the mlrun obj
-0000c970: 6563 7420 746f 2064 656c 6574 6520 6974  ect to delete it
-0000c980: 7320 7275 6e74 696d 6520 7265 736f 7572  s runtime resour
-0000c990: 6365 732e 2066 6f72 206d 6f73 7420 6675  ces. for most fu
-0000c9a0: 6e63 7469 6f6e 0a20 2020 2020 2020 2020  nction.         
-0000c9b0: 2020 2072 756e 7469 6d65 732c 2072 756e     runtimes, run
-0000c9c0: 7469 6d65 2072 6573 6f75 7263 6573 2061  time resources a
-0000c9d0: 7265 2070 6572 2052 756e 2c20 666f 7220  re per Run, for 
-0000c9e0: 7768 6963 6820 7468 6520 6964 656e 7469  which the identi
-0000c9f0: 6669 6572 2069 7320 7468 6520 5275 6e27  fier is the Run'
-0000ca00: 7320 5549 442e 2046 6f72 2064 6173 6b20  s UID. For dask 
-0000ca10: 7275 6e74 696d 652c 2074 6865 0a20 2020  runtime, the.   
-0000ca20: 2020 2020 2020 2020 2072 756e 7469 6d65           runtime
-0000ca30: 2072 6573 6f75 7263 6573 2061 7265 2070   resources are p
-0000ca40: 6572 2046 756e 6374 696f 6e2c 2066 6f72  er Function, for
-0000ca50: 2077 6869 6368 2074 6865 2069 6465 6e74   which the ident
-0000ca60: 6966 6965 7220 6973 2074 6865 2046 756e  ifier is the Fun
-0000ca70: 6374 696f 6e27 7320 6e61 6d65 2e0a 2020  ction's name..  
-0000ca80: 2020 2020 2020 3a70 6172 616d 2066 6f72        :param for
-0000ca90: 6365 3a20 466f 7263 6520 6465 6c65 7469  ce: Force deleti
-0000caa0: 6f6e 202d 2064 656c 6574 6520 7468 6520  on - delete the 
-0000cab0: 7275 6e74 696d 6520 7265 736f 7572 6365  runtime resource
-0000cac0: 2065 7665 6e20 6966 2069 7427 7320 6e6f   even if it's no
-0000cad0: 7420 696e 2074 6572 6d69 6e61 6c20 7374  t in terminal st
-0000cae0: 6174 6520 6f72 2069 6620 7468 6520 6772  ate or if the gr
-0000caf0: 6163 650a 2020 2020 2020 2020 2020 2020  ace.            
-0000cb00: 7065 7269 6f64 2064 6964 6e27 7420 7061  period didn't pa
-0000cb10: 7373 2e0a 2020 2020 2020 2020 3a70 6172  ss..        :par
-0000cb20: 616d 2067 7261 6365 5f70 6572 696f 643a  am grace_period:
-0000cb30: 2047 7261 6365 2070 6572 696f 6420 6769   Grace period gi
-0000cb40: 7665 6e20 746f 2074 6865 2072 756e 7469  ven to the runti
-0000cb50: 6d65 2072 6573 6f75 7263 6520 6265 666f  me resource befo
-0000cb60: 7265 2074 6865 7920 6172 6520 6163 7475  re they are actu
-0000cb70: 616c 6c79 2072 656d 6f76 6564 2c20 636f  ally removed, co
-0000cb80: 756e 7465 6420 6672 6f6d 0a20 2020 2020  unted from.     
-0000cb90: 2020 2020 2020 2074 6865 206d 6f6d 656e         the momen
-0000cba0: 7420 7468 6579 206d 6f76 6564 2074 6f20  t they moved to 
-0000cbb0: 7465 726d 696e 616c 2073 7461 7465 0a20  terminal state. 
-0000cbc0: 2020 2020 2020 2020 2020 2028 6465 6661             (defa
-0000cbd0: 756c 7473 2074 6f20 6d6c 7275 6e2e 636f  ults to mlrun.co
-0000cbe0: 6e66 6967 2e63 6f6e 6669 672e 7275 6e74  nfig.config.runt
-0000cbf0: 696d 655f 7265 736f 7572 6365 735f 6465  ime_resources_de
-0000cc00: 6c65 7469 6f6e 5f67 7261 6365 5f70 6572  letion_grace_per
-0000cc10: 696f 6429 2e0a 0a20 2020 2020 2020 203a  iod)...        :
-0000cc20: 7265 7475 726e 733a 203a 7079 3a63 6c61  returns: :py:cla
-0000cc30: 7373 3a60 7e6d 6c72 756e 2e63 6f6d 6d6f  ss:`~mlrun.commo
-0000cc40: 6e2e 7363 6865 6d61 732e 4772 6f75 7065  n.schemas.Groupe
-0000cc50: 6442 7950 726f 6a65 6374 5275 6e74 696d  dByProjectRuntim
-0000cc60: 6552 6573 6f75 7263 6573 4f75 7470 7574  eResourcesOutput
-0000cc70: 6020 6c69 7374 696e 6720 7468 6520 7275  ` listing the ru
-0000cc80: 6e74 696d 6520 7265 736f 7572 6365 730a  ntime resources.
-0000cc90: 2020 2020 2020 2020 2020 2020 7468 6174              that
-0000cca0: 2077 6572 6520 7265 6d6f 7665 642e 0a20   were removed.. 
-0000ccb0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0000ccc0: 2020 2069 6620 6772 6163 655f 7065 7269     if grace_peri
-0000ccd0: 6f64 2069 7320 4e6f 6e65 3a0a 2020 2020  od is None:.    
-0000cce0: 2020 2020 2020 2020 6772 6163 655f 7065          grace_pe
-0000ccf0: 7269 6f64 203d 2063 6f6e 6669 672e 7275  riod = config.ru
-0000cd00: 6e74 696d 655f 7265 736f 7572 6365 735f  ntime_resources_
-0000cd10: 6465 6c65 7469 6f6e 5f67 7261 6365 5f70  deletion_grace_p
-0000cd20: 6572 696f 640a 2020 2020 2020 2020 2020  eriod.          
-0000cd30: 2020 6c6f 6767 6572 2e69 6e66 6f28 0a20    logger.info(. 
-0000cd40: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0000cd50: 5573 696e 6720 6465 6661 756c 7420 6772  Using default gr
-0000cd60: 6163 6520 7065 7269 6f64 2066 6f72 2072  ace period for r
-0000cd70: 756e 7469 6d65 2072 6573 6f75 7263 6573  untime resources
-0000cd80: 2064 656c 6574 696f 6e22 2c0a 2020 2020   deletion",.    
-0000cd90: 2020 2020 2020 2020 2020 2020 6772 6163              grac
-0000cda0: 655f 7065 7269 6f64 3d67 7261 6365 5f70  e_period=grace_p
-0000cdb0: 6572 696f 642c 0a20 2020 2020 2020 2020  eriod,.         
-0000cdc0: 2020 2029 0a0a 2020 2020 2020 2020 7061     )..        pa
-0000cdd0: 7261 6d73 203d 207b 0a20 2020 2020 2020  rams = {.       
-0000cde0: 2020 2020 2022 6c61 6265 6c2d 7365 6c65       "label-sele
-0000cdf0: 6374 6f72 223a 206c 6162 656c 5f73 656c  ctor": label_sel
-0000ce00: 6563 746f 722c 0a20 2020 2020 2020 2020  ector,.         
-0000ce10: 2020 2022 6b69 6e64 223a 206b 696e 642c     "kind": kind,
-0000ce20: 0a20 2020 2020 2020 2020 2020 2022 6f62  .            "ob
-0000ce30: 6a65 6374 2d69 6422 3a20 6f62 6a65 6374  ject-id": object
-0000ce40: 5f69 642c 0a20 2020 2020 2020 2020 2020  _id,.           
-0000ce50: 2022 666f 7263 6522 3a20 666f 7263 652c   "force": force,
-0000ce60: 0a20 2020 2020 2020 2020 2020 2022 6772  .            "gr
-0000ce70: 6163 652d 7065 7269 6f64 223a 2067 7261  ace-period": gra
-0000ce80: 6365 5f70 6572 696f 642c 0a20 2020 2020  ce_period,.     
-0000ce90: 2020 207d 0a20 2020 2020 2020 2065 7272     }.        err
-0000cea0: 6f72 203d 2022 4661 696c 6564 2064 656c  or = "Failed del
-0000ceb0: 6574 696e 6720 7275 6e74 696d 6520 7265  eting runtime re
-0000cec0: 736f 7572 6365 7322 0a20 2020 2020 2020  sources".       
-0000ced0: 2070 726f 6a65 6374 5f70 6174 6820 3d20   project_path = 
-0000cee0: 7072 6f6a 6563 7420 6966 2070 726f 6a65  project if proje
-0000cef0: 6374 2065 6c73 6520 222a 220a 2020 2020  ct else "*".    
-0000cf00: 2020 2020 7265 7370 6f6e 7365 203d 2073      response = s
-0000cf10: 656c 662e 6170 695f 6361 6c6c 280a 2020  elf.api_call(.  
-0000cf20: 2020 2020 2020 2020 2020 2244 454c 4554            "DELET
-0000cf30: 4522 2c0a 2020 2020 2020 2020 2020 2020  E",.            
-0000cf40: 6622 7072 6f6a 6563 7473 2f7b 7072 6f6a  f"projects/{proj
-0000cf50: 6563 745f 7061 7468 7d2f 7275 6e74 696d  ect_path}/runtim
-0000cf60: 652d 7265 736f 7572 6365 7322 2c0a 2020  e-resources",.  
-0000cf70: 2020 2020 2020 2020 2020 6572 726f 722c            error,
-0000cf80: 0a20 2020 2020 2020 2020 2020 2070 6172  .            par
-0000cf90: 616d 733d 7061 7261 6d73 2c0a 2020 2020  ams=params,.    
-0000cfa0: 2020 2020 290a 2020 2020 2020 2020 7374      ).        st
-0000cfb0: 7275 6374 7572 6564 5f64 6963 7420 3d20  ructured_dict = 
-0000cfc0: 7b7d 0a20 2020 2020 2020 2066 6f72 2070  {}.        for p
-0000cfd0: 726f 6a65 6374 2c20 6b69 6e64 5f72 756e  roject, kind_run
-0000cfe0: 7469 6d65 5f72 6573 6f75 7263 6573 5f6d  time_resources_m
-0000cff0: 6170 2069 6e20 7265 7370 6f6e 7365 2e6a  ap in response.j
-0000d000: 736f 6e28 292e 6974 656d 7328 293a 0a20  son().items():. 
-0000d010: 2020 2020 2020 2020 2020 2066 6f72 206b             for k
-0000d020: 696e 642c 2072 756e 7469 6d65 5f72 6573  ind, runtime_res
-0000d030: 6f75 7263 6573 2069 6e20 6b69 6e64 5f72  ources in kind_r
-0000d040: 756e 7469 6d65 5f72 6573 6f75 7263 6573  untime_resources
-0000d050: 5f6d 6170 2e69 7465 6d73 2829 3a0a 2020  _map.items():.  
-0000d060: 2020 2020 2020 2020 2020 2020 2020 7374                st
-0000d070: 7275 6374 7572 6564 5f64 6963 742e 7365  ructured_dict.se
-0000d080: 7464 6566 6175 6c74 2870 726f 6a65 6374  tdefault(project
-0000d090: 2c20 7b7d 295b 6b69 6e64 5d20 3d20 280a  , {})[kind] = (.
-0000d0a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d0b0: 2020 2020 6d6c 7275 6e2e 636f 6d6d 6f6e      mlrun.common
-0000d0c0: 2e73 6368 656d 6173 2e52 756e 7469 6d65  .schemas.Runtime
-0000d0d0: 5265 736f 7572 6365 7328 2a2a 7275 6e74  Resources(**runt
-0000d0e0: 696d 655f 7265 736f 7572 6365 7329 0a20  ime_resources). 
-0000d0f0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-0000d100: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0000d110: 7374 7275 6374 7572 6564 5f64 6963 740a  structured_dict.
-0000d120: 0a20 2020 2064 6566 2063 7265 6174 655f  .    def create_
-0000d130: 7363 6865 6475 6c65 280a 2020 2020 2020  schedule(.      
-0000d140: 2020 7365 6c66 2c20 7072 6f6a 6563 743a    self, project:
-0000d150: 2073 7472 2c20 7363 6865 6475 6c65 3a20   str, schedule: 
-0000d160: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-0000d170: 656d 6173 2e53 6368 6564 756c 6549 6e70  emas.ScheduleInp
-0000d180: 7574 0a20 2020 2029 3a0a 2020 2020 2020  ut.    ):.      
-0000d190: 2020 2222 2243 7265 6174 6520 6120 6e65    """Create a ne
-0000d1a0: 7720 7363 6865 6475 6c65 206f 6e20 7468  w schedule on th
-0000d1b0: 6520 6769 7665 6e20 7072 6f6a 6563 742e  e given project.
-0000d1c0: 2054 6865 2064 6574 6169 6c73 206f 6e20   The details on 
-0000d1d0: 7468 6520 6163 7475 616c 206f 626a 6563  the actual objec
-0000d1e0: 7420 746f 2073 6368 6564 756c 6520 6173  t to schedule as
-0000d1f0: 2077 656c 6c20 6173 2074 6865 0a20 2020   well as the.   
-0000d200: 2020 2020 2073 6368 6564 756c 6520 6974       schedule it
-0000d210: 7365 6c66 2061 7265 2077 6974 6869 6e20  self are within 
-0000d220: 7468 6520 7363 6865 6475 6c65 206f 626a  the schedule obj
-0000d230: 6563 7420 7072 6f76 6964 6564 2e0a 2020  ect provided..  
-0000d240: 2020 2020 2020 5468 6520 3a70 793a 636c        The :py:cl
-0000d250: 6173 733a 607e 5363 6865 6475 6c65 4372  ass:`~ScheduleCr
-0000d260: 6f6e 5472 6967 6765 7260 2066 6f6c 6c6f  onTrigger` follo
-0000d270: 7773 2074 6865 2067 7569 6465 6c69 6e65  ws the guideline
-0000d280: 7320 696e 0a20 2020 2020 2020 2068 7474  s in.        htt
-0000d290: 7073 3a2f 2f61 7073 6368 6564 756c 6572  ps://apscheduler
-0000d2a0: 2e72 6561 6474 6865 646f 6373 2e69 6f2f  .readthedocs.io/
-0000d2b0: 656e 2f33 2e78 2f6d 6f64 756c 6573 2f74  en/3.x/modules/t
-0000d2c0: 7269 6767 6572 732f 6372 6f6e 2e68 746d  riggers/cron.htm
-0000d2d0: 6c2e 0a20 2020 2020 2020 2049 7420 616c  l..        It al
-0000d2e0: 736f 2073 7570 706f 7274 7320 6120 3a70  so supports a :p
-0000d2f0: 793a 6675 6e63 3a60 7e53 6368 6564 756c  y:func:`~Schedul
-0000d300: 6543 726f 6e54 7269 6767 6572 2e66 726f  eCronTrigger.fro
-0000d310: 6d5f 6372 6f6e 7461 6260 2066 756e 6374  m_crontab` funct
-0000d320: 696f 6e20 7468 6174 2061 6363 6570 7473  ion that accepts
-0000d330: 2061 0a20 2020 2020 2020 2063 726f 6e74   a.        cront
-0000d340: 6162 2d66 6f72 6d61 7474 6564 2073 7472  ab-formatted str
-0000d350: 696e 6720 2873 6565 2068 7474 7073 3a2f  ing (see https:/
-0000d360: 2f65 6e2e 7769 6b69 7065 6469 612e 6f72  /en.wikipedia.or
-0000d370: 672f 7769 6b69 2f43 726f 6e20 666f 7220  g/wiki/Cron for 
-0000d380: 6d6f 7265 2069 6e66 6f72 6d61 7469 6f6e  more information
-0000d390: 206f 6e20 7468 6520 666f 726d 6174 2061   on the format a
-0000d3a0: 6e64 0a20 2020 2020 2020 206e 6f74 6520  nd.        note 
-0000d3b0: 7468 6174 2074 6865 2030 2077 6565 6b64  that the 0 weekd
-0000d3c0: 6179 2069 7320 616c 7761 7973 206d 6f6e  ay is always mon
-0000d3d0: 6461 7929 2e0a 0a0a 2020 2020 2020 2020  day)....        
-0000d3e0: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
-0000d3f0: 2020 2020 2020 2066 726f 6d20 6d6c 7275         from mlru
-0000d400: 6e2e 636f 6d6d 6f6e 2069 6d70 6f72 7420  n.common import 
-0000d410: 7363 6865 6d61 730a 0a20 2020 2020 2020  schemas..       
-0000d420: 2020 2020 2023 2045 7865 6375 7465 2074       # Execute t
-0000d430: 6865 2067 6574 5f64 6174 615f 6675 6e63  he get_data_func
-0000d440: 2066 756e 6374 696f 6e20 6576 6572 7920   function every 
-0000d450: 5475 6573 6461 7920 6174 2031 353a 3330  Tuesday at 15:30
-0000d460: 0a20 2020 2020 2020 2020 2020 2073 6368  .            sch
-0000d470: 6564 756c 6520 3d20 7363 6865 6d61 732e  edule = schemas.
-0000d480: 5363 6865 6475 6c65 496e 7075 7428 0a20  ScheduleInput(. 
-0000d490: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-0000d4a0: 616d 653d 2272 756e 5f66 756e 635f 6f6e  ame="run_func_on
-0000d4b0: 5f74 7565 7364 6179 7322 2c0a 2020 2020  _tuesdays",.    
-0000d4c0: 2020 2020 2020 2020 2020 2020 6b69 6e64              kind
-0000d4d0: 3d22 6a6f 6222 2c0a 2020 2020 2020 2020  ="job",.        
-0000d4e0: 2020 2020 2020 2020 7363 6865 6475 6c65          schedule
-0000d4f0: 645f 6f62 6a65 6374 3d67 6574 5f64 6174  d_object=get_dat
-0000d500: 615f 6675 6e63 2c0a 2020 2020 2020 2020  a_func,.        
-0000d510: 2020 2020 2020 2020 6372 6f6e 5f74 7269          cron_tri
-0000d520: 6767 6572 3d73 6368 656d 6173 2e53 6368  gger=schemas.Sch
-0000d530: 6564 756c 6543 726f 6e54 7269 6767 6572  eduleCronTrigger
-0000d540: 2864 6179 5f6f 665f 7765 656b 3d27 7475  (day_of_week='tu
-0000d550: 6527 2c20 686f 7572 3d31 352c 206d 696e  e', hour=15, min
-0000d560: 7574 653d 3330 292c 0a20 2020 2020 2020  ute=30),.       
-0000d570: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-0000d580: 2020 2064 622e 6372 6561 7465 5f73 6368     db.create_sch
-0000d590: 6564 756c 6528 7072 6f6a 6563 745f 6e61  edule(project_na
-0000d5a0: 6d65 2c20 7363 6865 6475 6c65 290a 2020  me, schedule).  
-0000d5b0: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
-0000d5c0: 2020 2070 726f 6a65 6374 203d 2070 726f     project = pro
-0000d5d0: 6a65 6374 206f 7220 636f 6e66 6967 2e64  ject or config.d
-0000d5e0: 6566 6175 6c74 5f70 726f 6a65 6374 0a20  efault_project. 
-0000d5f0: 2020 2020 2020 2070 6174 6820 3d20 6622         path = f"
-0000d600: 7072 6f6a 6563 7473 2f7b 7072 6f6a 6563  projects/{projec
-0000d610: 747d 2f73 6368 6564 756c 6573 220a 0a20  t}/schedules".. 
-0000d620: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
-0000d630: 7361 6765 203d 2066 2246 6169 6c65 6420  sage = f"Failed 
-0000d640: 6372 6561 7469 6e67 2073 6368 6564 756c  creating schedul
-0000d650: 6520 7b70 726f 6a65 6374 7d2f 7b73 6368  e {project}/{sch
-0000d660: 6564 756c 652e 6e61 6d65 7d22 0a20 2020  edule.name}".   
-0000d670: 2020 2020 2073 656c 662e 6170 695f 6361       self.api_ca
-0000d680: 6c6c 2822 504f 5354 222c 2070 6174 682c  ll("POST", path,
-0000d690: 2065 7272 6f72 5f6d 6573 7361 6765 2c20   error_message, 
-0000d6a0: 626f 6479 3d64 6963 745f 746f 5f6a 736f  body=dict_to_jso
-0000d6b0: 6e28 7363 6865 6475 6c65 2e64 6963 7428  n(schedule.dict(
-0000d6c0: 2929 290a 0a20 2020 2064 6566 2075 7064  )))..    def upd
-0000d6d0: 6174 655f 7363 6865 6475 6c65 280a 2020  ate_schedule(.  
-0000d6e0: 2020 2020 2020 7365 6c66 2c20 7072 6f6a        self, proj
-0000d6f0: 6563 743a 2073 7472 2c20 6e61 6d65 3a20  ect: str, name: 
-0000d700: 7374 722c 2073 6368 6564 756c 653a 206d  str, schedule: m
-0000d710: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
-0000d720: 6d61 732e 5363 6865 6475 6c65 5570 6461  mas.ScheduleUpda
-0000d730: 7465 0a20 2020 2029 3a0a 2020 2020 2020  te.    ):.      
-0000d740: 2020 2222 2255 7064 6174 6520 616e 2065    """Update an e
-0000d750: 7869 7374 696e 6720 7363 6865 6475 6c65  xisting schedule
-0000d760: 2c20 7265 706c 6163 6520 6974 2077 6974  , replace it wit
-0000d770: 6820 7468 6520 6465 7461 696c 7320 636f  h the details co
-0000d780: 6e74 6169 6e65 6420 696e 2074 6865 2073  ntained in the s
-0000d790: 6368 6564 756c 6520 6f62 6a65 6374 2e22  chedule object."
-0000d7a0: 2222 0a0a 2020 2020 2020 2020 7072 6f6a  ""..        proj
-0000d7b0: 6563 7420 3d20 7072 6f6a 6563 7420 6f72  ect = project or
-0000d7c0: 2063 6f6e 6669 672e 6465 6661 756c 745f   config.default_
-0000d7d0: 7072 6f6a 6563 740a 2020 2020 2020 2020  project.        
-0000d7e0: 7061 7468 203d 2066 2270 726f 6a65 6374  path = f"project
-0000d7f0: 732f 7b70 726f 6a65 6374 7d2f 7363 6865  s/{project}/sche
-0000d800: 6475 6c65 732f 7b6e 616d 657d 220a 0a20  dules/{name}".. 
-0000d810: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
-0000d820: 7361 6765 203d 2066 2246 6169 6c65 6420  sage = f"Failed 
-0000d830: 7570 6461 7469 6e67 2073 6368 6564 756c  updating schedul
-0000d840: 6520 7b70 726f 6a65 6374 7d2f 7b6e 616d  e {project}/{nam
-0000d850: 657d 220a 2020 2020 2020 2020 7365 6c66  e}".        self
-0000d860: 2e61 7069 5f63 616c 6c28 2250 5554 222c  .api_call("PUT",
-0000d870: 2070 6174 682c 2065 7272 6f72 5f6d 6573   path, error_mes
-0000d880: 7361 6765 2c20 626f 6479 3d64 6963 745f  sage, body=dict_
-0000d890: 746f 5f6a 736f 6e28 7363 6865 6475 6c65  to_json(schedule
-0000d8a0: 2e64 6963 7428 2929 290a 0a20 2020 2064  .dict()))..    d
-0000d8b0: 6566 2067 6574 5f73 6368 6564 756c 6528  ef get_schedule(
-0000d8c0: 0a20 2020 2020 2020 2073 656c 662c 2070  .        self, p
-0000d8d0: 726f 6a65 6374 3a20 7374 722c 206e 616d  roject: str, nam
-0000d8e0: 653a 2073 7472 2c20 696e 636c 7564 655f  e: str, include_
-0000d8f0: 6c61 7374 5f72 756e 3a20 626f 6f6c 203d  last_run: bool =
-0000d900: 2046 616c 7365 0a20 2020 2029 202d 3e20   False.    ) -> 
-0000d910: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-0000d920: 656d 6173 2e53 6368 6564 756c 654f 7574  emas.ScheduleOut
-0000d930: 7075 743a 0a20 2020 2020 2020 2022 2222  put:.        """
-0000d940: 5265 7472 6965 7665 2064 6574 6169 6c73  Retrieve details
-0000d950: 206f 6620 7468 6520 7363 6865 6475 6c65   of the schedule
-0000d960: 2069 6e20 7175 6573 7469 6f6e 2e20 4265   in question. Be
-0000d970: 7369 6465 7320 7265 7475 726e 696e 6720  sides returning 
-0000d980: 7468 6520 6465 7461 696c 7320 6f66 2074  the details of t
-0000d990: 6865 2073 6368 6564 756c 6520 6f62 6a65  he schedule obje
-0000d9a0: 6374 2069 7473 656c 662c 0a20 2020 2020  ct itself,.     
-0000d9b0: 2020 2074 6869 7320 6675 6e63 7469 6f6e     this function
-0000d9c0: 2061 6c73 6f20 7265 7475 726e 7320 7468   also returns th
-0000d9d0: 6520 6e65 7874 2073 6368 6564 756c 6564  e next scheduled
-0000d9e0: 2072 756e 2066 6f72 2074 6869 7320 7370   run for this sp
-0000d9f0: 6563 6966 6963 2073 6368 6564 756c 652c  ecific schedule,
-0000da00: 2061 7320 7765 6c6c 2061 7320 706f 7465   as well as pote
-0000da10: 6e74 6961 6c6c 7920 7468 650a 2020 2020  ntially the.    
-0000da20: 2020 2020 7265 7375 6c74 7320 6f66 2074      results of t
-0000da30: 6865 206c 6173 7420 7275 6e20 6578 6563  he last run exec
-0000da40: 7574 6564 2074 6872 6f75 6768 2074 6869  uted through thi
-0000da50: 7320 7363 6865 6475 6c65 2e0a 0a20 2020  s schedule...   
-0000da60: 2020 2020 203a 7061 7261 6d20 7072 6f6a       :param proj
-0000da70: 6563 743a 2050 726f 6a65 6374 206e 616d  ect: Project nam
-0000da80: 652e 0a20 2020 2020 2020 203a 7061 7261  e..        :para
-0000da90: 6d20 6e61 6d65 3a20 4e61 6d65 206f 6620  m name: Name of 
-0000daa0: 7468 6520 7363 6865 6475 6c65 206f 626a  the schedule obj
-0000dab0: 6563 7420 746f 2071 7565 7279 2e0a 2020  ect to query..  
-0000dac0: 2020 2020 2020 3a70 6172 616d 2069 6e63        :param inc
-0000dad0: 6c75 6465 5f6c 6173 745f 7275 6e3a 2057  lude_last_run: W
-0000dae0: 6865 7468 6572 2074 6f20 696e 636c 7564  hether to includ
-0000daf0: 6520 7468 6520 7265 7375 6c74 7320 6f66  e the results of
-0000db00: 2074 6865 2073 6368 6564 756c 6527 7320   the schedule's 
-0000db10: 6c61 7374 2072 756e 2069 6e20 7468 6520  last run in the 
-0000db20: 7265 7370 6f6e 7365 2e0a 2020 2020 2020  response..      
-0000db30: 2020 2222 220a 0a20 2020 2020 2020 2070    """..        p
-0000db40: 726f 6a65 6374 203d 2070 726f 6a65 6374  roject = project
-0000db50: 206f 7220 636f 6e66 6967 2e64 6566 6175   or config.defau
-0000db60: 6c74 5f70 726f 6a65 6374 0a20 2020 2020  lt_project.     
-0000db70: 2020 2070 6174 6820 3d20 6622 7072 6f6a     path = f"proj
-0000db80: 6563 7473 2f7b 7072 6f6a 6563 747d 2f73  ects/{project}/s
-0000db90: 6368 6564 756c 6573 2f7b 6e61 6d65 7d22  chedules/{name}"
-0000dba0: 0a20 2020 2020 2020 2065 7272 6f72 5f6d  .        error_m
-0000dbb0: 6573 7361 6765 203d 2066 2246 6169 6c65  essage = f"Faile
-0000dbc0: 6420 6765 7474 696e 6720 7363 6865 6475  d getting schedu
-0000dbd0: 6c65 2066 6f72 207b 7072 6f6a 6563 747d  le for {project}
-0000dbe0: 2f7b 6e61 6d65 7d22 0a20 2020 2020 2020  /{name}".       
-0000dbf0: 2072 6573 7020 3d20 7365 6c66 2e61 7069   resp = self.api
-0000dc00: 5f63 616c 6c28 0a20 2020 2020 2020 2020  _call(.         
-0000dc10: 2020 2022 4745 5422 2c20 7061 7468 2c20     "GET", path, 
-0000dc20: 6572 726f 725f 6d65 7373 6167 652c 2070  error_message, p
-0000dc30: 6172 616d 733d 7b22 696e 636c 7564 655f  arams={"include_
-0000dc40: 6c61 7374 5f72 756e 223a 2069 6e63 6c75  last_run": inclu
-0000dc50: 6465 5f6c 6173 745f 7275 6e7d 0a20 2020  de_last_run}.   
-0000dc60: 2020 2020 2029 0a20 2020 2020 2020 2072       ).        r
-0000dc70: 6574 7572 6e20 6d6c 7275 6e2e 636f 6d6d  eturn mlrun.comm
-0000dc80: 6f6e 2e73 6368 656d 6173 2e53 6368 6564  on.schemas.Sched
-0000dc90: 756c 654f 7574 7075 7428 2a2a 7265 7370  uleOutput(**resp
-0000dca0: 2e6a 736f 6e28 2929 0a0a 2020 2020 6465  .json())..    de
-0000dcb0: 6620 6c69 7374 5f73 6368 6564 756c 6573  f list_schedules
-0000dcc0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-0000dcd0: 2020 2020 2020 2020 7072 6f6a 6563 743a          project:
-0000dce0: 2073 7472 2c0a 2020 2020 2020 2020 6e61   str,.        na
-0000dcf0: 6d65 3a20 7374 7220 3d20 4e6f 6e65 2c0a  me: str = None,.
-0000dd00: 2020 2020 2020 2020 6b69 6e64 3a20 6d6c          kind: ml
-0000dd10: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
-0000dd20: 6173 2e53 6368 6564 756c 654b 696e 6473  as.ScheduleKinds
-0000dd30: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-0000dd40: 2069 6e63 6c75 6465 5f6c 6173 745f 7275   include_last_ru
-0000dd50: 6e3a 2062 6f6f 6c20 3d20 4661 6c73 652c  n: bool = False,
-0000dd60: 0a20 2020 2029 202d 3e20 6d6c 7275 6e2e  .    ) -> mlrun.
-0000dd70: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e53  common.schemas.S
-0000dd80: 6368 6564 756c 6573 4f75 7470 7574 3a0a  chedulesOutput:.
-0000dd90: 2020 2020 2020 2020 2222 2252 6574 7269          """Retri
-0000dda0: 6576 6520 6c69 7374 206f 6620 7363 6865  eve list of sche
-0000ddb0: 6475 6c65 7320 6f66 2073 7065 6369 6669  dules of specifi
-0000ddc0: 6320 6e61 6d65 206f 7220 6b69 6e64 2e0a  c name or kind..
-0000ddd0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0000dde0: 7072 6f6a 6563 743a 2050 726f 6a65 6374  project: Project
-0000ddf0: 206e 616d 652e 0a20 2020 2020 2020 203a   name..        :
-0000de00: 7061 7261 6d20 6e61 6d65 3a20 4e61 6d65  param name: Name
-0000de10: 206f 6620 7363 6865 6475 6c65 2074 6f20   of schedule to 
-0000de20: 7265 7472 6965 7665 2e20 4361 6e20 6265  retrieve. Can be
-0000de30: 206f 6d69 7474 6564 2074 6f20 6c69 7374   omitted to list
-0000de40: 2061 6c6c 2073 6368 6564 756c 6573 2e0a   all schedules..
-0000de50: 2020 2020 2020 2020 3a70 6172 616d 206b          :param k
-0000de60: 696e 643a 204b 696e 6420 6f66 2073 6368  ind: Kind of sch
-0000de70: 6564 756c 6520 6f62 6a65 6374 7320 746f  edule objects to
-0000de80: 2072 6574 7269 6576 652c 2063 616e 2062   retrieve, can b
-0000de90: 6520 6569 7468 6572 2060 606a 6f62 6060  e either ``job``
-0000dea0: 206f 7220 6060 7069 7065 6c69 6e65 6060   or ``pipeline``
-0000deb0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-0000dec0: 2069 6e63 6c75 6465 5f6c 6173 745f 7275   include_last_ru
-0000ded0: 6e3a 2057 6865 7468 6572 2074 6f20 7265  n: Whether to re
-0000dee0: 7475 726e 2066 6f72 2065 6163 6820 7363  turn for each sc
-0000def0: 6865 6475 6c65 2072 6574 7572 6e65 6420  hedule returned 
-0000df00: 616c 736f 2074 6865 2072 6573 756c 7473  also the results
-0000df10: 206f 6620 7468 6520 6c61 7374 2072 756e   of the last run
-0000df20: 206f 660a 2020 2020 2020 2020 2020 2020   of.            
-0000df30: 7468 6174 2073 6368 6564 756c 652e 0a20  that schedule.. 
-0000df40: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
-0000df50: 2020 2020 7072 6f6a 6563 7420 3d20 7072      project = pr
-0000df60: 6f6a 6563 7420 6f72 2063 6f6e 6669 672e  oject or config.
-0000df70: 6465 6661 756c 745f 7072 6f6a 6563 740a  default_project.
-0000df80: 2020 2020 2020 2020 7061 7261 6d73 203d          params =
-0000df90: 207b 226b 696e 6422 3a20 6b69 6e64 2c20   {"kind": kind, 
-0000dfa0: 226e 616d 6522 3a20 6e61 6d65 2c20 2269  "name": name, "i
-0000dfb0: 6e63 6c75 6465 5f6c 6173 745f 7275 6e22  nclude_last_run"
-0000dfc0: 3a20 696e 636c 7564 655f 6c61 7374 5f72  : include_last_r
-0000dfd0: 756e 7d0a 2020 2020 2020 2020 7061 7468  un}.        path
-0000dfe0: 203d 2066 2270 726f 6a65 6374 732f 7b70   = f"projects/{p
-0000dff0: 726f 6a65 6374 7d2f 7363 6865 6475 6c65  roject}/schedule
-0000e000: 7322 0a20 2020 2020 2020 2065 7272 6f72  s".        error
-0000e010: 5f6d 6573 7361 6765 203d 2066 2246 6169  _message = f"Fai
-0000e020: 6c65 6420 6c69 7374 696e 6720 7363 6865  led listing sche
-0000e030: 6475 6c65 7320 666f 7220 7b70 726f 6a65  dules for {proje
-0000e040: 6374 7d20 3f20 7b6b 696e 647d 207b 6e61  ct} ? {kind} {na
-0000e050: 6d65 7d22 0a20 2020 2020 2020 2072 6573  me}".        res
-0000e060: 7020 3d20 7365 6c66 2e61 7069 5f63 616c  p = self.api_cal
-0000e070: 6c28 2247 4554 222c 2070 6174 682c 2065  l("GET", path, e
-0000e080: 7272 6f72 5f6d 6573 7361 6765 2c20 7061  rror_message, pa
-0000e090: 7261 6d73 3d70 6172 616d 7329 0a20 2020  rams=params).   
-0000e0a0: 2020 2020 2072 6574 7572 6e20 6d6c 7275       return mlru
-0000e0b0: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
-0000e0c0: 2e53 6368 6564 756c 6573 4f75 7470 7574  .SchedulesOutput
-0000e0d0: 282a 2a72 6573 702e 6a73 6f6e 2829 290a  (**resp.json()).
-0000e0e0: 0a20 2020 2064 6566 2064 656c 6574 655f  .    def delete_
-0000e0f0: 7363 6865 6475 6c65 2873 656c 662c 2070  schedule(self, p
-0000e100: 726f 6a65 6374 3a20 7374 722c 206e 616d  roject: str, nam
-0000e110: 653a 2073 7472 293a 0a20 2020 2020 2020  e: str):.       
-0000e120: 2022 2222 4465 6c65 7465 2061 2073 7065   """Delete a spe
-0000e130: 6369 6669 6320 7363 6865 6475 6c65 2062  cific schedule b
-0000e140: 7920 6e61 6d65 2e22 2222 0a0a 2020 2020  y name."""..    
-0000e150: 2020 2020 7072 6f6a 6563 7420 3d20 7072      project = pr
-0000e160: 6f6a 6563 7420 6f72 2063 6f6e 6669 672e  oject or config.
-0000e170: 6465 6661 756c 745f 7072 6f6a 6563 740a  default_project.
-0000e180: 2020 2020 2020 2020 7061 7468 203d 2066          path = f
-0000e190: 2270 726f 6a65 6374 732f 7b70 726f 6a65  "projects/{proje
-0000e1a0: 6374 7d2f 7363 6865 6475 6c65 732f 7b6e  ct}/schedules/{n
-0000e1b0: 616d 657d 220a 2020 2020 2020 2020 6572  ame}".        er
-0000e1c0: 726f 725f 6d65 7373 6167 6520 3d20 6622  ror_message = f"
-0000e1d0: 4661 696c 6564 2064 656c 6574 696e 6720  Failed deleting 
-0000e1e0: 7363 6865 6475 6c65 207b 7072 6f6a 6563  schedule {projec
-0000e1f0: 747d 2f7b 6e61 6d65 7d22 0a20 2020 2020  t}/{name}".     
-0000e200: 2020 2073 656c 662e 6170 695f 6361 6c6c     self.api_call
-0000e210: 2822 4445 4c45 5445 222c 2070 6174 682c  ("DELETE", path,
-0000e220: 2065 7272 6f72 5f6d 6573 7361 6765 290a   error_message).
-0000e230: 0a20 2020 2064 6566 2069 6e76 6f6b 655f  .    def invoke_
-0000e240: 7363 6865 6475 6c65 2873 656c 662c 2070  schedule(self, p
-0000e250: 726f 6a65 6374 3a20 7374 722c 206e 616d  roject: str, nam
-0000e260: 653a 2073 7472 293a 0a20 2020 2020 2020  e: str):.       
-0000e270: 2022 2222 4578 6563 7574 6520 7468 6520   """Execute the 
-0000e280: 6f62 6a65 6374 2072 6566 6572 656e 6365  object reference
-0000e290: 6420 6279 2074 6865 2073 6368 6564 756c  d by the schedul
-0000e2a0: 6520 696d 6d65 6469 6174 656c 792e 2222  e immediately.""
-0000e2b0: 220a 0a20 2020 2020 2020 2070 726f 6a65  "..        proje
-0000e2c0: 6374 203d 2070 726f 6a65 6374 206f 7220  ct = project or 
-0000e2d0: 636f 6e66 6967 2e64 6566 6175 6c74 5f70  config.default_p
-0000e2e0: 726f 6a65 6374 0a20 2020 2020 2020 2070  roject.        p
-0000e2f0: 6174 6820 3d20 6622 7072 6f6a 6563 7473  ath = f"projects
-0000e300: 2f7b 7072 6f6a 6563 747d 2f73 6368 6564  /{project}/sched
-0000e310: 756c 6573 2f7b 6e61 6d65 7d2f 696e 766f  ules/{name}/invo
-0000e320: 6b65 220a 2020 2020 2020 2020 6572 726f  ke".        erro
-0000e330: 725f 6d65 7373 6167 6520 3d20 6622 4661  r_message = f"Fa
-0000e340: 696c 6564 2069 6e76 6f6b 696e 6720 7363  iled invoking sc
-0000e350: 6865 6475 6c65 207b 7072 6f6a 6563 747d  hedule {project}
-0000e360: 2f7b 6e61 6d65 7d22 0a20 2020 2020 2020  /{name}".       
-0000e370: 2073 656c 662e 6170 695f 6361 6c6c 2822   self.api_call("
-0000e380: 504f 5354 222c 2070 6174 682c 2065 7272  POST", path, err
-0000e390: 6f72 5f6d 6573 7361 6765 290a 0a20 2020  or_message)..   
-0000e3a0: 2064 6566 2072 656d 6f74 655f 6275 696c   def remote_buil
-0000e3b0: 6465 7228 0a20 2020 2020 2020 2073 656c  der(.        sel
-0000e3c0: 662c 0a20 2020 2020 2020 2066 756e 633a  f,.        func:
-0000e3d0: 2042 6173 6552 756e 7469 6d65 2c0a 2020   BaseRuntime,.  
-0000e3e0: 2020 2020 2020 7769 7468 5f6d 6c72 756e        with_mlrun
-0000e3f0: 3a20 626f 6f6c 2c0a 2020 2020 2020 2020  : bool,.        
-0000e400: 6d6c 7275 6e5f 7665 7273 696f 6e5f 7370  mlrun_version_sp
-0000e410: 6563 6966 6965 723a 204f 7074 696f 6e61  ecifier: Optiona
-0000e420: 6c5b 7374 725d 203d 204e 6f6e 652c 0a20  l[str] = None,. 
-0000e430: 2020 2020 2020 2073 6b69 705f 6465 706c         skip_depl
-0000e440: 6f79 6564 3a20 626f 6f6c 203d 2046 616c  oyed: bool = Fal
-0000e450: 7365 2c0a 2020 2020 2020 2020 6275 696c  se,.        buil
-0000e460: 6465 725f 656e 763a 204f 7074 696f 6e61  der_env: Optiona
-0000e470: 6c5b 6469 6374 5d20 3d20 4e6f 6e65 2c0a  l[dict] = None,.
-0000e480: 2020 2020 2020 2020 666f 7263 655f 6275          force_bu
-0000e490: 696c 643a 2062 6f6f 6c20 3d20 4661 6c73  ild: bool = Fals
-0000e4a0: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
-0000e4b0: 2020 2222 2242 7569 6c64 2074 6865 2070    """Build the p
-0000e4c0: 6f64 2069 6d61 6765 2066 6f72 2061 2066  od image for a f
-0000e4d0: 756e 6374 696f 6e2c 2066 6f72 2065 7865  unction, for exe
-0000e4e0: 6375 7469 6f6e 206f 6e20 6120 7265 6d6f  cution on a remo
-0000e4f0: 7465 2063 6c75 7374 6572 2e20 5468 6973  te cluster. This
-0000e500: 2069 7320 6578 6563 7574 6564 2062 7920   is executed by 
-0000e510: 7468 6520 4d4c 5275 6e0a 2020 2020 2020  the MLRun.      
-0000e520: 2020 4150 4920 7365 7276 6572 2c20 616e    API server, an
-0000e530: 6420 6372 6561 7465 7320 6120 446f 636b  d creates a Dock
-0000e540: 6572 2069 6d61 6765 206f 7574 206f 6620  er image out of 
-0000e550: 7468 6520 6675 6e63 7469 6f6e 2070 726f  the function pro
-0000e560: 7669 6465 6420 616e 6420 616e 7920 7370  vided and any sp
-0000e570: 6563 6966 6963 2062 7569 6c64 0a20 2020  ecific build.   
-0000e580: 2020 2020 2069 6e73 7472 7563 7469 6f6e       instruction
-0000e590: 7320 7072 6f76 6964 6564 2077 6974 6869  s provided withi
-0000e5a0: 6e2e 2054 6869 7320 6973 2061 2070 7265  n. This is a pre
-0000e5b0: 2d72 6571 7569 7369 7465 2066 6f72 2072  -requisite for r
-0000e5c0: 656d 6f74 656c 7920 6578 6563 7574 696e  emotely executin
-0000e5d0: 6720 6120 6675 6e63 7469 6f6e 2c20 756e  g a function, un
-0000e5e0: 6c65 7373 2075 7369 6e67 0a20 2020 2020  less using.     
-0000e5f0: 2020 2061 2070 7265 2d64 6570 6c6f 7965     a pre-deploye
-0000e600: 6420 696d 6167 652e 0a0a 2020 2020 2020  d image...      
-0000e610: 2020 3a70 6172 616d 2066 756e 633a 2046    :param func: F
-0000e620: 756e 6374 696f 6e20 746f 2062 7569 6c64  unction to build
-0000e630: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-0000e640: 2077 6974 685f 6d6c 7275 6e3a 2057 6865   with_mlrun: Whe
-0000e650: 7468 6572 2074 6f20 6164 6420 4d4c 5275  ther to add MLRu
-0000e660: 6e20 7061 636b 6167 6520 746f 2074 6865  n package to the
-0000e670: 2062 7569 6c74 2070 6163 6b61 6765 2e20   built package. 
-0000e680: 5468 6973 2069 7320 6e6f 7420 7265 7175  This is not requ
-0000e690: 6972 6564 2069 6620 7573 696e 6720 6120  ired if using a 
-0000e6a0: 6261 7365 0a20 2020 2020 2020 2020 2020  base.           
-0000e6b0: 2069 6d61 6765 2074 6861 7420 616c 7265   image that alre
-0000e6c0: 6164 7920 6861 7320 4d4c 5275 6e20 696e  ady has MLRun in
-0000e6d0: 2069 742e 0a20 2020 2020 2020 203a 7061   it..        :pa
-0000e6e0: 7261 6d20 6d6c 7275 6e5f 7665 7273 696f  ram mlrun_versio
-0000e6f0: 6e5f 7370 6563 6966 6965 723a 2056 6572  n_specifier: Ver
-0000e700: 7369 6f6e 206f 6620 4d4c 5275 6e20 746f  sion of MLRun to
-0000e710: 2069 6e63 6c75 6465 2069 6e20 7468 6520   include in the 
-0000e720: 6275 696c 7420 696d 6167 652e 0a20 2020  built image..   
-0000e730: 2020 2020 203a 7061 7261 6d20 736b 6970       :param skip
-0000e740: 5f64 6570 6c6f 7965 643a 2053 6b69 7020  _deployed: Skip 
-0000e750: 7468 6520 6275 696c 6420 6966 2077 6520  the build if we 
-0000e760: 616c 7265 6164 7920 6861 7665 2061 6e20  already have an 
-0000e770: 696d 6167 6520 666f 7220 7468 6520 6675  image for the fu
-0000e780: 6e63 7469 6f6e 2e0a 2020 2020 2020 2020  nction..        
-0000e790: 3a70 6172 616d 2062 7569 6c64 6572 5f65  :param builder_e
-0000e7a0: 6e76 3a20 2020 4b61 6e69 6b6f 2062 7569  nv:   Kaniko bui
-0000e7b0: 6c64 6572 2070 6f64 2065 6e76 2076 6172  lder pod env var
-0000e7c0: 7320 6469 6374 2028 666f 7220 636f 6e66  s dict (for conf
-0000e7d0: 6967 2f63 7265 6465 6e74 6961 6c73 290a  ig/credentials).
-0000e7e0: 2020 2020 2020 2020 3a70 6172 616d 2066          :param f
-0000e7f0: 6f72 6365 5f62 7569 6c64 3a20 2020 466f  orce_build:   Fo
-0000e800: 7263 6520 6275 696c 6469 6e67 2074 6865  rce building the
-0000e810: 2069 6d61 6765 2c20 6576 656e 2077 6865   image, even whe
-0000e820: 6e20 6e6f 2063 6861 6e67 6573 2077 6572  n no changes wer
-0000e830: 6520 6d61 6465 0a20 2020 2020 2020 2022  e made.        "
-0000e840: 2222 0a20 2020 2020 2020 2069 735f 7333  "".        is_s3
-0000e850: 5f73 6f75 7263 6520 3d20 6675 6e63 2e73  _source = func.s
-0000e860: 7065 632e 6275 696c 642e 736f 7572 6365  pec.build.source
-0000e870: 2061 6e64 2066 756e 632e 7370 6563 2e62   and func.spec.b
-0000e880: 7569 6c64 2e73 6f75 7263 652e 7374 6172  uild.source.star
-0000e890: 7473 7769 7468 280a 2020 2020 2020 2020  tswith(.        
-0000e8a0: 2020 2020 2273 333a 2f2f 220a 2020 2020      "s3://".    
-0000e8b0: 2020 2020 290a 2020 2020 2020 2020 6973      ).        is
-0000e8c0: 5f65 6372 5f69 6d61 6765 203d 206d 6c72  _ecr_image = mlr
-0000e8d0: 756e 2e75 7469 6c73 2e69 735f 6563 725f  un.utils.is_ecr_
-0000e8e0: 7572 6c28 636f 6e66 6967 2e68 7474 7064  url(config.httpd
-0000e8f0: 622e 6275 696c 6465 722e 646f 636b 6572  b.builder.docker
-0000e900: 5f72 6567 6973 7472 7929 0a20 2020 2020  _registry).     
-0000e910: 2020 2069 6620 6e6f 7420 6675 6e63 2e73     if not func.s
-0000e920: 7065 632e 6275 696c 642e 6c6f 6164 5f73  pec.build.load_s
-0000e930: 6f75 7263 655f 6f6e 5f72 756e 2061 6e64  ource_on_run and
-0000e940: 2069 735f 7333 5f73 6f75 7263 6520 616e   is_s3_source an
-0000e950: 6420 6973 5f65 6372 5f69 6d61 6765 3a0a  d is_ecr_image:.
-0000e960: 2020 2020 2020 2020 2020 2020 6c6f 6767              logg
-0000e970: 6572 2e77 6172 6e69 6e67 280a 2020 2020  er.warning(.    
-0000e980: 2020 2020 2020 2020 2020 2020 2242 7569              "Bui
-0000e990: 6c64 696e 6720 6120 6675 6e63 7469 6f6e  lding a function
-0000e9a0: 2069 6d61 6765 2074 6f20 4543 5220 616e   image to ECR an
-0000e9b0: 6420 6c6f 6164 696e 6720 616e 2053 3320  d loading an S3 
-0000e9c0: 736f 7572 6365 2074 6f20 7468 6520 696d  source to the im
-0000e9d0: 6167 6520 6d61 7920 7265 7175 6972 6520  age may require 
-0000e9e0: 636f 6e66 6c69 6374 696e 6720 6163 6365  conflicting acce
-0000e9f0: 7373 2022 0a20 2020 2020 2020 2020 2020  ss ".           
-0000ea00: 2020 2020 2022 6b65 7973 2e20 4f6e 6c79       "keys. Only
-0000ea10: 2074 6865 2070 6572 6d69 7373 696f 6e73   the permissions
-0000ea20: 2067 7261 6e74 6564 2074 6f20 7468 6520   granted to the 
-0000ea30: 706c 6174 666f 726d 2773 2063 6f6e 6669  platform's confi
-0000ea40: 6775 7265 6420 7365 6372 6574 2077 696c  gured secret wil
-0000ea50: 6c20 7461 6b65 2061 6666 6563 7420 220a  l take affect ".
-0000ea60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ea70: 2228 7365 6520 6d6c 7275 6e2e 636f 6e66  "(see mlrun.conf
-0000ea80: 6967 2e63 6f6e 6669 672e 6874 7470 6462  ig.config.httpdb
-0000ea90: 2e62 7569 6c64 6572 2e64 6f63 6b65 725f  .builder.docker_
-0000eaa0: 7265 6769 7374 7279 5f73 6563 7265 7429  registry_secret)
-0000eab0: 2e20 220a 2020 2020 2020 2020 2020 2020  . ".            
-0000eac0: 2020 2020 2249 6e20 6361 7365 2074 6865      "In case the
-0000ead0: 2070 6572 6d69 7373 696f 6e73 2061 7265   permissions are
-0000eae0: 206c 696d 6974 6564 2074 6f20 4543 5220   limited to ECR 
-0000eaf0: 7363 6f70 652c 2079 6f75 206d 6179 2075  scope, you may u
-0000eb00: 7365 2070 756c 6c5f 6174 5f72 756e 7469  se pull_at_runti
-0000eb10: 6d65 3d54 7275 6520 696e 7374 6561 6422  me=True instead"
-0000eb20: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000eb30: 2020 736f 7572 6365 3d66 756e 632e 7370    source=func.sp
-0000eb40: 6563 2e62 7569 6c64 2e73 6f75 7263 652c  ec.build.source,
-0000eb50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000eb60: 206c 6f61 645f 736f 7572 6365 5f6f 6e5f   load_source_on_
-0000eb70: 7275 6e3d 6675 6e63 2e73 7065 632e 6275  run=func.spec.bu
-0000eb80: 696c 642e 6c6f 6164 5f73 6f75 7263 655f  ild.load_source_
-0000eb90: 6f6e 5f72 756e 2c0a 2020 2020 2020 2020  on_run,.        
-0000eba0: 2020 2020 2020 2020 6465 6661 756c 745f          default_
-0000ebb0: 646f 636b 6572 5f72 6567 6973 7472 793d  docker_registry=
-0000ebc0: 636f 6e66 6967 2e68 7474 7064 622e 6275  config.httpdb.bu
-0000ebd0: 696c 6465 722e 646f 636b 6572 5f72 6567  ilder.docker_reg
-0000ebe0: 6973 7472 792c 0a20 2020 2020 2020 2020  istry,.         
-0000ebf0: 2020 2029 0a0a 2020 2020 2020 2020 7472     )..        tr
-0000ec00: 793a 0a20 2020 2020 2020 2020 2020 2072  y:.            r
-0000ec10: 6571 203d 207b 0a20 2020 2020 2020 2020  eq = {.         
-0000ec20: 2020 2020 2020 2022 6675 6e63 7469 6f6e         "function
-0000ec30: 223a 2066 756e 632e 746f 5f64 6963 7428  ": func.to_dict(
-0000ec40: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-0000ec50: 2020 2022 7769 7468 5f6d 6c72 756e 223a     "with_mlrun":
-0000ec60: 2062 6f6f 6c32 7374 7228 7769 7468 5f6d   bool2str(with_m
-0000ec70: 6c72 756e 292c 0a20 2020 2020 2020 2020  lrun),.         
-0000ec80: 2020 2020 2020 2022 736b 6970 5f64 6570         "skip_dep
-0000ec90: 6c6f 7965 6422 3a20 736b 6970 5f64 6570  loyed": skip_dep
-0000eca0: 6c6f 7965 642c 0a20 2020 2020 2020 2020  loyed,.         
-0000ecb0: 2020 2020 2020 2022 666f 7263 655f 6275         "force_bu
-0000ecc0: 696c 6422 3a20 666f 7263 655f 6275 696c  ild": force_buil
-0000ecd0: 642c 0a20 2020 2020 2020 2020 2020 207d  d,.            }
-0000ece0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0000ecf0: 6d6c 7275 6e5f 7665 7273 696f 6e5f 7370  mlrun_version_sp
-0000ed00: 6563 6966 6965 723a 0a20 2020 2020 2020  ecifier:.       
-0000ed10: 2020 2020 2020 2020 2072 6571 5b22 6d6c           req["ml
-0000ed20: 7275 6e5f 7665 7273 696f 6e5f 7370 6563  run_version_spec
-0000ed30: 6966 6965 7222 5d20 3d20 6d6c 7275 6e5f  ifier"] = mlrun_
-0000ed40: 7665 7273 696f 6e5f 7370 6563 6966 6965  version_specifie
-0000ed50: 720a 2020 2020 2020 2020 2020 2020 6966  r.            if
-0000ed60: 2062 7569 6c64 6572 5f65 6e76 3a0a 2020   builder_env:.  
-0000ed70: 2020 2020 2020 2020 2020 2020 2020 7265                re
-0000ed80: 715b 2262 7569 6c64 6572 5f65 6e76 225d  q["builder_env"]
-0000ed90: 203d 2062 7569 6c64 6572 5f65 6e76 0a20   = builder_env. 
-0000eda0: 2020 2020 2020 2020 2020 2072 6573 7020             resp 
-0000edb0: 3d20 7365 6c66 2e61 7069 5f63 616c 6c28  = self.api_call(
-0000edc0: 2250 4f53 5422 2c20 2262 7569 6c64 2f66  "POST", "build/f
-0000edd0: 756e 6374 696f 6e22 2c20 6a73 6f6e 3d72  unction", json=r
-0000ede0: 6571 290a 2020 2020 2020 2020 6578 6365  eq).        exce
-0000edf0: 7074 204f 5345 7272 6f72 2061 7320 6572  pt OSError as er
-0000ee00: 723a 0a20 2020 2020 2020 2020 2020 206c  r:.            l
-0000ee10: 6f67 6765 722e 6572 726f 7228 6622 6572  ogger.error(f"er
-0000ee20: 726f 7220 7375 626d 6974 7469 6e67 2062  ror submitting b
-0000ee30: 7569 6c64 2074 6173 6b3a 207b 6572 725f  uild task: {err_
-0000ee40: 746f 5f73 7472 2865 7272 297d 2229 0a20  to_str(err)}"). 
-0000ee50: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0000ee60: 204f 5345 7272 6f72 2866 2265 7272 6f72   OSError(f"error
-0000ee70: 3a20 6361 6e6e 6f74 2073 7562 6d69 7420  : cannot submit 
-0000ee80: 6275 696c 642c 207b 6572 725f 746f 5f73  build, {err_to_s
-0000ee90: 7472 2865 7272 297d 2229 0a0a 2020 2020  tr(err)}")..    
-0000eea0: 2020 2020 6966 206e 6f74 2072 6573 702e      if not resp.
-0000eeb0: 6f6b 3a0a 2020 2020 2020 2020 2020 2020  ok:.            
-0000eec0: 6c6f 6767 6572 2e65 7272 6f72 2866 2262  logger.error(f"b
-0000eed0: 6164 2072 6573 7021 215c 6e7b 7265 7370  ad resp!!\n{resp
-0000eee0: 2e74 6578 747d 2229 0a20 2020 2020 2020  .text}").       
-0000eef0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-0000ef00: 4572 726f 7228 2262 6164 2066 756e 6374  Error("bad funct
-0000ef10: 696f 6e20 7275 6e20 7265 7370 6f6e 7365  ion run response
-0000ef20: 2229 0a0a 2020 2020 2020 2020 7265 7475  ")..        retu
-0000ef30: 726e 2072 6573 702e 6a73 6f6e 2829 0a0a  rn resp.json()..
-0000ef40: 2020 2020 6465 6620 6765 745f 6275 696c      def get_buil
-0000ef50: 6465 725f 7374 6174 7573 280a 2020 2020  der_status(.    
-0000ef60: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-0000ef70: 2020 6675 6e63 3a20 4261 7365 5275 6e74    func: BaseRunt
-0000ef80: 696d 652c 0a20 2020 2020 2020 206f 6666  ime,.        off
-0000ef90: 7365 743a 2069 6e74 203d 2030 2c0a 2020  set: int = 0,.  
-0000efa0: 2020 2020 2020 6c6f 6773 3a20 626f 6f6c        logs: bool
-0000efb0: 203d 2054 7275 652c 0a20 2020 2020 2020   = True,.       
-0000efc0: 206c 6173 745f 6c6f 675f 7469 6d65 7374   last_log_timest
-0000efd0: 616d 703a 2066 6c6f 6174 203d 2030 2e30  amp: float = 0.0
-0000efe0: 2c0a 2020 2020 2020 2020 7665 7262 6f73  ,.        verbos
-0000eff0: 653a 2062 6f6f 6c20 3d20 4661 6c73 652c  e: bool = False,
-0000f000: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
-0000f010: 2222 2252 6574 7269 6576 6520 7468 6520  """Retrieve the 
-0000f020: 7374 6174 7573 206f 6620 6120 6275 696c  status of a buil
-0000f030: 6420 6f70 6572 6174 696f 6e20 6375 7272  d operation curr
-0000f040: 656e 746c 7920 696e 2070 726f 6772 6573  ently in progres
-0000f050: 732e 0a0a 2020 2020 2020 2020 3a70 6172  s...        :par
-0000f060: 616d 2066 756e 633a 2020 2020 2020 2020  am func:        
-0000f070: 2020 2020 2020 2020 4675 6e63 7469 6f6e          Function
-0000f080: 206f 626a 6563 7420 7468 6174 2069 7320   object that is 
-0000f090: 6265 696e 6720 6275 696c 742e 0a20 2020  being built..   
-0000f0a0: 2020 2020 203a 7061 7261 6d20 6f66 6673       :param offs
-0000f0b0: 6574 3a20 2020 2020 2020 2020 2020 2020  et:             
-0000f0c0: 204f 6666 7365 7420 696e 746f 2074 6865   Offset into the
-0000f0d0: 2062 7569 6c64 206c 6f67 7320 746f 2072   build logs to r
-0000f0e0: 6574 7269 6576 6520 6c6f 6773 2066 726f  etrieve logs fro
-0000f0f0: 6d2e 0a20 2020 2020 2020 203a 7061 7261  m..        :para
-0000f100: 6d20 6c6f 6773 3a20 2020 2020 2020 2020  m logs:         
-0000f110: 2020 2020 2020 2053 686f 756c 6420 6275         Should bu
-0000f120: 696c 6420 6c6f 6773 2062 6520 7265 7472  ild logs be retr
-0000f130: 6965 7665 642e 0a20 2020 2020 2020 203a  ieved..        :
-0000f140: 7061 7261 6d20 6c61 7374 5f6c 6f67 5f74  param last_log_t
-0000f150: 696d 6573 7461 6d70 3a20 204c 6173 7420  imestamp:  Last 
-0000f160: 7469 6d65 7374 616d 7020 6f66 206c 6f67  timestamp of log
-0000f170: 7320 7468 6174 2077 6572 6520 616c 7265  s that were alre
-0000f180: 6164 7920 7265 7472 6965 7665 642e 2046  ady retrieved. F
-0000f190: 756e 6374 696f 6e20 7769 6c6c 2072 6574  unction will ret
-0000f1a0: 7572 6e20 6f6e 6c79 206c 6f67 730a 2020  urn only logs.  
-0000f1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f1d0: 2020 6c61 7465 7220 7468 616e 2074 6869    later than thi
-0000f1e0: 7320 7061 7261 6d65 7465 722e 0a20 2020  s parameter..   
-0000f1f0: 2020 2020 203a 7061 7261 6d20 7665 7262       :param verb
-0000f200: 6f73 653a 2020 2020 2020 2020 2020 2020  ose:            
-0000f210: 2041 6464 2076 6572 626f 7365 206c 6f67   Add verbose log
-0000f220: 7320 696e 746f 2074 6865 206f 7574 7075  s into the outpu
-0000f230: 742e 0a0a 2020 2020 2020 2020 3a72 6574  t...        :ret
-0000f240: 7572 6e73 3a20 5468 6520 666f 6c6c 6f77  urns: The follow
-0000f250: 696e 6720 7061 7261 6d65 7465 7273 3a0a  ing parameters:.
-0000f260: 0a20 2020 2020 2020 2020 2020 202d 2054  .            - T
-0000f270: 6578 7420 6f66 2062 7569 6c64 6572 206c  ext of builder l
-0000f280: 6f67 732e 0a20 2020 2020 2020 2020 2020  ogs..           
-0000f290: 202d 2054 696d 6573 7461 6d70 206f 6620   - Timestamp of 
-0000f2a0: 6c61 7374 206c 6f67 2072 6574 7269 6576  last log retriev
-0000f2b0: 6564 2c20 746f 2062 6520 7573 6564 2069  ed, to be used i
-0000f2c0: 6e20 7375 6273 6571 7565 6e74 2063 616c  n subsequent cal
-0000f2d0: 6c73 2074 6f20 7468 6973 2066 756e 6374  ls to this funct
-0000f2e0: 696f 6e2e 0a0a 2020 2020 2020 2020 2020  ion...          
-0000f2f0: 2020 5468 6520 6675 6e63 7469 6f6e 2061    The function a
-0000f300: 6c73 6f20 7570 6461 7465 7320 696e 7465  lso updates inte
-0000f310: 726e 616c 206d 656d 6265 7273 206f 6620  rnal members of 
-0000f320: 7468 6520 6060 6675 6e63 6060 206f 626a  the ``func`` obj
-0000f330: 6563 7420 746f 2072 6566 6c65 6374 2062  ect to reflect b
-0000f340: 7569 6c64 2070 726f 6365 7373 2069 6e66  uild process inf
-0000f350: 6f2e 0a20 2020 2020 2020 2022 2222 0a0a  o..        """..
-0000f360: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
-0000f370: 2020 2020 2020 2020 2070 6172 616d 7320           params 
-0000f380: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
-0000f390: 2020 2020 226e 616d 6522 3a20 6e6f 726d      "name": norm
-0000f3a0: 616c 697a 655f 6e61 6d65 2866 756e 632e  alize_name(func.
-0000f3b0: 6d65 7461 6461 7461 2e6e 616d 6529 2c0a  metadata.name),.
-0000f3c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f3d0: 2270 726f 6a65 6374 223a 2066 756e 632e  "project": func.
-0000f3e0: 6d65 7461 6461 7461 2e70 726f 6a65 6374  metadata.project
-0000f3f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000f400: 2020 2274 6167 223a 2066 756e 632e 6d65    "tag": func.me
-0000f410: 7461 6461 7461 2e74 6167 2c0a 2020 2020  tadata.tag,.    
-0000f420: 2020 2020 2020 2020 2020 2020 226c 6f67              "log
-0000f430: 7322 3a20 626f 6f6c 3273 7472 286c 6f67  s": bool2str(log
-0000f440: 7329 2c0a 2020 2020 2020 2020 2020 2020  s),.            
-0000f450: 2020 2020 226f 6666 7365 7422 3a20 7374      "offset": st
-0000f460: 7228 6f66 6673 6574 292c 0a20 2020 2020  r(offset),.     
-0000f470: 2020 2020 2020 2020 2020 2022 6c61 7374             "last
-0000f480: 5f6c 6f67 5f74 696d 6573 7461 6d70 223a  _log_timestamp":
-0000f490: 2073 7472 286c 6173 745f 6c6f 675f 7469   str(last_log_ti
-0000f4a0: 6d65 7374 616d 7029 2c0a 2020 2020 2020  mestamp),.      
-0000f4b0: 2020 2020 2020 2020 2020 2276 6572 626f            "verbo
-0000f4c0: 7365 223a 2062 6f6f 6c32 7374 7228 7665  se": bool2str(ve
-0000f4d0: 7262 6f73 6529 2c0a 2020 2020 2020 2020  rbose),.        
-0000f4e0: 2020 2020 7d0a 2020 2020 2020 2020 2020      }.          
-0000f4f0: 2020 7265 7370 203d 2073 656c 662e 6170    resp = self.ap
-0000f500: 695f 6361 6c6c 2822 4745 5422 2c20 2262  i_call("GET", "b
-0000f510: 7569 6c64 2f73 7461 7475 7322 2c20 7061  uild/status", pa
-0000f520: 7261 6d73 3d70 6172 616d 7329 0a20 2020  rams=params).   
-0000f530: 2020 2020 2065 7863 6570 7420 4f53 4572       except OSEr
-0000f540: 726f 7220 6173 2065 7272 3a0a 2020 2020  ror as err:.    
-0000f550: 2020 2020 2020 2020 6c6f 6767 6572 2e65          logger.e
-0000f560: 7272 6f72 2866 2265 7272 6f72 2067 6574  rror(f"error get
-0000f570: 7469 6e67 2062 7569 6c64 2073 7461 7475  ting build statu
-0000f580: 733a 207b 6572 725f 746f 5f73 7472 2865  s: {err_to_str(e
-0000f590: 7272 297d 2229 0a20 2020 2020 2020 2020  rr)}").         
-0000f5a0: 2020 2072 6169 7365 204f 5345 7272 6f72     raise OSError
-0000f5b0: 2866 2265 7272 6f72 3a20 6361 6e6e 6f74  (f"error: cannot
-0000f5c0: 2067 6574 2062 7569 6c64 2073 7461 7475   get build statu
-0000f5d0: 732c 207b 6572 725f 746f 5f73 7472 2865  s, {err_to_str(e
-0000f5e0: 7272 297d 2229 0a0a 2020 2020 2020 2020  rr)}")..        
-0000f5f0: 6966 206e 6f74 2072 6573 702e 6f6b 3a0a  if not resp.ok:.
-0000f600: 2020 2020 2020 2020 2020 2020 6c6f 6767              logg
-0000f610: 6572 2e77 6172 6e69 6e67 2866 2266 6169  er.warning(f"fai
-0000f620: 6c65 6420 7265 7370 2c20 7b72 6573 702e  led resp, {resp.
-0000f630: 7465 7874 7d22 290a 2020 2020 2020 2020  text}").        
-0000f640: 2020 2020 7261 6973 6520 5275 6e44 4245      raise RunDBE
-0000f650: 7272 6f72 2822 6261 6420 6675 6e63 7469  rror("bad functi
-0000f660: 6f6e 2062 7569 6c64 2072 6573 706f 6e73  on build respons
-0000f670: 6522 290a 0a20 2020 2020 2020 2069 6620  e")..        if 
-0000f680: 7265 7370 2e68 6561 6465 7273 3a0a 2020  resp.headers:.  
-0000f690: 2020 2020 2020 2020 2020 6675 6e63 2e73            func.s
-0000f6a0: 7461 7475 732e 7374 6174 6520 3d20 7265  tatus.state = re
-0000f6b0: 7370 2e68 6561 6465 7273 2e67 6574 2822  sp.headers.get("
-0000f6c0: 782d 6d6c 7275 6e2d 6675 6e63 7469 6f6e  x-mlrun-function
-0000f6d0: 2d73 7461 7475 7322 2c20 2222 290a 2020  -status", "").  
-0000f6e0: 2020 2020 2020 2020 2020 6c61 7374 5f6c            last_l
-0000f6f0: 6f67 5f74 696d 6573 7461 6d70 203d 2066  og_timestamp = f
-0000f700: 6c6f 6174 280a 2020 2020 2020 2020 2020  loat(.          
-0000f710: 2020 2020 2020 7265 7370 2e68 6561 6465        resp.heade
-0000f720: 7273 2e67 6574 2822 782d 6d6c 7275 6e2d  rs.get("x-mlrun-
-0000f730: 6c61 7374 2d74 696d 6573 7461 6d70 222c  last-timestamp",
-0000f740: 2022 302e 3022 290a 2020 2020 2020 2020   "0.0").        
-0000f750: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-0000f760: 2020 6966 2066 756e 632e 6b69 6e64 2069    if func.kind i
-0000f770: 6e20 6d6c 7275 6e2e 7275 6e74 696d 6573  n mlrun.runtimes
-0000f780: 2e52 756e 7469 6d65 4b69 6e64 732e 6e75  .RuntimeKinds.nu
-0000f790: 636c 696f 5f72 756e 7469 6d65 7328 293a  clio_runtimes():
-0000f7a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000f7b0: 2066 756e 632e 7374 6174 7573 2e61 6464   func.status.add
-0000f7c0: 7265 7373 203d 2072 6573 702e 6865 6164  ress = resp.head
-0000f7d0: 6572 732e 6765 7428 2278 2d6d 6c72 756e  ers.get("x-mlrun
-0000f7e0: 2d61 6464 7265 7373 222c 2022 2229 0a20  -address", ""). 
-0000f7f0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0000f800: 756e 632e 7374 6174 7573 2e6e 7563 6c69  unc.status.nucli
-0000f810: 6f5f 6e61 6d65 203d 2072 6573 702e 6865  o_name = resp.he
-0000f820: 6164 6572 732e 6765 7428 2278 2d6d 6c72  aders.get("x-mlr
-0000f830: 756e 2d6e 616d 6522 2c20 2222 290a 2020  un-name", "").  
-0000f840: 2020 2020 2020 2020 2020 2020 2020 6675                fu
-0000f850: 6e63 2e73 7461 7475 732e 696e 7465 726e  nc.status.intern
-0000f860: 616c 5f69 6e76 6f63 6174 696f 6e5f 7572  al_invocation_ur
-0000f870: 6c73 203d 2072 6573 702e 6865 6164 6572  ls = resp.header
-0000f880: 732e 6765 7428 0a20 2020 2020 2020 2020  s.get(.         
-0000f890: 2020 2020 2020 2020 2020 2022 782d 6d6c             "x-ml
-0000f8a0: 7275 6e2d 696e 7465 726e 616c 2d69 6e76  run-internal-inv
-0000f8b0: 6f63 6174 696f 6e2d 7572 6c73 222c 2022  ocation-urls", "
-0000f8c0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-0000f8d0: 2020 292e 7370 6c69 7428 222c 2229 0a20    ).split(","). 
-0000f8e0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0000f8f0: 756e 632e 7374 6174 7573 2e65 7874 6572  unc.status.exter
-0000f900: 6e61 6c5f 696e 766f 6361 7469 6f6e 5f75  nal_invocation_u
-0000f910: 726c 7320 3d20 7265 7370 2e68 6561 6465  rls = resp.heade
-0000f920: 7273 2e67 6574 280a 2020 2020 2020 2020  rs.get(.        
-0000f930: 2020 2020 2020 2020 2020 2020 2278 2d6d              "x-m
-0000f940: 6c72 756e 2d65 7874 6572 6e61 6c2d 696e  lrun-external-in
-0000f950: 766f 6361 7469 6f6e 2d75 726c 7322 2c20  vocation-urls", 
-0000f960: 2222 0a20 2020 2020 2020 2020 2020 2020  "".             
-0000f970: 2020 2029 2e73 706c 6974 2822 2c22 290a     ).split(",").
-0000f980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f990: 6675 6e63 2e73 7461 7475 732e 636f 6e74  func.status.cont
-0000f9a0: 6169 6e65 725f 696d 6167 6520 3d20 7265  ainer_image = re
-0000f9b0: 7370 2e68 6561 6465 7273 2e67 6574 280a  sp.headers.get(.
-0000f9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f9d0: 2020 2020 2278 2d6d 6c72 756e 2d63 6f6e      "x-mlrun-con
-0000f9e0: 7461 696e 6572 2d69 6d61 6765 222c 2022  tainer-image", "
-0000f9f0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-0000fa00: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-0000fa10: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0000fa20: 2020 2020 2020 6675 6e63 2e73 7461 7475        func.statu
-0000fa30: 732e 6275 696c 645f 706f 6420 3d20 7265  s.build_pod = re
-0000fa40: 7370 2e68 6561 6465 7273 2e67 6574 2822  sp.headers.get("
-0000fa50: 6275 696c 6465 725f 706f 6422 2c20 2222  builder_pod", ""
-0000fa60: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0000fa70: 2020 6675 6e63 2e73 7065 632e 696d 6167    func.spec.imag
-0000fa80: 6520 3d20 7265 7370 2e68 6561 6465 7273  e = resp.headers
-0000fa90: 2e67 6574 2822 6675 6e63 7469 6f6e 5f69  .get("function_i
-0000faa0: 6d61 6765 222c 2022 2229 0a0a 2020 2020  mage", "")..    
-0000fab0: 2020 2020 7465 7874 203d 2022 220a 2020      text = "".  
-0000fac0: 2020 2020 2020 6966 2072 6573 702e 636f        if resp.co
-0000fad0: 6e74 656e 743a 0a20 2020 2020 2020 2020  ntent:.         
-0000fae0: 2020 2074 6578 7420 3d20 7265 7370 2e63     text = resp.c
-0000faf0: 6f6e 7465 6e74 2e64 6563 6f64 6528 290a  ontent.decode().
-0000fb00: 2020 2020 2020 2020 7265 7475 726e 2074          return t
-0000fb10: 6578 742c 206c 6173 745f 6c6f 675f 7469  ext, last_log_ti
-0000fb20: 6d65 7374 616d 700a 0a20 2020 2064 6566  mestamp..    def
-0000fb30: 2073 7461 7274 5f66 756e 6374 696f 6e28   start_function(
-0000fb40: 0a20 2020 2020 2020 2073 656c 662c 2066  .        self, f
-0000fb50: 756e 635f 7572 6c3a 2073 7472 203d 204e  unc_url: str = N
-0000fb60: 6f6e 652c 2066 756e 6374 696f 6e3a 2022  one, function: "
-0000fb70: 6d6c 7275 6e2e 7275 6e74 696d 6573 2e42  mlrun.runtimes.B
-0000fb80: 6173 6552 756e 7469 6d65 2220 3d20 4e6f  aseRuntime" = No
-0000fb90: 6e65 0a20 2020 2029 202d 3e20 6d6c 7275  ne.    ) -> mlru
-0000fba0: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
-0000fbb0: 2e42 6163 6b67 726f 756e 6454 6173 6b3a  .BackgroundTask:
-0000fbc0: 0a20 2020 2020 2020 2022 2222 4578 6563  .        """Exec
-0000fbd0: 7574 6520 6120 6675 6e63 7469 6f6e 2072  ute a function r
-0000fbe0: 656d 6f74 656c 792c 2055 7365 6420 666f  emotely, Used fo
-0000fbf0: 7220 6060 6461 736b 6060 2066 756e 6374  r ``dask`` funct
-0000fc00: 696f 6e73 2e0a 0a20 2020 2020 2020 203a  ions...        :
-0000fc10: 7061 7261 6d20 6675 6e63 5f75 726c 3a20  param func_url: 
-0000fc20: 5552 4c20 746f 2074 6865 2066 756e 6374  URL to the funct
-0000fc30: 696f 6e20 746f 2062 6520 6578 6563 7574  ion to be execut
-0000fc40: 6564 2e0a 2020 2020 2020 2020 3a70 6172  ed..        :par
-0000fc50: 616d 2066 756e 6374 696f 6e3a 2054 6865  am function: The
-0000fc60: 2066 756e 6374 696f 6e20 6f62 6a65 6374   function object
-0000fc70: 2074 6f20 7374 6172 742c 206e 6f74 206e   to start, not n
-0000fc80: 6565 6465 6420 6865 7265 2e0a 2020 2020  eeded here..    
-0000fc90: 2020 2020 3a72 6574 7572 6e73 3a20 4120      :returns: A 
-0000fca0: 4261 636b 6772 6f75 6e64 5461 736b 206f  BackgroundTask o
-0000fcb0: 626a 6563 742c 2077 6974 6820 6465 7461  bject, with deta
-0000fcc0: 696c 7320 6f6e 2065 7865 6375 7469 6f6e  ils on execution
-0000fcd0: 2070 726f 6365 7373 2061 6e64 2069 7473   process and its
-0000fce0: 2073 7461 7475 732e 0a20 2020 2020 2020   status..       
-0000fcf0: 2022 2222 0a0a 2020 2020 2020 2020 7472   """..        tr
-0000fd00: 793a 0a20 2020 2020 2020 2020 2020 2072  y:.            r
-0000fd10: 6571 203d 207b 2266 756e 6374 696f 6e55  eq = {"functionU
-0000fd20: 726c 223a 2066 756e 635f 7572 6c7d 0a20  rl": func_url}. 
-0000fd30: 2020 2020 2020 2020 2020 2072 6573 7020             resp 
-0000fd40: 3d20 7365 6c66 2e61 7069 5f63 616c 6c28  = self.api_call(
-0000fd50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000fd60: 2022 504f 5354 222c 0a20 2020 2020 2020   "POST",.       
-0000fd70: 2020 2020 2020 2020 2022 7374 6172 742f           "start/
-0000fd80: 6675 6e63 7469 6f6e 222c 0a20 2020 2020  function",.     
-0000fd90: 2020 2020 2020 2020 2020 206a 736f 6e3d             json=
-0000fda0: 7265 712c 0a20 2020 2020 2020 2020 2020  req,.           
-0000fdb0: 2020 2020 2074 696d 656f 7574 3d69 6e74       timeout=int
-0000fdc0: 2863 6f6e 6669 672e 7375 626d 6974 5f74  (config.submit_t
-0000fdd0: 696d 656f 7574 2920 6f72 2036 302c 0a20  imeout) or 60,. 
-0000fde0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-0000fdf0: 2020 2020 2065 7863 6570 7420 4f53 4572       except OSEr
-0000fe00: 726f 7220 6173 2065 7272 3a0a 2020 2020  ror as err:.    
-0000fe10: 2020 2020 2020 2020 6c6f 6767 6572 2e65          logger.e
-0000fe20: 7272 6f72 2866 2265 7272 6f72 2073 7461  rror(f"error sta
-0000fe30: 7274 696e 6720 6675 6e63 7469 6f6e 3a20  rting function: 
-0000fe40: 7b65 7272 5f74 6f5f 7374 7228 6572 7229  {err_to_str(err)
-0000fe50: 7d22 290a 2020 2020 2020 2020 2020 2020  }").            
-0000fe60: 7261 6973 6520 4f53 4572 726f 7228 6622  raise OSError(f"
-0000fe70: 6572 726f 723a 2063 616e 6e6f 7420 7374  error: cannot st
-0000fe80: 6172 7420 6675 6e63 7469 6f6e 2c20 7b65  art function, {e
-0000fe90: 7272 5f74 6f5f 7374 7228 6572 7229 7d22  rr_to_str(err)}"
-0000fea0: 290a 0a20 2020 2020 2020 2069 6620 6e6f  )..        if no
-0000feb0: 7420 7265 7370 2e6f 6b3a 0a20 2020 2020  t resp.ok:.     
-0000fec0: 2020 2020 2020 206c 6f67 6765 722e 6572         logger.er
-0000fed0: 726f 7228 6622 6261 6420 7265 7370 2121  ror(f"bad resp!!
-0000fee0: 5c6e 7b72 6573 702e 7465 7874 7d22 290a  \n{resp.text}").
-0000fef0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0000ff00: 6520 5661 6c75 6545 7272 6f72 2822 6261  e ValueError("ba
-0000ff10: 6420 6675 6e63 7469 6f6e 2073 7461 7274  d function start
-0000ff20: 2072 6573 706f 6e73 6522 290a 0a20 2020   response")..   
-0000ff30: 2020 2020 2072 6574 7572 6e20 6d6c 7275       return mlru
-0000ff40: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
-0000ff50: 2e42 6163 6b67 726f 756e 6454 6173 6b28  .BackgroundTask(
-0000ff60: 2a2a 7265 7370 2e6a 736f 6e28 2929 0a0a  **resp.json())..
-0000ff70: 2020 2020 6465 6620 6765 745f 7072 6f6a      def get_proj
-0000ff80: 6563 745f 6261 636b 6772 6f75 6e64 5f74  ect_background_t
-0000ff90: 6173 6b28 0a20 2020 2020 2020 2073 656c  ask(.        sel
-0000ffa0: 662c 0a20 2020 2020 2020 2070 726f 6a65  f,.        proje
-0000ffb0: 6374 3a20 7374 722c 0a20 2020 2020 2020  ct: str,.       
-0000ffc0: 206e 616d 653a 2073 7472 2c0a 2020 2020   name: str,.    
-0000ffd0: 2920 2d3e 206d 6c72 756e 2e63 6f6d 6d6f  ) -> mlrun.commo
-0000ffe0: 6e2e 7363 6865 6d61 732e 4261 636b 6772  n.schemas.Backgr
-0000fff0: 6f75 6e64 5461 736b 3a0a 2020 2020 2020  oundTask:.      
-00010000: 2020 2222 2252 6574 7269 6576 6520 7570    """Retrieve up
-00010010: 6461 7465 6420 696e 666f 726d 6174 696f  dated informatio
-00010020: 6e20 6f6e 2061 2070 726f 6a65 6374 2062  n on a project b
-00010030: 6163 6b67 726f 756e 6420 7461 736b 2062  ackground task b
-00010040: 6569 6e67 2065 7865 6375 7465 642e 2222  eing executed.""
-00010050: 220a 0a20 2020 2020 2020 2070 726f 6a65  "..        proje
-00010060: 6374 203d 2070 726f 6a65 6374 206f 7220  ct = project or 
-00010070: 636f 6e66 6967 2e64 6566 6175 6c74 5f70  config.default_p
-00010080: 726f 6a65 6374 0a20 2020 2020 2020 2070  roject.        p
-00010090: 6174 6820 3d20 6622 7072 6f6a 6563 7473  ath = f"projects
-000100a0: 2f7b 7072 6f6a 6563 747d 2f62 6163 6b67  /{project}/backg
-000100b0: 726f 756e 642d 7461 736b 732f 7b6e 616d  round-tasks/{nam
-000100c0: 657d 220a 2020 2020 2020 2020 6572 726f  e}".        erro
-000100d0: 725f 6d65 7373 6167 6520 3d20 280a 2020  r_message = (.  
-000100e0: 2020 2020 2020 2020 2020 6622 4661 696c            f"Fail
-000100f0: 6564 2067 6574 7469 6e67 2070 726f 6a65  ed getting proje
-00010100: 6374 2062 6163 6b67 726f 756e 6420 7461  ct background ta
-00010110: 736b 2e20 7072 6f6a 6563 743d 7b70 726f  sk. project={pro
-00010120: 6a65 6374 7d2c 206e 616d 653d 7b6e 616d  ject}, name={nam
-00010130: 657d 220a 2020 2020 2020 2020 290a 2020  e}".        ).  
-00010140: 2020 2020 2020 7265 7370 6f6e 7365 203d        response =
-00010150: 2073 656c 662e 6170 695f 6361 6c6c 2822   self.api_call("
-00010160: 4745 5422 2c20 7061 7468 2c20 6572 726f  GET", path, erro
-00010170: 725f 6d65 7373 6167 6529 0a20 2020 2020  r_message).     
-00010180: 2020 2072 6574 7572 6e20 6d6c 7275 6e2e     return mlrun.
-00010190: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e42  common.schemas.B
-000101a0: 6163 6b67 726f 756e 6454 6173 6b28 2a2a  ackgroundTask(**
-000101b0: 7265 7370 6f6e 7365 2e6a 736f 6e28 2929  response.json())
-000101c0: 0a0a 2020 2020 6465 6620 6c69 7374 5f70  ..    def list_p
-000101d0: 726f 6a65 6374 5f62 6163 6b67 726f 756e  roject_backgroun
-000101e0: 645f 7461 736b 7328 0a20 2020 2020 2020  d_tasks(.       
-000101f0: 2073 656c 662c 0a20 2020 2020 2020 2070   self,.        p
-00010200: 726f 6a65 6374 3a20 4f70 7469 6f6e 616c  roject: Optional
-00010210: 5b73 7472 5d20 3d20 4e6f 6e65 2c0a 2020  [str] = None,.  
-00010220: 2020 2020 2020 7374 6174 653a 204f 7074        state: Opt
-00010230: 696f 6e61 6c5b 7374 725d 203d 204e 6f6e  ional[str] = Non
-00010240: 652c 0a20 2020 2020 2020 2063 7265 6174  e,.        creat
-00010250: 6564 5f66 726f 6d3a 204f 7074 696f 6e61  ed_from: Optiona
-00010260: 6c5b 6461 7465 7469 6d65 5d20 3d20 4e6f  l[datetime] = No
-00010270: 6e65 2c0a 2020 2020 2020 2020 6372 6561  ne,.        crea
-00010280: 7465 645f 746f 3a20 4f70 7469 6f6e 616c  ted_to: Optional
-00010290: 5b64 6174 6574 696d 655d 203d 204e 6f6e  [datetime] = Non
-000102a0: 652c 0a20 2020 2020 2020 206c 6173 745f  e,.        last_
-000102b0: 7570 6461 7465 5f74 696d 655f 6672 6f6d  update_time_from
-000102c0: 3a20 4f70 7469 6f6e 616c 5b64 6174 6574  : Optional[datet
-000102d0: 696d 655d 203d 204e 6f6e 652c 0a20 2020  ime] = None,.   
-000102e0: 2020 2020 206c 6173 745f 7570 6461 7465       last_update
-000102f0: 5f74 696d 655f 746f 3a20 4f70 7469 6f6e  _time_to: Option
-00010300: 616c 5b64 6174 6574 696d 655d 203d 204e  al[datetime] = N
-00010310: 6f6e 652c 0a20 2020 2029 202d 3e20 6c69  one,.    ) -> li
-00010320: 7374 5b6d 6c72 756e 2e63 6f6d 6d6f 6e2e  st[mlrun.common.
-00010330: 7363 6865 6d61 732e 4261 636b 6772 6f75  schemas.Backgrou
-00010340: 6e64 5461 736b 5d3a 0a20 2020 2020 2020  ndTask]:.       
-00010350: 2022 2222 0a20 2020 2020 2020 2052 6574   """.        Ret
-00010360: 7269 6576 6520 7570 6461 7465 6420 696e  rieve updated in
-00010370: 666f 726d 6174 696f 6e20 6f6e 2070 726f  formation on pro
-00010380: 6a65 6374 2062 6163 6b67 726f 756e 6420  ject background 
-00010390: 7461 736b 7320 6265 696e 6720 6578 6563  tasks being exec
-000103a0: 7574 6564 2e0a 2020 2020 2020 2020 4966  uted..        If
-000103b0: 206e 6f20 6669 6c74 6572 2069 7320 7072   no filter is pr
-000103c0: 6f76 6964 6564 2c20 7769 6c6c 2072 6574  ovided, will ret
-000103d0: 7572 6e20 6261 636b 6772 6f75 6e64 2074  urn background t
-000103e0: 6173 6b73 2066 726f 6d20 7468 6520 6c61  asks from the la
-000103f0: 7374 2077 6565 6b2e 0a0a 2020 2020 2020  st week...      
-00010400: 2020 3a70 6172 616d 2070 726f 6a65 6374    :param project
-00010410: 3a20 5072 6f6a 6563 7420 6e61 6d65 2028  : Project name (
-00010420: 6465 6661 756c 7473 2074 6f20 6d6c 7275  defaults to mlru
-00010430: 6e2e 636f 6e66 6967 2e63 6f6e 6669 672e  n.config.config.
-00010440: 6465 6661 756c 745f 7072 6f6a 6563 7429  default_project)
-00010450: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00010460: 2073 7461 7465 3a20 2020 4c69 7374 206f   state:   List o
-00010470: 6e6c 7920 6261 636b 6772 6f75 6e64 2074  nly background t
-00010480: 6173 6b73 2077 686f 7365 2073 7461 7465  asks whose state
-00010490: 2069 7320 7370 6563 6966 6965 642e 0a20   is specified.. 
-000104a0: 2020 2020 2020 203a 7061 7261 6d20 6372         :param cr
-000104b0: 6561 7465 645f 6672 6f6d 3a20 4669 6c74  eated_from: Filt
-000104c0: 6572 2062 7920 6261 636b 6772 6f75 6e64  er by background
-000104d0: 2074 6173 6b20 6372 6561 7465 6420 7469   task created ti
-000104e0: 6d65 2069 6e20 6060 5b63 7265 6174 6564  me in ``[created
-000104f0: 5f66 726f 6d2c 2063 7265 6174 6564 5f74  _from, created_t
-00010500: 6f5d 6060 2e0a 2020 2020 2020 2020 3a70  o]``..        :p
-00010510: 6172 616d 2063 7265 6174 6564 5f74 6f3a  aram created_to:
-00010520: 2020 4669 6c74 6572 2062 7920 6261 636b    Filter by back
-00010530: 6772 6f75 6e64 2074 6173 6b20 6372 6561  ground task crea
-00010540: 7465 6420 7469 6d65 2069 6e20 6060 5b63  ted time in ``[c
-00010550: 7265 6174 6564 5f66 726f 6d2c 2063 7265  reated_from, cre
-00010560: 6174 6564 5f74 6f5d 6060 2e0a 2020 2020  ated_to]``..    
-00010570: 2020 2020 3a70 6172 616d 206c 6173 745f      :param last_
-00010580: 7570 6461 7465 5f74 696d 655f 6672 6f6d  update_time_from
-00010590: 3a20 4669 6c74 6572 2062 7920 6261 636b  : Filter by back
-000105a0: 6772 6f75 6e64 2074 6173 6b20 6c61 7374  ground task last
-000105b0: 2075 7064 6174 6520 7469 6d65 2069 6e0a   update time in.
-000105c0: 2020 2020 2020 2020 2020 2020 6060 286c              ``(l
-000105d0: 6173 745f 7570 6461 7465 5f74 696d 655f  ast_update_time_
-000105e0: 6672 6f6d 2c20 6c61 7374 5f75 7064 6174  from, last_updat
-000105f0: 655f 7469 6d65 5f74 6f29 6060 2e0a 2020  e_time_to)``..  
-00010600: 2020 2020 2020 3a70 6172 616d 206c 6173        :param las
-00010610: 745f 7570 6461 7465 5f74 696d 655f 746f  t_update_time_to
-00010620: 3a20 4669 6c74 6572 2062 7920 6261 636b  : Filter by back
-00010630: 6772 6f75 6e64 2074 6173 6b20 6c61 7374  ground task last
-00010640: 2075 7064 6174 6520 7469 6d65 2069 6e0a   update time in.
-00010650: 2020 2020 2020 2020 2020 2020 6060 286c              ``(l
-00010660: 6173 745f 7570 6461 7465 5f74 696d 655f  ast_update_time_
-00010670: 6672 6f6d 2c20 6c61 7374 5f75 7064 6174  from, last_updat
-00010680: 655f 7469 6d65 5f74 6f29 6060 2e0a 2020  e_time_to)``..  
-00010690: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-000106a0: 2020 7072 6f6a 6563 7420 3d20 7072 6f6a    project = proj
-000106b0: 6563 7420 6f72 2063 6f6e 6669 672e 6465  ect or config.de
-000106c0: 6661 756c 745f 7072 6f6a 6563 740a 2020  fault_project.  
-000106d0: 2020 2020 2020 6966 2028 0a20 2020 2020        if (.     
-000106e0: 2020 2020 2020 206e 6f74 2073 7461 7465         not state
-000106f0: 0a20 2020 2020 2020 2020 2020 2061 6e64  .            and
-00010700: 206e 6f74 2063 7265 6174 6564 5f66 726f   not created_fro
-00010710: 6d0a 2020 2020 2020 2020 2020 2020 616e  m.            an
-00010720: 6420 6e6f 7420 6372 6561 7465 645f 746f  d not created_to
-00010730: 0a20 2020 2020 2020 2020 2020 2061 6e64  .            and
-00010740: 206e 6f74 206c 6173 745f 7570 6461 7465   not last_update
-00010750: 5f74 696d 655f 6672 6f6d 0a20 2020 2020  _time_from.     
-00010760: 2020 2020 2020 2061 6e64 206e 6f74 206c         and not l
-00010770: 6173 745f 7570 6461 7465 5f74 696d 655f  ast_update_time_
-00010780: 746f 0a20 2020 2020 2020 2029 3a0a 2020  to.        ):.  
-00010790: 2020 2020 2020 2020 2020 2320 6465 6661            # defa
-000107a0: 756c 7420 746f 206c 6173 7420 7765 656b  ult to last week
-000107b0: 206f 6e20 6e6f 2066 696c 7465 720a 2020   on no filter.  
-000107c0: 2020 2020 2020 2020 2020 6372 6561 7465            create
-000107d0: 645f 6672 6f6d 203d 2064 6174 6574 696d  d_from = datetim
-000107e0: 652e 6e6f 7728 2920 2d20 7469 6d65 6465  e.now() - timede
-000107f0: 6c74 6128 6461 7973 3d37 290a 0a20 2020  lta(days=7)..   
-00010800: 2020 2020 2070 6172 616d 7320 3d20 7b0a       params = {.
-00010810: 2020 2020 2020 2020 2020 2020 2273 7461              "sta
-00010820: 7465 223a 2073 7461 7465 2c0a 2020 2020  te": state,.    
-00010830: 2020 2020 2020 2020 2263 7265 6174 6564          "created
-00010840: 5f66 726f 6d22 3a20 6461 7465 7469 6d65  _from": datetime
-00010850: 5f74 6f5f 6973 6f28 6372 6561 7465 645f  _to_iso(created_
-00010860: 6672 6f6d 292c 0a20 2020 2020 2020 2020  from),.         
-00010870: 2020 2022 6372 6561 7465 645f 746f 223a     "created_to":
-00010880: 2064 6174 6574 696d 655f 746f 5f69 736f   datetime_to_iso
-00010890: 2863 7265 6174 6564 5f74 6f29 2c0a 2020  (created_to),.  
-000108a0: 2020 2020 2020 2020 2020 226c 6173 745f            "last_
-000108b0: 7570 6461 7465 5f74 696d 655f 6672 6f6d  update_time_from
-000108c0: 223a 2064 6174 6574 696d 655f 746f 5f69  ": datetime_to_i
-000108d0: 736f 286c 6173 745f 7570 6461 7465 5f74  so(last_update_t
-000108e0: 696d 655f 6672 6f6d 292c 0a20 2020 2020  ime_from),.     
-000108f0: 2020 2020 2020 2022 6c61 7374 5f75 7064         "last_upd
-00010900: 6174 655f 7469 6d65 5f74 6f22 3a20 6461  ate_time_to": da
-00010910: 7465 7469 6d65 5f74 6f5f 6973 6f28 6c61  tetime_to_iso(la
-00010920: 7374 5f75 7064 6174 655f 7469 6d65 5f74  st_update_time_t
-00010930: 6f29 2c0a 2020 2020 2020 2020 7d0a 0a20  o),.        }.. 
-00010940: 2020 2020 2020 2070 6174 6820 3d20 6622         path = f"
-00010950: 7072 6f6a 6563 7473 2f7b 7072 6f6a 6563  projects/{projec
-00010960: 747d 2f62 6163 6b67 726f 756e 642d 7461  t}/background-ta
-00010970: 736b 7322 0a20 2020 2020 2020 2065 7272  sks".        err
-00010980: 6f72 5f6d 6573 7361 6765 203d 2066 2246  or_message = f"F
-00010990: 6169 6c65 6420 6c69 7374 696e 6720 7072  ailed listing pr
-000109a0: 6f6a 6563 7420 6261 636b 6772 6f75 6e64  oject background
-000109b0: 2074 6173 6b2e 2070 726f 6a65 6374 3d7b   task. project={
-000109c0: 7072 6f6a 6563 747d 220a 2020 2020 2020  project}".      
-000109d0: 2020 7265 7370 6f6e 7365 203d 2073 656c    response = sel
-000109e0: 662e 6170 695f 6361 6c6c 2822 4745 5422  f.api_call("GET"
-000109f0: 2c20 7061 7468 2c20 6572 726f 725f 6d65  , path, error_me
-00010a00: 7373 6167 652c 2070 6172 616d 733d 7061  ssage, params=pa
-00010a10: 7261 6d73 290a 2020 2020 2020 2020 7265  rams).        re
-00010a20: 7475 726e 206d 6c72 756e 2e63 6f6d 6d6f  turn mlrun.commo
-00010a30: 6e2e 7363 6865 6d61 732e 4261 636b 6772  n.schemas.Backgr
-00010a40: 6f75 6e64 5461 736b 4c69 7374 280a 2020  oundTaskList(.  
-00010a50: 2020 2020 2020 2020 2020 2a2a 7265 7370            **resp
-00010a60: 6f6e 7365 2e6a 736f 6e28 290a 2020 2020  onse.json().    
-00010a70: 2020 2020 292e 6261 636b 6772 6f75 6e64      ).background
-00010a80: 5f74 6173 6b73 0a0a 2020 2020 6465 6620  _tasks..    def 
-00010a90: 6765 745f 6261 636b 6772 6f75 6e64 5f74  get_background_t
-00010aa0: 6173 6b28 7365 6c66 2c20 6e61 6d65 3a20  ask(self, name: 
-00010ab0: 7374 7229 202d 3e20 6d6c 7275 6e2e 636f  str) -> mlrun.co
-00010ac0: 6d6d 6f6e 2e73 6368 656d 6173 2e42 6163  mmon.schemas.Bac
-00010ad0: 6b67 726f 756e 6454 6173 6b3a 0a20 2020  kgroundTask:.   
-00010ae0: 2020 2020 2022 2222 5265 7472 6965 7665       """Retrieve
-00010af0: 2075 7064 6174 6564 2069 6e66 6f72 6d61   updated informa
-00010b00: 7469 6f6e 206f 6e20 6120 6261 636b 6772  tion on a backgr
-00010b10: 6f75 6e64 2074 6173 6b20 6265 696e 6720  ound task being 
-00010b20: 6578 6563 7574 6564 2e22 2222 0a0a 2020  executed."""..  
-00010b30: 2020 2020 2020 7061 7468 203d 2066 2262        path = f"b
-00010b40: 6163 6b67 726f 756e 642d 7461 736b 732f  ackground-tasks/
-00010b50: 7b6e 616d 657d 220a 2020 2020 2020 2020  {name}".        
-00010b60: 6572 726f 725f 6d65 7373 6167 6520 3d20  error_message = 
-00010b70: 6622 4661 696c 6564 2067 6574 7469 6e67  f"Failed getting
-00010b80: 2062 6163 6b67 726f 756e 6420 7461 736b   background task
-00010b90: 2e20 6e61 6d65 3d7b 6e61 6d65 7d22 0a20  . name={name}". 
-00010ba0: 2020 2020 2020 2072 6573 706f 6e73 6520         response 
-00010bb0: 3d20 7365 6c66 2e61 7069 5f63 616c 6c28  = self.api_call(
-00010bc0: 2247 4554 222c 2070 6174 682c 2065 7272  "GET", path, err
-00010bd0: 6f72 5f6d 6573 7361 6765 290a 2020 2020  or_message).    
-00010be0: 2020 2020 7265 7475 726e 206d 6c72 756e      return mlrun
-00010bf0: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
-00010c00: 4261 636b 6772 6f75 6e64 5461 736b 282a  BackgroundTask(*
-00010c10: 2a72 6573 706f 6e73 652e 6a73 6f6e 2829  *response.json()
-00010c20: 290a 0a20 2020 2064 6566 2066 756e 6374  )..    def funct
-00010c30: 696f 6e5f 7374 6174 7573 2873 656c 662c  ion_status(self,
-00010c40: 2070 726f 6a65 6374 2c20 6e61 6d65 2c20   project, name, 
-00010c50: 6b69 6e64 2c20 7365 6c65 6374 6f72 293a  kind, selector):
-00010c60: 0a20 2020 2020 2020 2022 2222 5265 7472  .        """Retr
-00010c70: 6965 7665 2073 7461 7475 7320 6f66 2061  ieve status of a
-00010c80: 2066 756e 6374 696f 6e20 6265 696e 6720   function being 
-00010c90: 6578 6563 7574 6564 2072 656d 6f74 656c  executed remotel
-00010ca0: 7920 2872 656c 6576 616e 7420 746f 2060  y (relevant to `
-00010cb0: 6064 6173 6b60 6020 6675 6e63 7469 6f6e  `dask`` function
-00010cc0: 7329 2e0a 0a20 2020 2020 2020 203a 7061  s)...        :pa
-00010cd0: 7261 6d20 7072 6f6a 6563 743a 2020 2020  ram project:    
-00010ce0: 2054 6865 2070 726f 6a65 6374 206f 6620   The project of 
-00010cf0: 7468 6520 6675 6e63 7469 6f6e 0a20 2020  the function.   
-00010d00: 2020 2020 203a 7061 7261 6d20 6e61 6d65       :param name
-00010d10: 3a20 2020 2020 2020 2054 6865 206e 616d  :        The nam
-00010d20: 6520 6f66 2074 6865 2066 756e 6374 696f  e of the functio
-00010d30: 6e0a 2020 2020 2020 2020 3a70 6172 616d  n.        :param
-00010d40: 206b 696e 643a 2020 2020 2020 2020 5468   kind:        Th
-00010d50: 6520 6b69 6e64 206f 6620 7468 6520 6675  e kind of the fu
-00010d60: 6e63 7469 6f6e 2c20 6375 7272 656e 746c  nction, currentl
-00010d70: 7920 6060 6461 736b 6060 2069 7320 7375  y ``dask`` is su
-00010d80: 7070 6f72 7465 642e 0a20 2020 2020 2020  pported..       
-00010d90: 203a 7061 7261 6d20 7365 6c65 6374 6f72   :param selector
-00010da0: 3a20 2020 2053 656c 6563 746f 7220 636c  :    Selector cl
-00010db0: 6175 7365 2074 6f20 6265 2061 7070 6c69  ause to be appli
-00010dc0: 6564 2074 6f20 7468 6520 4b75 6265 726e  ed to the Kubern
-00010dd0: 6574 6573 2073 7461 7475 7320 7175 6572  etes status quer
-00010de0: 7920 746f 2066 696c 7465 7220 7468 6520  y to filter the 
-00010df0: 7265 7375 6c74 732e 0a20 2020 2020 2020  results..       
-00010e00: 2022 2222 0a0a 2020 2020 2020 2020 7472   """..        tr
-00010e10: 793a 0a20 2020 2020 2020 2020 2020 2072  y:.            r
-00010e20: 6571 203d 207b 226b 696e 6422 3a20 6b69  eq = {"kind": ki
-00010e30: 6e64 2c20 2273 656c 6563 746f 7222 3a20  nd, "selector": 
-00010e40: 7365 6c65 6374 6f72 2c20 2270 726f 6a65  selector, "proje
-00010e50: 6374 223a 2070 726f 6a65 6374 2c20 226e  ct": project, "n
-00010e60: 616d 6522 3a20 6e61 6d65 7d0a 2020 2020  ame": name}.    
-00010e70: 2020 2020 2020 2020 7265 7370 203d 2073          resp = s
-00010e80: 656c 662e 6170 695f 6361 6c6c 2822 504f  elf.api_call("PO
-00010e90: 5354 222c 2022 7374 6174 7573 2f66 756e  ST", "status/fun
-00010ea0: 6374 696f 6e22 2c20 6a73 6f6e 3d72 6571  ction", json=req
-00010eb0: 290a 2020 2020 2020 2020 6578 6365 7074  ).        except
-00010ec0: 204f 5345 7272 6f72 2061 7320 6572 723a   OSError as err:
-00010ed0: 0a20 2020 2020 2020 2020 2020 206c 6f67  .            log
-00010ee0: 6765 722e 6572 726f 7228 6622 6572 726f  ger.error(f"erro
-00010ef0: 7220 7374 6172 7469 6e67 2066 756e 6374  r starting funct
-00010f00: 696f 6e3a 207b 6572 725f 746f 5f73 7472  ion: {err_to_str
-00010f10: 2865 7272 297d 2229 0a20 2020 2020 2020  (err)}").       
-00010f20: 2020 2020 2072 6169 7365 204f 5345 7272       raise OSErr
-00010f30: 6f72 2866 2265 7272 6f72 3a20 6361 6e6e  or(f"error: cann
-00010f40: 6f74 2073 7461 7274 2066 756e 6374 696f  ot start functio
-00010f50: 6e2c 207b 6572 725f 746f 5f73 7472 2865  n, {err_to_str(e
-00010f60: 7272 297d 2229 0a0a 2020 2020 2020 2020  rr)}")..        
-00010f70: 6966 206e 6f74 2072 6573 702e 6f6b 3a0a  if not resp.ok:.
-00010f80: 2020 2020 2020 2020 2020 2020 6c6f 6767              logg
-00010f90: 6572 2e65 7272 6f72 2866 2262 6164 2072  er.error(f"bad r
-00010fa0: 6573 7021 215c 6e7b 7265 7370 2e74 6578  esp!!\n{resp.tex
-00010fb0: 747d 2229 0a20 2020 2020 2020 2020 2020  t}").           
-00010fc0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-00010fd0: 7228 2262 6164 2066 756e 6374 696f 6e20  r("bad function 
-00010fe0: 7374 6174 7573 2072 6573 706f 6e73 6522  status response"
-00010ff0: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
-00011000: 6e20 7265 7370 2e6a 736f 6e28 295b 2264  n resp.json()["d
-00011010: 6174 6122 5d0a 0a20 2020 2064 6566 2073  ata"]..    def s
-00011020: 7562 6d69 745f 6a6f 6228 0a20 2020 2020  ubmit_job(.     
-00011030: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-00011040: 2072 756e 7370 6563 2c0a 2020 2020 2020   runspec,.      
-00011050: 2020 7363 6865 6475 6c65 3a20 556e 696f    schedule: Unio
-00011060: 6e5b 7374 722c 206d 6c72 756e 2e63 6f6d  n[str, mlrun.com
-00011070: 6d6f 6e2e 7363 6865 6d61 732e 5363 6865  mon.schemas.Sche
-00011080: 6475 6c65 4372 6f6e 5472 6967 6765 725d  duleCronTrigger]
-00011090: 203d 204e 6f6e 652c 0a20 2020 2029 3a0a   = None,.    ):.
-000110a0: 2020 2020 2020 2020 2222 2253 7562 6d69          """Submi
-000110b0: 7420 6120 6a6f 6220 666f 7220 7265 6d6f  t a job for remo
-000110c0: 7465 2065 7865 6375 7469 6f6e 2e0a 0a20  te execution... 
-000110d0: 2020 2020 2020 203a 7061 7261 6d20 7275         :param ru
-000110e0: 6e73 7065 633a 2054 6865 2072 756e 7469  nspec: The runti
-000110f0: 6d65 206f 626a 6563 7420 7370 6563 2028  me object spec (
-00011100: 5461 736b 2920 746f 2065 7865 6375 7465  Task) to execute
-00011110: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00011120: 2073 6368 6564 756c 653a 2057 6865 7468   schedule: Wheth
-00011130: 6572 2074 6f20 7363 6865 6475 6c65 2074  er to schedule t
-00011140: 6869 7320 6a6f 6220 7573 696e 6720 6120  his job using a 
-00011150: 4372 6f6e 2074 7269 6767 6572 2e20 4966  Cron trigger. If
-00011160: 206e 6f74 2073 7065 6369 6669 6564 2c20   not specified, 
-00011170: 7468 6520 6a6f 6220 7769 6c6c 2062 6520  the job will be 
-00011180: 7375 626d 6974 7465 640a 2020 2020 2020  submitted.      
-00011190: 2020 2020 2020 696d 6d65 6469 6174 656c        immediatel
-000111a0: 792e 0a20 2020 2020 2020 2022 2222 0a0a  y..        """..
-000111b0: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
-000111c0: 2020 2020 2020 2020 2072 6571 203d 207b           req = {
-000111d0: 2274 6173 6b22 3a20 7275 6e73 7065 632e  "task": runspec.
-000111e0: 746f 5f64 6963 7428 297d 0a20 2020 2020  to_dict()}.     
-000111f0: 2020 2020 2020 2069 6620 7363 6865 6475         if schedu
-00011200: 6c65 3a0a 2020 2020 2020 2020 2020 2020  le:.            
-00011210: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-00011220: 6528 7363 6865 6475 6c65 2c20 6d6c 7275  e(schedule, mlru
-00011230: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
-00011240: 2e53 6368 6564 756c 6543 726f 6e54 7269  .ScheduleCronTri
-00011250: 6767 6572 293a 0a20 2020 2020 2020 2020  gger):.         
-00011260: 2020 2020 2020 2020 2020 2073 6368 6564             sched
-00011270: 756c 6520 3d20 7363 6865 6475 6c65 2e64  ule = schedule.d
-00011280: 6963 7428 290a 2020 2020 2020 2020 2020  ict().          
-00011290: 2020 2020 2020 7265 715b 2273 6368 6564        req["sched
-000112a0: 756c 6522 5d20 3d20 7363 6865 6475 6c65  ule"] = schedule
-000112b0: 0a20 2020 2020 2020 2020 2020 2074 696d  .            tim
-000112c0: 656f 7574 203d 2028 696e 7428 636f 6e66  eout = (int(conf
-000112d0: 6967 2e73 7562 6d69 745f 7469 6d65 6f75  ig.submit_timeou
-000112e0: 7429 206f 7220 3132 3029 202b 2032 300a  t) or 120) + 20.
-000112f0: 2020 2020 2020 2020 2020 2020 7265 7370              resp
-00011300: 203d 2073 656c 662e 6170 695f 6361 6c6c   = self.api_call
-00011310: 2822 504f 5354 222c 2022 7375 626d 6974  ("POST", "submit
-00011320: 5f6a 6f62 222c 206a 736f 6e3d 7265 712c  _job", json=req,
-00011330: 2074 696d 656f 7574 3d74 696d 656f 7574   timeout=timeout
-00011340: 290a 0a20 2020 2020 2020 2065 7863 6570  )..        excep
-00011350: 7420 7265 7175 6573 7473 2e48 5454 5045  t requests.HTTPE
-00011360: 7272 6f72 2061 7320 6572 723a 0a20 2020  rror as err:.   
-00011370: 2020 2020 2020 2020 206c 6f67 6765 722e           logger.
-00011380: 6572 726f 7228 6622 6572 726f 7220 7375  error(f"error su
-00011390: 626d 6974 7469 6e67 2074 6173 6b3a 207b  bmitting task: {
-000113a0: 6572 725f 746f 5f73 7472 2865 7272 297d  err_to_str(err)}
-000113b0: 2229 0a20 2020 2020 2020 2020 2020 2023  ").            #
-000113c0: 206e 6f74 2063 7265 6174 696e 6720 6120   not creating a 
-000113d0: 6e65 7720 6578 6365 7074 696f 6e20 6865  new exception he
-000113e0: 7265 2c20 696e 206f 7264 6572 2074 6f20  re, in order to 
-000113f0: 6b65 6570 2074 6865 2072 6573 706f 6e73  keep the respons
-00011400: 6520 616e 6420 7374 6174 7573 2063 6f64  e and status cod
-00011410: 6520 696e 2074 6865 2065 7863 6570 7469  e in the excepti
-00011420: 6f6e 0a20 2020 2020 2020 2020 2020 2072  on.            r
-00011430: 6169 7365 0a0a 2020 2020 2020 2020 6578  aise..        ex
-00011440: 6365 7074 204f 5345 7272 6f72 2061 7320  cept OSError as 
-00011450: 6572 723a 0a20 2020 2020 2020 2020 2020  err:.           
-00011460: 206c 6f67 6765 722e 6572 726f 7228 6622   logger.error(f"
-00011470: 6572 726f 7220 7375 626d 6974 7469 6e67  error submitting
-00011480: 2074 6173 6b3a 207b 6572 725f 746f 5f73   task: {err_to_s
-00011490: 7472 2865 7272 297d 2229 0a20 2020 2020  tr(err)}").     
-000114a0: 2020 2020 2020 2072 6169 7365 204f 5345         raise OSE
-000114b0: 7272 6f72 2822 6572 726f 723a 2063 616e  rror("error: can
-000114c0: 6e6f 7420 7375 626d 6974 2074 6173 6b22  not submit task"
-000114d0: 2920 6672 6f6d 2065 7272 0a0a 2020 2020  ) from err..    
-000114e0: 2020 2020 6966 206e 6f74 2072 6573 702e      if not resp.
-000114f0: 6f6b 3a0a 2020 2020 2020 2020 2020 2020  ok:.            
-00011500: 6c6f 6767 6572 2e65 7272 6f72 2866 2262  logger.error(f"b
-00011510: 6164 2072 6573 7021 215c 6e7b 7265 7370  ad resp!!\n{resp
-00011520: 2e74 6578 747d 2229 0a20 2020 2020 2020  .text}").       
-00011530: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-00011540: 4572 726f 7228 6622 6261 6420 6675 6e63  Error(f"bad func
-00011550: 7469 6f6e 2072 756e 2072 6573 706f 6e73  tion run respons
-00011560: 652c 207b 7265 7370 2e74 6578 747d 2229  e, {resp.text}")
-00011570: 0a0a 2020 2020 2020 2020 7265 7370 203d  ..        resp =
-00011580: 2072 6573 702e 6a73 6f6e 2829 0a20 2020   resp.json().   
-00011590: 2020 2020 2072 6574 7572 6e20 7265 7370       return resp
-000115a0: 5b22 6461 7461 225d 0a0a 2020 2020 6465  ["data"]..    de
-000115b0: 6620 7375 626d 6974 5f70 6970 656c 696e  f submit_pipelin
-000115c0: 6528 0a20 2020 2020 2020 2073 656c 662c  e(.        self,
-000115d0: 0a20 2020 2020 2020 2070 726f 6a65 6374  .        project
-000115e0: 2c0a 2020 2020 2020 2020 7069 7065 6c69  ,.        pipeli
-000115f0: 6e65 2c0a 2020 2020 2020 2020 6172 6775  ne,.        argu
-00011600: 6d65 6e74 733d 4e6f 6e65 2c0a 2020 2020  ments=None,.    
-00011610: 2020 2020 6578 7065 7269 6d65 6e74 3d4e      experiment=N
-00011620: 6f6e 652c 0a20 2020 2020 2020 2072 756e  one,.        run
-00011630: 3d4e 6f6e 652c 0a20 2020 2020 2020 206e  =None,.        n
-00011640: 616d 6573 7061 6365 3d4e 6f6e 652c 0a20  amespace=None,. 
-00011650: 2020 2020 2020 2061 7274 6966 6163 745f         artifact_
-00011660: 7061 7468 3d4e 6f6e 652c 0a20 2020 2020  path=None,.     
-00011670: 2020 206f 7073 3d4e 6f6e 652c 0a20 2020     ops=None,.   
-00011680: 2020 2020 2063 6c65 616e 7570 5f74 746c       cleanup_ttl
-00011690: 3d4e 6f6e 652c 0a20 2020 2029 3a0a 2020  =None,.    ):.  
-000116a0: 2020 2020 2020 2222 2253 7562 6d69 7420        """Submit 
-000116b0: 6120 4b46 5020 7069 7065 6c69 6e65 2066  a KFP pipeline f
-000116c0: 6f72 2065 7865 6375 7469 6f6e 2e0a 0a20  or execution... 
-000116d0: 2020 2020 2020 203a 7061 7261 6d20 7072         :param pr
-000116e0: 6f6a 6563 743a 2054 6865 2070 726f 6a65  oject: The proje
-000116f0: 6374 206f 6620 7468 6520 7069 7065 6c69  ct of the pipeli
-00011700: 6e65 0a20 2020 2020 2020 203a 7061 7261  ne.        :para
-00011710: 6d20 7069 7065 6c69 6e65 3a20 5069 7065  m pipeline: Pipe
-00011720: 6c69 6e65 2066 756e 6374 696f 6e20 6f72  line function or
-00011730: 2070 6174 6820 746f 202e 7961 6d6c 2f2e   path to .yaml/.
-00011740: 7a69 7020 7069 7065 6c69 6e65 2066 696c  zip pipeline fil
-00011750: 652e 0a20 2020 2020 2020 203a 7061 7261  e..        :para
-00011760: 6d20 6172 6775 6d65 6e74 733a 2041 2064  m arguments: A d
-00011770: 6963 7469 6f6e 6172 7920 6f66 2061 7267  ictionary of arg
-00011780: 756d 656e 7473 2074 6f20 7061 7373 2074  uments to pass t
-00011790: 6f20 7468 6520 7069 7065 6c69 6e65 2e0a  o the pipeline..
-000117a0: 2020 2020 2020 2020 3a70 6172 616d 2065          :param e
-000117b0: 7870 6572 696d 656e 743a 2041 206e 616d  xperiment: A nam
-000117c0: 6520 746f 2061 7373 6967 6e20 666f 7220  e to assign for 
-000117d0: 7468 6520 7370 6563 6966 6963 2065 7870  the specific exp
-000117e0: 6572 696d 656e 742e 0a20 2020 2020 2020  eriment..       
-000117f0: 203a 7061 7261 6d20 7275 6e3a 2041 206e   :param run: A n
-00011800: 616d 6520 666f 7220 7468 6973 2073 7065  ame for this spe
-00011810: 6369 6669 6320 7275 6e2e 0a20 2020 2020  cific run..     
-00011820: 2020 203a 7061 7261 6d20 6e61 6d65 7370     :param namesp
-00011830: 6163 653a 204b 7562 6572 6e65 7465 7320  ace: Kubernetes 
-00011840: 6e61 6d65 7370 6163 6520 746f 2065 7865  namespace to exe
-00011850: 6375 7465 2074 6865 2070 6970 656c 696e  cute the pipelin
-00011860: 6520 696e 2e0a 2020 2020 2020 2020 3a70  e in..        :p
-00011870: 6172 616d 2061 7274 6966 6163 745f 7061  aram artifact_pa
-00011880: 7468 3a20 4120 7061 7468 2074 6f20 6172  th: A path to ar
-00011890: 7469 6661 6374 7320 7573 6564 2062 7920  tifacts used by 
-000118a0: 7468 6973 2070 6970 656c 696e 652e 0a20  this pipeline.. 
-000118b0: 2020 2020 2020 203a 7061 7261 6d20 6f70         :param op
-000118c0: 733a 2054 7261 6e73 666f 726d 6572 7320  s: Transformers 
-000118d0: 746f 2061 7070 6c79 206f 6e20 616c 6c20  to apply on all 
-000118e0: 6f70 7320 696e 2074 6865 2070 6970 656c  ops in the pipel
-000118f0: 696e 652e 0a20 2020 2020 2020 203a 7061  ine..        :pa
-00011900: 7261 6d20 636c 6561 6e75 705f 7474 6c3a  ram cleanup_ttl:
-00011910: 2070 6970 656c 696e 6520 636c 6561 6e75   pipeline cleanu
-00011920: 7020 7474 6c20 696e 2073 6563 7320 2874  p ttl in secs (t
-00011930: 696d 6520 746f 2077 6169 7420 6166 7465  ime to wait afte
-00011940: 7220 776f 726b 666c 6f77 2063 6f6d 706c  r workflow compl
-00011950: 6574 696f 6e2c 2061 7420 7768 6963 6820  etion, at which 
-00011960: 706f 696e 7420 7468 650a 2020 2020 2020  point the.      
-00011970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011980: 2020 2020 2020 776f 726b 666c 6f77 2061        workflow a
-00011990: 6e64 2061 6c6c 2069 7473 2072 6573 6f75  nd all its resou
-000119a0: 7263 6573 2061 7265 2064 656c 6574 6564  rces are deleted
-000119b0: 290a 2020 2020 2020 2020 2222 220a 0a20  ).        """.. 
-000119c0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-000119d0: 616e 6365 2870 6970 656c 696e 652c 2073  ance(pipeline, s
-000119e0: 7472 293a 0a20 2020 2020 2020 2020 2020  tr):.           
-000119f0: 2070 6970 655f 6669 6c65 203d 2070 6970   pipe_file = pip
-00011a00: 656c 696e 650a 2020 2020 2020 2020 656c  eline.        el
-00011a10: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00011a20: 7069 7065 5f66 696c 6520 3d20 7465 6d70  pipe_file = temp
-00011a30: 6669 6c65 2e4e 616d 6564 5465 6d70 6f72  file.NamedTempor
-00011a40: 6172 7946 696c 6528 7375 6666 6978 3d22  aryFile(suffix="
-00011a50: 2e79 616d 6c22 2c20 6465 6c65 7465 3d46  .yaml", delete=F
-00011a60: 616c 7365 292e 6e61 6d65 0a20 2020 2020  alse).name.     
-00011a70: 2020 2020 2020 2063 6f6e 6620 3d20 6e65         conf = ne
-00011a80: 775f 7069 7065 5f6d 6574 6164 6174 6128  w_pipe_metadata(
-00011a90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00011aa0: 2061 7274 6966 6163 745f 7061 7468 3d61   artifact_path=a
-00011ab0: 7274 6966 6163 745f 7061 7468 2c0a 2020  rtifact_path,.  
-00011ac0: 2020 2020 2020 2020 2020 2020 2020 636c                cl
-00011ad0: 6561 6e75 705f 7474 6c3d 636c 6561 6e75  eanup_ttl=cleanu
-00011ae0: 705f 7474 6c2c 0a20 2020 2020 2020 2020  p_ttl,.         
-00011af0: 2020 2020 2020 206f 705f 7472 616e 7366         op_transf
-00011b00: 6f72 6d65 7273 3d6f 7073 2c0a 2020 2020  ormers=ops,.    
-00011b10: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00011b20: 2020 2020 2020 6b66 702e 636f 6d70 696c        kfp.compil
-00011b30: 6572 2e43 6f6d 7069 6c65 7228 292e 636f  er.Compiler().co
-00011b40: 6d70 696c 6528 0a20 2020 2020 2020 2020  mpile(.         
-00011b50: 2020 2020 2020 2070 6970 656c 696e 652c         pipeline,
-00011b60: 2070 6970 655f 6669 6c65 2c20 7479 7065   pipe_file, type
-00011b70: 5f63 6865 636b 3d46 616c 7365 2c20 7069  _check=False, pi
-00011b80: 7065 6c69 6e65 5f63 6f6e 663d 636f 6e66  peline_conf=conf
-00011b90: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
-00011ba0: 2020 2020 2020 2020 6966 2070 6970 655f          if pipe_
-00011bb0: 6669 6c65 2e65 6e64 7377 6974 6828 222e  file.endswith(".
-00011bc0: 7961 6d6c 2229 3a0a 2020 2020 2020 2020  yaml"):.        
-00011bd0: 2020 2020 6865 6164 6572 7320 3d20 7b22      headers = {"
-00011be0: 636f 6e74 656e 742d 7479 7065 223a 2022  content-type": "
-00011bf0: 6170 706c 6963 6174 696f 6e2f 7961 6d6c  application/yaml
-00011c00: 227d 0a20 2020 2020 2020 2065 6c69 6620  "}.        elif 
-00011c10: 7069 7065 5f66 696c 652e 656e 6473 7769  pipe_file.endswi
-00011c20: 7468 2822 2e7a 6970 2229 3a0a 2020 2020  th(".zip"):.    
-00011c30: 2020 2020 2020 2020 6865 6164 6572 7320          headers 
-00011c40: 3d20 7b22 636f 6e74 656e 742d 7479 7065  = {"content-type
-00011c50: 223a 2022 6170 706c 6963 6174 696f 6e2f  ": "application/
-00011c60: 7a69 7022 7d0a 2020 2020 2020 2020 656c  zip"}.        el
-00011c70: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00011c80: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-00011c90: 2822 7069 7065 6c69 6e65 2066 696c 6520  ("pipeline file 
-00011ca0: 6d75 7374 2062 6520 2e79 616d 6c20 6f72  must be .yaml or
-00011cb0: 202e 7a69 7022 290a 2020 2020 2020 2020   .zip").        
-00011cc0: 6966 2061 7267 756d 656e 7473 3a0a 2020  if arguments:.  
-00011cd0: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
-00011ce0: 2069 7369 6e73 7461 6e63 6528 6172 6775   isinstance(argu
-00011cf0: 6d65 6e74 732c 2064 6963 7429 3a0a 2020  ments, dict):.  
-00011d00: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-00011d10: 6973 6520 5661 6c75 6545 7272 6f72 2822  ise ValueError("
-00011d20: 6172 6775 6d65 6e74 7320 6d75 7374 2062  arguments must b
-00011d30: 6520 6469 6374 2074 7970 6522 290a 2020  e dict type").  
-00011d40: 2020 2020 2020 2020 2020 6865 6164 6572            header
-00011d50: 735b 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  s[mlrun.common.s
-00011d60: 6368 656d 6173 2e48 6561 6465 724e 616d  chemas.HeaderNam
-00011d70: 6573 2e70 6970 656c 696e 655f 6172 6775  es.pipeline_argu
-00011d80: 6d65 6e74 735d 203d 2073 7472 280a 2020  ments] = str(.  
-00011d90: 2020 2020 2020 2020 2020 2020 2020 6172                ar
-00011da0: 6775 6d65 6e74 730a 2020 2020 2020 2020  guments.        
-00011db0: 2020 2020 290a 0a20 2020 2020 2020 2069      )..        i
-00011dc0: 6620 6e6f 7420 7061 7468 2e69 7366 696c  f not path.isfil
-00011dd0: 6528 7069 7065 5f66 696c 6529 3a0a 2020  e(pipe_file):.  
-00011de0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00011df0: 4f53 4572 726f 7228 6622 6669 6c65 207b  OSError(f"file {
-00011e00: 7069 7065 5f66 696c 657d 2064 6f65 736e  pipe_file} doesn
-00011e10: 7420 6578 6973 7422 290a 2020 2020 2020  t exist").      
-00011e20: 2020 7769 7468 206f 7065 6e28 7069 7065    with open(pipe
-00011e30: 5f66 696c 652c 2022 7262 2229 2061 7320  _file, "rb") as 
-00011e40: 6670 3a0a 2020 2020 2020 2020 2020 2020  fp:.            
-00011e50: 6461 7461 203d 2066 702e 7265 6164 2829  data = fp.read()
-00011e60: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-00011e70: 6973 696e 7374 616e 6365 2870 6970 656c  isinstance(pipel
-00011e80: 696e 652c 2073 7472 293a 0a20 2020 2020  ine, str):.     
-00011e90: 2020 2020 2020 2072 656d 6f76 6528 7069         remove(pi
-00011ea0: 7065 5f66 696c 6529 0a0a 2020 2020 2020  pe_file)..      
-00011eb0: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
-00011ec0: 2020 2070 6172 616d 7320 3d20 7b22 6e61     params = {"na
-00011ed0: 6d65 7370 6163 6522 3a20 6e61 6d65 7370  mespace": namesp
-00011ee0: 6163 652c 2022 6578 7065 7269 6d65 6e74  ace, "experiment
-00011ef0: 223a 2065 7870 6572 696d 656e 742c 2022  ": experiment, "
-00011f00: 7275 6e22 3a20 7275 6e7d 0a20 2020 2020  run": run}.     
-00011f10: 2020 2020 2020 2072 6573 7020 3d20 7365         resp = se
-00011f20: 6c66 2e61 7069 5f63 616c 6c28 0a20 2020  lf.api_call(.   
-00011f30: 2020 2020 2020 2020 2020 2020 2022 504f               "PO
-00011f40: 5354 222c 0a20 2020 2020 2020 2020 2020  ST",.           
-00011f50: 2020 2020 2066 2270 726f 6a65 6374 732f       f"projects/
-00011f60: 7b70 726f 6a65 6374 7d2f 7069 7065 6c69  {project}/pipeli
-00011f70: 6e65 7322 2c0a 2020 2020 2020 2020 2020  nes",.          
-00011f80: 2020 2020 2020 7061 7261 6d73 3d70 6172        params=par
-00011f90: 616d 732c 0a20 2020 2020 2020 2020 2020  ams,.           
-00011fa0: 2020 2020 2074 696d 656f 7574 3d32 302c       timeout=20,
-00011fb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00011fc0: 2062 6f64 793d 6461 7461 2c0a 2020 2020   body=data,.    
-00011fd0: 2020 2020 2020 2020 2020 2020 6865 6164              head
-00011fe0: 6572 733d 6865 6164 6572 732c 0a20 2020  ers=headers,.   
-00011ff0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00012000: 2020 2065 7863 6570 7420 4f53 4572 726f     except OSErro
-00012010: 7220 6173 2065 7272 3a0a 2020 2020 2020  r as err:.      
-00012020: 2020 2020 2020 6c6f 6767 6572 2e65 7272        logger.err
-00012030: 6f72 2822 4572 726f 723a 2043 616e 6e6f  or("Error: Canno
-00012040: 7420 7375 626d 6974 2070 6970 656c 696e  t submit pipelin
-00012050: 6522 2c20 6572 723d 6572 725f 746f 5f73  e", err=err_to_s
-00012060: 7472 2865 7272 2929 0a20 2020 2020 2020  tr(err)).       
-00012070: 2020 2020 2072 6169 7365 204f 5345 7272       raise OSErr
-00012080: 6f72 2866 2245 7272 6f72 3a20 4361 6e6e  or(f"Error: Cann
-00012090: 6f74 2073 7562 6d69 7420 7069 7065 6c69  ot submit pipeli
-000120a0: 6e65 2c20 7b65 7272 5f74 6f5f 7374 7228  ne, {err_to_str(
-000120b0: 6572 7229 7d22 290a 0a20 2020 2020 2020  err)}")..       
-000120c0: 2069 6620 6e6f 7420 7265 7370 2e6f 6b3a   if not resp.ok:
-000120d0: 0a20 2020 2020 2020 2020 2020 206c 6f67  .            log
-000120e0: 6765 722e 6572 726f 7228 2246 6169 6c65  ger.error("Faile
-000120f0: 6420 746f 2073 7562 6d69 7420 7069 7065  d to submit pipe
-00012100: 6c69 6e65 222c 2072 6573 706f 6e65 735f  line", respones_
-00012110: 7465 7874 3d72 6573 702e 7465 7874 290a  text=resp.text).
-00012120: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00012130: 6520 5661 6c75 6545 7272 6f72 2866 2246  e ValueError(f"F
-00012140: 6169 6c65 6420 746f 2073 7562 6d69 7420  ailed to submit 
-00012150: 7069 7065 6c69 6e65 2c20 7b72 6573 702e  pipeline, {resp.
-00012160: 7465 7874 7d22 290a 0a20 2020 2020 2020  text}")..       
-00012170: 2072 6573 7020 3d20 7265 7370 2e6a 736f   resp = resp.jso
-00012180: 6e28 290a 2020 2020 2020 2020 6c6f 6767  n().        logg
-00012190: 6572 2e69 6e66 6f28 0a20 2020 2020 2020  er.info(.       
-000121a0: 2020 2020 2022 5069 7065 6c69 6e65 2073       "Pipeline s
-000121b0: 7562 6d69 7474 6564 2073 7563 6365 7373  ubmitted success
-000121c0: 6675 6c6c 7922 2c20 7069 7065 6c69 6e65  fully", pipeline
-000121d0: 5f6e 616d 653d 7265 7370 5b22 6e61 6d65  _name=resp["name
-000121e0: 225d 2c20 6964 3d72 6573 705b 2269 6422  "], id=resp["id"
-000121f0: 5d0a 2020 2020 2020 2020 290a 2020 2020  ].        ).    
-00012200: 2020 2020 7265 7475 726e 2072 6573 705b      return resp[
-00012210: 2269 6422 5d0a 0a20 2020 2064 6566 206c  "id"]..    def l
-00012220: 6973 745f 7069 7065 6c69 6e65 7328 0a20  ist_pipelines(. 
-00012230: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-00012240: 2020 2020 2070 726f 6a65 6374 3a20 7374       project: st
-00012250: 722c 0a20 2020 2020 2020 206e 616d 6573  r,.        names
-00012260: 7061 6365 3a20 7374 7220 3d20 4e6f 6e65  pace: str = None
-00012270: 2c0a 2020 2020 2020 2020 736f 7274 5f62  ,.        sort_b
-00012280: 793a 2073 7472 203d 2022 222c 0a20 2020  y: str = "",.   
-00012290: 2020 2020 2070 6167 655f 746f 6b65 6e3a       page_token:
-000122a0: 2073 7472 203d 2022 222c 0a20 2020 2020   str = "",.     
-000122b0: 2020 2066 696c 7465 725f 3a20 7374 7220     filter_: str 
-000122c0: 3d20 2222 2c0a 2020 2020 2020 2020 666f  = "",.        fo
-000122d0: 726d 6174 5f3a 2055 6e69 6f6e 5b0a 2020  rmat_: Union[.  
-000122e0: 2020 2020 2020 2020 2020 7374 722c 206d            str, m
-000122f0: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
-00012300: 6d61 732e 5069 7065 6c69 6e65 7346 6f72  mas.PipelinesFor
-00012310: 6d61 740a 2020 2020 2020 2020 5d20 3d20  mat.        ] = 
-00012320: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-00012330: 656d 6173 2e50 6970 656c 696e 6573 466f  emas.PipelinesFo
-00012340: 726d 6174 2e6d 6574 6164 6174 615f 6f6e  rmat.metadata_on
-00012350: 6c79 2c0a 2020 2020 2020 2020 7061 6765  ly,.        page
-00012360: 5f73 697a 653a 2069 6e74 203d 204e 6f6e  _size: int = Non
-00012370: 652c 0a20 2020 2029 202d 3e20 6d6c 7275  e,.    ) -> mlru
-00012380: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
-00012390: 2e50 6970 656c 696e 6573 4f75 7470 7574  .PipelinesOutput
-000123a0: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
-000123b0: 7269 6576 6520 6120 6c69 7374 206f 6620  rieve a list of 
-000123c0: 4b46 5020 7069 7065 6c69 6e65 732e 2054  KFP pipelines. T
-000123d0: 6869 7320 6675 6e63 7469 6f6e 2063 616e  his function can
-000123e0: 2062 6520 696e 766f 6b65 6420 746f 2067   be invoked to g
-000123f0: 6574 2061 6c6c 2070 6970 656c 696e 6573  et all pipelines
-00012400: 2066 726f 6d20 616c 6c20 7072 6f6a 6563   from all projec
-00012410: 7473 2c0a 2020 2020 2020 2020 6279 2073  ts,.        by s
-00012420: 7065 6369 6679 696e 6720 6060 7072 6f6a  pecifying ``proj
-00012430: 6563 743d 2a60 602c 2069 6e20 7768 6963  ect=*``, in whic
-00012440: 6820 6361 7365 2070 6167 696e 6174 696f  h case paginatio
-00012450: 6e20 6361 6e20 6265 2075 7365 6420 616e  n can be used an
-00012460: 6420 7468 6520 7661 7269 6f75 7320 736f  d the various so
-00012470: 7274 696e 6720 616e 6420 7061 6769 6e61  rting and pagina
-00012480: 7469 6f6e 0a20 2020 2020 2020 2070 726f  tion.        pro
-00012490: 7065 7274 6965 7320 6361 6e20 6265 2061  perties can be a
-000124a0: 7070 6c69 6564 2e20 4966 2061 2073 7065  pplied. If a spe
-000124b0: 6369 6669 6320 7072 6f6a 6563 7420 6973  cific project is
-000124c0: 2072 6571 7565 7374 6564 2c20 7468 656e   requested, then
-000124d0: 2074 6865 2070 6167 696e 6174 696f 6e20   the pagination 
-000124e0: 6f70 7469 6f6e 7320 6361 6e6e 6f74 2062  options cannot b
-000124f0: 650a 2020 2020 2020 2020 7573 6564 2061  e.        used a
-00012500: 6e64 2070 6167 696e 6174 696f 6e20 6973  nd pagination is
-00012510: 206e 6f74 2061 7070 6c69 6564 2e0a 0a20   not applied... 
-00012520: 2020 2020 2020 203a 7061 7261 6d20 7072         :param pr
-00012530: 6f6a 6563 743a 2050 726f 6a65 6374 206e  oject: Project n
-00012540: 616d 652e 2043 616e 2062 6520 6060 2a60  ame. Can be ``*`
-00012550: 6020 666f 7220 7175 6572 7920 6163 726f  ` for query acro
-00012560: 7373 2061 6c6c 2070 726f 6a65 6374 732e  ss all projects.
-00012570: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00012580: 6e61 6d65 7370 6163 653a 204b 7562 6572  namespace: Kuber
-00012590: 6e65 7465 7320 6e61 6d65 7370 6163 6520  netes namespace 
-000125a0: 696e 2077 6869 6368 2074 6865 2070 6970  in which the pip
-000125b0: 656c 696e 6573 2061 7265 2065 7865 6375  elines are execu
-000125c0: 7469 6e67 2e0a 2020 2020 2020 2020 3a70  ting..        :p
-000125d0: 6172 616d 2073 6f72 745f 6279 3a20 4669  aram sort_by: Fi
-000125e0: 656c 6420 746f 2073 6f72 7420 7468 6520  eld to sort the 
-000125f0: 7265 7375 6c74 7320 6279 2e0a 2020 2020  results by..    
-00012600: 2020 2020 3a70 6172 616d 2070 6167 655f      :param page_
-00012610: 746f 6b65 6e3a 2055 7365 2066 6f72 2070  token: Use for p
-00012620: 6167 696e 6174 696f 6e2c 2074 6f20 7265  agination, to re
-00012630: 7472 6965 7665 206e 6578 7420 7061 6765  trieve next page
-00012640: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00012650: 2066 696c 7465 725f 3a20 4b75 6265 726e   filter_: Kubern
-00012660: 6574 6573 2066 696c 7465 7220 746f 2061  etes filter to a
-00012670: 7070 6c79 2074 6f20 7468 6520 7175 6572  pply to the quer
-00012680: 792c 2063 616e 2062 6520 7573 6564 2074  y, can be used t
-00012690: 6f20 6669 6c74 6572 206f 6e20 7370 6563  o filter on spec
-000126a0: 6966 6963 206f 626a 6563 7420 6669 656c  ific object fiel
-000126b0: 6473 2e0a 2020 2020 2020 2020 3a70 6172  ds..        :par
-000126c0: 616d 2066 6f72 6d61 745f 3a20 5265 7375  am format_: Resu
-000126d0: 6c74 2066 6f72 6d61 742e 2043 616e 2062  lt format. Can b
-000126e0: 6520 6f6e 6520 6f66 3a0a 0a20 2020 2020  e one of:..     
-000126f0: 2020 2020 2020 202d 2060 6066 756c 6c60         - ``full`
-00012700: 6020 2d20 7265 7475 726e 2074 6865 2066  ` - return the f
-00012710: 756c 6c20 6f62 6a65 6374 732e 0a20 2020  ull objects..   
-00012720: 2020 2020 2020 2020 202d 2060 606d 6574           - ``met
-00012730: 6164 6174 615f 6f6e 6c79 6060 2028 6465  adata_only`` (de
-00012740: 6661 756c 7429 202d 2072 6574 7572 6e20  fault) - return 
-00012750: 6a75 7374 206d 6574 6164 6174 6120 6f66  just metadata of
-00012760: 2074 6865 2070 6970 656c 696e 6573 206f   the pipelines o
-00012770: 626a 6563 7473 2e0a 2020 2020 2020 2020  bjects..        
-00012780: 2020 2020 2d20 6060 6e61 6d65 5f6f 6e6c      - ``name_onl
-00012790: 7960 6020 2d20 7265 7475 726e 206a 7573  y`` - return jus
-000127a0: 7420 7468 6520 6e61 6d65 7320 6f66 2074  t the names of t
-000127b0: 6865 2070 6970 656c 696e 6520 6f62 6a65  he pipeline obje
-000127c0: 6374 732e 0a20 2020 2020 2020 203a 7061  cts..        :pa
-000127d0: 7261 6d20 7061 6765 5f73 697a 653a 2053  ram page_size: S
-000127e0: 697a 6520 6f66 2061 2073 696e 676c 6520  ize of a single 
-000127f0: 7061 6765 2077 6865 6e20 6170 706c 7969  page when applyi
-00012800: 6e67 2070 6167 696e 6174 696f 6e2e 0a20  ng pagination.. 
-00012810: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
-00012820: 2020 2020 6966 2070 726f 6a65 6374 2021      if project !
-00012830: 3d20 222a 2220 616e 6420 2870 6167 655f  = "*" and (page_
-00012840: 746f 6b65 6e20 6f72 2070 6167 655f 7369  token or page_si
-00012850: 7a65 293a 0a20 2020 2020 2020 2020 2020  ze):.           
-00012860: 2072 6169 7365 206d 6c72 756e 2e65 7272   raise mlrun.err
-00012870: 6f72 732e 4d4c 5275 6e49 6e76 616c 6964  ors.MLRunInvalid
-00012880: 4172 6775 6d65 6e74 4572 726f 7228 0a20  ArgumentError(. 
-00012890: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-000128a0: 4669 6c74 6572 696e 6720 6279 2070 726f  Filtering by pro
-000128b0: 6a65 6374 2063 616e 206e 6f74 2062 6520  ject can not be 
-000128c0: 7573 6564 2074 6f67 6574 6865 7220 7769  used together wi
-000128d0: 7468 2070 6167 696e 6174 696f 6e22 0a20  th pagination". 
-000128e0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-000128f0: 2020 2020 2070 6172 616d 7320 3d20 7b0a       params = {.
-00012900: 2020 2020 2020 2020 2020 2020 226e 616d              "nam
-00012910: 6573 7061 6365 223a 206e 616d 6573 7061  espace": namespa
-00012920: 6365 2c0a 2020 2020 2020 2020 2020 2020  ce,.            
-00012930: 2273 6f72 745f 6279 223a 2073 6f72 745f  "sort_by": sort_
-00012940: 6279 2c0a 2020 2020 2020 2020 2020 2020  by,.            
-00012950: 2270 6167 655f 746f 6b65 6e22 3a20 7061  "page_token": pa
-00012960: 6765 5f74 6f6b 656e 2c0a 2020 2020 2020  ge_token,.      
-00012970: 2020 2020 2020 2266 696c 7465 7222 3a20        "filter": 
-00012980: 6669 6c74 6572 5f2c 0a20 2020 2020 2020  filter_,.       
-00012990: 2020 2020 2022 666f 726d 6174 223a 2066       "format": f
-000129a0: 6f72 6d61 745f 2c0a 2020 2020 2020 2020  ormat_,.        
-000129b0: 2020 2020 2270 6167 655f 7369 7a65 223a      "page_size":
-000129c0: 2070 6167 655f 7369 7a65 2c0a 2020 2020   page_size,.    
-000129d0: 2020 2020 7d0a 0a20 2020 2020 2020 2065      }..        e
-000129e0: 7272 6f72 5f6d 6573 7361 6765 203d 2066  rror_message = f
-000129f0: 2246 6169 6c65 6420 6c69 7374 696e 6720  "Failed listing 
-00012a00: 7069 7065 6c69 6e65 732c 2071 7565 7279  pipelines, query
-00012a10: 3a20 7b70 6172 616d 737d 220a 2020 2020  : {params}".    
-00012a20: 2020 2020 7265 7370 6f6e 7365 203d 2073      response = s
-00012a30: 656c 662e 6170 695f 6361 6c6c 280a 2020  elf.api_call(.  
-00012a40: 2020 2020 2020 2020 2020 2247 4554 222c            "GET",
-00012a50: 2066 2270 726f 6a65 6374 732f 7b70 726f   f"projects/{pro
-00012a60: 6a65 6374 7d2f 7069 7065 6c69 6e65 7322  ject}/pipelines"
-00012a70: 2c20 6572 726f 725f 6d65 7373 6167 652c  , error_message,
-00012a80: 2070 6172 616d 733d 7061 7261 6d73 0a20   params=params. 
-00012a90: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00012aa0: 2072 6574 7572 6e20 6d6c 7275 6e2e 636f   return mlrun.co
-00012ab0: 6d6d 6f6e 2e73 6368 656d 6173 2e50 6970  mmon.schemas.Pip
-00012ac0: 656c 696e 6573 4f75 7470 7574 282a 2a72  elinesOutput(**r
-00012ad0: 6573 706f 6e73 652e 6a73 6f6e 2829 290a  esponse.json()).
-00012ae0: 0a20 2020 2064 6566 2067 6574 5f70 6970  .    def get_pip
-00012af0: 656c 696e 6528 0a20 2020 2020 2020 2073  eline(.        s
-00012b00: 656c 662c 0a20 2020 2020 2020 2072 756e  elf,.        run
-00012b10: 5f69 643a 2073 7472 2c0a 2020 2020 2020  _id: str,.      
-00012b20: 2020 6e61 6d65 7370 6163 653a 2073 7472    namespace: str
-00012b30: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-00012b40: 2074 696d 656f 7574 3a20 696e 7420 3d20   timeout: int = 
-00012b50: 3330 2c0a 2020 2020 2020 2020 666f 726d  30,.        form
-00012b60: 6174 5f3a 2055 6e69 6f6e 5b0a 2020 2020  at_: Union[.    
-00012b70: 2020 2020 2020 2020 7374 722c 206d 6c72          str, mlr
-00012b80: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
-00012b90: 732e 5069 7065 6c69 6e65 7346 6f72 6d61  s.PipelinesForma
-00012ba0: 740a 2020 2020 2020 2020 5d20 3d20 6d6c  t.        ] = ml
-00012bb0: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
-00012bc0: 6173 2e50 6970 656c 696e 6573 466f 726d  as.PipelinesForm
-00012bd0: 6174 2e73 756d 6d61 7279 2c0a 2020 2020  at.summary,.    
-00012be0: 2020 2020 7072 6f6a 6563 743a 2073 7472      project: str
-00012bf0: 203d 204e 6f6e 652c 0a20 2020 2029 3a0a   = None,.    ):.
-00012c00: 2020 2020 2020 2020 2222 2252 6574 7269          """Retri
-00012c10: 6576 6520 6465 7461 696c 7320 6f66 2061  eve details of a
-00012c20: 2073 7065 6369 6669 6320 7069 7065 6c69   specific pipeli
-00012c30: 6e65 2075 7369 6e67 2069 7473 2072 756e  ne using its run
-00012c40: 2049 4420 2861 7320 7072 6f76 6964 6564   ID (as provided
-00012c50: 2077 6865 6e20 7468 6520 7069 7065 6c69   when the pipeli
-00012c60: 6e65 2077 6173 2065 7865 6375 7465 6429  ne was executed)
-00012c70: 2e22 2222 0a0a 2020 2020 2020 2020 7061  ."""..        pa
-00012c80: 7261 6d73 203d 207b 7d0a 2020 2020 2020  rams = {}.      
-00012c90: 2020 6966 206e 616d 6573 7061 6365 3a0a    if namespace:.
-00012ca0: 2020 2020 2020 2020 2020 2020 7061 7261              para
-00012cb0: 6d73 5b22 6e61 6d65 7370 6163 6522 5d20  ms["namespace"] 
-00012cc0: 3d20 6e61 6d65 7370 6163 650a 2020 2020  = namespace.    
-00012cd0: 2020 2020 7061 7261 6d73 5b22 666f 726d      params["form
-00012ce0: 6174 225d 203d 2066 6f72 6d61 745f 0a20  at"] = format_. 
-00012cf0: 2020 2020 2020 2070 726f 6a65 6374 5f70         project_p
-00012d00: 6174 6820 3d20 7072 6f6a 6563 7420 6966  ath = project if
-00012d10: 2070 726f 6a65 6374 2065 6c73 6520 222a   project else "*
-00012d20: 220a 2020 2020 2020 2020 7265 7370 203d  ".        resp =
-00012d30: 2073 656c 662e 6170 695f 6361 6c6c 280a   self.api_call(.
-00012d40: 2020 2020 2020 2020 2020 2020 2247 4554              "GET
-00012d50: 222c 0a20 2020 2020 2020 2020 2020 2066  ",.            f
-00012d60: 2270 726f 6a65 6374 732f 7b70 726f 6a65  "projects/{proje
-00012d70: 6374 5f70 6174 687d 2f70 6970 656c 696e  ct_path}/pipelin
-00012d80: 6573 2f7b 7275 6e5f 6964 7d22 2c0a 2020  es/{run_id}",.  
-00012d90: 2020 2020 2020 2020 2020 7061 7261 6d73            params
-00012da0: 3d70 6172 616d 732c 0a20 2020 2020 2020  =params,.       
-00012db0: 2020 2020 2074 696d 656f 7574 3d74 696d       timeout=tim
-00012dc0: 656f 7574 2c0a 2020 2020 2020 2020 290a  eout,.        ).
-00012dd0: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-00012de0: 7265 7370 2e6f 6b3a 0a20 2020 2020 2020  resp.ok:.       
-00012df0: 2020 2020 206c 6f67 6765 722e 6572 726f       logger.erro
-00012e00: 7228 6622 6261 6420 7265 7370 2121 5c6e  r(f"bad resp!!\n
-00012e10: 7b72 6573 702e 7465 7874 7d22 290a 2020  {resp.text}").  
-00012e20: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00012e30: 5661 6c75 6545 7272 6f72 2866 2262 6164  ValueError(f"bad
-00012e40: 2067 6574 2070 6970 656c 696e 6520 7265   get pipeline re
-00012e50: 7370 6f6e 7365 2c20 7b72 6573 702e 7465  sponse, {resp.te
-00012e60: 7874 7d22 290a 0a20 2020 2020 2020 2072  xt}")..        r
-00012e70: 6574 7572 6e20 7265 7370 2e6a 736f 6e28  eturn resp.json(
-00012e80: 290a 0a20 2020 2040 7374 6174 6963 6d65  )..    @staticme
-00012e90: 7468 6f64 0a20 2020 2064 6566 205f 7265  thod.    def _re
-00012ea0: 736f 6c76 655f 7265 6665 7265 6e63 6528  solve_reference(
-00012eb0: 7461 672c 2075 6964 293a 0a20 2020 2020  tag, uid):.     
-00012ec0: 2020 2069 6620 7569 6420 616e 6420 7461     if uid and ta
-00012ed0: 673a 0a20 2020 2020 2020 2020 2020 2072  g:.            r
-00012ee0: 6169 7365 204d 4c52 756e 496e 7661 6c69  aise MLRunInvali
-00012ef0: 6441 7267 756d 656e 7445 7272 6f72 2822  dArgumentError("
-00012f00: 626f 7468 2075 6964 2061 6e64 2074 6167  both uid and tag
-00012f10: 2077 6572 6520 7072 6f76 6964 6564 2229   were provided")
-00012f20: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00012f30: 7569 6420 6f72 2074 6167 206f 7220 226c  uid or tag or "l
-00012f40: 6174 6573 7422 0a0a 2020 2020 6465 6620  atest"..    def 
-00012f50: 6372 6561 7465 5f66 6561 7475 7265 5f73  create_feature_s
-00012f60: 6574 280a 2020 2020 2020 2020 7365 6c66  et(.        self
-00012f70: 2c0a 2020 2020 2020 2020 6665 6174 7572  ,.        featur
-00012f80: 655f 7365 743a 2055 6e69 6f6e 5b64 6963  e_set: Union[dic
-00012f90: 742c 206d 6c72 756e 2e63 6f6d 6d6f 6e2e  t, mlrun.common.
-00012fa0: 7363 6865 6d61 732e 4665 6174 7572 6553  schemas.FeatureS
-00012fb0: 6574 2c20 4665 6174 7572 6553 6574 5d2c  et, FeatureSet],
-00012fc0: 0a20 2020 2020 2020 2070 726f 6a65 6374  .        project
-00012fd0: 3d22 222c 0a20 2020 2020 2020 2076 6572  ="",.        ver
-00012fe0: 7369 6f6e 6564 3d54 7275 652c 0a20 2020  sioned=True,.   
-00012ff0: 2029 202d 3e20 6469 6374 3a0a 2020 2020   ) -> dict:.    
-00013000: 2020 2020 2222 2243 7265 6174 6520 6120      """Create a 
-00013010: 6e65 7720 3a70 793a 636c 6173 733a 607e  new :py:class:`~
-00013020: 6d6c 7275 6e2e 6665 6174 7572 655f 7374  mlrun.feature_st
-00013030: 6f72 652e 4665 6174 7572 6553 6574 6020  ore.FeatureSet` 
-00013040: 616e 6420 7361 7665 2069 6e20 7468 6520  and save in the 
-00013050: 3a70 793a 6d6f 643a 606d 6c72 756e 6020  :py:mod:`mlrun` 
-00013060: 4442 2e20 5468 650a 2020 2020 2020 2020  DB. The.        
-00013070: 6665 6174 7572 652d 7365 7420 6d75 7374  feature-set must
-00013080: 206e 6f74 2070 7265 7669 6f75 736c 7920   not previously 
-00013090: 6578 6973 7420 696e 2074 6865 2044 422e  exist in the DB.
-000130a0: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-000130b0: 2066 6561 7475 7265 5f73 6574 3a20 5468   feature_set: Th
-000130c0: 6520 6e65 7720 3a70 793a 636c 6173 733a  e new :py:class:
-000130d0: 607e 6d6c 7275 6e2e 6665 6174 7572 655f  `~mlrun.feature_
-000130e0: 7374 6f72 652e 4665 6174 7572 6553 6574  store.FeatureSet
-000130f0: 6020 746f 2063 7265 6174 652e 0a20 2020  ` to create..   
-00013100: 2020 2020 203a 7061 7261 6d20 7072 6f6a       :param proj
-00013110: 6563 743a 204e 616d 6520 6f66 2070 726f  ect: Name of pro
-00013120: 6a65 6374 2074 6869 7320 6665 6174 7572  ject this featur
-00013130: 652d 7365 7420 6265 6c6f 6e67 7320 746f  e-set belongs to
-00013140: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00013150: 2076 6572 7369 6f6e 6564 3a20 5768 6574   versioned: Whet
-00013160: 6865 7220 746f 206d 6169 6e74 6169 6e20  her to maintain 
-00013170: 7665 7273 696f 6e73 2066 6f72 2074 6869  versions for thi
-00013180: 7320 6665 6174 7572 652d 7365 742e 2041  s feature-set. A
-00013190: 6c6c 2076 6572 7369 6f6e 7320 6f66 2061  ll versions of a
-000131a0: 2076 6572 7369 6f6e 6564 206f 626a 6563   versioned objec
-000131b0: 740a 2020 2020 2020 2020 2020 2020 7769  t.            wi
-000131c0: 6c6c 2062 6520 6b65 7074 2069 6e20 7468  ll be kept in th
-000131d0: 6520 4442 2061 6e64 2063 616e 2062 6520  e DB and can be 
-000131e0: 7265 7472 6965 7665 6420 756e 7469 6c20  retrieved until 
-000131f0: 6578 706c 6963 6974 6c79 2064 656c 6574  explicitly delet
-00013200: 6564 2e0a 2020 2020 2020 2020 3a72 6574  ed..        :ret
-00013210: 7572 6e73 3a20 5468 6520 3a70 793a 636c  urns: The :py:cl
-00013220: 6173 733a 607e 6d6c 7275 6e2e 6665 6174  ass:`~mlrun.feat
-00013230: 7572 655f 7374 6f72 652e 4665 6174 7572  ure_store.Featur
-00013240: 6553 6574 6020 6f62 6a65 6374 2028 6173  eSet` object (as
-00013250: 2064 6963 7429 2e0a 2020 2020 2020 2020   dict)..        
-00013260: 2222 220a 2020 2020 2020 2020 6966 2069  """.        if i
-00013270: 7369 6e73 7461 6e63 6528 6665 6174 7572  sinstance(featur
-00013280: 655f 7365 742c 206d 6c72 756e 2e63 6f6d  e_set, mlrun.com
-00013290: 6d6f 6e2e 7363 6865 6d61 732e 4665 6174  mon.schemas.Feat
-000132a0: 7572 6553 6574 293a 0a20 2020 2020 2020  ureSet):.       
-000132b0: 2020 2020 2066 6561 7475 7265 5f73 6574       feature_set
-000132c0: 203d 2066 6561 7475 7265 5f73 6574 2e64   = feature_set.d
-000132d0: 6963 7428 290a 2020 2020 2020 2020 656c  ict().        el
-000132e0: 6966 2069 7369 6e73 7461 6e63 6528 6665  if isinstance(fe
-000132f0: 6174 7572 655f 7365 742c 2046 6561 7475  ature_set, Featu
-00013300: 7265 5365 7429 3a0a 2020 2020 2020 2020  reSet):.        
-00013310: 2020 2020 6665 6174 7572 655f 7365 7420      feature_set 
-00013320: 3d20 6665 6174 7572 655f 7365 742e 746f  = feature_set.to
-00013330: 5f64 6963 7428 290a 0a20 2020 2020 2020  _dict()..       
-00013340: 2070 726f 6a65 6374 203d 2028 0a20 2020   project = (.   
-00013350: 2020 2020 2020 2020 2070 726f 6a65 6374           project
-00013360: 0a20 2020 2020 2020 2020 2020 206f 7220  .            or 
-00013370: 6665 6174 7572 655f 7365 745b 226d 6574  feature_set["met
-00013380: 6164 6174 6122 5d2e 6765 7428 2270 726f  adata"].get("pro
-00013390: 6a65 6374 222c 204e 6f6e 6529 0a20 2020  ject", None).   
-000133a0: 2020 2020 2020 2020 206f 7220 636f 6e66           or conf
-000133b0: 6967 2e64 6566 6175 6c74 5f70 726f 6a65  ig.default_proje
-000133c0: 6374 0a20 2020 2020 2020 2029 0a20 2020  ct.        ).   
-000133d0: 2020 2020 2070 6174 6820 3d20 6622 7072       path = f"pr
-000133e0: 6f6a 6563 7473 2f7b 7072 6f6a 6563 747d  ojects/{project}
-000133f0: 2f66 6561 7475 7265 2d73 6574 7322 0a20  /feature-sets". 
-00013400: 2020 2020 2020 2070 6172 616d 7320 3d20         params = 
-00013410: 7b22 7665 7273 696f 6e65 6422 3a20 7665  {"versioned": ve
-00013420: 7273 696f 6e65 647d 0a0a 2020 2020 2020  rsioned}..      
-00013430: 2020 6e61 6d65 203d 2066 6561 7475 7265    name = feature
-00013440: 5f73 6574 5b22 6d65 7461 6461 7461 225d  _set["metadata"]
-00013450: 5b22 6e61 6d65 225d 0a20 2020 2020 2020  ["name"].       
-00013460: 2065 7272 6f72 5f6d 6573 7361 6765 203d   error_message =
-00013470: 2066 2246 6169 6c65 6420 6372 6561 7469   f"Failed creati
-00013480: 6e67 2066 6561 7475 7265 2d73 6574 207b  ng feature-set {
-00013490: 7072 6f6a 6563 747d 2f7b 6e61 6d65 7d22  project}/{name}"
-000134a0: 0a20 2020 2020 2020 2072 6573 7020 3d20  .        resp = 
-000134b0: 7365 6c66 2e61 7069 5f63 616c 6c28 0a20  self.api_call(. 
-000134c0: 2020 2020 2020 2020 2020 2022 504f 5354             "POST
-000134d0: 222c 0a20 2020 2020 2020 2020 2020 2070  ",.            p
-000134e0: 6174 682c 0a20 2020 2020 2020 2020 2020  ath,.           
-000134f0: 2065 7272 6f72 5f6d 6573 7361 6765 2c0a   error_message,.
-00013500: 2020 2020 2020 2020 2020 2020 7061 7261              para
-00013510: 6d73 3d70 6172 616d 732c 0a20 2020 2020  ms=params,.     
-00013520: 2020 2020 2020 2062 6f64 793d 6469 6374         body=dict
-00013530: 5f74 6f5f 6a73 6f6e 2866 6561 7475 7265  _to_json(feature
-00013540: 5f73 6574 292c 0a20 2020 2020 2020 2029  _set),.        )
-00013550: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00013560: 7265 7370 2e6a 736f 6e28 290a 0a20 2020  resp.json()..   
-00013570: 2064 6566 2067 6574 5f66 6561 7475 7265   def get_feature
-00013580: 5f73 6574 280a 2020 2020 2020 2020 7365  _set(.        se
-00013590: 6c66 2c20 6e61 6d65 3a20 7374 722c 2070  lf, name: str, p
-000135a0: 726f 6a65 6374 3a20 7374 7220 3d20 2222  roject: str = ""
-000135b0: 2c20 7461 673a 2073 7472 203d 204e 6f6e  , tag: str = Non
-000135c0: 652c 2075 6964 3a20 7374 7220 3d20 4e6f  e, uid: str = No
-000135d0: 6e65 0a20 2020 2029 202d 3e20 4665 6174  ne.    ) -> Feat
-000135e0: 7572 6553 6574 3a0a 2020 2020 2020 2020  ureSet:.        
-000135f0: 2222 2252 6574 7269 6576 6520 6120 7e6d  """Retrieve a ~m
-00013600: 6c72 756e 2e66 6561 7475 7265 5f73 746f  lrun.feature_sto
-00013610: 7265 2e46 6561 7475 7265 5365 7460 206f  re.FeatureSet` o
-00013620: 626a 6563 742e 2049 6620 626f 7468 2060  bject. If both `
-00013630: 6074 6167 6060 2061 6e64 2060 6075 6964  `tag`` and ``uid
-00013640: 6060 2061 7265 206e 6f74 2073 7065 6369  `` are not speci
-00013650: 6669 6564 2c20 7468 656e 0a20 2020 2020  fied, then.     
-00013660: 2020 2074 6865 206f 626a 6563 7420 7461     the object ta
-00013670: 6767 6564 2060 606c 6174 6573 7460 6020  gged ``latest`` 
-00013680: 7769 6c6c 2062 6520 7265 7472 6965 7665  will be retrieve
-00013690: 642e 0a0a 2020 2020 2020 2020 3a70 6172  d...        :par
-000136a0: 616d 206e 616d 653a 204e 616d 6520 6f66  am name: Name of
-000136b0: 206f 626a 6563 7420 746f 2072 6574 7269   object to retri
-000136c0: 6576 652e 0a20 2020 2020 2020 203a 7061  eve..        :pa
-000136d0: 7261 6d20 7072 6f6a 6563 743a 2050 726f  ram project: Pro
-000136e0: 6a65 6374 2074 6865 2046 6561 7475 7265  ject the Feature
-000136f0: 5365 7420 6265 6c6f 6e67 7320 746f 2e0a  Set belongs to..
-00013700: 2020 2020 2020 2020 3a70 6172 616d 2074          :param t
-00013710: 6167 3a20 5461 6720 6f66 2074 6865 2073  ag: Tag of the s
-00013720: 7065 6369 6669 6320 6f62 6a65 6374 2076  pecific object v
-00013730: 6572 7369 6f6e 2074 6f20 7265 7472 6965  ersion to retrie
-00013740: 7665 2e0a 2020 2020 2020 2020 3a70 6172  ve..        :par
-00013750: 616d 2075 6964 3a20 7569 6420 6f66 2074  am uid: uid of t
-00013760: 6865 206f 626a 6563 7420 746f 2072 6574  he object to ret
-00013770: 7269 6576 6520 2863 616e 206f 6e6c 7920  rieve (can only 
-00013780: 6265 2075 7365 6420 666f 7220 7665 7273  be used for vers
-00013790: 696f 6e65 6420 6f62 6a65 6374 7329 2e0a  ioned objects)..
-000137a0: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
-000137b0: 2020 2020 2070 726f 6a65 6374 203d 2070       project = p
-000137c0: 726f 6a65 6374 206f 7220 636f 6e66 6967  roject or config
-000137d0: 2e64 6566 6175 6c74 5f70 726f 6a65 6374  .default_project
-000137e0: 0a20 2020 2020 2020 2072 6566 6572 656e  .        referen
-000137f0: 6365 203d 2073 656c 662e 5f72 6573 6f6c  ce = self._resol
-00013800: 7665 5f72 6566 6572 656e 6365 2874 6167  ve_reference(tag
-00013810: 2c20 7569 6429 0a20 2020 2020 2020 2070  , uid).        p
-00013820: 6174 6820 3d20 6622 7072 6f6a 6563 7473  ath = f"projects
-00013830: 2f7b 7072 6f6a 6563 747d 2f66 6561 7475  /{project}/featu
-00013840: 7265 2d73 6574 732f 7b6e 616d 657d 2f72  re-sets/{name}/r
-00013850: 6566 6572 656e 6365 732f 7b72 6566 6572  eferences/{refer
-00013860: 656e 6365 7d22 0a20 2020 2020 2020 2065  ence}".        e
-00013870: 7272 6f72 5f6d 6573 7361 6765 203d 2066  rror_message = f
-00013880: 2246 6169 6c65 6420 7265 7472 6965 7669  "Failed retrievi
-00013890: 6e67 2066 6561 7475 7265 2d73 6574 207b  ng feature-set {
-000138a0: 7072 6f6a 6563 747d 2f7b 6e61 6d65 7d22  project}/{name}"
-000138b0: 0a20 2020 2020 2020 2072 6573 7020 3d20  .        resp = 
-000138c0: 7365 6c66 2e61 7069 5f63 616c 6c28 2247  self.api_call("G
-000138d0: 4554 222c 2070 6174 682c 2065 7272 6f72  ET", path, error
-000138e0: 5f6d 6573 7361 6765 290a 2020 2020 2020  _message).      
-000138f0: 2020 7265 7475 726e 2046 6561 7475 7265    return Feature
-00013900: 5365 742e 6672 6f6d 5f64 6963 7428 7265  Set.from_dict(re
-00013910: 7370 2e6a 736f 6e28 2929 0a0a 2020 2020  sp.json())..    
-00013920: 6465 6620 6c69 7374 5f66 6561 7475 7265  def list_feature
-00013930: 7328 0a20 2020 2020 2020 2073 656c 662c  s(.        self,
-00013940: 0a20 2020 2020 2020 2070 726f 6a65 6374  .        project
-00013950: 3a20 7374 722c 0a20 2020 2020 2020 206e  : str,.        n
-00013960: 616d 653a 2073 7472 203d 204e 6f6e 652c  ame: str = None,
-00013970: 0a20 2020 2020 2020 2074 6167 3a20 7374  .        tag: st
-00013980: 7220 3d20 4e6f 6e65 2c0a 2020 2020 2020  r = None,.      
-00013990: 2020 656e 7469 7469 6573 3a20 6c69 7374    entities: list
-000139a0: 5b73 7472 5d20 3d20 4e6f 6e65 2c0a 2020  [str] = None,.  
-000139b0: 2020 2020 2020 6c61 6265 6c73 3a20 6c69        labels: li
-000139c0: 7374 5b73 7472 5d20 3d20 4e6f 6e65 2c0a  st[str] = None,.
-000139d0: 2020 2020 2920 2d3e 206c 6973 745b 6469      ) -> list[di
-000139e0: 6374 5d3a 0a20 2020 2020 2020 2022 2222  ct]:.        """
-000139f0: 4c69 7374 2066 6561 7475 7265 2d73 6574  List feature-set
-00013a00: 7320 7768 6963 6820 636f 6e74 6169 6e20  s which contain 
-00013a10: 7370 6563 6966 6963 2066 6561 7475 7265  specific feature
-00013a20: 732e 2054 6869 7320 6675 6e63 7469 6f6e  s. This function
-00013a30: 206d 6179 2072 6574 7572 6e20 6d75 6c74   may return mult
-00013a40: 6970 6c65 2076 6572 7369 6f6e 7320 6f66  iple versions of
-00013a50: 2074 6865 2073 616d 650a 2020 2020 2020   the same.      
-00013a60: 2020 6665 6174 7572 652d 7365 7420 6966    feature-set if
-00013a70: 2061 2073 7065 6369 6669 6320 7461 6720   a specific tag 
-00013a80: 6973 206e 6f74 2072 6571 7565 7374 6564  is not requested
-00013a90: 2e20 4e6f 7465 2074 6861 7420 7468 6520  . Note that the 
-00013aa0: 7661 7269 6f75 7320 6669 6c74 6572 7320  various filters 
-00013ab0: 6f66 2074 6869 7320 6675 6e63 7469 6f6e  of this function
-00013ac0: 2061 6374 7561 6c6c 790a 2020 2020 2020   actually.      
-00013ad0: 2020 7265 6665 7220 746f 2074 6865 2066    refer to the f
-00013ae0: 6561 7475 7265 2d73 6574 206f 626a 6563  eature-set objec
-00013af0: 7420 636f 6e74 6169 6e69 6e67 2074 6865  t containing the
-00013b00: 2066 6561 7475 7265 732c 206e 6f74 2074   features, not t
-00013b10: 6f20 7468 6520 6665 6174 7572 6573 2074  o the features t
-00013b20: 6865 6d73 656c 7665 732e 0a0a 2020 2020  hemselves...    
-00013b30: 2020 2020 3a70 6172 616d 2070 726f 6a65      :param proje
-00013b40: 6374 3a20 5072 6f6a 6563 7420 7768 6963  ct: Project whic
-00013b50: 6820 636f 6e74 6169 6e73 2074 6865 7365  h contains these
-00013b60: 2066 6561 7475 7265 732e 0a20 2020 2020   features..     
-00013b70: 2020 203a 7061 7261 6d20 6e61 6d65 3a20     :param name: 
-00013b80: 4e61 6d65 206f 6620 7468 6520 6665 6174  Name of the feat
-00013b90: 7572 6520 746f 206c 6f6f 6b20 666f 722e  ure to look for.
-00013ba0: 2054 6865 206e 616d 6520 6973 2075 7365   The name is use
-00013bb0: 6420 696e 2061 206c 696b 6520 7175 6572  d in a like quer
-00013bc0: 792c 2061 6e64 2069 7320 6e6f 7420 6361  y, and is not ca
-00013bd0: 7365 2d73 656e 7369 7469 7665 2e20 466f  se-sensitive. Fo
-00013be0: 720a 2020 2020 2020 2020 2020 2020 6578  r.            ex
-00013bf0: 616d 706c 652c 206c 6f6f 6b69 6e67 2066  ample, looking f
-00013c00: 6f72 2060 6066 6561 7460 6020 7769 6c6c  or ``feat`` will
-00013c10: 2072 6574 7572 6e20 6665 6174 7572 6573   return features
-00013c20: 2077 6869 6368 2061 7265 206e 616d 6564   which are named
-00013c30: 2060 604d 7946 6561 7475 7265 6060 2061   ``MyFeature`` a
-00013c40: 7320 7765 6c6c 2061 7320 6060 6465 6665  s well as ``defe
-00013c50: 6174 6060 2e0a 2020 2020 2020 2020 3a70  at``..        :p
-00013c60: 6172 616d 2074 6167 3a20 5265 7475 726e  aram tag: Return
-00013c70: 2066 6561 7475 7265 2d73 6574 7320 7768   feature-sets wh
-00013c80: 6963 6820 636f 6e74 6169 6e20 7468 6520  ich contain the 
-00013c90: 6665 6174 7572 6573 206c 6f6f 6b65 6420  features looked 
-00013ca0: 666f 722c 2061 6e64 2061 7265 2074 6167  for, and are tag
-00013cb0: 6765 6420 7769 7468 2074 6865 2073 7065  ged with the spe
-00013cc0: 6369 6669 6320 7461 672e 0a20 2020 2020  cific tag..     
-00013cd0: 2020 203a 7061 7261 6d20 656e 7469 7469     :param entiti
-00013ce0: 6573 3a20 5265 7475 726e 206f 6e6c 7920  es: Return only 
-00013cf0: 6665 6174 7572 652d 7365 7473 2077 6869  feature-sets whi
-00013d00: 6368 2063 6f6e 7461 696e 2061 6e20 656e  ch contain an en
-00013d10: 7469 7479 2077 686f 7365 206e 616d 6520  tity whose name 
-00013d20: 6973 2063 6f6e 7461 696e 6564 2069 6e20  is contained in 
-00013d30: 7468 6973 206c 6973 742e 0a20 2020 2020  this list..     
-00013d40: 2020 203a 7061 7261 6d20 6c61 6265 6c73     :param labels
-00013d50: 3a20 5265 7475 726e 206f 6e6c 7920 6665  : Return only fe
-00013d60: 6174 7572 652d 7365 7473 2077 6869 6368  ature-sets which
-00013d70: 2061 7265 206c 6162 656c 6564 2061 7320   are labeled as 
-00013d80: 7265 7175 6573 7465 642e 0a20 2020 2020  requested..     
-00013d90: 2020 203a 7265 7475 726e 733a 2041 206c     :returns: A l
-00013da0: 6973 7420 6f66 206d 6170 7069 6e67 2066  ist of mapping f
-00013db0: 726f 6d20 6665 6174 7572 6520 746f 2061  rom feature to a
-00013dc0: 2064 6967 6573 7420 6f66 2074 6865 2066   digest of the f
-00013dd0: 6561 7475 7265 2d73 6574 2c20 7768 6963  eature-set, whic
-00013de0: 6820 636f 6e74 6169 6e73 2074 6865 2066  h contains the f
-00013df0: 6561 7475 7265 2d73 6574 0a20 2020 2020  eature-set.     
-00013e00: 2020 2020 2020 206d 6574 612d 6461 7461         meta-data
-00013e10: 2e20 4d75 6c74 6970 6c65 2065 6e74 7269  . Multiple entri
-00013e20: 6573 206d 6179 2062 6520 7265 7475 726e  es may be return
-00013e30: 6564 2066 6f72 2061 6e79 2073 7065 6369  ed for any speci
-00013e40: 6669 6320 6665 6174 7572 6520 6475 6520  fic feature due 
-00013e50: 746f 206d 756c 7469 706c 6520 7461 6773  to multiple tags
-00013e60: 206f 7220 7665 7273 696f 6e73 0a20 2020   or versions.   
-00013e70: 2020 2020 2020 2020 206f 6620 7468 6520           of the 
-00013e80: 6665 6174 7572 652d 7365 742e 0a20 2020  feature-set..   
-00013e90: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
-00013ea0: 2020 7072 6f6a 6563 7420 3d20 7072 6f6a    project = proj
-00013eb0: 6563 7420 6f72 2063 6f6e 6669 672e 6465  ect or config.de
-00013ec0: 6661 756c 745f 7072 6f6a 6563 740a 2020  fault_project.  
-00013ed0: 2020 2020 2020 7061 7261 6d73 203d 207b        params = {
-00013ee0: 0a20 2020 2020 2020 2020 2020 2022 6e61  .            "na
-00013ef0: 6d65 223a 206e 616d 652c 0a20 2020 2020  me": name,.     
-00013f00: 2020 2020 2020 2022 7461 6722 3a20 7461         "tag": ta
-00013f10: 672c 0a20 2020 2020 2020 2020 2020 2022  g,.            "
-00013f20: 656e 7469 7479 223a 2065 6e74 6974 6965  entity": entitie
-00013f30: 7320 6f72 205b 5d2c 0a20 2020 2020 2020  s or [],.       
-00013f40: 2020 2020 2022 6c61 6265 6c22 3a20 6c61       "label": la
-00013f50: 6265 6c73 206f 7220 5b5d 2c0a 2020 2020  bels or [],.    
-00013f60: 2020 2020 7d0a 0a20 2020 2020 2020 2070      }..        p
-00013f70: 6174 6820 3d20 6622 7072 6f6a 6563 7473  ath = f"projects
-00013f80: 2f7b 7072 6f6a 6563 747d 2f66 6561 7475  /{project}/featu
-00013f90: 7265 7322 0a0a 2020 2020 2020 2020 6572  res"..        er
-00013fa0: 726f 725f 6d65 7373 6167 6520 3d20 6622  ror_message = f"
-00013fb0: 4661 696c 6564 206c 6973 7469 6e67 2066  Failed listing f
-00013fc0: 6561 7475 7265 732c 2070 726f 6a65 6374  eatures, project
-00013fd0: 3a20 7b70 726f 6a65 6374 7d2c 2071 7565  : {project}, que
-00013fe0: 7279 3a20 7b70 6172 616d 737d 220a 2020  ry: {params}".  
-00013ff0: 2020 2020 2020 7265 7370 203d 2073 656c        resp = sel
-00014000: 662e 6170 695f 6361 6c6c 2822 4745 5422  f.api_call("GET"
-00014010: 2c20 7061 7468 2c20 6572 726f 725f 6d65  , path, error_me
-00014020: 7373 6167 652c 2070 6172 616d 733d 7061  ssage, params=pa
-00014030: 7261 6d73 290a 2020 2020 2020 2020 7265  rams).        re
-00014040: 7475 726e 2072 6573 702e 6a73 6f6e 2829  turn resp.json()
-00014050: 5b22 6665 6174 7572 6573 225d 0a0a 2020  ["features"]..  
-00014060: 2020 6465 6620 6c69 7374 5f65 6e74 6974    def list_entit
-00014070: 6965 7328 0a20 2020 2020 2020 2073 656c  ies(.        sel
-00014080: 662c 0a20 2020 2020 2020 2070 726f 6a65  f,.        proje
-00014090: 6374 3a20 7374 722c 0a20 2020 2020 2020  ct: str,.       
-000140a0: 206e 616d 653a 2073 7472 203d 204e 6f6e   name: str = Non
-000140b0: 652c 0a20 2020 2020 2020 2074 6167 3a20  e,.        tag: 
-000140c0: 7374 7220 3d20 4e6f 6e65 2c0a 2020 2020  str = None,.    
-000140d0: 2020 2020 6c61 6265 6c73 3a20 6c69 7374      labels: list
-000140e0: 5b73 7472 5d20 3d20 4e6f 6e65 2c0a 2020  [str] = None,.  
-000140f0: 2020 2920 2d3e 206c 6973 745b 6469 6374    ) -> list[dict
-00014100: 5d3a 0a20 2020 2020 2020 2022 2222 5265  ]:.        """Re
-00014110: 7472 6965 7665 2061 206c 6973 7420 6f66  trieve a list of
-00014120: 2065 6e74 6974 6965 7320 616e 6420 7468   entities and th
-00014130: 6569 7220 6d61 7070 696e 6720 746f 2074  eir mapping to t
-00014140: 6865 2063 6f6e 7461 696e 696e 6720 6665  he containing fe
-00014150: 6174 7572 652d 7365 7473 2e20 5468 6973  ature-sets. This
-00014160: 2066 756e 6374 696f 6e20 6973 2073 696d   function is sim
-00014170: 696c 6172 0a20 2020 2020 2020 2074 6f20  ilar.        to 
-00014180: 7468 6520 3a70 793a 6675 6e63 3a60 7e6c  the :py:func:`~l
-00014190: 6973 745f 6665 6174 7572 6573 6020 6675  ist_features` fu
-000141a0: 6e63 7469 6f6e 2c20 616e 6420 7573 6573  nction, and uses
-000141b0: 2074 6865 2073 616d 6520 6c6f 6769 632e   the same logic.
-000141c0: 2048 6f77 6576 6572 2c20 7468 6520 656e   However, the en
-000141d0: 7469 7469 6573 2061 7265 206d 6174 6368  tities are match
-000141e0: 6564 0a20 2020 2020 2020 2061 6761 696e  ed.        again
-000141f0: 7374 2074 6865 206e 616d 6520 7261 7468  st the name rath
-00014200: 6572 2074 6861 6e20 7468 6520 6665 6174  er than the feat
-00014210: 7572 6573 2e0a 2020 2020 2020 2020 2222  ures..        ""
-00014220: 220a 0a20 2020 2020 2020 2070 726f 6a65  "..        proje
-00014230: 6374 203d 2070 726f 6a65 6374 206f 7220  ct = project or 
-00014240: 636f 6e66 6967 2e64 6566 6175 6c74 5f70  config.default_p
-00014250: 726f 6a65 6374 0a20 2020 2020 2020 2070  roject.        p
-00014260: 6172 616d 7320 3d20 7b0a 2020 2020 2020  arams = {.      
-00014270: 2020 2020 2020 226e 616d 6522 3a20 6e61        "name": na
-00014280: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
-00014290: 2274 6167 223a 2074 6167 2c0a 2020 2020  "tag": tag,.    
-000142a0: 2020 2020 2020 2020 226c 6162 656c 223a          "label":
-000142b0: 206c 6162 656c 7320 6f72 205b 5d2c 0a20   labels or [],. 
-000142c0: 2020 2020 2020 207d 0a0a 2020 2020 2020         }..      
-000142d0: 2020 7061 7468 203d 2066 2270 726f 6a65    path = f"proje
-000142e0: 6374 732f 7b70 726f 6a65 6374 7d2f 656e  cts/{project}/en
-000142f0: 7469 7469 6573 220a 0a20 2020 2020 2020  tities"..       
-00014300: 2065 7272 6f72 5f6d 6573 7361 6765 203d   error_message =
-00014310: 2066 2246 6169 6c65 6420 6c69 7374 696e   f"Failed listin
-00014320: 6720 656e 7469 7469 6573 2c20 7072 6f6a  g entities, proj
-00014330: 6563 743a 207b 7072 6f6a 6563 747d 2c20  ect: {project}, 
-00014340: 7175 6572 793a 207b 7061 7261 6d73 7d22  query: {params}"
-00014350: 0a20 2020 2020 2020 2072 6573 7020 3d20  .        resp = 
-00014360: 7365 6c66 2e61 7069 5f63 616c 6c28 2247  self.api_call("G
-00014370: 4554 222c 2070 6174 682c 2065 7272 6f72  ET", path, error
-00014380: 5f6d 6573 7361 6765 2c20 7061 7261 6d73  _message, params
-00014390: 3d70 6172 616d 7329 0a20 2020 2020 2020  =params).       
-000143a0: 2072 6574 7572 6e20 7265 7370 2e6a 736f   return resp.jso
-000143b0: 6e28 295b 2265 6e74 6974 6965 7322 5d0a  n()["entities"].
-000143c0: 0a20 2020 2040 7374 6174 6963 6d65 7468  .    @staticmeth
-000143d0: 6f64 0a20 2020 2064 6566 205f 6765 6e65  od.    def _gene
-000143e0: 7261 7465 5f70 6172 7469 7469 6f6e 5f62  rate_partition_b
-000143f0: 795f 7061 7261 6d73 280a 2020 2020 2020  y_params(.      
-00014400: 2020 7061 7274 6974 696f 6e5f 6279 5f63    partition_by_c
-00014410: 6c73 2c0a 2020 2020 2020 2020 7061 7274  ls,.        part
-00014420: 6974 696f 6e5f 6279 2c0a 2020 2020 2020  ition_by,.      
-00014430: 2020 726f 7773 5f70 6572 5f70 6172 7469    rows_per_parti
-00014440: 7469 6f6e 2c0a 2020 2020 2020 2020 736f  tion,.        so
-00014450: 7274 5f62 792c 0a20 2020 2020 2020 206f  rt_by,.        o
-00014460: 7264 6572 2c0a 2020 2020 2020 2020 6d61  rder,.        ma
-00014470: 785f 7061 7274 6974 696f 6e73 3d4e 6f6e  x_partitions=Non
-00014480: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
-00014490: 2020 7061 7274 6974 696f 6e5f 7061 7261    partition_para
-000144a0: 6d73 203d 207b 0a20 2020 2020 2020 2020  ms = {.         
-000144b0: 2020 2022 7061 7274 6974 696f 6e2d 6279     "partition-by
-000144c0: 223a 2070 6172 7469 7469 6f6e 5f62 792c  ": partition_by,
-000144d0: 0a20 2020 2020 2020 2020 2020 2022 726f  .            "ro
-000144e0: 7773 2d70 6572 2d70 6172 7469 7469 6f6e  ws-per-partition
-000144f0: 223a 2072 6f77 735f 7065 725f 7061 7274  ": rows_per_part
-00014500: 6974 696f 6e2c 0a20 2020 2020 2020 2020  ition,.         
-00014510: 2020 2022 7061 7274 6974 696f 6e2d 736f     "partition-so
-00014520: 7274 2d62 7922 3a20 736f 7274 5f62 792c  rt-by": sort_by,
-00014530: 0a20 2020 2020 2020 2020 2020 2022 7061  .            "pa
-00014540: 7274 6974 696f 6e2d 6f72 6465 7222 3a20  rtition-order": 
-00014550: 6f72 6465 722c 0a20 2020 2020 2020 207d  order,.        }
-00014560: 0a20 2020 2020 2020 2069 6620 6d61 785f  .        if max_
-00014570: 7061 7274 6974 696f 6e73 2069 7320 6e6f  partitions is no
-00014580: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-00014590: 2020 2020 7061 7274 6974 696f 6e5f 7061      partition_pa
-000145a0: 7261 6d73 5b22 6d61 782d 7061 7274 6974  rams["max-partit
-000145b0: 696f 6e73 225d 203d 206d 6178 5f70 6172  ions"] = max_par
-000145c0: 7469 7469 6f6e 730a 2020 2020 2020 2020  titions.        
-000145d0: 7265 7475 726e 2070 6172 7469 7469 6f6e  return partition
-000145e0: 5f70 6172 616d 730a 0a20 2020 2064 6566  _params..    def
-000145f0: 206c 6973 745f 6665 6174 7572 655f 7365   list_feature_se
-00014600: 7473 280a 2020 2020 2020 2020 7365 6c66  ts(.        self
-00014610: 2c0a 2020 2020 2020 2020 7072 6f6a 6563  ,.        projec
-00014620: 743a 2073 7472 203d 2022 222c 0a20 2020  t: str = "",.   
-00014630: 2020 2020 206e 616d 653a 2073 7472 203d       name: str =
-00014640: 204e 6f6e 652c 0a20 2020 2020 2020 2074   None,.        t
-00014650: 6167 3a20 7374 7220 3d20 4e6f 6e65 2c0a  ag: str = None,.
-00014660: 2020 2020 2020 2020 7374 6174 653a 2073          state: s
-00014670: 7472 203d 204e 6f6e 652c 0a20 2020 2020  tr = None,.     
-00014680: 2020 2065 6e74 6974 6965 733a 206c 6973     entities: lis
-00014690: 745b 7374 725d 203d 204e 6f6e 652c 0a20  t[str] = None,. 
-000146a0: 2020 2020 2020 2066 6561 7475 7265 733a         features:
-000146b0: 206c 6973 745b 7374 725d 203d 204e 6f6e   list[str] = Non
-000146c0: 652c 0a20 2020 2020 2020 206c 6162 656c  e,.        label
-000146d0: 733a 206c 6973 745b 7374 725d 203d 204e  s: list[str] = N
-000146e0: 6f6e 652c 0a20 2020 2020 2020 2070 6172  one,.        par
-000146f0: 7469 7469 6f6e 5f62 793a 2055 6e69 6f6e  tition_by: Union
-00014700: 5b0a 2020 2020 2020 2020 2020 2020 6d6c  [.            ml
-00014710: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
-00014720: 6173 2e46 6561 7475 7265 5374 6f72 6550  as.FeatureStoreP
-00014730: 6172 7469 7469 6f6e 4279 4669 656c 642c  artitionByField,
-00014740: 2073 7472 0a20 2020 2020 2020 205d 203d   str.        ] =
-00014750: 204e 6f6e 652c 0a20 2020 2020 2020 2072   None,.        r
-00014760: 6f77 735f 7065 725f 7061 7274 6974 696f  ows_per_partitio
-00014770: 6e3a 2069 6e74 203d 2031 2c0a 2020 2020  n: int = 1,.    
-00014780: 2020 2020 7061 7274 6974 696f 6e5f 736f      partition_so
-00014790: 7274 5f62 793a 2055 6e69 6f6e 5b6d 6c72  rt_by: Union[mlr
-000147a0: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
-000147b0: 732e 536f 7274 4669 656c 642c 2073 7472  s.SortField, str
+00004e40: 6374 696f 6e22 290a 2020 2020 2020 2020  ction").        
+00004e50: 2020 2020 2020 2020 6f72 2063 6f6e 6669          or confi
+00004e60: 672e 6d6f 6465 6c5f 656e 6470 6f69 6e74  g.model_endpoint
+00004e70: 5f6d 6f6e 6974 6f72 696e 672e 656e 6470  _monitoring.endp
+00004e80: 6f69 6e74 5f73 746f 7265 5f63 6f6e 6e65  oint_store_conne
+00004e90: 6374 696f 6e0a 2020 2020 2020 2020 2020  ction.          
+00004ea0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00004eb0: 636f 6e66 6967 2e70 6163 6b61 6765 7273  config.packagers
+00004ec0: 203d 2073 6572 7665 725f 6366 672e 6765   = server_cfg.ge
+00004ed0: 7428 2270 6163 6b61 6765 7273 2229 206f  t("packagers") o
+00004ee0: 7220 636f 6e66 6967 2e70 6163 6b61 6765  r config.package
+00004ef0: 7273 0a20 2020 2020 2020 2020 2020 2073  rs.            s
+00004f00: 6572 7665 725f 6461 7461 5f70 7265 6669  erver_data_prefi
+00004f10: 7865 7320 3d20 7365 7276 6572 5f63 6667  xes = server_cfg
+00004f20: 2e67 6574 2822 6665 6174 7572 655f 7374  .get("feature_st
+00004f30: 6f72 655f 6461 7461 5f70 7265 6669 7865  ore_data_prefixe
+00004f40: 7322 2920 6f72 207b 7d0a 2020 2020 2020  s") or {}.      
+00004f50: 2020 2020 2020 666f 7220 7072 6566 6978        for prefix
+00004f60: 2069 6e20 5b22 6465 6661 756c 7422 2c20   in ["default", 
+00004f70: 226e 6f73 716c 222c 2022 7265 6469 736e  "nosql", "redisn
+00004f80: 6f73 716c 225d 3a0a 2020 2020 2020 2020  osql"]:.        
+00004f90: 2020 2020 2020 2020 7365 7276 6572 5f70          server_p
+00004fa0: 7265 6669 785f 7661 6c75 6520 3d20 7365  refix_value = se
+00004fb0: 7276 6572 5f64 6174 615f 7072 6566 6978  rver_data_prefix
+00004fc0: 6573 2e67 6574 2870 7265 6669 7829 0a20  es.get(prefix). 
+00004fd0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00004fe0: 6620 7365 7276 6572 5f70 7265 6669 785f  f server_prefix_
+00004ff0: 7661 6c75 6520 6973 206e 6f74 204e 6f6e  value is not Non
+00005000: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00005010: 2020 2020 2020 2073 6574 6174 7472 280a         setattr(.
+00005020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005030: 2020 2020 2020 2020 636f 6e66 6967 2e66          config.f
+00005040: 6561 7475 7265 5f73 746f 7265 2e64 6174  eature_store.dat
+00005050: 615f 7072 6566 6978 6573 2c20 7072 6566  a_prefixes, pref
+00005060: 6978 2c20 7365 7276 6572 5f70 7265 6669  ix, server_prefi
+00005070: 785f 7661 6c75 650a 2020 2020 2020 2020  x_value.        
+00005080: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00005090: 2020 2020 2020 2020 2020 636f 6e66 6967            config
+000050a0: 2e66 6561 7475 7265 5f73 746f 7265 2e64  .feature_store.d
+000050b0: 6566 6175 6c74 5f74 6172 6765 7473 203d  efault_targets =
+000050c0: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
+000050d0: 2020 2073 6572 7665 725f 6366 672e 6765     server_cfg.ge
+000050e0: 7428 2266 6561 7475 7265 5f73 746f 7265  t("feature_store
+000050f0: 5f64 6566 6175 6c74 5f74 6172 6765 7473  _default_targets
+00005100: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
+00005110: 2020 206f 7220 636f 6e66 6967 2e66 6561     or config.fea
+00005120: 7475 7265 5f73 746f 7265 2e64 6566 6175  ture_store.defau
+00005130: 6c74 5f74 6172 6765 7473 0a20 2020 2020  lt_targets.     
+00005140: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+00005150: 2020 6578 6365 7074 2045 7863 6570 7469    except Excepti
+00005160: 6f6e 2061 7320 6578 633a 0a20 2020 2020  on as exc:.     
+00005170: 2020 2020 2020 206c 6f67 6765 722e 7761         logger.wa
+00005180: 726e 696e 6728 0a20 2020 2020 2020 2020  rning(.         
+00005190: 2020 2020 2020 2022 4661 696c 6564 2073         "Failed s
+000051a0: 796e 6369 6e67 2063 6f6e 6669 6720 6672  yncing config fr
+000051b0: 6f6d 2073 6572 7665 7222 2c0a 2020 2020  om server",.    
+000051c0: 2020 2020 2020 2020 2020 2020 6578 633d              exc=
+000051d0: 6572 725f 746f 5f73 7472 2865 7863 292c  err_to_str(exc),
+000051e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000051f0: 2074 7261 6365 6261 636b 3d74 7261 6365   traceback=trace
+00005200: 6261 636b 2e66 6f72 6d61 745f 6578 6328  back.format_exc(
+00005210: 292c 0a20 2020 2020 2020 2020 2020 2029  ),.            )
+00005220: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00005230: 7365 6c66 0a0a 2020 2020 6465 6620 7374  self..    def st
+00005240: 6f72 655f 6c6f 6728 7365 6c66 2c20 7569  ore_log(self, ui
+00005250: 642c 2070 726f 6a65 6374 3d22 222c 2062  d, project="", b
+00005260: 6f64 793d 4e6f 6e65 2c20 6170 7065 6e64  ody=None, append
+00005270: 3d46 616c 7365 293a 0a20 2020 2020 2020  =False):.       
+00005280: 2022 2222 5361 7665 2061 206c 6f67 2070   """Save a log p
+00005290: 6572 7369 7374 656e 746c 792e 0a0a 2020  ersistently...  
+000052a0: 2020 2020 2020 3a70 6172 616d 2075 6964        :param uid
+000052b0: 3a20 4c6f 6720 756e 6971 7565 2049 440a  : Log unique ID.
+000052c0: 2020 2020 2020 2020 3a70 6172 616d 2070          :param p
+000052d0: 726f 6a65 6374 3a20 5072 6f6a 6563 7420  roject: Project 
+000052e0: 6e61 6d65 2066 6f72 2077 6869 6368 2074  name for which t
+000052f0: 6869 7320 6c6f 6720 6265 6c6f 6e67 730a  his log belongs.
+00005300: 2020 2020 2020 2020 3a70 6172 616d 2062          :param b
+00005310: 6f64 793a 2054 6865 2061 6374 7561 6c20  ody: The actual 
+00005320: 6c6f 6720 746f 2073 746f 7265 0a20 2020  log to store.   
+00005330: 2020 2020 203a 7061 7261 6d20 6170 7065       :param appe
+00005340: 6e64 3a20 5768 6574 6865 7220 746f 2061  nd: Whether to a
+00005350: 7070 656e 6420 7468 6520 6c6f 6720 7072  ppend the log pr
+00005360: 6f76 6964 6564 2069 6e20 6060 626f 6479  ovided in ``body
+00005370: 6060 2074 6f20 616e 2065 7869 7374 696e  `` to an existin
+00005380: 6720 6c6f 6720 7769 7468 2074 6865 2073  g log with the s
+00005390: 616d 6520 6060 7569 6460 6020 6f72 2074  ame ``uid`` or t
+000053a0: 6f0a 2020 2020 2020 2020 2020 2020 6372  o.            cr
+000053b0: 6561 7465 2061 206e 6577 206c 6f67 2e20  eate a new log. 
+000053c0: 4966 2073 6574 2074 6f20 6060 4661 6c73  If set to ``Fals
+000053d0: 6560 602c 2061 6e20 6578 6973 7469 6e67  e``, an existing
+000053e0: 206c 6f67 2077 6974 6820 7361 6d65 2060   log with same `
+000053f0: 6075 6964 6060 2077 696c 6c20 6265 206f  `uid`` will be o
+00005400: 7665 7277 7269 7474 656e 0a20 2020 2020  verwritten.     
+00005410: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
+00005420: 6966 206e 6f74 2062 6f64 793a 0a20 2020  if not body:.   
+00005430: 2020 2020 2020 2020 2072 6574 7572 6e0a           return.
+00005440: 0a20 2020 2020 2020 2070 6174 6820 3d20  .        path = 
+00005450: 7365 6c66 2e5f 7061 7468 5f6f 6628 226c  self._path_of("l
+00005460: 6f67 7322 2c20 7072 6f6a 6563 742c 2075  ogs", project, u
+00005470: 6964 290a 2020 2020 2020 2020 7061 7261  id).        para
+00005480: 6d73 203d 207b 2261 7070 656e 6422 3a20  ms = {"append": 
+00005490: 626f 6f6c 3273 7472 2861 7070 656e 6429  bool2str(append)
+000054a0: 7d0a 2020 2020 2020 2020 6572 726f 7220  }.        error 
+000054b0: 3d20 6622 7374 6f72 6520 6c6f 6720 7b70  = f"store log {p
+000054c0: 726f 6a65 6374 7d2f 7b75 6964 7d22 0a20  roject}/{uid}". 
+000054d0: 2020 2020 2020 2073 656c 662e 6170 695f         self.api_
+000054e0: 6361 6c6c 2822 504f 5354 222c 2070 6174  call("POST", pat
+000054f0: 682c 2065 7272 6f72 2c20 7061 7261 6d73  h, error, params
+00005500: 2c20 626f 6479 290a 0a20 2020 2064 6566  , body)..    def
+00005510: 2067 6574 5f6c 6f67 2873 656c 662c 2075   get_log(self, u
+00005520: 6964 2c20 7072 6f6a 6563 743d 2222 2c20  id, project="", 
+00005530: 6f66 6673 6574 3d30 2c20 7369 7a65 3d4e  offset=0, size=N
+00005540: 6f6e 6529 3a0a 2020 2020 2020 2020 2222  one):.        ""
+00005550: 2252 6574 7269 6576 6520 3120 4d42 2064  "Retrieve 1 MB d
+00005560: 6174 6120 6f66 206c 6f67 2e0a 0a20 2020  ata of log...   
+00005570: 2020 2020 203a 7061 7261 6d20 7569 643a       :param uid:
+00005580: 204c 6f67 2075 6e69 7175 6520 4944 0a20   Log unique ID. 
+00005590: 2020 2020 2020 203a 7061 7261 6d20 7072         :param pr
+000055a0: 6f6a 6563 743a 2050 726f 6a65 6374 206e  oject: Project n
+000055b0: 616d 6520 666f 7220 7768 6963 6820 7468  ame for which th
+000055c0: 6520 6c6f 6720 6265 6c6f 6e67 730a 2020  e log belongs.  
+000055d0: 2020 2020 2020 3a70 6172 616d 206f 6666        :param off
+000055e0: 7365 743a 2052 6574 7269 6576 6520 7061  set: Retrieve pa
+000055f0: 7274 6961 6c20 6c6f 672c 2067 6574 2075  rtial log, get u
+00005600: 7020 746f 2060 6073 697a 6560 6020 6279  p to ``size`` by
+00005610: 7465 7320 7374 6172 7469 6e67 2061 7420  tes starting at 
+00005620: 6f66 6673 6574 2060 606f 6666 7365 7460  offset ``offset`
+00005630: 600a 2020 2020 2020 2020 2020 2020 6672  `.            fr
+00005640: 6f6d 2062 6567 696e 6e69 6e67 206f 6620  om beginning of 
+00005650: 6c6f 6720 286d 7573 7420 6265 203e 3d20  log (must be >= 
+00005660: 3029 0a20 2020 2020 2020 203a 7061 7261  0).        :para
+00005670: 6d20 7369 7a65 3a20 4966 2073 6574 2074  m size: If set t
+00005680: 6f20 6060 2d31 6060 2077 696c 6c20 7265  o ``-1`` will re
+00005690: 7472 6965 7665 2061 6e64 2070 7269 6e74  trieve and print
+000056a0: 2061 6c6c 2064 6174 6120 746f 2065 6e64   all data to end
+000056b0: 206f 6620 7468 6520 6c6f 6720 6279 2063   of the log by c
+000056c0: 6875 6e6b 7320 6f66 2031 4d42 2065 6163  hunks of 1MB eac
+000056d0: 682e 0a20 2020 2020 2020 203a 7265 7475  h..        :retu
+000056e0: 726e 733a 2054 6865 2066 6f6c 6c6f 7769  rns: The followi
+000056f0: 6e67 206f 626a 6563 7473 3a0a 0a20 2020  ng objects:..   
+00005700: 2020 2020 2020 2020 202d 2073 7461 7465           - state
+00005710: 202d 2054 6865 2073 7461 7465 206f 6620   - The state of 
+00005720: 7468 6520 7275 6e74 696d 6520 6f62 6a65  the runtime obje
+00005730: 6374 2077 6869 6368 2067 656e 6572 6174  ct which generat
+00005740: 6573 2074 6869 7320 6c6f 672c 2069 6620  es this log, if 
+00005750: 6974 2065 7869 7374 732e 2049 6e20 6361  it exists. In ca
+00005760: 7365 206e 6f20 6b6e 6f77 6e20 7374 6174  se no known stat
+00005770: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+00005780: 6578 6973 7473 2c20 7468 6973 2077 696c  exists, this wil
+00005790: 6c20 6265 2060 6075 6e6b 6e6f 776e 6060  l be ``unknown``
+000057a0: 2e0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
+000057b0: 636f 6e74 656e 7420 2d20 5468 6520 6163  content - The ac
+000057c0: 7475 616c 206c 6f67 2063 6f6e 7465 6e74  tual log content
+000057d0: 2e0a 0a20 2020 2020 2020 2020 2020 202a  ...            *
+000057e0: 2069 6e20 6361 7365 2073 697a 6520 3d20   in case size = 
+000057f0: 2d31 2c20 7265 7475 726e 2074 6865 2073  -1, return the s
+00005800: 7461 7465 2061 6e64 2074 6865 2066 696e  tate and the fin
+00005810: 616c 206f 6666 7365 740a 2020 2020 2020  al offset.      
+00005820: 2020 2222 220a 2020 2020 2020 2020 6966    """.        if
+00005830: 206f 6666 7365 7420 3c20 303a 0a20 2020   offset < 0:.   
+00005840: 2020 2020 2020 2020 2072 6169 7365 204d           raise M
+00005850: 4c52 756e 496e 7661 6c69 6441 7267 756d  LRunInvalidArgum
+00005860: 656e 7445 7272 6f72 2822 4f66 6673 6574  entError("Offset
+00005870: 2063 616e 6e6f 7420 6265 206e 6567 6174   cannot be negat
+00005880: 6976 6522 290a 2020 2020 2020 2020 6966  ive").        if
+00005890: 2073 697a 6520 6973 204e 6f6e 653a 0a20   size is None:. 
+000058a0: 2020 2020 2020 2020 2020 2073 697a 6520             size 
+000058b0: 3d20 696e 7428 636f 6e66 6967 2e68 7474  = int(config.htt
+000058c0: 7064 622e 6c6f 6773 2e70 756c 6c5f 6c6f  pdb.logs.pull_lo
+000058d0: 6773 5f64 6566 6175 6c74 5f73 697a 655f  gs_default_size_
+000058e0: 6c69 6d69 7429 0a20 2020 2020 2020 2065  limit).        e
+000058f0: 6c69 6620 7369 7a65 203d 3d20 2d31 3a0a  lif size == -1:.
+00005900: 2020 2020 2020 2020 2020 2020 6c6f 6767              logg
+00005910: 6572 2e77 6172 6e69 6e67 280a 2020 2020  er.warning(.    
+00005920: 2020 2020 2020 2020 2020 2020 2252 6574              "Ret
+00005930: 7269 6576 696e 6720 616c 6c20 6c6f 6773  rieving all logs
+00005940: 2e20 5468 6973 206d 6179 2062 6520 696e  . This may be in
+00005950: 6566 6669 6369 656e 7420 616e 6420 6361  efficient and ca
+00005960: 6e20 7265 7375 6c74 2069 6e20 6120 6c61  n result in a la
+00005970: 7267 6520 6c6f 672e 220a 2020 2020 2020  rge log.".      
+00005980: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00005990: 2020 2020 7374 6174 652c 206f 6666 7365      state, offse
+000059a0: 7420 3d20 7365 6c66 2e77 6174 6368 5f6c  t = self.watch_l
+000059b0: 6f67 2875 6964 2c20 7072 6f6a 6563 742c  og(uid, project,
+000059c0: 2077 6174 6368 3d46 616c 7365 2c20 6f66   watch=False, of
+000059d0: 6673 6574 3d6f 6666 7365 7429 0a20 2020  fset=offset).   
+000059e0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+000059f0: 7374 6174 652c 206f 6666 7365 740a 0a20  state, offset.. 
+00005a00: 2020 2020 2020 2070 6172 616d 7320 3d20         params = 
+00005a10: 7b22 6f66 6673 6574 223a 206f 6666 7365  {"offset": offse
+00005a20: 742c 2022 7369 7a65 223a 2073 697a 657d  t, "size": size}
+00005a30: 0a20 2020 2020 2020 2070 6174 6820 3d20  .        path = 
+00005a40: 7365 6c66 2e5f 7061 7468 5f6f 6628 226c  self._path_of("l
+00005a50: 6f67 7322 2c20 7072 6f6a 6563 742c 2075  ogs", project, u
+00005a60: 6964 290a 2020 2020 2020 2020 6572 726f  id).        erro
+00005a70: 7220 3d20 6622 6765 7420 6c6f 6720 7b70  r = f"get log {p
+00005a80: 726f 6a65 6374 7d2f 7b75 6964 7d22 0a20  roject}/{uid}". 
+00005a90: 2020 2020 2020 2072 6573 7020 3d20 7365         resp = se
+00005aa0: 6c66 2e61 7069 5f63 616c 6c28 2247 4554  lf.api_call("GET
+00005ab0: 222c 2070 6174 682c 2065 7272 6f72 2c20  ", path, error, 
+00005ac0: 7061 7261 6d73 3d70 6172 616d 7329 0a20  params=params). 
+00005ad0: 2020 2020 2020 2069 6620 7265 7370 2e68         if resp.h
+00005ae0: 6561 6465 7273 3a0a 2020 2020 2020 2020  eaders:.        
+00005af0: 2020 2020 7374 6174 6520 3d20 7265 7370      state = resp
+00005b00: 2e68 6561 6465 7273 2e67 6574 2822 782d  .headers.get("x-
+00005b10: 6d6c 7275 6e2d 7275 6e2d 7374 6174 6522  mlrun-run-state"
+00005b20: 2c20 2222 290a 2020 2020 2020 2020 2020  , "").          
+00005b30: 2020 7265 7475 726e 2073 7461 7465 2e6c    return state.l
+00005b40: 6f77 6572 2829 2c20 7265 7370 2e63 6f6e  ower(), resp.con
+00005b50: 7465 6e74 0a0a 2020 2020 2020 2020 7265  tent..        re
+00005b60: 7475 726e 2022 756e 6b6e 6f77 6e22 2c20  turn "unknown", 
+00005b70: 7265 7370 2e63 6f6e 7465 6e74 0a0a 2020  resp.content..  
+00005b80: 2020 6465 6620 6765 745f 6c6f 675f 7369    def get_log_si
+00005b90: 7a65 2873 656c 662c 2075 6964 2c20 7072  ze(self, uid, pr
+00005ba0: 6f6a 6563 743d 2222 293a 0a20 2020 2020  oject=""):.     
+00005bb0: 2020 2022 2222 5265 7472 6965 7665 206c     """Retrieve l
+00005bc0: 6f67 2073 697a 6520 696e 2062 7974 6573  og size in bytes
+00005bd0: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
+00005be0: 6d20 7569 643a 2052 756e 2055 4944 0a20  m uid: Run UID. 
+00005bf0: 2020 2020 2020 203a 7061 7261 6d20 7072         :param pr
+00005c00: 6f6a 6563 743a 2050 726f 6a65 6374 206e  oject: Project n
+00005c10: 616d 6520 666f 7220 7768 6963 6820 7468  ame for which th
+00005c20: 6520 6c6f 6720 6265 6c6f 6e67 730a 2020  e log belongs.  
+00005c30: 2020 2020 2020 3a72 6574 7572 6e73 3a20        :returns: 
+00005c40: 5468 6520 6c6f 6720 6669 6c65 2073 697a  The log file siz
+00005c50: 6520 696e 2062 7974 6573 2066 6f72 2074  e in bytes for t
+00005c60: 6865 2067 6976 656e 2072 756e 2055 4944  he given run UID
+00005c70: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+00005c80: 2020 2020 2020 7061 7468 203d 2073 656c        path = sel
+00005c90: 662e 5f70 6174 685f 6f66 2822 6c6f 6773  f._path_of("logs
+00005ca0: 222c 2070 726f 6a65 6374 2c20 7569 6429  ", project, uid)
+00005cb0: 0a20 2020 2020 2020 2070 6174 6820 2b3d  .        path +=
+00005cc0: 2022 2f73 697a 6522 0a20 2020 2020 2020   "/size".       
+00005cd0: 2065 7272 6f72 203d 2066 2267 6574 206c   error = f"get l
+00005ce0: 6f67 2073 697a 6520 7b70 726f 6a65 6374  og size {project
+00005cf0: 7d2f 7b75 6964 7d22 0a20 2020 2020 2020  }/{uid}".       
+00005d00: 2072 6573 7020 3d20 7365 6c66 2e61 7069   resp = self.api
+00005d10: 5f63 616c 6c28 2247 4554 222c 2070 6174  _call("GET", pat
+00005d20: 682c 2065 7272 6f72 290a 2020 2020 2020  h, error).      
+00005d30: 2020 7265 7475 726e 2072 6573 702e 6a73    return resp.js
+00005d40: 6f6e 2829 5b22 7369 7a65 225d 0a0a 2020  on()["size"]..  
+00005d50: 2020 6465 6620 7761 7463 685f 6c6f 6728    def watch_log(
+00005d60: 7365 6c66 2c20 7569 642c 2070 726f 6a65  self, uid, proje
+00005d70: 6374 3d22 222c 2077 6174 6368 3d54 7275  ct="", watch=Tru
+00005d80: 652c 206f 6666 7365 743d 3029 3a0a 2020  e, offset=0):.  
+00005d90: 2020 2020 2020 2222 2252 6574 7269 6576        """Retriev
+00005da0: 6520 6c6f 6773 206f 6620 6120 7275 6e6e  e logs of a runn
+00005db0: 696e 6720 7072 6f63 6573 7320 6279 2063  ing process by c
+00005dc0: 6875 6e6b 7320 6f66 2031 4d42 2c20 616e  hunks of 1MB, an
+00005dd0: 6420 7761 7463 6820 7468 6520 7072 6f67  d watch the prog
+00005de0: 7265 7373 206f 6620 7468 6520 6578 6563  ress of the exec
+00005df0: 7574 696f 6e20 756e 7469 6c20 6974 0a20  ution until it. 
+00005e00: 2020 2020 2020 2063 6f6d 706c 6574 6573         completes
+00005e10: 2e20 5468 6973 206d 6574 686f 6420 7769  . This method wi
+00005e20: 6c6c 2070 7269 6e74 206f 7574 2074 6865  ll print out the
+00005e30: 206c 6f67 7320 616e 6420 636f 6e74 696e   logs and contin
+00005e40: 7565 2074 6f20 7065 7269 6f64 6963 616c  ue to periodical
+00005e50: 6c79 2070 6f6c 6c20 666f 722c 2061 6e64  ly poll for, and
+00005e60: 2070 7269 6e74 2c0a 2020 2020 2020 2020   print,.        
+00005e70: 6e65 7720 6c6f 6773 2061 7320 6c6f 6e67  new logs as long
+00005e80: 2061 7320 7468 6520 7374 6174 6520 6f66   as the state of
+00005e90: 2074 6865 2072 756e 7469 6d65 2077 6869   the runtime whi
+00005ea0: 6368 2067 656e 6572 6174 6573 2074 6869  ch generates thi
+00005eb0: 7320 6c6f 6720 6973 2065 6974 6865 7220  s log is either 
+00005ec0: 6060 7065 6e64 696e 6760 6020 6f72 2060  ``pending`` or `
+00005ed0: 6072 756e 6e69 6e67 6060 2e0a 0a20 2020  `running``...   
+00005ee0: 2020 2020 203a 7061 7261 6d20 7569 643a       :param uid:
+00005ef0: 2054 6865 2075 6964 206f 6620 7468 6520   The uid of the 
+00005f00: 6c6f 6720 6f62 6a65 6374 2074 6f20 7761  log object to wa
+00005f10: 7463 682e 0a20 2020 2020 2020 203a 7061  tch..        :pa
+00005f20: 7261 6d20 7072 6f6a 6563 743a 2050 726f  ram project: Pro
+00005f30: 6a65 6374 2074 6861 7420 7468 6520 6c6f  ject that the lo
+00005f40: 6720 6265 6c6f 6e67 7320 746f 2e0a 2020  g belongs to..  
+00005f50: 2020 2020 2020 3a70 6172 616d 2077 6174        :param wat
+00005f60: 6368 3a20 4966 2073 6574 2074 6f20 6060  ch: If set to ``
+00005f70: 5472 7565 6060 2077 696c 6c20 636f 6e74  True`` will cont
+00005f80: 696e 7565 2074 7261 636b 696e 6720 7468  inue tracking th
+00005f90: 6520 6c6f 6720 6173 2064 6573 6372 6962  e log as describ
+00005fa0: 6564 2061 626f 7665 2e20 4f74 6865 7277  ed above. Otherw
+00005fb0: 6973 6520 7468 6973 2066 756e 6374 696f  ise this functio
+00005fc0: 6e0a 2020 2020 2020 2020 2020 2020 6973  n.            is
+00005fd0: 2070 7261 6374 6963 616c 6c79 2065 7175   practically equ
+00005fe0: 6976 616c 656e 7420 746f 2074 6865 203a  ivalent to the :
+00005ff0: 7079 3a66 756e 633a 607e 6765 745f 6c6f  py:func:`~get_lo
+00006000: 6760 2066 756e 6374 696f 6e2e 0a20 2020  g` function..   
+00006010: 2020 2020 203a 7061 7261 6d20 6f66 6673       :param offs
+00006020: 6574 3a20 4d69 6e69 6d61 6c20 6f66 6673  et: Minimal offs
+00006030: 6574 2069 6e20 7468 6520 6c6f 6720 746f  et in the log to
+00006040: 2077 6174 6368 2e0a 2020 2020 2020 2020   watch..        
+00006050: 3a72 6574 7572 6e73 3a20 5468 6520 6669  :returns: The fi
+00006060: 6e61 6c20 7374 6174 6520 6f66 2074 6865  nal state of the
+00006070: 206c 6f67 2062 6569 6e67 2077 6174 6368   log being watch
+00006080: 6564 2061 6e64 2074 6865 2066 696e 616c  ed and the final
+00006090: 206f 6666 7365 742e 0a20 2020 2020 2020   offset..       
+000060a0: 2022 2222 0a0a 2020 2020 2020 2020 7374   """..        st
+000060b0: 6174 652c 2074 6578 7420 3d20 7365 6c66  ate, text = self
+000060c0: 2e67 6574 5f6c 6f67 2875 6964 2c20 7072  .get_log(uid, pr
+000060d0: 6f6a 6563 742c 206f 6666 7365 743d 6f66  oject, offset=of
+000060e0: 6673 6574 290a 2020 2020 2020 2020 6966  fset).        if
+000060f0: 2074 6578 743a 0a20 2020 2020 2020 2020   text:.         
+00006100: 2020 2070 7269 6e74 2874 6578 742e 6465     print(text.de
+00006110: 636f 6465 2865 7272 6f72 733d 636f 6e66  code(errors=conf
+00006120: 6967 2e68 7474 7064 622e 6c6f 6773 2e64  ig.httpdb.logs.d
+00006130: 6563 6f64 652e 6572 726f 7273 2929 0a20  ecode.errors)). 
+00006140: 2020 2020 2020 206e 696c 5f72 6573 7020         nil_resp 
+00006150: 3d20 300a 2020 2020 2020 2020 7768 696c  = 0.        whil
+00006160: 6520 5472 7565 3a0a 2020 2020 2020 2020  e True:.        
+00006170: 2020 2020 6f66 6673 6574 202b 3d20 6c65      offset += le
+00006180: 6e28 7465 7874 290a 2020 2020 2020 2020  n(text).        
+00006190: 2020 2020 2320 6966 2077 6520 6765 7420      # if we get 
+000061a0: 3320 6e69 6c20 7265 7370 6f6e 7365 7320  3 nil responses 
+000061b0: 696e 2061 2072 6f77 2c20 696e 6372 6561  in a row, increa
+000061c0: 7365 2074 6865 2073 6c65 6570 2074 696d  se the sleep tim
+000061d0: 6520 746f 2031 3020 7365 636f 6e64 730a  e to 10 seconds.
+000061e0: 2020 2020 2020 2020 2020 2020 2320 544f              # TO
+000061f0: 444f 3a20 7265 6661 6374 6f72 2074 6869  DO: refactor thi
+00006200: 7320 746f 2075 7365 2061 2063 6f6e 6469  s to use a condi
+00006210: 7469 6f6e 616c 2062 6163 6b6f 6666 206d  tional backoff m
+00006220: 6563 6861 6e69 736d 0a20 2020 2020 2020  echanism.       
+00006230: 2020 2020 2069 6620 6e69 6c5f 7265 7370       if nil_resp
+00006240: 203c 2033 3a0a 2020 2020 2020 2020 2020   < 3:.          
+00006250: 2020 2020 2020 7469 6d65 2e73 6c65 6570        time.sleep
+00006260: 2869 6e74 2863 6f6e 6669 672e 6874 7470  (int(config.http
+00006270: 6462 2e6c 6f67 732e 7075 6c6c 5f6c 6f67  db.logs.pull_log
+00006280: 735f 6465 6661 756c 745f 696e 7465 7276  s_default_interv
+00006290: 616c 2929 0a20 2020 2020 2020 2020 2020  al)).           
+000062a0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+000062b0: 2020 2020 2020 2074 696d 652e 736c 6565         time.slee
+000062c0: 7028 0a20 2020 2020 2020 2020 2020 2020  p(.             
+000062d0: 2020 2020 2020 2069 6e74 2863 6f6e 6669         int(confi
+000062e0: 672e 6874 7470 6462 2e6c 6f67 732e 7075  g.httpdb.logs.pu
+000062f0: 6c6c 5f6c 6f67 735f 6261 636b 6f66 665f  ll_logs_backoff_
+00006300: 6e6f 5f6c 6f67 735f 6465 6661 756c 745f  no_logs_default_
+00006310: 696e 7465 7276 616c 290a 2020 2020 2020  interval).      
+00006320: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00006330: 2020 2020 2020 2020 7374 6174 652c 2074          state, t
+00006340: 6578 7420 3d20 7365 6c66 2e67 6574 5f6c  ext = self.get_l
+00006350: 6f67 2875 6964 2c20 7072 6f6a 6563 742c  og(uid, project,
+00006360: 206f 6666 7365 743d 6f66 6673 6574 290a   offset=offset).
+00006370: 2020 2020 2020 2020 2020 2020 6966 2074              if t
+00006380: 6578 743a 0a20 2020 2020 2020 2020 2020  ext:.           
+00006390: 2020 2020 206e 696c 5f72 6573 7020 3d20       nil_resp = 
+000063a0: 300a 2020 2020 2020 2020 2020 2020 2020  0.              
+000063b0: 2020 7072 696e 7428 0a20 2020 2020 2020    print(.       
+000063c0: 2020 2020 2020 2020 2020 2020 2074 6578               tex
+000063d0: 742e 6465 636f 6465 2865 7272 6f72 733d  t.decode(errors=
+000063e0: 636f 6e66 6967 2e68 7474 7064 622e 6c6f  config.httpdb.lo
+000063f0: 6773 2e64 6563 6f64 652e 6572 726f 7273  gs.decode.errors
+00006400: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+00006410: 2020 2020 2020 2065 6e64 3d22 222c 0a20         end="",. 
+00006420: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00006430: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+00006440: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00006450: 2020 206e 696c 5f72 6573 7020 2b3d 2031     nil_resp += 1
+00006460: 0a0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+00006470: 2077 6174 6368 2061 6e64 2073 7461 7465   watch and state
+00006480: 2069 6e20 5b0a 2020 2020 2020 2020 2020   in [.          
+00006490: 2020 2020 2020 6d6c 7275 6e2e 7275 6e74        mlrun.runt
+000064a0: 696d 6573 2e63 6f6e 7374 616e 7473 2e52  imes.constants.R
+000064b0: 756e 5374 6174 6573 2e70 656e 6469 6e67  unStates.pending
+000064c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000064d0: 2020 6d6c 7275 6e2e 7275 6e74 696d 6573    mlrun.runtimes
+000064e0: 2e63 6f6e 7374 616e 7473 2e52 756e 5374  .constants.RunSt
+000064f0: 6174 6573 2e72 756e 6e69 6e67 2c0a 2020  ates.running,.  
+00006500: 2020 2020 2020 2020 2020 2020 2020 6d6c                ml
+00006510: 7275 6e2e 7275 6e74 696d 6573 2e63 6f6e  run.runtimes.con
+00006520: 7374 616e 7473 2e52 756e 5374 6174 6573  stants.RunStates
+00006530: 2e63 7265 6174 6564 2c0a 2020 2020 2020  .created,.      
+00006540: 2020 2020 2020 2020 2020 6d6c 7275 6e2e            mlrun.
+00006550: 7275 6e74 696d 6573 2e63 6f6e 7374 616e  runtimes.constan
+00006560: 7473 2e52 756e 5374 6174 6573 2e61 626f  ts.RunStates.abo
+00006570: 7274 696e 672c 0a20 2020 2020 2020 2020  rting,.         
+00006580: 2020 205d 3a0a 2020 2020 2020 2020 2020     ]:.          
+00006590: 2020 2020 2020 636f 6e74 696e 7565 0a20        continue. 
+000065a0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+000065b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000065c0: 2023 2074 6865 2077 686f 6c65 206c 6f67   # the whole log
+000065d0: 2077 6173 2072 6574 7269 6576 6564 0a20   was retrieved. 
+000065e0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+000065f0: 6620 6c65 6e28 7465 7874 2920 3d3d 2030  f len(text) == 0
+00006600: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00006610: 2020 2020 2020 6272 6561 6b0a 0a20 2020        break..   
+00006620: 2020 2020 2072 6574 7572 6e20 7374 6174       return stat
+00006630: 652c 206f 6666 7365 740a 0a20 2020 2064  e, offset..    d
+00006640: 6566 2073 746f 7265 5f72 756e 2873 656c  ef store_run(sel
+00006650: 662c 2073 7472 7563 742c 2075 6964 2c20  f, struct, uid, 
+00006660: 7072 6f6a 6563 743d 2222 2c20 6974 6572  project="", iter
+00006670: 3d30 293a 0a20 2020 2020 2020 2022 2222  =0):.        """
+00006680: 5374 6f72 6520 7275 6e20 6465 7461 696c  Store run detail
+00006690: 7320 696e 2074 6865 2044 422e 2054 6869  s in the DB. Thi
+000066a0: 7320 6d65 7468 6f64 2069 7320 7573 7561  s method is usua
+000066b0: 6c6c 7920 6361 6c6c 6564 2066 726f 6d20  lly called from 
+000066c0: 7769 7468 696e 206f 7468 6572 203a 7079  within other :py
+000066d0: 3a6d 6f64 3a60 6d6c 7275 6e60 2066 6c6f  :mod:`mlrun` flo
+000066e0: 7773 0a20 2020 2020 2020 2061 6e64 206e  ws.        and n
+000066f0: 6f74 2063 616c 6c65 6420 6469 7265 6374  ot called direct
+00006700: 6c79 2062 7920 7468 6520 7573 6572 2e22  ly by the user."
+00006710: 2222 0a0a 2020 2020 2020 2020 7061 7468  ""..        path
+00006720: 203d 2073 656c 662e 5f70 6174 685f 6f66   = self._path_of
+00006730: 2822 7275 6e73 222c 2070 726f 6a65 6374  ("runs", project
+00006740: 2c20 7569 6429 0a20 2020 2020 2020 2070  , uid).        p
+00006750: 6172 616d 7320 3d20 7b22 6974 6572 223a  arams = {"iter":
+00006760: 2069 7465 727d 0a20 2020 2020 2020 2065   iter}.        e
+00006770: 7272 6f72 203d 2066 2273 746f 7265 2072  rror = f"store r
+00006780: 756e 207b 7072 6f6a 6563 747d 2f7b 7569  un {project}/{ui
+00006790: 647d 220a 2020 2020 2020 2020 626f 6479  d}".        body
+000067a0: 203d 205f 6173 5f6a 736f 6e28 7374 7275   = _as_json(stru
+000067b0: 6374 290a 2020 2020 2020 2020 7365 6c66  ct).        self
+000067c0: 2e61 7069 5f63 616c 6c28 2250 4f53 5422  .api_call("POST"
+000067d0: 2c20 7061 7468 2c20 6572 726f 722c 2070  , path, error, p
+000067e0: 6172 616d 733d 7061 7261 6d73 2c20 626f  arams=params, bo
+000067f0: 6479 3d62 6f64 7929 0a0a 2020 2020 6465  dy=body)..    de
+00006800: 6620 7570 6461 7465 5f72 756e 2873 656c  f update_run(sel
+00006810: 662c 2075 7064 6174 6573 3a20 6469 6374  f, updates: dict
+00006820: 2c20 7569 642c 2070 726f 6a65 6374 3d22  , uid, project="
+00006830: 222c 2069 7465 723d 302c 2074 696d 656f  ", iter=0, timeo
+00006840: 7574 3d34 3529 3a0a 2020 2020 2020 2020  ut=45):.        
+00006850: 2222 2255 7064 6174 6520 7468 6520 6465  """Update the de
+00006860: 7461 696c 7320 6f66 2061 2073 746f 7265  tails of a store
+00006870: 6420 7275 6e20 696e 2074 6865 2044 422e  d run in the DB.
+00006880: 2222 220a 0a20 2020 2020 2020 2070 6174  """..        pat
+00006890: 6820 3d20 7365 6c66 2e5f 7061 7468 5f6f  h = self._path_o
+000068a0: 6628 2272 756e 7322 2c20 7072 6f6a 6563  f("runs", projec
+000068b0: 742c 2075 6964 290a 2020 2020 2020 2020  t, uid).        
+000068c0: 7061 7261 6d73 203d 207b 2269 7465 7222  params = {"iter"
+000068d0: 3a20 6974 6572 7d0a 2020 2020 2020 2020  : iter}.        
+000068e0: 6572 726f 7220 3d20 6622 7570 6461 7465  error = f"update
+000068f0: 2072 756e 207b 7072 6f6a 6563 747d 2f7b   run {project}/{
+00006900: 7569 647d 220a 2020 2020 2020 2020 626f  uid}".        bo
+00006910: 6479 203d 205f 6173 5f6a 736f 6e28 7570  dy = _as_json(up
+00006920: 6461 7465 7329 0a20 2020 2020 2020 2073  dates).        s
+00006930: 656c 662e 6170 695f 6361 6c6c 2822 5041  elf.api_call("PA
+00006940: 5443 4822 2c20 7061 7468 2c20 6572 726f  TCH", path, erro
+00006950: 722c 2070 6172 616d 733d 7061 7261 6d73  r, params=params
+00006960: 2c20 626f 6479 3d62 6f64 792c 2074 696d  , body=body, tim
+00006970: 656f 7574 3d74 696d 656f 7574 290a 0a20  eout=timeout).. 
+00006980: 2020 2064 6566 2061 626f 7274 5f72 756e     def abort_run
+00006990: 2873 656c 662c 2075 6964 2c20 7072 6f6a  (self, uid, proj
+000069a0: 6563 743d 2222 2c20 6974 6572 3d30 2c20  ect="", iter=0, 
+000069b0: 7469 6d65 6f75 743d 3435 2c20 7374 6174  timeout=45, stat
+000069c0: 7573 5f74 6578 743d 2222 293a 0a20 2020  us_text=""):.   
+000069d0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+000069e0: 2041 626f 7274 2061 2072 756e 6e69 6e67   Abort a running
+000069f0: 2072 756e 202d 2077 696c 6c20 7265 6d6f   run - will remo
+00006a00: 7665 2074 6865 2072 756e 2773 2072 756e  ve the run's run
+00006a10: 7469 6d65 2072 6573 6f75 7263 6573 2061  time resources a
+00006a20: 6e64 206d 6172 6b20 6974 7320 7374 6174  nd mark its stat
+00006a30: 6520 6173 2061 626f 7274 6564 2e0a 2020  e as aborted..  
+00006a40: 2020 2020 2020 3a72 6574 7572 6e73 3a20        :returns: 
+00006a50: 3a70 793a 636c 6173 733a 607e 6d6c 7275  :py:class:`~mlru
+00006a60: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
+00006a70: 2e42 6163 6b67 726f 756e 6454 6173 6b60  .BackgroundTask`
+00006a80: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+00006a90: 2020 2020 2020 7072 6f6a 6563 7420 3d20        project = 
+00006aa0: 7072 6f6a 6563 7420 6f72 2063 6f6e 6669  project or confi
+00006ab0: 672e 6465 6661 756c 745f 7072 6f6a 6563  g.default_projec
+00006ac0: 740a 2020 2020 2020 2020 7061 7261 6d73  t.        params
+00006ad0: 203d 207b 2269 7465 7222 3a20 6974 6572   = {"iter": iter
+00006ae0: 7d0a 2020 2020 2020 2020 7570 6461 7465  }.        update
+00006af0: 7320 3d20 7b7d 0a20 2020 2020 2020 2069  s = {}.        i
+00006b00: 6620 7374 6174 7573 5f74 6578 743a 0a20  f status_text:. 
+00006b10: 2020 2020 2020 2020 2020 2075 7064 6174             updat
+00006b20: 6573 5b22 7374 6174 7573 2e73 7461 7475  es["status.statu
+00006b30: 735f 7465 7874 225d 203d 2073 7461 7475  s_text"] = statu
+00006b40: 735f 7465 7874 0a20 2020 2020 2020 2062  s_text.        b
+00006b50: 6f64 7920 3d20 5f61 735f 6a73 6f6e 2875  ody = _as_json(u
+00006b60: 7064 6174 6573 290a 0a20 2020 2020 2020  pdates)..       
+00006b70: 2072 6573 706f 6e73 6520 3d20 7365 6c66   response = self
+00006b80: 2e61 7069 5f63 616c 6c28 0a20 2020 2020  .api_call(.     
+00006b90: 2020 2020 2020 2022 504f 5354 222c 0a20         "POST",. 
+00006ba0: 2020 2020 2020 2020 2020 2070 6174 683d             path=
+00006bb0: 6622 7072 6f6a 6563 7473 2f7b 7072 6f6a  f"projects/{proj
+00006bc0: 6563 747d 2f72 756e 732f 7b75 6964 7d2f  ect}/runs/{uid}/
+00006bd0: 6162 6f72 7422 2c0a 2020 2020 2020 2020  abort",.        
+00006be0: 2020 2020 6572 726f 723d 2246 6169 6c65      error="Faile
+00006bf0: 6420 7275 6e20 6162 6f72 7469 6f6e 222c  d run abortion",
+00006c00: 0a20 2020 2020 2020 2020 2020 2070 6172  .            par
+00006c10: 616d 733d 7061 7261 6d73 2c0a 2020 2020  ams=params,.    
+00006c20: 2020 2020 2020 2020 626f 6479 3d62 6f64          body=bod
+00006c30: 792c 0a20 2020 2020 2020 2020 2020 2074  y,.            t
+00006c40: 696d 656f 7574 3d74 696d 656f 7574 2c0a  imeout=timeout,.
+00006c50: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00006c60: 2020 6966 2072 6573 706f 6e73 652e 7374    if response.st
+00006c70: 6174 7573 5f63 6f64 6520 3d3d 2068 7474  atus_code == htt
+00006c80: 702e 4854 5450 5374 6174 7573 2e41 4343  p.HTTPStatus.ACC
+00006c90: 4550 5445 443a 0a20 2020 2020 2020 2020  EPTED:.         
+00006ca0: 2020 2062 6163 6b67 726f 756e 645f 7461     background_ta
+00006cb0: 736b 203d 206d 6c72 756e 2e63 6f6d 6d6f  sk = mlrun.commo
+00006cc0: 6e2e 7363 6865 6d61 732e 4261 636b 6772  n.schemas.Backgr
+00006cd0: 6f75 6e64 5461 736b 282a 2a72 6573 706f  oundTask(**respo
+00006ce0: 6e73 652e 6a73 6f6e 2829 290a 2020 2020  nse.json()).    
+00006cf0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00006d00: 656c 662e 5f77 6169 745f 666f 725f 6261  elf._wait_for_ba
+00006d10: 636b 6772 6f75 6e64 5f74 6173 6b5f 746f  ckground_task_to
+00006d20: 5f72 6561 6368 5f74 6572 6d69 6e61 6c5f  _reach_terminal_
+00006d30: 7374 6174 6528 0a20 2020 2020 2020 2020  state(.         
+00006d40: 2020 2020 2020 2062 6163 6b67 726f 756e         backgroun
+00006d50: 645f 7461 736b 2e6d 6574 6164 6174 612e  d_task.metadata.
+00006d60: 6e61 6d65 2c20 7072 6f6a 6563 743d 7072  name, project=pr
+00006d70: 6f6a 6563 740a 2020 2020 2020 2020 2020  oject.          
+00006d80: 2020 290a 2020 2020 2020 2020 7265 7475    ).        retu
+00006d90: 726e 204e 6f6e 650a 0a20 2020 2064 6566  rn None..    def
+00006da0: 2072 6561 645f 7275 6e28 7365 6c66 2c20   read_run(self, 
+00006db0: 7569 642c 2070 726f 6a65 6374 3d22 222c  uid, project="",
+00006dc0: 2069 7465 723d 3029 3a0a 2020 2020 2020   iter=0):.      
+00006dd0: 2020 2222 2252 6561 6420 7468 6520 6465    """Read the de
+00006de0: 7461 696c 7320 6f66 2061 2073 746f 7265  tails of a store
+00006df0: 6420 7275 6e20 6672 6f6d 2074 6865 2044  d run from the D
+00006e00: 422e 0a0a 2020 2020 2020 2020 3a70 6172  B...        :par
+00006e10: 616d 2075 6964 3a20 5468 6520 7275 6e27  am uid: The run'
+00006e20: 7320 756e 6971 7565 2049 442e 0a20 2020  s unique ID..   
+00006e30: 2020 2020 203a 7061 7261 6d20 7072 6f6a       :param proj
+00006e40: 6563 743a 2050 726f 6a65 6374 206e 616d  ect: Project nam
+00006e50: 652e 0a20 2020 2020 2020 203a 7061 7261  e..        :para
+00006e60: 6d20 6974 6572 3a20 4974 6572 6174 696f  m iter: Iteratio
+00006e70: 6e20 7769 7468 696e 2061 2073 7065 6369  n within a speci
+00006e80: 6669 6320 6578 6563 7574 696f 6e2e 0a20  fic execution.. 
+00006e90: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
+00006ea0: 2020 2020 7061 7468 203d 2073 656c 662e      path = self.
+00006eb0: 5f70 6174 685f 6f66 2822 7275 6e73 222c  _path_of("runs",
+00006ec0: 2070 726f 6a65 6374 2c20 7569 6429 0a20   project, uid). 
+00006ed0: 2020 2020 2020 2070 6172 616d 7320 3d20         params = 
+00006ee0: 7b22 6974 6572 223a 2069 7465 727d 0a20  {"iter": iter}. 
+00006ef0: 2020 2020 2020 2065 7272 6f72 203d 2066         error = f
+00006f00: 2267 6574 2072 756e 207b 7072 6f6a 6563  "get run {projec
+00006f10: 747d 2f7b 7569 647d 220a 2020 2020 2020  t}/{uid}".      
+00006f20: 2020 7265 7370 203d 2073 656c 662e 6170    resp = self.ap
+00006f30: 695f 6361 6c6c 2822 4745 5422 2c20 7061  i_call("GET", pa
+00006f40: 7468 2c20 6572 726f 722c 2070 6172 616d  th, error, param
+00006f50: 733d 7061 7261 6d73 290a 2020 2020 2020  s=params).      
+00006f60: 2020 7265 7475 726e 2072 6573 702e 6a73    return resp.js
+00006f70: 6f6e 2829 5b22 6461 7461 225d 0a0a 2020  on()["data"]..  
+00006f80: 2020 6465 6620 6465 6c5f 7275 6e28 7365    def del_run(se
+00006f90: 6c66 2c20 7569 642c 2070 726f 6a65 6374  lf, uid, project
+00006fa0: 3d22 222c 2069 7465 723d 3029 3a0a 2020  ="", iter=0):.  
+00006fb0: 2020 2020 2020 2222 2244 656c 6574 6520        """Delete 
+00006fc0: 6465 7461 696c 7320 6f66 2061 2073 7065  details of a spe
+00006fd0: 6369 6669 6320 7275 6e20 6672 6f6d 2044  cific run from D
+00006fe0: 422e 0a0a 2020 2020 2020 2020 3a70 6172  B...        :par
+00006ff0: 616d 2075 6964 3a20 556e 6971 7565 2049  am uid: Unique I
+00007000: 4420 666f 7220 7468 6520 7370 6563 6966  D for the specif
+00007010: 6963 2072 756e 2074 6f20 6465 6c65 7465  ic run to delete
+00007020: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00007030: 2070 726f 6a65 6374 3a20 5072 6f6a 6563   project: Projec
+00007040: 7420 7468 6174 2074 6865 2072 756e 2062  t that the run b
+00007050: 656c 6f6e 6773 2074 6f2e 0a20 2020 2020  elongs to..     
+00007060: 2020 203a 7061 7261 6d20 6974 6572 3a20     :param iter: 
+00007070: 4974 6572 6174 696f 6e20 7769 7468 696e  Iteration within
+00007080: 2061 2073 7065 6369 6669 6320 7461 736b   a specific task
+00007090: 2e0a 2020 2020 2020 2020 2222 220a 0a20  ..        """.. 
+000070a0: 2020 2020 2020 2070 6174 6820 3d20 7365         path = se
+000070b0: 6c66 2e5f 7061 7468 5f6f 6628 2272 756e  lf._path_of("run
+000070c0: 7322 2c20 7072 6f6a 6563 742c 2075 6964  s", project, uid
+000070d0: 290a 2020 2020 2020 2020 7061 7261 6d73  ).        params
+000070e0: 203d 207b 2269 7465 7222 3a20 6974 6572   = {"iter": iter
+000070f0: 7d0a 2020 2020 2020 2020 6572 726f 7220  }.        error 
+00007100: 3d20 6622 6465 6c20 7275 6e20 7b70 726f  = f"del run {pro
+00007110: 6a65 6374 7d2f 7b75 6964 7d22 0a20 2020  ject}/{uid}".   
+00007120: 2020 2020 2073 656c 662e 6170 695f 6361       self.api_ca
+00007130: 6c6c 2822 4445 4c45 5445 222c 2070 6174  ll("DELETE", pat
+00007140: 682c 2065 7272 6f72 2c20 7061 7261 6d73  h, error, params
+00007150: 3d70 6172 616d 7329 0a0a 2020 2020 6465  =params)..    de
+00007160: 6620 6c69 7374 5f72 756e 7328 0a20 2020  f list_runs(.   
+00007170: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+00007180: 2020 206e 616d 653a 204f 7074 696f 6e61     name: Optiona
+00007190: 6c5b 7374 725d 203d 204e 6f6e 652c 0a20  l[str] = None,. 
+000071a0: 2020 2020 2020 2075 6964 3a20 4f70 7469         uid: Opti
+000071b0: 6f6e 616c 5b55 6e69 6f6e 5b73 7472 2c20  onal[Union[str, 
+000071c0: 6c69 7374 5b73 7472 5d5d 5d20 3d20 4e6f  list[str]]] = No
+000071d0: 6e65 2c0a 2020 2020 2020 2020 7072 6f6a  ne,.        proj
+000071e0: 6563 743a 204f 7074 696f 6e61 6c5b 7374  ect: Optional[st
+000071f0: 725d 203d 204e 6f6e 652c 0a20 2020 2020  r] = None,.     
+00007200: 2020 206c 6162 656c 733a 204f 7074 696f     labels: Optio
+00007210: 6e61 6c5b 556e 696f 6e5b 7374 722c 206c  nal[Union[str, l
+00007220: 6973 745b 7374 725d 5d5d 203d 204e 6f6e  ist[str]]] = Non
+00007230: 652c 0a20 2020 2020 2020 2073 7461 7465  e,.        state
+00007240: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
+00007250: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
+00007260: 736f 7274 3a20 626f 6f6c 203d 2054 7275  sort: bool = Tru
+00007270: 652c 0a20 2020 2020 2020 206c 6173 743a  e,.        last:
+00007280: 2069 6e74 203d 2030 2c0a 2020 2020 2020   int = 0,.      
+00007290: 2020 6974 6572 3a20 626f 6f6c 203d 2046    iter: bool = F
+000072a0: 616c 7365 2c0a 2020 2020 2020 2020 7374  alse,.        st
+000072b0: 6172 745f 7469 6d65 5f66 726f 6d3a 204f  art_time_from: O
+000072c0: 7074 696f 6e61 6c5b 6461 7465 7469 6d65  ptional[datetime
+000072d0: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
+000072e0: 2020 7374 6172 745f 7469 6d65 5f74 6f3a    start_time_to:
+000072f0: 204f 7074 696f 6e61 6c5b 6461 7465 7469   Optional[dateti
+00007300: 6d65 5d20 3d20 4e6f 6e65 2c0a 2020 2020  me] = None,.    
+00007310: 2020 2020 6c61 7374 5f75 7064 6174 655f      last_update_
+00007320: 7469 6d65 5f66 726f 6d3a 204f 7074 696f  time_from: Optio
+00007330: 6e61 6c5b 6461 7465 7469 6d65 5d20 3d20  nal[datetime] = 
+00007340: 4e6f 6e65 2c0a 2020 2020 2020 2020 6c61  None,.        la
+00007350: 7374 5f75 7064 6174 655f 7469 6d65 5f74  st_update_time_t
+00007360: 6f3a 204f 7074 696f 6e61 6c5b 6461 7465  o: Optional[date
+00007370: 7469 6d65 5d20 3d20 4e6f 6e65 2c0a 2020  time] = None,.  
+00007380: 2020 2020 2020 7061 7274 6974 696f 6e5f        partition_
+00007390: 6279 3a20 4f70 7469 6f6e 616c 5b0a 2020  by: Optional[.  
+000073a0: 2020 2020 2020 2020 2020 556e 696f 6e5b            Union[
+000073b0: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+000073c0: 656d 6173 2e52 756e 5061 7274 6974 696f  emas.RunPartitio
+000073d0: 6e42 7946 6965 6c64 2c20 7374 725d 0a20  nByField, str]. 
+000073e0: 2020 2020 2020 205d 203d 204e 6f6e 652c         ] = None,
+000073f0: 0a20 2020 2020 2020 2072 6f77 735f 7065  .        rows_pe
+00007400: 725f 7061 7274 6974 696f 6e3a 2069 6e74  r_partition: int
+00007410: 203d 2031 2c0a 2020 2020 2020 2020 7061   = 1,.        pa
+00007420: 7274 6974 696f 6e5f 736f 7274 5f62 793a  rtition_sort_by:
+00007430: 204f 7074 696f 6e61 6c5b 556e 696f 6e5b   Optional[Union[
+00007440: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+00007450: 656d 6173 2e53 6f72 7446 6965 6c64 2c20  emas.SortField, 
+00007460: 7374 725d 5d20 3d20 4e6f 6e65 2c0a 2020  str]] = None,.  
+00007470: 2020 2020 2020 7061 7274 6974 696f 6e5f        partition_
+00007480: 6f72 6465 723a 2055 6e69 6f6e 5b0a 2020  order: Union[.  
+00007490: 2020 2020 2020 2020 2020 6d6c 7275 6e2e            mlrun.
+000074a0: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e4f  common.schemas.O
+000074b0: 7264 6572 5479 7065 2c20 7374 720a 2020  rderType, str.  
+000074c0: 2020 2020 2020 5d20 3d20 6d6c 7275 6e2e        ] = mlrun.
+000074d0: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e4f  common.schemas.O
+000074e0: 7264 6572 5479 7065 2e64 6573 632c 0a20  rderType.desc,. 
+000074f0: 2020 2020 2020 206d 6178 5f70 6172 7469         max_parti
+00007500: 7469 6f6e 733a 2069 6e74 203d 2030 2c0a  tions: int = 0,.
+00007510: 2020 2020 2020 2020 7769 7468 5f6e 6f74          with_not
+00007520: 6966 6963 6174 696f 6e73 3a20 626f 6f6c  ifications: bool
+00007530: 203d 2046 616c 7365 2c0a 2020 2020 2920   = False,.    ) 
+00007540: 2d3e 2052 756e 4c69 7374 3a0a 2020 2020  -> RunList:.    
+00007550: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00007560: 5265 7472 6965 7665 2061 206c 6973 7420  Retrieve a list 
+00007570: 6f66 2072 756e 732c 2066 696c 7465 7265  of runs, filtere
+00007580: 6420 6279 2076 6172 696f 7573 206f 7074  d by various opt
+00007590: 696f 6e73 2e0a 2020 2020 2020 2020 4966  ions..        If
+000075a0: 206e 6f20 6669 6c74 6572 2069 7320 7072   no filter is pr
+000075b0: 6f76 6964 6564 2c20 7769 6c6c 2072 6574  ovided, will ret
+000075c0: 7572 6e20 7275 6e73 2066 726f 6d20 7468  urn runs from th
+000075d0: 6520 6c61 7374 2077 6565 6b2e 0a0a 2020  e last week...  
+000075e0: 2020 2020 2020 4578 616d 706c 653a 3a0a        Example::.
+000075f0: 0a20 2020 2020 2020 2020 2020 2072 756e  .            run
+00007600: 7320 3d20 6462 2e6c 6973 745f 7275 6e73  s = db.list_runs
+00007610: 286e 616d 653d 2764 6f77 6e6c 6f61 6427  (name='download'
+00007620: 2c20 7072 6f6a 6563 743d 2769 7269 7327  , project='iris'
+00007630: 2c20 6c61 6265 6c73 3d5b 276f 776e 6572  , labels=['owner
+00007640: 3d61 646d 696e 272c 2027 6b69 6e64 3d6a  =admin', 'kind=j
+00007650: 6f62 275d 290a 2020 2020 2020 2020 2020  ob']).          
+00007660: 2020 2320 4966 2072 756e 6e69 6e67 2069    # If running i
+00007670: 6e20 4a75 7079 7465 722c 2063 616e 2075  n Jupyter, can u
+00007680: 7365 2074 6865 202e 7368 6f77 2829 2066  se the .show() f
+00007690: 756e 6374 696f 6e20 746f 2064 6973 706c  unction to displ
+000076a0: 6179 2074 6865 2072 6573 756c 7473 0a20  ay the results. 
+000076b0: 2020 2020 2020 2020 2020 2064 622e 6c69             db.li
+000076c0: 7374 5f72 756e 7328 6e61 6d65 3d27 272c  st_runs(name='',
+000076d0: 2070 726f 6a65 6374 3d70 726f 6a65 6374   project=project
+000076e0: 5f6e 616d 6529 2e73 686f 7728 290a 0a0a  _name).show()...
+000076f0: 2020 2020 2020 2020 3a70 6172 616d 206e          :param n
+00007700: 616d 653a 204e 616d 6520 6f66 2074 6865  ame: Name of the
+00007710: 2072 756e 2074 6f20 7265 7472 6965 7665   run to retrieve
+00007720: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00007730: 2075 6964 3a20 556e 6971 7565 2049 4420   uid: Unique ID 
+00007740: 6f66 2074 6865 2072 756e 2c20 6f72 2061  of the run, or a
+00007750: 206c 6973 7420 6f66 2072 756e 2055 4944   list of run UID
+00007760: 732e 0a20 2020 2020 2020 203a 7061 7261  s..        :para
+00007770: 6d20 7072 6f6a 6563 743a 2050 726f 6a65  m project: Proje
+00007780: 6374 2074 6861 7420 7468 6520 7275 6e73  ct that the runs
+00007790: 2062 656c 6f6e 6773 2074 6f2e 0a20 2020   belongs to..   
+000077a0: 2020 2020 203a 7061 7261 6d20 6c61 6265       :param labe
+000077b0: 6c73 3a20 4120 6c69 7374 206f 6620 6c61  ls: A list of la
+000077c0: 6265 6c73 2074 6f20 6669 6c74 6572 2062  bels to filter b
+000077d0: 792e 204c 6162 656c 2066 696c 7465 7273  y. Label filters
+000077e0: 2077 6f72 6b20 6279 2065 6974 6865 7220   work by either 
+000077f0: 6669 6c74 6572 696e 6720 6120 7370 6563  filtering a spec
+00007800: 6966 6963 2076 616c 7565 0a20 2020 2020  ific value.     
+00007810: 2020 2020 2020 206f 6620 6120 6c61 6265         of a labe
+00007820: 6c20 2869 2e65 2e20 6c69 7374 2822 6b65  l (i.e. list("ke
+00007830: 793d 7661 6c75 6522 2929 206f 7220 6279  y=value")) or by
+00007840: 206c 6f6f 6b69 6e67 2066 6f72 2074 6865   looking for the
+00007850: 2065 7869 7374 656e 6365 206f 6620 6120   existence of a 
+00007860: 6769 7665 6e0a 2020 2020 2020 2020 2020  given.          
+00007870: 2020 6b65 7920 2869 2e65 2e20 226b 6579    key (i.e. "key
+00007880: 2229 2e0a 2020 2020 2020 2020 3a70 6172  ")..        :par
+00007890: 616d 2073 7461 7465 3a20 4c69 7374 206f  am state: List o
+000078a0: 6e6c 7920 7275 6e73 2077 686f 7365 2073  nly runs whose s
+000078b0: 7461 7465 2069 7320 7370 6563 6966 6965  tate is specifie
+000078c0: 642e 0a20 2020 2020 2020 203a 7061 7261  d..        :para
+000078d0: 6d20 736f 7274 3a20 5768 6574 6865 7220  m sort: Whether 
+000078e0: 746f 2073 6f72 7420 7468 6520 7265 7375  to sort the resu
+000078f0: 6c74 2061 6363 6f72 6469 6e67 2074 6f20  lt according to 
+00007900: 7468 6569 7220 7374 6172 7420 7469 6d65  their start time
+00007910: 2e20 4f74 6865 7277 6973 652c 2072 6573  . Otherwise, res
+00007920: 756c 7473 2077 696c 6c20 6265 0a20 2020  ults will be.   
+00007930: 2020 2020 2020 2020 2072 6574 7572 6e65           returne
+00007940: 6420 6279 2074 6865 6972 2069 6e74 6572  d by their inter
+00007950: 6e61 6c20 6f72 6465 7220 696e 2074 6865  nal order in the
+00007960: 2044 4220 286f 7264 6572 2077 696c 6c20   DB (order will 
+00007970: 6e6f 7420 6265 2067 7561 7261 6e74 6565  not be guarantee
+00007980: 6429 2e0a 2020 2020 2020 2020 3a70 6172  d)..        :par
+00007990: 616d 206c 6173 743a 2044 6570 7265 6361  am last: Depreca
+000079a0: 7465 6420 2d20 6375 7272 656e 746c 7920  ted - currently 
+000079b0: 6e6f 7420 7573 6564 2028 7769 6c6c 2062  not used (will b
+000079c0: 6520 7265 6d6f 7665 6420 696e 2031 2e38  e removed in 1.8
+000079d0: 2e30 292e 0a20 2020 2020 2020 203a 7061  .0)..        :pa
+000079e0: 7261 6d20 6974 6572 3a20 4966 2060 6054  ram iter: If ``T
+000079f0: 7275 6560 6020 7265 7475 726e 2072 756e  rue`` return run
+00007a00: 7320 6672 6f6d 2061 6c6c 2069 7465 7261  s from all itera
+00007a10: 7469 6f6e 732e 204f 7468 6572 7769 7365  tions. Otherwise
+00007a20: 2c20 7265 7475 726e 206f 6e6c 7920 7275  , return only ru
+00007a30: 6e73 2077 686f 7365 2060 6069 7465 7260  ns whose ``iter`
+00007a40: 6020 6973 2030 2e0a 2020 2020 2020 2020  ` is 0..        
+00007a50: 3a70 6172 616d 2073 7461 7274 5f74 696d  :param start_tim
+00007a60: 655f 6672 6f6d 3a20 4669 6c74 6572 2062  e_from: Filter b
+00007a70: 7920 7275 6e20 7374 6172 7420 7469 6d65  y run start time
+00007a80: 2069 6e20 6060 5b73 7461 7274 5f74 696d   in ``[start_tim
+00007a90: 655f 6672 6f6d 2c20 7374 6172 745f 7469  e_from, start_ti
+00007aa0: 6d65 5f74 6f5d 6060 2e0a 2020 2020 2020  me_to]``..      
+00007ab0: 2020 3a70 6172 616d 2073 7461 7274 5f74    :param start_t
+00007ac0: 696d 655f 746f 3a20 4669 6c74 6572 2062  ime_to: Filter b
+00007ad0: 7920 7275 6e20 7374 6172 7420 7469 6d65  y run start time
+00007ae0: 2069 6e20 6060 5b73 7461 7274 5f74 696d   in ``[start_tim
+00007af0: 655f 6672 6f6d 2c20 7374 6172 745f 7469  e_from, start_ti
+00007b00: 6d65 5f74 6f5d 6060 2e0a 2020 2020 2020  me_to]``..      
+00007b10: 2020 3a70 6172 616d 206c 6173 745f 7570    :param last_up
+00007b20: 6461 7465 5f74 696d 655f 6672 6f6d 3a20  date_time_from: 
+00007b30: 4669 6c74 6572 2062 7920 7275 6e20 6c61  Filter by run la
+00007b40: 7374 2075 7064 6174 6520 7469 6d65 2069  st update time i
+00007b50: 6e20 6060 286c 6173 745f 7570 6461 7465  n ``(last_update
+00007b60: 5f74 696d 655f 6672 6f6d 2c0a 2020 2020  _time_from,.    
+00007b70: 2020 2020 2020 2020 6c61 7374 5f75 7064          last_upd
+00007b80: 6174 655f 7469 6d65 5f74 6f29 6060 2e0a  ate_time_to)``..
+00007b90: 2020 2020 2020 2020 3a70 6172 616d 206c          :param l
+00007ba0: 6173 745f 7570 6461 7465 5f74 696d 655f  ast_update_time_
+00007bb0: 746f 3a20 4669 6c74 6572 2062 7920 7275  to: Filter by ru
+00007bc0: 6e20 6c61 7374 2075 7064 6174 6520 7469  n last update ti
+00007bd0: 6d65 2069 6e20 6060 286c 6173 745f 7570  me in ``(last_up
+00007be0: 6461 7465 5f74 696d 655f 6672 6f6d 2c20  date_time_from, 
+00007bf0: 6c61 7374 5f75 7064 6174 655f 7469 6d65  last_update_time
+00007c00: 5f74 6f29 6060 2e0a 2020 2020 2020 2020  _to)``..        
+00007c10: 3a70 6172 616d 2070 6172 7469 7469 6f6e  :param partition
+00007c20: 5f62 793a 2046 6965 6c64 2074 6f20 6772  _by: Field to gr
+00007c30: 6f75 7020 7265 7375 6c74 7320 6279 2e20  oup results by. 
+00007c40: 4f6e 6c79 2061 6c6c 6f77 6564 2076 616c  Only allowed val
+00007c50: 7565 2069 7320 606e 616d 6560 2e20 5768  ue is `name`. Wh
+00007c60: 656e 2060 7061 7274 6974 696f 6e5f 6279  en `partition_by
+00007c70: 6020 6973 2073 7065 6369 6669 6564 2c0a  ` is specified,.
+00007c80: 2020 2020 2020 2020 2020 2020 7468 6520              the 
+00007c90: 6070 6172 7469 7469 6f6e 5f73 6f72 745f  `partition_sort_
+00007ca0: 6279 6020 7061 7261 6d65 7465 7220 6d75  by` parameter mu
+00007cb0: 7374 2062 6520 7072 6f76 6964 6564 2061  st be provided a
+00007cc0: 7320 7765 6c6c 2e0a 2020 2020 2020 2020  s well..        
+00007cd0: 3a70 6172 616d 2072 6f77 735f 7065 725f  :param rows_per_
+00007ce0: 7061 7274 6974 696f 6e3a 2048 6f77 206d  partition: How m
+00007cf0: 616e 7920 746f 7020 726f 7773 2028 7065  any top rows (pe
+00007d00: 7220 736f 7274 696e 6720 6465 6669 6e65  r sorting define
+00007d10: 6420 6279 2060 7061 7274 6974 696f 6e5f  d by `partition_
+00007d20: 736f 7274 5f62 7960 2061 6e64 2060 7061  sort_by` and `pa
+00007d30: 7274 6974 696f 6e5f 6f72 6465 7260 290a  rtition_order`).
+00007d40: 2020 2020 2020 2020 2020 2020 746f 2072              to r
+00007d50: 6574 7572 6e20 7065 7220 6772 6f75 702e  eturn per group.
+00007d60: 2044 6566 6175 6c74 2076 616c 7565 2069   Default value i
+00007d70: 7320 312e 0a20 2020 2020 2020 203a 7061  s 1..        :pa
+00007d80: 7261 6d20 7061 7274 6974 696f 6e5f 736f  ram partition_so
+00007d90: 7274 5f62 793a 2057 6861 7420 6669 656c  rt_by: What fiel
+00007da0: 6420 746f 2073 6f72 7420 7468 6520 7265  d to sort the re
+00007db0: 7375 6c74 7320 6279 2c20 7769 7468 696e  sults by, within
+00007dc0: 2065 6163 6820 7061 7274 6974 696f 6e20   each partition 
+00007dd0: 6465 6669 6e65 6420 6279 2060 7061 7274  defined by `part
+00007de0: 6974 696f 6e5f 6279 602e 0a20 2020 2020  ition_by`..     
+00007df0: 2020 2020 2020 2043 7572 7265 6e74 6c79         Currently
+00007e00: 2074 6865 206f 6e6c 7920 616c 6c6f 7765   the only allowe
+00007e10: 6420 7661 6c75 6573 2061 7265 2060 6372  d values are `cr
+00007e20: 6561 7465 6460 2061 6e64 2060 7570 6461  eated` and `upda
+00007e30: 7465 6460 2e0a 2020 2020 2020 2020 3a70  ted`..        :p
+00007e40: 6172 616d 2070 6172 7469 7469 6f6e 5f6f  aram partition_o
+00007e50: 7264 6572 3a20 4f72 6465 7220 6f66 2073  rder: Order of s
+00007e60: 6f72 7469 6e67 2077 6974 6869 6e20 7061  orting within pa
+00007e70: 7274 6974 696f 6e73 202d 2060 6173 6360  rtitions - `asc`
+00007e80: 206f 7220 6064 6573 6360 2e20 4465 6661   or `desc`. Defa
+00007e90: 756c 7420 6973 2060 6465 7363 602e 0a20  ult is `desc`.. 
+00007ea0: 2020 2020 2020 203a 7061 7261 6d20 6d61         :param ma
+00007eb0: 785f 7061 7274 6974 696f 6e73 3a20 4d61  x_partitions: Ma
+00007ec0: 7869 6d61 6c20 6e75 6d62 6572 206f 6620  ximal number of 
+00007ed0: 7061 7274 6974 696f 6e73 2074 6f20 696e  partitions to in
+00007ee0: 636c 7564 6520 696e 2074 6865 2072 6573  clude in the res
+00007ef0: 756c 742e 2044 6566 6175 6c74 2069 7320  ult. Default is 
+00007f00: 6030 6020 7768 6963 6820 6d65 616e 7320  `0` which means 
+00007f10: 6e6f 0a20 2020 2020 2020 2020 2020 206c  no.            l
+00007f20: 696d 6974 2e0a 2020 2020 2020 2020 3a70  imit..        :p
+00007f30: 6172 616d 2077 6974 685f 6e6f 7469 6669  aram with_notifi
+00007f40: 6361 7469 6f6e 733a 2052 6574 7572 6e20  cations: Return 
+00007f50: 7275 6e73 2077 6974 6820 6e6f 7469 6669  runs with notifi
+00007f60: 6361 7469 6f6e 732c 2061 6e64 206a 6f69  cations, and joi
+00007f70: 6e20 7468 656d 2074 6f20 7468 6520 7265  n them to the re
+00007f80: 7370 6f6e 7365 2e20 4465 6661 756c 7420  sponse. Default 
+00007f90: 6973 2060 4661 6c73 6560 2e0a 2020 2020  is `False`..    
+00007fa0: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
+00007fb0: 2070 726f 6a65 6374 203d 2070 726f 6a65   project = proje
+00007fc0: 6374 206f 7220 636f 6e66 6967 2e64 6566  ct or config.def
+00007fd0: 6175 6c74 5f70 726f 6a65 6374 0a20 2020  ault_project.   
+00007fe0: 2020 2020 2069 6620 7769 7468 5f6e 6f74       if with_not
+00007ff0: 6966 6963 6174 696f 6e73 3a0a 2020 2020  ifications:.    
+00008000: 2020 2020 2020 2020 6c6f 6767 6572 2e77          logger.w
+00008010: 6172 6e69 6e67 280a 2020 2020 2020 2020  arning(.        
+00008020: 2020 2020 2020 2020 224c 6f63 616c 2072          "Local r
+00008030: 756e 206e 6f74 6966 6963 6174 696f 6e73  un notifications
+00008040: 2061 7265 206e 6f74 2070 6572 7369 7374   are not persist
+00008050: 6564 2069 6e20 7468 6520 4442 2c20 7468  ed in the DB, th
+00008060: 6572 6566 6f72 6520 6c6f 6361 6c20 7275  erefore local ru
+00008070: 6e73 2077 696c 6c20 6e6f 7420 6265 2072  ns will not be r
+00008080: 6574 7572 6e65 6420 7768 656e 2022 0a20  eturned when ". 
+00008090: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+000080a0: 7573 696e 6720 7468 6520 6077 6974 685f  using the `with_
+000080b0: 6e6f 7469 6669 6361 7469 6f6e 7360 2066  notifications` f
+000080c0: 6c61 672e 220a 2020 2020 2020 2020 2020  lag.".          
+000080d0: 2020 290a 0a20 2020 2020 2020 2069 6620    )..        if 
+000080e0: 6c61 7374 3a0a 2020 2020 2020 2020 2020  last:.          
+000080f0: 2020 2320 544f 444f 3a20 5265 6d6f 7665    # TODO: Remove
+00008100: 2074 6869 7320 696e 2031 2e38 2e30 0a20   this in 1.8.0. 
+00008110: 2020 2020 2020 2020 2020 2077 6172 6e69             warni
+00008120: 6e67 732e 7761 726e 280a 2020 2020 2020  ngs.warn(.      
+00008130: 2020 2020 2020 2020 2020 2227 6c61 7374            "'last
+00008140: 2720 6973 2064 6570 7265 6361 7465 6420  ' is deprecated 
+00008150: 616e 6420 7769 6c6c 2062 6520 7265 6d6f  and will be remo
+00008160: 7665 6420 696e 2031 2e38 2e30 2e22 2c0a  ved in 1.8.0.",.
+00008170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008180: 4675 7475 7265 5761 726e 696e 672c 0a20  FutureWarning,. 
+00008190: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
+000081a0: 2020 2020 2020 6966 2028 0a20 2020 2020        if (.     
+000081b0: 2020 2020 2020 206e 6f74 206e 616d 650a         not name.
+000081c0: 2020 2020 2020 2020 2020 2020 616e 6420              and 
+000081d0: 6e6f 7420 7569 640a 2020 2020 2020 2020  not uid.        
+000081e0: 2020 2020 616e 6420 6e6f 7420 6c61 6265      and not labe
+000081f0: 6c73 0a20 2020 2020 2020 2020 2020 2061  ls.            a
+00008200: 6e64 206e 6f74 2073 7461 7465 0a20 2020  nd not state.   
+00008210: 2020 2020 2020 2020 2061 6e64 206e 6f74           and not
+00008220: 206c 6173 740a 2020 2020 2020 2020 2020   last.          
+00008230: 2020 616e 6420 6e6f 7420 7374 6172 745f    and not start_
+00008240: 7469 6d65 5f66 726f 6d0a 2020 2020 2020  time_from.      
+00008250: 2020 2020 2020 616e 6420 6e6f 7420 7374        and not st
+00008260: 6172 745f 7469 6d65 5f74 6f0a 2020 2020  art_time_to.    
+00008270: 2020 2020 2020 2020 616e 6420 6e6f 7420          and not 
+00008280: 6c61 7374 5f75 7064 6174 655f 7469 6d65  last_update_time
+00008290: 5f66 726f 6d0a 2020 2020 2020 2020 2020  _from.          
+000082a0: 2020 616e 6420 6e6f 7420 6c61 7374 5f75    and not last_u
+000082b0: 7064 6174 655f 7469 6d65 5f74 6f0a 2020  pdate_time_to.  
+000082c0: 2020 2020 2020 2020 2020 616e 6420 6e6f            and no
+000082d0: 7420 7061 7274 6974 696f 6e5f 6279 0a20  t partition_by. 
+000082e0: 2020 2020 2020 2020 2020 2061 6e64 206e             and n
+000082f0: 6f74 2070 6172 7469 7469 6f6e 5f73 6f72  ot partition_sor
+00008300: 745f 6279 0a20 2020 2020 2020 2020 2020  t_by.           
+00008310: 2061 6e64 206e 6f74 2069 7465 720a 2020   and not iter.  
+00008320: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
+00008330: 2020 2020 2023 2064 6566 6175 6c74 2074       # default t
+00008340: 6f20 6c61 7374 2077 6565 6b20 6f6e 206e  o last week on n
+00008350: 6f20 6669 6c74 6572 0a20 2020 2020 2020  o filter.       
+00008360: 2020 2020 2073 7461 7274 5f74 696d 655f       start_time_
+00008370: 6672 6f6d 203d 2064 6174 6574 696d 652e  from = datetime.
+00008380: 6e6f 7728 2920 2d20 7469 6d65 6465 6c74  now() - timedelt
+00008390: 6128 6461 7973 3d37 290a 2020 2020 2020  a(days=7).      
+000083a0: 2020 2020 2020 7061 7274 6974 696f 6e5f        partition_
+000083b0: 6279 203d 206d 6c72 756e 2e63 6f6d 6d6f  by = mlrun.commo
+000083c0: 6e2e 7363 6865 6d61 732e 5275 6e50 6172  n.schemas.RunPar
+000083d0: 7469 7469 6f6e 4279 4669 656c 642e 6e61  titionByField.na
+000083e0: 6d65 0a20 2020 2020 2020 2020 2020 2070  me.            p
+000083f0: 6172 7469 7469 6f6e 5f73 6f72 745f 6279  artition_sort_by
+00008400: 203d 206d 6c72 756e 2e63 6f6d 6d6f 6e2e   = mlrun.common.
+00008410: 7363 6865 6d61 732e 536f 7274 4669 656c  schemas.SortFiel
+00008420: 642e 7570 6461 7465 640a 0a20 2020 2020  d.updated..     
+00008430: 2020 2070 6172 616d 7320 3d20 7b0a 2020     params = {.  
+00008440: 2020 2020 2020 2020 2020 226e 616d 6522            "name"
+00008450: 3a20 6e61 6d65 2c0a 2020 2020 2020 2020  : name,.        
+00008460: 2020 2020 2275 6964 223a 2075 6964 2c0a      "uid": uid,.
+00008470: 2020 2020 2020 2020 2020 2020 226c 6162              "lab
+00008480: 656c 223a 206c 6162 656c 7320 6f72 205b  el": labels or [
+00008490: 5d2c 0a20 2020 2020 2020 2020 2020 2022  ],.            "
+000084a0: 7374 6174 6522 3a20 7374 6174 652c 0a20  state": state,. 
+000084b0: 2020 2020 2020 2020 2020 2022 736f 7274             "sort
+000084c0: 223a 2062 6f6f 6c32 7374 7228 736f 7274  ": bool2str(sort
+000084d0: 292c 0a20 2020 2020 2020 2020 2020 2022  ),.            "
+000084e0: 6974 6572 223a 2062 6f6f 6c32 7374 7228  iter": bool2str(
+000084f0: 6974 6572 292c 0a20 2020 2020 2020 2020  iter),.         
+00008500: 2020 2022 7374 6172 745f 7469 6d65 5f66     "start_time_f
+00008510: 726f 6d22 3a20 6461 7465 7469 6d65 5f74  rom": datetime_t
+00008520: 6f5f 6973 6f28 7374 6172 745f 7469 6d65  o_iso(start_time
+00008530: 5f66 726f 6d29 2c0a 2020 2020 2020 2020  _from),.        
+00008540: 2020 2020 2273 7461 7274 5f74 696d 655f      "start_time_
+00008550: 746f 223a 2064 6174 6574 696d 655f 746f  to": datetime_to
+00008560: 5f69 736f 2873 7461 7274 5f74 696d 655f  _iso(start_time_
+00008570: 746f 292c 0a20 2020 2020 2020 2020 2020  to),.           
+00008580: 2022 6c61 7374 5f75 7064 6174 655f 7469   "last_update_ti
+00008590: 6d65 5f66 726f 6d22 3a20 6461 7465 7469  me_from": dateti
+000085a0: 6d65 5f74 6f5f 6973 6f28 6c61 7374 5f75  me_to_iso(last_u
+000085b0: 7064 6174 655f 7469 6d65 5f66 726f 6d29  pdate_time_from)
+000085c0: 2c0a 2020 2020 2020 2020 2020 2020 226c  ,.            "l
+000085d0: 6173 745f 7570 6461 7465 5f74 696d 655f  ast_update_time_
+000085e0: 746f 223a 2064 6174 6574 696d 655f 746f  to": datetime_to
+000085f0: 5f69 736f 286c 6173 745f 7570 6461 7465  _iso(last_update
+00008600: 5f74 696d 655f 746f 292c 0a20 2020 2020  _time_to),.     
+00008610: 2020 2020 2020 2022 7769 7468 2d6e 6f74         "with-not
+00008620: 6966 6963 6174 696f 6e73 223a 2077 6974  ifications": wit
+00008630: 685f 6e6f 7469 6669 6361 7469 6f6e 732c  h_notifications,
+00008640: 0a20 2020 2020 2020 207d 0a0a 2020 2020  .        }..    
+00008650: 2020 2020 6966 2070 6172 7469 7469 6f6e      if partition
+00008660: 5f62 793a 0a20 2020 2020 2020 2020 2020  _by:.           
+00008670: 2070 6172 616d 732e 7570 6461 7465 280a   params.update(.
+00008680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008690: 7365 6c66 2e5f 6765 6e65 7261 7465 5f70  self._generate_p
+000086a0: 6172 7469 7469 6f6e 5f62 795f 7061 7261  artition_by_para
+000086b0: 6d73 280a 2020 2020 2020 2020 2020 2020  ms(.            
+000086c0: 2020 2020 2020 2020 6d6c 7275 6e2e 636f          mlrun.co
+000086d0: 6d6d 6f6e 2e73 6368 656d 6173 2e52 756e  mmon.schemas.Run
+000086e0: 5061 7274 6974 696f 6e42 7946 6965 6c64  PartitionByField
+000086f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00008700: 2020 2020 2020 7061 7274 6974 696f 6e5f        partition_
+00008710: 6279 2c0a 2020 2020 2020 2020 2020 2020  by,.            
+00008720: 2020 2020 2020 2020 726f 7773 5f70 6572          rows_per
+00008730: 5f70 6172 7469 7469 6f6e 2c0a 2020 2020  _partition,.    
+00008740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008750: 7061 7274 6974 696f 6e5f 736f 7274 5f62  partition_sort_b
+00008760: 792c 0a20 2020 2020 2020 2020 2020 2020  y,.             
+00008770: 2020 2020 2020 2070 6172 7469 7469 6f6e         partition
+00008780: 5f6f 7264 6572 2c0a 2020 2020 2020 2020  _order,.        
+00008790: 2020 2020 2020 2020 2020 2020 6d61 785f              max_
+000087a0: 7061 7274 6974 696f 6e73 2c0a 2020 2020  partitions,.    
+000087b0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+000087c0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+000087d0: 2020 2020 6572 726f 7220 3d20 226c 6973      error = "lis
+000087e0: 7420 7275 6e73 220a 2020 2020 2020 2020  t runs".        
+000087f0: 5f70 6174 6820 3d20 7365 6c66 2e5f 7061  _path = self._pa
+00008800: 7468 5f6f 6628 2272 756e 7322 2c20 7072  th_of("runs", pr
+00008810: 6f6a 6563 7429 0a20 2020 2020 2020 2072  oject).        r
+00008820: 6573 7020 3d20 7365 6c66 2e61 7069 5f63  esp = self.api_c
+00008830: 616c 6c28 2247 4554 222c 205f 7061 7468  all("GET", _path
+00008840: 2c20 6572 726f 722c 2070 6172 616d 733d  , error, params=
+00008850: 7061 7261 6d73 290a 2020 2020 2020 2020  params).        
+00008860: 7265 7475 726e 2052 756e 4c69 7374 2872  return RunList(r
+00008870: 6573 702e 6a73 6f6e 2829 5b22 7275 6e73  esp.json()["runs
+00008880: 225d 290a 0a20 2020 2064 6566 2064 656c  "])..    def del
+00008890: 5f72 756e 7328 7365 6c66 2c20 6e61 6d65  _runs(self, name
+000088a0: 3d4e 6f6e 652c 2070 726f 6a65 6374 3d4e  =None, project=N
+000088b0: 6f6e 652c 206c 6162 656c 733d 4e6f 6e65  one, labels=None
+000088c0: 2c20 7374 6174 653d 4e6f 6e65 2c20 6461  , state=None, da
+000088d0: 7973 5f61 676f 3d30 293a 0a20 2020 2020  ys_ago=0):.     
+000088e0: 2020 2022 2222 4465 6c65 7465 2061 2067     """Delete a g
+000088f0: 726f 7570 206f 6620 7275 6e73 2069 6465  roup of runs ide
+00008900: 6e74 6966 6965 6420 6279 2074 6865 2070  ntified by the p
+00008910: 6172 616d 6574 6572 7320 6f66 2074 6865  arameters of the
+00008920: 2066 756e 6374 696f 6e2e 0a0a 2020 2020   function...    
+00008930: 2020 2020 4578 616d 706c 653a 3a0a 0a20      Example::.. 
+00008940: 2020 2020 2020 2020 2020 2064 622e 6465             db.de
+00008950: 6c5f 7275 6e73 2873 7461 7465 3d27 636f  l_runs(state='co
+00008960: 6d70 6c65 7465 6427 290a 0a20 2020 2020  mpleted')..     
+00008970: 2020 203a 7061 7261 6d20 6e61 6d65 3a20     :param name: 
+00008980: 4e61 6d65 206f 6620 7468 6520 7461 736b  Name of the task
+00008990: 2077 6869 6368 2074 6865 2072 756e 7320   which the runs 
+000089a0: 6265 6c6f 6e67 2074 6f2e 0a20 2020 2020  belong to..     
+000089b0: 2020 203a 7061 7261 6d20 7072 6f6a 6563     :param projec
+000089c0: 743a 2050 726f 6a65 6374 2074 6f20 7768  t: Project to wh
+000089d0: 6963 6820 7468 6520 7275 6e73 2062 656c  ich the runs bel
+000089e0: 6f6e 672e 0a20 2020 2020 2020 203a 7061  ong..        :pa
+000089f0: 7261 6d20 6c61 6265 6c73 3a20 4669 6c74  ram labels: Filt
+00008a00: 6572 2072 756e 7320 7468 6174 2061 7265  er runs that are
+00008a10: 206c 6162 656c 6564 2075 7369 6e67 2074   labeled using t
+00008a20: 6865 7365 2073 7065 6369 6669 6320 6c61  hese specific la
+00008a30: 6265 6c20 7661 6c75 6573 2e0a 2020 2020  bel values..    
+00008a40: 2020 2020 3a70 6172 616d 2073 7461 7465      :param state
+00008a50: 3a20 4669 6c74 6572 206f 6e6c 7920 7275  : Filter only ru
+00008a60: 6e73 2077 6869 6368 2061 7265 2069 6e20  ns which are in 
+00008a70: 7468 6973 2073 7461 7465 2e0a 2020 2020  this state..    
+00008a80: 2020 2020 3a70 6172 616d 2064 6179 735f      :param days_
+00008a90: 6167 6f3a 2046 696c 7465 7220 7275 6e73  ago: Filter runs
+00008aa0: 2077 686f 7365 2073 7461 7274 2074 696d   whose start tim
+00008ab0: 6520 6973 206e 6577 6572 2074 6861 6e20  e is newer than 
+00008ac0: 7468 6973 2070 6172 616d 6574 6572 2e0a  this parameter..
+00008ad0: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
+00008ae0: 2020 2020 2070 726f 6a65 6374 203d 2070       project = p
+00008af0: 726f 6a65 6374 206f 7220 636f 6e66 6967  roject or config
+00008b00: 2e64 6566 6175 6c74 5f70 726f 6a65 6374  .default_project
+00008b10: 0a20 2020 2020 2020 2070 6172 616d 7320  .        params 
+00008b20: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
+00008b30: 226e 616d 6522 3a20 6e61 6d65 2c0a 2020  "name": name,.  
+00008b40: 2020 2020 2020 2020 2020 2270 726f 6a65            "proje
+00008b50: 6374 223a 2070 726f 6a65 6374 2c0a 2020  ct": project,.  
+00008b60: 2020 2020 2020 2020 2020 226c 6162 656c            "label
+00008b70: 223a 206c 6162 656c 7320 6f72 205b 5d2c  ": labels or [],
+00008b80: 0a20 2020 2020 2020 2020 2020 2022 7374  .            "st
+00008b90: 6174 6522 3a20 7374 6174 652c 0a20 2020  ate": state,.   
+00008ba0: 2020 2020 2020 2020 2022 6461 7973 5f61           "days_a
+00008bb0: 676f 223a 2073 7472 2864 6179 735f 6167  go": str(days_ag
+00008bc0: 6f29 2c0a 2020 2020 2020 2020 7d0a 2020  o),.        }.  
+00008bd0: 2020 2020 2020 6572 726f 7220 3d20 2264        error = "d
+00008be0: 656c 2072 756e 7322 0a20 2020 2020 2020  el runs".       
+00008bf0: 205f 7061 7468 203d 2073 656c 662e 5f70   _path = self._p
+00008c00: 6174 685f 6f66 2822 7275 6e73 222c 2070  ath_of("runs", p
+00008c10: 726f 6a65 6374 290a 2020 2020 2020 2020  roject).        
+00008c20: 7365 6c66 2e61 7069 5f63 616c 6c28 2244  self.api_call("D
+00008c30: 454c 4554 4522 2c20 5f70 6174 682c 2065  ELETE", _path, e
+00008c40: 7272 6f72 2c20 7061 7261 6d73 3d70 6172  rror, params=par
+00008c50: 616d 7329 0a0a 2020 2020 6465 6620 7374  ams)..    def st
+00008c60: 6f72 655f 6172 7469 6661 6374 280a 2020  ore_artifact(.  
+00008c70: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+00008c80: 2020 2020 6b65 792c 0a20 2020 2020 2020      key,.       
+00008c90: 2061 7274 6966 6163 742c 0a20 2020 2020   artifact,.     
+00008ca0: 2020 2023 2054 4f44 4f3a 2064 6570 7265     # TODO: depre
+00008cb0: 6361 7465 642c 2072 656d 6f76 6520 696e  cated, remove in
+00008cc0: 2031 2e38 2e30 0a20 2020 2020 2020 2075   1.8.0.        u
+00008cd0: 6964 3d4e 6f6e 652c 0a20 2020 2020 2020  id=None,.       
+00008ce0: 2069 7465 723d 4e6f 6e65 2c0a 2020 2020   iter=None,.    
+00008cf0: 2020 2020 7461 673d 4e6f 6e65 2c0a 2020      tag=None,.  
+00008d00: 2020 2020 2020 7072 6f6a 6563 743d 2222        project=""
+00008d10: 2c0a 2020 2020 2020 2020 7472 6565 3d4e  ,.        tree=N
+00008d20: 6f6e 652c 0a20 2020 2029 3a0a 2020 2020  one,.    ):.    
+00008d30: 2020 2020 2222 2253 746f 7265 2061 6e20      """Store an 
+00008d40: 6172 7469 6661 6374 2069 6e20 7468 6520  artifact in the 
+00008d50: 4442 2e0a 0a20 2020 2020 2020 203a 7061  DB...        :pa
+00008d60: 7261 6d20 6b65 793a 2049 6465 6e74 6966  ram key: Identif
+00008d70: 7969 6e67 206b 6579 206f 6620 7468 6520  ying key of the 
+00008d80: 6172 7469 6661 6374 2e0a 2020 2020 2020  artifact..      
+00008d90: 2020 3a70 6172 616d 2061 7274 6966 6163    :param artifac
+00008da0: 743a 2054 6865 203a 7079 3a63 6c61 7373  t: The :py:class
+00008db0: 3a60 7e6d 6c72 756e 2e61 7274 6966 6163  :`~mlrun.artifac
+00008dc0: 7473 2e41 7274 6966 6163 7460 2074 6f20  ts.Artifact` to 
+00008dd0: 7374 6f72 652e 0a20 2020 2020 2020 203a  store..        :
+00008de0: 7061 7261 6d20 7569 643a 2041 2075 6e69  param uid: A uni
+00008df0: 7175 6520 4944 2066 6f72 2074 6869 7320  que ID for this 
+00008e00: 7370 6563 6966 6963 2076 6572 7369 6f6e  specific version
+00008e10: 206f 6620 7468 6520 6172 7469 6661 6374   of the artifact
+00008e20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00008e30: 2020 2020 2028 6465 7072 6563 6174 6564       (deprecated
+00008e40: 2c20 6172 7469 6661 6374 2075 6964 2069  , artifact uid i
+00008e50: 7320 6765 6e65 7261 7465 6420 696e 2074  s generated in t
+00008e60: 6865 2062 6163 6b65 6e64 2075 7365 2060  he backend use `
+00008e70: 7472 6565 6020 696e 7374 6561 6429 0a20  tree` instead). 
+00008e80: 2020 2020 2020 203a 7061 7261 6d20 6974         :param it
+00008e90: 6572 3a20 5468 6520 7461 736b 2069 7465  er: The task ite
+00008ea0: 7261 7469 6f6e 2077 6869 6368 2067 656e  ration which gen
+00008eb0: 6572 6174 6564 2074 6869 7320 6172 7469  erated this arti
+00008ec0: 6661 6374 2e20 4966 2060 6069 7465 7260  fact. If ``iter`
+00008ed0: 6020 6973 206e 6f74 2060 604e 6f6e 6560  ` is not ``None`
+00008ee0: 6020 7468 6520 6974 6572 6174 696f 6e20  ` the iteration 
+00008ef0: 7769 6c6c 0a20 2020 2020 2020 2020 2020  will.           
+00008f00: 2062 6520 6164 6465 6420 746f 2074 6865   be added to the
+00008f10: 206b 6579 2070 726f 7669 6465 6420 746f   key provided to
+00008f20: 2067 656e 6572 6174 6520 6120 756e 6971   generate a uniq
+00008f30: 7565 206b 6579 2066 6f72 2074 6865 2061  ue key for the a
+00008f40: 7274 6966 6163 7420 6f66 2074 6865 2073  rtifact of the s
+00008f50: 7065 6369 6669 6320 6974 6572 6174 696f  pecific iteratio
+00008f60: 6e2e 0a20 2020 2020 2020 203a 7061 7261  n..        :para
+00008f70: 6d20 7461 673a 2054 6167 206f 6620 7468  m tag: Tag of th
+00008f80: 6520 6172 7469 6661 6374 2e0a 2020 2020  e artifact..    
+00008f90: 2020 2020 3a70 6172 616d 2070 726f 6a65      :param proje
+00008fa0: 6374 3a20 5072 6f6a 6563 7420 7468 6174  ct: Project that
+00008fb0: 2074 6865 2061 7274 6966 6163 7420 6265   the artifact be
+00008fc0: 6c6f 6e67 7320 746f 2e0a 2020 2020 2020  longs to..      
+00008fd0: 2020 3a70 6172 616d 2074 7265 653a 2054    :param tree: T
+00008fe0: 6865 2074 7265 6520 2870 726f 6475 6365  he tree (produce
+00008ff0: 7220 6964 2920 7768 6963 6820 6765 6e65  r id) which gene
+00009000: 7261 7465 6420 7468 6973 2061 7274 6966  rated this artif
+00009010: 6163 742e 0a20 2020 2020 2020 2022 2222  act..        """
+00009020: 0a20 2020 2020 2020 2069 6620 7569 643a  .        if uid:
+00009030: 0a20 2020 2020 2020 2020 2020 2077 6172  .            war
+00009040: 6e69 6e67 732e 7761 726e 280a 2020 2020  nings.warn(.    
+00009050: 2020 2020 2020 2020 2020 2020 2227 7569              "'ui
+00009060: 6427 2069 7320 6465 7072 6563 6174 6564  d' is deprecated
+00009070: 2069 6e20 312e 362e 3020 616e 6420 7769   in 1.6.0 and wi
+00009080: 6c6c 2062 6520 7265 6d6f 7665 6420 696e  ll be removed in
+00009090: 2031 2e38 2e30 2c20 7573 6520 2774 7265   1.8.0, use 'tre
+000090a0: 6527 2069 6e73 7465 6164 2e22 2c0a 2020  e' instead.",.  
+000090b0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+000090c0: 544f 444f 3a20 5265 6d6f 7665 2074 6869  TODO: Remove thi
+000090d0: 7320 696e 2031 2e38 2e30 0a20 2020 2020  s in 1.8.0.     
+000090e0: 2020 2020 2020 2020 2020 2046 7574 7572             Futur
+000090f0: 6557 6172 6e69 6e67 2c0a 2020 2020 2020  eWarning,.      
+00009100: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+00009110: 2023 2077 6520 646f 2074 6869 7320 6265   # we do this be
+00009120: 6361 7573 6520 7072 6576 696f 7573 6c79  cause previously
+00009130: 2074 6865 2027 7569 6427 206e 616d 6520   the 'uid' name 
+00009140: 7761 7320 7573 6564 2066 6f72 2074 6865  was used for the
+00009150: 2027 7472 6565 2720 7061 7261 6d65 7465   'tree' paramete
+00009160: 720a 2020 2020 2020 2020 7472 6565 203d  r.        tree =
+00009170: 2074 7265 6520 6f72 2075 6964 0a0a 2020   tree or uid..  
+00009180: 2020 2020 2020 656e 6470 6f69 6e74 5f70        endpoint_p
+00009190: 6174 6820 3d20 6622 7072 6f6a 6563 7473  ath = f"projects
+000091a0: 2f7b 7072 6f6a 6563 747d 2f61 7274 6966  /{project}/artif
+000091b0: 6163 7473 2f7b 6b65 797d 220a 0a20 2020  acts/{key}"..   
+000091c0: 2020 2020 2065 7272 6f72 203d 2066 2273       error = f"s
+000091d0: 746f 7265 2061 7274 6966 6163 7420 7b70  tore artifact {p
+000091e0: 726f 6a65 6374 7d2f 7b6b 6579 7d22 0a0a  roject}/{key}"..
+000091f0: 2020 2020 2020 2020 7061 7261 6d73 203d          params =
+00009200: 207b 7d0a 2020 2020 2020 2020 6966 2069   {}.        if i
+00009210: 7465 723a 0a20 2020 2020 2020 2020 2020  ter:.           
+00009220: 2070 6172 616d 735b 2269 7465 7222 5d20   params["iter"] 
+00009230: 3d20 7374 7228 6974 6572 290a 2020 2020  = str(iter).    
+00009240: 2020 2020 6966 2074 6167 3a0a 2020 2020      if tag:.    
+00009250: 2020 2020 2020 2020 7061 7261 6d73 5b22          params["
+00009260: 7461 6722 5d20 3d20 7461 670a 2020 2020  tag"] = tag.    
+00009270: 2020 2020 6966 2074 7265 653a 0a20 2020      if tree:.   
+00009280: 2020 2020 2020 2020 2070 6172 616d 735b           params[
+00009290: 2274 7265 6522 5d20 3d20 7472 6565 0a0a  "tree"] = tree..
+000092a0: 2020 2020 2020 2020 626f 6479 203d 205f          body = _
+000092b0: 6173 5f6a 736f 6e28 6172 7469 6661 6374  as_json(artifact
+000092c0: 290a 2020 2020 2020 2020 7365 6c66 2e61  ).        self.a
+000092d0: 7069 5f63 616c 6c28 0a20 2020 2020 2020  pi_call(.       
+000092e0: 2020 2020 2022 5055 5422 2c20 656e 6470       "PUT", endp
+000092f0: 6f69 6e74 5f70 6174 682c 2065 7272 6f72  oint_path, error
+00009300: 2c20 626f 6479 3d62 6f64 792c 2070 6172  , body=body, par
+00009310: 616d 733d 7061 7261 6d73 2c20 7665 7273  ams=params, vers
+00009320: 696f 6e3d 2276 3222 0a20 2020 2020 2020  ion="v2".       
+00009330: 2029 0a0a 2020 2020 6465 6620 7265 6164   )..    def read
+00009340: 5f61 7274 6966 6163 7428 0a20 2020 2020  _artifact(.     
+00009350: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+00009360: 206b 6579 2c0a 2020 2020 2020 2020 7461   key,.        ta
+00009370: 673d 4e6f 6e65 2c0a 2020 2020 2020 2020  g=None,.        
+00009380: 6974 6572 3d4e 6f6e 652c 0a20 2020 2020  iter=None,.     
+00009390: 2020 2070 726f 6a65 6374 3d22 222c 0a20     project="",. 
+000093a0: 2020 2020 2020 2074 7265 653d 4e6f 6e65         tree=None
+000093b0: 2c0a 2020 2020 2020 2020 7569 643d 4e6f  ,.        uid=No
+000093c0: 6e65 2c0a 2020 2020 293a 0a20 2020 2020  ne,.    ):.     
+000093d0: 2020 2022 2222 5265 6164 2061 6e20 6172     """Read an ar
+000093e0: 7469 6661 6374 2c20 6964 656e 7469 6669  tifact, identifi
+000093f0: 6564 2062 7920 6974 7320 6b65 792c 2074  ed by its key, t
+00009400: 6167 2c20 7472 6565 2061 6e64 2069 7465  ag, tree and ite
+00009410: 7261 7469 6f6e 2e0a 0a20 2020 2020 2020  ration...       
+00009420: 203a 7061 7261 6d20 6b65 793a 2049 6465   :param key: Ide
+00009430: 6e74 6966 7969 6e67 206b 6579 206f 6620  ntifying key of 
+00009440: 7468 6520 6172 7469 6661 6374 2e0a 2020  the artifact..  
+00009450: 2020 2020 2020 3a70 6172 616d 2074 6167        :param tag
+00009460: 3a20 5461 6720 6f66 2074 6865 2061 7274  : Tag of the art
+00009470: 6966 6163 742e 0a20 2020 2020 2020 203a  ifact..        :
+00009480: 7061 7261 6d20 6974 6572 3a20 5468 6520  param iter: The 
+00009490: 6974 6572 6174 696f 6e20 7768 6963 6820  iteration which 
+000094a0: 6765 6e65 7261 7465 6420 7468 6973 2061  generated this a
+000094b0: 7274 6966 6163 7420 2877 6865 7265 2060  rtifact (where `
+000094c0: 6069 7465 723d 3060 6020 6d65 616e 7320  `iter=0`` means 
+000094d0: 7468 6520 726f 6f74 2069 7465 7261 7469  the root iterati
+000094e0: 6f6e 292e 0a20 2020 2020 2020 203a 7061  on)..        :pa
+000094f0: 7261 6d20 7072 6f6a 6563 743a 2050 726f  ram project: Pro
+00009500: 6a65 6374 2074 6861 7420 7468 6520 6172  ject that the ar
+00009510: 7469 6661 6374 2062 656c 6f6e 6773 2074  tifact belongs t
+00009520: 6f2e 0a20 2020 2020 2020 203a 7061 7261  o..        :para
+00009530: 6d20 7472 6565 3a20 5468 6520 7472 6565  m tree: The tree
+00009540: 2077 6869 6368 2067 656e 6572 6174 6564   which generated
+00009550: 2074 6869 7320 6172 7469 6661 6374 2e0a   this artifact..
+00009560: 2020 2020 2020 2020 3a70 6172 616d 2075          :param u
+00009570: 6964 3a20 4120 756e 6971 7565 2049 4420  id: A unique ID 
+00009580: 666f 7220 7468 6973 2073 7065 6369 6669  for this specifi
+00009590: 6320 7665 7273 696f 6e20 6f66 2074 6865  c version of the
+000095a0: 2061 7274 6966 6163 7420 2874 6865 2075   artifact (the u
+000095b0: 6964 2074 6861 7420 7761 7320 6765 6e65  id that was gene
+000095c0: 7261 7465 6420 696e 2074 6865 2062 6163  rated in the bac
+000095d0: 6b65 6e64 290a 2020 2020 2020 2020 2222  kend).        ""
+000095e0: 220a 0a20 2020 2020 2020 2070 726f 6a65  "..        proje
+000095f0: 6374 203d 2070 726f 6a65 6374 206f 7220  ct = project or 
+00009600: 636f 6e66 6967 2e64 6566 6175 6c74 5f70  config.default_p
+00009610: 726f 6a65 6374 0a20 2020 2020 2020 2074  roject.        t
+00009620: 6167 203d 2074 6167 206f 7220 226c 6174  ag = tag or "lat
+00009630: 6573 7422 0a20 2020 2020 2020 2065 6e64  est".        end
+00009640: 706f 696e 745f 7061 7468 203d 2066 2270  point_path = f"p
+00009650: 726f 6a65 6374 732f 7b70 726f 6a65 6374  rojects/{project
+00009660: 7d2f 6172 7469 6661 6374 732f 7b6b 6579  }/artifacts/{key
+00009670: 7d22 0a20 2020 2020 2020 2065 7272 6f72  }".        error
+00009680: 203d 2066 2272 6561 6420 6172 7469 6661   = f"read artifa
+00009690: 6374 207b 7072 6f6a 6563 747d 2f7b 6b65  ct {project}/{ke
+000096a0: 797d 220a 2020 2020 2020 2020 2320 6578  y}".        # ex
+000096b0: 706c 6963 6974 6c79 2073 6574 2061 7274  plicitly set art
+000096c0: 6966 6163 7473 2066 6f72 6d61 7420 746f  ifacts format to
+000096d0: 2027 6675 6c6c 2720 7369 6e63 6520 6f6c   'full' since ol
+000096e0: 6420 7365 7276 6572 7320 6d61 7920 6465  d servers may de
+000096f0: 6661 756c 7420 746f 2027 6c65 6761 6379  fault to 'legacy
+00009700: 270a 2020 2020 2020 2020 7061 7261 6d73  '.        params
+00009710: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
+00009720: 2022 666f 726d 6174 223a 206d 6c72 756e   "format": mlrun
+00009730: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
+00009740: 4172 7469 6661 6374 7346 6f72 6d61 742e  ArtifactsFormat.
+00009750: 6675 6c6c 2e76 616c 7565 2c0a 2020 2020  full.value,.    
+00009760: 2020 2020 2020 2020 2274 6167 223a 2074          "tag": t
+00009770: 6167 2c0a 2020 2020 2020 2020 2020 2020  ag,.            
+00009780: 2274 7265 6522 3a20 7472 6565 2c0a 2020  "tree": tree,.  
+00009790: 2020 2020 2020 2020 2020 2275 6964 223a            "uid":
+000097a0: 2075 6964 2c0a 2020 2020 2020 2020 7d0a   uid,.        }.
+000097b0: 2020 2020 2020 2020 6966 2069 7465 723a          if iter:
+000097c0: 0a20 2020 2020 2020 2020 2020 2070 6172  .            par
+000097d0: 616d 735b 2269 7465 7222 5d20 3d20 7374  ams["iter"] = st
+000097e0: 7228 6974 6572 290a 2020 2020 2020 2020  r(iter).        
+000097f0: 7265 7370 203d 2073 656c 662e 6170 695f  resp = self.api_
+00009800: 6361 6c6c 2822 4745 5422 2c20 656e 6470  call("GET", endp
+00009810: 6f69 6e74 5f70 6174 682c 2065 7272 6f72  oint_path, error
+00009820: 2c20 7061 7261 6d73 3d70 6172 616d 732c  , params=params,
+00009830: 2076 6572 7369 6f6e 3d22 7632 2229 0a20   version="v2"). 
+00009840: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
+00009850: 7370 2e6a 736f 6e28 290a 0a20 2020 2064  sp.json()..    d
+00009860: 6566 2064 656c 5f61 7274 6966 6163 7428  ef del_artifact(
+00009870: 7365 6c66 2c20 6b65 792c 2074 6167 3d4e  self, key, tag=N
+00009880: 6f6e 652c 2070 726f 6a65 6374 3d22 222c  one, project="",
+00009890: 2074 7265 653d 4e6f 6e65 2c20 7569 643d   tree=None, uid=
+000098a0: 4e6f 6e65 293a 0a20 2020 2020 2020 2022  None):.        "
+000098b0: 2222 4465 6c65 7465 2061 6e20 6172 7469  ""Delete an arti
+000098c0: 6661 6374 2e0a 0a20 2020 2020 2020 203a  fact...        :
+000098d0: 7061 7261 6d20 6b65 793a 2049 6465 6e74  param key: Ident
+000098e0: 6966 7969 6e67 206b 6579 206f 6620 7468  ifying key of th
+000098f0: 6520 6172 7469 6661 6374 2e0a 2020 2020  e artifact..    
+00009900: 2020 2020 3a70 6172 616d 2074 6167 3a20      :param tag: 
+00009910: 5461 6720 6f66 2074 6865 2061 7274 6966  Tag of the artif
+00009920: 6163 742e 0a20 2020 2020 2020 203a 7061  act..        :pa
+00009930: 7261 6d20 7072 6f6a 6563 743a 2050 726f  ram project: Pro
+00009940: 6a65 6374 2074 6861 7420 7468 6520 6172  ject that the ar
+00009950: 7469 6661 6374 2062 656c 6f6e 6773 2074  tifact belongs t
+00009960: 6f2e 0a20 2020 2020 2020 203a 7061 7261  o..        :para
+00009970: 6d20 7472 6565 3a20 5468 6520 7472 6565  m tree: The tree
+00009980: 2077 6869 6368 2067 656e 6572 6174 6564   which generated
+00009990: 2074 6869 7320 6172 7469 6661 6374 2e0a   this artifact..
+000099a0: 2020 2020 2020 2020 3a70 6172 616d 2075          :param u
+000099b0: 6964 3a20 4120 756e 6971 7565 2049 4420  id: A unique ID 
+000099c0: 666f 7220 7468 6973 2073 7065 6369 6669  for this specifi
+000099d0: 6320 7665 7273 696f 6e20 6f66 2074 6865  c version of the
+000099e0: 2061 7274 6966 6163 7420 2874 6865 2075   artifact (the u
+000099f0: 6964 2074 6861 7420 7761 7320 6765 6e65  id that was gene
+00009a00: 7261 7465 6420 696e 2074 6865 2062 6163  rated in the bac
+00009a10: 6b65 6e64 290a 2020 2020 2020 2020 2222  kend).        ""
+00009a20: 220a 0a20 2020 2020 2020 2065 6e64 706f  "..        endpo
+00009a30: 696e 745f 7061 7468 203d 2066 2270 726f  int_path = f"pro
+00009a40: 6a65 6374 732f 7b70 726f 6a65 6374 7d2f  jects/{project}/
+00009a50: 6172 7469 6661 6374 732f 7b6b 6579 7d22  artifacts/{key}"
+00009a60: 0a20 2020 2020 2020 2070 6172 616d 7320  .        params 
+00009a70: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
+00009a80: 226b 6579 223a 206b 6579 2c0a 2020 2020  "key": key,.    
+00009a90: 2020 2020 2020 2020 2274 6167 223a 2074          "tag": t
+00009aa0: 6167 2c0a 2020 2020 2020 2020 2020 2020  ag,.            
+00009ab0: 2274 7265 6522 3a20 7472 6565 2c0a 2020  "tree": tree,.  
+00009ac0: 2020 2020 2020 2020 2020 2275 6964 223a            "uid":
+00009ad0: 2075 6964 2c0a 2020 2020 2020 2020 7d0a   uid,.        }.
+00009ae0: 2020 2020 2020 2020 6572 726f 7220 3d20          error = 
+00009af0: 6622 6465 6c20 6172 7469 6661 6374 207b  f"del artifact {
+00009b00: 7072 6f6a 6563 747d 2f7b 6b65 797d 220a  project}/{key}".
+00009b10: 2020 2020 2020 2020 7365 6c66 2e61 7069          self.api
+00009b20: 5f63 616c 6c28 2244 454c 4554 4522 2c20  _call("DELETE", 
+00009b30: 656e 6470 6f69 6e74 5f70 6174 682c 2065  endpoint_path, e
+00009b40: 7272 6f72 2c20 7061 7261 6d73 3d70 6172  rror, params=par
+00009b50: 616d 732c 2076 6572 7369 6f6e 3d22 7632  ams, version="v2
+00009b60: 2229 0a0a 2020 2020 6465 6620 6c69 7374  ")..    def list
+00009b70: 5f61 7274 6966 6163 7473 280a 2020 2020  _artifacts(.    
+00009b80: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+00009b90: 2020 6e61 6d65 3d4e 6f6e 652c 0a20 2020    name=None,.   
+00009ba0: 2020 2020 2070 726f 6a65 6374 3d4e 6f6e       project=Non
+00009bb0: 652c 0a20 2020 2020 2020 2074 6167 3d4e  e,.        tag=N
+00009bc0: 6f6e 652c 0a20 2020 2020 2020 206c 6162  one,.        lab
+00009bd0: 656c 733a 204f 7074 696f 6e61 6c5b 556e  els: Optional[Un
+00009be0: 696f 6e5b 6469 6374 5b73 7472 2c20 7374  ion[dict[str, st
+00009bf0: 725d 2c20 6c69 7374 5b73 7472 5d5d 5d20  r], list[str]]] 
+00009c00: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
+00009c10: 7369 6e63 653d 4e6f 6e65 2c0a 2020 2020  since=None,.    
+00009c20: 2020 2020 756e 7469 6c3d 4e6f 6e65 2c0a      until=None,.
+00009c30: 2020 2020 2020 2020 6974 6572 3a20 696e          iter: in
+00009c40: 7420 3d20 4e6f 6e65 2c0a 2020 2020 2020  t = None,.      
+00009c50: 2020 6265 7374 5f69 7465 7261 7469 6f6e    best_iteration
+00009c60: 3a20 626f 6f6c 203d 2046 616c 7365 2c0a  : bool = False,.
+00009c70: 2020 2020 2020 2020 6b69 6e64 3a20 7374          kind: st
+00009c80: 7220 3d20 4e6f 6e65 2c0a 2020 2020 2020  r = None,.      
+00009c90: 2020 6361 7465 676f 7279 3a20 556e 696f    category: Unio
+00009ca0: 6e5b 7374 722c 206d 6c72 756e 2e63 6f6d  n[str, mlrun.com
+00009cb0: 6d6f 6e2e 7363 6865 6d61 732e 4172 7469  mon.schemas.Arti
+00009cc0: 6661 6374 4361 7465 676f 7269 6573 5d20  factCategories] 
+00009cd0: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
+00009ce0: 7472 6565 3a20 7374 7220 3d20 4e6f 6e65  tree: str = None
+00009cf0: 2c0a 2020 2020 2920 2d3e 2041 7274 6966  ,.    ) -> Artif
+00009d00: 6163 744c 6973 743a 0a20 2020 2020 2020  actList:.       
+00009d10: 2022 2222 4c69 7374 2061 7274 6966 6163   """List artifac
+00009d20: 7473 2066 696c 7465 7265 6420 6279 2076  ts filtered by v
+00009d30: 6172 696f 7573 2070 6172 616d 6574 6572  arious parameter
+00009d40: 732e 0a0a 2020 2020 2020 2020 4578 616d  s...        Exam
+00009d50: 706c 6573 3a3a 0a0a 2020 2020 2020 2020  ples::..        
+00009d60: 2020 2020 2320 5368 6f77 206c 6174 6573      # Show lates
+00009d70: 7420 7665 7273 696f 6e20 6f66 2061 6c6c  t version of all
+00009d80: 2061 7274 6966 6163 7473 2069 6e20 7072   artifacts in pr
+00009d90: 6f6a 6563 740a 2020 2020 2020 2020 2020  oject.          
+00009da0: 2020 6c61 7465 7374 5f61 7274 6966 6163    latest_artifac
+00009db0: 7473 203d 2064 622e 6c69 7374 5f61 7274  ts = db.list_art
+00009dc0: 6966 6163 7473 2827 272c 2074 6167 3d27  ifacts('', tag='
+00009dd0: 6c61 7465 7374 272c 2070 726f 6a65 6374  latest', project
+00009de0: 3d27 6972 6973 2729 0a20 2020 2020 2020  ='iris').       
+00009df0: 2020 2020 2023 2063 6865 636b 2064 6966       # check dif
+00009e00: 6665 7265 6e74 2061 7274 6966 6163 7420  ferent artifact 
+00009e10: 7665 7273 696f 6e73 2066 6f72 2061 2073  versions for a s
+00009e20: 7065 6369 6669 6320 6172 7469 6661 6374  pecific artifact
+00009e30: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
+00009e40: 756c 745f 7665 7273 696f 6e73 203d 2064  ult_versions = d
+00009e50: 622e 6c69 7374 5f61 7274 6966 6163 7473  b.list_artifacts
+00009e60: 2827 7265 7375 6c74 7327 2c20 7461 673d  ('results', tag=
+00009e70: 272a 272c 2070 726f 6a65 6374 3d27 6972  '*', project='ir
+00009e80: 6973 2729 0a20 2020 2020 2020 2020 2020  is').           
+00009e90: 2023 2053 686f 7720 6172 7469 6661 6374   # Show artifact
+00009ea0: 7320 7769 7468 206c 6162 656c 2066 696c  s with label fil
+00009eb0: 7465 7273 202d 2062 6f74 6820 7570 6c6f  ters - both uplo
+00009ec0: 6164 6564 2061 6e64 206f 6620 6269 6e61  aded and of bina
+00009ed0: 7279 2074 7970 650a 2020 2020 2020 2020  ry type.        
+00009ee0: 2020 2020 7265 7375 6c74 5f6c 6162 656c      result_label
+00009ef0: 7320 3d20 6462 2e6c 6973 745f 6172 7469  s = db.list_arti
+00009f00: 6661 6374 7328 2772 6573 756c 7473 272c  facts('results',
+00009f10: 2074 6167 3d27 2a27 2c20 7072 6f6a 6563   tag='*', projec
+00009f20: 743d 2769 7269 7327 2c20 6c61 6265 6c73  t='iris', labels
+00009f30: 3d5b 2775 706c 6f61 6465 6427 2c20 2774  =['uploaded', 't
+00009f40: 7970 653d 6269 6e61 7279 275d 290a 0a20  ype=binary']).. 
+00009f50: 2020 2020 2020 203a 7061 7261 6d20 6e61         :param na
+00009f60: 6d65 3a20 4e61 6d65 206f 6620 6172 7469  me: Name of arti
+00009f70: 6661 6374 7320 746f 2072 6574 7269 6576  facts to retriev
+00009f80: 652e 204e 616d 6520 7769 7468 2027 7e27  e. Name with '~'
+00009f90: 2070 7265 6669 7820 6973 2075 7365 6420   prefix is used 
+00009fa0: 6173 2061 206c 696b 6520 7175 6572 792c  as a like query,
+00009fb0: 2061 6e64 2069 7320 6e6f 740a 2020 2020   and is not.    
+00009fc0: 2020 2020 2020 2020 6361 7365 2d73 656e          case-sen
+00009fd0: 7369 7469 7665 2e20 5468 6973 206d 6561  sitive. This mea
+00009fe0: 6e73 2074 6861 7420 7175 6572 7969 6e67  ns that querying
+00009ff0: 2066 6f72 2060 607e 6e61 6d65 6060 206d   for ``~name`` m
+0000a000: 6179 2072 6574 7572 6e20 6172 7469 6661  ay return artifa
+0000a010: 6374 7320 6e61 6d65 640a 2020 2020 2020  cts named.      
+0000a020: 2020 2020 2020 6060 6d79 5f4e 616d 655f        ``my_Name_
+0000a030: 3160 6020 6f72 2060 6073 7572 6e61 6d65  1`` or ``surname
+0000a040: 6060 2e0a 2020 2020 2020 2020 3a70 6172  ``..        :par
+0000a050: 616d 2070 726f 6a65 6374 3a20 5072 6f6a  am project: Proj
+0000a060: 6563 7420 6e61 6d65 2e0a 2020 2020 2020  ect name..      
+0000a070: 2020 3a70 6172 616d 2074 6167 3a20 5265    :param tag: Re
+0000a080: 7475 726e 2061 7274 6966 6163 7473 2061  turn artifacts a
+0000a090: 7373 6967 6e65 6420 7468 6973 2074 6167  ssigned this tag
+0000a0a0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0000a0b0: 206c 6162 656c 733a 2052 6574 7572 6e20   labels: Return 
+0000a0c0: 6172 7469 6661 6374 7320 7468 6174 2068  artifacts that h
+0000a0d0: 6176 6520 7468 6573 6520 6c61 6265 6c73  ave these labels
+0000a0e0: 2e20 4c61 6265 6c73 2063 616e 2065 6974  . Labels can eit
+0000a0f0: 6865 7220 6265 2061 2064 6963 7469 6f6e  her be a diction
+0000a100: 6172 7920 7b22 6c61 6265 6c22 3a20 2276  ary {"label": "v
+0000a110: 616c 7565 227d 206f 720a 2020 2020 2020  alue"} or.      
+0000a120: 2020 2020 2020 6120 6c69 7374 206f 6620        a list of 
+0000a130: 226c 6162 656c 3d76 616c 7565 2220 286d  "label=value" (m
+0000a140: 6174 6368 206c 6162 656c 206b 6579 2061  atch label key a
+0000a150: 6e64 2076 616c 7565 2920 6f72 2022 6c61  nd value) or "la
+0000a160: 6265 6c22 2028 6d61 7463 6820 6a75 7374  bel" (match just
+0000a170: 206c 6162 656c 206b 6579 2920 7374 7269   label key) stri
+0000a180: 6e67 732e 0a20 2020 2020 2020 203a 7061  ngs..        :pa
+0000a190: 7261 6d20 7369 6e63 653a 204e 6f74 2069  ram since: Not i
+0000a1a0: 6e20 7573 6520 696e 203a 7079 3a63 6c61  n use in :py:cla
+0000a1b0: 7373 3a60 4854 5450 5275 6e44 4260 2e0a  ss:`HTTPRunDB`..
+0000a1c0: 2020 2020 2020 2020 3a70 6172 616d 2075          :param u
+0000a1d0: 6e74 696c 3a20 4e6f 7420 696e 2075 7365  ntil: Not in use
+0000a1e0: 2069 6e20 3a70 793a 636c 6173 733a 6048   in :py:class:`H
+0000a1f0: 5454 5052 756e 4442 602e 0a20 2020 2020  TTPRunDB`..     
+0000a200: 2020 203a 7061 7261 6d20 6974 6572 3a20     :param iter: 
+0000a210: 5265 7475 726e 2061 7274 6966 6163 7473  Return artifacts
+0000a220: 2066 726f 6d20 6120 7370 6563 6966 6963   from a specific
+0000a230: 2069 7465 7261 7469 6f6e 2028 7768 6572   iteration (wher
+0000a240: 6520 6060 6974 6572 3d30 6060 206d 6561  e ``iter=0`` mea
+0000a250: 6e73 2074 6865 2072 6f6f 7420 6974 6572  ns the root iter
+0000a260: 6174 696f 6e29 2e20 4966 0a20 2020 2020  ation). If.     
+0000a270: 2020 2020 2020 2060 604e 6f6e 6560 6020         ``None`` 
+0000a280: 2864 6566 6175 6c74 2920 7265 7475 726e  (default) return
+0000a290: 2061 7274 6966 6163 7473 2066 726f 6d20   artifacts from 
+0000a2a0: 616c 6c20 6974 6572 6174 696f 6e73 2e0a  all iterations..
+0000a2b0: 2020 2020 2020 2020 3a70 6172 616d 2062          :param b
+0000a2c0: 6573 745f 6974 6572 6174 696f 6e3a 2052  est_iteration: R
+0000a2d0: 6574 7572 6e73 2074 6865 2061 7274 6966  eturns the artif
+0000a2e0: 6163 7420 7768 6963 6820 6265 6c6f 6e67  act which belong
+0000a2f0: 7320 746f 2074 6865 2062 6573 7420 6974  s to the best it
+0000a300: 6572 6174 696f 6e20 6f66 2061 2067 6976  eration of a giv
+0000a310: 656e 2072 756e 2c20 696e 2074 6865 2063  en run, in the c
+0000a320: 6173 6520 6f66 0a20 2020 2020 2020 2020  ase of.         
+0000a330: 2020 2061 7274 6966 6163 7473 2067 656e     artifacts gen
+0000a340: 6572 6174 6564 2066 726f 6d20 6120 6879  erated from a hy
+0000a350: 7065 722d 7061 7261 6d20 7275 6e2e 2049  per-param run. I
+0000a360: 6620 6f6e 6c79 2061 2073 696e 676c 6520  f only a single 
+0000a370: 6974 6572 6174 696f 6e20 6578 6973 7473  iteration exists
+0000a380: 2c20 7769 6c6c 2072 6574 7572 6e20 7468  , will return th
+0000a390: 6520 6172 7469 6661 6374 0a20 2020 2020  e artifact.     
+0000a3a0: 2020 2020 2020 2066 726f 6d20 7468 6174         from that
+0000a3b0: 2069 7465 7261 7469 6f6e 2e20 4966 2075   iteration. If u
+0000a3c0: 7369 6e67 2060 6062 6573 745f 6974 6572  sing ``best_iter
+0000a3d0: 6060 2c20 7468 6520 6060 6974 6572 6060  ``, the ``iter``
+0000a3e0: 2070 6172 616d 6574 6572 206d 7573 7420   parameter must 
+0000a3f0: 6e6f 7420 6265 2075 7365 642e 0a20 2020  not be used..   
+0000a400: 2020 2020 203a 7061 7261 6d20 6b69 6e64       :param kind
+0000a410: 3a20 5265 7475 726e 2061 7274 6966 6163  : Return artifac
+0000a420: 7473 206f 6620 7468 6520 7265 7175 6573  ts of the reques
+0000a430: 7465 6420 6b69 6e64 2e0a 2020 2020 2020  ted kind..      
+0000a440: 2020 3a70 6172 616d 2063 6174 6567 6f72    :param categor
+0000a450: 793a 2052 6574 7572 6e20 6172 7469 6661  y: Return artifa
+0000a460: 6374 7320 6f66 2074 6865 2072 6571 7565  cts of the reque
+0000a470: 7374 6564 2063 6174 6567 6f72 792e 0a20  sted category.. 
+0000a480: 2020 2020 2020 203a 7061 7261 6d20 7472         :param tr
+0000a490: 6565 3a20 5265 7475 726e 2061 7274 6966  ee: Return artif
+0000a4a0: 6163 7473 206f 6620 7468 6520 7265 7175  acts of the requ
+0000a4b0: 6573 7465 6420 7472 6565 2e0a 2020 2020  ested tree..    
+0000a4c0: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
+0000a4d0: 2070 726f 6a65 6374 203d 2070 726f 6a65   project = proje
+0000a4e0: 6374 206f 7220 636f 6e66 6967 2e64 6566  ct or config.def
+0000a4f0: 6175 6c74 5f70 726f 6a65 6374 0a0a 2020  ault_project..  
+0000a500: 2020 2020 2020 6c61 6265 6c73 203d 206c        labels = l
+0000a510: 6162 656c 7320 6f72 205b 5d0a 2020 2020  abels or [].    
+0000a520: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+0000a530: 6528 6c61 6265 6c73 2c20 6469 6374 293a  e(labels, dict):
+0000a540: 0a20 2020 2020 2020 2020 2020 206c 6162  .            lab
+0000a550: 656c 7320 3d20 5b66 227b 6b65 797d 3d7b  els = [f"{key}={
+0000a560: 7661 6c75 657d 2220 666f 7220 6b65 792c  value}" for key,
+0000a570: 2076 616c 7565 2069 6e20 6c61 6265 6c73   value in labels
+0000a580: 2e69 7465 6d73 2829 5d0a 0a20 2020 2020  .items()]..     
+0000a590: 2020 2070 6172 616d 7320 3d20 7b0a 2020     params = {.  
+0000a5a0: 2020 2020 2020 2020 2020 226e 616d 6522            "name"
+0000a5b0: 3a20 6e61 6d65 2c0a 2020 2020 2020 2020  : name,.        
+0000a5c0: 2020 2020 2274 6167 223a 2074 6167 2c0a      "tag": tag,.
+0000a5d0: 2020 2020 2020 2020 2020 2020 226c 6162              "lab
+0000a5e0: 656c 223a 206c 6162 656c 732c 0a20 2020  el": labels,.   
+0000a5f0: 2020 2020 2020 2020 2022 6974 6572 223a           "iter":
+0000a600: 2069 7465 722c 0a20 2020 2020 2020 2020   iter,.         
+0000a610: 2020 2022 6265 7374 2d69 7465 7261 7469     "best-iterati
+0000a620: 6f6e 223a 2062 6573 745f 6974 6572 6174  on": best_iterat
+0000a630: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
+0000a640: 2022 6b69 6e64 223a 206b 696e 642c 0a20   "kind": kind,. 
+0000a650: 2020 2020 2020 2020 2020 2022 6361 7465             "cate
+0000a660: 676f 7279 223a 2063 6174 6567 6f72 792c  gory": category,
+0000a670: 0a20 2020 2020 2020 2020 2020 2022 7472  .            "tr
+0000a680: 6565 223a 2074 7265 652c 0a20 2020 2020  ee": tree,.     
+0000a690: 2020 2020 2020 2022 666f 726d 6174 223a         "format":
+0000a6a0: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
+0000a6b0: 6865 6d61 732e 4172 7469 6661 6374 7346  hemas.ArtifactsF
+0000a6c0: 6f72 6d61 742e 6675 6c6c 2e76 616c 7565  ormat.full.value
+0000a6d0: 2c0a 2020 2020 2020 2020 7d0a 2020 2020  ,.        }.    
+0000a6e0: 2020 2020 6572 726f 7220 3d20 226c 6973      error = "lis
+0000a6f0: 7420 6172 7469 6661 6374 7322 0a20 2020  t artifacts".   
+0000a700: 2020 2020 2065 6e64 706f 696e 745f 7061       endpoint_pa
+0000a710: 7468 203d 2066 2270 726f 6a65 6374 732f  th = f"projects/
+0000a720: 7b70 726f 6a65 6374 7d2f 6172 7469 6661  {project}/artifa
+0000a730: 6374 7322 0a20 2020 2020 2020 2072 6573  cts".        res
+0000a740: 7020 3d20 7365 6c66 2e61 7069 5f63 616c  p = self.api_cal
+0000a750: 6c28 2247 4554 222c 2065 6e64 706f 696e  l("GET", endpoin
+0000a760: 745f 7061 7468 2c20 6572 726f 722c 2070  t_path, error, p
+0000a770: 6172 616d 733d 7061 7261 6d73 2c20 7665  arams=params, ve
+0000a780: 7273 696f 6e3d 2276 3222 290a 2020 2020  rsion="v2").    
+0000a790: 2020 2020 7661 6c75 6573 203d 2041 7274      values = Art
+0000a7a0: 6966 6163 744c 6973 7428 7265 7370 2e6a  ifactList(resp.j
+0000a7b0: 736f 6e28 295b 2261 7274 6966 6163 7473  son()["artifacts
+0000a7c0: 225d 290a 2020 2020 2020 2020 7661 6c75  "]).        valu
+0000a7d0: 6573 2e74 6167 203d 2074 6167 0a20 2020  es.tag = tag.   
+0000a7e0: 2020 2020 2072 6574 7572 6e20 7661 6c75       return valu
+0000a7f0: 6573 0a0a 2020 2020 6465 6620 6465 6c5f  es..    def del_
+0000a800: 6172 7469 6661 6374 7328 0a20 2020 2020  artifacts(.     
+0000a810: 2020 2073 656c 662c 206e 616d 653d 4e6f     self, name=No
+0000a820: 6e65 2c20 7072 6f6a 6563 743d 4e6f 6e65  ne, project=None
+0000a830: 2c20 7461 673d 4e6f 6e65 2c20 6c61 6265  , tag=None, labe
+0000a840: 6c73 3d4e 6f6e 652c 2064 6179 735f 6167  ls=None, days_ag
+0000a850: 6f3d 302c 2074 7265 653d 4e6f 6e65 0a20  o=0, tree=None. 
+0000a860: 2020 2029 3a0a 2020 2020 2020 2020 2222     ):.        ""
+0000a870: 2244 656c 6574 6520 6172 7469 6661 6374  "Delete artifact
+0000a880: 7320 7265 6665 7265 6e63 6564 2062 7920  s referenced by 
+0000a890: 7468 6520 7061 7261 6d65 7465 7273 2e0a  the parameters..
+0000a8a0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0000a8b0: 6e61 6d65 3a20 4e61 6d65 206f 6620 6172  name: Name of ar
+0000a8c0: 7469 6661 6374 7320 746f 2064 656c 6574  tifacts to delet
+0000a8d0: 652e 204e 6f74 6520 7468 6174 2074 6869  e. Note that thi
+0000a8e0: 7320 6973 2061 206c 696b 6520 7175 6572  s is a like quer
+0000a8f0: 792c 2061 6e64 2069 7320 6361 7365 2d69  y, and is case-i
+0000a900: 6e73 656e 7369 7469 7665 2e20 5365 650a  nsensitive. See.
+0000a910: 2020 2020 2020 2020 2020 2020 3a70 793a              :py:
+0000a920: 6675 6e63 3a60 7e6c 6973 745f 6172 7469  func:`~list_arti
+0000a930: 6661 6374 7360 2066 6f72 206d 6f72 6520  facts` for more 
+0000a940: 6465 7461 696c 732e 0a20 2020 2020 2020  details..       
+0000a950: 203a 7061 7261 6d20 7072 6f6a 6563 743a   :param project:
+0000a960: 2050 726f 6a65 6374 2074 6861 7420 6172   Project that ar
+0000a970: 7469 6661 6374 7320 6265 6c6f 6e67 2074  tifacts belong t
+0000a980: 6f2e 0a20 2020 2020 2020 203a 7061 7261  o..        :para
+0000a990: 6d20 7461 673a 2043 686f 6f73 6520 6172  m tag: Choose ar
+0000a9a0: 7469 6661 6374 7320 7768 6f20 6172 6520  tifacts who are 
+0000a9b0: 6173 7369 676e 6564 2074 6869 7320 7461  assigned this ta
+0000a9c0: 672e 0a20 2020 2020 2020 203a 7061 7261  g..        :para
+0000a9d0: 6d20 6c61 6265 6c73 3a20 4368 6f6f 7365  m labels: Choose
+0000a9e0: 2061 7274 6966 6163 7473 2077 6869 6368   artifacts which
+0000a9f0: 2061 7265 206c 6162 656c 6564 2e0a 2020   are labeled..  
+0000aa00: 2020 2020 2020 3a70 6172 616d 2064 6179        :param day
+0000aa10: 735f 6167 6f3a 2054 6869 7320 7061 7261  s_ago: This para
+0000aa20: 6d65 7465 7220 6973 2064 6570 7265 6361  meter is depreca
+0000aa30: 7465 6420 616e 6420 6e6f 7420 7573 6564  ted and not used
+0000aa40: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+0000aa50: 2020 2020 2020 7072 6f6a 6563 7420 3d20        project = 
+0000aa60: 7072 6f6a 6563 7420 6f72 2063 6f6e 6669  project or confi
+0000aa70: 672e 6465 6661 756c 745f 7072 6f6a 6563  g.default_projec
+0000aa80: 740a 2020 2020 2020 2020 7061 7261 6d73  t.        params
+0000aa90: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
+0000aaa0: 2022 6e61 6d65 223a 206e 616d 652c 0a20   "name": name,. 
+0000aab0: 2020 2020 2020 2020 2020 2022 7461 6722             "tag"
+0000aac0: 3a20 7461 672c 0a20 2020 2020 2020 2020  : tag,.         
+0000aad0: 2020 2022 7472 6565 223a 2074 7265 652c     "tree": tree,
+0000aae0: 0a20 2020 2020 2020 2020 2020 2022 6c61  .            "la
+0000aaf0: 6265 6c22 3a20 6c61 6265 6c73 206f 7220  bel": labels or 
+0000ab00: 5b5d 2c0a 2020 2020 2020 2020 2020 2020  [],.            
+0000ab10: 2264 6179 735f 6167 6f22 3a20 7374 7228  "days_ago": str(
+0000ab20: 6461 7973 5f61 676f 292c 0a20 2020 2020  days_ago),.     
+0000ab30: 2020 207d 0a20 2020 2020 2020 2065 7272     }.        err
+0000ab40: 6f72 203d 2022 6465 6c20 6172 7469 6661  or = "del artifa
+0000ab50: 6374 7322 0a20 2020 2020 2020 2065 6e64  cts".        end
+0000ab60: 706f 696e 745f 7061 7468 203d 2066 2270  point_path = f"p
+0000ab70: 726f 6a65 6374 732f 7b70 726f 6a65 6374  rojects/{project
+0000ab80: 7d2f 6172 7469 6661 6374 7322 0a20 2020  }/artifacts".   
+0000ab90: 2020 2020 2073 656c 662e 6170 695f 6361       self.api_ca
+0000aba0: 6c6c 2822 4445 4c45 5445 222c 2065 6e64  ll("DELETE", end
+0000abb0: 706f 696e 745f 7061 7468 2c20 6572 726f  point_path, erro
+0000abc0: 722c 2070 6172 616d 733d 7061 7261 6d73  r, params=params
+0000abd0: 2c20 7665 7273 696f 6e3d 2276 3222 290a  , version="v2").
+0000abe0: 0a20 2020 2064 6566 206c 6973 745f 6172  .    def list_ar
+0000abf0: 7469 6661 6374 5f74 6167 7328 0a20 2020  tifact_tags(.   
+0000ac00: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+0000ac10: 2020 2070 726f 6a65 6374 3d4e 6f6e 652c     project=None,
+0000ac20: 0a20 2020 2020 2020 2063 6174 6567 6f72  .        categor
+0000ac30: 793a 2055 6e69 6f6e 5b73 7472 2c20 6d6c  y: Union[str, ml
+0000ac40: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
+0000ac50: 6173 2e41 7274 6966 6163 7443 6174 6567  as.ArtifactCateg
+0000ac60: 6f72 6965 735d 203d 204e 6f6e 652c 0a20  ories] = None,. 
+0000ac70: 2020 2029 202d 3e20 6c69 7374 5b73 7472     ) -> list[str
+0000ac80: 5d3a 0a20 2020 2020 2020 2022 2222 5265  ]:.        """Re
+0000ac90: 7475 726e 2061 206c 6973 7420 6f66 2061  turn a list of a
+0000aca0: 6c6c 2074 6865 2074 6167 7320 6173 7369  ll the tags assi
+0000acb0: 676e 6564 2074 6f20 6172 7469 6661 6374  gned to artifact
+0000acc0: 7320 696e 2074 6865 2073 636f 7065 206f  s in the scope o
+0000acd0: 6620 7468 6520 6769 7665 6e20 7072 6f6a  f the given proj
+0000ace0: 6563 742e 2222 220a 0a20 2020 2020 2020  ect."""..       
+0000acf0: 2070 726f 6a65 6374 203d 2070 726f 6a65   project = proje
+0000ad00: 6374 206f 7220 636f 6e66 6967 2e64 6566  ct or config.def
+0000ad10: 6175 6c74 5f70 726f 6a65 6374 0a20 2020  ault_project.   
+0000ad20: 2020 2020 2065 7272 6f72 5f6d 6573 7361       error_messa
+0000ad30: 6765 203d 2066 2246 6169 6c65 6420 6c69  ge = f"Failed li
+0000ad40: 7374 696e 6720 6172 7469 6661 6374 2074  sting artifact t
+0000ad50: 6167 732e 2070 726f 6a65 6374 3d7b 7072  ags. project={pr
+0000ad60: 6f6a 6563 747d 220a 2020 2020 2020 2020  oject}".        
+0000ad70: 7061 7261 6d73 203d 207b 2263 6174 6567  params = {"categ
+0000ad80: 6f72 7922 3a20 6361 7465 676f 7279 7d20  ory": category} 
+0000ad90: 6966 2063 6174 6567 6f72 7920 656c 7365  if category else
+0000ada0: 207b 7d0a 0a20 2020 2020 2020 2072 6573   {}..        res
+0000adb0: 706f 6e73 6520 3d20 7365 6c66 2e61 7069  ponse = self.api
+0000adc0: 5f63 616c 6c28 0a20 2020 2020 2020 2020  _call(.         
+0000add0: 2020 2022 4745 5422 2c20 6622 7072 6f6a     "GET", f"proj
+0000ade0: 6563 7473 2f7b 7072 6f6a 6563 747d 2f61  ects/{project}/a
+0000adf0: 7274 6966 6163 742d 7461 6773 222c 2065  rtifact-tags", e
+0000ae00: 7272 6f72 5f6d 6573 7361 6765 2c20 7061  rror_message, pa
+0000ae10: 7261 6d73 3d70 6172 616d 730a 2020 2020  rams=params.    
+0000ae20: 2020 2020 290a 2020 2020 2020 2020 7265      ).        re
+0000ae30: 7475 726e 2072 6573 706f 6e73 652e 6a73  turn response.js
+0000ae40: 6f6e 2829 5b22 7461 6773 225d 0a0a 2020  on()["tags"]..  
+0000ae50: 2020 6465 6620 7374 6f72 655f 6675 6e63    def store_func
+0000ae60: 7469 6f6e 280a 2020 2020 2020 2020 7365  tion(.        se
+0000ae70: 6c66 2c0a 2020 2020 2020 2020 6675 6e63  lf,.        func
+0000ae80: 7469 6f6e 3a20 7479 7069 6e67 2e55 6e69  tion: typing.Uni
+0000ae90: 6f6e 5b6d 6c72 756e 2e72 756e 7469 6d65  on[mlrun.runtime
+0000aea0: 732e 4261 7365 5275 6e74 696d 652c 2064  s.BaseRuntime, d
+0000aeb0: 6963 745d 2c0a 2020 2020 2020 2020 6e61  ict],.        na
+0000aec0: 6d65 2c0a 2020 2020 2020 2020 7072 6f6a  me,.        proj
+0000aed0: 6563 743d 2222 2c0a 2020 2020 2020 2020  ect="",.        
+0000aee0: 7461 673d 4e6f 6e65 2c0a 2020 2020 2020  tag=None,.      
+0000aef0: 2020 7665 7273 696f 6e65 643d 4661 6c73    versioned=Fals
+0000af00: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
+0000af10: 2020 2222 2253 746f 7265 2061 2066 756e    """Store a fun
+0000af20: 6374 696f 6e20 6f62 6a65 6374 2e20 4675  ction object. Fu
+0000af30: 6e63 7469 6f6e 2069 7320 6964 656e 7469  nction is identi
+0000af40: 6669 6564 2062 7920 6974 7320 6e61 6d65  fied by its name
+0000af50: 2061 6e64 2074 6167 2c20 616e 6420 6361   and tag, and ca
+0000af60: 6e20 6265 2076 6572 7369 6f6e 6564 2e22  n be versioned."
+0000af70: 2222 0a20 2020 2020 2020 206e 616d 6520  "".        name 
+0000af80: 3d20 6d6c 7275 6e2e 7574 696c 732e 6e6f  = mlrun.utils.no
+0000af90: 726d 616c 697a 655f 6e61 6d65 286e 616d  rmalize_name(nam
+0000afa0: 6529 0a20 2020 2020 2020 2069 6620 6861  e).        if ha
+0000afb0: 7361 7474 7228 6675 6e63 7469 6f6e 2c20  sattr(function, 
+0000afc0: 2274 6f5f 6469 6374 2229 3a0a 2020 2020  "to_dict"):.    
+0000afd0: 2020 2020 2020 2020 6675 6e63 7469 6f6e          function
+0000afe0: 203d 2066 756e 6374 696f 6e2e 746f 5f64   = function.to_d
+0000aff0: 6963 7428 290a 0a20 2020 2020 2020 2070  ict()..        p
+0000b000: 6172 616d 7320 3d20 7b22 7461 6722 3a20  arams = {"tag": 
+0000b010: 7461 672c 2022 7665 7273 696f 6e65 6422  tag, "versioned"
+0000b020: 3a20 7665 7273 696f 6e65 647d 0a20 2020  : versioned}.   
+0000b030: 2020 2020 2070 726f 6a65 6374 203d 2070       project = p
+0000b040: 726f 6a65 6374 206f 7220 636f 6e66 6967  roject or config
+0000b050: 2e64 6566 6175 6c74 5f70 726f 6a65 6374  .default_project
+0000b060: 0a20 2020 2020 2020 2070 6174 6820 3d20  .        path = 
+0000b070: 6622 7072 6f6a 6563 7473 2f7b 7072 6f6a  f"projects/{proj
+0000b080: 6563 747d 2f66 756e 6374 696f 6e73 2f7b  ect}/functions/{
+0000b090: 6e61 6d65 7d22 0a0a 2020 2020 2020 2020  name}"..        
+0000b0a0: 6572 726f 7220 3d20 6622 7374 6f72 6520  error = f"store 
+0000b0b0: 6675 6e63 7469 6f6e 207b 7072 6f6a 6563  function {projec
+0000b0c0: 747d 2f7b 6e61 6d65 7d22 0a20 2020 2020  t}/{name}".     
+0000b0d0: 2020 2072 6573 7020 3d20 7365 6c66 2e61     resp = self.a
+0000b0e0: 7069 5f63 616c 6c28 0a20 2020 2020 2020  pi_call(.       
+0000b0f0: 2020 2020 2022 504f 5354 222c 2070 6174       "POST", pat
+0000b100: 682c 2065 7272 6f72 2c20 7061 7261 6d73  h, error, params
+0000b110: 3d70 6172 616d 732c 2062 6f64 793d 6469  =params, body=di
+0000b120: 6374 5f74 6f5f 6a73 6f6e 2866 756e 6374  ct_to_json(funct
+0000b130: 696f 6e29 0a20 2020 2020 2020 2029 0a0a  ion).        )..
+0000b140: 2020 2020 2020 2020 2320 6861 7368 206b          # hash k
+0000b150: 6579 206f 7074 696f 6e61 6c20 746f 2062  ey optional to b
+0000b160: 6520 6261 636b 7761 7264 7320 636f 6d70  e backwards comp
+0000b170: 6174 6962 6c65 2074 6f20 4150 4920 763c  atible to API v<
+0000b180: 302e 342e 3130 2069 6e20 7768 6963 6820  0.4.10 in which 
+0000b190: 6974 2077 6173 6e27 7420 696e 2074 6865  it wasn't in the
+0000b1a0: 2072 6573 706f 6e73 650a 2020 2020 2020   response.      
+0000b1b0: 2020 7265 7475 726e 2072 6573 702e 6a73    return resp.js
+0000b1c0: 6f6e 2829 2e67 6574 2822 6861 7368 5f6b  on().get("hash_k
+0000b1d0: 6579 2229 0a0a 2020 2020 6465 6620 6765  ey")..    def ge
+0000b1e0: 745f 6675 6e63 7469 6f6e 2873 656c 662c  t_function(self,
+0000b1f0: 206e 616d 652c 2070 726f 6a65 6374 3d22   name, project="
+0000b200: 222c 2074 6167 3d4e 6f6e 652c 2068 6173  ", tag=None, has
+0000b210: 685f 6b65 793d 2222 293a 0a20 2020 2020  h_key=""):.     
+0000b220: 2020 2022 2222 5265 7472 6965 7665 2064     """Retrieve d
+0000b230: 6574 6169 6c73 206f 6620 6120 7370 6563  etails of a spec
+0000b240: 6966 6963 2066 756e 6374 696f 6e2c 2069  ific function, i
+0000b250: 6465 6e74 6966 6965 6420 6279 2069 7473  dentified by its
+0000b260: 206e 616d 6520 616e 6420 706f 7465 6e74   name and potent
+0000b270: 6961 6c6c 7920 6120 7461 6720 6f72 2066  ially a tag or f
+0000b280: 756e 6374 696f 6e20 6861 7368 2e22 2222  unction hash."""
+0000b290: 0a0a 2020 2020 2020 2020 7061 7261 6d73  ..        params
+0000b2a0: 203d 207b 2274 6167 223a 2074 6167 2c20   = {"tag": tag, 
+0000b2b0: 2268 6173 685f 6b65 7922 3a20 6861 7368  "hash_key": hash
+0000b2c0: 5f6b 6579 7d0a 2020 2020 2020 2020 7072  _key}.        pr
+0000b2d0: 6f6a 6563 7420 3d20 7072 6f6a 6563 7420  oject = project 
+0000b2e0: 6f72 2063 6f6e 6669 672e 6465 6661 756c  or config.defaul
+0000b2f0: 745f 7072 6f6a 6563 740a 2020 2020 2020  t_project.      
+0000b300: 2020 7061 7468 203d 2066 2270 726f 6a65    path = f"proje
+0000b310: 6374 732f 7b70 726f 6a65 6374 7d2f 6675  cts/{project}/fu
+0000b320: 6e63 7469 6f6e 732f 7b6e 616d 657d 220a  nctions/{name}".
+0000b330: 2020 2020 2020 2020 6572 726f 7220 3d20          error = 
+0000b340: 6622 6765 7420 6675 6e63 7469 6f6e 207b  f"get function {
+0000b350: 7072 6f6a 6563 747d 2f7b 6e61 6d65 7d22  project}/{name}"
+0000b360: 0a20 2020 2020 2020 2072 6573 7020 3d20  .        resp = 
+0000b370: 7365 6c66 2e61 7069 5f63 616c 6c28 2247  self.api_call("G
+0000b380: 4554 222c 2070 6174 682c 2065 7272 6f72  ET", path, error
+0000b390: 2c20 7061 7261 6d73 3d70 6172 616d 7329  , params=params)
+0000b3a0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0000b3b0: 7265 7370 2e6a 736f 6e28 295b 2266 756e  resp.json()["fun
+0000b3c0: 6322 5d0a 0a20 2020 2064 6566 2064 656c  c"]..    def del
+0000b3d0: 6574 655f 6675 6e63 7469 6f6e 2873 656c  ete_function(sel
+0000b3e0: 662c 206e 616d 653a 2073 7472 2c20 7072  f, name: str, pr
+0000b3f0: 6f6a 6563 743a 2073 7472 203d 2022 2229  oject: str = "")
+0000b400: 3a0a 2020 2020 2020 2020 2222 2244 656c  :.        """Del
+0000b410: 6574 6520 6120 6675 6e63 7469 6f6e 2062  ete a function b
+0000b420: 656c 6f6e 6769 6e67 2074 6f20 6120 7370  elonging to a sp
+0000b430: 6563 6966 6963 2070 726f 6a65 6374 2e22  ecific project."
+0000b440: 2222 0a0a 2020 2020 2020 2020 7072 6f6a  ""..        proj
+0000b450: 6563 7420 3d20 7072 6f6a 6563 7420 6f72  ect = project or
+0000b460: 2063 6f6e 6669 672e 6465 6661 756c 745f   config.default_
+0000b470: 7072 6f6a 6563 740a 2020 2020 2020 2020  project.        
+0000b480: 7061 7468 203d 2066 2270 726f 6a65 6374  path = f"project
+0000b490: 732f 7b70 726f 6a65 6374 7d2f 6675 6e63  s/{project}/func
+0000b4a0: 7469 6f6e 732f 7b6e 616d 657d 220a 2020  tions/{name}".  
+0000b4b0: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
+0000b4c0: 6167 6520 3d20 6622 4661 696c 6564 2064  age = f"Failed d
+0000b4d0: 656c 6574 696e 6720 6675 6e63 7469 6f6e  eleting function
+0000b4e0: 207b 7072 6f6a 6563 747d 2f7b 6e61 6d65   {project}/{name
+0000b4f0: 7d22 0a20 2020 2020 2020 2073 656c 662e  }".        self.
+0000b500: 6170 695f 6361 6c6c 2822 4445 4c45 5445  api_call("DELETE
+0000b510: 222c 2070 6174 682c 2065 7272 6f72 5f6d  ", path, error_m
+0000b520: 6573 7361 6765 290a 0a20 2020 2064 6566  essage)..    def
+0000b530: 206c 6973 745f 6675 6e63 7469 6f6e 7328   list_functions(
+0000b540: 7365 6c66 2c20 6e61 6d65 3d4e 6f6e 652c  self, name=None,
+0000b550: 2070 726f 6a65 6374 3d4e 6f6e 652c 2074   project=None, t
+0000b560: 6167 3d4e 6f6e 652c 206c 6162 656c 733d  ag=None, labels=
+0000b570: 4e6f 6e65 293a 0a20 2020 2020 2020 2022  None):.        "
+0000b580: 2222 5265 7472 6965 7665 2061 206c 6973  ""Retrieve a lis
+0000b590: 7420 6f66 2066 756e 6374 696f 6e73 2c20  t of functions, 
+0000b5a0: 6669 6c74 6572 6564 2062 7920 7370 6563  filtered by spec
+0000b5b0: 6966 6963 2063 7269 7465 7269 612e 0a0a  ific criteria...
+0000b5c0: 2020 2020 2020 2020 3a70 6172 616d 206e          :param n
+0000b5d0: 616d 653a 2052 6574 7572 6e20 6f6e 6c79  ame: Return only
+0000b5e0: 2066 756e 6374 696f 6e73 2077 6974 6820   functions with 
+0000b5f0: 6120 7370 6563 6966 6963 206e 616d 652e  a specific name.
+0000b600: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0000b610: 7072 6f6a 6563 743a 2052 6574 7572 6e20  project: Return 
+0000b620: 6675 6e63 7469 6f6e 7320 6265 6c6f 6e67  functions belong
+0000b630: 696e 6720 746f 2074 6869 7320 7072 6f6a  ing to this proj
+0000b640: 6563 742e 2049 6620 6e6f 7420 7370 6563  ect. If not spec
+0000b650: 6966 6965 642c 2074 6865 2064 6566 6175  ified, the defau
+0000b660: 6c74 2070 726f 6a65 6374 2069 7320 7573  lt project is us
+0000b670: 6564 2e0a 2020 2020 2020 2020 3a70 6172  ed..        :par
+0000b680: 616d 2074 6167 3a20 5265 7475 726e 2066  am tag: Return f
+0000b690: 756e 6374 696f 6e20 7665 7273 696f 6e73  unction versions
+0000b6a0: 2077 6974 6820 7370 6563 6966 6963 2074   with specific t
+0000b6b0: 6167 732e 0a20 2020 2020 2020 203a 7061  ags..        :pa
+0000b6c0: 7261 6d20 6c61 6265 6c73 3a20 5265 7475  ram labels: Retu
+0000b6d0: 726e 2066 756e 6374 696f 6e73 2074 6861  rn functions tha
+0000b6e0: 7420 6861 7665 2073 7065 6369 6669 6320  t have specific 
+0000b6f0: 6c61 6265 6c73 2061 7373 6967 6e65 6420  labels assigned 
+0000b700: 746f 2074 6865 6d2e 0a20 2020 2020 2020  to them..       
+0000b710: 203a 7265 7475 726e 733a 204c 6973 7420   :returns: List 
+0000b720: 6f66 2066 756e 6374 696f 6e20 6f62 6a65  of function obje
+0000b730: 6374 7320 2861 7320 6469 6374 696f 6e61  cts (as dictiona
+0000b740: 7279 292e 0a20 2020 2020 2020 2022 2222  ry)..        """
+0000b750: 0a20 2020 2020 2020 2070 726f 6a65 6374  .        project
+0000b760: 203d 2070 726f 6a65 6374 206f 7220 636f   = project or co
+0000b770: 6e66 6967 2e64 6566 6175 6c74 5f70 726f  nfig.default_pro
+0000b780: 6a65 6374 0a20 2020 2020 2020 2070 6172  ject.        par
+0000b790: 616d 7320 3d20 7b0a 2020 2020 2020 2020  ams = {.        
+0000b7a0: 2020 2020 226e 616d 6522 3a20 6e61 6d65      "name": name
+0000b7b0: 2c0a 2020 2020 2020 2020 2020 2020 2274  ,.            "t
+0000b7c0: 6167 223a 2074 6167 2c0a 2020 2020 2020  ag": tag,.      
+0000b7d0: 2020 2020 2020 226c 6162 656c 223a 206c        "label": l
+0000b7e0: 6162 656c 7320 6f72 205b 5d2c 0a20 2020  abels or [],.   
+0000b7f0: 2020 2020 207d 0a20 2020 2020 2020 2065       }.        e
+0000b800: 7272 6f72 203d 2022 6c69 7374 2066 756e  rror = "list fun
+0000b810: 6374 696f 6e73 220a 2020 2020 2020 2020  ctions".        
+0000b820: 7061 7468 203d 2066 2270 726f 6a65 6374  path = f"project
+0000b830: 732f 7b70 726f 6a65 6374 7d2f 6675 6e63  s/{project}/func
+0000b840: 7469 6f6e 7322 0a20 2020 2020 2020 2072  tions".        r
+0000b850: 6573 7020 3d20 7365 6c66 2e61 7069 5f63  esp = self.api_c
+0000b860: 616c 6c28 2247 4554 222c 2070 6174 682c  all("GET", path,
+0000b870: 2065 7272 6f72 2c20 7061 7261 6d73 3d70   error, params=p
+0000b880: 6172 616d 7329 0a20 2020 2020 2020 2072  arams).        r
+0000b890: 6574 7572 6e20 7265 7370 2e6a 736f 6e28  eturn resp.json(
+0000b8a0: 295b 2266 756e 6373 225d 0a0a 2020 2020  )["funcs"]..    
+0000b8b0: 6465 6620 6c69 7374 5f72 756e 7469 6d65  def list_runtime
+0000b8c0: 5f72 6573 6f75 7263 6573 280a 2020 2020  _resources(.    
+0000b8d0: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+0000b8e0: 2020 7072 6f6a 6563 743a 204f 7074 696f    project: Optio
+0000b8f0: 6e61 6c5b 7374 725d 203d 204e 6f6e 652c  nal[str] = None,
+0000b900: 0a20 2020 2020 2020 206c 6162 656c 5f73  .        label_s
+0000b910: 656c 6563 746f 723a 204f 7074 696f 6e61  elector: Optiona
+0000b920: 6c5b 7374 725d 203d 204e 6f6e 652c 0a20  l[str] = None,. 
+0000b930: 2020 2020 2020 206b 696e 643a 204f 7074         kind: Opt
+0000b940: 696f 6e61 6c5b 7374 725d 203d 204e 6f6e  ional[str] = Non
+0000b950: 652c 0a20 2020 2020 2020 206f 626a 6563  e,.        objec
+0000b960: 745f 6964 3a20 4f70 7469 6f6e 616c 5b73  t_id: Optional[s
+0000b970: 7472 5d20 3d20 4e6f 6e65 2c0a 2020 2020  tr] = None,.    
+0000b980: 2020 2020 6772 6f75 705f 6279 3a20 4f70      group_by: Op
+0000b990: 7469 6f6e 616c 5b0a 2020 2020 2020 2020  tional[.        
+0000b9a0: 2020 2020 6d6c 7275 6e2e 636f 6d6d 6f6e      mlrun.common
+0000b9b0: 2e73 6368 656d 6173 2e4c 6973 7452 756e  .schemas.ListRun
+0000b9c0: 7469 6d65 5265 736f 7572 6365 7347 726f  timeResourcesGro
+0000b9d0: 7570 4279 4669 656c 640a 2020 2020 2020  upByField.      
+0000b9e0: 2020 5d20 3d20 4e6f 6e65 2c0a 2020 2020    ] = None,.    
+0000b9f0: 2920 2d3e 2055 6e69 6f6e 5b0a 2020 2020  ) -> Union[.    
+0000ba00: 2020 2020 6d6c 7275 6e2e 636f 6d6d 6f6e      mlrun.common
+0000ba10: 2e73 6368 656d 6173 2e52 756e 7469 6d65  .schemas.Runtime
+0000ba20: 5265 736f 7572 6365 734f 7574 7075 742c  ResourcesOutput,
+0000ba30: 0a20 2020 2020 2020 206d 6c72 756e 2e63  .        mlrun.c
+0000ba40: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 4772  ommon.schemas.Gr
+0000ba50: 6f75 7065 6442 794a 6f62 5275 6e74 696d  oupedByJobRuntim
+0000ba60: 6552 6573 6f75 7263 6573 4f75 7470 7574  eResourcesOutput
+0000ba70: 2c0a 2020 2020 2020 2020 6d6c 7275 6e2e  ,.        mlrun.
+0000ba80: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e47  common.schemas.G
+0000ba90: 726f 7570 6564 4279 5072 6f6a 6563 7452  roupedByProjectR
+0000baa0: 756e 7469 6d65 5265 736f 7572 6365 734f  untimeResourcesO
+0000bab0: 7574 7075 742c 0a20 2020 205d 3a0a 2020  utput,.    ]:.  
+0000bac0: 2020 2020 2020 2222 224c 6973 7420 6375        """List cu
+0000bad0: 7272 656e 7420 7275 6e74 696d 6520 7265  rrent runtime re
+0000bae0: 736f 7572 6365 732c 2077 6869 6368 2061  sources, which a
+0000baf0: 7265 2075 7375 616c 6c79 2028 6275 7420  re usually (but 
+0000bb00: 6e6f 7420 6c69 6d69 7465 6420 746f 2920  not limited to) 
+0000bb10: 4b75 6265 726e 6574 6573 2070 6f64 7320  Kubernetes pods 
+0000bb20: 6f72 2043 5244 732e 0a20 2020 2020 2020  or CRDs..       
+0000bb30: 2046 756e 6374 696f 6e20 6170 706c 6965   Function applie
+0000bb40: 7320 666f 7220 7275 6e73 206f 6620 7479  s for runs of ty
+0000bb50: 7065 2060 5b27 6461 736b 272c 2027 6a6f  pe `['dask', 'jo
+0000bb60: 6227 2c20 2773 7061 726b 272c 2027 7265  b', 'spark', 're
+0000bb70: 6d6f 7465 2d73 7061 726b 272c 2027 6d70  mote-spark', 'mp
+0000bb80: 696a 6f62 275d 602c 2061 6e64 2077 696c  ijob']`, and wil
+0000bb90: 6c20 7265 7475 726e 2070 6572 0a20 2020  l return per.   
+0000bba0: 2020 2020 2072 756e 7469 6d65 206b 696e       runtime kin
+0000bbb0: 6420 6120 6c69 7374 206f 6620 7468 6520  d a list of the 
+0000bbc0: 7275 6e74 696d 6520 7265 736f 7572 6365  runtime resource
+0000bbd0: 7320 2877 6869 6368 206d 6179 2068 6176  s (which may hav
+0000bbe0: 6520 616c 7265 6164 7920 636f 6d70 6c65  e already comple
+0000bbf0: 7465 6420 7468 6569 7220 6578 6563 7574  ted their execut
+0000bc00: 696f 6e29 2e0a 0a20 2020 2020 2020 203a  ion)...        :
+0000bc10: 7061 7261 6d20 7072 6f6a 6563 743a 2047  param project: G
+0000bc20: 6574 206f 6e6c 7920 7275 6e74 696d 6520  et only runtime 
+0000bc30: 7265 736f 7572 6365 7320 6f66 2061 2073  resources of a s
+0000bc40: 7065 6369 6669 6320 7072 6f6a 6563 742c  pecific project,
+0000bc50: 2062 7920 6465 6661 756c 7420 4e6f 6e65   by default None
+0000bc60: 2c20 7768 6963 6820 7769 6c6c 2072 6574  , which will ret
+0000bc70: 7572 6e20 6f6e 6c79 2074 6865 0a20 2020  urn only the.   
+0000bc80: 2020 2020 2020 2020 2070 726f 6a65 6374           project
+0000bc90: 7320 796f 7527 7265 2061 7574 686f 7269  s you're authori
+0000bca0: 7a65 6420 746f 2073 6565 2e0a 2020 2020  zed to see..    
+0000bcb0: 2020 2020 3a70 6172 616d 206c 6162 656c      :param label
+0000bcc0: 5f73 656c 6563 746f 723a 2041 206c 6162  _selector: A lab
+0000bcd0: 656c 2066 696c 7465 7220 7468 6174 2077  el filter that w
+0000bce0: 696c 6c20 6265 2070 6173 7365 6420 746f  ill be passed to
+0000bcf0: 204b 7562 6572 6e65 7465 7320 666f 7220   Kubernetes for 
+0000bd00: 6669 6c74 6572 696e 6720 7468 6520 7265  filtering the re
+0000bd10: 7375 6c74 7320 6163 636f 7264 696e 670a  sults according.
+0000bd20: 2020 2020 2020 2020 2020 2020 746f 2074              to t
+0000bd30: 6865 6972 206c 6162 656c 732e 0a20 2020  heir labels..   
+0000bd40: 2020 2020 203a 7061 7261 6d20 6b69 6e64       :param kind
+0000bd50: 3a20 5468 6520 6b69 6e64 206f 6620 7275  : The kind of ru
+0000bd60: 6e74 696d 6520 746f 2071 7565 7279 2e20  ntime to query. 
+0000bd70: 4d61 7920 6265 206f 6e65 206f 6620 605b  May be one of `[
+0000bd80: 2764 6173 6b27 2c20 276a 6f62 272c 2027  'dask', 'job', '
+0000bd90: 7370 6172 6b27 2c20 2772 656d 6f74 652d  spark', 'remote-
+0000bda0: 7370 6172 6b27 2c20 276d 7069 6a6f 6227  spark', 'mpijob'
+0000bdb0: 5d60 0a20 2020 2020 2020 203a 7061 7261  ]`.        :para
+0000bdc0: 6d20 6f62 6a65 6374 5f69 643a 2054 6865  m object_id: The
+0000bdd0: 2069 6465 6e74 6966 6965 7220 6f66 2074   identifier of t
+0000bde0: 6865 206d 6c72 756e 206f 626a 6563 7420  he mlrun object 
+0000bdf0: 746f 2071 7565 7279 2069 7473 2072 756e  to query its run
+0000be00: 7469 6d65 2072 6573 6f75 7263 6573 2e20  time resources. 
+0000be10: 666f 7220 6d6f 7374 2066 756e 6374 696f  for most functio
+0000be20: 6e20 7275 6e74 696d 6573 2c0a 2020 2020  n runtimes,.    
+0000be30: 2020 2020 2020 2020 7275 6e74 696d 6520          runtime 
+0000be40: 7265 736f 7572 6365 7320 6172 6520 7065  resources are pe
+0000be50: 7220 5275 6e2c 2066 6f72 2077 6869 6368  r Run, for which
+0000be60: 2074 6865 2069 6465 6e74 6966 6965 7220   the identifier 
+0000be70: 6973 2074 6865 2052 756e 2773 2055 4944  is the Run's UID
+0000be80: 2e20 466f 7220 6461 736b 2072 756e 7469  . For dask runti
+0000be90: 6d65 2c20 7468 6520 7275 6e74 696d 650a  me, the runtime.
+0000bea0: 2020 2020 2020 2020 2020 2020 7265 736f              reso
+0000beb0: 7572 6365 7320 6172 6520 7065 7220 4675  urces are per Fu
+0000bec0: 6e63 7469 6f6e 2c20 666f 7220 7768 6963  nction, for whic
+0000bed0: 6820 7468 6520 6964 656e 7469 6669 6572  h the identifier
+0000bee0: 2069 7320 7468 6520 4675 6e63 7469 6f6e   is the Function
+0000bef0: 2773 206e 616d 652e 0a20 2020 2020 2020  's name..       
+0000bf00: 203a 7061 7261 6d20 6772 6f75 705f 6279   :param group_by
+0000bf10: 3a20 4f62 6a65 6374 2074 6f20 6772 6f75  : Object to grou
+0000bf20: 7020 7265 7375 6c74 7320 6279 2e20 416c  p results by. Al
+0000bf30: 6c6f 7765 6420 7661 6c75 6573 2061 7265  lowed values are
+0000bf40: 2060 6a6f 6260 2061 6e64 2060 7072 6f6a   `job` and `proj
+0000bf50: 6563 7460 2e0a 2020 2020 2020 2020 2222  ect`..        ""
+0000bf60: 220a 2020 2020 2020 2020 7061 7261 6d73  ".        params
+0000bf70: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
+0000bf80: 2022 6c61 6265 6c2d 7365 6c65 6374 6f72   "label-selector
+0000bf90: 223a 206c 6162 656c 5f73 656c 6563 746f  ": label_selecto
+0000bfa0: 722c 0a20 2020 2020 2020 2020 2020 2022  r,.            "
+0000bfb0: 6772 6f75 702d 6279 223a 2067 726f 7570  group-by": group
+0000bfc0: 5f62 792c 0a20 2020 2020 2020 2020 2020  _by,.           
+0000bfd0: 2022 6b69 6e64 223a 206b 696e 642c 0a20   "kind": kind,. 
+0000bfe0: 2020 2020 2020 2020 2020 2022 6f62 6a65             "obje
+0000bff0: 6374 2d69 6422 3a20 6f62 6a65 6374 5f69  ct-id": object_i
+0000c000: 642c 0a20 2020 2020 2020 207d 0a20 2020  d,.        }.   
+0000c010: 2020 2020 2070 726f 6a65 6374 5f70 6174       project_pat
+0000c020: 6820 3d20 7072 6f6a 6563 7420 6966 2070  h = project if p
+0000c030: 726f 6a65 6374 2065 6c73 6520 222a 220a  roject else "*".
+0000c040: 2020 2020 2020 2020 6572 726f 7220 3d20          error = 
+0000c050: 2246 6169 6c65 6420 6c69 7374 696e 6720  "Failed listing 
+0000c060: 7275 6e74 696d 6520 7265 736f 7572 6365  runtime resource
+0000c070: 7322 0a20 2020 2020 2020 2072 6573 706f  s".        respo
+0000c080: 6e73 6520 3d20 7365 6c66 2e61 7069 5f63  nse = self.api_c
+0000c090: 616c 6c28 0a20 2020 2020 2020 2020 2020  all(.           
+0000c0a0: 2022 4745 5422 2c20 6622 7072 6f6a 6563   "GET", f"projec
+0000c0b0: 7473 2f7b 7072 6f6a 6563 745f 7061 7468  ts/{project_path
+0000c0c0: 7d2f 7275 6e74 696d 652d 7265 736f 7572  }/runtime-resour
+0000c0d0: 6365 7322 2c20 6572 726f 722c 2070 6172  ces", error, par
+0000c0e0: 616d 733d 7061 7261 6d73 0a20 2020 2020  ams=params.     
+0000c0f0: 2020 2029 0a20 2020 2020 2020 2069 6620     ).        if 
+0000c100: 6772 6f75 705f 6279 2069 7320 4e6f 6e65  group_by is None
+0000c110: 3a0a 2020 2020 2020 2020 2020 2020 7374  :.            st
+0000c120: 7275 6374 7572 6564 5f6c 6973 7420 3d20  ructured_list = 
+0000c130: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+0000c140: 2020 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73    mlrun.common.s
+0000c150: 6368 656d 6173 2e4b 696e 6452 756e 7469  chemas.KindRunti
+0000c160: 6d65 5265 736f 7572 6365 7328 2a2a 6b69  meResources(**ki
+0000c170: 6e64 5f72 756e 7469 6d65 5f72 6573 6f75  nd_runtime_resou
+0000c180: 7263 6573 290a 2020 2020 2020 2020 2020  rces).          
+0000c190: 2020 2020 2020 666f 7220 6b69 6e64 5f72        for kind_r
+0000c1a0: 756e 7469 6d65 5f72 6573 6f75 7263 6573  untime_resources
+0000c1b0: 2069 6e20 7265 7370 6f6e 7365 2e6a 736f   in response.jso
+0000c1c0: 6e28 290a 2020 2020 2020 2020 2020 2020  n().            
+0000c1d0: 5d0a 2020 2020 2020 2020 2020 2020 7265  ].            re
+0000c1e0: 7475 726e 2073 7472 7563 7475 7265 645f  turn structured_
+0000c1f0: 6c69 7374 0a20 2020 2020 2020 2065 6c69  list.        eli
+0000c200: 6620 6772 6f75 705f 6279 203d 3d20 6d6c  f group_by == ml
+0000c210: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
+0000c220: 6173 2e4c 6973 7452 756e 7469 6d65 5265  as.ListRuntimeRe
+0000c230: 736f 7572 6365 7347 726f 7570 4279 4669  sourcesGroupByFi
+0000c240: 656c 642e 6a6f 623a 0a20 2020 2020 2020  eld.job:.       
+0000c250: 2020 2020 2073 7472 7563 7475 7265 645f       structured_
+0000c260: 6469 6374 203d 207b 7d0a 2020 2020 2020  dict = {}.      
+0000c270: 2020 2020 2020 666f 7220 7072 6f6a 6563        for projec
+0000c280: 742c 206a 6f62 5f72 756e 7469 6d65 5f72  t, job_runtime_r
+0000c290: 6573 6f75 7263 6573 5f6d 6170 2069 6e20  esources_map in 
+0000c2a0: 7265 7370 6f6e 7365 2e6a 736f 6e28 292e  response.json().
+0000c2b0: 6974 656d 7328 293a 0a20 2020 2020 2020  items():.       
+0000c2c0: 2020 2020 2020 2020 2066 6f72 206a 6f62           for job
+0000c2d0: 5f69 642c 2072 756e 7469 6d65 5f72 6573  _id, runtime_res
+0000c2e0: 6f75 7263 6573 2069 6e20 6a6f 625f 7275  ources in job_ru
+0000c2f0: 6e74 696d 655f 7265 736f 7572 6365 735f  ntime_resources_
+0000c300: 6d61 702e 6974 656d 7328 293a 0a20 2020  map.items():.   
+0000c310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c320: 2073 7472 7563 7475 7265 645f 6469 6374   structured_dict
+0000c330: 2e73 6574 6465 6661 756c 7428 7072 6f6a  .setdefault(proj
+0000c340: 6563 742c 207b 7d29 5b6a 6f62 5f69 645d  ect, {})[job_id]
+0000c350: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
+0000c360: 2020 2020 2020 2020 2020 2020 206d 6c72               mlr
+0000c370: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+0000c380: 732e 5275 6e74 696d 6552 6573 6f75 7263  s.RuntimeResourc
+0000c390: 6573 282a 2a72 756e 7469 6d65 5f72 6573  es(**runtime_res
+0000c3a0: 6f75 7263 6573 290a 2020 2020 2020 2020  ources).        
+0000c3b0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0000c3c0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0000c3d0: 2073 7472 7563 7475 7265 645f 6469 6374   structured_dict
+0000c3e0: 0a20 2020 2020 2020 2065 6c69 6620 6772  .        elif gr
+0000c3f0: 6f75 705f 6279 203d 3d20 6d6c 7275 6e2e  oup_by == mlrun.
+0000c400: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e4c  common.schemas.L
+0000c410: 6973 7452 756e 7469 6d65 5265 736f 7572  istRuntimeResour
+0000c420: 6365 7347 726f 7570 4279 4669 656c 642e  cesGroupByField.
+0000c430: 7072 6f6a 6563 743a 0a20 2020 2020 2020  project:.       
+0000c440: 2020 2020 2073 7472 7563 7475 7265 645f       structured_
+0000c450: 6469 6374 203d 207b 7d0a 2020 2020 2020  dict = {}.      
+0000c460: 2020 2020 2020 666f 7220 7072 6f6a 6563        for projec
+0000c470: 742c 206b 696e 645f 7275 6e74 696d 655f  t, kind_runtime_
+0000c480: 7265 736f 7572 6365 735f 6d61 7020 696e  resources_map in
+0000c490: 2072 6573 706f 6e73 652e 6a73 6f6e 2829   response.json()
+0000c4a0: 2e69 7465 6d73 2829 3a0a 2020 2020 2020  .items():.      
+0000c4b0: 2020 2020 2020 2020 2020 666f 7220 6b69            for ki
+0000c4c0: 6e64 2c20 7275 6e74 696d 655f 7265 736f  nd, runtime_reso
+0000c4d0: 7572 6365 7320 696e 206b 696e 645f 7275  urces in kind_ru
+0000c4e0: 6e74 696d 655f 7265 736f 7572 6365 735f  ntime_resources_
+0000c4f0: 6d61 702e 6974 656d 7328 293a 0a20 2020  map.items():.   
+0000c500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c510: 2073 7472 7563 7475 7265 645f 6469 6374   structured_dict
+0000c520: 2e73 6574 6465 6661 756c 7428 7072 6f6a  .setdefault(proj
+0000c530: 6563 742c 207b 7d29 5b6b 696e 645d 203d  ect, {})[kind] =
+0000c540: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
+0000c550: 2020 2020 2020 2020 2020 206d 6c72 756e             mlrun
+0000c560: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
+0000c570: 5275 6e74 696d 6552 6573 6f75 7263 6573  RuntimeResources
+0000c580: 282a 2a72 756e 7469 6d65 5f72 6573 6f75  (**runtime_resou
+0000c590: 7263 6573 290a 2020 2020 2020 2020 2020  rces).          
+0000c5a0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+0000c5b0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0000c5c0: 7472 7563 7475 7265 645f 6469 6374 0a20  tructured_dict. 
+0000c5d0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0000c5e0: 2020 2020 2020 2020 2072 6169 7365 204e           raise N
+0000c5f0: 6f74 496d 706c 656d 656e 7465 6445 7272  otImplementedErr
+0000c600: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+0000c610: 2020 2020 6622 5072 6f76 6964 6564 2067      f"Provided g
+0000c620: 726f 7570 2062 7920 6669 656c 6420 6973  roup by field is
+0000c630: 206e 6f74 2073 7570 706f 7274 6564 2e20   not supported. 
+0000c640: 6772 6f75 705f 6279 3d7b 6772 6f75 705f  group_by={group_
+0000c650: 6279 7d22 0a20 2020 2020 2020 2020 2020  by}".           
+0000c660: 2029 0a0a 2020 2020 6465 6620 6465 6c65   )..    def dele
+0000c670: 7465 5f72 756e 7469 6d65 5f72 6573 6f75  te_runtime_resou
+0000c680: 7263 6573 280a 2020 2020 2020 2020 7365  rces(.        se
+0000c690: 6c66 2c0a 2020 2020 2020 2020 7072 6f6a  lf,.        proj
+0000c6a0: 6563 743a 204f 7074 696f 6e61 6c5b 7374  ect: Optional[st
+0000c6b0: 725d 203d 204e 6f6e 652c 0a20 2020 2020  r] = None,.     
+0000c6c0: 2020 206c 6162 656c 5f73 656c 6563 746f     label_selecto
+0000c6d0: 723a 204f 7074 696f 6e61 6c5b 7374 725d  r: Optional[str]
+0000c6e0: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+0000c6f0: 206b 696e 643a 204f 7074 696f 6e61 6c5b   kind: Optional[
+0000c700: 7374 725d 203d 204e 6f6e 652c 0a20 2020  str] = None,.   
+0000c710: 2020 2020 206f 626a 6563 745f 6964 3a20       object_id: 
+0000c720: 4f70 7469 6f6e 616c 5b73 7472 5d20 3d20  Optional[str] = 
+0000c730: 4e6f 6e65 2c0a 2020 2020 2020 2020 666f  None,.        fo
+0000c740: 7263 653a 2062 6f6f 6c20 3d20 4661 6c73  rce: bool = Fals
+0000c750: 652c 0a20 2020 2020 2020 2067 7261 6365  e,.        grace
+0000c760: 5f70 6572 696f 643a 2069 6e74 203d 204e  _period: int = N
+0000c770: 6f6e 652c 0a20 2020 2029 202d 3e20 6d6c  one,.    ) -> ml
+0000c780: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
+0000c790: 6173 2e47 726f 7570 6564 4279 5072 6f6a  as.GroupedByProj
+0000c7a0: 6563 7452 756e 7469 6d65 5265 736f 7572  ectRuntimeResour
+0000c7b0: 6365 734f 7574 7075 743a 0a20 2020 2020  cesOutput:.     
+0000c7c0: 2020 2022 2222 4465 6c65 7465 2061 6c6c     """Delete all
+0000c7d0: 2072 756e 7469 6d65 2072 6573 6f75 7263   runtime resourc
+0000c7e0: 6573 2077 6869 6368 2061 7265 2069 6e20  es which are in 
+0000c7f0: 7465 726d 696e 616c 2073 7461 7465 2e0a  terminal state..
+0000c800: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0000c810: 7072 6f6a 6563 743a 2044 656c 6574 6520  project: Delete 
+0000c820: 6f6e 6c79 2072 756e 7469 6d65 2072 6573  only runtime res
+0000c830: 6f75 7263 6573 206f 6620 6120 7370 6563  ources of a spec
+0000c840: 6966 6963 2070 726f 6a65 6374 2c20 6279  ific project, by
+0000c850: 2064 6566 6175 6c74 204e 6f6e 652c 2077   default None, w
+0000c860: 6869 6368 2077 696c 6c20 6465 6c65 7465  hich will delete
+0000c870: 206f 6e6c 790a 2020 2020 2020 2020 2020   only.          
+0000c880: 2020 6672 6f6d 2074 6865 2070 726f 6a65    from the proje
+0000c890: 6374 7320 796f 7527 7265 2061 7574 686f  cts you're autho
+0000c8a0: 7269 7a65 6420 746f 2064 656c 6574 6520  rized to delete 
+0000c8b0: 6672 6f6d 2e0a 2020 2020 2020 2020 3a70  from..        :p
+0000c8c0: 6172 616d 206c 6162 656c 5f73 656c 6563  aram label_selec
+0000c8d0: 746f 723a 2044 656c 6574 6520 6f6e 6c79  tor: Delete only
+0000c8e0: 2072 756e 7469 6d65 2072 6573 6f75 7263   runtime resourc
+0000c8f0: 6573 206d 6174 6368 696e 6720 7468 6520  es matching the 
+0000c900: 6c61 6265 6c20 7365 6c65 6374 6f72 2e0a  label selector..
+0000c910: 2020 2020 2020 2020 3a70 6172 616d 206b          :param k
+0000c920: 696e 643a 2054 6865 206b 696e 6420 6f66  ind: The kind of
+0000c930: 2072 756e 7469 6d65 2074 6f20 6465 6c65   runtime to dele
+0000c940: 7465 2e20 4d61 7920 6265 206f 6e65 206f  te. May be one o
+0000c950: 6620 605b 2764 6173 6b27 2c20 276a 6f62  f `['dask', 'job
+0000c960: 272c 2027 7370 6172 6b27 2c20 2772 656d  ', 'spark', 'rem
+0000c970: 6f74 652d 7370 6172 6b27 2c20 276d 7069  ote-spark', 'mpi
+0000c980: 6a6f 6227 5d60 0a20 2020 2020 2020 203a  job']`.        :
+0000c990: 7061 7261 6d20 6f62 6a65 6374 5f69 643a  param object_id:
+0000c9a0: 2054 6865 2069 6465 6e74 6966 6965 7220   The identifier 
+0000c9b0: 6f66 2074 6865 206d 6c72 756e 206f 626a  of the mlrun obj
+0000c9c0: 6563 7420 746f 2064 656c 6574 6520 6974  ect to delete it
+0000c9d0: 7320 7275 6e74 696d 6520 7265 736f 7572  s runtime resour
+0000c9e0: 6365 732e 2066 6f72 206d 6f73 7420 6675  ces. for most fu
+0000c9f0: 6e63 7469 6f6e 0a20 2020 2020 2020 2020  nction.         
+0000ca00: 2020 2072 756e 7469 6d65 732c 2072 756e     runtimes, run
+0000ca10: 7469 6d65 2072 6573 6f75 7263 6573 2061  time resources a
+0000ca20: 7265 2070 6572 2052 756e 2c20 666f 7220  re per Run, for 
+0000ca30: 7768 6963 6820 7468 6520 6964 656e 7469  which the identi
+0000ca40: 6669 6572 2069 7320 7468 6520 5275 6e27  fier is the Run'
+0000ca50: 7320 5549 442e 2046 6f72 2064 6173 6b20  s UID. For dask 
+0000ca60: 7275 6e74 696d 652c 2074 6865 0a20 2020  runtime, the.   
+0000ca70: 2020 2020 2020 2020 2072 756e 7469 6d65           runtime
+0000ca80: 2072 6573 6f75 7263 6573 2061 7265 2070   resources are p
+0000ca90: 6572 2046 756e 6374 696f 6e2c 2066 6f72  er Function, for
+0000caa0: 2077 6869 6368 2074 6865 2069 6465 6e74   which the ident
+0000cab0: 6966 6965 7220 6973 2074 6865 2046 756e  ifier is the Fun
+0000cac0: 6374 696f 6e27 7320 6e61 6d65 2e0a 2020  ction's name..  
+0000cad0: 2020 2020 2020 3a70 6172 616d 2066 6f72        :param for
+0000cae0: 6365 3a20 466f 7263 6520 6465 6c65 7469  ce: Force deleti
+0000caf0: 6f6e 202d 2064 656c 6574 6520 7468 6520  on - delete the 
+0000cb00: 7275 6e74 696d 6520 7265 736f 7572 6365  runtime resource
+0000cb10: 2065 7665 6e20 6966 2069 7427 7320 6e6f   even if it's no
+0000cb20: 7420 696e 2074 6572 6d69 6e61 6c20 7374  t in terminal st
+0000cb30: 6174 6520 6f72 2069 6620 7468 6520 6772  ate or if the gr
+0000cb40: 6163 650a 2020 2020 2020 2020 2020 2020  ace.            
+0000cb50: 7065 7269 6f64 2064 6964 6e27 7420 7061  period didn't pa
+0000cb60: 7373 2e0a 2020 2020 2020 2020 3a70 6172  ss..        :par
+0000cb70: 616d 2067 7261 6365 5f70 6572 696f 643a  am grace_period:
+0000cb80: 2047 7261 6365 2070 6572 696f 6420 6769   Grace period gi
+0000cb90: 7665 6e20 746f 2074 6865 2072 756e 7469  ven to the runti
+0000cba0: 6d65 2072 6573 6f75 7263 6520 6265 666f  me resource befo
+0000cbb0: 7265 2074 6865 7920 6172 6520 6163 7475  re they are actu
+0000cbc0: 616c 6c79 2072 656d 6f76 6564 2c20 636f  ally removed, co
+0000cbd0: 756e 7465 6420 6672 6f6d 0a20 2020 2020  unted from.     
+0000cbe0: 2020 2020 2020 2074 6865 206d 6f6d 656e         the momen
+0000cbf0: 7420 7468 6579 206d 6f76 6564 2074 6f20  t they moved to 
+0000cc00: 7465 726d 696e 616c 2073 7461 7465 0a20  terminal state. 
+0000cc10: 2020 2020 2020 2020 2020 2028 6465 6661             (defa
+0000cc20: 756c 7473 2074 6f20 6d6c 7275 6e2e 636f  ults to mlrun.co
+0000cc30: 6e66 6967 2e63 6f6e 6669 672e 7275 6e74  nfig.config.runt
+0000cc40: 696d 655f 7265 736f 7572 6365 735f 6465  ime_resources_de
+0000cc50: 6c65 7469 6f6e 5f67 7261 6365 5f70 6572  letion_grace_per
+0000cc60: 696f 6429 2e0a 0a20 2020 2020 2020 203a  iod)...        :
+0000cc70: 7265 7475 726e 733a 203a 7079 3a63 6c61  returns: :py:cla
+0000cc80: 7373 3a60 7e6d 6c72 756e 2e63 6f6d 6d6f  ss:`~mlrun.commo
+0000cc90: 6e2e 7363 6865 6d61 732e 4772 6f75 7065  n.schemas.Groupe
+0000cca0: 6442 7950 726f 6a65 6374 5275 6e74 696d  dByProjectRuntim
+0000ccb0: 6552 6573 6f75 7263 6573 4f75 7470 7574  eResourcesOutput
+0000ccc0: 6020 6c69 7374 696e 6720 7468 6520 7275  ` listing the ru
+0000ccd0: 6e74 696d 6520 7265 736f 7572 6365 730a  ntime resources.
+0000cce0: 2020 2020 2020 2020 2020 2020 7468 6174              that
+0000ccf0: 2077 6572 6520 7265 6d6f 7665 642e 0a20   were removed.. 
+0000cd00: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0000cd10: 2020 2069 6620 6772 6163 655f 7065 7269     if grace_peri
+0000cd20: 6f64 2069 7320 4e6f 6e65 3a0a 2020 2020  od is None:.    
+0000cd30: 2020 2020 2020 2020 6772 6163 655f 7065          grace_pe
+0000cd40: 7269 6f64 203d 2063 6f6e 6669 672e 7275  riod = config.ru
+0000cd50: 6e74 696d 655f 7265 736f 7572 6365 735f  ntime_resources_
+0000cd60: 6465 6c65 7469 6f6e 5f67 7261 6365 5f70  deletion_grace_p
+0000cd70: 6572 696f 640a 2020 2020 2020 2020 2020  eriod.          
+0000cd80: 2020 6c6f 6767 6572 2e69 6e66 6f28 0a20    logger.info(. 
+0000cd90: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0000cda0: 5573 696e 6720 6465 6661 756c 7420 6772  Using default gr
+0000cdb0: 6163 6520 7065 7269 6f64 2066 6f72 2072  ace period for r
+0000cdc0: 756e 7469 6d65 2072 6573 6f75 7263 6573  untime resources
+0000cdd0: 2064 656c 6574 696f 6e22 2c0a 2020 2020   deletion",.    
+0000cde0: 2020 2020 2020 2020 2020 2020 6772 6163              grac
+0000cdf0: 655f 7065 7269 6f64 3d67 7261 6365 5f70  e_period=grace_p
+0000ce00: 6572 696f 642c 0a20 2020 2020 2020 2020  eriod,.         
+0000ce10: 2020 2029 0a0a 2020 2020 2020 2020 7061     )..        pa
+0000ce20: 7261 6d73 203d 207b 0a20 2020 2020 2020  rams = {.       
+0000ce30: 2020 2020 2022 6c61 6265 6c2d 7365 6c65       "label-sele
+0000ce40: 6374 6f72 223a 206c 6162 656c 5f73 656c  ctor": label_sel
+0000ce50: 6563 746f 722c 0a20 2020 2020 2020 2020  ector,.         
+0000ce60: 2020 2022 6b69 6e64 223a 206b 696e 642c     "kind": kind,
+0000ce70: 0a20 2020 2020 2020 2020 2020 2022 6f62  .            "ob
+0000ce80: 6a65 6374 2d69 6422 3a20 6f62 6a65 6374  ject-id": object
+0000ce90: 5f69 642c 0a20 2020 2020 2020 2020 2020  _id,.           
+0000cea0: 2022 666f 7263 6522 3a20 666f 7263 652c   "force": force,
+0000ceb0: 0a20 2020 2020 2020 2020 2020 2022 6772  .            "gr
+0000cec0: 6163 652d 7065 7269 6f64 223a 2067 7261  ace-period": gra
+0000ced0: 6365 5f70 6572 696f 642c 0a20 2020 2020  ce_period,.     
+0000cee0: 2020 207d 0a20 2020 2020 2020 2065 7272     }.        err
+0000cef0: 6f72 203d 2022 4661 696c 6564 2064 656c  or = "Failed del
+0000cf00: 6574 696e 6720 7275 6e74 696d 6520 7265  eting runtime re
+0000cf10: 736f 7572 6365 7322 0a20 2020 2020 2020  sources".       
+0000cf20: 2070 726f 6a65 6374 5f70 6174 6820 3d20   project_path = 
+0000cf30: 7072 6f6a 6563 7420 6966 2070 726f 6a65  project if proje
+0000cf40: 6374 2065 6c73 6520 222a 220a 2020 2020  ct else "*".    
+0000cf50: 2020 2020 7265 7370 6f6e 7365 203d 2073      response = s
+0000cf60: 656c 662e 6170 695f 6361 6c6c 280a 2020  elf.api_call(.  
+0000cf70: 2020 2020 2020 2020 2020 2244 454c 4554            "DELET
+0000cf80: 4522 2c0a 2020 2020 2020 2020 2020 2020  E",.            
+0000cf90: 6622 7072 6f6a 6563 7473 2f7b 7072 6f6a  f"projects/{proj
+0000cfa0: 6563 745f 7061 7468 7d2f 7275 6e74 696d  ect_path}/runtim
+0000cfb0: 652d 7265 736f 7572 6365 7322 2c0a 2020  e-resources",.  
+0000cfc0: 2020 2020 2020 2020 2020 6572 726f 722c            error,
+0000cfd0: 0a20 2020 2020 2020 2020 2020 2070 6172  .            par
+0000cfe0: 616d 733d 7061 7261 6d73 2c0a 2020 2020  ams=params,.    
+0000cff0: 2020 2020 290a 2020 2020 2020 2020 7374      ).        st
+0000d000: 7275 6374 7572 6564 5f64 6963 7420 3d20  ructured_dict = 
+0000d010: 7b7d 0a20 2020 2020 2020 2066 6f72 2070  {}.        for p
+0000d020: 726f 6a65 6374 2c20 6b69 6e64 5f72 756e  roject, kind_run
+0000d030: 7469 6d65 5f72 6573 6f75 7263 6573 5f6d  time_resources_m
+0000d040: 6170 2069 6e20 7265 7370 6f6e 7365 2e6a  ap in response.j
+0000d050: 736f 6e28 292e 6974 656d 7328 293a 0a20  son().items():. 
+0000d060: 2020 2020 2020 2020 2020 2066 6f72 206b             for k
+0000d070: 696e 642c 2072 756e 7469 6d65 5f72 6573  ind, runtime_res
+0000d080: 6f75 7263 6573 2069 6e20 6b69 6e64 5f72  ources in kind_r
+0000d090: 756e 7469 6d65 5f72 6573 6f75 7263 6573  untime_resources
+0000d0a0: 5f6d 6170 2e69 7465 6d73 2829 3a0a 2020  _map.items():.  
+0000d0b0: 2020 2020 2020 2020 2020 2020 2020 7374                st
+0000d0c0: 7275 6374 7572 6564 5f64 6963 742e 7365  ructured_dict.se
+0000d0d0: 7464 6566 6175 6c74 2870 726f 6a65 6374  tdefault(project
+0000d0e0: 2c20 7b7d 295b 6b69 6e64 5d20 3d20 280a  , {})[kind] = (.
+0000d0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d100: 2020 2020 6d6c 7275 6e2e 636f 6d6d 6f6e      mlrun.common
+0000d110: 2e73 6368 656d 6173 2e52 756e 7469 6d65  .schemas.Runtime
+0000d120: 5265 736f 7572 6365 7328 2a2a 7275 6e74  Resources(**runt
+0000d130: 696d 655f 7265 736f 7572 6365 7329 0a20  ime_resources). 
+0000d140: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0000d150: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0000d160: 7374 7275 6374 7572 6564 5f64 6963 740a  structured_dict.
+0000d170: 0a20 2020 2064 6566 2063 7265 6174 655f  .    def create_
+0000d180: 7363 6865 6475 6c65 280a 2020 2020 2020  schedule(.      
+0000d190: 2020 7365 6c66 2c20 7072 6f6a 6563 743a    self, project:
+0000d1a0: 2073 7472 2c20 7363 6865 6475 6c65 3a20   str, schedule: 
+0000d1b0: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+0000d1c0: 656d 6173 2e53 6368 6564 756c 6549 6e70  emas.ScheduleInp
+0000d1d0: 7574 0a20 2020 2029 3a0a 2020 2020 2020  ut.    ):.      
+0000d1e0: 2020 2222 2243 7265 6174 6520 6120 6e65    """Create a ne
+0000d1f0: 7720 7363 6865 6475 6c65 206f 6e20 7468  w schedule on th
+0000d200: 6520 6769 7665 6e20 7072 6f6a 6563 742e  e given project.
+0000d210: 2054 6865 2064 6574 6169 6c73 206f 6e20   The details on 
+0000d220: 7468 6520 6163 7475 616c 206f 626a 6563  the actual objec
+0000d230: 7420 746f 2073 6368 6564 756c 6520 6173  t to schedule as
+0000d240: 2077 656c 6c20 6173 2074 6865 0a20 2020   well as the.   
+0000d250: 2020 2020 2073 6368 6564 756c 6520 6974       schedule it
+0000d260: 7365 6c66 2061 7265 2077 6974 6869 6e20  self are within 
+0000d270: 7468 6520 7363 6865 6475 6c65 206f 626a  the schedule obj
+0000d280: 6563 7420 7072 6f76 6964 6564 2e0a 2020  ect provided..  
+0000d290: 2020 2020 2020 5468 6520 3a70 793a 636c        The :py:cl
+0000d2a0: 6173 733a 607e 5363 6865 6475 6c65 4372  ass:`~ScheduleCr
+0000d2b0: 6f6e 5472 6967 6765 7260 2066 6f6c 6c6f  onTrigger` follo
+0000d2c0: 7773 2074 6865 2067 7569 6465 6c69 6e65  ws the guideline
+0000d2d0: 7320 696e 0a20 2020 2020 2020 2068 7474  s in.        htt
+0000d2e0: 7073 3a2f 2f61 7073 6368 6564 756c 6572  ps://apscheduler
+0000d2f0: 2e72 6561 6474 6865 646f 6373 2e69 6f2f  .readthedocs.io/
+0000d300: 656e 2f33 2e78 2f6d 6f64 756c 6573 2f74  en/3.x/modules/t
+0000d310: 7269 6767 6572 732f 6372 6f6e 2e68 746d  riggers/cron.htm
+0000d320: 6c2e 0a20 2020 2020 2020 2049 7420 616c  l..        It al
+0000d330: 736f 2073 7570 706f 7274 7320 6120 3a70  so supports a :p
+0000d340: 793a 6675 6e63 3a60 7e53 6368 6564 756c  y:func:`~Schedul
+0000d350: 6543 726f 6e54 7269 6767 6572 2e66 726f  eCronTrigger.fro
+0000d360: 6d5f 6372 6f6e 7461 6260 2066 756e 6374  m_crontab` funct
+0000d370: 696f 6e20 7468 6174 2061 6363 6570 7473  ion that accepts
+0000d380: 2061 0a20 2020 2020 2020 2063 726f 6e74   a.        cront
+0000d390: 6162 2d66 6f72 6d61 7474 6564 2073 7472  ab-formatted str
+0000d3a0: 696e 6720 2873 6565 2068 7474 7073 3a2f  ing (see https:/
+0000d3b0: 2f65 6e2e 7769 6b69 7065 6469 612e 6f72  /en.wikipedia.or
+0000d3c0: 672f 7769 6b69 2f43 726f 6e20 666f 7220  g/wiki/Cron for 
+0000d3d0: 6d6f 7265 2069 6e66 6f72 6d61 7469 6f6e  more information
+0000d3e0: 206f 6e20 7468 6520 666f 726d 6174 2061   on the format a
+0000d3f0: 6e64 0a20 2020 2020 2020 206e 6f74 6520  nd.        note 
+0000d400: 7468 6174 2074 6865 2030 2077 6565 6b64  that the 0 weekd
+0000d410: 6179 2069 7320 616c 7761 7973 206d 6f6e  ay is always mon
+0000d420: 6461 7929 2e0a 0a0a 2020 2020 2020 2020  day)....        
+0000d430: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
+0000d440: 2020 2020 2020 2066 726f 6d20 6d6c 7275         from mlru
+0000d450: 6e2e 636f 6d6d 6f6e 2069 6d70 6f72 7420  n.common import 
+0000d460: 7363 6865 6d61 730a 0a20 2020 2020 2020  schemas..       
+0000d470: 2020 2020 2023 2045 7865 6375 7465 2074       # Execute t
+0000d480: 6865 2067 6574 5f64 6174 615f 6675 6e63  he get_data_func
+0000d490: 2066 756e 6374 696f 6e20 6576 6572 7920   function every 
+0000d4a0: 5475 6573 6461 7920 6174 2031 353a 3330  Tuesday at 15:30
+0000d4b0: 0a20 2020 2020 2020 2020 2020 2073 6368  .            sch
+0000d4c0: 6564 756c 6520 3d20 7363 6865 6d61 732e  edule = schemas.
+0000d4d0: 5363 6865 6475 6c65 496e 7075 7428 0a20  ScheduleInput(. 
+0000d4e0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+0000d4f0: 616d 653d 2272 756e 5f66 756e 635f 6f6e  ame="run_func_on
+0000d500: 5f74 7565 7364 6179 7322 2c0a 2020 2020  _tuesdays",.    
+0000d510: 2020 2020 2020 2020 2020 2020 6b69 6e64              kind
+0000d520: 3d22 6a6f 6222 2c0a 2020 2020 2020 2020  ="job",.        
+0000d530: 2020 2020 2020 2020 7363 6865 6475 6c65          schedule
+0000d540: 645f 6f62 6a65 6374 3d67 6574 5f64 6174  d_object=get_dat
+0000d550: 615f 6675 6e63 2c0a 2020 2020 2020 2020  a_func,.        
+0000d560: 2020 2020 2020 2020 6372 6f6e 5f74 7269          cron_tri
+0000d570: 6767 6572 3d73 6368 656d 6173 2e53 6368  gger=schemas.Sch
+0000d580: 6564 756c 6543 726f 6e54 7269 6767 6572  eduleCronTrigger
+0000d590: 2864 6179 5f6f 665f 7765 656b 3d27 7475  (day_of_week='tu
+0000d5a0: 6527 2c20 686f 7572 3d31 352c 206d 696e  e', hour=15, min
+0000d5b0: 7574 653d 3330 292c 0a20 2020 2020 2020  ute=30),.       
+0000d5c0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+0000d5d0: 2020 2064 622e 6372 6561 7465 5f73 6368     db.create_sch
+0000d5e0: 6564 756c 6528 7072 6f6a 6563 745f 6e61  edule(project_na
+0000d5f0: 6d65 2c20 7363 6865 6475 6c65 290a 2020  me, schedule).  
+0000d600: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
+0000d610: 2020 2070 726f 6a65 6374 203d 2070 726f     project = pro
+0000d620: 6a65 6374 206f 7220 636f 6e66 6967 2e64  ject or config.d
+0000d630: 6566 6175 6c74 5f70 726f 6a65 6374 0a20  efault_project. 
+0000d640: 2020 2020 2020 2070 6174 6820 3d20 6622         path = f"
+0000d650: 7072 6f6a 6563 7473 2f7b 7072 6f6a 6563  projects/{projec
+0000d660: 747d 2f73 6368 6564 756c 6573 220a 0a20  t}/schedules".. 
+0000d670: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
+0000d680: 7361 6765 203d 2066 2246 6169 6c65 6420  sage = f"Failed 
+0000d690: 6372 6561 7469 6e67 2073 6368 6564 756c  creating schedul
+0000d6a0: 6520 7b70 726f 6a65 6374 7d2f 7b73 6368  e {project}/{sch
+0000d6b0: 6564 756c 652e 6e61 6d65 7d22 0a20 2020  edule.name}".   
+0000d6c0: 2020 2020 2073 656c 662e 6170 695f 6361       self.api_ca
+0000d6d0: 6c6c 2822 504f 5354 222c 2070 6174 682c  ll("POST", path,
+0000d6e0: 2065 7272 6f72 5f6d 6573 7361 6765 2c20   error_message, 
+0000d6f0: 626f 6479 3d64 6963 745f 746f 5f6a 736f  body=dict_to_jso
+0000d700: 6e28 7363 6865 6475 6c65 2e64 6963 7428  n(schedule.dict(
+0000d710: 2929 290a 0a20 2020 2064 6566 2075 7064  )))..    def upd
+0000d720: 6174 655f 7363 6865 6475 6c65 280a 2020  ate_schedule(.  
+0000d730: 2020 2020 2020 7365 6c66 2c20 7072 6f6a        self, proj
+0000d740: 6563 743a 2073 7472 2c20 6e61 6d65 3a20  ect: str, name: 
+0000d750: 7374 722c 2073 6368 6564 756c 653a 206d  str, schedule: m
+0000d760: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
+0000d770: 6d61 732e 5363 6865 6475 6c65 5570 6461  mas.ScheduleUpda
+0000d780: 7465 0a20 2020 2029 3a0a 2020 2020 2020  te.    ):.      
+0000d790: 2020 2222 2255 7064 6174 6520 616e 2065    """Update an e
+0000d7a0: 7869 7374 696e 6720 7363 6865 6475 6c65  xisting schedule
+0000d7b0: 2c20 7265 706c 6163 6520 6974 2077 6974  , replace it wit
+0000d7c0: 6820 7468 6520 6465 7461 696c 7320 636f  h the details co
+0000d7d0: 6e74 6169 6e65 6420 696e 2074 6865 2073  ntained in the s
+0000d7e0: 6368 6564 756c 6520 6f62 6a65 6374 2e22  chedule object."
+0000d7f0: 2222 0a0a 2020 2020 2020 2020 7072 6f6a  ""..        proj
+0000d800: 6563 7420 3d20 7072 6f6a 6563 7420 6f72  ect = project or
+0000d810: 2063 6f6e 6669 672e 6465 6661 756c 745f   config.default_
+0000d820: 7072 6f6a 6563 740a 2020 2020 2020 2020  project.        
+0000d830: 7061 7468 203d 2066 2270 726f 6a65 6374  path = f"project
+0000d840: 732f 7b70 726f 6a65 6374 7d2f 7363 6865  s/{project}/sche
+0000d850: 6475 6c65 732f 7b6e 616d 657d 220a 0a20  dules/{name}".. 
+0000d860: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
+0000d870: 7361 6765 203d 2066 2246 6169 6c65 6420  sage = f"Failed 
+0000d880: 7570 6461 7469 6e67 2073 6368 6564 756c  updating schedul
+0000d890: 6520 7b70 726f 6a65 6374 7d2f 7b6e 616d  e {project}/{nam
+0000d8a0: 657d 220a 2020 2020 2020 2020 7365 6c66  e}".        self
+0000d8b0: 2e61 7069 5f63 616c 6c28 2250 5554 222c  .api_call("PUT",
+0000d8c0: 2070 6174 682c 2065 7272 6f72 5f6d 6573   path, error_mes
+0000d8d0: 7361 6765 2c20 626f 6479 3d64 6963 745f  sage, body=dict_
+0000d8e0: 746f 5f6a 736f 6e28 7363 6865 6475 6c65  to_json(schedule
+0000d8f0: 2e64 6963 7428 2929 290a 0a20 2020 2064  .dict()))..    d
+0000d900: 6566 2067 6574 5f73 6368 6564 756c 6528  ef get_schedule(
+0000d910: 0a20 2020 2020 2020 2073 656c 662c 2070  .        self, p
+0000d920: 726f 6a65 6374 3a20 7374 722c 206e 616d  roject: str, nam
+0000d930: 653a 2073 7472 2c20 696e 636c 7564 655f  e: str, include_
+0000d940: 6c61 7374 5f72 756e 3a20 626f 6f6c 203d  last_run: bool =
+0000d950: 2046 616c 7365 0a20 2020 2029 202d 3e20   False.    ) -> 
+0000d960: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+0000d970: 656d 6173 2e53 6368 6564 756c 654f 7574  emas.ScheduleOut
+0000d980: 7075 743a 0a20 2020 2020 2020 2022 2222  put:.        """
+0000d990: 5265 7472 6965 7665 2064 6574 6169 6c73  Retrieve details
+0000d9a0: 206f 6620 7468 6520 7363 6865 6475 6c65   of the schedule
+0000d9b0: 2069 6e20 7175 6573 7469 6f6e 2e20 4265   in question. Be
+0000d9c0: 7369 6465 7320 7265 7475 726e 696e 6720  sides returning 
+0000d9d0: 7468 6520 6465 7461 696c 7320 6f66 2074  the details of t
+0000d9e0: 6865 2073 6368 6564 756c 6520 6f62 6a65  he schedule obje
+0000d9f0: 6374 2069 7473 656c 662c 0a20 2020 2020  ct itself,.     
+0000da00: 2020 2074 6869 7320 6675 6e63 7469 6f6e     this function
+0000da10: 2061 6c73 6f20 7265 7475 726e 7320 7468   also returns th
+0000da20: 6520 6e65 7874 2073 6368 6564 756c 6564  e next scheduled
+0000da30: 2072 756e 2066 6f72 2074 6869 7320 7370   run for this sp
+0000da40: 6563 6966 6963 2073 6368 6564 756c 652c  ecific schedule,
+0000da50: 2061 7320 7765 6c6c 2061 7320 706f 7465   as well as pote
+0000da60: 6e74 6961 6c6c 7920 7468 650a 2020 2020  ntially the.    
+0000da70: 2020 2020 7265 7375 6c74 7320 6f66 2074      results of t
+0000da80: 6865 206c 6173 7420 7275 6e20 6578 6563  he last run exec
+0000da90: 7574 6564 2074 6872 6f75 6768 2074 6869  uted through thi
+0000daa0: 7320 7363 6865 6475 6c65 2e0a 0a20 2020  s schedule...   
+0000dab0: 2020 2020 203a 7061 7261 6d20 7072 6f6a       :param proj
+0000dac0: 6563 743a 2050 726f 6a65 6374 206e 616d  ect: Project nam
+0000dad0: 652e 0a20 2020 2020 2020 203a 7061 7261  e..        :para
+0000dae0: 6d20 6e61 6d65 3a20 4e61 6d65 206f 6620  m name: Name of 
+0000daf0: 7468 6520 7363 6865 6475 6c65 206f 626a  the schedule obj
+0000db00: 6563 7420 746f 2071 7565 7279 2e0a 2020  ect to query..  
+0000db10: 2020 2020 2020 3a70 6172 616d 2069 6e63        :param inc
+0000db20: 6c75 6465 5f6c 6173 745f 7275 6e3a 2057  lude_last_run: W
+0000db30: 6865 7468 6572 2074 6f20 696e 636c 7564  hether to includ
+0000db40: 6520 7468 6520 7265 7375 6c74 7320 6f66  e the results of
+0000db50: 2074 6865 2073 6368 6564 756c 6527 7320   the schedule's 
+0000db60: 6c61 7374 2072 756e 2069 6e20 7468 6520  last run in the 
+0000db70: 7265 7370 6f6e 7365 2e0a 2020 2020 2020  response..      
+0000db80: 2020 2222 220a 0a20 2020 2020 2020 2070    """..        p
+0000db90: 726f 6a65 6374 203d 2070 726f 6a65 6374  roject = project
+0000dba0: 206f 7220 636f 6e66 6967 2e64 6566 6175   or config.defau
+0000dbb0: 6c74 5f70 726f 6a65 6374 0a20 2020 2020  lt_project.     
+0000dbc0: 2020 2070 6174 6820 3d20 6622 7072 6f6a     path = f"proj
+0000dbd0: 6563 7473 2f7b 7072 6f6a 6563 747d 2f73  ects/{project}/s
+0000dbe0: 6368 6564 756c 6573 2f7b 6e61 6d65 7d22  chedules/{name}"
+0000dbf0: 0a20 2020 2020 2020 2065 7272 6f72 5f6d  .        error_m
+0000dc00: 6573 7361 6765 203d 2066 2246 6169 6c65  essage = f"Faile
+0000dc10: 6420 6765 7474 696e 6720 7363 6865 6475  d getting schedu
+0000dc20: 6c65 2066 6f72 207b 7072 6f6a 6563 747d  le for {project}
+0000dc30: 2f7b 6e61 6d65 7d22 0a20 2020 2020 2020  /{name}".       
+0000dc40: 2072 6573 7020 3d20 7365 6c66 2e61 7069   resp = self.api
+0000dc50: 5f63 616c 6c28 0a20 2020 2020 2020 2020  _call(.         
+0000dc60: 2020 2022 4745 5422 2c20 7061 7468 2c20     "GET", path, 
+0000dc70: 6572 726f 725f 6d65 7373 6167 652c 2070  error_message, p
+0000dc80: 6172 616d 733d 7b22 696e 636c 7564 655f  arams={"include_
+0000dc90: 6c61 7374 5f72 756e 223a 2069 6e63 6c75  last_run": inclu
+0000dca0: 6465 5f6c 6173 745f 7275 6e7d 0a20 2020  de_last_run}.   
+0000dcb0: 2020 2020 2029 0a20 2020 2020 2020 2072       ).        r
+0000dcc0: 6574 7572 6e20 6d6c 7275 6e2e 636f 6d6d  eturn mlrun.comm
+0000dcd0: 6f6e 2e73 6368 656d 6173 2e53 6368 6564  on.schemas.Sched
+0000dce0: 756c 654f 7574 7075 7428 2a2a 7265 7370  uleOutput(**resp
+0000dcf0: 2e6a 736f 6e28 2929 0a0a 2020 2020 6465  .json())..    de
+0000dd00: 6620 6c69 7374 5f73 6368 6564 756c 6573  f list_schedules
+0000dd10: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+0000dd20: 2020 2020 2020 2020 7072 6f6a 6563 743a          project:
+0000dd30: 2073 7472 2c0a 2020 2020 2020 2020 6e61   str,.        na
+0000dd40: 6d65 3a20 7374 7220 3d20 4e6f 6e65 2c0a  me: str = None,.
+0000dd50: 2020 2020 2020 2020 6b69 6e64 3a20 6d6c          kind: ml
+0000dd60: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
+0000dd70: 6173 2e53 6368 6564 756c 654b 696e 6473  as.ScheduleKinds
+0000dd80: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+0000dd90: 2069 6e63 6c75 6465 5f6c 6173 745f 7275   include_last_ru
+0000dda0: 6e3a 2062 6f6f 6c20 3d20 4661 6c73 652c  n: bool = False,
+0000ddb0: 0a20 2020 2029 202d 3e20 6d6c 7275 6e2e  .    ) -> mlrun.
+0000ddc0: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e53  common.schemas.S
+0000ddd0: 6368 6564 756c 6573 4f75 7470 7574 3a0a  chedulesOutput:.
+0000dde0: 2020 2020 2020 2020 2222 2252 6574 7269          """Retri
+0000ddf0: 6576 6520 6c69 7374 206f 6620 7363 6865  eve list of sche
+0000de00: 6475 6c65 7320 6f66 2073 7065 6369 6669  dules of specifi
+0000de10: 6320 6e61 6d65 206f 7220 6b69 6e64 2e0a  c name or kind..
+0000de20: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0000de30: 7072 6f6a 6563 743a 2050 726f 6a65 6374  project: Project
+0000de40: 206e 616d 652e 0a20 2020 2020 2020 203a   name..        :
+0000de50: 7061 7261 6d20 6e61 6d65 3a20 4e61 6d65  param name: Name
+0000de60: 206f 6620 7363 6865 6475 6c65 2074 6f20   of schedule to 
+0000de70: 7265 7472 6965 7665 2e20 4361 6e20 6265  retrieve. Can be
+0000de80: 206f 6d69 7474 6564 2074 6f20 6c69 7374   omitted to list
+0000de90: 2061 6c6c 2073 6368 6564 756c 6573 2e0a   all schedules..
+0000dea0: 2020 2020 2020 2020 3a70 6172 616d 206b          :param k
+0000deb0: 696e 643a 204b 696e 6420 6f66 2073 6368  ind: Kind of sch
+0000dec0: 6564 756c 6520 6f62 6a65 6374 7320 746f  edule objects to
+0000ded0: 2072 6574 7269 6576 652c 2063 616e 2062   retrieve, can b
+0000dee0: 6520 6569 7468 6572 2060 606a 6f62 6060  e either ``job``
+0000def0: 206f 7220 6060 7069 7065 6c69 6e65 6060   or ``pipeline``
+0000df00: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0000df10: 2069 6e63 6c75 6465 5f6c 6173 745f 7275   include_last_ru
+0000df20: 6e3a 2057 6865 7468 6572 2074 6f20 7265  n: Whether to re
+0000df30: 7475 726e 2066 6f72 2065 6163 6820 7363  turn for each sc
+0000df40: 6865 6475 6c65 2072 6574 7572 6e65 6420  hedule returned 
+0000df50: 616c 736f 2074 6865 2072 6573 756c 7473  also the results
+0000df60: 206f 6620 7468 6520 6c61 7374 2072 756e   of the last run
+0000df70: 206f 660a 2020 2020 2020 2020 2020 2020   of.            
+0000df80: 7468 6174 2073 6368 6564 756c 652e 0a20  that schedule.. 
+0000df90: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
+0000dfa0: 2020 2020 7072 6f6a 6563 7420 3d20 7072      project = pr
+0000dfb0: 6f6a 6563 7420 6f72 2063 6f6e 6669 672e  oject or config.
+0000dfc0: 6465 6661 756c 745f 7072 6f6a 6563 740a  default_project.
+0000dfd0: 2020 2020 2020 2020 7061 7261 6d73 203d          params =
+0000dfe0: 207b 226b 696e 6422 3a20 6b69 6e64 2c20   {"kind": kind, 
+0000dff0: 226e 616d 6522 3a20 6e61 6d65 2c20 2269  "name": name, "i
+0000e000: 6e63 6c75 6465 5f6c 6173 745f 7275 6e22  nclude_last_run"
+0000e010: 3a20 696e 636c 7564 655f 6c61 7374 5f72  : include_last_r
+0000e020: 756e 7d0a 2020 2020 2020 2020 7061 7468  un}.        path
+0000e030: 203d 2066 2270 726f 6a65 6374 732f 7b70   = f"projects/{p
+0000e040: 726f 6a65 6374 7d2f 7363 6865 6475 6c65  roject}/schedule
+0000e050: 7322 0a20 2020 2020 2020 2065 7272 6f72  s".        error
+0000e060: 5f6d 6573 7361 6765 203d 2066 2246 6169  _message = f"Fai
+0000e070: 6c65 6420 6c69 7374 696e 6720 7363 6865  led listing sche
+0000e080: 6475 6c65 7320 666f 7220 7b70 726f 6a65  dules for {proje
+0000e090: 6374 7d20 3f20 7b6b 696e 647d 207b 6e61  ct} ? {kind} {na
+0000e0a0: 6d65 7d22 0a20 2020 2020 2020 2072 6573  me}".        res
+0000e0b0: 7020 3d20 7365 6c66 2e61 7069 5f63 616c  p = self.api_cal
+0000e0c0: 6c28 2247 4554 222c 2070 6174 682c 2065  l("GET", path, e
+0000e0d0: 7272 6f72 5f6d 6573 7361 6765 2c20 7061  rror_message, pa
+0000e0e0: 7261 6d73 3d70 6172 616d 7329 0a20 2020  rams=params).   
+0000e0f0: 2020 2020 2072 6574 7572 6e20 6d6c 7275       return mlru
+0000e100: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
+0000e110: 2e53 6368 6564 756c 6573 4f75 7470 7574  .SchedulesOutput
+0000e120: 282a 2a72 6573 702e 6a73 6f6e 2829 290a  (**resp.json()).
+0000e130: 0a20 2020 2064 6566 2064 656c 6574 655f  .    def delete_
+0000e140: 7363 6865 6475 6c65 2873 656c 662c 2070  schedule(self, p
+0000e150: 726f 6a65 6374 3a20 7374 722c 206e 616d  roject: str, nam
+0000e160: 653a 2073 7472 293a 0a20 2020 2020 2020  e: str):.       
+0000e170: 2022 2222 4465 6c65 7465 2061 2073 7065   """Delete a spe
+0000e180: 6369 6669 6320 7363 6865 6475 6c65 2062  cific schedule b
+0000e190: 7920 6e61 6d65 2e22 2222 0a0a 2020 2020  y name."""..    
+0000e1a0: 2020 2020 7072 6f6a 6563 7420 3d20 7072      project = pr
+0000e1b0: 6f6a 6563 7420 6f72 2063 6f6e 6669 672e  oject or config.
+0000e1c0: 6465 6661 756c 745f 7072 6f6a 6563 740a  default_project.
+0000e1d0: 2020 2020 2020 2020 7061 7468 203d 2066          path = f
+0000e1e0: 2270 726f 6a65 6374 732f 7b70 726f 6a65  "projects/{proje
+0000e1f0: 6374 7d2f 7363 6865 6475 6c65 732f 7b6e  ct}/schedules/{n
+0000e200: 616d 657d 220a 2020 2020 2020 2020 6572  ame}".        er
+0000e210: 726f 725f 6d65 7373 6167 6520 3d20 6622  ror_message = f"
+0000e220: 4661 696c 6564 2064 656c 6574 696e 6720  Failed deleting 
+0000e230: 7363 6865 6475 6c65 207b 7072 6f6a 6563  schedule {projec
+0000e240: 747d 2f7b 6e61 6d65 7d22 0a20 2020 2020  t}/{name}".     
+0000e250: 2020 2073 656c 662e 6170 695f 6361 6c6c     self.api_call
+0000e260: 2822 4445 4c45 5445 222c 2070 6174 682c  ("DELETE", path,
+0000e270: 2065 7272 6f72 5f6d 6573 7361 6765 290a   error_message).
+0000e280: 0a20 2020 2064 6566 2069 6e76 6f6b 655f  .    def invoke_
+0000e290: 7363 6865 6475 6c65 2873 656c 662c 2070  schedule(self, p
+0000e2a0: 726f 6a65 6374 3a20 7374 722c 206e 616d  roject: str, nam
+0000e2b0: 653a 2073 7472 293a 0a20 2020 2020 2020  e: str):.       
+0000e2c0: 2022 2222 4578 6563 7574 6520 7468 6520   """Execute the 
+0000e2d0: 6f62 6a65 6374 2072 6566 6572 656e 6365  object reference
+0000e2e0: 6420 6279 2074 6865 2073 6368 6564 756c  d by the schedul
+0000e2f0: 6520 696d 6d65 6469 6174 656c 792e 2222  e immediately.""
+0000e300: 220a 0a20 2020 2020 2020 2070 726f 6a65  "..        proje
+0000e310: 6374 203d 2070 726f 6a65 6374 206f 7220  ct = project or 
+0000e320: 636f 6e66 6967 2e64 6566 6175 6c74 5f70  config.default_p
+0000e330: 726f 6a65 6374 0a20 2020 2020 2020 2070  roject.        p
+0000e340: 6174 6820 3d20 6622 7072 6f6a 6563 7473  ath = f"projects
+0000e350: 2f7b 7072 6f6a 6563 747d 2f73 6368 6564  /{project}/sched
+0000e360: 756c 6573 2f7b 6e61 6d65 7d2f 696e 766f  ules/{name}/invo
+0000e370: 6b65 220a 2020 2020 2020 2020 6572 726f  ke".        erro
+0000e380: 725f 6d65 7373 6167 6520 3d20 6622 4661  r_message = f"Fa
+0000e390: 696c 6564 2069 6e76 6f6b 696e 6720 7363  iled invoking sc
+0000e3a0: 6865 6475 6c65 207b 7072 6f6a 6563 747d  hedule {project}
+0000e3b0: 2f7b 6e61 6d65 7d22 0a20 2020 2020 2020  /{name}".       
+0000e3c0: 2073 656c 662e 6170 695f 6361 6c6c 2822   self.api_call("
+0000e3d0: 504f 5354 222c 2070 6174 682c 2065 7272  POST", path, err
+0000e3e0: 6f72 5f6d 6573 7361 6765 290a 0a20 2020  or_message)..   
+0000e3f0: 2064 6566 2072 656d 6f74 655f 6275 696c   def remote_buil
+0000e400: 6465 7228 0a20 2020 2020 2020 2073 656c  der(.        sel
+0000e410: 662c 0a20 2020 2020 2020 2066 756e 633a  f,.        func:
+0000e420: 2042 6173 6552 756e 7469 6d65 2c0a 2020   BaseRuntime,.  
+0000e430: 2020 2020 2020 7769 7468 5f6d 6c72 756e        with_mlrun
+0000e440: 3a20 626f 6f6c 2c0a 2020 2020 2020 2020  : bool,.        
+0000e450: 6d6c 7275 6e5f 7665 7273 696f 6e5f 7370  mlrun_version_sp
+0000e460: 6563 6966 6965 723a 204f 7074 696f 6e61  ecifier: Optiona
+0000e470: 6c5b 7374 725d 203d 204e 6f6e 652c 0a20  l[str] = None,. 
+0000e480: 2020 2020 2020 2073 6b69 705f 6465 706c         skip_depl
+0000e490: 6f79 6564 3a20 626f 6f6c 203d 2046 616c  oyed: bool = Fal
+0000e4a0: 7365 2c0a 2020 2020 2020 2020 6275 696c  se,.        buil
+0000e4b0: 6465 725f 656e 763a 204f 7074 696f 6e61  der_env: Optiona
+0000e4c0: 6c5b 6469 6374 5d20 3d20 4e6f 6e65 2c0a  l[dict] = None,.
+0000e4d0: 2020 2020 2020 2020 666f 7263 655f 6275          force_bu
+0000e4e0: 696c 643a 2062 6f6f 6c20 3d20 4661 6c73  ild: bool = Fals
+0000e4f0: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
+0000e500: 2020 2222 2242 7569 6c64 2074 6865 2070    """Build the p
+0000e510: 6f64 2069 6d61 6765 2066 6f72 2061 2066  od image for a f
+0000e520: 756e 6374 696f 6e2c 2066 6f72 2065 7865  unction, for exe
+0000e530: 6375 7469 6f6e 206f 6e20 6120 7265 6d6f  cution on a remo
+0000e540: 7465 2063 6c75 7374 6572 2e20 5468 6973  te cluster. This
+0000e550: 2069 7320 6578 6563 7574 6564 2062 7920   is executed by 
+0000e560: 7468 6520 4d4c 5275 6e0a 2020 2020 2020  the MLRun.      
+0000e570: 2020 4150 4920 7365 7276 6572 2c20 616e    API server, an
+0000e580: 6420 6372 6561 7465 7320 6120 446f 636b  d creates a Dock
+0000e590: 6572 2069 6d61 6765 206f 7574 206f 6620  er image out of 
+0000e5a0: 7468 6520 6675 6e63 7469 6f6e 2070 726f  the function pro
+0000e5b0: 7669 6465 6420 616e 6420 616e 7920 7370  vided and any sp
+0000e5c0: 6563 6966 6963 2062 7569 6c64 0a20 2020  ecific build.   
+0000e5d0: 2020 2020 2069 6e73 7472 7563 7469 6f6e       instruction
+0000e5e0: 7320 7072 6f76 6964 6564 2077 6974 6869  s provided withi
+0000e5f0: 6e2e 2054 6869 7320 6973 2061 2070 7265  n. This is a pre
+0000e600: 2d72 6571 7569 7369 7465 2066 6f72 2072  -requisite for r
+0000e610: 656d 6f74 656c 7920 6578 6563 7574 696e  emotely executin
+0000e620: 6720 6120 6675 6e63 7469 6f6e 2c20 756e  g a function, un
+0000e630: 6c65 7373 2075 7369 6e67 0a20 2020 2020  less using.     
+0000e640: 2020 2061 2070 7265 2d64 6570 6c6f 7965     a pre-deploye
+0000e650: 6420 696d 6167 652e 0a0a 2020 2020 2020  d image...      
+0000e660: 2020 3a70 6172 616d 2066 756e 633a 2046    :param func: F
+0000e670: 756e 6374 696f 6e20 746f 2062 7569 6c64  unction to build
+0000e680: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0000e690: 2077 6974 685f 6d6c 7275 6e3a 2057 6865   with_mlrun: Whe
+0000e6a0: 7468 6572 2074 6f20 6164 6420 4d4c 5275  ther to add MLRu
+0000e6b0: 6e20 7061 636b 6167 6520 746f 2074 6865  n package to the
+0000e6c0: 2062 7569 6c74 2070 6163 6b61 6765 2e20   built package. 
+0000e6d0: 5468 6973 2069 7320 6e6f 7420 7265 7175  This is not requ
+0000e6e0: 6972 6564 2069 6620 7573 696e 6720 6120  ired if using a 
+0000e6f0: 6261 7365 0a20 2020 2020 2020 2020 2020  base.           
+0000e700: 2069 6d61 6765 2074 6861 7420 616c 7265   image that alre
+0000e710: 6164 7920 6861 7320 4d4c 5275 6e20 696e  ady has MLRun in
+0000e720: 2069 742e 0a20 2020 2020 2020 203a 7061   it..        :pa
+0000e730: 7261 6d20 6d6c 7275 6e5f 7665 7273 696f  ram mlrun_versio
+0000e740: 6e5f 7370 6563 6966 6965 723a 2056 6572  n_specifier: Ver
+0000e750: 7369 6f6e 206f 6620 4d4c 5275 6e20 746f  sion of MLRun to
+0000e760: 2069 6e63 6c75 6465 2069 6e20 7468 6520   include in the 
+0000e770: 6275 696c 7420 696d 6167 652e 0a20 2020  built image..   
+0000e780: 2020 2020 203a 7061 7261 6d20 736b 6970       :param skip
+0000e790: 5f64 6570 6c6f 7965 643a 2053 6b69 7020  _deployed: Skip 
+0000e7a0: 7468 6520 6275 696c 6420 6966 2077 6520  the build if we 
+0000e7b0: 616c 7265 6164 7920 6861 7665 2061 6e20  already have an 
+0000e7c0: 696d 6167 6520 666f 7220 7468 6520 6675  image for the fu
+0000e7d0: 6e63 7469 6f6e 2e0a 2020 2020 2020 2020  nction..        
+0000e7e0: 3a70 6172 616d 2062 7569 6c64 6572 5f65  :param builder_e
+0000e7f0: 6e76 3a20 2020 4b61 6e69 6b6f 2062 7569  nv:   Kaniko bui
+0000e800: 6c64 6572 2070 6f64 2065 6e76 2076 6172  lder pod env var
+0000e810: 7320 6469 6374 2028 666f 7220 636f 6e66  s dict (for conf
+0000e820: 6967 2f63 7265 6465 6e74 6961 6c73 290a  ig/credentials).
+0000e830: 2020 2020 2020 2020 3a70 6172 616d 2066          :param f
+0000e840: 6f72 6365 5f62 7569 6c64 3a20 2020 466f  orce_build:   Fo
+0000e850: 7263 6520 6275 696c 6469 6e67 2074 6865  rce building the
+0000e860: 2069 6d61 6765 2c20 6576 656e 2077 6865   image, even whe
+0000e870: 6e20 6e6f 2063 6861 6e67 6573 2077 6572  n no changes wer
+0000e880: 6520 6d61 6465 0a20 2020 2020 2020 2022  e made.        "
+0000e890: 2222 0a20 2020 2020 2020 2069 735f 7333  "".        is_s3
+0000e8a0: 5f73 6f75 7263 6520 3d20 6675 6e63 2e73  _source = func.s
+0000e8b0: 7065 632e 6275 696c 642e 736f 7572 6365  pec.build.source
+0000e8c0: 2061 6e64 2066 756e 632e 7370 6563 2e62   and func.spec.b
+0000e8d0: 7569 6c64 2e73 6f75 7263 652e 7374 6172  uild.source.star
+0000e8e0: 7473 7769 7468 280a 2020 2020 2020 2020  tswith(.        
+0000e8f0: 2020 2020 2273 333a 2f2f 220a 2020 2020      "s3://".    
+0000e900: 2020 2020 290a 2020 2020 2020 2020 6973      ).        is
+0000e910: 5f65 6372 5f69 6d61 6765 203d 206d 6c72  _ecr_image = mlr
+0000e920: 756e 2e75 7469 6c73 2e69 735f 6563 725f  un.utils.is_ecr_
+0000e930: 7572 6c28 636f 6e66 6967 2e68 7474 7064  url(config.httpd
+0000e940: 622e 6275 696c 6465 722e 646f 636b 6572  b.builder.docker
+0000e950: 5f72 6567 6973 7472 7929 0a20 2020 2020  _registry).     
+0000e960: 2020 2069 6620 6e6f 7420 6675 6e63 2e73     if not func.s
+0000e970: 7065 632e 6275 696c 642e 6c6f 6164 5f73  pec.build.load_s
+0000e980: 6f75 7263 655f 6f6e 5f72 756e 2061 6e64  ource_on_run and
+0000e990: 2069 735f 7333 5f73 6f75 7263 6520 616e   is_s3_source an
+0000e9a0: 6420 6973 5f65 6372 5f69 6d61 6765 3a0a  d is_ecr_image:.
+0000e9b0: 2020 2020 2020 2020 2020 2020 6c6f 6767              logg
+0000e9c0: 6572 2e77 6172 6e69 6e67 280a 2020 2020  er.warning(.    
+0000e9d0: 2020 2020 2020 2020 2020 2020 2242 7569              "Bui
+0000e9e0: 6c64 696e 6720 6120 6675 6e63 7469 6f6e  lding a function
+0000e9f0: 2069 6d61 6765 2074 6f20 4543 5220 616e   image to ECR an
+0000ea00: 6420 6c6f 6164 696e 6720 616e 2053 3320  d loading an S3 
+0000ea10: 736f 7572 6365 2074 6f20 7468 6520 696d  source to the im
+0000ea20: 6167 6520 6d61 7920 7265 7175 6972 6520  age may require 
+0000ea30: 636f 6e66 6c69 6374 696e 6720 6163 6365  conflicting acce
+0000ea40: 7373 2022 0a20 2020 2020 2020 2020 2020  ss ".           
+0000ea50: 2020 2020 2022 6b65 7973 2e20 4f6e 6c79       "keys. Only
+0000ea60: 2074 6865 2070 6572 6d69 7373 696f 6e73   the permissions
+0000ea70: 2067 7261 6e74 6564 2074 6f20 7468 6520   granted to the 
+0000ea80: 706c 6174 666f 726d 2773 2063 6f6e 6669  platform's confi
+0000ea90: 6775 7265 6420 7365 6372 6574 2077 696c  gured secret wil
+0000eaa0: 6c20 7461 6b65 2061 6666 6563 7420 220a  l take affect ".
+0000eab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000eac0: 2228 7365 6520 6d6c 7275 6e2e 636f 6e66  "(see mlrun.conf
+0000ead0: 6967 2e63 6f6e 6669 672e 6874 7470 6462  ig.config.httpdb
+0000eae0: 2e62 7569 6c64 6572 2e64 6f63 6b65 725f  .builder.docker_
+0000eaf0: 7265 6769 7374 7279 5f73 6563 7265 7429  registry_secret)
+0000eb00: 2e20 220a 2020 2020 2020 2020 2020 2020  . ".            
+0000eb10: 2020 2020 2249 6e20 6361 7365 2074 6865      "In case the
+0000eb20: 2070 6572 6d69 7373 696f 6e73 2061 7265   permissions are
+0000eb30: 206c 696d 6974 6564 2074 6f20 4543 5220   limited to ECR 
+0000eb40: 7363 6f70 652c 2079 6f75 206d 6179 2075  scope, you may u
+0000eb50: 7365 2070 756c 6c5f 6174 5f72 756e 7469  se pull_at_runti
+0000eb60: 6d65 3d54 7275 6520 696e 7374 6561 6422  me=True instead"
+0000eb70: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000eb80: 2020 736f 7572 6365 3d66 756e 632e 7370    source=func.sp
+0000eb90: 6563 2e62 7569 6c64 2e73 6f75 7263 652c  ec.build.source,
+0000eba0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ebb0: 206c 6f61 645f 736f 7572 6365 5f6f 6e5f   load_source_on_
+0000ebc0: 7275 6e3d 6675 6e63 2e73 7065 632e 6275  run=func.spec.bu
+0000ebd0: 696c 642e 6c6f 6164 5f73 6f75 7263 655f  ild.load_source_
+0000ebe0: 6f6e 5f72 756e 2c0a 2020 2020 2020 2020  on_run,.        
+0000ebf0: 2020 2020 2020 2020 6465 6661 756c 745f          default_
+0000ec00: 646f 636b 6572 5f72 6567 6973 7472 793d  docker_registry=
+0000ec10: 636f 6e66 6967 2e68 7474 7064 622e 6275  config.httpdb.bu
+0000ec20: 696c 6465 722e 646f 636b 6572 5f72 6567  ilder.docker_reg
+0000ec30: 6973 7472 792c 0a20 2020 2020 2020 2020  istry,.         
+0000ec40: 2020 2029 0a0a 2020 2020 2020 2020 7472     )..        tr
+0000ec50: 793a 0a20 2020 2020 2020 2020 2020 2072  y:.            r
+0000ec60: 6571 203d 207b 0a20 2020 2020 2020 2020  eq = {.         
+0000ec70: 2020 2020 2020 2022 6675 6e63 7469 6f6e         "function
+0000ec80: 223a 2066 756e 632e 746f 5f64 6963 7428  ": func.to_dict(
+0000ec90: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+0000eca0: 2020 2022 7769 7468 5f6d 6c72 756e 223a     "with_mlrun":
+0000ecb0: 2062 6f6f 6c32 7374 7228 7769 7468 5f6d   bool2str(with_m
+0000ecc0: 6c72 756e 292c 0a20 2020 2020 2020 2020  lrun),.         
+0000ecd0: 2020 2020 2020 2022 736b 6970 5f64 6570         "skip_dep
+0000ece0: 6c6f 7965 6422 3a20 736b 6970 5f64 6570  loyed": skip_dep
+0000ecf0: 6c6f 7965 642c 0a20 2020 2020 2020 2020  loyed,.         
+0000ed00: 2020 2020 2020 2022 666f 7263 655f 6275         "force_bu
+0000ed10: 696c 6422 3a20 666f 7263 655f 6275 696c  ild": force_buil
+0000ed20: 642c 0a20 2020 2020 2020 2020 2020 207d  d,.            }
+0000ed30: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0000ed40: 6d6c 7275 6e5f 7665 7273 696f 6e5f 7370  mlrun_version_sp
+0000ed50: 6563 6966 6965 723a 0a20 2020 2020 2020  ecifier:.       
+0000ed60: 2020 2020 2020 2020 2072 6571 5b22 6d6c           req["ml
+0000ed70: 7275 6e5f 7665 7273 696f 6e5f 7370 6563  run_version_spec
+0000ed80: 6966 6965 7222 5d20 3d20 6d6c 7275 6e5f  ifier"] = mlrun_
+0000ed90: 7665 7273 696f 6e5f 7370 6563 6966 6965  version_specifie
+0000eda0: 720a 2020 2020 2020 2020 2020 2020 6966  r.            if
+0000edb0: 2062 7569 6c64 6572 5f65 6e76 3a0a 2020   builder_env:.  
+0000edc0: 2020 2020 2020 2020 2020 2020 2020 7265                re
+0000edd0: 715b 2262 7569 6c64 6572 5f65 6e76 225d  q["builder_env"]
+0000ede0: 203d 2062 7569 6c64 6572 5f65 6e76 0a20   = builder_env. 
+0000edf0: 2020 2020 2020 2020 2020 2072 6573 7020             resp 
+0000ee00: 3d20 7365 6c66 2e61 7069 5f63 616c 6c28  = self.api_call(
+0000ee10: 2250 4f53 5422 2c20 2262 7569 6c64 2f66  "POST", "build/f
+0000ee20: 756e 6374 696f 6e22 2c20 6a73 6f6e 3d72  unction", json=r
+0000ee30: 6571 290a 2020 2020 2020 2020 6578 6365  eq).        exce
+0000ee40: 7074 204f 5345 7272 6f72 2061 7320 6572  pt OSError as er
+0000ee50: 723a 0a20 2020 2020 2020 2020 2020 206c  r:.            l
+0000ee60: 6f67 6765 722e 6572 726f 7228 6622 6572  ogger.error(f"er
+0000ee70: 726f 7220 7375 626d 6974 7469 6e67 2062  ror submitting b
+0000ee80: 7569 6c64 2074 6173 6b3a 207b 6572 725f  uild task: {err_
+0000ee90: 746f 5f73 7472 2865 7272 297d 2229 0a20  to_str(err)}"). 
+0000eea0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0000eeb0: 204f 5345 7272 6f72 2866 2265 7272 6f72   OSError(f"error
+0000eec0: 3a20 6361 6e6e 6f74 2073 7562 6d69 7420  : cannot submit 
+0000eed0: 6275 696c 642c 207b 6572 725f 746f 5f73  build, {err_to_s
+0000eee0: 7472 2865 7272 297d 2229 0a0a 2020 2020  tr(err)}")..    
+0000eef0: 2020 2020 6966 206e 6f74 2072 6573 702e      if not resp.
+0000ef00: 6f6b 3a0a 2020 2020 2020 2020 2020 2020  ok:.            
+0000ef10: 6c6f 6767 6572 2e65 7272 6f72 2866 2262  logger.error(f"b
+0000ef20: 6164 2072 6573 7021 215c 6e7b 7265 7370  ad resp!!\n{resp
+0000ef30: 2e74 6578 747d 2229 0a20 2020 2020 2020  .text}").       
+0000ef40: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+0000ef50: 4572 726f 7228 2262 6164 2066 756e 6374  Error("bad funct
+0000ef60: 696f 6e20 7275 6e20 7265 7370 6f6e 7365  ion run response
+0000ef70: 2229 0a0a 2020 2020 2020 2020 7265 7475  ")..        retu
+0000ef80: 726e 2072 6573 702e 6a73 6f6e 2829 0a0a  rn resp.json()..
+0000ef90: 2020 2020 6465 6620 6765 745f 6275 696c      def get_buil
+0000efa0: 6465 725f 7374 6174 7573 280a 2020 2020  der_status(.    
+0000efb0: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+0000efc0: 2020 6675 6e63 3a20 4261 7365 5275 6e74    func: BaseRunt
+0000efd0: 696d 652c 0a20 2020 2020 2020 206f 6666  ime,.        off
+0000efe0: 7365 743a 2069 6e74 203d 2030 2c0a 2020  set: int = 0,.  
+0000eff0: 2020 2020 2020 6c6f 6773 3a20 626f 6f6c        logs: bool
+0000f000: 203d 2054 7275 652c 0a20 2020 2020 2020   = True,.       
+0000f010: 206c 6173 745f 6c6f 675f 7469 6d65 7374   last_log_timest
+0000f020: 616d 703a 2066 6c6f 6174 203d 2030 2e30  amp: float = 0.0
+0000f030: 2c0a 2020 2020 2020 2020 7665 7262 6f73  ,.        verbos
+0000f040: 653a 2062 6f6f 6c20 3d20 4661 6c73 652c  e: bool = False,
+0000f050: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
+0000f060: 2222 2252 6574 7269 6576 6520 7468 6520  """Retrieve the 
+0000f070: 7374 6174 7573 206f 6620 6120 6275 696c  status of a buil
+0000f080: 6420 6f70 6572 6174 696f 6e20 6375 7272  d operation curr
+0000f090: 656e 746c 7920 696e 2070 726f 6772 6573  ently in progres
+0000f0a0: 732e 0a0a 2020 2020 2020 2020 3a70 6172  s...        :par
+0000f0b0: 616d 2066 756e 633a 2020 2020 2020 2020  am func:        
+0000f0c0: 2020 2020 2020 2020 4675 6e63 7469 6f6e          Function
+0000f0d0: 206f 626a 6563 7420 7468 6174 2069 7320   object that is 
+0000f0e0: 6265 696e 6720 6275 696c 742e 0a20 2020  being built..   
+0000f0f0: 2020 2020 203a 7061 7261 6d20 6f66 6673       :param offs
+0000f100: 6574 3a20 2020 2020 2020 2020 2020 2020  et:             
+0000f110: 204f 6666 7365 7420 696e 746f 2074 6865   Offset into the
+0000f120: 2062 7569 6c64 206c 6f67 7320 746f 2072   build logs to r
+0000f130: 6574 7269 6576 6520 6c6f 6773 2066 726f  etrieve logs fro
+0000f140: 6d2e 0a20 2020 2020 2020 203a 7061 7261  m..        :para
+0000f150: 6d20 6c6f 6773 3a20 2020 2020 2020 2020  m logs:         
+0000f160: 2020 2020 2020 2053 686f 756c 6420 6275         Should bu
+0000f170: 696c 6420 6c6f 6773 2062 6520 7265 7472  ild logs be retr
+0000f180: 6965 7665 642e 0a20 2020 2020 2020 203a  ieved..        :
+0000f190: 7061 7261 6d20 6c61 7374 5f6c 6f67 5f74  param last_log_t
+0000f1a0: 696d 6573 7461 6d70 3a20 204c 6173 7420  imestamp:  Last 
+0000f1b0: 7469 6d65 7374 616d 7020 6f66 206c 6f67  timestamp of log
+0000f1c0: 7320 7468 6174 2077 6572 6520 616c 7265  s that were alre
+0000f1d0: 6164 7920 7265 7472 6965 7665 642e 2046  ady retrieved. F
+0000f1e0: 756e 6374 696f 6e20 7769 6c6c 2072 6574  unction will ret
+0000f1f0: 7572 6e20 6f6e 6c79 206c 6f67 730a 2020  urn only logs.  
+0000f200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f220: 2020 6c61 7465 7220 7468 616e 2074 6869    later than thi
+0000f230: 7320 7061 7261 6d65 7465 722e 0a20 2020  s parameter..   
+0000f240: 2020 2020 203a 7061 7261 6d20 7665 7262       :param verb
+0000f250: 6f73 653a 2020 2020 2020 2020 2020 2020  ose:            
+0000f260: 2041 6464 2076 6572 626f 7365 206c 6f67   Add verbose log
+0000f270: 7320 696e 746f 2074 6865 206f 7574 7075  s into the outpu
+0000f280: 742e 0a0a 2020 2020 2020 2020 3a72 6574  t...        :ret
+0000f290: 7572 6e73 3a20 5468 6520 666f 6c6c 6f77  urns: The follow
+0000f2a0: 696e 6720 7061 7261 6d65 7465 7273 3a0a  ing parameters:.
+0000f2b0: 0a20 2020 2020 2020 2020 2020 202d 2054  .            - T
+0000f2c0: 6578 7420 6f66 2062 7569 6c64 6572 206c  ext of builder l
+0000f2d0: 6f67 732e 0a20 2020 2020 2020 2020 2020  ogs..           
+0000f2e0: 202d 2054 696d 6573 7461 6d70 206f 6620   - Timestamp of 
+0000f2f0: 6c61 7374 206c 6f67 2072 6574 7269 6576  last log retriev
+0000f300: 6564 2c20 746f 2062 6520 7573 6564 2069  ed, to be used i
+0000f310: 6e20 7375 6273 6571 7565 6e74 2063 616c  n subsequent cal
+0000f320: 6c73 2074 6f20 7468 6973 2066 756e 6374  ls to this funct
+0000f330: 696f 6e2e 0a0a 2020 2020 2020 2020 2020  ion...          
+0000f340: 2020 5468 6520 6675 6e63 7469 6f6e 2061    The function a
+0000f350: 6c73 6f20 7570 6461 7465 7320 696e 7465  lso updates inte
+0000f360: 726e 616c 206d 656d 6265 7273 206f 6620  rnal members of 
+0000f370: 7468 6520 6060 6675 6e63 6060 206f 626a  the ``func`` obj
+0000f380: 6563 7420 746f 2072 6566 6c65 6374 2062  ect to reflect b
+0000f390: 7569 6c64 2070 726f 6365 7373 2069 6e66  uild process inf
+0000f3a0: 6f2e 0a20 2020 2020 2020 2022 2222 0a0a  o..        """..
+0000f3b0: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
+0000f3c0: 2020 2020 2020 2020 2070 6172 616d 7320           params 
+0000f3d0: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
+0000f3e0: 2020 2020 226e 616d 6522 3a20 6e6f 726d      "name": norm
+0000f3f0: 616c 697a 655f 6e61 6d65 2866 756e 632e  alize_name(func.
+0000f400: 6d65 7461 6461 7461 2e6e 616d 6529 2c0a  metadata.name),.
+0000f410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f420: 2270 726f 6a65 6374 223a 2066 756e 632e  "project": func.
+0000f430: 6d65 7461 6461 7461 2e70 726f 6a65 6374  metadata.project
+0000f440: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000f450: 2020 2274 6167 223a 2066 756e 632e 6d65    "tag": func.me
+0000f460: 7461 6461 7461 2e74 6167 2c0a 2020 2020  tadata.tag,.    
+0000f470: 2020 2020 2020 2020 2020 2020 226c 6f67              "log
+0000f480: 7322 3a20 626f 6f6c 3273 7472 286c 6f67  s": bool2str(log
+0000f490: 7329 2c0a 2020 2020 2020 2020 2020 2020  s),.            
+0000f4a0: 2020 2020 226f 6666 7365 7422 3a20 7374      "offset": st
+0000f4b0: 7228 6f66 6673 6574 292c 0a20 2020 2020  r(offset),.     
+0000f4c0: 2020 2020 2020 2020 2020 2022 6c61 7374             "last
+0000f4d0: 5f6c 6f67 5f74 696d 6573 7461 6d70 223a  _log_timestamp":
+0000f4e0: 2073 7472 286c 6173 745f 6c6f 675f 7469   str(last_log_ti
+0000f4f0: 6d65 7374 616d 7029 2c0a 2020 2020 2020  mestamp),.      
+0000f500: 2020 2020 2020 2020 2020 2276 6572 626f            "verbo
+0000f510: 7365 223a 2062 6f6f 6c32 7374 7228 7665  se": bool2str(ve
+0000f520: 7262 6f73 6529 2c0a 2020 2020 2020 2020  rbose),.        
+0000f530: 2020 2020 7d0a 2020 2020 2020 2020 2020      }.          
+0000f540: 2020 7265 7370 203d 2073 656c 662e 6170    resp = self.ap
+0000f550: 695f 6361 6c6c 2822 4745 5422 2c20 2262  i_call("GET", "b
+0000f560: 7569 6c64 2f73 7461 7475 7322 2c20 7061  uild/status", pa
+0000f570: 7261 6d73 3d70 6172 616d 7329 0a20 2020  rams=params).   
+0000f580: 2020 2020 2065 7863 6570 7420 4f53 4572       except OSEr
+0000f590: 726f 7220 6173 2065 7272 3a0a 2020 2020  ror as err:.    
+0000f5a0: 2020 2020 2020 2020 6c6f 6767 6572 2e65          logger.e
+0000f5b0: 7272 6f72 2866 2265 7272 6f72 2067 6574  rror(f"error get
+0000f5c0: 7469 6e67 2062 7569 6c64 2073 7461 7475  ting build statu
+0000f5d0: 733a 207b 6572 725f 746f 5f73 7472 2865  s: {err_to_str(e
+0000f5e0: 7272 297d 2229 0a20 2020 2020 2020 2020  rr)}").         
+0000f5f0: 2020 2072 6169 7365 204f 5345 7272 6f72     raise OSError
+0000f600: 2866 2265 7272 6f72 3a20 6361 6e6e 6f74  (f"error: cannot
+0000f610: 2067 6574 2062 7569 6c64 2073 7461 7475   get build statu
+0000f620: 732c 207b 6572 725f 746f 5f73 7472 2865  s, {err_to_str(e
+0000f630: 7272 297d 2229 0a0a 2020 2020 2020 2020  rr)}")..        
+0000f640: 6966 206e 6f74 2072 6573 702e 6f6b 3a0a  if not resp.ok:.
+0000f650: 2020 2020 2020 2020 2020 2020 6c6f 6767              logg
+0000f660: 6572 2e77 6172 6e69 6e67 2866 2266 6169  er.warning(f"fai
+0000f670: 6c65 6420 7265 7370 2c20 7b72 6573 702e  led resp, {resp.
+0000f680: 7465 7874 7d22 290a 2020 2020 2020 2020  text}").        
+0000f690: 2020 2020 7261 6973 6520 5275 6e44 4245      raise RunDBE
+0000f6a0: 7272 6f72 2822 6261 6420 6675 6e63 7469  rror("bad functi
+0000f6b0: 6f6e 2062 7569 6c64 2072 6573 706f 6e73  on build respons
+0000f6c0: 6522 290a 0a20 2020 2020 2020 2069 6620  e")..        if 
+0000f6d0: 7265 7370 2e68 6561 6465 7273 3a0a 2020  resp.headers:.  
+0000f6e0: 2020 2020 2020 2020 2020 6675 6e63 2e73            func.s
+0000f6f0: 7461 7475 732e 7374 6174 6520 3d20 7265  tatus.state = re
+0000f700: 7370 2e68 6561 6465 7273 2e67 6574 2822  sp.headers.get("
+0000f710: 782d 6d6c 7275 6e2d 6675 6e63 7469 6f6e  x-mlrun-function
+0000f720: 2d73 7461 7475 7322 2c20 2222 290a 2020  -status", "").  
+0000f730: 2020 2020 2020 2020 2020 6c61 7374 5f6c            last_l
+0000f740: 6f67 5f74 696d 6573 7461 6d70 203d 2066  og_timestamp = f
+0000f750: 6c6f 6174 280a 2020 2020 2020 2020 2020  loat(.          
+0000f760: 2020 2020 2020 7265 7370 2e68 6561 6465        resp.heade
+0000f770: 7273 2e67 6574 2822 782d 6d6c 7275 6e2d  rs.get("x-mlrun-
+0000f780: 6c61 7374 2d74 696d 6573 7461 6d70 222c  last-timestamp",
+0000f790: 2022 302e 3022 290a 2020 2020 2020 2020   "0.0").        
+0000f7a0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+0000f7b0: 2020 6966 2066 756e 632e 6b69 6e64 2069    if func.kind i
+0000f7c0: 6e20 6d6c 7275 6e2e 7275 6e74 696d 6573  n mlrun.runtimes
+0000f7d0: 2e52 756e 7469 6d65 4b69 6e64 732e 6e75  .RuntimeKinds.nu
+0000f7e0: 636c 696f 5f72 756e 7469 6d65 7328 293a  clio_runtimes():
+0000f7f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000f800: 2066 756e 632e 7374 6174 7573 2e61 6464   func.status.add
+0000f810: 7265 7373 203d 2072 6573 702e 6865 6164  ress = resp.head
+0000f820: 6572 732e 6765 7428 2278 2d6d 6c72 756e  ers.get("x-mlrun
+0000f830: 2d61 6464 7265 7373 222c 2022 2229 0a20  -address", ""). 
+0000f840: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0000f850: 756e 632e 7374 6174 7573 2e6e 7563 6c69  unc.status.nucli
+0000f860: 6f5f 6e61 6d65 203d 2072 6573 702e 6865  o_name = resp.he
+0000f870: 6164 6572 732e 6765 7428 2278 2d6d 6c72  aders.get("x-mlr
+0000f880: 756e 2d6e 616d 6522 2c20 2222 290a 2020  un-name", "").  
+0000f890: 2020 2020 2020 2020 2020 2020 2020 6675                fu
+0000f8a0: 6e63 2e73 7461 7475 732e 696e 7465 726e  nc.status.intern
+0000f8b0: 616c 5f69 6e76 6f63 6174 696f 6e5f 7572  al_invocation_ur
+0000f8c0: 6c73 203d 2072 6573 702e 6865 6164 6572  ls = resp.header
+0000f8d0: 732e 6765 7428 0a20 2020 2020 2020 2020  s.get(.         
+0000f8e0: 2020 2020 2020 2020 2020 2022 782d 6d6c             "x-ml
+0000f8f0: 7275 6e2d 696e 7465 726e 616c 2d69 6e76  run-internal-inv
+0000f900: 6f63 6174 696f 6e2d 7572 6c73 222c 2022  ocation-urls", "
+0000f910: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+0000f920: 2020 292e 7370 6c69 7428 222c 2229 0a20    ).split(","). 
+0000f930: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0000f940: 756e 632e 7374 6174 7573 2e65 7874 6572  unc.status.exter
+0000f950: 6e61 6c5f 696e 766f 6361 7469 6f6e 5f75  nal_invocation_u
+0000f960: 726c 7320 3d20 7265 7370 2e68 6561 6465  rls = resp.heade
+0000f970: 7273 2e67 6574 280a 2020 2020 2020 2020  rs.get(.        
+0000f980: 2020 2020 2020 2020 2020 2020 2278 2d6d              "x-m
+0000f990: 6c72 756e 2d65 7874 6572 6e61 6c2d 696e  lrun-external-in
+0000f9a0: 766f 6361 7469 6f6e 2d75 726c 7322 2c20  vocation-urls", 
+0000f9b0: 2222 0a20 2020 2020 2020 2020 2020 2020  "".             
+0000f9c0: 2020 2029 2e73 706c 6974 2822 2c22 290a     ).split(",").
+0000f9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f9e0: 6675 6e63 2e73 7461 7475 732e 636f 6e74  func.status.cont
+0000f9f0: 6169 6e65 725f 696d 6167 6520 3d20 7265  ainer_image = re
+0000fa00: 7370 2e68 6561 6465 7273 2e67 6574 280a  sp.headers.get(.
+0000fa10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fa20: 2020 2020 2278 2d6d 6c72 756e 2d63 6f6e      "x-mlrun-con
+0000fa30: 7461 696e 6572 2d69 6d61 6765 222c 2022  tainer-image", "
+0000fa40: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+0000fa50: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+0000fa60: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0000fa70: 2020 2020 2020 6675 6e63 2e73 7461 7475        func.statu
+0000fa80: 732e 6275 696c 645f 706f 6420 3d20 7265  s.build_pod = re
+0000fa90: 7370 2e68 6561 6465 7273 2e67 6574 2822  sp.headers.get("
+0000faa0: 6275 696c 6465 725f 706f 6422 2c20 2222  builder_pod", ""
+0000fab0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0000fac0: 2020 6675 6e63 2e73 7065 632e 696d 6167    func.spec.imag
+0000fad0: 6520 3d20 7265 7370 2e68 6561 6465 7273  e = resp.headers
+0000fae0: 2e67 6574 2822 6675 6e63 7469 6f6e 5f69  .get("function_i
+0000faf0: 6d61 6765 222c 2022 2229 0a0a 2020 2020  mage", "")..    
+0000fb00: 2020 2020 7465 7874 203d 2022 220a 2020      text = "".  
+0000fb10: 2020 2020 2020 6966 2072 6573 702e 636f        if resp.co
+0000fb20: 6e74 656e 743a 0a20 2020 2020 2020 2020  ntent:.         
+0000fb30: 2020 2074 6578 7420 3d20 7265 7370 2e63     text = resp.c
+0000fb40: 6f6e 7465 6e74 2e64 6563 6f64 6528 290a  ontent.decode().
+0000fb50: 2020 2020 2020 2020 7265 7475 726e 2074          return t
+0000fb60: 6578 742c 206c 6173 745f 6c6f 675f 7469  ext, last_log_ti
+0000fb70: 6d65 7374 616d 700a 0a20 2020 2064 6566  mestamp..    def
+0000fb80: 2073 7461 7274 5f66 756e 6374 696f 6e28   start_function(
+0000fb90: 0a20 2020 2020 2020 2073 656c 662c 2066  .        self, f
+0000fba0: 756e 635f 7572 6c3a 2073 7472 203d 204e  unc_url: str = N
+0000fbb0: 6f6e 652c 2066 756e 6374 696f 6e3a 2022  one, function: "
+0000fbc0: 6d6c 7275 6e2e 7275 6e74 696d 6573 2e42  mlrun.runtimes.B
+0000fbd0: 6173 6552 756e 7469 6d65 2220 3d20 4e6f  aseRuntime" = No
+0000fbe0: 6e65 0a20 2020 2029 202d 3e20 6d6c 7275  ne.    ) -> mlru
+0000fbf0: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
+0000fc00: 2e42 6163 6b67 726f 756e 6454 6173 6b3a  .BackgroundTask:
+0000fc10: 0a20 2020 2020 2020 2022 2222 4578 6563  .        """Exec
+0000fc20: 7574 6520 6120 6675 6e63 7469 6f6e 2072  ute a function r
+0000fc30: 656d 6f74 656c 792c 2055 7365 6420 666f  emotely, Used fo
+0000fc40: 7220 6060 6461 736b 6060 2066 756e 6374  r ``dask`` funct
+0000fc50: 696f 6e73 2e0a 0a20 2020 2020 2020 203a  ions...        :
+0000fc60: 7061 7261 6d20 6675 6e63 5f75 726c 3a20  param func_url: 
+0000fc70: 5552 4c20 746f 2074 6865 2066 756e 6374  URL to the funct
+0000fc80: 696f 6e20 746f 2062 6520 6578 6563 7574  ion to be execut
+0000fc90: 6564 2e0a 2020 2020 2020 2020 3a70 6172  ed..        :par
+0000fca0: 616d 2066 756e 6374 696f 6e3a 2054 6865  am function: The
+0000fcb0: 2066 756e 6374 696f 6e20 6f62 6a65 6374   function object
+0000fcc0: 2074 6f20 7374 6172 742c 206e 6f74 206e   to start, not n
+0000fcd0: 6565 6465 6420 6865 7265 2e0a 2020 2020  eeded here..    
+0000fce0: 2020 2020 3a72 6574 7572 6e73 3a20 4120      :returns: A 
+0000fcf0: 4261 636b 6772 6f75 6e64 5461 736b 206f  BackgroundTask o
+0000fd00: 626a 6563 742c 2077 6974 6820 6465 7461  bject, with deta
+0000fd10: 696c 7320 6f6e 2065 7865 6375 7469 6f6e  ils on execution
+0000fd20: 2070 726f 6365 7373 2061 6e64 2069 7473   process and its
+0000fd30: 2073 7461 7475 732e 0a20 2020 2020 2020   status..       
+0000fd40: 2022 2222 0a0a 2020 2020 2020 2020 7472   """..        tr
+0000fd50: 793a 0a20 2020 2020 2020 2020 2020 2072  y:.            r
+0000fd60: 6571 203d 207b 2266 756e 6374 696f 6e55  eq = {"functionU
+0000fd70: 726c 223a 2066 756e 635f 7572 6c7d 0a20  rl": func_url}. 
+0000fd80: 2020 2020 2020 2020 2020 2072 6573 7020             resp 
+0000fd90: 3d20 7365 6c66 2e61 7069 5f63 616c 6c28  = self.api_call(
+0000fda0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000fdb0: 2022 504f 5354 222c 0a20 2020 2020 2020   "POST",.       
+0000fdc0: 2020 2020 2020 2020 2022 7374 6172 742f           "start/
+0000fdd0: 6675 6e63 7469 6f6e 222c 0a20 2020 2020  function",.     
+0000fde0: 2020 2020 2020 2020 2020 206a 736f 6e3d             json=
+0000fdf0: 7265 712c 0a20 2020 2020 2020 2020 2020  req,.           
+0000fe00: 2020 2020 2074 696d 656f 7574 3d69 6e74       timeout=int
+0000fe10: 2863 6f6e 6669 672e 7375 626d 6974 5f74  (config.submit_t
+0000fe20: 696d 656f 7574 2920 6f72 2036 302c 0a20  imeout) or 60,. 
+0000fe30: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0000fe40: 2020 2020 2065 7863 6570 7420 4f53 4572       except OSEr
+0000fe50: 726f 7220 6173 2065 7272 3a0a 2020 2020  ror as err:.    
+0000fe60: 2020 2020 2020 2020 6c6f 6767 6572 2e65          logger.e
+0000fe70: 7272 6f72 2866 2265 7272 6f72 2073 7461  rror(f"error sta
+0000fe80: 7274 696e 6720 6675 6e63 7469 6f6e 3a20  rting function: 
+0000fe90: 7b65 7272 5f74 6f5f 7374 7228 6572 7229  {err_to_str(err)
+0000fea0: 7d22 290a 2020 2020 2020 2020 2020 2020  }").            
+0000feb0: 7261 6973 6520 4f53 4572 726f 7228 6622  raise OSError(f"
+0000fec0: 6572 726f 723a 2063 616e 6e6f 7420 7374  error: cannot st
+0000fed0: 6172 7420 6675 6e63 7469 6f6e 2c20 7b65  art function, {e
+0000fee0: 7272 5f74 6f5f 7374 7228 6572 7229 7d22  rr_to_str(err)}"
+0000fef0: 290a 0a20 2020 2020 2020 2069 6620 6e6f  )..        if no
+0000ff00: 7420 7265 7370 2e6f 6b3a 0a20 2020 2020  t resp.ok:.     
+0000ff10: 2020 2020 2020 206c 6f67 6765 722e 6572         logger.er
+0000ff20: 726f 7228 6622 6261 6420 7265 7370 2121  ror(f"bad resp!!
+0000ff30: 5c6e 7b72 6573 702e 7465 7874 7d22 290a  \n{resp.text}").
+0000ff40: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0000ff50: 6520 5661 6c75 6545 7272 6f72 2822 6261  e ValueError("ba
+0000ff60: 6420 6675 6e63 7469 6f6e 2073 7461 7274  d function start
+0000ff70: 2072 6573 706f 6e73 6522 290a 0a20 2020   response")..   
+0000ff80: 2020 2020 2072 6574 7572 6e20 6d6c 7275       return mlru
+0000ff90: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
+0000ffa0: 2e42 6163 6b67 726f 756e 6454 6173 6b28  .BackgroundTask(
+0000ffb0: 2a2a 7265 7370 2e6a 736f 6e28 2929 0a0a  **resp.json())..
+0000ffc0: 2020 2020 6465 6620 6765 745f 7072 6f6a      def get_proj
+0000ffd0: 6563 745f 6261 636b 6772 6f75 6e64 5f74  ect_background_t
+0000ffe0: 6173 6b28 0a20 2020 2020 2020 2073 656c  ask(.        sel
+0000fff0: 662c 0a20 2020 2020 2020 2070 726f 6a65  f,.        proje
+00010000: 6374 3a20 7374 722c 0a20 2020 2020 2020  ct: str,.       
+00010010: 206e 616d 653a 2073 7472 2c0a 2020 2020   name: str,.    
+00010020: 2920 2d3e 206d 6c72 756e 2e63 6f6d 6d6f  ) -> mlrun.commo
+00010030: 6e2e 7363 6865 6d61 732e 4261 636b 6772  n.schemas.Backgr
+00010040: 6f75 6e64 5461 736b 3a0a 2020 2020 2020  oundTask:.      
+00010050: 2020 2222 2252 6574 7269 6576 6520 7570    """Retrieve up
+00010060: 6461 7465 6420 696e 666f 726d 6174 696f  dated informatio
+00010070: 6e20 6f6e 2061 2070 726f 6a65 6374 2062  n on a project b
+00010080: 6163 6b67 726f 756e 6420 7461 736b 2062  ackground task b
+00010090: 6569 6e67 2065 7865 6375 7465 642e 2222  eing executed.""
+000100a0: 220a 0a20 2020 2020 2020 2070 726f 6a65  "..        proje
+000100b0: 6374 203d 2070 726f 6a65 6374 206f 7220  ct = project or 
+000100c0: 636f 6e66 6967 2e64 6566 6175 6c74 5f70  config.default_p
+000100d0: 726f 6a65 6374 0a20 2020 2020 2020 2070  roject.        p
+000100e0: 6174 6820 3d20 6622 7072 6f6a 6563 7473  ath = f"projects
+000100f0: 2f7b 7072 6f6a 6563 747d 2f62 6163 6b67  /{project}/backg
+00010100: 726f 756e 642d 7461 736b 732f 7b6e 616d  round-tasks/{nam
+00010110: 657d 220a 2020 2020 2020 2020 6572 726f  e}".        erro
+00010120: 725f 6d65 7373 6167 6520 3d20 280a 2020  r_message = (.  
+00010130: 2020 2020 2020 2020 2020 6622 4661 696c            f"Fail
+00010140: 6564 2067 6574 7469 6e67 2070 726f 6a65  ed getting proje
+00010150: 6374 2062 6163 6b67 726f 756e 6420 7461  ct background ta
+00010160: 736b 2e20 7072 6f6a 6563 743d 7b70 726f  sk. project={pro
+00010170: 6a65 6374 7d2c 206e 616d 653d 7b6e 616d  ject}, name={nam
+00010180: 657d 220a 2020 2020 2020 2020 290a 2020  e}".        ).  
+00010190: 2020 2020 2020 7265 7370 6f6e 7365 203d        response =
+000101a0: 2073 656c 662e 6170 695f 6361 6c6c 2822   self.api_call("
+000101b0: 4745 5422 2c20 7061 7468 2c20 6572 726f  GET", path, erro
+000101c0: 725f 6d65 7373 6167 6529 0a20 2020 2020  r_message).     
+000101d0: 2020 2072 6574 7572 6e20 6d6c 7275 6e2e     return mlrun.
+000101e0: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e42  common.schemas.B
+000101f0: 6163 6b67 726f 756e 6454 6173 6b28 2a2a  ackgroundTask(**
+00010200: 7265 7370 6f6e 7365 2e6a 736f 6e28 2929  response.json())
+00010210: 0a0a 2020 2020 6465 6620 6c69 7374 5f70  ..    def list_p
+00010220: 726f 6a65 6374 5f62 6163 6b67 726f 756e  roject_backgroun
+00010230: 645f 7461 736b 7328 0a20 2020 2020 2020  d_tasks(.       
+00010240: 2073 656c 662c 0a20 2020 2020 2020 2070   self,.        p
+00010250: 726f 6a65 6374 3a20 4f70 7469 6f6e 616c  roject: Optional
+00010260: 5b73 7472 5d20 3d20 4e6f 6e65 2c0a 2020  [str] = None,.  
+00010270: 2020 2020 2020 7374 6174 653a 204f 7074        state: Opt
+00010280: 696f 6e61 6c5b 7374 725d 203d 204e 6f6e  ional[str] = Non
+00010290: 652c 0a20 2020 2020 2020 2063 7265 6174  e,.        creat
+000102a0: 6564 5f66 726f 6d3a 204f 7074 696f 6e61  ed_from: Optiona
+000102b0: 6c5b 6461 7465 7469 6d65 5d20 3d20 4e6f  l[datetime] = No
+000102c0: 6e65 2c0a 2020 2020 2020 2020 6372 6561  ne,.        crea
+000102d0: 7465 645f 746f 3a20 4f70 7469 6f6e 616c  ted_to: Optional
+000102e0: 5b64 6174 6574 696d 655d 203d 204e 6f6e  [datetime] = Non
+000102f0: 652c 0a20 2020 2020 2020 206c 6173 745f  e,.        last_
+00010300: 7570 6461 7465 5f74 696d 655f 6672 6f6d  update_time_from
+00010310: 3a20 4f70 7469 6f6e 616c 5b64 6174 6574  : Optional[datet
+00010320: 696d 655d 203d 204e 6f6e 652c 0a20 2020  ime] = None,.   
+00010330: 2020 2020 206c 6173 745f 7570 6461 7465       last_update
+00010340: 5f74 696d 655f 746f 3a20 4f70 7469 6f6e  _time_to: Option
+00010350: 616c 5b64 6174 6574 696d 655d 203d 204e  al[datetime] = N
+00010360: 6f6e 652c 0a20 2020 2029 202d 3e20 6c69  one,.    ) -> li
+00010370: 7374 5b6d 6c72 756e 2e63 6f6d 6d6f 6e2e  st[mlrun.common.
+00010380: 7363 6865 6d61 732e 4261 636b 6772 6f75  schemas.Backgrou
+00010390: 6e64 5461 736b 5d3a 0a20 2020 2020 2020  ndTask]:.       
+000103a0: 2022 2222 0a20 2020 2020 2020 2052 6574   """.        Ret
+000103b0: 7269 6576 6520 7570 6461 7465 6420 696e  rieve updated in
+000103c0: 666f 726d 6174 696f 6e20 6f6e 2070 726f  formation on pro
+000103d0: 6a65 6374 2062 6163 6b67 726f 756e 6420  ject background 
+000103e0: 7461 736b 7320 6265 696e 6720 6578 6563  tasks being exec
+000103f0: 7574 6564 2e0a 2020 2020 2020 2020 4966  uted..        If
+00010400: 206e 6f20 6669 6c74 6572 2069 7320 7072   no filter is pr
+00010410: 6f76 6964 6564 2c20 7769 6c6c 2072 6574  ovided, will ret
+00010420: 7572 6e20 6261 636b 6772 6f75 6e64 2074  urn background t
+00010430: 6173 6b73 2066 726f 6d20 7468 6520 6c61  asks from the la
+00010440: 7374 2077 6565 6b2e 0a0a 2020 2020 2020  st week...      
+00010450: 2020 3a70 6172 616d 2070 726f 6a65 6374    :param project
+00010460: 3a20 5072 6f6a 6563 7420 6e61 6d65 2028  : Project name (
+00010470: 6465 6661 756c 7473 2074 6f20 6d6c 7275  defaults to mlru
+00010480: 6e2e 636f 6e66 6967 2e63 6f6e 6669 672e  n.config.config.
+00010490: 6465 6661 756c 745f 7072 6f6a 6563 7429  default_project)
+000104a0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+000104b0: 2073 7461 7465 3a20 2020 4c69 7374 206f   state:   List o
+000104c0: 6e6c 7920 6261 636b 6772 6f75 6e64 2074  nly background t
+000104d0: 6173 6b73 2077 686f 7365 2073 7461 7465  asks whose state
+000104e0: 2069 7320 7370 6563 6966 6965 642e 0a20   is specified.. 
+000104f0: 2020 2020 2020 203a 7061 7261 6d20 6372         :param cr
+00010500: 6561 7465 645f 6672 6f6d 3a20 4669 6c74  eated_from: Filt
+00010510: 6572 2062 7920 6261 636b 6772 6f75 6e64  er by background
+00010520: 2074 6173 6b20 6372 6561 7465 6420 7469   task created ti
+00010530: 6d65 2069 6e20 6060 5b63 7265 6174 6564  me in ``[created
+00010540: 5f66 726f 6d2c 2063 7265 6174 6564 5f74  _from, created_t
+00010550: 6f5d 6060 2e0a 2020 2020 2020 2020 3a70  o]``..        :p
+00010560: 6172 616d 2063 7265 6174 6564 5f74 6f3a  aram created_to:
+00010570: 2020 4669 6c74 6572 2062 7920 6261 636b    Filter by back
+00010580: 6772 6f75 6e64 2074 6173 6b20 6372 6561  ground task crea
+00010590: 7465 6420 7469 6d65 2069 6e20 6060 5b63  ted time in ``[c
+000105a0: 7265 6174 6564 5f66 726f 6d2c 2063 7265  reated_from, cre
+000105b0: 6174 6564 5f74 6f5d 6060 2e0a 2020 2020  ated_to]``..    
+000105c0: 2020 2020 3a70 6172 616d 206c 6173 745f      :param last_
+000105d0: 7570 6461 7465 5f74 696d 655f 6672 6f6d  update_time_from
+000105e0: 3a20 4669 6c74 6572 2062 7920 6261 636b  : Filter by back
+000105f0: 6772 6f75 6e64 2074 6173 6b20 6c61 7374  ground task last
+00010600: 2075 7064 6174 6520 7469 6d65 2069 6e0a   update time in.
+00010610: 2020 2020 2020 2020 2020 2020 6060 286c              ``(l
+00010620: 6173 745f 7570 6461 7465 5f74 696d 655f  ast_update_time_
+00010630: 6672 6f6d 2c20 6c61 7374 5f75 7064 6174  from, last_updat
+00010640: 655f 7469 6d65 5f74 6f29 6060 2e0a 2020  e_time_to)``..  
+00010650: 2020 2020 2020 3a70 6172 616d 206c 6173        :param las
+00010660: 745f 7570 6461 7465 5f74 696d 655f 746f  t_update_time_to
+00010670: 3a20 4669 6c74 6572 2062 7920 6261 636b  : Filter by back
+00010680: 6772 6f75 6e64 2074 6173 6b20 6c61 7374  ground task last
+00010690: 2075 7064 6174 6520 7469 6d65 2069 6e0a   update time in.
+000106a0: 2020 2020 2020 2020 2020 2020 6060 286c              ``(l
+000106b0: 6173 745f 7570 6461 7465 5f74 696d 655f  ast_update_time_
+000106c0: 6672 6f6d 2c20 6c61 7374 5f75 7064 6174  from, last_updat
+000106d0: 655f 7469 6d65 5f74 6f29 6060 2e0a 2020  e_time_to)``..  
+000106e0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+000106f0: 2020 7072 6f6a 6563 7420 3d20 7072 6f6a    project = proj
+00010700: 6563 7420 6f72 2063 6f6e 6669 672e 6465  ect or config.de
+00010710: 6661 756c 745f 7072 6f6a 6563 740a 2020  fault_project.  
+00010720: 2020 2020 2020 6966 2028 0a20 2020 2020        if (.     
+00010730: 2020 2020 2020 206e 6f74 2073 7461 7465         not state
+00010740: 0a20 2020 2020 2020 2020 2020 2061 6e64  .            and
+00010750: 206e 6f74 2063 7265 6174 6564 5f66 726f   not created_fro
+00010760: 6d0a 2020 2020 2020 2020 2020 2020 616e  m.            an
+00010770: 6420 6e6f 7420 6372 6561 7465 645f 746f  d not created_to
+00010780: 0a20 2020 2020 2020 2020 2020 2061 6e64  .            and
+00010790: 206e 6f74 206c 6173 745f 7570 6461 7465   not last_update
+000107a0: 5f74 696d 655f 6672 6f6d 0a20 2020 2020  _time_from.     
+000107b0: 2020 2020 2020 2061 6e64 206e 6f74 206c         and not l
+000107c0: 6173 745f 7570 6461 7465 5f74 696d 655f  ast_update_time_
+000107d0: 746f 0a20 2020 2020 2020 2029 3a0a 2020  to.        ):.  
+000107e0: 2020 2020 2020 2020 2020 2320 6465 6661            # defa
+000107f0: 756c 7420 746f 206c 6173 7420 7765 656b  ult to last week
+00010800: 206f 6e20 6e6f 2066 696c 7465 720a 2020   on no filter.  
+00010810: 2020 2020 2020 2020 2020 6372 6561 7465            create
+00010820: 645f 6672 6f6d 203d 2064 6174 6574 696d  d_from = datetim
+00010830: 652e 6e6f 7728 2920 2d20 7469 6d65 6465  e.now() - timede
+00010840: 6c74 6128 6461 7973 3d37 290a 0a20 2020  lta(days=7)..   
+00010850: 2020 2020 2070 6172 616d 7320 3d20 7b0a       params = {.
+00010860: 2020 2020 2020 2020 2020 2020 2273 7461              "sta
+00010870: 7465 223a 2073 7461 7465 2c0a 2020 2020  te": state,.    
+00010880: 2020 2020 2020 2020 2263 7265 6174 6564          "created
+00010890: 5f66 726f 6d22 3a20 6461 7465 7469 6d65  _from": datetime
+000108a0: 5f74 6f5f 6973 6f28 6372 6561 7465 645f  _to_iso(created_
+000108b0: 6672 6f6d 292c 0a20 2020 2020 2020 2020  from),.         
+000108c0: 2020 2022 6372 6561 7465 645f 746f 223a     "created_to":
+000108d0: 2064 6174 6574 696d 655f 746f 5f69 736f   datetime_to_iso
+000108e0: 2863 7265 6174 6564 5f74 6f29 2c0a 2020  (created_to),.  
+000108f0: 2020 2020 2020 2020 2020 226c 6173 745f            "last_
+00010900: 7570 6461 7465 5f74 696d 655f 6672 6f6d  update_time_from
+00010910: 223a 2064 6174 6574 696d 655f 746f 5f69  ": datetime_to_i
+00010920: 736f 286c 6173 745f 7570 6461 7465 5f74  so(last_update_t
+00010930: 696d 655f 6672 6f6d 292c 0a20 2020 2020  ime_from),.     
+00010940: 2020 2020 2020 2022 6c61 7374 5f75 7064         "last_upd
+00010950: 6174 655f 7469 6d65 5f74 6f22 3a20 6461  ate_time_to": da
+00010960: 7465 7469 6d65 5f74 6f5f 6973 6f28 6c61  tetime_to_iso(la
+00010970: 7374 5f75 7064 6174 655f 7469 6d65 5f74  st_update_time_t
+00010980: 6f29 2c0a 2020 2020 2020 2020 7d0a 0a20  o),.        }.. 
+00010990: 2020 2020 2020 2070 6174 6820 3d20 6622         path = f"
+000109a0: 7072 6f6a 6563 7473 2f7b 7072 6f6a 6563  projects/{projec
+000109b0: 747d 2f62 6163 6b67 726f 756e 642d 7461  t}/background-ta
+000109c0: 736b 7322 0a20 2020 2020 2020 2065 7272  sks".        err
+000109d0: 6f72 5f6d 6573 7361 6765 203d 2066 2246  or_message = f"F
+000109e0: 6169 6c65 6420 6c69 7374 696e 6720 7072  ailed listing pr
+000109f0: 6f6a 6563 7420 6261 636b 6772 6f75 6e64  oject background
+00010a00: 2074 6173 6b2e 2070 726f 6a65 6374 3d7b   task. project={
+00010a10: 7072 6f6a 6563 747d 220a 2020 2020 2020  project}".      
+00010a20: 2020 7265 7370 6f6e 7365 203d 2073 656c    response = sel
+00010a30: 662e 6170 695f 6361 6c6c 2822 4745 5422  f.api_call("GET"
+00010a40: 2c20 7061 7468 2c20 6572 726f 725f 6d65  , path, error_me
+00010a50: 7373 6167 652c 2070 6172 616d 733d 7061  ssage, params=pa
+00010a60: 7261 6d73 290a 2020 2020 2020 2020 7265  rams).        re
+00010a70: 7475 726e 206d 6c72 756e 2e63 6f6d 6d6f  turn mlrun.commo
+00010a80: 6e2e 7363 6865 6d61 732e 4261 636b 6772  n.schemas.Backgr
+00010a90: 6f75 6e64 5461 736b 4c69 7374 280a 2020  oundTaskList(.  
+00010aa0: 2020 2020 2020 2020 2020 2a2a 7265 7370            **resp
+00010ab0: 6f6e 7365 2e6a 736f 6e28 290a 2020 2020  onse.json().    
+00010ac0: 2020 2020 292e 6261 636b 6772 6f75 6e64      ).background
+00010ad0: 5f74 6173 6b73 0a0a 2020 2020 6465 6620  _tasks..    def 
+00010ae0: 6765 745f 6261 636b 6772 6f75 6e64 5f74  get_background_t
+00010af0: 6173 6b28 7365 6c66 2c20 6e61 6d65 3a20  ask(self, name: 
+00010b00: 7374 7229 202d 3e20 6d6c 7275 6e2e 636f  str) -> mlrun.co
+00010b10: 6d6d 6f6e 2e73 6368 656d 6173 2e42 6163  mmon.schemas.Bac
+00010b20: 6b67 726f 756e 6454 6173 6b3a 0a20 2020  kgroundTask:.   
+00010b30: 2020 2020 2022 2222 5265 7472 6965 7665       """Retrieve
+00010b40: 2075 7064 6174 6564 2069 6e66 6f72 6d61   updated informa
+00010b50: 7469 6f6e 206f 6e20 6120 6261 636b 6772  tion on a backgr
+00010b60: 6f75 6e64 2074 6173 6b20 6265 696e 6720  ound task being 
+00010b70: 6578 6563 7574 6564 2e22 2222 0a0a 2020  executed."""..  
+00010b80: 2020 2020 2020 7061 7468 203d 2066 2262        path = f"b
+00010b90: 6163 6b67 726f 756e 642d 7461 736b 732f  ackground-tasks/
+00010ba0: 7b6e 616d 657d 220a 2020 2020 2020 2020  {name}".        
+00010bb0: 6572 726f 725f 6d65 7373 6167 6520 3d20  error_message = 
+00010bc0: 6622 4661 696c 6564 2067 6574 7469 6e67  f"Failed getting
+00010bd0: 2062 6163 6b67 726f 756e 6420 7461 736b   background task
+00010be0: 2e20 6e61 6d65 3d7b 6e61 6d65 7d22 0a20  . name={name}". 
+00010bf0: 2020 2020 2020 2072 6573 706f 6e73 6520         response 
+00010c00: 3d20 7365 6c66 2e61 7069 5f63 616c 6c28  = self.api_call(
+00010c10: 2247 4554 222c 2070 6174 682c 2065 7272  "GET", path, err
+00010c20: 6f72 5f6d 6573 7361 6765 290a 2020 2020  or_message).    
+00010c30: 2020 2020 7265 7475 726e 206d 6c72 756e      return mlrun
+00010c40: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
+00010c50: 4261 636b 6772 6f75 6e64 5461 736b 282a  BackgroundTask(*
+00010c60: 2a72 6573 706f 6e73 652e 6a73 6f6e 2829  *response.json()
+00010c70: 290a 0a20 2020 2064 6566 2066 756e 6374  )..    def funct
+00010c80: 696f 6e5f 7374 6174 7573 2873 656c 662c  ion_status(self,
+00010c90: 2070 726f 6a65 6374 2c20 6e61 6d65 2c20   project, name, 
+00010ca0: 6b69 6e64 2c20 7365 6c65 6374 6f72 293a  kind, selector):
+00010cb0: 0a20 2020 2020 2020 2022 2222 5265 7472  .        """Retr
+00010cc0: 6965 7665 2073 7461 7475 7320 6f66 2061  ieve status of a
+00010cd0: 2066 756e 6374 696f 6e20 6265 696e 6720   function being 
+00010ce0: 6578 6563 7574 6564 2072 656d 6f74 656c  executed remotel
+00010cf0: 7920 2872 656c 6576 616e 7420 746f 2060  y (relevant to `
+00010d00: 6064 6173 6b60 6020 6675 6e63 7469 6f6e  `dask`` function
+00010d10: 7329 2e0a 0a20 2020 2020 2020 203a 7061  s)...        :pa
+00010d20: 7261 6d20 7072 6f6a 6563 743a 2020 2020  ram project:    
+00010d30: 2054 6865 2070 726f 6a65 6374 206f 6620   The project of 
+00010d40: 7468 6520 6675 6e63 7469 6f6e 0a20 2020  the function.   
+00010d50: 2020 2020 203a 7061 7261 6d20 6e61 6d65       :param name
+00010d60: 3a20 2020 2020 2020 2054 6865 206e 616d  :        The nam
+00010d70: 6520 6f66 2074 6865 2066 756e 6374 696f  e of the functio
+00010d80: 6e0a 2020 2020 2020 2020 3a70 6172 616d  n.        :param
+00010d90: 206b 696e 643a 2020 2020 2020 2020 5468   kind:        Th
+00010da0: 6520 6b69 6e64 206f 6620 7468 6520 6675  e kind of the fu
+00010db0: 6e63 7469 6f6e 2c20 6375 7272 656e 746c  nction, currentl
+00010dc0: 7920 6060 6461 736b 6060 2069 7320 7375  y ``dask`` is su
+00010dd0: 7070 6f72 7465 642e 0a20 2020 2020 2020  pported..       
+00010de0: 203a 7061 7261 6d20 7365 6c65 6374 6f72   :param selector
+00010df0: 3a20 2020 2053 656c 6563 746f 7220 636c  :    Selector cl
+00010e00: 6175 7365 2074 6f20 6265 2061 7070 6c69  ause to be appli
+00010e10: 6564 2074 6f20 7468 6520 4b75 6265 726e  ed to the Kubern
+00010e20: 6574 6573 2073 7461 7475 7320 7175 6572  etes status quer
+00010e30: 7920 746f 2066 696c 7465 7220 7468 6520  y to filter the 
+00010e40: 7265 7375 6c74 732e 0a20 2020 2020 2020  results..       
+00010e50: 2022 2222 0a0a 2020 2020 2020 2020 7472   """..        tr
+00010e60: 793a 0a20 2020 2020 2020 2020 2020 2072  y:.            r
+00010e70: 6571 203d 207b 226b 696e 6422 3a20 6b69  eq = {"kind": ki
+00010e80: 6e64 2c20 2273 656c 6563 746f 7222 3a20  nd, "selector": 
+00010e90: 7365 6c65 6374 6f72 2c20 2270 726f 6a65  selector, "proje
+00010ea0: 6374 223a 2070 726f 6a65 6374 2c20 226e  ct": project, "n
+00010eb0: 616d 6522 3a20 6e61 6d65 7d0a 2020 2020  ame": name}.    
+00010ec0: 2020 2020 2020 2020 7265 7370 203d 2073          resp = s
+00010ed0: 656c 662e 6170 695f 6361 6c6c 2822 504f  elf.api_call("PO
+00010ee0: 5354 222c 2022 7374 6174 7573 2f66 756e  ST", "status/fun
+00010ef0: 6374 696f 6e22 2c20 6a73 6f6e 3d72 6571  ction", json=req
+00010f00: 290a 2020 2020 2020 2020 6578 6365 7074  ).        except
+00010f10: 204f 5345 7272 6f72 2061 7320 6572 723a   OSError as err:
+00010f20: 0a20 2020 2020 2020 2020 2020 206c 6f67  .            log
+00010f30: 6765 722e 6572 726f 7228 6622 6572 726f  ger.error(f"erro
+00010f40: 7220 7374 6172 7469 6e67 2066 756e 6374  r starting funct
+00010f50: 696f 6e3a 207b 6572 725f 746f 5f73 7472  ion: {err_to_str
+00010f60: 2865 7272 297d 2229 0a20 2020 2020 2020  (err)}").       
+00010f70: 2020 2020 2072 6169 7365 204f 5345 7272       raise OSErr
+00010f80: 6f72 2866 2265 7272 6f72 3a20 6361 6e6e  or(f"error: cann
+00010f90: 6f74 2073 7461 7274 2066 756e 6374 696f  ot start functio
+00010fa0: 6e2c 207b 6572 725f 746f 5f73 7472 2865  n, {err_to_str(e
+00010fb0: 7272 297d 2229 0a0a 2020 2020 2020 2020  rr)}")..        
+00010fc0: 6966 206e 6f74 2072 6573 702e 6f6b 3a0a  if not resp.ok:.
+00010fd0: 2020 2020 2020 2020 2020 2020 6c6f 6767              logg
+00010fe0: 6572 2e65 7272 6f72 2866 2262 6164 2072  er.error(f"bad r
+00010ff0: 6573 7021 215c 6e7b 7265 7370 2e74 6578  esp!!\n{resp.tex
+00011000: 747d 2229 0a20 2020 2020 2020 2020 2020  t}").           
+00011010: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+00011020: 7228 2262 6164 2066 756e 6374 696f 6e20  r("bad function 
+00011030: 7374 6174 7573 2072 6573 706f 6e73 6522  status response"
+00011040: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
+00011050: 6e20 7265 7370 2e6a 736f 6e28 295b 2264  n resp.json()["d
+00011060: 6174 6122 5d0a 0a20 2020 2064 6566 2073  ata"]..    def s
+00011070: 7562 6d69 745f 6a6f 6228 0a20 2020 2020  ubmit_job(.     
+00011080: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+00011090: 2072 756e 7370 6563 2c0a 2020 2020 2020   runspec,.      
+000110a0: 2020 7363 6865 6475 6c65 3a20 556e 696f    schedule: Unio
+000110b0: 6e5b 7374 722c 206d 6c72 756e 2e63 6f6d  n[str, mlrun.com
+000110c0: 6d6f 6e2e 7363 6865 6d61 732e 5363 6865  mon.schemas.Sche
+000110d0: 6475 6c65 4372 6f6e 5472 6967 6765 725d  duleCronTrigger]
+000110e0: 203d 204e 6f6e 652c 0a20 2020 2029 3a0a   = None,.    ):.
+000110f0: 2020 2020 2020 2020 2222 2253 7562 6d69          """Submi
+00011100: 7420 6120 6a6f 6220 666f 7220 7265 6d6f  t a job for remo
+00011110: 7465 2065 7865 6375 7469 6f6e 2e0a 0a20  te execution... 
+00011120: 2020 2020 2020 203a 7061 7261 6d20 7275         :param ru
+00011130: 6e73 7065 633a 2054 6865 2072 756e 7469  nspec: The runti
+00011140: 6d65 206f 626a 6563 7420 7370 6563 2028  me object spec (
+00011150: 5461 736b 2920 746f 2065 7865 6375 7465  Task) to execute
+00011160: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00011170: 2073 6368 6564 756c 653a 2057 6865 7468   schedule: Wheth
+00011180: 6572 2074 6f20 7363 6865 6475 6c65 2074  er to schedule t
+00011190: 6869 7320 6a6f 6220 7573 696e 6720 6120  his job using a 
+000111a0: 4372 6f6e 2074 7269 6767 6572 2e20 4966  Cron trigger. If
+000111b0: 206e 6f74 2073 7065 6369 6669 6564 2c20   not specified, 
+000111c0: 7468 6520 6a6f 6220 7769 6c6c 2062 6520  the job will be 
+000111d0: 7375 626d 6974 7465 640a 2020 2020 2020  submitted.      
+000111e0: 2020 2020 2020 696d 6d65 6469 6174 656c        immediatel
+000111f0: 792e 0a20 2020 2020 2020 2022 2222 0a0a  y..        """..
+00011200: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
+00011210: 2020 2020 2020 2020 2072 6571 203d 207b           req = {
+00011220: 2274 6173 6b22 3a20 7275 6e73 7065 632e  "task": runspec.
+00011230: 746f 5f64 6963 7428 297d 0a20 2020 2020  to_dict()}.     
+00011240: 2020 2020 2020 2069 6620 7363 6865 6475         if schedu
+00011250: 6c65 3a0a 2020 2020 2020 2020 2020 2020  le:.            
+00011260: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+00011270: 6528 7363 6865 6475 6c65 2c20 6d6c 7275  e(schedule, mlru
+00011280: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
+00011290: 2e53 6368 6564 756c 6543 726f 6e54 7269  .ScheduleCronTri
+000112a0: 6767 6572 293a 0a20 2020 2020 2020 2020  gger):.         
+000112b0: 2020 2020 2020 2020 2020 2073 6368 6564             sched
+000112c0: 756c 6520 3d20 7363 6865 6475 6c65 2e64  ule = schedule.d
+000112d0: 6963 7428 290a 2020 2020 2020 2020 2020  ict().          
+000112e0: 2020 2020 2020 7265 715b 2273 6368 6564        req["sched
+000112f0: 756c 6522 5d20 3d20 7363 6865 6475 6c65  ule"] = schedule
+00011300: 0a20 2020 2020 2020 2020 2020 2074 696d  .            tim
+00011310: 656f 7574 203d 2028 696e 7428 636f 6e66  eout = (int(conf
+00011320: 6967 2e73 7562 6d69 745f 7469 6d65 6f75  ig.submit_timeou
+00011330: 7429 206f 7220 3132 3029 202b 2032 300a  t) or 120) + 20.
+00011340: 2020 2020 2020 2020 2020 2020 7265 7370              resp
+00011350: 203d 2073 656c 662e 6170 695f 6361 6c6c   = self.api_call
+00011360: 2822 504f 5354 222c 2022 7375 626d 6974  ("POST", "submit
+00011370: 5f6a 6f62 222c 206a 736f 6e3d 7265 712c  _job", json=req,
+00011380: 2074 696d 656f 7574 3d74 696d 656f 7574   timeout=timeout
+00011390: 290a 0a20 2020 2020 2020 2065 7863 6570  )..        excep
+000113a0: 7420 7265 7175 6573 7473 2e48 5454 5045  t requests.HTTPE
+000113b0: 7272 6f72 2061 7320 6572 723a 0a20 2020  rror as err:.   
+000113c0: 2020 2020 2020 2020 206c 6f67 6765 722e           logger.
+000113d0: 6572 726f 7228 6622 6572 726f 7220 7375  error(f"error su
+000113e0: 626d 6974 7469 6e67 2074 6173 6b3a 207b  bmitting task: {
+000113f0: 6572 725f 746f 5f73 7472 2865 7272 297d  err_to_str(err)}
+00011400: 2229 0a20 2020 2020 2020 2020 2020 2023  ").            #
+00011410: 206e 6f74 2063 7265 6174 696e 6720 6120   not creating a 
+00011420: 6e65 7720 6578 6365 7074 696f 6e20 6865  new exception he
+00011430: 7265 2c20 696e 206f 7264 6572 2074 6f20  re, in order to 
+00011440: 6b65 6570 2074 6865 2072 6573 706f 6e73  keep the respons
+00011450: 6520 616e 6420 7374 6174 7573 2063 6f64  e and status cod
+00011460: 6520 696e 2074 6865 2065 7863 6570 7469  e in the excepti
+00011470: 6f6e 0a20 2020 2020 2020 2020 2020 2072  on.            r
+00011480: 6169 7365 0a0a 2020 2020 2020 2020 6578  aise..        ex
+00011490: 6365 7074 204f 5345 7272 6f72 2061 7320  cept OSError as 
+000114a0: 6572 723a 0a20 2020 2020 2020 2020 2020  err:.           
+000114b0: 206c 6f67 6765 722e 6572 726f 7228 6622   logger.error(f"
+000114c0: 6572 726f 7220 7375 626d 6974 7469 6e67  error submitting
+000114d0: 2074 6173 6b3a 207b 6572 725f 746f 5f73   task: {err_to_s
+000114e0: 7472 2865 7272 297d 2229 0a20 2020 2020  tr(err)}").     
+000114f0: 2020 2020 2020 2072 6169 7365 204f 5345         raise OSE
+00011500: 7272 6f72 2822 6572 726f 723a 2063 616e  rror("error: can
+00011510: 6e6f 7420 7375 626d 6974 2074 6173 6b22  not submit task"
+00011520: 2920 6672 6f6d 2065 7272 0a0a 2020 2020  ) from err..    
+00011530: 2020 2020 6966 206e 6f74 2072 6573 702e      if not resp.
+00011540: 6f6b 3a0a 2020 2020 2020 2020 2020 2020  ok:.            
+00011550: 6c6f 6767 6572 2e65 7272 6f72 2866 2262  logger.error(f"b
+00011560: 6164 2072 6573 7021 215c 6e7b 7265 7370  ad resp!!\n{resp
+00011570: 2e74 6578 747d 2229 0a20 2020 2020 2020  .text}").       
+00011580: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+00011590: 4572 726f 7228 6622 6261 6420 6675 6e63  Error(f"bad func
+000115a0: 7469 6f6e 2072 756e 2072 6573 706f 6e73  tion run respons
+000115b0: 652c 207b 7265 7370 2e74 6578 747d 2229  e, {resp.text}")
+000115c0: 0a0a 2020 2020 2020 2020 7265 7370 203d  ..        resp =
+000115d0: 2072 6573 702e 6a73 6f6e 2829 0a20 2020   resp.json().   
+000115e0: 2020 2020 2072 6574 7572 6e20 7265 7370       return resp
+000115f0: 5b22 6461 7461 225d 0a0a 2020 2020 6465  ["data"]..    de
+00011600: 6620 7375 626d 6974 5f70 6970 656c 696e  f submit_pipelin
+00011610: 6528 0a20 2020 2020 2020 2073 656c 662c  e(.        self,
+00011620: 0a20 2020 2020 2020 2070 726f 6a65 6374  .        project
+00011630: 2c0a 2020 2020 2020 2020 7069 7065 6c69  ,.        pipeli
+00011640: 6e65 2c0a 2020 2020 2020 2020 6172 6775  ne,.        argu
+00011650: 6d65 6e74 733d 4e6f 6e65 2c0a 2020 2020  ments=None,.    
+00011660: 2020 2020 6578 7065 7269 6d65 6e74 3d4e      experiment=N
+00011670: 6f6e 652c 0a20 2020 2020 2020 2072 756e  one,.        run
+00011680: 3d4e 6f6e 652c 0a20 2020 2020 2020 206e  =None,.        n
+00011690: 616d 6573 7061 6365 3d4e 6f6e 652c 0a20  amespace=None,. 
+000116a0: 2020 2020 2020 2061 7274 6966 6163 745f         artifact_
+000116b0: 7061 7468 3d4e 6f6e 652c 0a20 2020 2020  path=None,.     
+000116c0: 2020 206f 7073 3d4e 6f6e 652c 0a20 2020     ops=None,.   
+000116d0: 2020 2020 2063 6c65 616e 7570 5f74 746c       cleanup_ttl
+000116e0: 3d4e 6f6e 652c 0a20 2020 2020 2020 2074  =None,.        t
+000116f0: 696d 656f 7574 3d36 302c 0a20 2020 2029  imeout=60,.    )
+00011700: 3a0a 2020 2020 2020 2020 2222 2253 7562  :.        """Sub
+00011710: 6d69 7420 6120 4b46 5020 7069 7065 6c69  mit a KFP pipeli
+00011720: 6e65 2066 6f72 2065 7865 6375 7469 6f6e  ne for execution
+00011730: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
+00011740: 6d20 7072 6f6a 6563 743a 2020 2020 2020  m project:      
+00011750: 2020 2054 6865 2070 726f 6a65 6374 206f     The project o
+00011760: 6620 7468 6520 7069 7065 6c69 6e65 0a20  f the pipeline. 
+00011770: 2020 2020 2020 203a 7061 7261 6d20 7069         :param pi
+00011780: 7065 6c69 6e65 3a20 2020 2020 2020 2050  peline:        P
+00011790: 6970 656c 696e 6520 6675 6e63 7469 6f6e  ipeline function
+000117a0: 206f 7220 7061 7468 2074 6f20 2e79 616d   or path to .yam
+000117b0: 6c2f 2e7a 6970 2070 6970 656c 696e 6520  l/.zip pipeline 
+000117c0: 6669 6c65 2e0a 2020 2020 2020 2020 3a70  file..        :p
+000117d0: 6172 616d 2061 7267 756d 656e 7473 3a20  aram arguments: 
+000117e0: 2020 2020 2020 4120 6469 6374 696f 6e61        A dictiona
+000117f0: 7279 206f 6620 6172 6775 6d65 6e74 7320  ry of arguments 
+00011800: 746f 2070 6173 7320 746f 2074 6865 2070  to pass to the p
+00011810: 6970 656c 696e 652e 0a20 2020 2020 2020  ipeline..       
+00011820: 203a 7061 7261 6d20 6578 7065 7269 6d65   :param experime
+00011830: 6e74 3a20 2020 2020 2041 206e 616d 6520  nt:      A name 
+00011840: 746f 2061 7373 6967 6e20 666f 7220 7468  to assign for th
+00011850: 6520 7370 6563 6966 6963 2065 7870 6572  e specific exper
+00011860: 696d 656e 742e 0a20 2020 2020 2020 203a  iment..        :
+00011870: 7061 7261 6d20 7275 6e3a 2020 2020 2020  param run:      
+00011880: 2020 2020 2020 2041 206e 616d 6520 666f         A name fo
+00011890: 7220 7468 6973 2073 7065 6369 6669 6320  r this specific 
+000118a0: 7275 6e2e 0a20 2020 2020 2020 203a 7061  run..        :pa
+000118b0: 7261 6d20 6e61 6d65 7370 6163 653a 2020  ram namespace:  
+000118c0: 2020 2020 204b 7562 6572 6e65 7465 7320       Kubernetes 
+000118d0: 6e61 6d65 7370 6163 6520 746f 2065 7865  namespace to exe
+000118e0: 6375 7465 2074 6865 2070 6970 656c 696e  cute the pipelin
+000118f0: 6520 696e 2e0a 2020 2020 2020 2020 3a70  e in..        :p
+00011900: 6172 616d 2061 7274 6966 6163 745f 7061  aram artifact_pa
+00011910: 7468 3a20 2020 4120 7061 7468 2074 6f20  th:   A path to 
+00011920: 6172 7469 6661 6374 7320 7573 6564 2062  artifacts used b
+00011930: 7920 7468 6973 2070 6970 656c 696e 652e  y this pipeline.
+00011940: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00011950: 6f70 733a 2020 2020 2020 2020 2020 2020  ops:            
+00011960: 2054 7261 6e73 666f 726d 6572 7320 746f   Transformers to
+00011970: 2061 7070 6c79 206f 6e20 616c 6c20 6f70   apply on all op
+00011980: 7320 696e 2074 6865 2070 6970 656c 696e  s in the pipelin
+00011990: 652e 0a20 2020 2020 2020 203a 7061 7261  e..        :para
+000119a0: 6d20 636c 6561 6e75 705f 7474 6c3a 2020  m cleanup_ttl:  
+000119b0: 2020 2050 6970 656c 696e 6520 636c 6561     Pipeline clea
+000119c0: 6e75 7020 7474 6c20 696e 2073 6563 7320  nup ttl in secs 
+000119d0: 2874 696d 6520 746f 2077 6169 7420 6166  (time to wait af
+000119e0: 7465 7220 776f 726b 666c 6f77 2063 6f6d  ter workflow com
+000119f0: 706c 6574 696f 6e2c 2061 7420 7768 6963  pletion, at whic
+00011a00: 6820 706f 696e 7420 7468 650a 2020 2020  h point the.    
+00011a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011a20: 2020 2020 2020 2020 2020 2020 776f 726b              work
+00011a30: 666c 6f77 2061 6e64 2061 6c6c 2069 7473  flow and all its
+00011a40: 2072 6573 6f75 7263 6573 2061 7265 2064   resources are d
+00011a50: 656c 6574 6564 290a 2020 2020 2020 2020  eleted).        
+00011a60: 3a70 6172 616d 2074 696d 656f 7574 3a20  :param timeout: 
+00011a70: 2020 2020 2020 2020 5469 6d65 6f75 7420          Timeout 
+00011a80: 666f 7220 7468 6520 4150 4920 6361 6c6c  for the API call
+00011a90: 2e0a 2020 2020 2020 2020 2222 220a 0a20  ..        """.. 
+00011aa0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+00011ab0: 616e 6365 2870 6970 656c 696e 652c 2073  ance(pipeline, s
+00011ac0: 7472 293a 0a20 2020 2020 2020 2020 2020  tr):.           
+00011ad0: 2070 6970 655f 6669 6c65 203d 2070 6970   pipe_file = pip
+00011ae0: 656c 696e 650a 2020 2020 2020 2020 656c  eline.        el
+00011af0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00011b00: 7069 7065 5f66 696c 6520 3d20 7465 6d70  pipe_file = temp
+00011b10: 6669 6c65 2e4e 616d 6564 5465 6d70 6f72  file.NamedTempor
+00011b20: 6172 7946 696c 6528 7375 6666 6978 3d22  aryFile(suffix="
+00011b30: 2e79 616d 6c22 2c20 6465 6c65 7465 3d46  .yaml", delete=F
+00011b40: 616c 7365 292e 6e61 6d65 0a20 2020 2020  alse).name.     
+00011b50: 2020 2020 2020 2063 6f6e 6620 3d20 6e65         conf = ne
+00011b60: 775f 7069 7065 5f6d 6574 6164 6174 6128  w_pipe_metadata(
+00011b70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011b80: 2061 7274 6966 6163 745f 7061 7468 3d61   artifact_path=a
+00011b90: 7274 6966 6163 745f 7061 7468 2c0a 2020  rtifact_path,.  
+00011ba0: 2020 2020 2020 2020 2020 2020 2020 636c                cl
+00011bb0: 6561 6e75 705f 7474 6c3d 636c 6561 6e75  eanup_ttl=cleanu
+00011bc0: 705f 7474 6c2c 0a20 2020 2020 2020 2020  p_ttl,.         
+00011bd0: 2020 2020 2020 206f 705f 7472 616e 7366         op_transf
+00011be0: 6f72 6d65 7273 3d6f 7073 2c0a 2020 2020  ormers=ops,.    
+00011bf0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00011c00: 2020 2020 2020 6b66 702e 636f 6d70 696c        kfp.compil
+00011c10: 6572 2e43 6f6d 7069 6c65 7228 292e 636f  er.Compiler().co
+00011c20: 6d70 696c 6528 0a20 2020 2020 2020 2020  mpile(.         
+00011c30: 2020 2020 2020 2070 6970 656c 696e 652c         pipeline,
+00011c40: 2070 6970 655f 6669 6c65 2c20 7479 7065   pipe_file, type
+00011c50: 5f63 6865 636b 3d46 616c 7365 2c20 7069  _check=False, pi
+00011c60: 7065 6c69 6e65 5f63 6f6e 663d 636f 6e66  peline_conf=conf
+00011c70: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
+00011c80: 2020 2020 2020 2020 6966 2070 6970 655f          if pipe_
+00011c90: 6669 6c65 2e65 6e64 7377 6974 6828 222e  file.endswith(".
+00011ca0: 7961 6d6c 2229 3a0a 2020 2020 2020 2020  yaml"):.        
+00011cb0: 2020 2020 6865 6164 6572 7320 3d20 7b22      headers = {"
+00011cc0: 636f 6e74 656e 742d 7479 7065 223a 2022  content-type": "
+00011cd0: 6170 706c 6963 6174 696f 6e2f 7961 6d6c  application/yaml
+00011ce0: 227d 0a20 2020 2020 2020 2065 6c69 6620  "}.        elif 
+00011cf0: 7069 7065 5f66 696c 652e 656e 6473 7769  pipe_file.endswi
+00011d00: 7468 2822 2e7a 6970 2229 3a0a 2020 2020  th(".zip"):.    
+00011d10: 2020 2020 2020 2020 6865 6164 6572 7320          headers 
+00011d20: 3d20 7b22 636f 6e74 656e 742d 7479 7065  = {"content-type
+00011d30: 223a 2022 6170 706c 6963 6174 696f 6e2f  ": "application/
+00011d40: 7a69 7022 7d0a 2020 2020 2020 2020 656c  zip"}.        el
+00011d50: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00011d60: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+00011d70: 2822 7069 7065 6c69 6e65 2066 696c 6520  ("pipeline file 
+00011d80: 6d75 7374 2062 6520 2e79 616d 6c20 6f72  must be .yaml or
+00011d90: 202e 7a69 7022 290a 2020 2020 2020 2020   .zip").        
+00011da0: 6966 2061 7267 756d 656e 7473 3a0a 2020  if arguments:.  
+00011db0: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
+00011dc0: 2069 7369 6e73 7461 6e63 6528 6172 6775   isinstance(argu
+00011dd0: 6d65 6e74 732c 2064 6963 7429 3a0a 2020  ments, dict):.  
+00011de0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+00011df0: 6973 6520 5661 6c75 6545 7272 6f72 2822  ise ValueError("
+00011e00: 6172 6775 6d65 6e74 7320 6d75 7374 2062  arguments must b
+00011e10: 6520 6469 6374 2074 7970 6522 290a 2020  e dict type").  
+00011e20: 2020 2020 2020 2020 2020 6865 6164 6572            header
+00011e30: 735b 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  s[mlrun.common.s
+00011e40: 6368 656d 6173 2e48 6561 6465 724e 616d  chemas.HeaderNam
+00011e50: 6573 2e70 6970 656c 696e 655f 6172 6775  es.pipeline_argu
+00011e60: 6d65 6e74 735d 203d 2073 7472 280a 2020  ments] = str(.  
+00011e70: 2020 2020 2020 2020 2020 2020 2020 6172                ar
+00011e80: 6775 6d65 6e74 730a 2020 2020 2020 2020  guments.        
+00011e90: 2020 2020 290a 0a20 2020 2020 2020 2069      )..        i
+00011ea0: 6620 6e6f 7420 7061 7468 2e69 7366 696c  f not path.isfil
+00011eb0: 6528 7069 7065 5f66 696c 6529 3a0a 2020  e(pipe_file):.  
+00011ec0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00011ed0: 4f53 4572 726f 7228 6622 6669 6c65 207b  OSError(f"file {
+00011ee0: 7069 7065 5f66 696c 657d 2064 6f65 736e  pipe_file} doesn
+00011ef0: 7420 6578 6973 7422 290a 2020 2020 2020  t exist").      
+00011f00: 2020 7769 7468 206f 7065 6e28 7069 7065    with open(pipe
+00011f10: 5f66 696c 652c 2022 7262 2229 2061 7320  _file, "rb") as 
+00011f20: 6670 3a0a 2020 2020 2020 2020 2020 2020  fp:.            
+00011f30: 6461 7461 203d 2066 702e 7265 6164 2829  data = fp.read()
+00011f40: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
+00011f50: 6973 696e 7374 616e 6365 2870 6970 656c  isinstance(pipel
+00011f60: 696e 652c 2073 7472 293a 0a20 2020 2020  ine, str):.     
+00011f70: 2020 2020 2020 2072 656d 6f76 6528 7069         remove(pi
+00011f80: 7065 5f66 696c 6529 0a0a 2020 2020 2020  pe_file)..      
+00011f90: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
+00011fa0: 2020 2070 6172 616d 7320 3d20 7b22 6e61     params = {"na
+00011fb0: 6d65 7370 6163 6522 3a20 6e61 6d65 7370  mespace": namesp
+00011fc0: 6163 652c 2022 6578 7065 7269 6d65 6e74  ace, "experiment
+00011fd0: 223a 2065 7870 6572 696d 656e 742c 2022  ": experiment, "
+00011fe0: 7275 6e22 3a20 7275 6e7d 0a20 2020 2020  run": run}.     
+00011ff0: 2020 2020 2020 2072 6573 7020 3d20 7365         resp = se
+00012000: 6c66 2e61 7069 5f63 616c 6c28 0a20 2020  lf.api_call(.   
+00012010: 2020 2020 2020 2020 2020 2020 2022 504f               "PO
+00012020: 5354 222c 0a20 2020 2020 2020 2020 2020  ST",.           
+00012030: 2020 2020 2066 2270 726f 6a65 6374 732f       f"projects/
+00012040: 7b70 726f 6a65 6374 7d2f 7069 7065 6c69  {project}/pipeli
+00012050: 6e65 7322 2c0a 2020 2020 2020 2020 2020  nes",.          
+00012060: 2020 2020 2020 7061 7261 6d73 3d70 6172        params=par
+00012070: 616d 732c 0a20 2020 2020 2020 2020 2020  ams,.           
+00012080: 2020 2020 2074 696d 656f 7574 3d74 696d       timeout=tim
+00012090: 656f 7574 2c0a 2020 2020 2020 2020 2020  eout,.          
+000120a0: 2020 2020 2020 626f 6479 3d64 6174 612c        body=data,
+000120b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000120c0: 2068 6561 6465 7273 3d68 6561 6465 7273   headers=headers
+000120d0: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
+000120e0: 2020 2020 2020 2020 6578 6365 7074 204f          except O
+000120f0: 5345 7272 6f72 2061 7320 6572 723a 0a20  SError as err:. 
+00012100: 2020 2020 2020 2020 2020 206c 6f67 6765             logge
+00012110: 722e 6572 726f 7228 2245 7272 6f72 3a20  r.error("Error: 
+00012120: 4361 6e6e 6f74 2073 7562 6d69 7420 7069  Cannot submit pi
+00012130: 7065 6c69 6e65 222c 2065 7272 3d65 7272  peline", err=err
+00012140: 5f74 6f5f 7374 7228 6572 7229 290a 2020  _to_str(err)).  
+00012150: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00012160: 4f53 4572 726f 7228 6622 4572 726f 723a  OSError(f"Error:
+00012170: 2043 616e 6e6f 7420 7375 626d 6974 2070   Cannot submit p
+00012180: 6970 656c 696e 652c 207b 6572 725f 746f  ipeline, {err_to
+00012190: 5f73 7472 2865 7272 297d 2229 0a0a 2020  _str(err)}")..  
+000121a0: 2020 2020 2020 6966 206e 6f74 2072 6573        if not res
+000121b0: 702e 6f6b 3a0a 2020 2020 2020 2020 2020  p.ok:.          
+000121c0: 2020 6c6f 6767 6572 2e65 7272 6f72 2822    logger.error("
+000121d0: 4661 696c 6564 2074 6f20 7375 626d 6974  Failed to submit
+000121e0: 2070 6970 656c 696e 6522 2c20 7265 7370   pipeline", resp
+000121f0: 6f6e 6573 5f74 6578 743d 7265 7370 2e74  ones_text=resp.t
+00012200: 6578 7429 0a20 2020 2020 2020 2020 2020  ext).           
+00012210: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+00012220: 7228 6622 4661 696c 6564 2074 6f20 7375  r(f"Failed to su
+00012230: 626d 6974 2070 6970 656c 696e 652c 207b  bmit pipeline, {
+00012240: 7265 7370 2e74 6578 747d 2229 0a0a 2020  resp.text}")..  
+00012250: 2020 2020 2020 7265 7370 203d 2072 6573        resp = res
+00012260: 702e 6a73 6f6e 2829 0a20 2020 2020 2020  p.json().       
+00012270: 206c 6f67 6765 722e 696e 666f 280a 2020   logger.info(.  
+00012280: 2020 2020 2020 2020 2020 2250 6970 656c            "Pipel
+00012290: 696e 6520 7375 626d 6974 7465 6420 7375  ine submitted su
+000122a0: 6363 6573 7366 756c 6c79 222c 2070 6970  ccessfully", pip
+000122b0: 656c 696e 655f 6e61 6d65 3d72 6573 705b  eline_name=resp[
+000122c0: 226e 616d 6522 5d2c 2069 643d 7265 7370  "name"], id=resp
+000122d0: 5b22 6964 225d 0a20 2020 2020 2020 2029  ["id"].        )
+000122e0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+000122f0: 7265 7370 5b22 6964 225d 0a0a 2020 2020  resp["id"]..    
+00012300: 6465 6620 6c69 7374 5f70 6970 656c 696e  def list_pipelin
+00012310: 6573 280a 2020 2020 2020 2020 7365 6c66  es(.        self
+00012320: 2c0a 2020 2020 2020 2020 7072 6f6a 6563  ,.        projec
+00012330: 743a 2073 7472 2c0a 2020 2020 2020 2020  t: str,.        
+00012340: 6e61 6d65 7370 6163 653a 2073 7472 203d  namespace: str =
+00012350: 204e 6f6e 652c 0a20 2020 2020 2020 2073   None,.        s
+00012360: 6f72 745f 6279 3a20 7374 7220 3d20 2222  ort_by: str = ""
+00012370: 2c0a 2020 2020 2020 2020 7061 6765 5f74  ,.        page_t
+00012380: 6f6b 656e 3a20 7374 7220 3d20 2222 2c0a  oken: str = "",.
+00012390: 2020 2020 2020 2020 6669 6c74 6572 5f3a          filter_:
+000123a0: 2073 7472 203d 2022 222c 0a20 2020 2020   str = "",.     
+000123b0: 2020 2066 6f72 6d61 745f 3a20 556e 696f     format_: Unio
+000123c0: 6e5b 0a20 2020 2020 2020 2020 2020 2073  n[.            s
+000123d0: 7472 2c20 6d6c 7275 6e2e 636f 6d6d 6f6e  tr, mlrun.common
+000123e0: 2e73 6368 656d 6173 2e50 6970 656c 696e  .schemas.Pipelin
+000123f0: 6573 466f 726d 6174 0a20 2020 2020 2020  esFormat.       
+00012400: 205d 203d 206d 6c72 756e 2e63 6f6d 6d6f   ] = mlrun.commo
+00012410: 6e2e 7363 6865 6d61 732e 5069 7065 6c69  n.schemas.Pipeli
+00012420: 6e65 7346 6f72 6d61 742e 6d65 7461 6461  nesFormat.metada
+00012430: 7461 5f6f 6e6c 792c 0a20 2020 2020 2020  ta_only,.       
+00012440: 2070 6167 655f 7369 7a65 3a20 696e 7420   page_size: int 
+00012450: 3d20 4e6f 6e65 2c0a 2020 2020 2920 2d3e  = None,.    ) ->
+00012460: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
+00012470: 6865 6d61 732e 5069 7065 6c69 6e65 734f  hemas.PipelinesO
+00012480: 7574 7075 743a 0a20 2020 2020 2020 2022  utput:.        "
+00012490: 2222 5265 7472 6965 7665 2061 206c 6973  ""Retrieve a lis
+000124a0: 7420 6f66 204b 4650 2070 6970 656c 696e  t of KFP pipelin
+000124b0: 6573 2e20 5468 6973 2066 756e 6374 696f  es. This functio
+000124c0: 6e20 6361 6e20 6265 2069 6e76 6f6b 6564  n can be invoked
+000124d0: 2074 6f20 6765 7420 616c 6c20 7069 7065   to get all pipe
+000124e0: 6c69 6e65 7320 6672 6f6d 2061 6c6c 2070  lines from all p
+000124f0: 726f 6a65 6374 732c 0a20 2020 2020 2020  rojects,.       
+00012500: 2062 7920 7370 6563 6966 7969 6e67 2060   by specifying `
+00012510: 6070 726f 6a65 6374 3d2a 6060 2c20 696e  `project=*``, in
+00012520: 2077 6869 6368 2063 6173 6520 7061 6769   which case pagi
+00012530: 6e61 7469 6f6e 2063 616e 2062 6520 7573  nation can be us
+00012540: 6564 2061 6e64 2074 6865 2076 6172 696f  ed and the vario
+00012550: 7573 2073 6f72 7469 6e67 2061 6e64 2070  us sorting and p
+00012560: 6167 696e 6174 696f 6e0a 2020 2020 2020  agination.      
+00012570: 2020 7072 6f70 6572 7469 6573 2063 616e    properties can
+00012580: 2062 6520 6170 706c 6965 642e 2049 6620   be applied. If 
+00012590: 6120 7370 6563 6966 6963 2070 726f 6a65  a specific proje
+000125a0: 6374 2069 7320 7265 7175 6573 7465 642c  ct is requested,
+000125b0: 2074 6865 6e20 7468 6520 7061 6769 6e61   then the pagina
+000125c0: 7469 6f6e 206f 7074 696f 6e73 2063 616e  tion options can
+000125d0: 6e6f 7420 6265 0a20 2020 2020 2020 2075  not be.        u
+000125e0: 7365 6420 616e 6420 7061 6769 6e61 7469  sed and paginati
+000125f0: 6f6e 2069 7320 6e6f 7420 6170 706c 6965  on is not applie
+00012600: 642e 0a0a 2020 2020 2020 2020 3a70 6172  d...        :par
+00012610: 616d 2070 726f 6a65 6374 3a20 5072 6f6a  am project: Proj
+00012620: 6563 7420 6e61 6d65 2e20 4361 6e20 6265  ect name. Can be
+00012630: 2060 602a 6060 2066 6f72 2071 7565 7279   ``*`` for query
+00012640: 2061 6372 6f73 7320 616c 6c20 7072 6f6a   across all proj
+00012650: 6563 7473 2e0a 2020 2020 2020 2020 3a70  ects..        :p
+00012660: 6172 616d 206e 616d 6573 7061 6365 3a20  aram namespace: 
+00012670: 4b75 6265 726e 6574 6573 206e 616d 6573  Kubernetes names
+00012680: 7061 6365 2069 6e20 7768 6963 6820 7468  pace in which th
+00012690: 6520 7069 7065 6c69 6e65 7320 6172 6520  e pipelines are 
+000126a0: 6578 6563 7574 696e 672e 0a20 2020 2020  executing..     
+000126b0: 2020 203a 7061 7261 6d20 736f 7274 5f62     :param sort_b
+000126c0: 793a 2046 6965 6c64 2074 6f20 736f 7274  y: Field to sort
+000126d0: 2074 6865 2072 6573 756c 7473 2062 792e   the results by.
+000126e0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+000126f0: 7061 6765 5f74 6f6b 656e 3a20 5573 6520  page_token: Use 
+00012700: 666f 7220 7061 6769 6e61 7469 6f6e 2c20  for pagination, 
+00012710: 746f 2072 6574 7269 6576 6520 6e65 7874  to retrieve next
+00012720: 2070 6167 652e 0a20 2020 2020 2020 203a   page..        :
+00012730: 7061 7261 6d20 6669 6c74 6572 5f3a 204b  param filter_: K
+00012740: 7562 6572 6e65 7465 7320 6669 6c74 6572  ubernetes filter
+00012750: 2074 6f20 6170 706c 7920 746f 2074 6865   to apply to the
+00012760: 2071 7565 7279 2c20 6361 6e20 6265 2075   query, can be u
+00012770: 7365 6420 746f 2066 696c 7465 7220 6f6e  sed to filter on
+00012780: 2073 7065 6369 6669 6320 6f62 6a65 6374   specific object
+00012790: 2066 6965 6c64 732e 0a20 2020 2020 2020   fields..       
+000127a0: 203a 7061 7261 6d20 666f 726d 6174 5f3a   :param format_:
+000127b0: 2052 6573 756c 7420 666f 726d 6174 2e20   Result format. 
+000127c0: 4361 6e20 6265 206f 6e65 206f 663a 0a0a  Can be one of:..
+000127d0: 2020 2020 2020 2020 2020 2020 2d20 6060              - ``
+000127e0: 6675 6c6c 6060 202d 2072 6574 7572 6e20  full`` - return 
+000127f0: 7468 6520 6675 6c6c 206f 626a 6563 7473  the full objects
+00012800: 2e0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
+00012810: 6060 6d65 7461 6461 7461 5f6f 6e6c 7960  ``metadata_only`
+00012820: 6020 2864 6566 6175 6c74 2920 2d20 7265  ` (default) - re
+00012830: 7475 726e 206a 7573 7420 6d65 7461 6461  turn just metada
+00012840: 7461 206f 6620 7468 6520 7069 7065 6c69  ta of the pipeli
+00012850: 6e65 7320 6f62 6a65 6374 732e 0a20 2020  nes objects..   
+00012860: 2020 2020 2020 2020 202d 2060 606e 616d           - ``nam
+00012870: 655f 6f6e 6c79 6060 202d 2072 6574 7572  e_only`` - retur
+00012880: 6e20 6a75 7374 2074 6865 206e 616d 6573  n just the names
+00012890: 206f 6620 7468 6520 7069 7065 6c69 6e65   of the pipeline
+000128a0: 206f 626a 6563 7473 2e0a 2020 2020 2020   objects..      
+000128b0: 2020 3a70 6172 616d 2070 6167 655f 7369    :param page_si
+000128c0: 7a65 3a20 5369 7a65 206f 6620 6120 7369  ze: Size of a si
+000128d0: 6e67 6c65 2070 6167 6520 7768 656e 2061  ngle page when a
+000128e0: 7070 6c79 696e 6720 7061 6769 6e61 7469  pplying paginati
+000128f0: 6f6e 2e0a 2020 2020 2020 2020 2222 220a  on..        """.
+00012900: 0a20 2020 2020 2020 2069 6620 7072 6f6a  .        if proj
+00012910: 6563 7420 213d 2022 2a22 2061 6e64 2028  ect != "*" and (
+00012920: 7061 6765 5f74 6f6b 656e 206f 7220 7061  page_token or pa
+00012930: 6765 5f73 697a 6529 3a0a 2020 2020 2020  ge_size):.      
+00012940: 2020 2020 2020 7261 6973 6520 6d6c 7275        raise mlru
+00012950: 6e2e 6572 726f 7273 2e4d 4c52 756e 496e  n.errors.MLRunIn
+00012960: 7661 6c69 6441 7267 756d 656e 7445 7272  validArgumentErr
+00012970: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+00012980: 2020 2020 2246 696c 7465 7269 6e67 2062      "Filtering b
+00012990: 7920 7072 6f6a 6563 7420 6361 6e20 6e6f  y project can no
+000129a0: 7420 6265 2075 7365 6420 746f 6765 7468  t be used togeth
+000129b0: 6572 2077 6974 6820 7061 6769 6e61 7469  er with paginati
+000129c0: 6f6e 220a 2020 2020 2020 2020 2020 2020  on".            
+000129d0: 290a 2020 2020 2020 2020 7061 7261 6d73  ).        params
+000129e0: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
+000129f0: 2022 6e61 6d65 7370 6163 6522 3a20 6e61   "namespace": na
+00012a00: 6d65 7370 6163 652c 0a20 2020 2020 2020  mespace,.       
+00012a10: 2020 2020 2022 736f 7274 5f62 7922 3a20       "sort_by": 
+00012a20: 736f 7274 5f62 792c 0a20 2020 2020 2020  sort_by,.       
+00012a30: 2020 2020 2022 7061 6765 5f74 6f6b 656e       "page_token
+00012a40: 223a 2070 6167 655f 746f 6b65 6e2c 0a20  ": page_token,. 
+00012a50: 2020 2020 2020 2020 2020 2022 6669 6c74             "filt
+00012a60: 6572 223a 2066 696c 7465 725f 2c0a 2020  er": filter_,.  
+00012a70: 2020 2020 2020 2020 2020 2266 6f72 6d61            "forma
+00012a80: 7422 3a20 666f 726d 6174 5f2c 0a20 2020  t": format_,.   
+00012a90: 2020 2020 2020 2020 2022 7061 6765 5f73           "page_s
+00012aa0: 697a 6522 3a20 7061 6765 5f73 697a 652c  ize": page_size,
+00012ab0: 0a20 2020 2020 2020 207d 0a0a 2020 2020  .        }..    
+00012ac0: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
+00012ad0: 6520 3d20 6622 4661 696c 6564 206c 6973  e = f"Failed lis
+00012ae0: 7469 6e67 2070 6970 656c 696e 6573 2c20  ting pipelines, 
+00012af0: 7175 6572 793a 207b 7061 7261 6d73 7d22  query: {params}"
+00012b00: 0a20 2020 2020 2020 2072 6573 706f 6e73  .        respons
+00012b10: 6520 3d20 7365 6c66 2e61 7069 5f63 616c  e = self.api_cal
+00012b20: 6c28 0a20 2020 2020 2020 2020 2020 2022  l(.            "
+00012b30: 4745 5422 2c20 6622 7072 6f6a 6563 7473  GET", f"projects
+00012b40: 2f7b 7072 6f6a 6563 747d 2f70 6970 656c  /{project}/pipel
+00012b50: 696e 6573 222c 2065 7272 6f72 5f6d 6573  ines", error_mes
+00012b60: 7361 6765 2c20 7061 7261 6d73 3d70 6172  sage, params=par
+00012b70: 616d 730a 2020 2020 2020 2020 290a 2020  ams.        ).  
+00012b80: 2020 2020 2020 7265 7475 726e 206d 6c72        return mlr
+00012b90: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+00012ba0: 732e 5069 7065 6c69 6e65 734f 7574 7075  s.PipelinesOutpu
+00012bb0: 7428 2a2a 7265 7370 6f6e 7365 2e6a 736f  t(**response.jso
+00012bc0: 6e28 2929 0a0a 2020 2020 6465 6620 6765  n())..    def ge
+00012bd0: 745f 7069 7065 6c69 6e65 280a 2020 2020  t_pipeline(.    
+00012be0: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+00012bf0: 2020 7275 6e5f 6964 3a20 7374 722c 0a20    run_id: str,. 
+00012c00: 2020 2020 2020 206e 616d 6573 7061 6365         namespace
+00012c10: 3a20 7374 7220 3d20 4e6f 6e65 2c0a 2020  : str = None,.  
+00012c20: 2020 2020 2020 7469 6d65 6f75 743a 2069        timeout: i
+00012c30: 6e74 203d 2033 302c 0a20 2020 2020 2020  nt = 30,.       
+00012c40: 2066 6f72 6d61 745f 3a20 556e 696f 6e5b   format_: Union[
+00012c50: 0a20 2020 2020 2020 2020 2020 2073 7472  .            str
+00012c60: 2c20 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  , mlrun.common.s
+00012c70: 6368 656d 6173 2e50 6970 656c 696e 6573  chemas.Pipelines
+00012c80: 466f 726d 6174 0a20 2020 2020 2020 205d  Format.        ]
+00012c90: 203d 206d 6c72 756e 2e63 6f6d 6d6f 6e2e   = mlrun.common.
+00012ca0: 7363 6865 6d61 732e 5069 7065 6c69 6e65  schemas.Pipeline
+00012cb0: 7346 6f72 6d61 742e 7375 6d6d 6172 792c  sFormat.summary,
+00012cc0: 0a20 2020 2020 2020 2070 726f 6a65 6374  .        project
+00012cd0: 3a20 7374 7220 3d20 4e6f 6e65 2c0a 2020  : str = None,.  
+00012ce0: 2020 293a 0a20 2020 2020 2020 2022 2222    ):.        """
+00012cf0: 5265 7472 6965 7665 2064 6574 6169 6c73  Retrieve details
+00012d00: 206f 6620 6120 7370 6563 6966 6963 2070   of a specific p
+00012d10: 6970 656c 696e 6520 7573 696e 6720 6974  ipeline using it
+00012d20: 7320 7275 6e20 4944 2028 6173 2070 726f  s run ID (as pro
+00012d30: 7669 6465 6420 7768 656e 2074 6865 2070  vided when the p
+00012d40: 6970 656c 696e 6520 7761 7320 6578 6563  ipeline was exec
+00012d50: 7574 6564 292e 2222 220a 0a20 2020 2020  uted)."""..     
+00012d60: 2020 2070 6172 616d 7320 3d20 7b7d 0a20     params = {}. 
+00012d70: 2020 2020 2020 2069 6620 6e61 6d65 7370         if namesp
+00012d80: 6163 653a 0a20 2020 2020 2020 2020 2020  ace:.           
+00012d90: 2070 6172 616d 735b 226e 616d 6573 7061   params["namespa
+00012da0: 6365 225d 203d 206e 616d 6573 7061 6365  ce"] = namespace
+00012db0: 0a20 2020 2020 2020 2070 6172 616d 735b  .        params[
+00012dc0: 2266 6f72 6d61 7422 5d20 3d20 666f 726d  "format"] = form
+00012dd0: 6174 5f0a 2020 2020 2020 2020 7072 6f6a  at_.        proj
+00012de0: 6563 745f 7061 7468 203d 2070 726f 6a65  ect_path = proje
+00012df0: 6374 2069 6620 7072 6f6a 6563 7420 656c  ct if project el
+00012e00: 7365 2022 2a22 0a20 2020 2020 2020 2072  se "*".        r
+00012e10: 6573 7020 3d20 7365 6c66 2e61 7069 5f63  esp = self.api_c
+00012e20: 616c 6c28 0a20 2020 2020 2020 2020 2020  all(.           
+00012e30: 2022 4745 5422 2c0a 2020 2020 2020 2020   "GET",.        
+00012e40: 2020 2020 6622 7072 6f6a 6563 7473 2f7b      f"projects/{
+00012e50: 7072 6f6a 6563 745f 7061 7468 7d2f 7069  project_path}/pi
+00012e60: 7065 6c69 6e65 732f 7b72 756e 5f69 647d  pelines/{run_id}
+00012e70: 222c 0a20 2020 2020 2020 2020 2020 2070  ",.            p
+00012e80: 6172 616d 733d 7061 7261 6d73 2c0a 2020  arams=params,.  
+00012e90: 2020 2020 2020 2020 2020 7469 6d65 6f75            timeou
+00012ea0: 743d 7469 6d65 6f75 742c 0a20 2020 2020  t=timeout,.     
+00012eb0: 2020 2029 0a0a 2020 2020 2020 2020 6966     )..        if
+00012ec0: 206e 6f74 2072 6573 702e 6f6b 3a0a 2020   not resp.ok:.  
+00012ed0: 2020 2020 2020 2020 2020 6c6f 6767 6572            logger
+00012ee0: 2e65 7272 6f72 2866 2262 6164 2072 6573  .error(f"bad res
+00012ef0: 7021 215c 6e7b 7265 7370 2e74 6578 747d  p!!\n{resp.text}
+00012f00: 2229 0a20 2020 2020 2020 2020 2020 2072  ").            r
+00012f10: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+00012f20: 6622 6261 6420 6765 7420 7069 7065 6c69  f"bad get pipeli
+00012f30: 6e65 2072 6573 706f 6e73 652c 207b 7265  ne response, {re
+00012f40: 7370 2e74 6578 747d 2229 0a0a 2020 2020  sp.text}")..    
+00012f50: 2020 2020 7265 7475 726e 2072 6573 702e      return resp.
+00012f60: 6a73 6f6e 2829 0a0a 2020 2020 4073 7461  json()..    @sta
+00012f70: 7469 636d 6574 686f 640a 2020 2020 6465  ticmethod.    de
+00012f80: 6620 5f72 6573 6f6c 7665 5f72 6566 6572  f _resolve_refer
+00012f90: 656e 6365 2874 6167 2c20 7569 6429 3a0a  ence(tag, uid):.
+00012fa0: 2020 2020 2020 2020 6966 2075 6964 2061          if uid a
+00012fb0: 6e64 2074 6167 3a0a 2020 2020 2020 2020  nd tag:.        
+00012fc0: 2020 2020 7261 6973 6520 4d4c 5275 6e49      raise MLRunI
+00012fd0: 6e76 616c 6964 4172 6775 6d65 6e74 4572  nvalidArgumentEr
+00012fe0: 726f 7228 2262 6f74 6820 7569 6420 616e  ror("both uid an
+00012ff0: 6420 7461 6720 7765 7265 2070 726f 7669  d tag were provi
+00013000: 6465 6422 290a 2020 2020 2020 2020 7265  ded").        re
+00013010: 7475 726e 2075 6964 206f 7220 7461 6720  turn uid or tag 
+00013020: 6f72 2022 6c61 7465 7374 220a 0a20 2020  or "latest"..   
+00013030: 2064 6566 2063 7265 6174 655f 6665 6174   def create_feat
+00013040: 7572 655f 7365 7428 0a20 2020 2020 2020  ure_set(.       
+00013050: 2073 656c 662c 0a20 2020 2020 2020 2066   self,.        f
+00013060: 6561 7475 7265 5f73 6574 3a20 556e 696f  eature_set: Unio
+00013070: 6e5b 6469 6374 2c20 6d6c 7275 6e2e 636f  n[dict, mlrun.co
+00013080: 6d6d 6f6e 2e73 6368 656d 6173 2e46 6561  mmon.schemas.Fea
+00013090: 7475 7265 5365 742c 2046 6561 7475 7265  tureSet, Feature
+000130a0: 5365 745d 2c0a 2020 2020 2020 2020 7072  Set],.        pr
+000130b0: 6f6a 6563 743d 2222 2c0a 2020 2020 2020  oject="",.      
+000130c0: 2020 7665 7273 696f 6e65 643d 5472 7565    versioned=True
+000130d0: 2c0a 2020 2020 2920 2d3e 2064 6963 743a  ,.    ) -> dict:
+000130e0: 0a20 2020 2020 2020 2022 2222 4372 6561  .        """Crea
+000130f0: 7465 2061 206e 6577 203a 7079 3a63 6c61  te a new :py:cla
+00013100: 7373 3a60 7e6d 6c72 756e 2e66 6561 7475  ss:`~mlrun.featu
+00013110: 7265 5f73 746f 7265 2e46 6561 7475 7265  re_store.Feature
+00013120: 5365 7460 2061 6e64 2073 6176 6520 696e  Set` and save in
+00013130: 2074 6865 203a 7079 3a6d 6f64 3a60 6d6c   the :py:mod:`ml
+00013140: 7275 6e60 2044 422e 2054 6865 0a20 2020  run` DB. The.   
+00013150: 2020 2020 2066 6561 7475 7265 2d73 6574       feature-set
+00013160: 206d 7573 7420 6e6f 7420 7072 6576 696f   must not previo
+00013170: 7573 6c79 2065 7869 7374 2069 6e20 7468  usly exist in th
+00013180: 6520 4442 2e0a 0a20 2020 2020 2020 203a  e DB...        :
+00013190: 7061 7261 6d20 6665 6174 7572 655f 7365  param feature_se
+000131a0: 743a 2054 6865 206e 6577 203a 7079 3a63  t: The new :py:c
+000131b0: 6c61 7373 3a60 7e6d 6c72 756e 2e66 6561  lass:`~mlrun.fea
+000131c0: 7475 7265 5f73 746f 7265 2e46 6561 7475  ture_store.Featu
+000131d0: 7265 5365 7460 2074 6f20 6372 6561 7465  reSet` to create
+000131e0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+000131f0: 2070 726f 6a65 6374 3a20 4e61 6d65 206f   project: Name o
+00013200: 6620 7072 6f6a 6563 7420 7468 6973 2066  f project this f
+00013210: 6561 7475 7265 2d73 6574 2062 656c 6f6e  eature-set belon
+00013220: 6773 2074 6f2e 0a20 2020 2020 2020 203a  gs to..        :
+00013230: 7061 7261 6d20 7665 7273 696f 6e65 643a  param versioned:
+00013240: 2057 6865 7468 6572 2074 6f20 6d61 696e   Whether to main
+00013250: 7461 696e 2076 6572 7369 6f6e 7320 666f  tain versions fo
+00013260: 7220 7468 6973 2066 6561 7475 7265 2d73  r this feature-s
+00013270: 6574 2e20 416c 6c20 7665 7273 696f 6e73  et. All versions
+00013280: 206f 6620 6120 7665 7273 696f 6e65 6420   of a versioned 
+00013290: 6f62 6a65 6374 0a20 2020 2020 2020 2020  object.         
+000132a0: 2020 2077 696c 6c20 6265 206b 6570 7420     will be kept 
+000132b0: 696e 2074 6865 2044 4220 616e 6420 6361  in the DB and ca
+000132c0: 6e20 6265 2072 6574 7269 6576 6564 2075  n be retrieved u
+000132d0: 6e74 696c 2065 7870 6c69 6369 746c 7920  ntil explicitly 
+000132e0: 6465 6c65 7465 642e 0a20 2020 2020 2020  deleted..       
+000132f0: 203a 7265 7475 726e 733a 2054 6865 203a   :returns: The :
+00013300: 7079 3a63 6c61 7373 3a60 7e6d 6c72 756e  py:class:`~mlrun
+00013310: 2e66 6561 7475 7265 5f73 746f 7265 2e46  .feature_store.F
+00013320: 6561 7475 7265 5365 7460 206f 626a 6563  eatureSet` objec
+00013330: 7420 2861 7320 6469 6374 292e 0a20 2020  t (as dict)..   
+00013340: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00013350: 2069 6620 6973 696e 7374 616e 6365 2866   if isinstance(f
+00013360: 6561 7475 7265 5f73 6574 2c20 6d6c 7275  eature_set, mlru
+00013370: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
+00013380: 2e46 6561 7475 7265 5365 7429 3a0a 2020  .FeatureSet):.  
+00013390: 2020 2020 2020 2020 2020 6665 6174 7572            featur
+000133a0: 655f 7365 7420 3d20 6665 6174 7572 655f  e_set = feature_
+000133b0: 7365 742e 6469 6374 2829 0a20 2020 2020  set.dict().     
+000133c0: 2020 2065 6c69 6620 6973 696e 7374 616e     elif isinstan
+000133d0: 6365 2866 6561 7475 7265 5f73 6574 2c20  ce(feature_set, 
+000133e0: 4665 6174 7572 6553 6574 293a 0a20 2020  FeatureSet):.   
+000133f0: 2020 2020 2020 2020 2066 6561 7475 7265           feature
+00013400: 5f73 6574 203d 2066 6561 7475 7265 5f73  _set = feature_s
+00013410: 6574 2e74 6f5f 6469 6374 2829 0a0a 2020  et.to_dict()..  
+00013420: 2020 2020 2020 7072 6f6a 6563 7420 3d20        project = 
+00013430: 280a 2020 2020 2020 2020 2020 2020 7072  (.            pr
+00013440: 6f6a 6563 740a 2020 2020 2020 2020 2020  oject.          
+00013450: 2020 6f72 2066 6561 7475 7265 5f73 6574    or feature_set
+00013460: 5b22 6d65 7461 6461 7461 225d 2e67 6574  ["metadata"].get
+00013470: 2822 7072 6f6a 6563 7422 2c20 4e6f 6e65  ("project", None
+00013480: 290a 2020 2020 2020 2020 2020 2020 6f72  ).            or
+00013490: 2063 6f6e 6669 672e 6465 6661 756c 745f   config.default_
+000134a0: 7072 6f6a 6563 740a 2020 2020 2020 2020  project.        
+000134b0: 290a 2020 2020 2020 2020 7061 7468 203d  ).        path =
+000134c0: 2066 2270 726f 6a65 6374 732f 7b70 726f   f"projects/{pro
+000134d0: 6a65 6374 7d2f 6665 6174 7572 652d 7365  ject}/feature-se
+000134e0: 7473 220a 2020 2020 2020 2020 7061 7261  ts".        para
+000134f0: 6d73 203d 207b 2276 6572 7369 6f6e 6564  ms = {"versioned
+00013500: 223a 2076 6572 7369 6f6e 6564 7d0a 0a20  ": versioned}.. 
+00013510: 2020 2020 2020 206e 616d 6520 3d20 6665         name = fe
+00013520: 6174 7572 655f 7365 745b 226d 6574 6164  ature_set["metad
+00013530: 6174 6122 5d5b 226e 616d 6522 5d0a 2020  ata"]["name"].  
+00013540: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
+00013550: 6167 6520 3d20 6622 4661 696c 6564 2063  age = f"Failed c
+00013560: 7265 6174 696e 6720 6665 6174 7572 652d  reating feature-
+00013570: 7365 7420 7b70 726f 6a65 6374 7d2f 7b6e  set {project}/{n
+00013580: 616d 657d 220a 2020 2020 2020 2020 7265  ame}".        re
+00013590: 7370 203d 2073 656c 662e 6170 695f 6361  sp = self.api_ca
+000135a0: 6c6c 280a 2020 2020 2020 2020 2020 2020  ll(.            
+000135b0: 2250 4f53 5422 2c0a 2020 2020 2020 2020  "POST",.        
+000135c0: 2020 2020 7061 7468 2c0a 2020 2020 2020      path,.      
+000135d0: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
+000135e0: 6167 652c 0a20 2020 2020 2020 2020 2020  age,.           
+000135f0: 2070 6172 616d 733d 7061 7261 6d73 2c0a   params=params,.
+00013600: 2020 2020 2020 2020 2020 2020 626f 6479              body
+00013610: 3d64 6963 745f 746f 5f6a 736f 6e28 6665  =dict_to_json(fe
+00013620: 6174 7572 655f 7365 7429 2c0a 2020 2020  ature_set),.    
+00013630: 2020 2020 290a 2020 2020 2020 2020 7265      ).        re
+00013640: 7475 726e 2072 6573 702e 6a73 6f6e 2829  turn resp.json()
+00013650: 0a0a 2020 2020 6465 6620 6765 745f 6665  ..    def get_fe
+00013660: 6174 7572 655f 7365 7428 0a20 2020 2020  ature_set(.     
+00013670: 2020 2073 656c 662c 206e 616d 653a 2073     self, name: s
+00013680: 7472 2c20 7072 6f6a 6563 743a 2073 7472  tr, project: str
+00013690: 203d 2022 222c 2074 6167 3a20 7374 7220   = "", tag: str 
+000136a0: 3d20 4e6f 6e65 2c20 7569 643a 2073 7472  = None, uid: str
+000136b0: 203d 204e 6f6e 650a 2020 2020 2920 2d3e   = None.    ) ->
+000136c0: 2046 6561 7475 7265 5365 743a 0a20 2020   FeatureSet:.   
+000136d0: 2020 2020 2022 2222 5265 7472 6965 7665       """Retrieve
+000136e0: 2061 207e 6d6c 7275 6e2e 6665 6174 7572   a ~mlrun.featur
+000136f0: 655f 7374 6f72 652e 4665 6174 7572 6553  e_store.FeatureS
+00013700: 6574 6020 6f62 6a65 6374 2e20 4966 2062  et` object. If b
+00013710: 6f74 6820 6060 7461 6760 6020 616e 6420  oth ``tag`` and 
+00013720: 6060 7569 6460 6020 6172 6520 6e6f 7420  ``uid`` are not 
+00013730: 7370 6563 6966 6965 642c 2074 6865 6e0a  specified, then.
+00013740: 2020 2020 2020 2020 7468 6520 6f62 6a65          the obje
+00013750: 6374 2074 6167 6765 6420 6060 6c61 7465  ct tagged ``late
+00013760: 7374 6060 2077 696c 6c20 6265 2072 6574  st`` will be ret
+00013770: 7269 6576 6564 2e0a 0a20 2020 2020 2020  rieved...       
+00013780: 203a 7061 7261 6d20 6e61 6d65 3a20 4e61   :param name: Na
+00013790: 6d65 206f 6620 6f62 6a65 6374 2074 6f20  me of object to 
+000137a0: 7265 7472 6965 7665 2e0a 2020 2020 2020  retrieve..      
+000137b0: 2020 3a70 6172 616d 2070 726f 6a65 6374    :param project
+000137c0: 3a20 5072 6f6a 6563 7420 7468 6520 4665  : Project the Fe
+000137d0: 6174 7572 6553 6574 2062 656c 6f6e 6773  atureSet belongs
+000137e0: 2074 6f2e 0a20 2020 2020 2020 203a 7061   to..        :pa
+000137f0: 7261 6d20 7461 673a 2054 6167 206f 6620  ram tag: Tag of 
+00013800: 7468 6520 7370 6563 6966 6963 206f 626a  the specific obj
+00013810: 6563 7420 7665 7273 696f 6e20 746f 2072  ect version to r
+00013820: 6574 7269 6576 652e 0a20 2020 2020 2020  etrieve..       
+00013830: 203a 7061 7261 6d20 7569 643a 2075 6964   :param uid: uid
+00013840: 206f 6620 7468 6520 6f62 6a65 6374 2074   of the object t
+00013850: 6f20 7265 7472 6965 7665 2028 6361 6e20  o retrieve (can 
+00013860: 6f6e 6c79 2062 6520 7573 6564 2066 6f72  only be used for
+00013870: 2076 6572 7369 6f6e 6564 206f 626a 6563   versioned objec
+00013880: 7473 292e 0a20 2020 2020 2020 2022 2222  ts)..        """
+00013890: 0a0a 2020 2020 2020 2020 7072 6f6a 6563  ..        projec
+000138a0: 7420 3d20 7072 6f6a 6563 7420 6f72 2063  t = project or c
+000138b0: 6f6e 6669 672e 6465 6661 756c 745f 7072  onfig.default_pr
+000138c0: 6f6a 6563 740a 2020 2020 2020 2020 7265  oject.        re
+000138d0: 6665 7265 6e63 6520 3d20 7365 6c66 2e5f  ference = self._
+000138e0: 7265 736f 6c76 655f 7265 6665 7265 6e63  resolve_referenc
+000138f0: 6528 7461 672c 2075 6964 290a 2020 2020  e(tag, uid).    
+00013900: 2020 2020 7061 7468 203d 2066 2270 726f      path = f"pro
+00013910: 6a65 6374 732f 7b70 726f 6a65 6374 7d2f  jects/{project}/
+00013920: 6665 6174 7572 652d 7365 7473 2f7b 6e61  feature-sets/{na
+00013930: 6d65 7d2f 7265 6665 7265 6e63 6573 2f7b  me}/references/{
+00013940: 7265 6665 7265 6e63 657d 220a 2020 2020  reference}".    
+00013950: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
+00013960: 6520 3d20 6622 4661 696c 6564 2072 6574  e = f"Failed ret
+00013970: 7269 6576 696e 6720 6665 6174 7572 652d  rieving feature-
+00013980: 7365 7420 7b70 726f 6a65 6374 7d2f 7b6e  set {project}/{n
+00013990: 616d 657d 220a 2020 2020 2020 2020 7265  ame}".        re
+000139a0: 7370 203d 2073 656c 662e 6170 695f 6361  sp = self.api_ca
+000139b0: 6c6c 2822 4745 5422 2c20 7061 7468 2c20  ll("GET", path, 
+000139c0: 6572 726f 725f 6d65 7373 6167 6529 0a20  error_message). 
+000139d0: 2020 2020 2020 2072 6574 7572 6e20 4665         return Fe
+000139e0: 6174 7572 6553 6574 2e66 726f 6d5f 6469  atureSet.from_di
+000139f0: 6374 2872 6573 702e 6a73 6f6e 2829 290a  ct(resp.json()).
+00013a00: 0a20 2020 2064 6566 206c 6973 745f 6665  .    def list_fe
+00013a10: 6174 7572 6573 280a 2020 2020 2020 2020  atures(.        
+00013a20: 7365 6c66 2c0a 2020 2020 2020 2020 7072  self,.        pr
+00013a30: 6f6a 6563 743a 2073 7472 2c0a 2020 2020  oject: str,.    
+00013a40: 2020 2020 6e61 6d65 3a20 7374 7220 3d20      name: str = 
+00013a50: 4e6f 6e65 2c0a 2020 2020 2020 2020 7461  None,.        ta
+00013a60: 673a 2073 7472 203d 204e 6f6e 652c 0a20  g: str = None,. 
+00013a70: 2020 2020 2020 2065 6e74 6974 6965 733a         entities:
+00013a80: 206c 6973 745b 7374 725d 203d 204e 6f6e   list[str] = Non
+00013a90: 652c 0a20 2020 2020 2020 206c 6162 656c  e,.        label
+00013aa0: 733a 206c 6973 745b 7374 725d 203d 204e  s: list[str] = N
+00013ab0: 6f6e 652c 0a20 2020 2029 202d 3e20 6c69  one,.    ) -> li
+00013ac0: 7374 5b64 6963 745d 3a0a 2020 2020 2020  st[dict]:.      
+00013ad0: 2020 2222 224c 6973 7420 6665 6174 7572    """List featur
+00013ae0: 652d 7365 7473 2077 6869 6368 2063 6f6e  e-sets which con
+00013af0: 7461 696e 2073 7065 6369 6669 6320 6665  tain specific fe
+00013b00: 6174 7572 6573 2e20 5468 6973 2066 756e  atures. This fun
+00013b10: 6374 696f 6e20 6d61 7920 7265 7475 726e  ction may return
+00013b20: 206d 756c 7469 706c 6520 7665 7273 696f   multiple versio
+00013b30: 6e73 206f 6620 7468 6520 7361 6d65 0a20  ns of the same. 
+00013b40: 2020 2020 2020 2066 6561 7475 7265 2d73         feature-s
+00013b50: 6574 2069 6620 6120 7370 6563 6966 6963  et if a specific
+00013b60: 2074 6167 2069 7320 6e6f 7420 7265 7175   tag is not requ
+00013b70: 6573 7465 642e 204e 6f74 6520 7468 6174  ested. Note that
+00013b80: 2074 6865 2076 6172 696f 7573 2066 696c   the various fil
+00013b90: 7465 7273 206f 6620 7468 6973 2066 756e  ters of this fun
+00013ba0: 6374 696f 6e20 6163 7475 616c 6c79 0a20  ction actually. 
+00013bb0: 2020 2020 2020 2072 6566 6572 2074 6f20         refer to 
+00013bc0: 7468 6520 6665 6174 7572 652d 7365 7420  the feature-set 
+00013bd0: 6f62 6a65 6374 2063 6f6e 7461 696e 696e  object containin
+00013be0: 6720 7468 6520 6665 6174 7572 6573 2c20  g the features, 
+00013bf0: 6e6f 7420 746f 2074 6865 2066 6561 7475  not to the featu
+00013c00: 7265 7320 7468 656d 7365 6c76 6573 2e0a  res themselves..
+00013c10: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00013c20: 7072 6f6a 6563 743a 2050 726f 6a65 6374  project: Project
+00013c30: 2077 6869 6368 2063 6f6e 7461 696e 7320   which contains 
+00013c40: 7468 6573 6520 6665 6174 7572 6573 2e0a  these features..
+00013c50: 2020 2020 2020 2020 3a70 6172 616d 206e          :param n
+00013c60: 616d 653a 204e 616d 6520 6f66 2074 6865  ame: Name of the
+00013c70: 2066 6561 7475 7265 2074 6f20 6c6f 6f6b   feature to look
+00013c80: 2066 6f72 2e20 5468 6520 6e61 6d65 2069   for. The name i
+00013c90: 7320 7573 6564 2069 6e20 6120 6c69 6b65  s used in a like
+00013ca0: 2071 7565 7279 2c20 616e 6420 6973 206e   query, and is n
+00013cb0: 6f74 2063 6173 652d 7365 6e73 6974 6976  ot case-sensitiv
+00013cc0: 652e 2046 6f72 0a20 2020 2020 2020 2020  e. For.         
+00013cd0: 2020 2065 7861 6d70 6c65 2c20 6c6f 6f6b     example, look
+00013ce0: 696e 6720 666f 7220 6060 6665 6174 6060  ing for ``feat``
+00013cf0: 2077 696c 6c20 7265 7475 726e 2066 6561   will return fea
+00013d00: 7475 7265 7320 7768 6963 6820 6172 6520  tures which are 
+00013d10: 6e61 6d65 6420 6060 4d79 4665 6174 7572  named ``MyFeatur
+00013d20: 6560 6020 6173 2077 656c 6c20 6173 2060  e`` as well as `
+00013d30: 6064 6566 6561 7460 602e 0a20 2020 2020  `defeat``..     
+00013d40: 2020 203a 7061 7261 6d20 7461 673a 2052     :param tag: R
+00013d50: 6574 7572 6e20 6665 6174 7572 652d 7365  eturn feature-se
+00013d60: 7473 2077 6869 6368 2063 6f6e 7461 696e  ts which contain
+00013d70: 2074 6865 2066 6561 7475 7265 7320 6c6f   the features lo
+00013d80: 6f6b 6564 2066 6f72 2c20 616e 6420 6172  oked for, and ar
+00013d90: 6520 7461 6767 6564 2077 6974 6820 7468  e tagged with th
+00013da0: 6520 7370 6563 6966 6963 2074 6167 2e0a  e specific tag..
+00013db0: 2020 2020 2020 2020 3a70 6172 616d 2065          :param e
+00013dc0: 6e74 6974 6965 733a 2052 6574 7572 6e20  ntities: Return 
+00013dd0: 6f6e 6c79 2066 6561 7475 7265 2d73 6574  only feature-set
+00013de0: 7320 7768 6963 6820 636f 6e74 6169 6e20  s which contain 
+00013df0: 616e 2065 6e74 6974 7920 7768 6f73 6520  an entity whose 
+00013e00: 6e61 6d65 2069 7320 636f 6e74 6169 6e65  name is containe
+00013e10: 6420 696e 2074 6869 7320 6c69 7374 2e0a  d in this list..
+00013e20: 2020 2020 2020 2020 3a70 6172 616d 206c          :param l
+00013e30: 6162 656c 733a 2052 6574 7572 6e20 6f6e  abels: Return on
+00013e40: 6c79 2066 6561 7475 7265 2d73 6574 7320  ly feature-sets 
+00013e50: 7768 6963 6820 6172 6520 6c61 6265 6c65  which are labele
+00013e60: 6420 6173 2072 6571 7565 7374 6564 2e0a  d as requested..
+00013e70: 2020 2020 2020 2020 3a72 6574 7572 6e73          :returns
+00013e80: 3a20 4120 6c69 7374 206f 6620 6d61 7070  : A list of mapp
+00013e90: 696e 6720 6672 6f6d 2066 6561 7475 7265  ing from feature
+00013ea0: 2074 6f20 6120 6469 6765 7374 206f 6620   to a digest of 
+00013eb0: 7468 6520 6665 6174 7572 652d 7365 742c  the feature-set,
+00013ec0: 2077 6869 6368 2063 6f6e 7461 696e 7320   which contains 
+00013ed0: 7468 6520 6665 6174 7572 652d 7365 740a  the feature-set.
+00013ee0: 2020 2020 2020 2020 2020 2020 6d65 7461              meta
+00013ef0: 2d64 6174 612e 204d 756c 7469 706c 6520  -data. Multiple 
+00013f00: 656e 7472 6965 7320 6d61 7920 6265 2072  entries may be r
+00013f10: 6574 7572 6e65 6420 666f 7220 616e 7920  eturned for any 
+00013f20: 7370 6563 6966 6963 2066 6561 7475 7265  specific feature
+00013f30: 2064 7565 2074 6f20 6d75 6c74 6970 6c65   due to multiple
+00013f40: 2074 6167 7320 6f72 2076 6572 7369 6f6e   tags or version
+00013f50: 730a 2020 2020 2020 2020 2020 2020 6f66  s.            of
+00013f60: 2074 6865 2066 6561 7475 7265 2d73 6574   the feature-set
+00013f70: 2e0a 2020 2020 2020 2020 2222 220a 0a20  ..        """.. 
+00013f80: 2020 2020 2020 2070 726f 6a65 6374 203d         project =
+00013f90: 2070 726f 6a65 6374 206f 7220 636f 6e66   project or conf
+00013fa0: 6967 2e64 6566 6175 6c74 5f70 726f 6a65  ig.default_proje
+00013fb0: 6374 0a20 2020 2020 2020 2070 6172 616d  ct.        param
+00013fc0: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
+00013fd0: 2020 226e 616d 6522 3a20 6e61 6d65 2c0a    "name": name,.
+00013fe0: 2020 2020 2020 2020 2020 2020 2274 6167              "tag
+00013ff0: 223a 2074 6167 2c0a 2020 2020 2020 2020  ": tag,.        
+00014000: 2020 2020 2265 6e74 6974 7922 3a20 656e      "entity": en
+00014010: 7469 7469 6573 206f 7220 5b5d 2c0a 2020  tities or [],.  
+00014020: 2020 2020 2020 2020 2020 226c 6162 656c            "label
+00014030: 223a 206c 6162 656c 7320 6f72 205b 5d2c  ": labels or [],
+00014040: 0a20 2020 2020 2020 207d 0a0a 2020 2020  .        }..    
+00014050: 2020 2020 7061 7468 203d 2066 2270 726f      path = f"pro
+00014060: 6a65 6374 732f 7b70 726f 6a65 6374 7d2f  jects/{project}/
+00014070: 6665 6174 7572 6573 220a 0a20 2020 2020  features"..     
+00014080: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
+00014090: 203d 2066 2246 6169 6c65 6420 6c69 7374   = f"Failed list
+000140a0: 696e 6720 6665 6174 7572 6573 2c20 7072  ing features, pr
+000140b0: 6f6a 6563 743a 207b 7072 6f6a 6563 747d  oject: {project}
+000140c0: 2c20 7175 6572 793a 207b 7061 7261 6d73  , query: {params
+000140d0: 7d22 0a20 2020 2020 2020 2072 6573 7020  }".        resp 
+000140e0: 3d20 7365 6c66 2e61 7069 5f63 616c 6c28  = self.api_call(
+000140f0: 2247 4554 222c 2070 6174 682c 2065 7272  "GET", path, err
+00014100: 6f72 5f6d 6573 7361 6765 2c20 7061 7261  or_message, para
+00014110: 6d73 3d70 6172 616d 7329 0a20 2020 2020  ms=params).     
+00014120: 2020 2072 6574 7572 6e20 7265 7370 2e6a     return resp.j
+00014130: 736f 6e28 295b 2266 6561 7475 7265 7322  son()["features"
+00014140: 5d0a 0a20 2020 2064 6566 206c 6973 745f  ]..    def list_
+00014150: 656e 7469 7469 6573 280a 2020 2020 2020  entities(.      
+00014160: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+00014170: 7072 6f6a 6563 743a 2073 7472 2c0a 2020  project: str,.  
+00014180: 2020 2020 2020 6e61 6d65 3a20 7374 7220        name: str 
+00014190: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
+000141a0: 7461 673a 2073 7472 203d 204e 6f6e 652c  tag: str = None,
+000141b0: 0a20 2020 2020 2020 206c 6162 656c 733a  .        labels:
+000141c0: 206c 6973 745b 7374 725d 203d 204e 6f6e   list[str] = Non
+000141d0: 652c 0a20 2020 2029 202d 3e20 6c69 7374  e,.    ) -> list
+000141e0: 5b64 6963 745d 3a0a 2020 2020 2020 2020  [dict]:.        
+000141f0: 2222 2252 6574 7269 6576 6520 6120 6c69  """Retrieve a li
+00014200: 7374 206f 6620 656e 7469 7469 6573 2061  st of entities a
+00014210: 6e64 2074 6865 6972 206d 6170 7069 6e67  nd their mapping
+00014220: 2074 6f20 7468 6520 636f 6e74 6169 6e69   to the containi
+00014230: 6e67 2066 6561 7475 7265 2d73 6574 732e  ng feature-sets.
+00014240: 2054 6869 7320 6675 6e63 7469 6f6e 2069   This function i
+00014250: 7320 7369 6d69 6c61 720a 2020 2020 2020  s similar.      
+00014260: 2020 746f 2074 6865 203a 7079 3a66 756e    to the :py:fun
+00014270: 633a 607e 6c69 7374 5f66 6561 7475 7265  c:`~list_feature
+00014280: 7360 2066 756e 6374 696f 6e2c 2061 6e64  s` function, and
+00014290: 2075 7365 7320 7468 6520 7361 6d65 206c   uses the same l
+000142a0: 6f67 6963 2e20 486f 7765 7665 722c 2074  ogic. However, t
+000142b0: 6865 2065 6e74 6974 6965 7320 6172 6520  he entities are 
+000142c0: 6d61 7463 6865 640a 2020 2020 2020 2020  matched.        
+000142d0: 6167 6169 6e73 7420 7468 6520 6e61 6d65  against the name
+000142e0: 2072 6174 6865 7220 7468 616e 2074 6865   rather than the
+000142f0: 2066 6561 7475 7265 732e 0a20 2020 2020   features..     
+00014300: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
+00014310: 7072 6f6a 6563 7420 3d20 7072 6f6a 6563  project = projec
+00014320: 7420 6f72 2063 6f6e 6669 672e 6465 6661  t or config.defa
+00014330: 756c 745f 7072 6f6a 6563 740a 2020 2020  ult_project.    
+00014340: 2020 2020 7061 7261 6d73 203d 207b 0a20      params = {. 
+00014350: 2020 2020 2020 2020 2020 2022 6e61 6d65             "name
+00014360: 223a 206e 616d 652c 0a20 2020 2020 2020  ": name,.       
+00014370: 2020 2020 2022 7461 6722 3a20 7461 672c       "tag": tag,
+00014380: 0a20 2020 2020 2020 2020 2020 2022 6c61  .            "la
+00014390: 6265 6c22 3a20 6c61 6265 6c73 206f 7220  bel": labels or 
+000143a0: 5b5d 2c0a 2020 2020 2020 2020 7d0a 0a20  [],.        }.. 
+000143b0: 2020 2020 2020 2070 6174 6820 3d20 6622         path = f"
+000143c0: 7072 6f6a 6563 7473 2f7b 7072 6f6a 6563  projects/{projec
+000143d0: 747d 2f65 6e74 6974 6965 7322 0a0a 2020  t}/entities"..  
+000143e0: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
+000143f0: 6167 6520 3d20 6622 4661 696c 6564 206c  age = f"Failed l
+00014400: 6973 7469 6e67 2065 6e74 6974 6965 732c  isting entities,
+00014410: 2070 726f 6a65 6374 3a20 7b70 726f 6a65   project: {proje
+00014420: 6374 7d2c 2071 7565 7279 3a20 7b70 6172  ct}, query: {par
+00014430: 616d 737d 220a 2020 2020 2020 2020 7265  ams}".        re
+00014440: 7370 203d 2073 656c 662e 6170 695f 6361  sp = self.api_ca
+00014450: 6c6c 2822 4745 5422 2c20 7061 7468 2c20  ll("GET", path, 
+00014460: 6572 726f 725f 6d65 7373 6167 652c 2070  error_message, p
+00014470: 6172 616d 733d 7061 7261 6d73 290a 2020  arams=params).  
+00014480: 2020 2020 2020 7265 7475 726e 2072 6573        return res
+00014490: 702e 6a73 6f6e 2829 5b22 656e 7469 7469  p.json()["entiti
+000144a0: 6573 225d 0a0a 2020 2020 4073 7461 7469  es"]..    @stati
+000144b0: 636d 6574 686f 640a 2020 2020 6465 6620  cmethod.    def 
+000144c0: 5f67 656e 6572 6174 655f 7061 7274 6974  _generate_partit
+000144d0: 696f 6e5f 6279 5f70 6172 616d 7328 0a20  ion_by_params(. 
+000144e0: 2020 2020 2020 2070 6172 7469 7469 6f6e         partition
+000144f0: 5f62 795f 636c 732c 0a20 2020 2020 2020  _by_cls,.       
+00014500: 2070 6172 7469 7469 6f6e 5f62 792c 0a20   partition_by,. 
+00014510: 2020 2020 2020 2072 6f77 735f 7065 725f         rows_per_
+00014520: 7061 7274 6974 696f 6e2c 0a20 2020 2020  partition,.     
+00014530: 2020 2073 6f72 745f 6279 2c0a 2020 2020     sort_by,.    
+00014540: 2020 2020 6f72 6465 722c 0a20 2020 2020      order,.     
+00014550: 2020 206d 6178 5f70 6172 7469 7469 6f6e     max_partition
+00014560: 733d 4e6f 6e65 2c0a 2020 2020 293a 0a20  s=None,.    ):. 
+00014570: 2020 2020 2020 2070 6172 7469 7469 6f6e         partition
+00014580: 5f70 6172 616d 7320 3d20 7b0a 2020 2020  _params = {.    
+00014590: 2020 2020 2020 2020 2270 6172 7469 7469          "partiti
+000145a0: 6f6e 2d62 7922 3a20 7061 7274 6974 696f  on-by": partitio
+000145b0: 6e5f 6279 2c0a 2020 2020 2020 2020 2020  n_by,.          
+000145c0: 2020 2272 6f77 732d 7065 722d 7061 7274    "rows-per-part
+000145d0: 6974 696f 6e22 3a20 726f 7773 5f70 6572  ition": rows_per
+000145e0: 5f70 6172 7469 7469 6f6e 2c0a 2020 2020  _partition,.    
+000145f0: 2020 2020 2020 2020 2270 6172 7469 7469          "partiti
+00014600: 6f6e 2d73 6f72 742d 6279 223a 2073 6f72  on-sort-by": sor
+00014610: 745f 6279 2c0a 2020 2020 2020 2020 2020  t_by,.          
+00014620: 2020 2270 6172 7469 7469 6f6e 2d6f 7264    "partition-ord
+00014630: 6572 223a 206f 7264 6572 2c0a 2020 2020  er": order,.    
+00014640: 2020 2020 7d0a 2020 2020 2020 2020 6966      }.        if
+00014650: 206d 6178 5f70 6172 7469 7469 6f6e 7320   max_partitions 
+00014660: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+00014670: 2020 2020 2020 2020 2070 6172 7469 7469           partiti
+00014680: 6f6e 5f70 6172 616d 735b 226d 6178 2d70  on_params["max-p
+00014690: 6172 7469 7469 6f6e 7322 5d20 3d20 6d61  artitions"] = ma
+000146a0: 785f 7061 7274 6974 696f 6e73 0a20 2020  x_partitions.   
+000146b0: 2020 2020 2072 6574 7572 6e20 7061 7274       return part
+000146c0: 6974 696f 6e5f 7061 7261 6d73 0a0a 2020  ition_params..  
+000146d0: 2020 6465 6620 6c69 7374 5f66 6561 7475    def list_featu
+000146e0: 7265 5f73 6574 7328 0a20 2020 2020 2020  re_sets(.       
+000146f0: 2073 656c 662c 0a20 2020 2020 2020 2070   self,.        p
+00014700: 726f 6a65 6374 3a20 7374 7220 3d20 2222  roject: str = ""
+00014710: 2c0a 2020 2020 2020 2020 6e61 6d65 3a20  ,.        name: 
+00014720: 7374 7220 3d20 4e6f 6e65 2c0a 2020 2020  str = None,.    
+00014730: 2020 2020 7461 673a 2073 7472 203d 204e      tag: str = N
+00014740: 6f6e 652c 0a20 2020 2020 2020 2073 7461  one,.        sta
+00014750: 7465 3a20 7374 7220 3d20 4e6f 6e65 2c0a  te: str = None,.
+00014760: 2020 2020 2020 2020 656e 7469 7469 6573          entities
+00014770: 3a20 6c69 7374 5b73 7472 5d20 3d20 4e6f  : list[str] = No
+00014780: 6e65 2c0a 2020 2020 2020 2020 6665 6174  ne,.        feat
+00014790: 7572 6573 3a20 6c69 7374 5b73 7472 5d20  ures: list[str] 
+000147a0: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
+000147b0: 6c61 6265 6c73 3a20 6c69 7374 5b73 7472  labels: list[str
 000147c0: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
-000147d0: 2020 7061 7274 6974 696f 6e5f 6f72 6465    partition_orde
-000147e0: 723a 2055 6e69 6f6e 5b0a 2020 2020 2020  r: Union[.      
-000147f0: 2020 2020 2020 6d6c 7275 6e2e 636f 6d6d        mlrun.comm
-00014800: 6f6e 2e73 6368 656d 6173 2e4f 7264 6572  on.schemas.Order
-00014810: 5479 7065 2c20 7374 720a 2020 2020 2020  Type, str.      
-00014820: 2020 5d20 3d20 6d6c 7275 6e2e 636f 6d6d    ] = mlrun.comm
-00014830: 6f6e 2e73 6368 656d 6173 2e4f 7264 6572  on.schemas.Order
-00014840: 5479 7065 2e64 6573 632c 0a20 2020 2029  Type.desc,.    )
-00014850: 202d 3e20 6c69 7374 5b46 6561 7475 7265   -> list[Feature
-00014860: 5365 745d 3a0a 2020 2020 2020 2020 2222  Set]:.        ""
-00014870: 2252 6574 7269 6576 6520 6120 6c69 7374  "Retrieve a list
-00014880: 206f 6620 6665 6174 7572 652d 7365 7473   of feature-sets
-00014890: 206d 6174 6368 696e 6720 7468 6520 6372   matching the cr
-000148a0: 6974 6572 6961 2070 726f 7669 6465 642e  iteria provided.
-000148b0: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-000148c0: 2070 726f 6a65 6374 3a20 5072 6f6a 6563   project: Projec
-000148d0: 7420 6e61 6d65 2e0a 2020 2020 2020 2020  t name..        
-000148e0: 3a70 6172 616d 206e 616d 653a 204e 616d  :param name: Nam
-000148f0: 6520 6f66 2066 6561 7475 7265 2d73 6574  e of feature-set
-00014900: 2074 6f20 6d61 7463 682e 2054 6869 7320   to match. This 
-00014910: 6973 2061 206c 696b 6520 7175 6572 792c  is a like query,
-00014920: 2061 6e64 2069 7320 6361 7365 2d69 6e73   and is case-ins
-00014930: 656e 7369 7469 7665 2e0a 2020 2020 2020  ensitive..      
-00014940: 2020 3a70 6172 616d 2074 6167 3a20 4d61    :param tag: Ma
-00014950: 7463 6820 6665 6174 7572 652d 7365 7473  tch feature-sets
-00014960: 2077 6974 6820 7370 6563 6966 6963 2074   with specific t
-00014970: 6167 2e0a 2020 2020 2020 2020 3a70 6172  ag..        :par
-00014980: 616d 2073 7461 7465 3a20 4d61 7463 6820  am state: Match 
-00014990: 6665 6174 7572 652d 7365 7473 2077 6974  feature-sets wit
-000149a0: 6820 6120 7370 6563 6966 6963 2073 7461  h a specific sta
-000149b0: 7465 2e0a 2020 2020 2020 2020 3a70 6172  te..        :par
-000149c0: 616d 2065 6e74 6974 6965 733a 204d 6174  am entities: Mat
-000149d0: 6368 2066 6561 7475 7265 2d73 6574 7320  ch feature-sets 
-000149e0: 7768 6963 6820 636f 6e74 6169 6e20 656e  which contain en
-000149f0: 7469 7469 6573 2077 686f 7365 206e 616d  tities whose nam
-00014a00: 6520 6973 2069 6e20 7468 6973 206c 6973  e is in this lis
-00014a10: 742e 0a20 2020 2020 2020 203a 7061 7261  t..        :para
-00014a20: 6d20 6665 6174 7572 6573 3a20 4d61 7463  m features: Matc
-00014a30: 6820 6665 6174 7572 652d 7365 7473 2077  h feature-sets w
-00014a40: 6869 6368 2063 6f6e 7461 696e 2066 6561  hich contain fea
-00014a50: 7475 7265 7320 7768 6f73 6520 6e61 6d65  tures whose name
-00014a60: 2069 7320 696e 2074 6869 7320 6c69 7374   is in this list
-00014a70: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00014a80: 206c 6162 656c 733a 204d 6174 6368 2066   labels: Match f
-00014a90: 6561 7475 7265 2d73 6574 7320 7768 6963  eature-sets whic
-00014aa0: 6820 6861 7665 2074 6865 7365 206c 6162  h have these lab
-00014ab0: 656c 732e 0a20 2020 2020 2020 203a 7061  els..        :pa
-00014ac0: 7261 6d20 7061 7274 6974 696f 6e5f 6279  ram partition_by
-00014ad0: 3a20 4669 656c 6420 746f 2067 726f 7570  : Field to group
-00014ae0: 2072 6573 756c 7473 2062 792e 204f 6e6c   results by. Onl
-00014af0: 7920 616c 6c6f 7765 6420 7661 6c75 6520  y allowed value 
-00014b00: 6973 2060 6e61 6d65 602e 2057 6865 6e20  is `name`. When 
-00014b10: 6070 6172 7469 7469 6f6e 5f62 7960 2069  `partition_by` i
-00014b20: 7320 7370 6563 6966 6965 642c 0a20 2020  s specified,.   
-00014b30: 2020 2020 2020 2020 2074 6865 2060 7061           the `pa
-00014b40: 7274 6974 696f 6e5f 736f 7274 5f62 7960  rtition_sort_by`
-00014b50: 2070 6172 616d 6574 6572 206d 7573 7420   parameter must 
-00014b60: 6265 2070 726f 7669 6465 6420 6173 2077  be provided as w
-00014b70: 656c 6c2e 0a20 2020 2020 2020 203a 7061  ell..        :pa
-00014b80: 7261 6d20 726f 7773 5f70 6572 5f70 6172  ram rows_per_par
-00014b90: 7469 7469 6f6e 3a20 486f 7720 6d61 6e79  tition: How many
-00014ba0: 2074 6f70 2072 6f77 7320 2870 6572 2073   top rows (per s
-00014bb0: 6f72 7469 6e67 2064 6566 696e 6564 2062  orting defined b
-00014bc0: 7920 6070 6172 7469 7469 6f6e 5f73 6f72  y `partition_sor
-00014bd0: 745f 6279 6020 616e 6420 6070 6172 7469  t_by` and `parti
-00014be0: 7469 6f6e 5f6f 7264 6572 6029 0a20 2020  tion_order`).   
-00014bf0: 2020 2020 2020 2020 2074 6f20 7265 7475           to retu
-00014c00: 726e 2070 6572 2067 726f 7570 2e20 4465  rn per group. De
-00014c10: 6661 756c 7420 7661 6c75 6520 6973 2031  fault value is 1
-00014c20: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00014c30: 2070 6172 7469 7469 6f6e 5f73 6f72 745f   partition_sort_
-00014c40: 6279 3a20 5768 6174 2066 6965 6c64 2074  by: What field t
-00014c50: 6f20 736f 7274 2074 6865 2072 6573 756c  o sort the resul
-00014c60: 7473 2062 792c 2077 6974 6869 6e20 6561  ts by, within ea
-00014c70: 6368 2070 6172 7469 7469 6f6e 2064 6566  ch partition def
-00014c80: 696e 6564 2062 7920 6070 6172 7469 7469  ined by `partiti
-00014c90: 6f6e 5f62 7960 2e0a 2020 2020 2020 2020  on_by`..        
-00014ca0: 2020 2020 4375 7272 656e 746c 7920 7468      Currently th
-00014cb0: 6520 6f6e 6c79 2061 6c6c 6f77 6564 2076  e only allowed v
-00014cc0: 616c 7565 2061 7265 2060 6372 6561 7465  alue are `create
-00014cd0: 6460 2061 6e64 2060 7570 6461 7465 6460  d` and `updated`
-00014ce0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00014cf0: 2070 6172 7469 7469 6f6e 5f6f 7264 6572   partition_order
-00014d00: 3a20 4f72 6465 7220 6f66 2073 6f72 7469  : Order of sorti
-00014d10: 6e67 2077 6974 6869 6e20 7061 7274 6974  ng within partit
-00014d20: 696f 6e73 202d 2060 6173 6360 206f 7220  ions - `asc` or 
-00014d30: 6064 6573 6360 2e20 4465 6661 756c 7420  `desc`. Default 
-00014d40: 6973 2060 6465 7363 602e 0a20 2020 2020  is `desc`..     
-00014d50: 2020 203a 7265 7475 726e 733a 204c 6973     :returns: Lis
-00014d60: 7420 6f66 206d 6174 6368 696e 6720 3a70  t of matching :p
-00014d70: 793a 636c 6173 733a 607e 6d6c 7275 6e2e  y:class:`~mlrun.
-00014d80: 6665 6174 7572 655f 7374 6f72 652e 4665  feature_store.Fe
-00014d90: 6174 7572 6553 6574 6020 6f62 6a65 6374  atureSet` object
-00014da0: 732e 0a20 2020 2020 2020 2022 2222 0a0a  s..        """..
-00014db0: 2020 2020 2020 2020 7072 6f6a 6563 7420          project 
-00014dc0: 3d20 7072 6f6a 6563 7420 6f72 2063 6f6e  = project or con
-00014dd0: 6669 672e 6465 6661 756c 745f 7072 6f6a  fig.default_proj
-00014de0: 6563 740a 0a20 2020 2020 2020 2070 6172  ect..        par
-00014df0: 616d 7320 3d20 7b0a 2020 2020 2020 2020  ams = {.        
-00014e00: 2020 2020 226e 616d 6522 3a20 6e61 6d65      "name": name
-00014e10: 2c0a 2020 2020 2020 2020 2020 2020 2273  ,.            "s
-00014e20: 7461 7465 223a 2073 7461 7465 2c0a 2020  tate": state,.  
-00014e30: 2020 2020 2020 2020 2020 2274 6167 223a            "tag":
-00014e40: 2074 6167 2c0a 2020 2020 2020 2020 2020   tag,.          
-00014e50: 2020 2265 6e74 6974 7922 3a20 656e 7469    "entity": enti
-00014e60: 7469 6573 206f 7220 5b5d 2c0a 2020 2020  ties or [],.    
-00014e70: 2020 2020 2020 2020 2266 6561 7475 7265          "feature
-00014e80: 223a 2066 6561 7475 7265 7320 6f72 205b  ": features or [
-00014e90: 5d2c 0a20 2020 2020 2020 2020 2020 2022  ],.            "
-00014ea0: 6c61 6265 6c22 3a20 6c61 6265 6c73 206f  label": labels o
-00014eb0: 7220 5b5d 2c0a 2020 2020 2020 2020 7d0a  r [],.        }.
-00014ec0: 2020 2020 2020 2020 6966 2070 6172 7469          if parti
-00014ed0: 7469 6f6e 5f62 793a 0a20 2020 2020 2020  tion_by:.       
-00014ee0: 2020 2020 2070 6172 616d 732e 7570 6461       params.upda
-00014ef0: 7465 280a 2020 2020 2020 2020 2020 2020  te(.            
-00014f00: 2020 2020 7365 6c66 2e5f 6765 6e65 7261      self._genera
-00014f10: 7465 5f70 6172 7469 7469 6f6e 5f62 795f  te_partition_by_
-00014f20: 7061 7261 6d73 280a 2020 2020 2020 2020  params(.        
-00014f30: 2020 2020 2020 2020 2020 2020 6d6c 7275              mlru
-00014f40: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
-00014f50: 2e46 6561 7475 7265 5374 6f72 6550 6172  .FeatureStorePar
-00014f60: 7469 7469 6f6e 4279 4669 656c 642c 0a20  titionByField,. 
-00014f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014f80: 2020 2070 6172 7469 7469 6f6e 5f62 792c     partition_by,
-00014f90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014fa0: 2020 2020 2072 6f77 735f 7065 725f 7061       rows_per_pa
-00014fb0: 7274 6974 696f 6e2c 0a20 2020 2020 2020  rtition,.       
-00014fc0: 2020 2020 2020 2020 2020 2020 2070 6172               par
-00014fd0: 7469 7469 6f6e 5f73 6f72 745f 6279 2c0a  tition_sort_by,.
-00014fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014ff0: 2020 2020 7061 7274 6974 696f 6e5f 6f72      partition_or
-00015000: 6465 722c 0a20 2020 2020 2020 2020 2020  der,.           
-00015010: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-00015020: 2020 2029 0a0a 2020 2020 2020 2020 7061     )..        pa
-00015030: 7468 203d 2066 2270 726f 6a65 6374 732f  th = f"projects/
-00015040: 7b70 726f 6a65 6374 7d2f 6665 6174 7572  {project}/featur
-00015050: 652d 7365 7473 220a 0a20 2020 2020 2020  e-sets"..       
-00015060: 2065 7272 6f72 5f6d 6573 7361 6765 203d   error_message =
-00015070: 2028 0a20 2020 2020 2020 2020 2020 2066   (.            f
-00015080: 2246 6169 6c65 6420 6c69 7374 696e 6720  "Failed listing 
-00015090: 6665 6174 7572 652d 7365 7473 2c20 7072  feature-sets, pr
-000150a0: 6f6a 6563 743a 207b 7072 6f6a 6563 747d  oject: {project}
-000150b0: 2c20 7175 6572 793a 207b 7061 7261 6d73  , query: {params
-000150c0: 7d22 0a20 2020 2020 2020 2029 0a20 2020  }".        ).   
-000150d0: 2020 2020 2072 6573 7020 3d20 7365 6c66       resp = self
-000150e0: 2e61 7069 5f63 616c 6c28 2247 4554 222c  .api_call("GET",
-000150f0: 2070 6174 682c 2065 7272 6f72 5f6d 6573   path, error_mes
-00015100: 7361 6765 2c20 7061 7261 6d73 3d70 6172  sage, params=par
-00015110: 616d 7329 0a20 2020 2020 2020 2066 6561  ams).        fea
-00015120: 7475 7265 5f73 6574 7320 3d20 7265 7370  ture_sets = resp
-00015130: 2e6a 736f 6e28 295b 2266 6561 7475 7265  .json()["feature
-00015140: 5f73 6574 7322 5d0a 2020 2020 2020 2020  _sets"].        
-00015150: 6966 2066 6561 7475 7265 5f73 6574 733a  if feature_sets:
-00015160: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00015170: 7572 6e20 5b46 6561 7475 7265 5365 742e  urn [FeatureSet.
-00015180: 6672 6f6d 5f64 6963 7428 6f62 6a29 2066  from_dict(obj) f
-00015190: 6f72 206f 626a 2069 6e20 6665 6174 7572  or obj in featur
-000151a0: 655f 7365 7473 5d0a 0a20 2020 2064 6566  e_sets]..    def
-000151b0: 2073 746f 7265 5f66 6561 7475 7265 5f73   store_feature_s
-000151c0: 6574 280a 2020 2020 2020 2020 7365 6c66  et(.        self
-000151d0: 2c0a 2020 2020 2020 2020 6665 6174 7572  ,.        featur
-000151e0: 655f 7365 743a 2055 6e69 6f6e 5b64 6963  e_set: Union[dic
-000151f0: 742c 206d 6c72 756e 2e63 6f6d 6d6f 6e2e  t, mlrun.common.
-00015200: 7363 6865 6d61 732e 4665 6174 7572 6553  schemas.FeatureS
-00015210: 6574 2c20 4665 6174 7572 6553 6574 5d2c  et, FeatureSet],
-00015220: 0a20 2020 2020 2020 206e 616d 653d 4e6f  .        name=No
-00015230: 6e65 2c0a 2020 2020 2020 2020 7072 6f6a  ne,.        proj
-00015240: 6563 743d 2222 2c0a 2020 2020 2020 2020  ect="",.        
-00015250: 7461 673d 4e6f 6e65 2c0a 2020 2020 2020  tag=None,.      
-00015260: 2020 7569 643d 4e6f 6e65 2c0a 2020 2020    uid=None,.    
-00015270: 2020 2020 7665 7273 696f 6e65 643d 5472      versioned=Tr
-00015280: 7565 2c0a 2020 2020 2920 2d3e 2064 6963  ue,.    ) -> dic
-00015290: 743a 0a20 2020 2020 2020 2022 2222 5361  t:.        """Sa
-000152a0: 7665 2061 203a 7079 3a63 6c61 7373 3a60  ve a :py:class:`
-000152b0: 7e6d 6c72 756e 2e66 6561 7475 7265 5f73  ~mlrun.feature_s
-000152c0: 746f 7265 2e46 6561 7475 7265 5365 7460  tore.FeatureSet`
-000152d0: 206f 626a 6563 7420 696e 2074 6865 203a   object in the :
-000152e0: 7079 3a6d 6f64 3a60 6d6c 7275 6e60 2044  py:mod:`mlrun` D
-000152f0: 422e 2054 6865 0a20 2020 2020 2020 2066  B. The.        f
-00015300: 6561 7475 7265 2d73 6574 2063 616e 2062  eature-set can b
-00015310: 6520 6569 7468 6572 2061 206e 6577 206f  e either a new o
-00015320: 626a 6563 7420 6f72 2061 206d 6f64 6966  bject or a modif
-00015330: 6963 6174 696f 6e20 746f 2065 7869 7374  ication to exist
-00015340: 696e 6720 6f62 6a65 6374 2072 6566 6572  ing object refer
-00015350: 656e 6365 6420 6279 2074 6865 2070 6172  enced by the par
-00015360: 616d 7320 6f66 0a20 2020 2020 2020 2074  ams of.        t
-00015370: 6865 2066 756e 6374 696f 6e2e 0a0a 2020  he function...  
-00015380: 2020 2020 2020 3a70 6172 616d 2066 6561        :param fea
-00015390: 7475 7265 5f73 6574 3a20 5468 6520 3a70  ture_set: The :p
-000153a0: 793a 636c 6173 733a 607e 6d6c 7275 6e2e  y:class:`~mlrun.
-000153b0: 6665 6174 7572 655f 7374 6f72 652e 4665  feature_store.Fe
-000153c0: 6174 7572 6553 6574 6020 746f 2073 746f  atureSet` to sto
-000153d0: 7265 2e0a 2020 2020 2020 2020 3a70 6172  re..        :par
-000153e0: 616d 206e 616d 653a 2020 2020 4e61 6d65  am name:    Name
-000153f0: 206f 6620 6665 6174 7572 6520 7365 742e   of feature set.
-00015400: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00015410: 7072 6f6a 6563 743a 204e 616d 6520 6f66  project: Name of
-00015420: 2070 726f 6a65 6374 2074 6869 7320 6665   project this fe
-00015430: 6174 7572 652d 7365 7420 6265 6c6f 6e67  ature-set belong
-00015440: 7320 746f 2e0a 2020 2020 2020 2020 3a70  s to..        :p
-00015450: 6172 616d 2074 6167 3a20 5468 6520 6060  aram tag: The ``
-00015460: 7461 6760 6020 6f66 2074 6865 206f 626a  tag`` of the obj
-00015470: 6563 7420 746f 2072 6570 6c61 6365 2069  ect to replace i
-00015480: 6e20 7468 6520 4442 2c20 666f 7220 6578  n the DB, for ex
-00015490: 616d 706c 6520 6060 6c61 7465 7374 6060  ample ``latest``
-000154a0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-000154b0: 2075 6964 3a20 5468 6520 6060 7569 6460   uid: The ``uid`
-000154c0: 6020 6f66 2074 6865 206f 626a 6563 7420  ` of the object 
-000154d0: 746f 2072 6570 6c61 6365 2069 6e20 7468  to replace in th
-000154e0: 6520 4442 2e20 4966 2075 7369 6e67 2074  e DB. If using t
-000154f0: 6869 7320 7061 7261 6d65 7465 722c 2074  his parameter, t
-00015500: 6865 206d 6f64 6966 6965 6420 6f62 6a65  he modified obje
-00015510: 6374 0a20 2020 2020 2020 2020 2020 206d  ct.            m
-00015520: 7573 7420 6861 7665 2074 6865 2073 616d  ust have the sam
-00015530: 6520 6060 7569 6460 6020 6f66 2074 6865  e ``uid`` of the
-00015540: 2070 7265 7669 6f75 736c 792d 6578 6973   previously-exis
-00015550: 7469 6e67 206f 626a 6563 742e 2054 6869  ting object. Thi
-00015560: 7320 6361 6e6e 6f74 2062 6520 7573 6564  s cannot be used
-00015570: 2066 6f72 206e 6f6e 2d76 6572 7369 6f6e   for non-version
-00015580: 6564 206f 626a 6563 7473 2e0a 2020 2020  ed objects..    
-00015590: 2020 2020 3a70 6172 616d 2076 6572 7369      :param versi
-000155a0: 6f6e 6564 3a20 5768 6574 6865 7220 746f  oned: Whether to
-000155b0: 206d 6169 6e74 6169 6e20 7665 7273 696f   maintain versio
-000155c0: 6e73 2066 6f72 2074 6869 7320 6665 6174  ns for this feat
-000155d0: 7572 652d 7365 742e 2041 6c6c 2076 6572  ure-set. All ver
-000155e0: 7369 6f6e 7320 6f66 2061 2076 6572 7369  sions of a versi
-000155f0: 6f6e 6564 206f 626a 6563 740a 2020 2020  oned object.    
-00015600: 2020 2020 2020 2020 7769 6c6c 2062 6520          will be 
-00015610: 6b65 7074 2069 6e20 7468 6520 4442 2061  kept in the DB a
-00015620: 6e64 2063 616e 2062 6520 7265 7472 6965  nd can be retrie
-00015630: 7665 6420 756e 7469 6c20 6578 706c 6963  ved until explic
-00015640: 6974 6c79 2064 656c 6574 6564 2e0a 2020  itly deleted..  
-00015650: 2020 2020 2020 3a72 6574 7572 6e73 3a20        :returns: 
-00015660: 5468 6520 3a70 793a 636c 6173 733a 607e  The :py:class:`~
-00015670: 6d6c 7275 6e2e 6665 6174 7572 655f 7374  mlrun.feature_st
-00015680: 6f72 652e 4665 6174 7572 6553 6574 6020  ore.FeatureSet` 
-00015690: 6f62 6a65 6374 2028 6173 2064 6963 7429  object (as dict)
-000156a0: 2e0a 2020 2020 2020 2020 2222 220a 0a20  ..        """.. 
-000156b0: 2020 2020 2020 2072 6566 6572 656e 6365         reference
-000156c0: 203d 2073 656c 662e 5f72 6573 6f6c 7665   = self._resolve
-000156d0: 5f72 6566 6572 656e 6365 2874 6167 2c20  _reference(tag, 
-000156e0: 7569 6429 0a20 2020 2020 2020 2070 6172  uid).        par
-000156f0: 616d 7320 3d20 7b22 7665 7273 696f 6e65  ams = {"versione
-00015700: 6422 3a20 7665 7273 696f 6e65 647d 0a0a  d": versioned}..
-00015710: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-00015720: 7461 6e63 6528 6665 6174 7572 655f 7365  tance(feature_se
-00015730: 742c 206d 6c72 756e 2e63 6f6d 6d6f 6e2e  t, mlrun.common.
-00015740: 7363 6865 6d61 732e 4665 6174 7572 6553  schemas.FeatureS
-00015750: 6574 293a 0a20 2020 2020 2020 2020 2020  et):.           
-00015760: 2066 6561 7475 7265 5f73 6574 203d 2066   feature_set = f
-00015770: 6561 7475 7265 5f73 6574 2e64 6963 7428  eature_set.dict(
-00015780: 290a 2020 2020 2020 2020 656c 6966 2069  ).        elif i
-00015790: 7369 6e73 7461 6e63 6528 6665 6174 7572  sinstance(featur
-000157a0: 655f 7365 742c 2046 6561 7475 7265 5365  e_set, FeatureSe
-000157b0: 7429 3a0a 2020 2020 2020 2020 2020 2020  t):.            
-000157c0: 6665 6174 7572 655f 7365 7420 3d20 6665  feature_set = fe
-000157d0: 6174 7572 655f 7365 742e 746f 5f64 6963  ature_set.to_dic
-000157e0: 7428 290a 0a20 2020 2020 2020 206e 616d  t()..        nam
-000157f0: 6520 3d20 6e61 6d65 206f 7220 6665 6174  e = name or feat
-00015800: 7572 655f 7365 745b 226d 6574 6164 6174  ure_set["metadat
-00015810: 6122 5d5b 226e 616d 6522 5d0a 2020 2020  a"]["name"].    
-00015820: 2020 2020 7072 6f6a 6563 7420 3d20 280a      project = (.
-00015830: 2020 2020 2020 2020 2020 2020 7072 6f6a              proj
-00015840: 6563 7420 6f72 2066 6561 7475 7265 5f73  ect or feature_s
-00015850: 6574 5b22 6d65 7461 6461 7461 225d 2e67  et["metadata"].g
-00015860: 6574 2822 7072 6f6a 6563 7422 2920 6f72  et("project") or
-00015870: 2063 6f6e 6669 672e 6465 6661 756c 745f   config.default_
-00015880: 7072 6f6a 6563 740a 2020 2020 2020 2020  project.        
-00015890: 290a 2020 2020 2020 2020 7061 7468 203d  ).        path =
-000158a0: 2066 2270 726f 6a65 6374 732f 7b70 726f   f"projects/{pro
-000158b0: 6a65 6374 7d2f 6665 6174 7572 652d 7365  ject}/feature-se
-000158c0: 7473 2f7b 6e61 6d65 7d2f 7265 6665 7265  ts/{name}/refere
-000158d0: 6e63 6573 2f7b 7265 6665 7265 6e63 657d  nces/{reference}
-000158e0: 220a 2020 2020 2020 2020 6572 726f 725f  ".        error_
-000158f0: 6d65 7373 6167 6520 3d20 6622 4661 696c  message = f"Fail
-00015900: 6564 2073 746f 7269 6e67 2066 6561 7475  ed storing featu
-00015910: 7265 2d73 6574 207b 7072 6f6a 6563 747d  re-set {project}
-00015920: 2f7b 6e61 6d65 7d22 0a20 2020 2020 2020  /{name}".       
-00015930: 2072 6573 7020 3d20 7365 6c66 2e61 7069   resp = self.api
-00015940: 5f63 616c 6c28 0a20 2020 2020 2020 2020  _call(.         
-00015950: 2020 2022 5055 5422 2c20 7061 7468 2c20     "PUT", path, 
-00015960: 6572 726f 725f 6d65 7373 6167 652c 2070  error_message, p
-00015970: 6172 616d 733d 7061 7261 6d73 2c20 626f  arams=params, bo
-00015980: 6479 3d64 6963 745f 746f 5f6a 736f 6e28  dy=dict_to_json(
-00015990: 6665 6174 7572 655f 7365 7429 0a20 2020  feature_set).   
-000159a0: 2020 2020 2029 0a20 2020 2020 2020 2072       ).        r
-000159b0: 6574 7572 6e20 7265 7370 2e6a 736f 6e28  eturn resp.json(
-000159c0: 290a 0a20 2020 2064 6566 2070 6174 6368  )..    def patch
-000159d0: 5f66 6561 7475 7265 5f73 6574 280a 2020  _feature_set(.  
-000159e0: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-000159f0: 2020 2020 6e61 6d65 2c0a 2020 2020 2020      name,.      
-00015a00: 2020 6665 6174 7572 655f 7365 745f 7570    feature_set_up
-00015a10: 6461 7465 3a20 6469 6374 2c0a 2020 2020  date: dict,.    
-00015a20: 2020 2020 7072 6f6a 6563 743d 2222 2c0a      project="",.
-00015a30: 2020 2020 2020 2020 7461 673d 4e6f 6e65          tag=None
-00015a40: 2c0a 2020 2020 2020 2020 7569 643d 4e6f  ,.        uid=No
-00015a50: 6e65 2c0a 2020 2020 2020 2020 7061 7463  ne,.        patc
-00015a60: 685f 6d6f 6465 3a20 556e 696f 6e5b 0a20  h_mode: Union[. 
-00015a70: 2020 2020 2020 2020 2020 2073 7472 2c20             str, 
-00015a80: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-00015a90: 656d 6173 2e50 6174 6368 4d6f 6465 0a20  emas.PatchMode. 
-00015aa0: 2020 2020 2020 205d 203d 206d 6c72 756e         ] = mlrun
-00015ab0: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
-00015ac0: 5061 7463 684d 6f64 652e 7265 706c 6163  PatchMode.replac
-00015ad0: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
-00015ae0: 2020 2222 224d 6f64 6966 7920 2870 6174    """Modify (pat
-00015af0: 6368 2920 616e 2065 7869 7374 696e 6720  ch) an existing 
-00015b00: 3a70 793a 636c 6173 733a 607e 6d6c 7275  :py:class:`~mlru
-00015b10: 6e2e 6665 6174 7572 655f 7374 6f72 652e  n.feature_store.
-00015b20: 4665 6174 7572 6553 6574 6020 6f62 6a65  FeatureSet` obje
-00015b30: 6374 2e0a 2020 2020 2020 2020 5468 6520  ct..        The 
-00015b40: 6f62 6a65 6374 2069 7320 6964 656e 7469  object is identi
-00015b50: 6669 6564 2062 7920 6974 7320 6e61 6d65  fied by its name
-00015b60: 2028 616e 6420 7072 6f6a 6563 7420 6974   (and project it
-00015b70: 2062 656c 6f6e 6773 2074 6f29 2c20 6173   belongs to), as
-00015b80: 2077 656c 6c20 6173 206f 7074 696f 6e61   well as optiona
-00015b90: 6c6c 7920 6120 6060 7461 6760 6020 6f72  lly a ``tag`` or
-00015ba0: 2069 7473 0a20 2020 2020 2020 2060 6075   its.        ``u
-00015bb0: 6964 6060 2028 666f 7220 7665 7273 696f  id`` (for versio
-00015bc0: 6e65 6420 6f62 6a65 6374 292e 2049 6620  ned object). If 
-00015bd0: 626f 7468 2060 6074 6167 6060 2061 6e64  both ``tag`` and
-00015be0: 2060 6075 6964 6060 2061 7265 206f 6d69   ``uid`` are omi
-00015bf0: 7474 6564 2074 6865 6e20 7468 6520 6f62  tted then the ob
-00015c00: 6a65 6374 2077 6974 6820 7461 6720 6060  ject with tag ``
-00015c10: 6c61 7465 7374 6060 0a20 2020 2020 2020  latest``.       
-00015c20: 2069 7320 6d6f 6469 6669 6564 2e0a 0a20   is modified... 
-00015c30: 2020 2020 2020 203a 7061 7261 6d20 6e61         :param na
-00015c40: 6d65 3a20 4e61 6d65 206f 6620 7468 6520  me: Name of the 
-00015c50: 6f62 6a65 6374 2074 6f20 7061 7463 682e  object to patch.
-00015c60: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00015c70: 6665 6174 7572 655f 7365 745f 7570 6461  feature_set_upda
-00015c80: 7465 3a20 5468 6520 6d6f 6469 6669 6361  te: The modifica
-00015c90: 7469 6f6e 7320 6e65 6564 6564 2069 6e20  tions needed in 
-00015ca0: 7468 6520 6f62 6a65 6374 2e20 5468 6973  the object. This
-00015cb0: 2070 6172 616d 6574 6572 206f 6e6c 7920   parameter only 
-00015cc0: 6861 7320 7468 6520 6368 616e 6765 7320  has the changes 
-00015cd0: 696e 2069 742c 0a20 2020 2020 2020 2020  in it,.         
-00015ce0: 2020 206e 6f74 2061 2066 756c 6c20 6f62     not a full ob
-00015cf0: 6a65 6374 2e0a 2020 2020 2020 2020 2020  ject..          
-00015d00: 2020 4578 616d 706c 653a 3a0a 0a20 2020    Example::..   
-00015d10: 2020 2020 2020 2020 2020 2020 2066 6561               fea
-00015d20: 7475 7265 5f73 6574 5f75 7064 6174 6520  ture_set_update 
-00015d30: 3d20 7b22 7374 6174 7573 223a 207b 2270  = {"status": {"p
-00015d40: 726f 6365 7373 6564 2220 3a20 5472 7565  rocessed" : True
-00015d50: 7d7d 0a0a 2020 2020 2020 2020 2020 2020  }}..            
-00015d60: 5769 6c6c 2061 7070 6c79 2074 6865 2066  Will apply the f
-00015d70: 6965 6c64 2060 6073 7461 7475 732e 7072  ield ``status.pr
-00015d80: 6f63 6573 7365 6460 6020 746f 2074 6865  ocessed`` to the
-00015d90: 2065 7869 7374 696e 6720 6f62 6a65 6374   existing object
-00015da0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00015db0: 2070 726f 6a65 6374 3a20 5072 6f6a 6563   project: Projec
-00015dc0: 7420 7768 6963 6820 636f 6e74 6169 6e73  t which contains
-00015dd0: 2074 6865 206d 6f64 6966 6965 6420 6f62   the modified ob
-00015de0: 6a65 6374 2e0a 2020 2020 2020 2020 3a70  ject..        :p
-00015df0: 6172 616d 2074 6167 3a20 5468 6520 7461  aram tag: The ta
-00015e00: 6720 6f66 2074 6865 206f 626a 6563 7420  g of the object 
-00015e10: 746f 206d 6f64 6966 792e 0a20 2020 2020  to modify..     
-00015e20: 2020 203a 7061 7261 6d20 7569 643a 2075     :param uid: u
-00015e30: 6964 206f 6620 7468 6520 6f62 6a65 6374  id of the object
-00015e40: 2074 6f20 6d6f 6469 6679 2e0a 2020 2020   to modify..    
-00015e50: 2020 2020 3a70 6172 616d 2070 6174 6368      :param patch
-00015e60: 5f6d 6f64 653a 2054 6865 2073 7472 6174  _mode: The strat
-00015e70: 6567 7920 666f 7220 6d65 7267 696e 6720  egy for merging 
-00015e80: 7468 6520 6368 616e 6765 7320 7769 7468  the changes with
-00015e90: 2074 6865 2065 7869 7374 696e 6720 6f62   the existing ob
-00015ea0: 6a65 6374 2e20 4361 6e20 6265 2065 6974  ject. Can be eit
-00015eb0: 6865 7220 6060 7265 706c 6163 6560 600a  her ``replace``.
-00015ec0: 2020 2020 2020 2020 2020 2020 6f72 2060              or `
-00015ed0: 6061 6464 6974 6976 6560 602e 0a20 2020  `additive``..   
-00015ee0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00015ef0: 2070 726f 6a65 6374 203d 2070 726f 6a65   project = proje
-00015f00: 6374 206f 7220 636f 6e66 6967 2e64 6566  ct or config.def
-00015f10: 6175 6c74 5f70 726f 6a65 6374 0a20 2020  ault_project.   
-00015f20: 2020 2020 2072 6566 6572 656e 6365 203d       reference =
-00015f30: 2073 656c 662e 5f72 6573 6f6c 7665 5f72   self._resolve_r
-00015f40: 6566 6572 656e 6365 2874 6167 2c20 7569  eference(tag, ui
-00015f50: 6429 0a20 2020 2020 2020 2068 6561 6465  d).        heade
-00015f60: 7273 203d 207b 6d6c 7275 6e2e 636f 6d6d  rs = {mlrun.comm
-00015f70: 6f6e 2e73 6368 656d 6173 2e48 6561 6465  on.schemas.Heade
-00015f80: 724e 616d 6573 2e70 6174 6368 5f6d 6f64  rNames.patch_mod
-00015f90: 653a 2070 6174 6368 5f6d 6f64 657d 0a20  e: patch_mode}. 
-00015fa0: 2020 2020 2020 2070 6174 6820 3d20 6622         path = f"
-00015fb0: 7072 6f6a 6563 7473 2f7b 7072 6f6a 6563  projects/{projec
-00015fc0: 747d 2f66 6561 7475 7265 2d73 6574 732f  t}/feature-sets/
-00015fd0: 7b6e 616d 657d 2f72 6566 6572 656e 6365  {name}/reference
-00015fe0: 732f 7b72 6566 6572 656e 6365 7d22 0a20  s/{reference}". 
-00015ff0: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
-00016000: 7361 6765 203d 2066 2246 6169 6c65 6420  sage = f"Failed 
-00016010: 7570 6461 7469 6e67 2066 6561 7475 7265  updating feature
-00016020: 2d73 6574 207b 7072 6f6a 6563 747d 2f7b  -set {project}/{
-00016030: 6e61 6d65 7d22 0a20 2020 2020 2020 2073  name}".        s
-00016040: 656c 662e 6170 695f 6361 6c6c 280a 2020  elf.api_call(.  
-00016050: 2020 2020 2020 2020 2020 2250 4154 4348            "PATCH
-00016060: 222c 0a20 2020 2020 2020 2020 2020 2070  ",.            p
-00016070: 6174 682c 0a20 2020 2020 2020 2020 2020  ath,.           
-00016080: 2065 7272 6f72 5f6d 6573 7361 6765 2c0a   error_message,.
-00016090: 2020 2020 2020 2020 2020 2020 626f 6479              body
-000160a0: 3d64 6963 745f 746f 5f6a 736f 6e28 6665  =dict_to_json(fe
-000160b0: 6174 7572 655f 7365 745f 7570 6461 7465  ature_set_update
-000160c0: 292c 0a20 2020 2020 2020 2020 2020 2068  ),.            h
-000160d0: 6561 6465 7273 3d68 6561 6465 7273 2c0a  eaders=headers,.
-000160e0: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
-000160f0: 6566 2064 656c 6574 655f 6665 6174 7572  ef delete_featur
-00016100: 655f 7365 7428 7365 6c66 2c20 6e61 6d65  e_set(self, name
-00016110: 2c20 7072 6f6a 6563 743d 2222 2c20 7461  , project="", ta
-00016120: 673d 4e6f 6e65 2c20 7569 643d 4e6f 6e65  g=None, uid=None
-00016130: 293a 0a20 2020 2020 2020 2022 2222 4465  ):.        """De
-00016140: 6c65 7465 2061 203a 7079 3a63 6c61 7373  lete a :py:class
-00016150: 3a60 7e6d 6c72 756e 2e66 6561 7475 7265  :`~mlrun.feature
-00016160: 5f73 746f 7265 2e46 6561 7475 7265 5365  _store.FeatureSe
-00016170: 7460 206f 626a 6563 7420 6672 6f6d 2074  t` object from t
-00016180: 6865 2044 422e 0a20 2020 2020 2020 2049  he DB..        I
-00016190: 6620 6060 7461 6760 6020 6f72 2060 6075  f ``tag`` or ``u
-000161a0: 6964 6060 2061 7265 2073 7065 6369 6669  id`` are specifi
-000161b0: 6564 2c20 7468 656e 206a 7573 7420 7468  ed, then just th
-000161c0: 6520 7665 7273 696f 6e20 7265 6665 7265  e version refere
-000161d0: 6e63 6564 2062 7920 7468 656d 2077 696c  nced by them wil
-000161e0: 6c20 6265 2064 656c 6574 6564 2e20 5573  l be deleted. Us
-000161f0: 696e 6720 626f 7468 0a20 2020 2020 2020  ing both.       
-00016200: 2069 7320 6e6f 7420 616c 6c6f 7765 642e   is not allowed.
-00016210: 0a20 2020 2020 2020 2049 6620 6e6f 6e65  .        If none
-00016220: 2061 7265 2073 7065 6369 6669 6564 2c20   are specified, 
-00016230: 7468 656e 2061 6c6c 2069 6e73 7461 6e63  then all instanc
-00016240: 6573 206f 6620 7468 6520 6f62 6a65 6374  es of the object
-00016250: 2077 686f 7365 206e 616d 6520 6973 2060   whose name is `
-00016260: 606e 616d 6560 6020 7769 6c6c 2062 6520  `name`` will be 
-00016270: 6465 6c65 7465 642e 0a20 2020 2020 2020  deleted..       
-00016280: 2022 2222 0a20 2020 2020 2020 2070 726f   """.        pro
-00016290: 6a65 6374 203d 2070 726f 6a65 6374 206f  ject = project o
-000162a0: 7220 636f 6e66 6967 2e64 6566 6175 6c74  r config.default
-000162b0: 5f70 726f 6a65 6374 0a20 2020 2020 2020  _project.       
-000162c0: 2070 6174 6820 3d20 6622 7072 6f6a 6563   path = f"projec
-000162d0: 7473 2f7b 7072 6f6a 6563 747d 2f66 6561  ts/{project}/fea
-000162e0: 7475 7265 2d73 6574 732f 7b6e 616d 657d  ture-sets/{name}
-000162f0: 220a 0a20 2020 2020 2020 2069 6620 7461  "..        if ta
-00016300: 6720 6f72 2075 6964 3a0a 2020 2020 2020  g or uid:.      
-00016310: 2020 2020 2020 7265 6665 7265 6e63 6520        reference 
-00016320: 3d20 7365 6c66 2e5f 7265 736f 6c76 655f  = self._resolve_
-00016330: 7265 6665 7265 6e63 6528 7461 672c 2075  reference(tag, u
-00016340: 6964 290a 2020 2020 2020 2020 2020 2020  id).            
-00016350: 7061 7468 203d 2070 6174 6820 2b20 6622  path = path + f"
-00016360: 2f72 6566 6572 656e 6365 732f 7b72 6566  /references/{ref
-00016370: 6572 656e 6365 7d22 0a0a 2020 2020 2020  erence}"..      
-00016380: 2020 6572 726f 725f 6d65 7373 6167 6520    error_message 
-00016390: 3d20 6622 4661 696c 6564 2064 656c 6574  = f"Failed delet
-000163a0: 696e 6720 6665 6174 7572 652d 7365 7420  ing feature-set 
-000163b0: 7b6e 616d 657d 220a 2020 2020 2020 2020  {name}".        
-000163c0: 7365 6c66 2e61 7069 5f63 616c 6c28 2244  self.api_call("D
-000163d0: 454c 4554 4522 2c20 7061 7468 2c20 6572  ELETE", path, er
-000163e0: 726f 725f 6d65 7373 6167 6529 0a0a 2020  ror_message)..  
-000163f0: 2020 6465 6620 6372 6561 7465 5f66 6561    def create_fea
-00016400: 7475 7265 5f76 6563 746f 7228 0a20 2020  ture_vector(.   
-00016410: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-00016420: 2020 2066 6561 7475 7265 5f76 6563 746f     feature_vecto
-00016430: 723a 2055 6e69 6f6e 5b64 6963 742c 206d  r: Union[dict, m
-00016440: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
-00016450: 6d61 732e 4665 6174 7572 6556 6563 746f  mas.FeatureVecto
-00016460: 722c 2046 6561 7475 7265 5665 6374 6f72  r, FeatureVector
-00016470: 5d2c 0a20 2020 2020 2020 2070 726f 6a65  ],.        proje
-00016480: 6374 3d22 222c 0a20 2020 2020 2020 2076  ct="",.        v
-00016490: 6572 7369 6f6e 6564 3d54 7275 652c 0a20  ersioned=True,. 
-000164a0: 2020 2029 202d 3e20 6469 6374 3a0a 2020     ) -> dict:.  
-000164b0: 2020 2020 2020 2222 2243 7265 6174 6520        """Create 
-000164c0: 6120 6e65 7720 3a70 793a 636c 6173 733a  a new :py:class:
-000164d0: 607e 6d6c 7275 6e2e 6665 6174 7572 655f  `~mlrun.feature_
-000164e0: 7374 6f72 652e 4665 6174 7572 6556 6563  store.FeatureVec
-000164f0: 746f 7260 2061 6e64 2073 6176 6520 696e  tor` and save in
-00016500: 2074 6865 203a 7079 3a6d 6f64 3a60 6d6c   the :py:mod:`ml
-00016510: 7275 6e60 2044 422e 0a0a 2020 2020 2020  run` DB...      
-00016520: 2020 3a70 6172 616d 2066 6561 7475 7265    :param feature
-00016530: 5f76 6563 746f 723a 2054 6865 206e 6577  _vector: The new
-00016540: 203a 7079 3a63 6c61 7373 3a60 7e6d 6c72   :py:class:`~mlr
-00016550: 756e 2e66 6561 7475 7265 5f73 746f 7265  un.feature_store
-00016560: 2e46 6561 7475 7265 5665 6374 6f72 6020  .FeatureVector` 
-00016570: 746f 2063 7265 6174 652e 0a20 2020 2020  to create..     
-00016580: 2020 203a 7061 7261 6d20 7072 6f6a 6563     :param projec
-00016590: 743a 204e 616d 6520 6f66 2070 726f 6a65  t: Name of proje
-000165a0: 6374 2074 6869 7320 6665 6174 7572 652d  ct this feature-
-000165b0: 7665 6374 6f72 2062 656c 6f6e 6773 2074  vector belongs t
-000165c0: 6f2e 0a20 2020 2020 2020 203a 7061 7261  o..        :para
-000165d0: 6d20 7665 7273 696f 6e65 643a 2057 6865  m versioned: Whe
-000165e0: 7468 6572 2074 6f20 6d61 696e 7461 696e  ther to maintain
-000165f0: 2076 6572 7369 6f6e 7320 666f 7220 7468   versions for th
-00016600: 6973 2066 6561 7475 7265 2d76 6563 746f  is feature-vecto
-00016610: 722e 2041 6c6c 2076 6572 7369 6f6e 7320  r. All versions 
-00016620: 6f66 2061 2076 6572 7369 6f6e 6564 206f  of a versioned o
-00016630: 626a 6563 740a 2020 2020 2020 2020 2020  bject.          
-00016640: 2020 7769 6c6c 2062 6520 6b65 7074 2069    will be kept i
-00016650: 6e20 7468 6520 4442 2061 6e64 2063 616e  n the DB and can
-00016660: 2062 6520 7265 7472 6965 7665 6420 756e   be retrieved un
-00016670: 7469 6c20 6578 706c 6963 6974 6c79 2064  til explicitly d
-00016680: 656c 6574 6564 2e0a 2020 2020 2020 2020  eleted..        
-00016690: 3a72 6574 7572 6e73 3a20 5468 6520 3a70  :returns: The :p
-000166a0: 793a 636c 6173 733a 607e 6d6c 7275 6e2e  y:class:`~mlrun.
-000166b0: 6665 6174 7572 655f 7374 6f72 652e 4665  feature_store.Fe
-000166c0: 6174 7572 6556 6563 746f 7260 206f 626a  atureVector` obj
-000166d0: 6563 7420 2861 7320 6469 6374 292e 0a20  ect (as dict).. 
-000166e0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-000166f0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-00016700: 2866 6561 7475 7265 5f76 6563 746f 722c  (feature_vector,
-00016710: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
-00016720: 6865 6d61 732e 4665 6174 7572 6556 6563  hemas.FeatureVec
-00016730: 746f 7229 3a0a 2020 2020 2020 2020 2020  tor):.          
-00016740: 2020 6665 6174 7572 655f 7665 6374 6f72    feature_vector
-00016750: 203d 2066 6561 7475 7265 5f76 6563 746f   = feature_vecto
-00016760: 722e 6469 6374 2829 0a20 2020 2020 2020  r.dict().       
-00016770: 2065 6c69 6620 6973 696e 7374 616e 6365   elif isinstance
-00016780: 2866 6561 7475 7265 5f76 6563 746f 722c  (feature_vector,
-00016790: 2046 6561 7475 7265 5665 6374 6f72 293a   FeatureVector):
-000167a0: 0a20 2020 2020 2020 2020 2020 2066 6561  .            fea
-000167b0: 7475 7265 5f76 6563 746f 7220 3d20 6665  ture_vector = fe
-000167c0: 6174 7572 655f 7665 6374 6f72 2e74 6f5f  ature_vector.to_
-000167d0: 6469 6374 2829 0a0a 2020 2020 2020 2020  dict()..        
-000167e0: 7072 6f6a 6563 7420 3d20 280a 2020 2020  project = (.    
-000167f0: 2020 2020 2020 2020 7072 6f6a 6563 740a          project.
-00016800: 2020 2020 2020 2020 2020 2020 6f72 2066              or f
-00016810: 6561 7475 7265 5f76 6563 746f 725b 226d  eature_vector["m
-00016820: 6574 6164 6174 6122 5d2e 6765 7428 2270  etadata"].get("p
-00016830: 726f 6a65 6374 222c 204e 6f6e 6529 0a20  roject", None). 
-00016840: 2020 2020 2020 2020 2020 206f 7220 636f             or co
-00016850: 6e66 6967 2e64 6566 6175 6c74 5f70 726f  nfig.default_pro
-00016860: 6a65 6374 0a20 2020 2020 2020 2029 0a20  ject.        ). 
-00016870: 2020 2020 2020 2070 6174 6820 3d20 6622         path = f"
-00016880: 7072 6f6a 6563 7473 2f7b 7072 6f6a 6563  projects/{projec
-00016890: 747d 2f66 6561 7475 7265 2d76 6563 746f  t}/feature-vecto
-000168a0: 7273 220a 2020 2020 2020 2020 7061 7261  rs".        para
-000168b0: 6d73 203d 207b 2276 6572 7369 6f6e 6564  ms = {"versioned
-000168c0: 223a 2076 6572 7369 6f6e 6564 7d0a 0a20  ": versioned}.. 
-000168d0: 2020 2020 2020 206e 616d 6520 3d20 6665         name = fe
-000168e0: 6174 7572 655f 7665 6374 6f72 5b22 6d65  ature_vector["me
-000168f0: 7461 6461 7461 225d 5b22 6e61 6d65 225d  tadata"]["name"]
-00016900: 0a20 2020 2020 2020 2065 7272 6f72 5f6d  .        error_m
-00016910: 6573 7361 6765 203d 2066 2246 6169 6c65  essage = f"Faile
-00016920: 6420 6372 6561 7469 6e67 2066 6561 7475  d creating featu
-00016930: 7265 2d76 6563 746f 7220 7b70 726f 6a65  re-vector {proje
-00016940: 6374 7d2f 7b6e 616d 657d 220a 2020 2020  ct}/{name}".    
-00016950: 2020 2020 7265 7370 203d 2073 656c 662e      resp = self.
-00016960: 6170 695f 6361 6c6c 280a 2020 2020 2020  api_call(.      
-00016970: 2020 2020 2020 2250 4f53 5422 2c0a 2020        "POST",.  
-00016980: 2020 2020 2020 2020 2020 7061 7468 2c0a            path,.
-00016990: 2020 2020 2020 2020 2020 2020 6572 726f              erro
-000169a0: 725f 6d65 7373 6167 652c 0a20 2020 2020  r_message,.     
-000169b0: 2020 2020 2020 2070 6172 616d 733d 7061         params=pa
-000169c0: 7261 6d73 2c0a 2020 2020 2020 2020 2020  rams,.          
-000169d0: 2020 626f 6479 3d64 6963 745f 746f 5f6a    body=dict_to_j
-000169e0: 736f 6e28 6665 6174 7572 655f 7665 6374  son(feature_vect
-000169f0: 6f72 292c 0a20 2020 2020 2020 2029 0a20  or),.        ). 
-00016a00: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
-00016a10: 7370 2e6a 736f 6e28 290a 0a20 2020 2064  sp.json()..    d
-00016a20: 6566 2067 6574 5f66 6561 7475 7265 5f76  ef get_feature_v
-00016a30: 6563 746f 7228 0a20 2020 2020 2020 2073  ector(.        s
-00016a40: 656c 662c 206e 616d 653a 2073 7472 2c20  elf, name: str, 
-00016a50: 7072 6f6a 6563 743a 2073 7472 203d 2022  project: str = "
-00016a60: 222c 2074 6167 3a20 7374 7220 3d20 4e6f  ", tag: str = No
-00016a70: 6e65 2c20 7569 643a 2073 7472 203d 204e  ne, uid: str = N
-00016a80: 6f6e 650a 2020 2020 2920 2d3e 2046 6561  one.    ) -> Fea
-00016a90: 7475 7265 5665 6374 6f72 3a0a 2020 2020  tureVector:.    
-00016aa0: 2020 2020 2222 2252 6574 7572 6e20 6120      """Return a 
-00016ab0: 7370 6563 6966 6963 2066 6561 7475 7265  specific feature
-00016ac0: 2d76 6563 746f 7220 7265 6665 7265 6e63  -vector referenc
-00016ad0: 6564 2062 7920 6974 7320 7461 6720 6f72  ed by its tag or
-00016ae0: 2075 6964 2e20 4966 206e 6f6e 6520 6172   uid. If none ar
-00016af0: 6520 7072 6f76 6964 6564 2c20 6060 6c61  e provided, ``la
-00016b00: 7465 7374 6060 2074 6167 2077 696c 6c0a  test`` tag will.
-00016b10: 2020 2020 2020 2020 6265 2075 7365 642e          be used.
-00016b20: 2222 220a 0a20 2020 2020 2020 2070 726f  """..        pro
-00016b30: 6a65 6374 203d 2070 726f 6a65 6374 206f  ject = project o
-00016b40: 7220 636f 6e66 6967 2e64 6566 6175 6c74  r config.default
-00016b50: 5f70 726f 6a65 6374 0a20 2020 2020 2020  _project.       
-00016b60: 2072 6566 6572 656e 6365 203d 2073 656c   reference = sel
-00016b70: 662e 5f72 6573 6f6c 7665 5f72 6566 6572  f._resolve_refer
-00016b80: 656e 6365 2874 6167 2c20 7569 6429 0a20  ence(tag, uid). 
-00016b90: 2020 2020 2020 2070 6174 6820 3d20 6622         path = f"
-00016ba0: 7072 6f6a 6563 7473 2f7b 7072 6f6a 6563  projects/{projec
-00016bb0: 747d 2f66 6561 7475 7265 2d76 6563 746f  t}/feature-vecto
-00016bc0: 7273 2f7b 6e61 6d65 7d2f 7265 6665 7265  rs/{name}/refere
-00016bd0: 6e63 6573 2f7b 7265 6665 7265 6e63 657d  nces/{reference}
-00016be0: 220a 2020 2020 2020 2020 6572 726f 725f  ".        error_
-00016bf0: 6d65 7373 6167 6520 3d20 6622 4661 696c  message = f"Fail
-00016c00: 6564 2072 6574 7269 6576 696e 6720 6665  ed retrieving fe
-00016c10: 6174 7572 652d 7665 6374 6f72 207b 7072  ature-vector {pr
-00016c20: 6f6a 6563 747d 2f7b 6e61 6d65 7d22 0a20  oject}/{name}". 
-00016c30: 2020 2020 2020 2072 6573 7020 3d20 7365         resp = se
-00016c40: 6c66 2e61 7069 5f63 616c 6c28 2247 4554  lf.api_call("GET
-00016c50: 222c 2070 6174 682c 2065 7272 6f72 5f6d  ", path, error_m
-00016c60: 6573 7361 6765 290a 2020 2020 2020 2020  essage).        
-00016c70: 7265 7475 726e 2046 6561 7475 7265 5665  return FeatureVe
-00016c80: 6374 6f72 2e66 726f 6d5f 6469 6374 2872  ctor.from_dict(r
-00016c90: 6573 702e 6a73 6f6e 2829 290a 0a20 2020  esp.json())..   
-00016ca0: 2064 6566 206c 6973 745f 6665 6174 7572   def list_featur
-00016cb0: 655f 7665 6374 6f72 7328 0a20 2020 2020  e_vectors(.     
-00016cc0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-00016cd0: 2070 726f 6a65 6374 3a20 7374 7220 3d20   project: str = 
-00016ce0: 2222 2c0a 2020 2020 2020 2020 6e61 6d65  "",.        name
-00016cf0: 3a20 7374 7220 3d20 4e6f 6e65 2c0a 2020  : str = None,.  
-00016d00: 2020 2020 2020 7461 673a 2073 7472 203d        tag: str =
-00016d10: 204e 6f6e 652c 0a20 2020 2020 2020 2073   None,.        s
-00016d20: 7461 7465 3a20 7374 7220 3d20 4e6f 6e65  tate: str = None
-00016d30: 2c0a 2020 2020 2020 2020 6c61 6265 6c73  ,.        labels
-00016d40: 3a20 6c69 7374 5b73 7472 5d20 3d20 4e6f  : list[str] = No
-00016d50: 6e65 2c0a 2020 2020 2020 2020 7061 7274  ne,.        part
-00016d60: 6974 696f 6e5f 6279 3a20 556e 696f 6e5b  ition_by: Union[
-00016d70: 0a20 2020 2020 2020 2020 2020 206d 6c72  .            mlr
-00016d80: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
-00016d90: 732e 4665 6174 7572 6553 746f 7265 5061  s.FeatureStorePa
-00016da0: 7274 6974 696f 6e42 7946 6965 6c64 2c20  rtitionByField, 
-00016db0: 7374 720a 2020 2020 2020 2020 5d20 3d20  str.        ] = 
-00016dc0: 4e6f 6e65 2c0a 2020 2020 2020 2020 726f  None,.        ro
-00016dd0: 7773 5f70 6572 5f70 6172 7469 7469 6f6e  ws_per_partition
-00016de0: 3a20 696e 7420 3d20 312c 0a20 2020 2020  : int = 1,.     
-00016df0: 2020 2070 6172 7469 7469 6f6e 5f73 6f72     partition_sor
-00016e00: 745f 6279 3a20 556e 696f 6e5b 6d6c 7275  t_by: Union[mlru
-00016e10: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
-00016e20: 2e53 6f72 7446 6965 6c64 2c20 7374 725d  .SortField, str]
+000147d0: 2020 7061 7274 6974 696f 6e5f 6279 3a20    partition_by: 
+000147e0: 556e 696f 6e5b 0a20 2020 2020 2020 2020  Union[.         
+000147f0: 2020 206d 6c72 756e 2e63 6f6d 6d6f 6e2e     mlrun.common.
+00014800: 7363 6865 6d61 732e 4665 6174 7572 6553  schemas.FeatureS
+00014810: 746f 7265 5061 7274 6974 696f 6e42 7946  torePartitionByF
+00014820: 6965 6c64 2c20 7374 720a 2020 2020 2020  ield, str.      
+00014830: 2020 5d20 3d20 4e6f 6e65 2c0a 2020 2020    ] = None,.    
+00014840: 2020 2020 726f 7773 5f70 6572 5f70 6172      rows_per_par
+00014850: 7469 7469 6f6e 3a20 696e 7420 3d20 312c  tition: int = 1,
+00014860: 0a20 2020 2020 2020 2070 6172 7469 7469  .        partiti
+00014870: 6f6e 5f73 6f72 745f 6279 3a20 556e 696f  on_sort_by: Unio
+00014880: 6e5b 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  n[mlrun.common.s
+00014890: 6368 656d 6173 2e53 6f72 7446 6965 6c64  chemas.SortField
+000148a0: 2c20 7374 725d 203d 204e 6f6e 652c 0a20  , str] = None,. 
+000148b0: 2020 2020 2020 2070 6172 7469 7469 6f6e         partition
+000148c0: 5f6f 7264 6572 3a20 556e 696f 6e5b 0a20  _order: Union[. 
+000148d0: 2020 2020 2020 2020 2020 206d 6c72 756e             mlrun
+000148e0: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
+000148f0: 4f72 6465 7254 7970 652c 2073 7472 0a20  OrderType, str. 
+00014900: 2020 2020 2020 205d 203d 206d 6c72 756e         ] = mlrun
+00014910: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
+00014920: 4f72 6465 7254 7970 652e 6465 7363 2c0a  OrderType.desc,.
+00014930: 2020 2020 2920 2d3e 206c 6973 745b 4665      ) -> list[Fe
+00014940: 6174 7572 6553 6574 5d3a 0a20 2020 2020  atureSet]:.     
+00014950: 2020 2022 2222 5265 7472 6965 7665 2061     """Retrieve a
+00014960: 206c 6973 7420 6f66 2066 6561 7475 7265   list of feature
+00014970: 2d73 6574 7320 6d61 7463 6869 6e67 2074  -sets matching t
+00014980: 6865 2063 7269 7465 7269 6120 7072 6f76  he criteria prov
+00014990: 6964 6564 2e0a 0a20 2020 2020 2020 203a  ided...        :
+000149a0: 7061 7261 6d20 7072 6f6a 6563 743a 2050  param project: P
+000149b0: 726f 6a65 6374 206e 616d 652e 0a20 2020  roject name..   
+000149c0: 2020 2020 203a 7061 7261 6d20 6e61 6d65       :param name
+000149d0: 3a20 4e61 6d65 206f 6620 6665 6174 7572  : Name of featur
+000149e0: 652d 7365 7420 746f 206d 6174 6368 2e20  e-set to match. 
+000149f0: 5468 6973 2069 7320 6120 6c69 6b65 2071  This is a like q
+00014a00: 7565 7279 2c20 616e 6420 6973 2063 6173  uery, and is cas
+00014a10: 652d 696e 7365 6e73 6974 6976 652e 0a20  e-insensitive.. 
+00014a20: 2020 2020 2020 203a 7061 7261 6d20 7461         :param ta
+00014a30: 673a 204d 6174 6368 2066 6561 7475 7265  g: Match feature
+00014a40: 2d73 6574 7320 7769 7468 2073 7065 6369  -sets with speci
+00014a50: 6669 6320 7461 672e 0a20 2020 2020 2020  fic tag..       
+00014a60: 203a 7061 7261 6d20 7374 6174 653a 204d   :param state: M
+00014a70: 6174 6368 2066 6561 7475 7265 2d73 6574  atch feature-set
+00014a80: 7320 7769 7468 2061 2073 7065 6369 6669  s with a specifi
+00014a90: 6320 7374 6174 652e 0a20 2020 2020 2020  c state..       
+00014aa0: 203a 7061 7261 6d20 656e 7469 7469 6573   :param entities
+00014ab0: 3a20 4d61 7463 6820 6665 6174 7572 652d  : Match feature-
+00014ac0: 7365 7473 2077 6869 6368 2063 6f6e 7461  sets which conta
+00014ad0: 696e 2065 6e74 6974 6965 7320 7768 6f73  in entities whos
+00014ae0: 6520 6e61 6d65 2069 7320 696e 2074 6869  e name is in thi
+00014af0: 7320 6c69 7374 2e0a 2020 2020 2020 2020  s list..        
+00014b00: 3a70 6172 616d 2066 6561 7475 7265 733a  :param features:
+00014b10: 204d 6174 6368 2066 6561 7475 7265 2d73   Match feature-s
+00014b20: 6574 7320 7768 6963 6820 636f 6e74 6169  ets which contai
+00014b30: 6e20 6665 6174 7572 6573 2077 686f 7365  n features whose
+00014b40: 206e 616d 6520 6973 2069 6e20 7468 6973   name is in this
+00014b50: 206c 6973 742e 0a20 2020 2020 2020 203a   list..        :
+00014b60: 7061 7261 6d20 6c61 6265 6c73 3a20 4d61  param labels: Ma
+00014b70: 7463 6820 6665 6174 7572 652d 7365 7473  tch feature-sets
+00014b80: 2077 6869 6368 2068 6176 6520 7468 6573   which have thes
+00014b90: 6520 6c61 6265 6c73 2e0a 2020 2020 2020  e labels..      
+00014ba0: 2020 3a70 6172 616d 2070 6172 7469 7469    :param partiti
+00014bb0: 6f6e 5f62 793a 2046 6965 6c64 2074 6f20  on_by: Field to 
+00014bc0: 6772 6f75 7020 7265 7375 6c74 7320 6279  group results by
+00014bd0: 2e20 4f6e 6c79 2061 6c6c 6f77 6564 2076  . Only allowed v
+00014be0: 616c 7565 2069 7320 606e 616d 6560 2e20  alue is `name`. 
+00014bf0: 5768 656e 2060 7061 7274 6974 696f 6e5f  When `partition_
+00014c00: 6279 6020 6973 2073 7065 6369 6669 6564  by` is specified
+00014c10: 2c0a 2020 2020 2020 2020 2020 2020 7468  ,.            th
+00014c20: 6520 6070 6172 7469 7469 6f6e 5f73 6f72  e `partition_sor
+00014c30: 745f 6279 6020 7061 7261 6d65 7465 7220  t_by` parameter 
+00014c40: 6d75 7374 2062 6520 7072 6f76 6964 6564  must be provided
+00014c50: 2061 7320 7765 6c6c 2e0a 2020 2020 2020   as well..      
+00014c60: 2020 3a70 6172 616d 2072 6f77 735f 7065    :param rows_pe
+00014c70: 725f 7061 7274 6974 696f 6e3a 2048 6f77  r_partition: How
+00014c80: 206d 616e 7920 746f 7020 726f 7773 2028   many top rows (
+00014c90: 7065 7220 736f 7274 696e 6720 6465 6669  per sorting defi
+00014ca0: 6e65 6420 6279 2060 7061 7274 6974 696f  ned by `partitio
+00014cb0: 6e5f 736f 7274 5f62 7960 2061 6e64 2060  n_sort_by` and `
+00014cc0: 7061 7274 6974 696f 6e5f 6f72 6465 7260  partition_order`
+00014cd0: 290a 2020 2020 2020 2020 2020 2020 746f  ).            to
+00014ce0: 2072 6574 7572 6e20 7065 7220 6772 6f75   return per grou
+00014cf0: 702e 2044 6566 6175 6c74 2076 616c 7565  p. Default value
+00014d00: 2069 7320 312e 0a20 2020 2020 2020 203a   is 1..        :
+00014d10: 7061 7261 6d20 7061 7274 6974 696f 6e5f  param partition_
+00014d20: 736f 7274 5f62 793a 2057 6861 7420 6669  sort_by: What fi
+00014d30: 656c 6420 746f 2073 6f72 7420 7468 6520  eld to sort the 
+00014d40: 7265 7375 6c74 7320 6279 2c20 7769 7468  results by, with
+00014d50: 696e 2065 6163 6820 7061 7274 6974 696f  in each partitio
+00014d60: 6e20 6465 6669 6e65 6420 6279 2060 7061  n defined by `pa
+00014d70: 7274 6974 696f 6e5f 6279 602e 0a20 2020  rtition_by`..   
+00014d80: 2020 2020 2020 2020 2043 7572 7265 6e74           Current
+00014d90: 6c79 2074 6865 206f 6e6c 7920 616c 6c6f  ly the only allo
+00014da0: 7765 6420 7661 6c75 6520 6172 6520 6063  wed value are `c
+00014db0: 7265 6174 6564 6020 616e 6420 6075 7064  reated` and `upd
+00014dc0: 6174 6564 602e 0a20 2020 2020 2020 203a  ated`..        :
+00014dd0: 7061 7261 6d20 7061 7274 6974 696f 6e5f  param partition_
+00014de0: 6f72 6465 723a 204f 7264 6572 206f 6620  order: Order of 
+00014df0: 736f 7274 696e 6720 7769 7468 696e 2070  sorting within p
+00014e00: 6172 7469 7469 6f6e 7320 2d20 6061 7363  artitions - `asc
+00014e10: 6020 6f72 2060 6465 7363 602e 2044 6566  ` or `desc`. Def
+00014e20: 6175 6c74 2069 7320 6064 6573 6360 2e0a  ault is `desc`..
+00014e30: 2020 2020 2020 2020 3a72 6574 7572 6e73          :returns
+00014e40: 3a20 4c69 7374 206f 6620 6d61 7463 6869  : List of matchi
+00014e50: 6e67 203a 7079 3a63 6c61 7373 3a60 7e6d  ng :py:class:`~m
+00014e60: 6c72 756e 2e66 6561 7475 7265 5f73 746f  lrun.feature_sto
+00014e70: 7265 2e46 6561 7475 7265 5365 7460 206f  re.FeatureSet` o
+00014e80: 626a 6563 7473 2e0a 2020 2020 2020 2020  bjects..        
+00014e90: 2222 220a 0a20 2020 2020 2020 2070 726f  """..        pro
+00014ea0: 6a65 6374 203d 2070 726f 6a65 6374 206f  ject = project o
+00014eb0: 7220 636f 6e66 6967 2e64 6566 6175 6c74  r config.default
+00014ec0: 5f70 726f 6a65 6374 0a0a 2020 2020 2020  _project..      
+00014ed0: 2020 7061 7261 6d73 203d 207b 0a20 2020    params = {.   
+00014ee0: 2020 2020 2020 2020 2022 6e61 6d65 223a           "name":
+00014ef0: 206e 616d 652c 0a20 2020 2020 2020 2020   name,.         
+00014f00: 2020 2022 7374 6174 6522 3a20 7374 6174     "state": stat
+00014f10: 652c 0a20 2020 2020 2020 2020 2020 2022  e,.            "
+00014f20: 7461 6722 3a20 7461 672c 0a20 2020 2020  tag": tag,.     
+00014f30: 2020 2020 2020 2022 656e 7469 7479 223a         "entity":
+00014f40: 2065 6e74 6974 6965 7320 6f72 205b 5d2c   entities or [],
+00014f50: 0a20 2020 2020 2020 2020 2020 2022 6665  .            "fe
+00014f60: 6174 7572 6522 3a20 6665 6174 7572 6573  ature": features
+00014f70: 206f 7220 5b5d 2c0a 2020 2020 2020 2020   or [],.        
+00014f80: 2020 2020 226c 6162 656c 223a 206c 6162      "label": lab
+00014f90: 656c 7320 6f72 205b 5d2c 0a20 2020 2020  els or [],.     
+00014fa0: 2020 207d 0a20 2020 2020 2020 2069 6620     }.        if 
+00014fb0: 7061 7274 6974 696f 6e5f 6279 3a0a 2020  partition_by:.  
+00014fc0: 2020 2020 2020 2020 2020 7061 7261 6d73            params
+00014fd0: 2e75 7064 6174 6528 0a20 2020 2020 2020  .update(.       
+00014fe0: 2020 2020 2020 2020 2073 656c 662e 5f67           self._g
+00014ff0: 656e 6572 6174 655f 7061 7274 6974 696f  enerate_partitio
+00015000: 6e5f 6279 5f70 6172 616d 7328 0a20 2020  n_by_params(.   
+00015010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015020: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
+00015030: 6865 6d61 732e 4665 6174 7572 6553 746f  hemas.FeatureSto
+00015040: 7265 5061 7274 6974 696f 6e42 7946 6965  rePartitionByFie
+00015050: 6c64 2c0a 2020 2020 2020 2020 2020 2020  ld,.            
+00015060: 2020 2020 2020 2020 7061 7274 6974 696f          partitio
+00015070: 6e5f 6279 2c0a 2020 2020 2020 2020 2020  n_by,.          
+00015080: 2020 2020 2020 2020 2020 726f 7773 5f70            rows_p
+00015090: 6572 5f70 6172 7469 7469 6f6e 2c0a 2020  er_partition,.  
+000150a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000150b0: 2020 7061 7274 6974 696f 6e5f 736f 7274    partition_sort
+000150c0: 5f62 792c 0a20 2020 2020 2020 2020 2020  _by,.           
+000150d0: 2020 2020 2020 2020 2070 6172 7469 7469           partiti
+000150e0: 6f6e 5f6f 7264 6572 2c0a 2020 2020 2020  on_order,.      
+000150f0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00015100: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+00015110: 2020 2070 6174 6820 3d20 6622 7072 6f6a     path = f"proj
+00015120: 6563 7473 2f7b 7072 6f6a 6563 747d 2f66  ects/{project}/f
+00015130: 6561 7475 7265 2d73 6574 7322 0a0a 2020  eature-sets"..  
+00015140: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
+00015150: 6167 6520 3d20 280a 2020 2020 2020 2020  age = (.        
+00015160: 2020 2020 6622 4661 696c 6564 206c 6973      f"Failed lis
+00015170: 7469 6e67 2066 6561 7475 7265 2d73 6574  ting feature-set
+00015180: 732c 2070 726f 6a65 6374 3a20 7b70 726f  s, project: {pro
+00015190: 6a65 6374 7d2c 2071 7565 7279 3a20 7b70  ject}, query: {p
+000151a0: 6172 616d 737d 220a 2020 2020 2020 2020  arams}".        
+000151b0: 290a 2020 2020 2020 2020 7265 7370 203d  ).        resp =
+000151c0: 2073 656c 662e 6170 695f 6361 6c6c 2822   self.api_call("
+000151d0: 4745 5422 2c20 7061 7468 2c20 6572 726f  GET", path, erro
+000151e0: 725f 6d65 7373 6167 652c 2070 6172 616d  r_message, param
+000151f0: 733d 7061 7261 6d73 290a 2020 2020 2020  s=params).      
+00015200: 2020 6665 6174 7572 655f 7365 7473 203d    feature_sets =
+00015210: 2072 6573 702e 6a73 6f6e 2829 5b22 6665   resp.json()["fe
+00015220: 6174 7572 655f 7365 7473 225d 0a20 2020  ature_sets"].   
+00015230: 2020 2020 2069 6620 6665 6174 7572 655f       if feature_
+00015240: 7365 7473 3a0a 2020 2020 2020 2020 2020  sets:.          
+00015250: 2020 7265 7475 726e 205b 4665 6174 7572    return [Featur
+00015260: 6553 6574 2e66 726f 6d5f 6469 6374 286f  eSet.from_dict(o
+00015270: 626a 2920 666f 7220 6f62 6a20 696e 2066  bj) for obj in f
+00015280: 6561 7475 7265 5f73 6574 735d 0a0a 2020  eature_sets]..  
+00015290: 2020 6465 6620 7374 6f72 655f 6665 6174    def store_feat
+000152a0: 7572 655f 7365 7428 0a20 2020 2020 2020  ure_set(.       
+000152b0: 2073 656c 662c 0a20 2020 2020 2020 2066   self,.        f
+000152c0: 6561 7475 7265 5f73 6574 3a20 556e 696f  eature_set: Unio
+000152d0: 6e5b 6469 6374 2c20 6d6c 7275 6e2e 636f  n[dict, mlrun.co
+000152e0: 6d6d 6f6e 2e73 6368 656d 6173 2e46 6561  mmon.schemas.Fea
+000152f0: 7475 7265 5365 742c 2046 6561 7475 7265  tureSet, Feature
+00015300: 5365 745d 2c0a 2020 2020 2020 2020 6e61  Set],.        na
+00015310: 6d65 3d4e 6f6e 652c 0a20 2020 2020 2020  me=None,.       
+00015320: 2070 726f 6a65 6374 3d22 222c 0a20 2020   project="",.   
+00015330: 2020 2020 2074 6167 3d4e 6f6e 652c 0a20       tag=None,. 
+00015340: 2020 2020 2020 2075 6964 3d4e 6f6e 652c         uid=None,
+00015350: 0a20 2020 2020 2020 2076 6572 7369 6f6e  .        version
+00015360: 6564 3d54 7275 652c 0a20 2020 2029 202d  ed=True,.    ) -
+00015370: 3e20 6469 6374 3a0a 2020 2020 2020 2020  > dict:.        
+00015380: 2222 2253 6176 6520 6120 3a70 793a 636c  """Save a :py:cl
+00015390: 6173 733a 607e 6d6c 7275 6e2e 6665 6174  ass:`~mlrun.feat
+000153a0: 7572 655f 7374 6f72 652e 4665 6174 7572  ure_store.Featur
+000153b0: 6553 6574 6020 6f62 6a65 6374 2069 6e20  eSet` object in 
+000153c0: 7468 6520 3a70 793a 6d6f 643a 606d 6c72  the :py:mod:`mlr
+000153d0: 756e 6020 4442 2e20 5468 650a 2020 2020  un` DB. The.    
+000153e0: 2020 2020 6665 6174 7572 652d 7365 7420      feature-set 
+000153f0: 6361 6e20 6265 2065 6974 6865 7220 6120  can be either a 
+00015400: 6e65 7720 6f62 6a65 6374 206f 7220 6120  new object or a 
+00015410: 6d6f 6469 6669 6361 7469 6f6e 2074 6f20  modification to 
+00015420: 6578 6973 7469 6e67 206f 626a 6563 7420  existing object 
+00015430: 7265 6665 7265 6e63 6564 2062 7920 7468  referenced by th
+00015440: 6520 7061 7261 6d73 206f 660a 2020 2020  e params of.    
+00015450: 2020 2020 7468 6520 6675 6e63 7469 6f6e      the function
+00015460: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
+00015470: 6d20 6665 6174 7572 655f 7365 743a 2054  m feature_set: T
+00015480: 6865 203a 7079 3a63 6c61 7373 3a60 7e6d  he :py:class:`~m
+00015490: 6c72 756e 2e66 6561 7475 7265 5f73 746f  lrun.feature_sto
+000154a0: 7265 2e46 6561 7475 7265 5365 7460 2074  re.FeatureSet` t
+000154b0: 6f20 7374 6f72 652e 0a20 2020 2020 2020  o store..       
+000154c0: 203a 7061 7261 6d20 6e61 6d65 3a20 2020   :param name:   
+000154d0: 204e 616d 6520 6f66 2066 6561 7475 7265   Name of feature
+000154e0: 2073 6574 2e0a 2020 2020 2020 2020 3a70   set..        :p
+000154f0: 6172 616d 2070 726f 6a65 6374 3a20 4e61  aram project: Na
+00015500: 6d65 206f 6620 7072 6f6a 6563 7420 7468  me of project th
+00015510: 6973 2066 6561 7475 7265 2d73 6574 2062  is feature-set b
+00015520: 656c 6f6e 6773 2074 6f2e 0a20 2020 2020  elongs to..     
+00015530: 2020 203a 7061 7261 6d20 7461 673a 2054     :param tag: T
+00015540: 6865 2060 6074 6167 6060 206f 6620 7468  he ``tag`` of th
+00015550: 6520 6f62 6a65 6374 2074 6f20 7265 706c  e object to repl
+00015560: 6163 6520 696e 2074 6865 2044 422c 2066  ace in the DB, f
+00015570: 6f72 2065 7861 6d70 6c65 2060 606c 6174  or example ``lat
+00015580: 6573 7460 602e 0a20 2020 2020 2020 203a  est``..        :
+00015590: 7061 7261 6d20 7569 643a 2054 6865 2060  param uid: The `
+000155a0: 6075 6964 6060 206f 6620 7468 6520 6f62  `uid`` of the ob
+000155b0: 6a65 6374 2074 6f20 7265 706c 6163 6520  ject to replace 
+000155c0: 696e 2074 6865 2044 422e 2049 6620 7573  in the DB. If us
+000155d0: 696e 6720 7468 6973 2070 6172 616d 6574  ing this paramet
+000155e0: 6572 2c20 7468 6520 6d6f 6469 6669 6564  er, the modified
+000155f0: 206f 626a 6563 740a 2020 2020 2020 2020   object.        
+00015600: 2020 2020 6d75 7374 2068 6176 6520 7468      must have th
+00015610: 6520 7361 6d65 2060 6075 6964 6060 206f  e same ``uid`` o
+00015620: 6620 7468 6520 7072 6576 696f 7573 6c79  f the previously
+00015630: 2d65 7869 7374 696e 6720 6f62 6a65 6374  -existing object
+00015640: 2e20 5468 6973 2063 616e 6e6f 7420 6265  . This cannot be
+00015650: 2075 7365 6420 666f 7220 6e6f 6e2d 7665   used for non-ve
+00015660: 7273 696f 6e65 6420 6f62 6a65 6374 732e  rsioned objects.
+00015670: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00015680: 7665 7273 696f 6e65 643a 2057 6865 7468  versioned: Wheth
+00015690: 6572 2074 6f20 6d61 696e 7461 696e 2076  er to maintain v
+000156a0: 6572 7369 6f6e 7320 666f 7220 7468 6973  ersions for this
+000156b0: 2066 6561 7475 7265 2d73 6574 2e20 416c   feature-set. Al
+000156c0: 6c20 7665 7273 696f 6e73 206f 6620 6120  l versions of a 
+000156d0: 7665 7273 696f 6e65 6420 6f62 6a65 6374  versioned object
+000156e0: 0a20 2020 2020 2020 2020 2020 2077 696c  .            wil
+000156f0: 6c20 6265 206b 6570 7420 696e 2074 6865  l be kept in the
+00015700: 2044 4220 616e 6420 6361 6e20 6265 2072   DB and can be r
+00015710: 6574 7269 6576 6564 2075 6e74 696c 2065  etrieved until e
+00015720: 7870 6c69 6369 746c 7920 6465 6c65 7465  xplicitly delete
+00015730: 642e 0a20 2020 2020 2020 203a 7265 7475  d..        :retu
+00015740: 726e 733a 2054 6865 203a 7079 3a63 6c61  rns: The :py:cla
+00015750: 7373 3a60 7e6d 6c72 756e 2e66 6561 7475  ss:`~mlrun.featu
+00015760: 7265 5f73 746f 7265 2e46 6561 7475 7265  re_store.Feature
+00015770: 5365 7460 206f 626a 6563 7420 2861 7320  Set` object (as 
+00015780: 6469 6374 292e 0a20 2020 2020 2020 2022  dict)..        "
+00015790: 2222 0a0a 2020 2020 2020 2020 7265 6665  ""..        refe
+000157a0: 7265 6e63 6520 3d20 7365 6c66 2e5f 7265  rence = self._re
+000157b0: 736f 6c76 655f 7265 6665 7265 6e63 6528  solve_reference(
+000157c0: 7461 672c 2075 6964 290a 2020 2020 2020  tag, uid).      
+000157d0: 2020 7061 7261 6d73 203d 207b 2276 6572    params = {"ver
+000157e0: 7369 6f6e 6564 223a 2076 6572 7369 6f6e  sioned": version
+000157f0: 6564 7d0a 0a20 2020 2020 2020 2069 6620  ed}..        if 
+00015800: 6973 696e 7374 616e 6365 2866 6561 7475  isinstance(featu
+00015810: 7265 5f73 6574 2c20 6d6c 7275 6e2e 636f  re_set, mlrun.co
+00015820: 6d6d 6f6e 2e73 6368 656d 6173 2e46 6561  mmon.schemas.Fea
+00015830: 7475 7265 5365 7429 3a0a 2020 2020 2020  tureSet):.      
+00015840: 2020 2020 2020 6665 6174 7572 655f 7365        feature_se
+00015850: 7420 3d20 6665 6174 7572 655f 7365 742e  t = feature_set.
+00015860: 6469 6374 2829 0a20 2020 2020 2020 2065  dict().        e
+00015870: 6c69 6620 6973 696e 7374 616e 6365 2866  lif isinstance(f
+00015880: 6561 7475 7265 5f73 6574 2c20 4665 6174  eature_set, Feat
+00015890: 7572 6553 6574 293a 0a20 2020 2020 2020  ureSet):.       
+000158a0: 2020 2020 2066 6561 7475 7265 5f73 6574       feature_set
+000158b0: 203d 2066 6561 7475 7265 5f73 6574 2e74   = feature_set.t
+000158c0: 6f5f 6469 6374 2829 0a0a 2020 2020 2020  o_dict()..      
+000158d0: 2020 6e61 6d65 203d 206e 616d 6520 6f72    name = name or
+000158e0: 2066 6561 7475 7265 5f73 6574 5b22 6d65   feature_set["me
+000158f0: 7461 6461 7461 225d 5b22 6e61 6d65 225d  tadata"]["name"]
+00015900: 0a20 2020 2020 2020 2070 726f 6a65 6374  .        project
+00015910: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
+00015920: 2070 726f 6a65 6374 206f 7220 6665 6174   project or feat
+00015930: 7572 655f 7365 745b 226d 6574 6164 6174  ure_set["metadat
+00015940: 6122 5d2e 6765 7428 2270 726f 6a65 6374  a"].get("project
+00015950: 2229 206f 7220 636f 6e66 6967 2e64 6566  ") or config.def
+00015960: 6175 6c74 5f70 726f 6a65 6374 0a20 2020  ault_project.   
+00015970: 2020 2020 2029 0a20 2020 2020 2020 2070       ).        p
+00015980: 6174 6820 3d20 6622 7072 6f6a 6563 7473  ath = f"projects
+00015990: 2f7b 7072 6f6a 6563 747d 2f66 6561 7475  /{project}/featu
+000159a0: 7265 2d73 6574 732f 7b6e 616d 657d 2f72  re-sets/{name}/r
+000159b0: 6566 6572 656e 6365 732f 7b72 6566 6572  eferences/{refer
+000159c0: 656e 6365 7d22 0a20 2020 2020 2020 2065  ence}".        e
+000159d0: 7272 6f72 5f6d 6573 7361 6765 203d 2066  rror_message = f
+000159e0: 2246 6169 6c65 6420 7374 6f72 696e 6720  "Failed storing 
+000159f0: 6665 6174 7572 652d 7365 7420 7b70 726f  feature-set {pro
+00015a00: 6a65 6374 7d2f 7b6e 616d 657d 220a 2020  ject}/{name}".  
+00015a10: 2020 2020 2020 7265 7370 203d 2073 656c        resp = sel
+00015a20: 662e 6170 695f 6361 6c6c 280a 2020 2020  f.api_call(.    
+00015a30: 2020 2020 2020 2020 2250 5554 222c 2070          "PUT", p
+00015a40: 6174 682c 2065 7272 6f72 5f6d 6573 7361  ath, error_messa
+00015a50: 6765 2c20 7061 7261 6d73 3d70 6172 616d  ge, params=param
+00015a60: 732c 2062 6f64 793d 6469 6374 5f74 6f5f  s, body=dict_to_
+00015a70: 6a73 6f6e 2866 6561 7475 7265 5f73 6574  json(feature_set
+00015a80: 290a 2020 2020 2020 2020 290a 2020 2020  ).        ).    
+00015a90: 2020 2020 7265 7475 726e 2072 6573 702e      return resp.
+00015aa0: 6a73 6f6e 2829 0a0a 2020 2020 6465 6620  json()..    def 
+00015ab0: 7061 7463 685f 6665 6174 7572 655f 7365  patch_feature_se
+00015ac0: 7428 0a20 2020 2020 2020 2073 656c 662c  t(.        self,
+00015ad0: 0a20 2020 2020 2020 206e 616d 652c 0a20  .        name,. 
+00015ae0: 2020 2020 2020 2066 6561 7475 7265 5f73         feature_s
+00015af0: 6574 5f75 7064 6174 653a 2064 6963 742c  et_update: dict,
+00015b00: 0a20 2020 2020 2020 2070 726f 6a65 6374  .        project
+00015b10: 3d22 222c 0a20 2020 2020 2020 2074 6167  ="",.        tag
+00015b20: 3d4e 6f6e 652c 0a20 2020 2020 2020 2075  =None,.        u
+00015b30: 6964 3d4e 6f6e 652c 0a20 2020 2020 2020  id=None,.       
+00015b40: 2070 6174 6368 5f6d 6f64 653a 2055 6e69   patch_mode: Uni
+00015b50: 6f6e 5b0a 2020 2020 2020 2020 2020 2020  on[.            
+00015b60: 7374 722c 206d 6c72 756e 2e63 6f6d 6d6f  str, mlrun.commo
+00015b70: 6e2e 7363 6865 6d61 732e 5061 7463 684d  n.schemas.PatchM
+00015b80: 6f64 650a 2020 2020 2020 2020 5d20 3d20  ode.        ] = 
+00015b90: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+00015ba0: 656d 6173 2e50 6174 6368 4d6f 6465 2e72  emas.PatchMode.r
+00015bb0: 6570 6c61 6365 2c0a 2020 2020 293a 0a20  eplace,.    ):. 
+00015bc0: 2020 2020 2020 2022 2222 4d6f 6469 6679         """Modify
+00015bd0: 2028 7061 7463 6829 2061 6e20 6578 6973   (patch) an exis
+00015be0: 7469 6e67 203a 7079 3a63 6c61 7373 3a60  ting :py:class:`
+00015bf0: 7e6d 6c72 756e 2e66 6561 7475 7265 5f73  ~mlrun.feature_s
+00015c00: 746f 7265 2e46 6561 7475 7265 5365 7460  tore.FeatureSet`
+00015c10: 206f 626a 6563 742e 0a20 2020 2020 2020   object..       
+00015c20: 2054 6865 206f 626a 6563 7420 6973 2069   The object is i
+00015c30: 6465 6e74 6966 6965 6420 6279 2069 7473  dentified by its
+00015c40: 206e 616d 6520 2861 6e64 2070 726f 6a65   name (and proje
+00015c50: 6374 2069 7420 6265 6c6f 6e67 7320 746f  ct it belongs to
+00015c60: 292c 2061 7320 7765 6c6c 2061 7320 6f70  ), as well as op
+00015c70: 7469 6f6e 616c 6c79 2061 2060 6074 6167  tionally a ``tag
+00015c80: 6060 206f 7220 6974 730a 2020 2020 2020  `` or its.      
+00015c90: 2020 6060 7569 6460 6020 2866 6f72 2076    ``uid`` (for v
+00015ca0: 6572 7369 6f6e 6564 206f 626a 6563 7429  ersioned object)
+00015cb0: 2e20 4966 2062 6f74 6820 6060 7461 6760  . If both ``tag`
+00015cc0: 6020 616e 6420 6060 7569 6460 6020 6172  ` and ``uid`` ar
+00015cd0: 6520 6f6d 6974 7465 6420 7468 656e 2074  e omitted then t
+00015ce0: 6865 206f 626a 6563 7420 7769 7468 2074  he object with t
+00015cf0: 6167 2060 606c 6174 6573 7460 600a 2020  ag ``latest``.  
+00015d00: 2020 2020 2020 6973 206d 6f64 6966 6965        is modifie
+00015d10: 642e 0a0a 2020 2020 2020 2020 3a70 6172  d...        :par
+00015d20: 616d 206e 616d 653a 204e 616d 6520 6f66  am name: Name of
+00015d30: 2074 6865 206f 626a 6563 7420 746f 2070   the object to p
+00015d40: 6174 6368 2e0a 2020 2020 2020 2020 3a70  atch..        :p
+00015d50: 6172 616d 2066 6561 7475 7265 5f73 6574  aram feature_set
+00015d60: 5f75 7064 6174 653a 2054 6865 206d 6f64  _update: The mod
+00015d70: 6966 6963 6174 696f 6e73 206e 6565 6465  ifications neede
+00015d80: 6420 696e 2074 6865 206f 626a 6563 742e  d in the object.
+00015d90: 2054 6869 7320 7061 7261 6d65 7465 7220   This parameter 
+00015da0: 6f6e 6c79 2068 6173 2074 6865 2063 6861  only has the cha
+00015db0: 6e67 6573 2069 6e20 6974 2c0a 2020 2020  nges in it,.    
+00015dc0: 2020 2020 2020 2020 6e6f 7420 6120 6675          not a fu
+00015dd0: 6c6c 206f 626a 6563 742e 0a20 2020 2020  ll object..     
+00015de0: 2020 2020 2020 2045 7861 6d70 6c65 3a3a         Example::
+00015df0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00015e00: 2020 6665 6174 7572 655f 7365 745f 7570    feature_set_up
+00015e10: 6461 7465 203d 207b 2273 7461 7475 7322  date = {"status"
+00015e20: 3a20 7b22 7072 6f63 6573 7365 6422 203a  : {"processed" :
+00015e30: 2054 7275 657d 7d0a 0a20 2020 2020 2020   True}}..       
+00015e40: 2020 2020 2057 696c 6c20 6170 706c 7920       Will apply 
+00015e50: 7468 6520 6669 656c 6420 6060 7374 6174  the field ``stat
+00015e60: 7573 2e70 726f 6365 7373 6564 6060 2074  us.processed`` t
+00015e70: 6f20 7468 6520 6578 6973 7469 6e67 206f  o the existing o
+00015e80: 626a 6563 742e 0a20 2020 2020 2020 203a  bject..        :
+00015e90: 7061 7261 6d20 7072 6f6a 6563 743a 2050  param project: P
+00015ea0: 726f 6a65 6374 2077 6869 6368 2063 6f6e  roject which con
+00015eb0: 7461 696e 7320 7468 6520 6d6f 6469 6669  tains the modifi
+00015ec0: 6564 206f 626a 6563 742e 0a20 2020 2020  ed object..     
+00015ed0: 2020 203a 7061 7261 6d20 7461 673a 2054     :param tag: T
+00015ee0: 6865 2074 6167 206f 6620 7468 6520 6f62  he tag of the ob
+00015ef0: 6a65 6374 2074 6f20 6d6f 6469 6679 2e0a  ject to modify..
+00015f00: 2020 2020 2020 2020 3a70 6172 616d 2075          :param u
+00015f10: 6964 3a20 7569 6420 6f66 2074 6865 206f  id: uid of the o
+00015f20: 626a 6563 7420 746f 206d 6f64 6966 792e  bject to modify.
+00015f30: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00015f40: 7061 7463 685f 6d6f 6465 3a20 5468 6520  patch_mode: The 
+00015f50: 7374 7261 7465 6779 2066 6f72 206d 6572  strategy for mer
+00015f60: 6769 6e67 2074 6865 2063 6861 6e67 6573  ging the changes
+00015f70: 2077 6974 6820 7468 6520 6578 6973 7469   with the existi
+00015f80: 6e67 206f 626a 6563 742e 2043 616e 2062  ng object. Can b
+00015f90: 6520 6569 7468 6572 2060 6072 6570 6c61  e either ``repla
+00015fa0: 6365 6060 0a20 2020 2020 2020 2020 2020  ce``.           
+00015fb0: 206f 7220 6060 6164 6469 7469 7665 6060   or ``additive``
+00015fc0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+00015fd0: 2020 2020 2020 7072 6f6a 6563 7420 3d20        project = 
+00015fe0: 7072 6f6a 6563 7420 6f72 2063 6f6e 6669  project or confi
+00015ff0: 672e 6465 6661 756c 745f 7072 6f6a 6563  g.default_projec
+00016000: 740a 2020 2020 2020 2020 7265 6665 7265  t.        refere
+00016010: 6e63 6520 3d20 7365 6c66 2e5f 7265 736f  nce = self._reso
+00016020: 6c76 655f 7265 6665 7265 6e63 6528 7461  lve_reference(ta
+00016030: 672c 2075 6964 290a 2020 2020 2020 2020  g, uid).        
+00016040: 6865 6164 6572 7320 3d20 7b6d 6c72 756e  headers = {mlrun
+00016050: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
+00016060: 4865 6164 6572 4e61 6d65 732e 7061 7463  HeaderNames.patc
+00016070: 685f 6d6f 6465 3a20 7061 7463 685f 6d6f  h_mode: patch_mo
+00016080: 6465 7d0a 2020 2020 2020 2020 7061 7468  de}.        path
+00016090: 203d 2066 2270 726f 6a65 6374 732f 7b70   = f"projects/{p
+000160a0: 726f 6a65 6374 7d2f 6665 6174 7572 652d  roject}/feature-
+000160b0: 7365 7473 2f7b 6e61 6d65 7d2f 7265 6665  sets/{name}/refe
+000160c0: 7265 6e63 6573 2f7b 7265 6665 7265 6e63  rences/{referenc
+000160d0: 657d 220a 2020 2020 2020 2020 6572 726f  e}".        erro
+000160e0: 725f 6d65 7373 6167 6520 3d20 6622 4661  r_message = f"Fa
+000160f0: 696c 6564 2075 7064 6174 696e 6720 6665  iled updating fe
+00016100: 6174 7572 652d 7365 7420 7b70 726f 6a65  ature-set {proje
+00016110: 6374 7d2f 7b6e 616d 657d 220a 2020 2020  ct}/{name}".    
+00016120: 2020 2020 7365 6c66 2e61 7069 5f63 616c      self.api_cal
+00016130: 6c28 0a20 2020 2020 2020 2020 2020 2022  l(.            "
+00016140: 5041 5443 4822 2c0a 2020 2020 2020 2020  PATCH",.        
+00016150: 2020 2020 7061 7468 2c0a 2020 2020 2020      path,.      
+00016160: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
+00016170: 6167 652c 0a20 2020 2020 2020 2020 2020  age,.           
+00016180: 2062 6f64 793d 6469 6374 5f74 6f5f 6a73   body=dict_to_js
+00016190: 6f6e 2866 6561 7475 7265 5f73 6574 5f75  on(feature_set_u
+000161a0: 7064 6174 6529 2c0a 2020 2020 2020 2020  pdate),.        
+000161b0: 2020 2020 6865 6164 6572 733d 6865 6164      headers=head
+000161c0: 6572 732c 0a20 2020 2020 2020 2029 0a0a  ers,.        )..
+000161d0: 2020 2020 6465 6620 6465 6c65 7465 5f66      def delete_f
+000161e0: 6561 7475 7265 5f73 6574 2873 656c 662c  eature_set(self,
+000161f0: 206e 616d 652c 2070 726f 6a65 6374 3d22   name, project="
+00016200: 222c 2074 6167 3d4e 6f6e 652c 2075 6964  ", tag=None, uid
+00016210: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
+00016220: 2222 2244 656c 6574 6520 6120 3a70 793a  """Delete a :py:
+00016230: 636c 6173 733a 607e 6d6c 7275 6e2e 6665  class:`~mlrun.fe
+00016240: 6174 7572 655f 7374 6f72 652e 4665 6174  ature_store.Feat
+00016250: 7572 6553 6574 6020 6f62 6a65 6374 2066  ureSet` object f
+00016260: 726f 6d20 7468 6520 4442 2e0a 2020 2020  rom the DB..    
+00016270: 2020 2020 4966 2060 6074 6167 6060 206f      If ``tag`` o
+00016280: 7220 6060 7569 6460 6020 6172 6520 7370  r ``uid`` are sp
+00016290: 6563 6966 6965 642c 2074 6865 6e20 6a75  ecified, then ju
+000162a0: 7374 2074 6865 2076 6572 7369 6f6e 2072  st the version r
+000162b0: 6566 6572 656e 6365 6420 6279 2074 6865  eferenced by the
+000162c0: 6d20 7769 6c6c 2062 6520 6465 6c65 7465  m will be delete
+000162d0: 642e 2055 7369 6e67 2062 6f74 680a 2020  d. Using both.  
+000162e0: 2020 2020 2020 6973 206e 6f74 2061 6c6c        is not all
+000162f0: 6f77 6564 2e0a 2020 2020 2020 2020 4966  owed..        If
+00016300: 206e 6f6e 6520 6172 6520 7370 6563 6966   none are specif
+00016310: 6965 642c 2074 6865 6e20 616c 6c20 696e  ied, then all in
+00016320: 7374 616e 6365 7320 6f66 2074 6865 206f  stances of the o
+00016330: 626a 6563 7420 7768 6f73 6520 6e61 6d65  bject whose name
+00016340: 2069 7320 6060 6e61 6d65 6060 2077 696c   is ``name`` wil
+00016350: 6c20 6265 2064 656c 6574 6564 2e0a 2020  l be deleted..  
+00016360: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00016370: 2020 7072 6f6a 6563 7420 3d20 7072 6f6a    project = proj
+00016380: 6563 7420 6f72 2063 6f6e 6669 672e 6465  ect or config.de
+00016390: 6661 756c 745f 7072 6f6a 6563 740a 2020  fault_project.  
+000163a0: 2020 2020 2020 7061 7468 203d 2066 2270        path = f"p
+000163b0: 726f 6a65 6374 732f 7b70 726f 6a65 6374  rojects/{project
+000163c0: 7d2f 6665 6174 7572 652d 7365 7473 2f7b  }/feature-sets/{
+000163d0: 6e61 6d65 7d22 0a0a 2020 2020 2020 2020  name}"..        
+000163e0: 6966 2074 6167 206f 7220 7569 643a 0a20  if tag or uid:. 
+000163f0: 2020 2020 2020 2020 2020 2072 6566 6572             refer
+00016400: 656e 6365 203d 2073 656c 662e 5f72 6573  ence = self._res
+00016410: 6f6c 7665 5f72 6566 6572 656e 6365 2874  olve_reference(t
+00016420: 6167 2c20 7569 6429 0a20 2020 2020 2020  ag, uid).       
+00016430: 2020 2020 2070 6174 6820 3d20 7061 7468       path = path
+00016440: 202b 2066 222f 7265 6665 7265 6e63 6573   + f"/references
+00016450: 2f7b 7265 6665 7265 6e63 657d 220a 0a20  /{reference}".. 
+00016460: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
+00016470: 7361 6765 203d 2066 2246 6169 6c65 6420  sage = f"Failed 
+00016480: 6465 6c65 7469 6e67 2066 6561 7475 7265  deleting feature
+00016490: 2d73 6574 207b 6e61 6d65 7d22 0a20 2020  -set {name}".   
+000164a0: 2020 2020 2073 656c 662e 6170 695f 6361       self.api_ca
+000164b0: 6c6c 2822 4445 4c45 5445 222c 2070 6174  ll("DELETE", pat
+000164c0: 682c 2065 7272 6f72 5f6d 6573 7361 6765  h, error_message
+000164d0: 290a 0a20 2020 2064 6566 2063 7265 6174  )..    def creat
+000164e0: 655f 6665 6174 7572 655f 7665 6374 6f72  e_feature_vector
+000164f0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+00016500: 2020 2020 2020 2020 6665 6174 7572 655f          feature_
+00016510: 7665 6374 6f72 3a20 556e 696f 6e5b 6469  vector: Union[di
+00016520: 6374 2c20 6d6c 7275 6e2e 636f 6d6d 6f6e  ct, mlrun.common
+00016530: 2e73 6368 656d 6173 2e46 6561 7475 7265  .schemas.Feature
+00016540: 5665 6374 6f72 2c20 4665 6174 7572 6556  Vector, FeatureV
+00016550: 6563 746f 725d 2c0a 2020 2020 2020 2020  ector],.        
+00016560: 7072 6f6a 6563 743d 2222 2c0a 2020 2020  project="",.    
+00016570: 2020 2020 7665 7273 696f 6e65 643d 5472      versioned=Tr
+00016580: 7565 2c0a 2020 2020 2920 2d3e 2064 6963  ue,.    ) -> dic
+00016590: 743a 0a20 2020 2020 2020 2022 2222 4372  t:.        """Cr
+000165a0: 6561 7465 2061 206e 6577 203a 7079 3a63  eate a new :py:c
+000165b0: 6c61 7373 3a60 7e6d 6c72 756e 2e66 6561  lass:`~mlrun.fea
+000165c0: 7475 7265 5f73 746f 7265 2e46 6561 7475  ture_store.Featu
+000165d0: 7265 5665 6374 6f72 6020 616e 6420 7361  reVector` and sa
+000165e0: 7665 2069 6e20 7468 6520 3a70 793a 6d6f  ve in the :py:mo
+000165f0: 643a 606d 6c72 756e 6020 4442 2e0a 0a20  d:`mlrun` DB... 
+00016600: 2020 2020 2020 203a 7061 7261 6d20 6665         :param fe
+00016610: 6174 7572 655f 7665 6374 6f72 3a20 5468  ature_vector: Th
+00016620: 6520 6e65 7720 3a70 793a 636c 6173 733a  e new :py:class:
+00016630: 607e 6d6c 7275 6e2e 6665 6174 7572 655f  `~mlrun.feature_
+00016640: 7374 6f72 652e 4665 6174 7572 6556 6563  store.FeatureVec
+00016650: 746f 7260 2074 6f20 6372 6561 7465 2e0a  tor` to create..
+00016660: 2020 2020 2020 2020 3a70 6172 616d 2070          :param p
+00016670: 726f 6a65 6374 3a20 4e61 6d65 206f 6620  roject: Name of 
+00016680: 7072 6f6a 6563 7420 7468 6973 2066 6561  project this fea
+00016690: 7475 7265 2d76 6563 746f 7220 6265 6c6f  ture-vector belo
+000166a0: 6e67 7320 746f 2e0a 2020 2020 2020 2020  ngs to..        
+000166b0: 3a70 6172 616d 2076 6572 7369 6f6e 6564  :param versioned
+000166c0: 3a20 5768 6574 6865 7220 746f 206d 6169  : Whether to mai
+000166d0: 6e74 6169 6e20 7665 7273 696f 6e73 2066  ntain versions f
+000166e0: 6f72 2074 6869 7320 6665 6174 7572 652d  or this feature-
+000166f0: 7665 6374 6f72 2e20 416c 6c20 7665 7273  vector. All vers
+00016700: 696f 6e73 206f 6620 6120 7665 7273 696f  ions of a versio
+00016710: 6e65 6420 6f62 6a65 6374 0a20 2020 2020  ned object.     
+00016720: 2020 2020 2020 2077 696c 6c20 6265 206b         will be k
+00016730: 6570 7420 696e 2074 6865 2044 4220 616e  ept in the DB an
+00016740: 6420 6361 6e20 6265 2072 6574 7269 6576  d can be retriev
+00016750: 6564 2075 6e74 696c 2065 7870 6c69 6369  ed until explici
+00016760: 746c 7920 6465 6c65 7465 642e 0a20 2020  tly deleted..   
+00016770: 2020 2020 203a 7265 7475 726e 733a 2054       :returns: T
+00016780: 6865 203a 7079 3a63 6c61 7373 3a60 7e6d  he :py:class:`~m
+00016790: 6c72 756e 2e66 6561 7475 7265 5f73 746f  lrun.feature_sto
+000167a0: 7265 2e46 6561 7475 7265 5665 6374 6f72  re.FeatureVector
+000167b0: 6020 6f62 6a65 6374 2028 6173 2064 6963  ` object (as dic
+000167c0: 7429 2e0a 2020 2020 2020 2020 2222 220a  t)..        """.
+000167d0: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+000167e0: 7461 6e63 6528 6665 6174 7572 655f 7665  tance(feature_ve
+000167f0: 6374 6f72 2c20 6d6c 7275 6e2e 636f 6d6d  ctor, mlrun.comm
+00016800: 6f6e 2e73 6368 656d 6173 2e46 6561 7475  on.schemas.Featu
+00016810: 7265 5665 6374 6f72 293a 0a20 2020 2020  reVector):.     
+00016820: 2020 2020 2020 2066 6561 7475 7265 5f76         feature_v
+00016830: 6563 746f 7220 3d20 6665 6174 7572 655f  ector = feature_
+00016840: 7665 6374 6f72 2e64 6963 7428 290a 2020  vector.dict().  
+00016850: 2020 2020 2020 656c 6966 2069 7369 6e73        elif isins
+00016860: 7461 6e63 6528 6665 6174 7572 655f 7665  tance(feature_ve
+00016870: 6374 6f72 2c20 4665 6174 7572 6556 6563  ctor, FeatureVec
+00016880: 746f 7229 3a0a 2020 2020 2020 2020 2020  tor):.          
+00016890: 2020 6665 6174 7572 655f 7665 6374 6f72    feature_vector
+000168a0: 203d 2066 6561 7475 7265 5f76 6563 746f   = feature_vecto
+000168b0: 722e 746f 5f64 6963 7428 290a 0a20 2020  r.to_dict()..   
+000168c0: 2020 2020 2070 726f 6a65 6374 203d 2028       project = (
+000168d0: 0a20 2020 2020 2020 2020 2020 2070 726f  .            pro
+000168e0: 6a65 6374 0a20 2020 2020 2020 2020 2020  ject.           
+000168f0: 206f 7220 6665 6174 7572 655f 7665 6374   or feature_vect
+00016900: 6f72 5b22 6d65 7461 6461 7461 225d 2e67  or["metadata"].g
+00016910: 6574 2822 7072 6f6a 6563 7422 2c20 4e6f  et("project", No
+00016920: 6e65 290a 2020 2020 2020 2020 2020 2020  ne).            
+00016930: 6f72 2063 6f6e 6669 672e 6465 6661 756c  or config.defaul
+00016940: 745f 7072 6f6a 6563 740a 2020 2020 2020  t_project.      
+00016950: 2020 290a 2020 2020 2020 2020 7061 7468    ).        path
+00016960: 203d 2066 2270 726f 6a65 6374 732f 7b70   = f"projects/{p
+00016970: 726f 6a65 6374 7d2f 6665 6174 7572 652d  roject}/feature-
+00016980: 7665 6374 6f72 7322 0a20 2020 2020 2020  vectors".       
+00016990: 2070 6172 616d 7320 3d20 7b22 7665 7273   params = {"vers
+000169a0: 696f 6e65 6422 3a20 7665 7273 696f 6e65  ioned": versione
+000169b0: 647d 0a0a 2020 2020 2020 2020 6e61 6d65  d}..        name
+000169c0: 203d 2066 6561 7475 7265 5f76 6563 746f   = feature_vecto
+000169d0: 725b 226d 6574 6164 6174 6122 5d5b 226e  r["metadata"]["n
+000169e0: 616d 6522 5d0a 2020 2020 2020 2020 6572  ame"].        er
+000169f0: 726f 725f 6d65 7373 6167 6520 3d20 6622  ror_message = f"
+00016a00: 4661 696c 6564 2063 7265 6174 696e 6720  Failed creating 
+00016a10: 6665 6174 7572 652d 7665 6374 6f72 207b  feature-vector {
+00016a20: 7072 6f6a 6563 747d 2f7b 6e61 6d65 7d22  project}/{name}"
+00016a30: 0a20 2020 2020 2020 2072 6573 7020 3d20  .        resp = 
+00016a40: 7365 6c66 2e61 7069 5f63 616c 6c28 0a20  self.api_call(. 
+00016a50: 2020 2020 2020 2020 2020 2022 504f 5354             "POST
+00016a60: 222c 0a20 2020 2020 2020 2020 2020 2070  ",.            p
+00016a70: 6174 682c 0a20 2020 2020 2020 2020 2020  ath,.           
+00016a80: 2065 7272 6f72 5f6d 6573 7361 6765 2c0a   error_message,.
+00016a90: 2020 2020 2020 2020 2020 2020 7061 7261              para
+00016aa0: 6d73 3d70 6172 616d 732c 0a20 2020 2020  ms=params,.     
+00016ab0: 2020 2020 2020 2062 6f64 793d 6469 6374         body=dict
+00016ac0: 5f74 6f5f 6a73 6f6e 2866 6561 7475 7265  _to_json(feature
+00016ad0: 5f76 6563 746f 7229 2c0a 2020 2020 2020  _vector),.      
+00016ae0: 2020 290a 2020 2020 2020 2020 7265 7475    ).        retu
+00016af0: 726e 2072 6573 702e 6a73 6f6e 2829 0a0a  rn resp.json()..
+00016b00: 2020 2020 6465 6620 6765 745f 6665 6174      def get_feat
+00016b10: 7572 655f 7665 6374 6f72 280a 2020 2020  ure_vector(.    
+00016b20: 2020 2020 7365 6c66 2c20 6e61 6d65 3a20      self, name: 
+00016b30: 7374 722c 2070 726f 6a65 6374 3a20 7374  str, project: st
+00016b40: 7220 3d20 2222 2c20 7461 673a 2073 7472  r = "", tag: str
+00016b50: 203d 204e 6f6e 652c 2075 6964 3a20 7374   = None, uid: st
+00016b60: 7220 3d20 4e6f 6e65 0a20 2020 2029 202d  r = None.    ) -
+00016b70: 3e20 4665 6174 7572 6556 6563 746f 723a  > FeatureVector:
+00016b80: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
+00016b90: 726e 2061 2073 7065 6369 6669 6320 6665  rn a specific fe
+00016ba0: 6174 7572 652d 7665 6374 6f72 2072 6566  ature-vector ref
+00016bb0: 6572 656e 6365 6420 6279 2069 7473 2074  erenced by its t
+00016bc0: 6167 206f 7220 7569 642e 2049 6620 6e6f  ag or uid. If no
+00016bd0: 6e65 2061 7265 2070 726f 7669 6465 642c  ne are provided,
+00016be0: 2060 606c 6174 6573 7460 6020 7461 6720   ``latest`` tag 
+00016bf0: 7769 6c6c 0a20 2020 2020 2020 2062 6520  will.        be 
+00016c00: 7573 6564 2e22 2222 0a0a 2020 2020 2020  used."""..      
+00016c10: 2020 7072 6f6a 6563 7420 3d20 7072 6f6a    project = proj
+00016c20: 6563 7420 6f72 2063 6f6e 6669 672e 6465  ect or config.de
+00016c30: 6661 756c 745f 7072 6f6a 6563 740a 2020  fault_project.  
+00016c40: 2020 2020 2020 7265 6665 7265 6e63 6520        reference 
+00016c50: 3d20 7365 6c66 2e5f 7265 736f 6c76 655f  = self._resolve_
+00016c60: 7265 6665 7265 6e63 6528 7461 672c 2075  reference(tag, u
+00016c70: 6964 290a 2020 2020 2020 2020 7061 7468  id).        path
+00016c80: 203d 2066 2270 726f 6a65 6374 732f 7b70   = f"projects/{p
+00016c90: 726f 6a65 6374 7d2f 6665 6174 7572 652d  roject}/feature-
+00016ca0: 7665 6374 6f72 732f 7b6e 616d 657d 2f72  vectors/{name}/r
+00016cb0: 6566 6572 656e 6365 732f 7b72 6566 6572  eferences/{refer
+00016cc0: 656e 6365 7d22 0a20 2020 2020 2020 2065  ence}".        e
+00016cd0: 7272 6f72 5f6d 6573 7361 6765 203d 2066  rror_message = f
+00016ce0: 2246 6169 6c65 6420 7265 7472 6965 7669  "Failed retrievi
+00016cf0: 6e67 2066 6561 7475 7265 2d76 6563 746f  ng feature-vecto
+00016d00: 7220 7b70 726f 6a65 6374 7d2f 7b6e 616d  r {project}/{nam
+00016d10: 657d 220a 2020 2020 2020 2020 7265 7370  e}".        resp
+00016d20: 203d 2073 656c 662e 6170 695f 6361 6c6c   = self.api_call
+00016d30: 2822 4745 5422 2c20 7061 7468 2c20 6572  ("GET", path, er
+00016d40: 726f 725f 6d65 7373 6167 6529 0a20 2020  ror_message).   
+00016d50: 2020 2020 2072 6574 7572 6e20 4665 6174       return Feat
+00016d60: 7572 6556 6563 746f 722e 6672 6f6d 5f64  ureVector.from_d
+00016d70: 6963 7428 7265 7370 2e6a 736f 6e28 2929  ict(resp.json())
+00016d80: 0a0a 2020 2020 6465 6620 6c69 7374 5f66  ..    def list_f
+00016d90: 6561 7475 7265 5f76 6563 746f 7273 280a  eature_vectors(.
+00016da0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+00016db0: 2020 2020 2020 7072 6f6a 6563 743a 2073        project: s
+00016dc0: 7472 203d 2022 222c 0a20 2020 2020 2020  tr = "",.       
+00016dd0: 206e 616d 653a 2073 7472 203d 204e 6f6e   name: str = Non
+00016de0: 652c 0a20 2020 2020 2020 2074 6167 3a20  e,.        tag: 
+00016df0: 7374 7220 3d20 4e6f 6e65 2c0a 2020 2020  str = None,.    
+00016e00: 2020 2020 7374 6174 653a 2073 7472 203d      state: str =
+00016e10: 204e 6f6e 652c 0a20 2020 2020 2020 206c   None,.        l
+00016e20: 6162 656c 733a 206c 6973 745b 7374 725d  abels: list[str]
 00016e30: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-00016e40: 2070 6172 7469 7469 6f6e 5f6f 7264 6572   partition_order
-00016e50: 3a20 556e 696f 6e5b 0a20 2020 2020 2020  : Union[.       
-00016e60: 2020 2020 206d 6c72 756e 2e63 6f6d 6d6f       mlrun.commo
-00016e70: 6e2e 7363 6865 6d61 732e 4f72 6465 7254  n.schemas.OrderT
-00016e80: 7970 652c 2073 7472 0a20 2020 2020 2020  ype, str.       
-00016e90: 205d 203d 206d 6c72 756e 2e63 6f6d 6d6f   ] = mlrun.commo
-00016ea0: 6e2e 7363 6865 6d61 732e 4f72 6465 7254  n.schemas.OrderT
-00016eb0: 7970 652e 6465 7363 2c0a 2020 2020 2920  ype.desc,.    ) 
-00016ec0: 2d3e 206c 6973 745b 4665 6174 7572 6556  -> list[FeatureV
-00016ed0: 6563 746f 725d 3a0a 2020 2020 2020 2020  ector]:.        
-00016ee0: 2222 2252 6574 7269 6576 6520 6120 6c69  """Retrieve a li
-00016ef0: 7374 206f 6620 6665 6174 7572 652d 7665  st of feature-ve
-00016f00: 6374 6f72 7320 6d61 7463 6869 6e67 2074  ctors matching t
-00016f10: 6865 2063 7269 7465 7269 6120 7072 6f76  he criteria prov
-00016f20: 6964 6564 2e0a 0a20 2020 2020 2020 203a  ided...        :
-00016f30: 7061 7261 6d20 7072 6f6a 6563 743a 2050  param project: P
-00016f40: 726f 6a65 6374 206e 616d 652e 0a20 2020  roject name..   
-00016f50: 2020 2020 203a 7061 7261 6d20 6e61 6d65       :param name
-00016f60: 3a20 4e61 6d65 206f 6620 6665 6174 7572  : Name of featur
-00016f70: 652d 7665 6374 6f72 2074 6f20 6d61 7463  e-vector to matc
-00016f80: 682e 2054 6869 7320 6973 2061 206c 696b  h. This is a lik
-00016f90: 6520 7175 6572 792c 2061 6e64 2069 7320  e query, and is 
-00016fa0: 6361 7365 2d69 6e73 656e 7369 7469 7665  case-insensitive
-00016fb0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00016fc0: 2074 6167 3a20 4d61 7463 6820 6665 6174   tag: Match feat
-00016fd0: 7572 652d 7665 6374 6f72 7320 7769 7468  ure-vectors with
-00016fe0: 2073 7065 6369 6669 6320 7461 672e 0a20   specific tag.. 
-00016ff0: 2020 2020 2020 203a 7061 7261 6d20 7374         :param st
-00017000: 6174 653a 204d 6174 6368 2066 6561 7475  ate: Match featu
-00017010: 7265 2d76 6563 746f 7273 2077 6974 6820  re-vectors with 
-00017020: 6120 7370 6563 6966 6963 2073 7461 7465  a specific state
+00016e40: 2070 6172 7469 7469 6f6e 5f62 793a 2055   partition_by: U
+00016e50: 6e69 6f6e 5b0a 2020 2020 2020 2020 2020  nion[.          
+00016e60: 2020 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73    mlrun.common.s
+00016e70: 6368 656d 6173 2e46 6561 7475 7265 5374  chemas.FeatureSt
+00016e80: 6f72 6550 6172 7469 7469 6f6e 4279 4669  orePartitionByFi
+00016e90: 656c 642c 2073 7472 0a20 2020 2020 2020  eld, str.       
+00016ea0: 205d 203d 204e 6f6e 652c 0a20 2020 2020   ] = None,.     
+00016eb0: 2020 2072 6f77 735f 7065 725f 7061 7274     rows_per_part
+00016ec0: 6974 696f 6e3a 2069 6e74 203d 2031 2c0a  ition: int = 1,.
+00016ed0: 2020 2020 2020 2020 7061 7274 6974 696f          partitio
+00016ee0: 6e5f 736f 7274 5f62 793a 2055 6e69 6f6e  n_sort_by: Union
+00016ef0: 5b6d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363  [mlrun.common.sc
+00016f00: 6865 6d61 732e 536f 7274 4669 656c 642c  hemas.SortField,
+00016f10: 2073 7472 5d20 3d20 4e6f 6e65 2c0a 2020   str] = None,.  
+00016f20: 2020 2020 2020 7061 7274 6974 696f 6e5f        partition_
+00016f30: 6f72 6465 723a 2055 6e69 6f6e 5b0a 2020  order: Union[.  
+00016f40: 2020 2020 2020 2020 2020 6d6c 7275 6e2e            mlrun.
+00016f50: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e4f  common.schemas.O
+00016f60: 7264 6572 5479 7065 2c20 7374 720a 2020  rderType, str.  
+00016f70: 2020 2020 2020 5d20 3d20 6d6c 7275 6e2e        ] = mlrun.
+00016f80: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e4f  common.schemas.O
+00016f90: 7264 6572 5479 7065 2e64 6573 632c 0a20  rderType.desc,. 
+00016fa0: 2020 2029 202d 3e20 6c69 7374 5b46 6561     ) -> list[Fea
+00016fb0: 7475 7265 5665 6374 6f72 5d3a 0a20 2020  tureVector]:.   
+00016fc0: 2020 2020 2022 2222 5265 7472 6965 7665       """Retrieve
+00016fd0: 2061 206c 6973 7420 6f66 2066 6561 7475   a list of featu
+00016fe0: 7265 2d76 6563 746f 7273 206d 6174 6368  re-vectors match
+00016ff0: 696e 6720 7468 6520 6372 6974 6572 6961  ing the criteria
+00017000: 2070 726f 7669 6465 642e 0a0a 2020 2020   provided...    
+00017010: 2020 2020 3a70 6172 616d 2070 726f 6a65      :param proje
+00017020: 6374 3a20 5072 6f6a 6563 7420 6e61 6d65  ct: Project name
 00017030: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00017040: 206c 6162 656c 733a 204d 6174 6368 2066   labels: Match f
-00017050: 6561 7475 7265 2d76 6563 746f 7273 2077  eature-vectors w
-00017060: 6869 6368 2068 6176 6520 7468 6573 6520  hich have these 
-00017070: 6c61 6265 6c73 2e0a 2020 2020 2020 2020  labels..        
-00017080: 3a70 6172 616d 2070 6172 7469 7469 6f6e  :param partition
-00017090: 5f62 793a 2046 6965 6c64 2074 6f20 6772  _by: Field to gr
-000170a0: 6f75 7020 7265 7375 6c74 7320 6279 2e20  oup results by. 
-000170b0: 4f6e 6c79 2061 6c6c 6f77 6564 2076 616c  Only allowed val
-000170c0: 7565 2069 7320 606e 616d 6560 2e20 5768  ue is `name`. Wh
-000170d0: 656e 2060 7061 7274 6974 696f 6e5f 6279  en `partition_by
-000170e0: 6020 6973 2073 7065 6369 6669 6564 2c0a  ` is specified,.
-000170f0: 2020 2020 2020 2020 2020 2020 7468 6520              the 
-00017100: 6070 6172 7469 7469 6f6e 5f73 6f72 745f  `partition_sort_
-00017110: 6279 6020 7061 7261 6d65 7465 7220 6d75  by` parameter mu
-00017120: 7374 2062 6520 7072 6f76 6964 6564 2061  st be provided a
-00017130: 7320 7765 6c6c 2e0a 2020 2020 2020 2020  s well..        
-00017140: 3a70 6172 616d 2072 6f77 735f 7065 725f  :param rows_per_
-00017150: 7061 7274 6974 696f 6e3a 2048 6f77 206d  partition: How m
-00017160: 616e 7920 746f 7020 726f 7773 2028 7065  any top rows (pe
-00017170: 7220 736f 7274 696e 6720 6465 6669 6e65  r sorting define
-00017180: 6420 6279 2060 7061 7274 6974 696f 6e5f  d by `partition_
-00017190: 736f 7274 5f62 7960 2061 6e64 2060 7061  sort_by` and `pa
-000171a0: 7274 6974 696f 6e5f 6f72 6465 7260 290a  rtition_order`).
-000171b0: 2020 2020 2020 2020 2020 2020 746f 2072              to r
-000171c0: 6574 7572 6e20 7065 7220 6772 6f75 702e  eturn per group.
-000171d0: 2044 6566 6175 6c74 2076 616c 7565 2069   Default value i
-000171e0: 7320 312e 0a20 2020 2020 2020 203a 7061  s 1..        :pa
-000171f0: 7261 6d20 7061 7274 6974 696f 6e5f 736f  ram partition_so
-00017200: 7274 5f62 793a 2057 6861 7420 6669 656c  rt_by: What fiel
-00017210: 6420 746f 2073 6f72 7420 7468 6520 7265  d to sort the re
-00017220: 7375 6c74 7320 6279 2c20 7769 7468 696e  sults by, within
-00017230: 2065 6163 6820 7061 7274 6974 696f 6e20   each partition 
-00017240: 6465 6669 6e65 6420 6279 2060 7061 7274  defined by `part
-00017250: 6974 696f 6e5f 6279 602e 0a20 2020 2020  ition_by`..     
-00017260: 2020 2020 2020 2043 7572 7265 6e74 6c79         Currently
-00017270: 2074 6865 206f 6e6c 7920 616c 6c6f 7765   the only allowe
-00017280: 6420 7661 6c75 6573 2061 7265 2060 6372  d values are `cr
-00017290: 6561 7465 6460 2061 6e64 2060 7570 6461  eated` and `upda
-000172a0: 7465 6460 2e0a 2020 2020 2020 2020 3a70  ted`..        :p
-000172b0: 6172 616d 2070 6172 7469 7469 6f6e 5f6f  aram partition_o
-000172c0: 7264 6572 3a20 4f72 6465 7220 6f66 2073  rder: Order of s
-000172d0: 6f72 7469 6e67 2077 6974 6869 6e20 7061  orting within pa
-000172e0: 7274 6974 696f 6e73 202d 2060 6173 6360  rtitions - `asc`
-000172f0: 206f 7220 6064 6573 6360 2e20 4465 6661   or `desc`. Defa
-00017300: 756c 7420 6973 2060 6465 7363 602e 0a20  ult is `desc`.. 
-00017310: 2020 2020 2020 203a 7265 7475 726e 733a         :returns:
-00017320: 204c 6973 7420 6f66 206d 6174 6368 696e   List of matchin
-00017330: 6720 3a70 793a 636c 6173 733a 607e 6d6c  g :py:class:`~ml
-00017340: 7275 6e2e 6665 6174 7572 655f 7374 6f72  run.feature_stor
-00017350: 652e 4665 6174 7572 6556 6563 746f 7260  e.FeatureVector`
-00017360: 206f 626a 6563 7473 2e0a 2020 2020 2020   objects..      
-00017370: 2020 2222 220a 0a20 2020 2020 2020 2070    """..        p
-00017380: 726f 6a65 6374 203d 2070 726f 6a65 6374  roject = project
-00017390: 206f 7220 636f 6e66 6967 2e64 6566 6175   or config.defau
-000173a0: 6c74 5f70 726f 6a65 6374 0a0a 2020 2020  lt_project..    
-000173b0: 2020 2020 7061 7261 6d73 203d 207b 0a20      params = {. 
-000173c0: 2020 2020 2020 2020 2020 2022 6e61 6d65             "name
-000173d0: 223a 206e 616d 652c 0a20 2020 2020 2020  ": name,.       
-000173e0: 2020 2020 2022 7374 6174 6522 3a20 7374       "state": st
-000173f0: 6174 652c 0a20 2020 2020 2020 2020 2020  ate,.           
-00017400: 2022 7461 6722 3a20 7461 672c 0a20 2020   "tag": tag,.   
-00017410: 2020 2020 2020 2020 2022 6c61 6265 6c22           "label"
-00017420: 3a20 6c61 6265 6c73 206f 7220 5b5d 2c0a  : labels or [],.
-00017430: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
-00017440: 2020 6966 2070 6172 7469 7469 6f6e 5f62    if partition_b
-00017450: 793a 0a20 2020 2020 2020 2020 2020 2070  y:.            p
-00017460: 6172 616d 732e 7570 6461 7465 280a 2020  arams.update(.  
-00017470: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00017480: 6c66 2e5f 6765 6e65 7261 7465 5f70 6172  lf._generate_par
-00017490: 7469 7469 6f6e 5f62 795f 7061 7261 6d73  tition_by_params
-000174a0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-000174b0: 2020 2020 2020 6d6c 7275 6e2e 636f 6d6d        mlrun.comm
-000174c0: 6f6e 2e73 6368 656d 6173 2e46 6561 7475  on.schemas.Featu
-000174d0: 7265 5374 6f72 6550 6172 7469 7469 6f6e  reStorePartition
-000174e0: 4279 4669 656c 642c 0a20 2020 2020 2020  ByField,.       
-000174f0: 2020 2020 2020 2020 2020 2020 2070 6172               par
-00017500: 7469 7469 6f6e 5f62 792c 0a20 2020 2020  tition_by,.     
-00017510: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00017520: 6f77 735f 7065 725f 7061 7274 6974 696f  ows_per_partitio
-00017530: 6e2c 0a20 2020 2020 2020 2020 2020 2020  n,.             
-00017540: 2020 2020 2020 2070 6172 7469 7469 6f6e         partition
-00017550: 5f73 6f72 745f 6279 2c0a 2020 2020 2020  _sort_by,.      
-00017560: 2020 2020 2020 2020 2020 2020 2020 7061                pa
-00017570: 7274 6974 696f 6e5f 6f72 6465 722c 0a20  rtition_order,. 
-00017580: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-00017590: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
-000175a0: 2020 2020 2020 2020 7061 7468 203d 2066          path = f
-000175b0: 2270 726f 6a65 6374 732f 7b70 726f 6a65  "projects/{proje
-000175c0: 6374 7d2f 6665 6174 7572 652d 7665 6374  ct}/feature-vect
-000175d0: 6f72 7322 0a0a 2020 2020 2020 2020 6572  ors"..        er
-000175e0: 726f 725f 6d65 7373 6167 6520 3d20 280a  ror_message = (.
-000175f0: 2020 2020 2020 2020 2020 2020 6622 4661              f"Fa
-00017600: 696c 6564 206c 6973 7469 6e67 2066 6561  iled listing fea
-00017610: 7475 7265 2d76 6563 746f 7273 2c20 7072  ture-vectors, pr
-00017620: 6f6a 6563 743a 207b 7072 6f6a 6563 747d  oject: {project}
-00017630: 2c20 7175 6572 793a 207b 7061 7261 6d73  , query: {params
-00017640: 7d22 0a20 2020 2020 2020 2029 0a20 2020  }".        ).   
-00017650: 2020 2020 2072 6573 7020 3d20 7365 6c66       resp = self
-00017660: 2e61 7069 5f63 616c 6c28 2247 4554 222c  .api_call("GET",
-00017670: 2070 6174 682c 2065 7272 6f72 5f6d 6573   path, error_mes
-00017680: 7361 6765 2c20 7061 7261 6d73 3d70 6172  sage, params=par
-00017690: 616d 7329 0a20 2020 2020 2020 2066 6561  ams).        fea
-000176a0: 7475 7265 5f76 6563 746f 7273 203d 2072  ture_vectors = r
-000176b0: 6573 702e 6a73 6f6e 2829 5b22 6665 6174  esp.json()["feat
-000176c0: 7572 655f 7665 6374 6f72 7322 5d0a 2020  ure_vectors"].  
-000176d0: 2020 2020 2020 6966 2066 6561 7475 7265        if feature
-000176e0: 5f76 6563 746f 7273 3a0a 2020 2020 2020  _vectors:.      
-000176f0: 2020 2020 2020 7265 7475 726e 205b 4665        return [Fe
-00017700: 6174 7572 6556 6563 746f 722e 6672 6f6d  atureVector.from
-00017710: 5f64 6963 7428 6f62 6a29 2066 6f72 206f  _dict(obj) for o
-00017720: 626a 2069 6e20 6665 6174 7572 655f 7665  bj in feature_ve
-00017730: 6374 6f72 735d 0a0a 2020 2020 6465 6620  ctors]..    def 
-00017740: 7374 6f72 655f 6665 6174 7572 655f 7665  store_feature_ve
-00017750: 6374 6f72 280a 2020 2020 2020 2020 7365  ctor(.        se
-00017760: 6c66 2c0a 2020 2020 2020 2020 6665 6174  lf,.        feat
-00017770: 7572 655f 7665 6374 6f72 3a20 556e 696f  ure_vector: Unio
-00017780: 6e5b 6469 6374 2c20 6d6c 7275 6e2e 636f  n[dict, mlrun.co
-00017790: 6d6d 6f6e 2e73 6368 656d 6173 2e46 6561  mmon.schemas.Fea
-000177a0: 7475 7265 5665 6374 6f72 2c20 4665 6174  tureVector, Feat
-000177b0: 7572 6556 6563 746f 725d 2c0a 2020 2020  ureVector],.    
-000177c0: 2020 2020 6e61 6d65 3d4e 6f6e 652c 0a20      name=None,. 
-000177d0: 2020 2020 2020 2070 726f 6a65 6374 3d22         project="
-000177e0: 222c 0a20 2020 2020 2020 2074 6167 3d4e  ",.        tag=N
-000177f0: 6f6e 652c 0a20 2020 2020 2020 2075 6964  one,.        uid
-00017800: 3d4e 6f6e 652c 0a20 2020 2020 2020 2076  =None,.        v
-00017810: 6572 7369 6f6e 6564 3d54 7275 652c 0a20  ersioned=True,. 
-00017820: 2020 2029 202d 3e20 6469 6374 3a0a 2020     ) -> dict:.  
-00017830: 2020 2020 2020 2222 2253 746f 7265 2061        """Store a
-00017840: 203a 7079 3a63 6c61 7373 3a60 7e6d 6c72   :py:class:`~mlr
-00017850: 756e 2e66 6561 7475 7265 5f73 746f 7265  un.feature_store
-00017860: 2e46 6561 7475 7265 5665 6374 6f72 6020  .FeatureVector` 
-00017870: 6f62 6a65 6374 2069 6e20 7468 6520 3a70  object in the :p
-00017880: 793a 6d6f 643a 606d 6c72 756e 6020 4442  y:mod:`mlrun` DB
-00017890: 2e20 5468 650a 2020 2020 2020 2020 6665  . The.        fe
-000178a0: 6174 7572 652d 7665 6374 6f72 2063 616e  ature-vector can
-000178b0: 2062 6520 6569 7468 6572 2061 206e 6577   be either a new
-000178c0: 206f 626a 6563 7420 6f72 2061 206d 6f64   object or a mod
-000178d0: 6966 6963 6174 696f 6e20 746f 2065 7869  ification to exi
-000178e0: 7374 696e 6720 6f62 6a65 6374 2072 6566  sting object ref
-000178f0: 6572 656e 6365 6420 6279 2074 6865 2070  erenced by the p
-00017900: 6172 616d 730a 2020 2020 2020 2020 6f66  arams.        of
-00017910: 2074 6865 2066 756e 6374 696f 6e2e 0a0a   the function...
-00017920: 2020 2020 2020 2020 3a70 6172 616d 2066          :param f
-00017930: 6561 7475 7265 5f76 6563 746f 723a 2054  eature_vector: T
-00017940: 6865 203a 7079 3a63 6c61 7373 3a60 7e6d  he :py:class:`~m
-00017950: 6c72 756e 2e66 6561 7475 7265 5f73 746f  lrun.feature_sto
-00017960: 7265 2e46 6561 7475 7265 5665 6374 6f72  re.FeatureVector
-00017970: 6020 746f 2073 746f 7265 2e0a 2020 2020  ` to store..    
-00017980: 2020 2020 3a70 6172 616d 206e 616d 653a      :param name:
-00017990: 2020 2020 4e61 6d65 206f 6620 6665 6174      Name of feat
-000179a0: 7572 6520 7665 6374 6f72 2e0a 2020 2020  ure vector..    
-000179b0: 2020 2020 3a70 6172 616d 2070 726f 6a65      :param proje
-000179c0: 6374 3a20 4e61 6d65 206f 6620 7072 6f6a  ct: Name of proj
-000179d0: 6563 7420 7468 6973 2066 6561 7475 7265  ect this feature
-000179e0: 2d76 6563 746f 7220 6265 6c6f 6e67 7320  -vector belongs 
-000179f0: 746f 2e0a 2020 2020 2020 2020 3a70 6172  to..        :par
-00017a00: 616d 2074 6167 3a20 5468 6520 6060 7461  am tag: The ``ta
-00017a10: 6760 6020 6f66 2074 6865 206f 626a 6563  g`` of the objec
-00017a20: 7420 746f 2072 6570 6c61 6365 2069 6e20  t to replace in 
-00017a30: 7468 6520 4442 2c20 666f 7220 6578 616d  the DB, for exam
-00017a40: 706c 6520 6060 6c61 7465 7374 6060 2e0a  ple ``latest``..
-00017a50: 2020 2020 2020 2020 3a70 6172 616d 2075          :param u
-00017a60: 6964 3a20 5468 6520 6060 7569 6460 6020  id: The ``uid`` 
-00017a70: 6f66 2074 6865 206f 626a 6563 7420 746f  of the object to
-00017a80: 2072 6570 6c61 6365 2069 6e20 7468 6520   replace in the 
-00017a90: 4442 2e20 4966 2075 7369 6e67 2074 6869  DB. If using thi
-00017aa0: 7320 7061 7261 6d65 7465 722c 2074 6865  s parameter, the
-00017ab0: 206d 6f64 6966 6965 6420 6f62 6a65 6374   modified object
-00017ac0: 0a20 2020 2020 2020 2020 2020 206d 7573  .            mus
-00017ad0: 7420 6861 7665 2074 6865 2073 616d 6520  t have the same 
-00017ae0: 6060 7569 6460 6020 6f66 2074 6865 2070  ``uid`` of the p
-00017af0: 7265 7669 6f75 736c 792d 6578 6973 7469  reviously-existi
-00017b00: 6e67 206f 626a 6563 742e 2054 6869 7320  ng object. This 
-00017b10: 6361 6e6e 6f74 2062 6520 7573 6564 2066  cannot be used f
-00017b20: 6f72 206e 6f6e 2d76 6572 7369 6f6e 6564  or non-versioned
-00017b30: 206f 626a 6563 7473 2e0a 2020 2020 2020   objects..      
-00017b40: 2020 3a70 6172 616d 2076 6572 7369 6f6e    :param version
-00017b50: 6564 3a20 5768 6574 6865 7220 746f 206d  ed: Whether to m
-00017b60: 6169 6e74 6169 6e20 7665 7273 696f 6e73  aintain versions
-00017b70: 2066 6f72 2074 6869 7320 6665 6174 7572   for this featur
-00017b80: 652d 7665 6374 6f72 2e20 416c 6c20 7665  e-vector. All ve
-00017b90: 7273 696f 6e73 206f 6620 6120 7665 7273  rsions of a vers
-00017ba0: 696f 6e65 6420 6f62 6a65 6374 0a20 2020  ioned object.   
-00017bb0: 2020 2020 2020 2020 2077 696c 6c20 6265           will be
-00017bc0: 206b 6570 7420 696e 2074 6865 2044 4220   kept in the DB 
-00017bd0: 616e 6420 6361 6e20 6265 2072 6574 7269  and can be retri
-00017be0: 6576 6564 2075 6e74 696c 2065 7870 6c69  eved until expli
-00017bf0: 6369 746c 7920 6465 6c65 7465 642e 0a20  citly deleted.. 
-00017c00: 2020 2020 2020 203a 7265 7475 726e 733a         :returns:
-00017c10: 2054 6865 203a 7079 3a63 6c61 7373 3a60   The :py:class:`
-00017c20: 7e6d 6c72 756e 2e66 6561 7475 7265 5f73  ~mlrun.feature_s
-00017c30: 746f 7265 2e46 6561 7475 7265 5665 6374  tore.FeatureVect
-00017c40: 6f72 6020 6f62 6a65 6374 2028 6173 2064  or` object (as d
-00017c50: 6963 7429 2e0a 2020 2020 2020 2020 2222  ict)..        ""
-00017c60: 220a 0a20 2020 2020 2020 2072 6566 6572  "..        refer
-00017c70: 656e 6365 203d 2073 656c 662e 5f72 6573  ence = self._res
-00017c80: 6f6c 7665 5f72 6566 6572 656e 6365 2874  olve_reference(t
-00017c90: 6167 2c20 7569 6429 0a20 2020 2020 2020  ag, uid).       
-00017ca0: 2070 6172 616d 7320 3d20 7b22 7665 7273   params = {"vers
-00017cb0: 696f 6e65 6422 3a20 7665 7273 696f 6e65  ioned": versione
-00017cc0: 647d 0a0a 2020 2020 2020 2020 6966 2069  d}..        if i
-00017cd0: 7369 6e73 7461 6e63 6528 6665 6174 7572  sinstance(featur
-00017ce0: 655f 7665 6374 6f72 2c20 6d6c 7275 6e2e  e_vector, mlrun.
-00017cf0: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e46  common.schemas.F
-00017d00: 6561 7475 7265 5665 6374 6f72 293a 0a20  eatureVector):. 
-00017d10: 2020 2020 2020 2020 2020 2066 6561 7475             featu
-00017d20: 7265 5f76 6563 746f 7220 3d20 6665 6174  re_vector = feat
-00017d30: 7572 655f 7665 6374 6f72 2e64 6963 7428  ure_vector.dict(
-00017d40: 290a 2020 2020 2020 2020 656c 6966 2069  ).        elif i
-00017d50: 7369 6e73 7461 6e63 6528 6665 6174 7572  sinstance(featur
-00017d60: 655f 7665 6374 6f72 2c20 4665 6174 7572  e_vector, Featur
-00017d70: 6556 6563 746f 7229 3a0a 2020 2020 2020  eVector):.      
-00017d80: 2020 2020 2020 6665 6174 7572 655f 7665        feature_ve
-00017d90: 6374 6f72 203d 2066 6561 7475 7265 5f76  ctor = feature_v
-00017da0: 6563 746f 722e 746f 5f64 6963 7428 290a  ector.to_dict().
-00017db0: 0a20 2020 2020 2020 206e 616d 6520 3d20  .        name = 
-00017dc0: 6e61 6d65 206f 7220 6665 6174 7572 655f  name or feature_
-00017dd0: 7665 6374 6f72 5b22 6d65 7461 6461 7461  vector["metadata
-00017de0: 225d 5b22 6e61 6d65 225d 0a20 2020 2020  "]["name"].     
-00017df0: 2020 2070 726f 6a65 6374 203d 2028 0a20     project = (. 
-00017e00: 2020 2020 2020 2020 2020 2070 726f 6a65             proje
-00017e10: 6374 0a20 2020 2020 2020 2020 2020 206f  ct.            o
-00017e20: 7220 6665 6174 7572 655f 7665 6374 6f72  r feature_vector
-00017e30: 5b22 6d65 7461 6461 7461 225d 2e67 6574  ["metadata"].get
-00017e40: 2822 7072 6f6a 6563 7422 290a 2020 2020  ("project").    
-00017e50: 2020 2020 2020 2020 6f72 2063 6f6e 6669          or confi
-00017e60: 672e 6465 6661 756c 745f 7072 6f6a 6563  g.default_projec
-00017e70: 740a 2020 2020 2020 2020 290a 2020 2020  t.        ).    
-00017e80: 2020 2020 7061 7468 203d 2066 2270 726f      path = f"pro
-00017e90: 6a65 6374 732f 7b70 726f 6a65 6374 7d2f  jects/{project}/
-00017ea0: 6665 6174 7572 652d 7665 6374 6f72 732f  feature-vectors/
-00017eb0: 7b6e 616d 657d 2f72 6566 6572 656e 6365  {name}/reference
-00017ec0: 732f 7b72 6566 6572 656e 6365 7d22 0a20  s/{reference}". 
-00017ed0: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
-00017ee0: 7361 6765 203d 2066 2246 6169 6c65 6420  sage = f"Failed 
-00017ef0: 7374 6f72 696e 6720 6665 6174 7572 652d  storing feature-
-00017f00: 7665 6374 6f72 207b 7072 6f6a 6563 747d  vector {project}
-00017f10: 2f7b 6e61 6d65 7d22 0a20 2020 2020 2020  /{name}".       
-00017f20: 2072 6573 7020 3d20 7365 6c66 2e61 7069   resp = self.api
-00017f30: 5f63 616c 6c28 0a20 2020 2020 2020 2020  _call(.         
-00017f40: 2020 2022 5055 5422 2c20 7061 7468 2c20     "PUT", path, 
-00017f50: 6572 726f 725f 6d65 7373 6167 652c 2070  error_message, p
-00017f60: 6172 616d 733d 7061 7261 6d73 2c20 626f  arams=params, bo
-00017f70: 6479 3d64 6963 745f 746f 5f6a 736f 6e28  dy=dict_to_json(
-00017f80: 6665 6174 7572 655f 7665 6374 6f72 290a  feature_vector).
-00017f90: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00017fa0: 2020 7265 7475 726e 2072 6573 702e 6a73    return resp.js
-00017fb0: 6f6e 2829 0a0a 2020 2020 6465 6620 7061  on()..    def pa
-00017fc0: 7463 685f 6665 6174 7572 655f 7665 6374  tch_feature_vect
-00017fd0: 6f72 280a 2020 2020 2020 2020 7365 6c66  or(.        self
-00017fe0: 2c0a 2020 2020 2020 2020 6e61 6d65 2c0a  ,.        name,.
-00017ff0: 2020 2020 2020 2020 6665 6174 7572 655f          feature_
-00018000: 7665 6374 6f72 5f75 7064 6174 653a 2064  vector_update: d
-00018010: 6963 742c 0a20 2020 2020 2020 2070 726f  ict,.        pro
-00018020: 6a65 6374 3d22 222c 0a20 2020 2020 2020  ject="",.       
-00018030: 2074 6167 3d4e 6f6e 652c 0a20 2020 2020   tag=None,.     
-00018040: 2020 2075 6964 3d4e 6f6e 652c 0a20 2020     uid=None,.   
-00018050: 2020 2020 2070 6174 6368 5f6d 6f64 653a       patch_mode:
-00018060: 2055 6e69 6f6e 5b0a 2020 2020 2020 2020   Union[.        
-00018070: 2020 2020 7374 722c 206d 6c72 756e 2e63      str, mlrun.c
-00018080: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 5061  ommon.schemas.Pa
-00018090: 7463 684d 6f64 650a 2020 2020 2020 2020  tchMode.        
-000180a0: 5d20 3d20 6d6c 7275 6e2e 636f 6d6d 6f6e  ] = mlrun.common
-000180b0: 2e73 6368 656d 6173 2e50 6174 6368 4d6f  .schemas.PatchMo
-000180c0: 6465 2e72 6570 6c61 6365 2c0a 2020 2020  de.replace,.    
-000180d0: 293a 0a20 2020 2020 2020 2022 2222 4d6f  ):.        """Mo
-000180e0: 6469 6679 2028 7061 7463 6829 2061 6e20  dify (patch) an 
-000180f0: 6578 6973 7469 6e67 203a 7079 3a63 6c61  existing :py:cla
-00018100: 7373 3a60 7e6d 6c72 756e 2e66 6561 7475  ss:`~mlrun.featu
-00018110: 7265 5f73 746f 7265 2e46 6561 7475 7265  re_store.Feature
-00018120: 5665 6374 6f72 6020 6f62 6a65 6374 2e0a  Vector` object..
-00018130: 2020 2020 2020 2020 5468 6520 6f62 6a65          The obje
-00018140: 6374 2069 7320 6964 656e 7469 6669 6564  ct is identified
-00018150: 2062 7920 6974 7320 6e61 6d65 2028 616e   by its name (an
-00018160: 6420 7072 6f6a 6563 7420 6974 2062 656c  d project it bel
-00018170: 6f6e 6773 2074 6f29 2c20 6173 2077 656c  ongs to), as wel
-00018180: 6c20 6173 206f 7074 696f 6e61 6c6c 7920  l as optionally 
-00018190: 6120 6060 7461 6760 6020 6f72 2069 7473  a ``tag`` or its
-000181a0: 0a20 2020 2020 2020 2060 6075 6964 6060  .        ``uid``
-000181b0: 2028 666f 7220 7665 7273 696f 6e65 6420   (for versioned 
-000181c0: 6f62 6a65 6374 292e 2049 6620 626f 7468  object). If both
-000181d0: 2060 6074 6167 6060 2061 6e64 2060 6075   ``tag`` and ``u
-000181e0: 6964 6060 2061 7265 206f 6d69 7474 6564  id`` are omitted
-000181f0: 2074 6865 6e20 7468 6520 6f62 6a65 6374   then the object
-00018200: 2077 6974 6820 7461 6720 6060 6c61 7465   with tag ``late
-00018210: 7374 6060 0a20 2020 2020 2020 2069 7320  st``.        is 
-00018220: 6d6f 6469 6669 6564 2e0a 0a20 2020 2020  modified...     
-00018230: 2020 203a 7061 7261 6d20 6e61 6d65 3a20     :param name: 
-00018240: 4e61 6d65 206f 6620 7468 6520 6f62 6a65  Name of the obje
-00018250: 6374 2074 6f20 7061 7463 682e 0a20 2020  ct to patch..   
-00018260: 2020 2020 203a 7061 7261 6d20 6665 6174       :param feat
-00018270: 7572 655f 7665 6374 6f72 5f75 7064 6174  ure_vector_updat
-00018280: 653a 2054 6865 206d 6f64 6966 6963 6174  e: The modificat
-00018290: 696f 6e73 206e 6565 6465 6420 696e 2074  ions needed in t
-000182a0: 6865 206f 626a 6563 742e 2054 6869 7320  he object. This 
-000182b0: 7061 7261 6d65 7465 7220 6f6e 6c79 2068  parameter only h
-000182c0: 6173 2074 6865 2063 6861 6e67 6573 2069  as the changes i
-000182d0: 6e20 6974 2c0a 2020 2020 2020 2020 2020  n it,.          
-000182e0: 2020 6e6f 7420 6120 6675 6c6c 206f 626a    not a full obj
-000182f0: 6563 742e 0a20 2020 2020 2020 203a 7061  ect..        :pa
-00018300: 7261 6d20 7072 6f6a 6563 743a 2050 726f  ram project: Pro
-00018310: 6a65 6374 2077 6869 6368 2063 6f6e 7461  ject which conta
-00018320: 696e 7320 7468 6520 6d6f 6469 6669 6564  ins the modified
-00018330: 206f 626a 6563 742e 0a20 2020 2020 2020   object..       
-00018340: 203a 7061 7261 6d20 7461 673a 2054 6865   :param tag: The
-00018350: 2074 6167 206f 6620 7468 6520 6f62 6a65   tag of the obje
-00018360: 6374 2074 6f20 6d6f 6469 6679 2e0a 2020  ct to modify..  
-00018370: 2020 2020 2020 3a70 6172 616d 2075 6964        :param uid
-00018380: 3a20 7569 6420 6f66 2074 6865 206f 626a  : uid of the obj
-00018390: 6563 7420 746f 206d 6f64 6966 792e 0a20  ect to modify.. 
-000183a0: 2020 2020 2020 203a 7061 7261 6d20 7061         :param pa
-000183b0: 7463 685f 6d6f 6465 3a20 5468 6520 7374  tch_mode: The st
-000183c0: 7261 7465 6779 2066 6f72 206d 6572 6769  rategy for mergi
-000183d0: 6e67 2074 6865 2063 6861 6e67 6573 2077  ng the changes w
-000183e0: 6974 6820 7468 6520 6578 6973 7469 6e67  ith the existing
-000183f0: 206f 626a 6563 742e 2043 616e 2062 6520   object. Can be 
-00018400: 6569 7468 6572 2060 6072 6570 6c61 6365  either ``replace
-00018410: 6060 0a20 2020 2020 2020 2020 2020 206f  ``.            o
-00018420: 7220 6060 6164 6469 7469 7665 6060 2e0a  r ``additive``..
-00018430: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00018440: 2020 2020 7265 6665 7265 6e63 6520 3d20      reference = 
-00018450: 7365 6c66 2e5f 7265 736f 6c76 655f 7265  self._resolve_re
-00018460: 6665 7265 6e63 6528 7461 672c 2075 6964  ference(tag, uid
-00018470: 290a 2020 2020 2020 2020 7072 6f6a 6563  ).        projec
-00018480: 7420 3d20 7072 6f6a 6563 7420 6f72 2063  t = project or c
-00018490: 6f6e 6669 672e 6465 6661 756c 745f 7072  onfig.default_pr
-000184a0: 6f6a 6563 740a 2020 2020 2020 2020 6865  oject.        he
-000184b0: 6164 6572 7320 3d20 7b6d 6c72 756e 2e63  aders = {mlrun.c
-000184c0: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 4865  ommon.schemas.He
-000184d0: 6164 6572 4e61 6d65 732e 7061 7463 685f  aderNames.patch_
-000184e0: 6d6f 6465 3a20 7061 7463 685f 6d6f 6465  mode: patch_mode
-000184f0: 7d0a 2020 2020 2020 2020 7061 7468 203d  }.        path =
-00018500: 2066 2270 726f 6a65 6374 732f 7b70 726f   f"projects/{pro
-00018510: 6a65 6374 7d2f 6665 6174 7572 652d 7665  ject}/feature-ve
-00018520: 6374 6f72 732f 7b6e 616d 657d 2f72 6566  ctors/{name}/ref
-00018530: 6572 656e 6365 732f 7b72 6566 6572 656e  erences/{referen
-00018540: 6365 7d22 0a20 2020 2020 2020 2065 7272  ce}".        err
-00018550: 6f72 5f6d 6573 7361 6765 203d 2066 2246  or_message = f"F
-00018560: 6169 6c65 6420 7570 6461 7469 6e67 2066  ailed updating f
-00018570: 6561 7475 7265 2d76 6563 746f 7220 7b70  eature-vector {p
-00018580: 726f 6a65 6374 7d2f 7b6e 616d 657d 220a  roject}/{name}".
-00018590: 2020 2020 2020 2020 7365 6c66 2e61 7069          self.api
-000185a0: 5f63 616c 6c28 0a20 2020 2020 2020 2020  _call(.         
-000185b0: 2020 2022 5041 5443 4822 2c0a 2020 2020     "PATCH",.    
-000185c0: 2020 2020 2020 2020 7061 7468 2c0a 2020          path,.  
-000185d0: 2020 2020 2020 2020 2020 6572 726f 725f            error_
-000185e0: 6d65 7373 6167 652c 0a20 2020 2020 2020  message,.       
-000185f0: 2020 2020 2062 6f64 793d 6469 6374 5f74       body=dict_t
-00018600: 6f5f 6a73 6f6e 2866 6561 7475 7265 5f76  o_json(feature_v
-00018610: 6563 746f 725f 7570 6461 7465 292c 0a20  ector_update),. 
-00018620: 2020 2020 2020 2020 2020 2068 6561 6465             heade
-00018630: 7273 3d68 6561 6465 7273 2c0a 2020 2020  rs=headers,.    
-00018640: 2020 2020 290a 0a20 2020 2064 6566 2064      )..    def d
-00018650: 656c 6574 655f 6665 6174 7572 655f 7665  elete_feature_ve
-00018660: 6374 6f72 2873 656c 662c 206e 616d 652c  ctor(self, name,
-00018670: 2070 726f 6a65 6374 3d22 222c 2074 6167   project="", tag
-00018680: 3d4e 6f6e 652c 2075 6964 3d4e 6f6e 6529  =None, uid=None)
-00018690: 3a0a 2020 2020 2020 2020 2222 2244 656c  :.        """Del
-000186a0: 6574 6520 6120 3a70 793a 636c 6173 733a  ete a :py:class:
-000186b0: 607e 6d6c 7275 6e2e 6665 6174 7572 655f  `~mlrun.feature_
-000186c0: 7374 6f72 652e 4665 6174 7572 6556 6563  store.FeatureVec
-000186d0: 746f 7260 206f 626a 6563 7420 6672 6f6d  tor` object from
-000186e0: 2074 6865 2044 422e 0a20 2020 2020 2020   the DB..       
-000186f0: 2049 6620 6060 7461 6760 6020 6f72 2060   If ``tag`` or `
-00018700: 6075 6964 6060 2061 7265 2073 7065 6369  `uid`` are speci
-00018710: 6669 6564 2c20 7468 656e 206a 7573 7420  fied, then just 
-00018720: 7468 6520 7665 7273 696f 6e20 7265 6665  the version refe
-00018730: 7265 6e63 6564 2062 7920 7468 656d 2077  renced by them w
-00018740: 696c 6c20 6265 2064 656c 6574 6564 2e20  ill be deleted. 
-00018750: 5573 696e 6720 626f 7468 0a20 2020 2020  Using both.     
-00018760: 2020 2069 7320 6e6f 7420 616c 6c6f 7765     is not allowe
-00018770: 642e 0a20 2020 2020 2020 2049 6620 6e6f  d..        If no
-00018780: 6e65 2061 7265 2073 7065 6369 6669 6564  ne are specified
-00018790: 2c20 7468 656e 2061 6c6c 2069 6e73 7461  , then all insta
-000187a0: 6e63 6573 206f 6620 7468 6520 6f62 6a65  nces of the obje
-000187b0: 6374 2077 686f 7365 206e 616d 6520 6973  ct whose name is
-000187c0: 2060 606e 616d 6560 6020 7769 6c6c 2062   ``name`` will b
-000187d0: 6520 6465 6c65 7465 642e 0a20 2020 2020  e deleted..     
-000187e0: 2020 2022 2222 0a20 2020 2020 2020 2070     """.        p
-000187f0: 726f 6a65 6374 203d 2070 726f 6a65 6374  roject = project
-00018800: 206f 7220 636f 6e66 6967 2e64 6566 6175   or config.defau
-00018810: 6c74 5f70 726f 6a65 6374 0a20 2020 2020  lt_project.     
-00018820: 2020 2070 6174 6820 3d20 6622 7072 6f6a     path = f"proj
-00018830: 6563 7473 2f7b 7072 6f6a 6563 747d 2f66  ects/{project}/f
-00018840: 6561 7475 7265 2d76 6563 746f 7273 2f7b  eature-vectors/{
-00018850: 6e61 6d65 7d22 0a20 2020 2020 2020 2069  name}".        i
-00018860: 6620 7461 6720 6f72 2075 6964 3a0a 2020  f tag or uid:.  
-00018870: 2020 2020 2020 2020 2020 7265 6665 7265            refere
-00018880: 6e63 6520 3d20 7365 6c66 2e5f 7265 736f  nce = self._reso
-00018890: 6c76 655f 7265 6665 7265 6e63 6528 7461  lve_reference(ta
-000188a0: 672c 2075 6964 290a 2020 2020 2020 2020  g, uid).        
-000188b0: 2020 2020 7061 7468 203d 2070 6174 6820      path = path 
-000188c0: 2b20 6622 2f72 6566 6572 656e 6365 732f  + f"/references/
-000188d0: 7b72 6566 6572 656e 6365 7d22 0a0a 2020  {reference}"..  
-000188e0: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
-000188f0: 6167 6520 3d20 6622 4661 696c 6564 2064  age = f"Failed d
-00018900: 656c 6574 696e 6720 6665 6174 7572 652d  eleting feature-
-00018910: 7665 6374 6f72 207b 6e61 6d65 7d22 0a20  vector {name}". 
-00018920: 2020 2020 2020 2073 656c 662e 6170 695f         self.api_
-00018930: 6361 6c6c 2822 4445 4c45 5445 222c 2070  call("DELETE", p
-00018940: 6174 682c 2065 7272 6f72 5f6d 6573 7361  ath, error_messa
-00018950: 6765 290a 0a20 2020 2064 6566 2074 6167  ge)..    def tag
-00018960: 5f6f 626a 6563 7473 280a 2020 2020 2020  _objects(.      
-00018970: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-00018980: 7072 6f6a 6563 743a 2073 7472 2c0a 2020  project: str,.  
-00018990: 2020 2020 2020 7461 675f 6e61 6d65 3a20        tag_name: 
-000189a0: 7374 722c 0a20 2020 2020 2020 206f 626a  str,.        obj
-000189b0: 6563 7473 3a20 556e 696f 6e5b 6d6c 7275  ects: Union[mlru
-000189c0: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
-000189d0: 2e54 6167 4f62 6a65 6374 732c 2064 6963  .TagObjects, dic
-000189e0: 745d 2c0a 2020 2020 2020 2020 7265 706c  t],.        repl
-000189f0: 6163 653a 2062 6f6f 6c20 3d20 4661 6c73  ace: bool = Fals
-00018a00: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
-00018a10: 2020 2222 2254 6167 2061 206c 6973 7420    """Tag a list 
-00018a20: 6f66 206f 626a 6563 7473 2e0a 0a20 2020  of objects...   
-00018a30: 2020 2020 203a 7061 7261 6d20 7072 6f6a       :param proj
-00018a40: 6563 743a 2050 726f 6a65 6374 2077 6869  ect: Project whi
-00018a50: 6368 2063 6f6e 7461 696e 7320 7468 6520  ch contains the 
-00018a60: 6f62 6a65 6374 732e 0a20 2020 2020 2020  objects..       
-00018a70: 203a 7061 7261 6d20 7461 675f 6e61 6d65   :param tag_name
-00018a80: 3a20 5468 6520 7461 6720 746f 2073 6574  : The tag to set
-00018a90: 206f 6e20 7468 6520 6f62 6a65 6374 732e   on the objects.
-00018aa0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00018ab0: 6f62 6a65 6374 733a 2054 6865 206f 626a  objects: The obj
-00018ac0: 6563 7473 2074 6f20 7461 672e 0a20 2020  ects to tag..   
-00018ad0: 2020 2020 203a 7061 7261 6d20 7265 706c       :param repl
-00018ae0: 6163 653a 2057 6865 7468 6572 2074 6f20  ace: Whether to 
-00018af0: 7265 706c 6163 6520 7468 6520 6578 6973  replace the exis
-00018b00: 7469 6e67 2074 6167 7320 6f66 2074 6865  ting tags of the
-00018b10: 206f 626a 6563 7473 206f 7220 746f 2061   objects or to a
-00018b20: 6464 2074 6865 206e 6577 2074 6167 2074  dd the new tag t
-00018b30: 6f20 7468 656d 2e0a 2020 2020 2020 2020  o them..        
-00018b40: 2222 220a 0a20 2020 2020 2020 2070 6174  """..        pat
-00018b50: 6820 3d20 6622 7072 6f6a 6563 7473 2f7b  h = f"projects/{
-00018b60: 7072 6f6a 6563 747d 2f74 6167 732f 7b74  project}/tags/{t
-00018b70: 6167 5f6e 616d 657d 220a 2020 2020 2020  ag_name}".      
-00018b80: 2020 6572 726f 725f 6d65 7373 6167 6520    error_message 
-00018b90: 3d20 6622 4661 696c 6564 2074 6f20 7461  = f"Failed to ta
-00018ba0: 6720 7b74 6167 5f6e 616d 657d 206f 6e20  g {tag_name} on 
-00018bb0: 6f62 6a65 6374 7320 7b6f 626a 6563 7473  objects {objects
-00018bc0: 7d22 0a20 2020 2020 2020 206d 6574 686f  }".        metho
-00018bd0: 6420 3d20 2250 4f53 5422 2069 6620 7265  d = "POST" if re
-00018be0: 706c 6163 6520 656c 7365 2022 5055 5422  place else "PUT"
-00018bf0: 0a20 2020 2020 2020 2073 656c 662e 6170  .        self.ap
-00018c00: 695f 6361 6c6c 280a 2020 2020 2020 2020  i_call(.        
-00018c10: 2020 2020 6d65 7468 6f64 2c0a 2020 2020      method,.    
-00018c20: 2020 2020 2020 2020 7061 7468 2c0a 2020          path,.  
-00018c30: 2020 2020 2020 2020 2020 6572 726f 725f            error_
-00018c40: 6d65 7373 6167 652c 0a20 2020 2020 2020  message,.       
-00018c50: 2020 2020 2062 6f64 793d 6469 6374 5f74       body=dict_t
-00018c60: 6f5f 6a73 6f6e 280a 2020 2020 2020 2020  o_json(.        
-00018c70: 2020 2020 2020 2020 6f62 6a65 6374 732e          objects.
-00018c80: 6469 6374 2829 0a20 2020 2020 2020 2020  dict().         
-00018c90: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-00018ca0: 616e 6365 286f 626a 6563 7473 2c20 6d6c  ance(objects, ml
-00018cb0: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
-00018cc0: 6173 2e54 6167 4f62 6a65 6374 7329 0a20  as.TagObjects). 
-00018cd0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00018ce0: 6c73 6520 6f62 6a65 6374 730a 2020 2020  lse objects.    
-00018cf0: 2020 2020 2020 2020 292c 0a20 2020 2020          ),.     
-00018d00: 2020 2029 0a0a 2020 2020 6465 6620 6465     )..    def de
-00018d10: 6c65 7465 5f6f 626a 6563 7473 5f74 6167  lete_objects_tag
-00018d20: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-00018d30: 2020 2020 2020 2020 7072 6f6a 6563 743a          project:
-00018d40: 2073 7472 2c0a 2020 2020 2020 2020 7461   str,.        ta
-00018d50: 675f 6e61 6d65 3a20 7374 722c 0a20 2020  g_name: str,.   
-00018d60: 2020 2020 2074 6167 5f6f 626a 6563 7473       tag_objects
-00018d70: 3a20 556e 696f 6e5b 6d6c 7275 6e2e 636f  : Union[mlrun.co
-00018d80: 6d6d 6f6e 2e73 6368 656d 6173 2e54 6167  mmon.schemas.Tag
-00018d90: 4f62 6a65 6374 732c 2064 6963 745d 2c0a  Objects, dict],.
-00018da0: 2020 2020 293a 0a20 2020 2020 2020 2022      ):.        "
-00018db0: 2222 4465 6c65 7465 2061 2074 6167 2066  ""Delete a tag f
-00018dc0: 726f 6d20 6120 6c69 7374 206f 6620 6f62  rom a list of ob
-00018dd0: 6a65 6374 732e 0a0a 2020 2020 2020 2020  jects...        
-00018de0: 3a70 6172 616d 2070 726f 6a65 6374 3a20  :param project: 
-00018df0: 5072 6f6a 6563 7420 7768 6963 6820 636f  Project which co
-00018e00: 6e74 6169 6e73 2074 6865 206f 626a 6563  ntains the objec
-00018e10: 7473 2e0a 2020 2020 2020 2020 3a70 6172  ts..        :par
-00018e20: 616d 2074 6167 5f6e 616d 653a 2054 6865  am tag_name: The
-00018e30: 2074 6167 2074 6f20 6465 6c65 7465 2066   tag to delete f
-00018e40: 726f 6d20 7468 6520 6f62 6a65 6374 732e  rom the objects.
-00018e50: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00018e60: 7461 675f 6f62 6a65 6374 733a 2054 6865  tag_objects: The
-00018e70: 206f 626a 6563 7473 2074 6f20 6465 6c65   objects to dele
-00018e80: 7465 2074 6865 2074 6167 2066 726f 6d2e  te the tag from.
-00018e90: 0a0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00018ea0: 2020 2020 2020 7061 7468 203d 2066 2270        path = f"p
-00018eb0: 726f 6a65 6374 732f 7b70 726f 6a65 6374  rojects/{project
-00018ec0: 7d2f 7461 6773 2f7b 7461 675f 6e61 6d65  }/tags/{tag_name
-00018ed0: 7d22 0a20 2020 2020 2020 2065 7272 6f72  }".        error
-00018ee0: 5f6d 6573 7361 6765 203d 2066 2246 6169  _message = f"Fai
-00018ef0: 6c65 6420 6465 6c65 7469 6e67 2074 6167  led deleting tag
-00018f00: 2066 726f 6d20 7b74 6167 5f6e 616d 657d   from {tag_name}
-00018f10: 220a 2020 2020 2020 2020 7365 6c66 2e61  ".        self.a
-00018f20: 7069 5f63 616c 6c28 0a20 2020 2020 2020  pi_call(.       
-00018f30: 2020 2020 2022 4445 4c45 5445 222c 0a20       "DELETE",. 
-00018f40: 2020 2020 2020 2020 2020 2070 6174 682c             path,
-00018f50: 0a20 2020 2020 2020 2020 2020 2065 7272  .            err
-00018f60: 6f72 5f6d 6573 7361 6765 2c0a 2020 2020  or_message,.    
-00018f70: 2020 2020 2020 2020 626f 6479 3d64 6963          body=dic
-00018f80: 745f 746f 5f6a 736f 6e28 0a20 2020 2020  t_to_json(.     
-00018f90: 2020 2020 2020 2020 2020 2074 6167 5f6f             tag_o
-00018fa0: 626a 6563 7473 2e64 6963 7428 290a 2020  bjects.dict().  
-00018fb0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00018fc0: 2069 7369 6e73 7461 6e63 6528 7461 675f   isinstance(tag_
-00018fd0: 6f62 6a65 6374 732c 206d 6c72 756e 2e63  objects, mlrun.c
-00018fe0: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 5461  ommon.schemas.Ta
-00018ff0: 674f 626a 6563 7473 290a 2020 2020 2020  gObjects).      
-00019000: 2020 2020 2020 2020 2020 656c 7365 2074            else t
-00019010: 6167 5f6f 626a 6563 7473 0a20 2020 2020  ag_objects.     
-00019020: 2020 2020 2020 2029 2c0a 2020 2020 2020         ),.      
-00019030: 2020 290a 0a20 2020 2064 6566 2074 6167    )..    def tag
-00019040: 5f61 7274 6966 6163 7473 280a 2020 2020  _artifacts(.    
-00019050: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-00019060: 2020 6172 7469 6661 6374 733a 2055 6e69    artifacts: Uni
-00019070: 6f6e 5b6c 6973 745b 4172 7469 6661 6374  on[list[Artifact
-00019080: 5d2c 206c 6973 745b 6469 6374 5d2c 2041  ], list[dict], A
-00019090: 7274 6966 6163 742c 2064 6963 745d 2c0a  rtifact, dict],.
-000190a0: 2020 2020 2020 2020 7072 6f6a 6563 743a          project:
-000190b0: 2073 7472 2c0a 2020 2020 2020 2020 7461   str,.        ta
-000190c0: 675f 6e61 6d65 3a20 7374 722c 0a20 2020  g_name: str,.   
-000190d0: 2020 2020 2072 6570 6c61 6365 3a20 626f       replace: bo
-000190e0: 6f6c 203d 2046 616c 7365 2c0a 2020 2020  ol = False,.    
-000190f0: 293a 0a20 2020 2020 2020 2022 2222 5461  ):.        """Ta
-00019100: 6720 6120 6c69 7374 206f 6620 6172 7469  g a list of arti
-00019110: 6661 6374 732e 0a0a 2020 2020 2020 2020  facts...        
-00019120: 3a70 6172 616d 2061 7274 6966 6163 7473  :param artifacts
-00019130: 3a20 5468 6520 6172 7469 6661 6374 7320  : The artifacts 
-00019140: 746f 2074 6167 2e20 4361 6e20 6265 2061  to tag. Can be a
-00019150: 206c 6973 7420 6f66 203a 7079 3a63 6c61   list of :py:cla
-00019160: 7373 3a60 7e6d 6c72 756e 2e61 7274 6966  ss:`~mlrun.artif
-00019170: 6163 7473 2e41 7274 6966 6163 7460 206f  acts.Artifact` o
-00019180: 626a 6563 7473 206f 720a 2020 2020 2020  bjects or.      
-00019190: 2020 2020 2020 6469 6374 696f 6e61 7269        dictionari
-000191a0: 6573 2c20 6f72 2061 2073 696e 676c 6520  es, or a single 
-000191b0: 6f62 6a65 6374 2e0a 2020 2020 2020 2020  object..        
-000191c0: 3a70 6172 616d 2070 726f 6a65 6374 3a20  :param project: 
-000191d0: 5072 6f6a 6563 7420 7768 6963 6820 636f  Project which co
-000191e0: 6e74 6169 6e73 2074 6865 2061 7274 6966  ntains the artif
-000191f0: 6163 7473 2e0a 2020 2020 2020 2020 3a70  acts..        :p
-00019200: 6172 616d 2074 6167 5f6e 616d 653a 2054  aram tag_name: T
-00019210: 6865 2074 6167 2074 6f20 7365 7420 6f6e  he tag to set on
-00019220: 2074 6865 2061 7274 6966 6163 7473 2e0a   the artifacts..
-00019230: 2020 2020 2020 2020 3a70 6172 616d 2072          :param r
-00019240: 6570 6c61 6365 3a20 4966 2054 7275 652c  eplace: If True,
-00019250: 2072 6570 6c61 6365 2065 7869 7374 696e   replace existin
-00019260: 6720 7461 6773 2c20 6f74 6865 7277 6973  g tags, otherwis
-00019270: 6520 6170 7065 6e64 2074 6f20 6578 6973  e append to exis
-00019280: 7469 6e67 2074 6167 732e 0a20 2020 2020  ting tags..     
-00019290: 2020 2022 2222 0a20 2020 2020 2020 2074     """.        t
-000192a0: 6167 5f6f 626a 6563 7473 203d 2073 656c  ag_objects = sel
-000192b0: 662e 5f72 6573 6f6c 7665 5f61 7274 6966  f._resolve_artif
-000192c0: 6163 7473 5f74 6f5f 7461 675f 6f62 6a65  acts_to_tag_obje
-000192d0: 6374 7328 6172 7469 6661 6374 7329 0a20  cts(artifacts). 
-000192e0: 2020 2020 2020 2073 656c 662e 7461 675f         self.tag_
-000192f0: 6f62 6a65 6374 7328 7072 6f6a 6563 742c  objects(project,
-00019300: 2074 6167 5f6e 616d 652c 206f 626a 6563   tag_name, objec
-00019310: 7473 3d74 6167 5f6f 626a 6563 7473 2c20  ts=tag_objects, 
-00019320: 7265 706c 6163 653d 7265 706c 6163 6529  replace=replace)
-00019330: 0a0a 2020 2020 6465 6620 6465 6c65 7465  ..    def delete
-00019340: 5f61 7274 6966 6163 7473 5f74 6167 7328  _artifacts_tags(
-00019350: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-00019360: 2020 2020 2020 2061 7274 6966 6163 7473         artifacts
-00019370: 2c0a 2020 2020 2020 2020 7072 6f6a 6563  ,.        projec
-00019380: 743a 2073 7472 2c0a 2020 2020 2020 2020  t: str,.        
-00019390: 7461 675f 6e61 6d65 3a20 7374 722c 0a20  tag_name: str,. 
-000193a0: 2020 2029 3a0a 2020 2020 2020 2020 2222     ):.        ""
-000193b0: 2244 656c 6574 6520 7461 6720 6672 6f6d  "Delete tag from
-000193c0: 2061 206c 6973 7420 6f66 2061 7274 6966   a list of artif
-000193d0: 6163 7473 2e0a 0a20 2020 2020 2020 203a  acts...        :
-000193e0: 7061 7261 6d20 6172 7469 6661 6374 733a  param artifacts:
-000193f0: 2054 6865 2061 7274 6966 6163 7473 2074   The artifacts t
-00019400: 6f20 6465 6c65 7465 2074 6865 2074 6167  o delete the tag
-00019410: 2066 726f 6d2e 2043 616e 2062 6520 6120   from. Can be a 
-00019420: 6c69 7374 206f 6620 3a70 793a 636c 6173  list of :py:clas
-00019430: 733a 607e 6d6c 7275 6e2e 6172 7469 6661  s:`~mlrun.artifa
-00019440: 6374 732e 4172 7469 6661 6374 600a 2020  cts.Artifact`.  
-00019450: 2020 2020 2020 2020 2020 6f62 6a65 6374            object
-00019460: 7320 6f72 2064 6963 7469 6f6e 6172 6965  s or dictionarie
-00019470: 732c 206f 7220 6120 7369 6e67 6c65 206f  s, or a single o
-00019480: 626a 6563 742e 0a20 2020 2020 2020 203a  bject..        :
-00019490: 7061 7261 6d20 7072 6f6a 6563 743a 2050  param project: P
-000194a0: 726f 6a65 6374 2077 6869 6368 2063 6f6e  roject which con
-000194b0: 7461 696e 7320 7468 6520 6172 7469 6661  tains the artifa
-000194c0: 6374 732e 0a20 2020 2020 2020 203a 7061  cts..        :pa
-000194d0: 7261 6d20 7461 675f 6e61 6d65 3a20 5468  ram tag_name: Th
-000194e0: 6520 7461 6720 746f 2073 6574 206f 6e20  e tag to set on 
-000194f0: 7468 6520 6172 7469 6661 6374 732e 0a20  the artifacts.. 
-00019500: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00019510: 2020 2074 6167 5f6f 626a 6563 7473 203d     tag_objects =
-00019520: 2073 656c 662e 5f72 6573 6f6c 7665 5f61   self._resolve_a
-00019530: 7274 6966 6163 7473 5f74 6f5f 7461 675f  rtifacts_to_tag_
-00019540: 6f62 6a65 6374 7328 6172 7469 6661 6374  objects(artifact
-00019550: 7329 0a20 2020 2020 2020 2073 656c 662e  s).        self.
-00019560: 6465 6c65 7465 5f6f 626a 6563 7473 5f74  delete_objects_t
-00019570: 6167 2870 726f 6a65 6374 2c20 7461 675f  ag(project, tag_
-00019580: 6e61 6d65 2c20 7461 675f 6f62 6a65 6374  name, tag_object
-00019590: 7329 0a0a 2020 2020 6465 6620 6c69 7374  s)..    def list
-000195a0: 5f70 726f 6a65 6374 7328 0a20 2020 2020  _projects(.     
-000195b0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-000195c0: 206f 776e 6572 3a20 7374 7220 3d20 4e6f   owner: str = No
-000195d0: 6e65 2c0a 2020 2020 2020 2020 666f 726d  ne,.        form
-000195e0: 6174 5f3a 2055 6e69 6f6e 5b0a 2020 2020  at_: Union[.    
-000195f0: 2020 2020 2020 2020 7374 722c 206d 6c72          str, mlr
-00019600: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
-00019610: 732e 5072 6f6a 6563 7473 466f 726d 6174  s.ProjectsFormat
-00019620: 0a20 2020 2020 2020 205d 203d 206d 6c72  .        ] = mlr
-00019630: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
-00019640: 732e 5072 6f6a 6563 7473 466f 726d 6174  s.ProjectsFormat
-00019650: 2e6e 616d 655f 6f6e 6c79 2c0a 2020 2020  .name_only,.    
-00019660: 2020 2020 6c61 6265 6c73 3a20 6c69 7374      labels: list
-00019670: 5b73 7472 5d20 3d20 4e6f 6e65 2c0a 2020  [str] = None,.  
-00019680: 2020 2020 2020 7374 6174 653a 2055 6e69        state: Uni
-00019690: 6f6e 5b73 7472 2c20 6d6c 7275 6e2e 636f  on[str, mlrun.co
-000196a0: 6d6d 6f6e 2e73 6368 656d 6173 2e50 726f  mmon.schemas.Pro
-000196b0: 6a65 6374 5374 6174 655d 203d 204e 6f6e  jectState] = Non
-000196c0: 652c 0a20 2020 2029 202d 3e20 6c69 7374  e,.    ) -> list
-000196d0: 5b55 6e69 6f6e 5b6d 6c72 756e 2e70 726f  [Union[mlrun.pro
-000196e0: 6a65 6374 732e 4d6c 7275 6e50 726f 6a65  jects.MlrunProje
-000196f0: 6374 2c20 7374 725d 5d3a 0a20 2020 2020  ct, str]]:.     
-00019700: 2020 2022 2222 5265 7475 726e 2061 206c     """Return a l
-00019710: 6973 7420 6f66 2074 6865 2065 7869 7374  ist of the exist
-00019720: 696e 6720 7072 6f6a 6563 7473 2c20 706f  ing projects, po
-00019730: 7465 6e74 6961 6c6c 7920 6669 6c74 6572  tentially filter
-00019740: 6564 2062 7920 7370 6563 6966 6963 2063  ed by specific c
-00019750: 7269 7465 7269 612e 0a0a 2020 2020 2020  riteria...      
-00019760: 2020 3a70 6172 616d 206f 776e 6572 3a20    :param owner: 
-00019770: 4c69 7374 206f 6e6c 7920 7072 6f6a 6563  List only projec
-00019780: 7473 2062 656c 6f6e 6769 6e67 2074 6f20  ts belonging to 
-00019790: 7468 6973 2073 7065 6369 6669 6320 6f77  this specific ow
-000197a0: 6e65 722e 0a20 2020 2020 2020 203a 7061  ner..        :pa
-000197b0: 7261 6d20 666f 726d 6174 5f3a 2046 6f72  ram format_: For
-000197c0: 6d61 7420 6f66 2074 6865 2072 6573 756c  mat of the resul
-000197d0: 7473 2e20 506f 7373 6962 6c65 2076 616c  ts. Possible val
-000197e0: 7565 7320 6172 653a 0a0a 2020 2020 2020  ues are:..      
-000197f0: 2020 2020 2020 2d20 6060 6e61 6d65 5f6f        - ``name_o
-00019800: 6e6c 7960 6020 2864 6566 6175 6c74 2076  nly`` (default v
-00019810: 616c 7565 2920 2d20 5265 7475 726e 206a  alue) - Return j
-00019820: 7573 7420 7468 6520 6e61 6d65 7320 6f66  ust the names of
-00019830: 2074 6865 2070 726f 6a65 6374 732e 0a20   the projects.. 
-00019840: 2020 2020 2020 2020 2020 202d 2060 606d             - ``m
-00019850: 696e 696d 616c 6060 202d 2052 6574 7572  inimal`` - Retur
-00019860: 6e20 6d69 6e69 6d61 6c20 7072 6f6a 6563  n minimal projec
-00019870: 7420 6f62 6a65 6374 7320 286d 696e 696d  t objects (minim
-00019880: 697a 6174 696f 6e20 6861 7070 656e 7320  ization happens 
-00019890: 696e 2074 6865 2042 4529 2e0a 2020 2020  in the BE)..    
-000198a0: 2020 2020 2020 2020 2d20 6060 6675 6c6c          - ``full
-000198b0: 6060 2020 2d20 5265 7475 726e 2066 756c  ``  - Return ful
-000198c0: 6c20 7072 6f6a 6563 7420 6f62 6a65 6374  l project object
-000198d0: 732e 0a0a 2020 2020 2020 2020 3a70 6172  s...        :par
-000198e0: 616d 206c 6162 656c 733a 2046 696c 7465  am labels: Filte
-000198f0: 7220 6279 206c 6162 656c 7320 6174 7461  r by labels atta
-00019900: 6368 6564 2074 6f20 7468 6520 7072 6f6a  ched to the proj
-00019910: 6563 742e 0a20 2020 2020 2020 203a 7061  ect..        :pa
-00019920: 7261 6d20 7374 6174 653a 2046 696c 7465  ram state: Filte
-00019930: 7220 6279 2070 726f 6a65 6374 2773 2073  r by project's s
-00019940: 7461 7465 2e20 4361 6e20 6265 2065 6974  tate. Can be eit
-00019950: 6865 7220 6060 6f6e 6c69 6e65 6060 206f  her ``online`` o
-00019960: 7220 6060 6172 6368 6976 6564 6060 2e0a  r ``archived``..
-00019970: 2020 2020 2020 2020 2222 220a 0a20 2020          """..   
-00019980: 2020 2020 2070 6172 616d 7320 3d20 7b0a       params = {.
-00019990: 2020 2020 2020 2020 2020 2020 226f 776e              "own
-000199a0: 6572 223a 206f 776e 6572 2c0a 2020 2020  er": owner,.    
-000199b0: 2020 2020 2020 2020 2273 7461 7465 223a          "state":
-000199c0: 2073 7461 7465 2c0a 2020 2020 2020 2020   state,.        
-000199d0: 2020 2020 2266 6f72 6d61 7422 3a20 666f      "format": fo
-000199e0: 726d 6174 5f2c 0a20 2020 2020 2020 2020  rmat_,.         
-000199f0: 2020 2022 6c61 6265 6c22 3a20 6c61 6265     "label": labe
-00019a00: 6c73 206f 7220 5b5d 2c0a 2020 2020 2020  ls or [],.      
-00019a10: 2020 7d0a 0a20 2020 2020 2020 2065 7272    }..        err
-00019a20: 6f72 5f6d 6573 7361 6765 203d 2066 2246  or_message = f"F
-00019a30: 6169 6c65 6420 6c69 7374 696e 6720 7072  ailed listing pr
-00019a40: 6f6a 6563 7473 2c20 7175 6572 793a 207b  ojects, query: {
-00019a50: 7061 7261 6d73 7d22 0a20 2020 2020 2020  params}".       
-00019a60: 2072 6573 706f 6e73 6520 3d20 7365 6c66   response = self
-00019a70: 2e61 7069 5f63 616c 6c28 2247 4554 222c  .api_call("GET",
-00019a80: 2022 7072 6f6a 6563 7473 222c 2065 7272   "projects", err
-00019a90: 6f72 5f6d 6573 7361 6765 2c20 7061 7261  or_message, para
-00019aa0: 6d73 3d70 6172 616d 7329 0a20 2020 2020  ms=params).     
-00019ab0: 2020 2069 6620 666f 726d 6174 5f20 3d3d     if format_ ==
-00019ac0: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
-00019ad0: 6865 6d61 732e 5072 6f6a 6563 7473 466f  hemas.ProjectsFo
-00019ae0: 726d 6174 2e6e 616d 655f 6f6e 6c79 3a0a  rmat.name_only:.
-00019af0: 2020 2020 2020 2020 2020 2020 2320 7072              # pr
-00019b00: 6f6a 6563 7473 2069 7320 6a75 7374 2061  ojects is just a
-00019b10: 206c 6973 7420 6f66 2073 7472 696e 6773   list of strings
-00019b20: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00019b30: 7572 6e20 7265 7370 6f6e 7365 2e6a 736f  urn response.jso
-00019b40: 6e28 295b 2270 726f 6a65 6374 7322 5d0a  n()["projects"].
-00019b50: 0a20 2020 2020 2020 2023 2066 6f72 7761  .        # forwa
-00019b60: 7264 7320 636f 6d70 6174 6962 696c 6974  rds compatibilit
-00019b70: 7920 2d20 7765 2077 616e 7420 746f 2062  y - we want to b
-00019b80: 6520 6162 6c65 2074 6f20 6861 6e64 6c65  e able to handle
-00019b90: 206e 6577 2066 6f72 6d61 7473 2074 6861   new formats tha
-00019ba0: 7420 6d69 6768 7420 6265 2061 6464 6564  t might be added
-00019bb0: 2069 6e20 7468 6520 6675 7475 7265 0a20   in the future. 
-00019bc0: 2020 2020 2020 2023 2069 6620 666f 726d         # if form
-00019bd0: 6174 2069 7320 6e6f 7420 6b6e 6f77 6e20  at is not known 
-00019be0: 746f 2074 6865 2061 7069 2c20 6974 2069  to the api, it i
-00019bf0: 7320 7570 2074 6f20 7468 6520 7365 7276  s up to the serv
-00019c00: 6572 2074 6f20 7265 7475 726e 2065 6974  er to return eit
-00019c10: 6865 7220 616e 2065 7272 6f72 206f 7220  her an error or 
-00019c20: 6120 6465 6661 756c 7420 666f 726d 6174  a default format
-00019c30: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00019c40: 5b0a 2020 2020 2020 2020 2020 2020 6d6c  [.            ml
-00019c50: 7275 6e2e 7072 6f6a 6563 7473 2e4d 6c72  run.projects.Mlr
-00019c60: 756e 5072 6f6a 6563 742e 6672 6f6d 5f64  unProject.from_d
-00019c70: 6963 7428 7072 6f6a 6563 745f 6469 6374  ict(project_dict
-00019c80: 290a 2020 2020 2020 2020 2020 2020 666f  ).            fo
-00019c90: 7220 7072 6f6a 6563 745f 6469 6374 2069  r project_dict i
-00019ca0: 6e20 7265 7370 6f6e 7365 2e6a 736f 6e28  n response.json(
-00019cb0: 295b 2270 726f 6a65 6374 7322 5d0a 2020  )["projects"].  
-00019cc0: 2020 2020 2020 5d0a 0a20 2020 2064 6566        ]..    def
-00019cd0: 2067 6574 5f70 726f 6a65 6374 2873 656c   get_project(sel
-00019ce0: 662c 206e 616d 653a 2073 7472 2920 2d3e  f, name: str) ->
-00019cf0: 206d 6c72 756e 2e70 726f 6a65 6374 732e   mlrun.projects.
-00019d00: 4d6c 7275 6e50 726f 6a65 6374 3a0a 2020  MlrunProject:.  
-00019d10: 2020 2020 2020 2222 2247 6574 2064 6574        """Get det
-00019d20: 6169 6c73 2066 6f72 2061 2073 7065 6369  ails for a speci
-00019d30: 6669 6320 7072 6f6a 6563 742e 2222 220a  fic project.""".
-00019d40: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-00019d50: 6e61 6d65 3a0a 2020 2020 2020 2020 2020  name:.          
-00019d60: 2020 7261 6973 6520 4d4c 5275 6e49 6e76    raise MLRunInv
-00019d70: 616c 6964 4172 6775 6d65 6e74 4572 726f  alidArgumentErro
-00019d80: 7228 224e 616d 6520 6d75 7374 2062 6520  r("Name must be 
-00019d90: 7072 6f76 6964 6564 2229 0a0a 2020 2020  provided")..    
-00019da0: 2020 2020 7061 7468 203d 2066 2270 726f      path = f"pro
-00019db0: 6a65 6374 732f 7b6e 616d 657d 220a 2020  jects/{name}".  
-00019dc0: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
-00019dd0: 6167 6520 3d20 6622 4661 696c 6564 2072  age = f"Failed r
-00019de0: 6574 7269 6576 696e 6720 7072 6f6a 6563  etrieving projec
-00019df0: 7420 7b6e 616d 657d 220a 2020 2020 2020  t {name}".      
-00019e00: 2020 7265 7370 6f6e 7365 203d 2073 656c    response = sel
-00019e10: 662e 6170 695f 6361 6c6c 2822 4745 5422  f.api_call("GET"
-00019e20: 2c20 7061 7468 2c20 6572 726f 725f 6d65  , path, error_me
-00019e30: 7373 6167 6529 0a20 2020 2020 2020 2072  ssage).        r
-00019e40: 6574 7572 6e20 6d6c 7275 6e2e 7072 6f6a  eturn mlrun.proj
-00019e50: 6563 7473 2e4d 6c72 756e 5072 6f6a 6563  ects.MlrunProjec
-00019e60: 742e 6672 6f6d 5f64 6963 7428 7265 7370  t.from_dict(resp
-00019e70: 6f6e 7365 2e6a 736f 6e28 2929 0a0a 2020  onse.json())..  
-00019e80: 2020 6465 6620 6465 6c65 7465 5f70 726f    def delete_pro
-00019e90: 6a65 6374 280a 2020 2020 2020 2020 7365  ject(.        se
-00019ea0: 6c66 2c0a 2020 2020 2020 2020 6e61 6d65  lf,.        name
-00019eb0: 3a20 7374 722c 0a20 2020 2020 2020 2064  : str,.        d
-00019ec0: 656c 6574 696f 6e5f 7374 7261 7465 6779  eletion_strategy
-00019ed0: 3a20 556e 696f 6e5b 0a20 2020 2020 2020  : Union[.       
-00019ee0: 2020 2020 2073 7472 2c20 6d6c 7275 6e2e       str, mlrun.
-00019ef0: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e44  common.schemas.D
-00019f00: 656c 6574 696f 6e53 7472 6174 6567 790a  eletionStrategy.
-00019f10: 2020 2020 2020 2020 5d20 3d20 6d6c 7275          ] = mlru
-00019f20: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
-00019f30: 2e44 656c 6574 696f 6e53 7472 6174 6567  .DeletionStrateg
-00019f40: 792e 6465 6661 756c 7428 292c 0a20 2020  y.default(),.   
-00019f50: 2029 3a0a 2020 2020 2020 2020 2222 2244   ):.        """D
-00019f60: 656c 6574 6520 6120 7072 6f6a 6563 742e  elete a project.
-00019f70: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00019f80: 206e 616d 653a 204e 616d 6520 6f66 2074   name: Name of t
-00019f90: 6865 2070 726f 6a65 6374 2074 6f20 6465  he project to de
-00019fa0: 6c65 7465 2e0a 2020 2020 2020 2020 3a70  lete..        :p
-00019fb0: 6172 616d 2064 656c 6574 696f 6e5f 7374  aram deletion_st
-00019fc0: 7261 7465 6779 3a20 486f 7720 746f 2074  rategy: How to t
-00019fd0: 7265 6174 2072 6573 6f75 7263 6573 2072  reat resources r
-00019fe0: 656c 6174 6564 2074 6f20 7468 6520 7072  elated to the pr
-00019ff0: 6f6a 6563 742e 2050 6f73 7369 626c 6520  oject. Possible 
-0001a000: 7661 6c75 6573 2061 7265 3a0a 0a20 2020  values are:..   
-0001a010: 2020 2020 2020 2020 202d 2060 6072 6573           - ``res
-0001a020: 7472 6963 7460 6020 2864 6566 6175 6c74  trict`` (default
-0001a030: 2920 2d20 5072 6f6a 6563 7420 6d75 7374  ) - Project must
-0001a040: 206e 6f74 2068 6176 6520 616e 7920 7265   not have any re
-0001a050: 6c61 7465 6420 7265 736f 7572 6365 7320  lated resources 
-0001a060: 7768 656e 2064 656c 6574 6564 2e20 4966  when deleted. If
-0001a070: 2075 7369 6e67 0a20 2020 2020 2020 2020   using.         
-0001a080: 2020 2020 2074 6869 7320 6d6f 6465 2077       this mode w
-0001a090: 6869 6c65 2072 656c 6174 6564 2072 6573  hile related res
-0001a0a0: 6f75 7263 6573 2065 7869 7374 2c20 7468  ources exist, th
-0001a0b0: 6520 6f70 6572 6174 696f 6e20 7769 6c6c  e operation will
-0001a0c0: 2066 6169 6c2e 0a20 2020 2020 2020 2020   fail..         
-0001a0d0: 2020 202d 2060 6063 6173 6361 6465 6060     - ``cascade``
-0001a0e0: 202d 2041 7574 6f6d 6174 6963 616c 6c79   - Automatically
-0001a0f0: 2064 656c 6574 6520 616c 6c20 7265 6c61   delete all rela
-0001a100: 7465 6420 7265 736f 7572 6365 7320 7768  ted resources wh
-0001a110: 656e 2064 656c 6574 696e 6720 7468 6520  en deleting the 
-0001a120: 7072 6f6a 6563 742e 0a20 2020 2020 2020  project..       
-0001a130: 2022 2222 0a0a 2020 2020 2020 2020 6865   """..        he
-0001a140: 6164 6572 7320 3d20 7b0a 2020 2020 2020  aders = {.      
-0001a150: 2020 2020 2020 6d6c 7275 6e2e 636f 6d6d        mlrun.comm
-0001a160: 6f6e 2e73 6368 656d 6173 2e48 6561 6465  on.schemas.Heade
-0001a170: 724e 616d 6573 2e64 656c 6574 696f 6e5f  rNames.deletion_
-0001a180: 7374 7261 7465 6779 3a20 6465 6c65 7469  strategy: deleti
-0001a190: 6f6e 5f73 7472 6174 6567 790a 2020 2020  on_strategy.    
-0001a1a0: 2020 2020 7d0a 2020 2020 2020 2020 6572      }.        er
-0001a1b0: 726f 725f 6d65 7373 6167 6520 3d20 6622  ror_message = f"
-0001a1c0: 4661 696c 6564 2064 656c 6574 696e 6720  Failed deleting 
-0001a1d0: 7072 6f6a 6563 7420 7b6e 616d 657d 220a  project {name}".
-0001a1e0: 2020 2020 2020 2020 7265 7370 6f6e 7365          response
-0001a1f0: 203d 2073 656c 662e 6170 695f 6361 6c6c   = self.api_call
-0001a200: 280a 2020 2020 2020 2020 2020 2020 2244  (.            "D
-0001a210: 454c 4554 4522 2c20 6622 7072 6f6a 6563  ELETE", f"projec
-0001a220: 7473 2f7b 6e61 6d65 7d22 2c20 6572 726f  ts/{name}", erro
-0001a230: 725f 6d65 7373 6167 652c 2068 6561 6465  r_message, heade
-0001a240: 7273 3d68 6561 6465 7273 2c20 7665 7273  rs=headers, vers
-0001a250: 696f 6e3d 2276 3222 0a20 2020 2020 2020  ion="v2".       
-0001a260: 2029 0a20 2020 2020 2020 2069 6620 7265   ).        if re
-0001a270: 7370 6f6e 7365 2e73 7461 7475 735f 636f  sponse.status_co
-0001a280: 6465 203d 3d20 6874 7470 2e48 5454 5053  de == http.HTTPS
-0001a290: 7461 7475 732e 4143 4345 5054 4544 3a0a  tatus.ACCEPTED:.
-0001a2a0: 2020 2020 2020 2020 2020 2020 6c6f 6767              logg
-0001a2b0: 6572 2e69 6e66 6f28 2250 726f 6a65 6374  er.info("Project
-0001a2c0: 2069 7320 6265 696e 6720 6465 6c65 7465   is being delete
-0001a2d0: 6422 2c20 7072 6f6a 6563 745f 6e61 6d65  d", project_name
-0001a2e0: 3d6e 616d 6529 0a20 2020 2020 2020 2020  =name).         
-0001a2f0: 2020 2062 6163 6b67 726f 756e 645f 7461     background_ta
-0001a300: 736b 203d 206d 6c72 756e 2e63 6f6d 6d6f  sk = mlrun.commo
-0001a310: 6e2e 7363 6865 6d61 732e 4261 636b 6772  n.schemas.Backgr
-0001a320: 6f75 6e64 5461 736b 282a 2a72 6573 706f  oundTask(**respo
-0001a330: 6e73 652e 6a73 6f6e 2829 290a 2020 2020  nse.json()).    
-0001a340: 2020 2020 2020 2020 6261 636b 6772 6f75          backgrou
-0001a350: 6e64 5f74 6173 6b20 3d20 7365 6c66 2e5f  nd_task = self._
-0001a360: 7761 6974 5f66 6f72 5f62 6163 6b67 726f  wait_for_backgro
-0001a370: 756e 645f 7461 736b 5f74 6f5f 7265 6163  und_task_to_reac
-0001a380: 685f 7465 726d 696e 616c 5f73 7461 7465  h_terminal_state
-0001a390: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0001a3a0: 2020 6261 636b 6772 6f75 6e64 5f74 6173    background_tas
-0001a3b0: 6b2e 6d65 7461 6461 7461 2e6e 616d 650a  k.metadata.name.
-0001a3c0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0001a3d0: 2020 2020 2020 2020 2020 6966 2028 0a20            if (. 
-0001a3e0: 2020 2020 2020 2020 2020 2020 2020 2062                 b
-0001a3f0: 6163 6b67 726f 756e 645f 7461 736b 2e73  ackground_task.s
-0001a400: 7461 7475 732e 7374 6174 650a 2020 2020  tatus.state.    
-0001a410: 2020 2020 2020 2020 2020 2020 3d3d 206d              == m
-0001a420: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
-0001a430: 6d61 732e 4261 636b 6772 6f75 6e64 5461  mas.BackgroundTa
-0001a440: 736b 5374 6174 652e 7375 6363 6565 6465  skState.succeede
-0001a450: 640a 2020 2020 2020 2020 2020 2020 293a  d.            ):
-0001a460: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001a470: 206c 6f67 6765 722e 696e 666f 2822 5072   logger.info("Pr
-0001a480: 6f6a 6563 7420 6465 6c65 7465 6422 2c20  oject deleted", 
-0001a490: 7072 6f6a 6563 745f 6e61 6d65 3d6e 616d  project_name=nam
-0001a4a0: 6529 0a20 2020 2020 2020 2020 2020 2020  e).             
-0001a4b0: 2020 2072 6574 7572 6e0a 2020 2020 2020     return.      
-0001a4c0: 2020 656c 6966 2072 6573 706f 6e73 652e    elif response.
-0001a4d0: 7374 6174 7573 5f63 6f64 6520 3d3d 2068  status_code == h
-0001a4e0: 7474 702e 4854 5450 5374 6174 7573 2e4e  ttp.HTTPStatus.N
-0001a4f0: 4f5f 434f 4e54 454e 543a 0a20 2020 2020  O_CONTENT:.     
-0001a500: 2020 2020 2020 206c 6f67 6765 722e 696e         logger.in
-0001a510: 666f 2822 5072 6f6a 6563 7420 6465 6c65  fo("Project dele
-0001a520: 7465 6422 2c20 7072 6f6a 6563 745f 6e61  ted", project_na
-0001a530: 6d65 3d6e 616d 6529 0a20 2020 2020 2020  me=name).       
-0001a540: 2020 2020 2072 6574 7572 6e0a 0a20 2020       return..   
-0001a550: 2064 6566 2073 746f 7265 5f70 726f 6a65   def store_proje
-0001a560: 6374 280a 2020 2020 2020 2020 7365 6c66  ct(.        self
-0001a570: 2c0a 2020 2020 2020 2020 6e61 6d65 3a20  ,.        name: 
-0001a580: 7374 722c 0a20 2020 2020 2020 2070 726f  str,.        pro
-0001a590: 6a65 6374 3a20 556e 696f 6e5b 6469 6374  ject: Union[dict
-0001a5a0: 2c20 6d6c 7275 6e2e 7072 6f6a 6563 7473  , mlrun.projects
-0001a5b0: 2e4d 6c72 756e 5072 6f6a 6563 742c 206d  .MlrunProject, m
-0001a5c0: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
-0001a5d0: 6d61 732e 5072 6f6a 6563 745d 2c0a 2020  mas.Project],.  
-0001a5e0: 2020 2920 2d3e 206d 6c72 756e 2e70 726f    ) -> mlrun.pro
-0001a5f0: 6a65 6374 732e 4d6c 7275 6e50 726f 6a65  jects.MlrunProje
-0001a600: 6374 3a0a 2020 2020 2020 2020 2222 2253  ct:.        """S
-0001a610: 746f 7265 2061 2070 726f 6a65 6374 2069  tore a project i
-0001a620: 6e20 7468 6520 4442 2e20 5468 6973 206f  n the DB. This o
-0001a630: 7065 7261 7469 6f6e 2077 696c 6c20 6f76  peration will ov
-0001a640: 6572 7772 6974 6520 6578 6973 7469 6e67  erwrite existing
-0001a650: 2070 726f 6a65 6374 206f 6620 7468 6520   project of the 
-0001a660: 7361 6d65 206e 616d 6520 6966 2065 7869  same name if exi
-0001a670: 7374 732e 2222 220a 0a20 2020 2020 2020  sts."""..       
-0001a680: 2070 6174 6820 3d20 6622 7072 6f6a 6563   path = f"projec
-0001a690: 7473 2f7b 6e61 6d65 7d22 0a20 2020 2020  ts/{name}".     
-0001a6a0: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
-0001a6b0: 203d 2066 2246 6169 6c65 6420 7374 6f72   = f"Failed stor
-0001a6c0: 696e 6720 7072 6f6a 6563 7420 7b6e 616d  ing project {nam
-0001a6d0: 657d 220a 2020 2020 2020 2020 6966 2069  e}".        if i
-0001a6e0: 7369 6e73 7461 6e63 6528 7072 6f6a 6563  sinstance(projec
-0001a6f0: 742c 206d 6c72 756e 2e63 6f6d 6d6f 6e2e  t, mlrun.common.
-0001a700: 7363 6865 6d61 732e 5072 6f6a 6563 7429  schemas.Project)
-0001a710: 3a0a 2020 2020 2020 2020 2020 2020 7072  :.            pr
-0001a720: 6f6a 6563 7420 3d20 7072 6f6a 6563 742e  oject = project.
-0001a730: 6469 6374 2829 0a20 2020 2020 2020 2065  dict().        e
-0001a740: 6c69 6620 6973 696e 7374 616e 6365 2870  lif isinstance(p
-0001a750: 726f 6a65 6374 2c20 6d6c 7275 6e2e 7072  roject, mlrun.pr
-0001a760: 6f6a 6563 7473 2e4d 6c72 756e 5072 6f6a  ojects.MlrunProj
-0001a770: 6563 7429 3a0a 2020 2020 2020 2020 2020  ect):.          
-0001a780: 2020 7072 6f6a 6563 7420 3d20 7072 6f6a    project = proj
-0001a790: 6563 742e 746f 5f64 6963 7428 290a 2020  ect.to_dict().  
-0001a7a0: 2020 2020 2020 7265 7370 6f6e 7365 203d        response =
-0001a7b0: 2073 656c 662e 6170 695f 6361 6c6c 280a   self.api_call(.
-0001a7c0: 2020 2020 2020 2020 2020 2020 2250 5554              "PUT
-0001a7d0: 222c 0a20 2020 2020 2020 2020 2020 2070  ",.            p
-0001a7e0: 6174 682c 0a20 2020 2020 2020 2020 2020  ath,.           
-0001a7f0: 2065 7272 6f72 5f6d 6573 7361 6765 2c0a   error_message,.
-0001a800: 2020 2020 2020 2020 2020 2020 626f 6479              body
-0001a810: 3d64 6963 745f 746f 5f6a 736f 6e28 7072  =dict_to_json(pr
-0001a820: 6f6a 6563 7429 2c0a 2020 2020 2020 2020  oject),.        
-0001a830: 290a 2020 2020 2020 2020 6966 2072 6573  ).        if res
-0001a840: 706f 6e73 652e 7374 6174 7573 5f63 6f64  ponse.status_cod
-0001a850: 6520 3d3d 2068 7474 702e 4854 5450 5374  e == http.HTTPSt
-0001a860: 6174 7573 2e41 4343 4550 5445 443a 0a20  atus.ACCEPTED:. 
-0001a870: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0001a880: 6e20 7365 6c66 2e5f 7761 6974 5f66 6f72  n self._wait_for
-0001a890: 5f70 726f 6a65 6374 5f74 6f5f 7265 6163  _project_to_reac
-0001a8a0: 685f 7465 726d 696e 616c 5f73 7461 7465  h_terminal_state
-0001a8b0: 286e 616d 6529 0a20 2020 2020 2020 2072  (name).        r
-0001a8c0: 6574 7572 6e20 6d6c 7275 6e2e 7072 6f6a  eturn mlrun.proj
-0001a8d0: 6563 7473 2e4d 6c72 756e 5072 6f6a 6563  ects.MlrunProjec
-0001a8e0: 742e 6672 6f6d 5f64 6963 7428 7265 7370  t.from_dict(resp
-0001a8f0: 6f6e 7365 2e6a 736f 6e28 2929 0a0a 2020  onse.json())..  
-0001a900: 2020 6465 6620 7061 7463 685f 7072 6f6a    def patch_proj
-0001a910: 6563 7428 0a20 2020 2020 2020 2073 656c  ect(.        sel
-0001a920: 662c 0a20 2020 2020 2020 206e 616d 653a  f,.        name:
-0001a930: 2073 7472 2c0a 2020 2020 2020 2020 7072   str,.        pr
-0001a940: 6f6a 6563 743a 2064 6963 742c 0a20 2020  oject: dict,.   
-0001a950: 2020 2020 2070 6174 6368 5f6d 6f64 653a       patch_mode:
-0001a960: 2055 6e69 6f6e 5b0a 2020 2020 2020 2020   Union[.        
-0001a970: 2020 2020 7374 722c 206d 6c72 756e 2e63      str, mlrun.c
-0001a980: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 5061  ommon.schemas.Pa
-0001a990: 7463 684d 6f64 650a 2020 2020 2020 2020  tchMode.        
-0001a9a0: 5d20 3d20 6d6c 7275 6e2e 636f 6d6d 6f6e  ] = mlrun.common
-0001a9b0: 2e73 6368 656d 6173 2e50 6174 6368 4d6f  .schemas.PatchMo
-0001a9c0: 6465 2e72 6570 6c61 6365 2c0a 2020 2020  de.replace,.    
-0001a9d0: 2920 2d3e 206d 6c72 756e 2e70 726f 6a65  ) -> mlrun.proje
-0001a9e0: 6374 732e 4d6c 7275 6e50 726f 6a65 6374  cts.MlrunProject
-0001a9f0: 3a0a 2020 2020 2020 2020 2222 2250 6174  :.        """Pat
-0001aa00: 6368 2061 6e20 6578 6973 7469 6e67 2070  ch an existing p
-0001aa10: 726f 6a65 6374 206f 626a 6563 742e 0a0a  roject object...
-0001aa20: 2020 2020 2020 2020 3a70 6172 616d 206e          :param n
-0001aa30: 616d 653a 204e 616d 6520 6f66 2070 726f  ame: Name of pro
-0001aa40: 6a65 6374 2074 6f20 7061 7463 682e 0a20  ject to patch.. 
-0001aa50: 2020 2020 2020 203a 7061 7261 6d20 7072         :param pr
-0001aa60: 6f6a 6563 743a 2054 6865 2061 6374 7561  oject: The actua
-0001aa70: 6c20 6368 616e 6765 7320 746f 2074 6865  l changes to the
-0001aa80: 2070 726f 6a65 6374 206f 626a 6563 742e   project object.
-0001aa90: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0001aaa0: 7061 7463 685f 6d6f 6465 3a20 5468 6520  patch_mode: The 
-0001aab0: 7374 7261 7465 6779 2066 6f72 206d 6572  strategy for mer
-0001aac0: 6769 6e67 2074 6865 2063 6861 6e67 6573  ging the changes
-0001aad0: 2077 6974 6820 7468 6520 6578 6973 7469   with the existi
-0001aae0: 6e67 206f 626a 6563 742e 2043 616e 2062  ng object. Can b
-0001aaf0: 6520 6569 7468 6572 2060 6072 6570 6c61  e either ``repla
-0001ab00: 6365 6060 0a20 2020 2020 2020 2020 2020  ce``.           
-0001ab10: 206f 7220 6060 6164 6469 7469 7665 6060   or ``additive``
-0001ab20: 2e0a 2020 2020 2020 2020 2222 220a 0a20  ..        """.. 
-0001ab30: 2020 2020 2020 2070 6174 6820 3d20 6622         path = f"
-0001ab40: 7072 6f6a 6563 7473 2f7b 6e61 6d65 7d22  projects/{name}"
-0001ab50: 0a20 2020 2020 2020 2068 6561 6465 7273  .        headers
-0001ab60: 203d 207b 6d6c 7275 6e2e 636f 6d6d 6f6e   = {mlrun.common
-0001ab70: 2e73 6368 656d 6173 2e48 6561 6465 724e  .schemas.HeaderN
-0001ab80: 616d 6573 2e70 6174 6368 5f6d 6f64 653a  ames.patch_mode:
-0001ab90: 2070 6174 6368 5f6d 6f64 657d 0a20 2020   patch_mode}.   
-0001aba0: 2020 2020 2065 7272 6f72 5f6d 6573 7361       error_messa
-0001abb0: 6765 203d 2066 2246 6169 6c65 6420 7061  ge = f"Failed pa
-0001abc0: 7463 6869 6e67 2070 726f 6a65 6374 207b  tching project {
-0001abd0: 6e61 6d65 7d22 0a20 2020 2020 2020 2072  name}".        r
-0001abe0: 6573 706f 6e73 6520 3d20 7365 6c66 2e61  esponse = self.a
-0001abf0: 7069 5f63 616c 6c28 0a20 2020 2020 2020  pi_call(.       
-0001ac00: 2020 2020 2022 5041 5443 4822 2c20 7061       "PATCH", pa
-0001ac10: 7468 2c20 6572 726f 725f 6d65 7373 6167  th, error_messag
-0001ac20: 652c 2062 6f64 793d 6469 6374 5f74 6f5f  e, body=dict_to_
-0001ac30: 6a73 6f6e 2870 726f 6a65 6374 292c 2068  json(project), h
-0001ac40: 6561 6465 7273 3d68 6561 6465 7273 0a20  eaders=headers. 
-0001ac50: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0001ac60: 2072 6574 7572 6e20 6d6c 7275 6e2e 7072   return mlrun.pr
-0001ac70: 6f6a 6563 7473 2e4d 6c72 756e 5072 6f6a  ojects.MlrunProj
-0001ac80: 6563 742e 6672 6f6d 5f64 6963 7428 7265  ect.from_dict(re
-0001ac90: 7370 6f6e 7365 2e6a 736f 6e28 2929 0a0a  sponse.json())..
-0001aca0: 2020 2020 6465 6620 6372 6561 7465 5f70      def create_p
-0001acb0: 726f 6a65 6374 280a 2020 2020 2020 2020  roject(.        
-0001acc0: 7365 6c66 2c0a 2020 2020 2020 2020 7072  self,.        pr
-0001acd0: 6f6a 6563 743a 2055 6e69 6f6e 5b64 6963  oject: Union[dic
-0001ace0: 742c 206d 6c72 756e 2e70 726f 6a65 6374  t, mlrun.project
-0001acf0: 732e 4d6c 7275 6e50 726f 6a65 6374 2c20  s.MlrunProject, 
-0001ad00: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-0001ad10: 656d 6173 2e50 726f 6a65 6374 5d2c 0a20  emas.Project],. 
-0001ad20: 2020 2029 202d 3e20 6d6c 7275 6e2e 7072     ) -> mlrun.pr
-0001ad30: 6f6a 6563 7473 2e4d 6c72 756e 5072 6f6a  ojects.MlrunProj
-0001ad40: 6563 743a 0a20 2020 2020 2020 2022 2222  ect:.        """
-0001ad50: 4372 6561 7465 2061 206e 6577 2070 726f  Create a new pro
-0001ad60: 6a65 6374 2e20 4120 7072 6f6a 6563 7420  ject. A project 
-0001ad70: 7769 7468 2074 6865 2073 616d 6520 6e61  with the same na
-0001ad80: 6d65 206d 7573 7420 6e6f 7420 6578 6973  me must not exis
-0001ad90: 7420 7072 696f 7220 746f 2063 7265 6174  t prior to creat
-0001ada0: 696f 6e2e 2222 220a 0a20 2020 2020 2020  ion."""..       
-0001adb0: 2069 6620 6973 696e 7374 616e 6365 2870   if isinstance(p
-0001adc0: 726f 6a65 6374 2c20 6d6c 7275 6e2e 636f  roject, mlrun.co
-0001add0: 6d6d 6f6e 2e73 6368 656d 6173 2e50 726f  mmon.schemas.Pro
-0001ade0: 6a65 6374 293a 0a20 2020 2020 2020 2020  ject):.         
-0001adf0: 2020 2070 726f 6a65 6374 203d 2070 726f     project = pro
-0001ae00: 6a65 6374 2e64 6963 7428 290a 2020 2020  ject.dict().    
-0001ae10: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
-0001ae20: 6e63 6528 7072 6f6a 6563 742c 206d 6c72  nce(project, mlr
-0001ae30: 756e 2e70 726f 6a65 6374 732e 4d6c 7275  un.projects.Mlru
-0001ae40: 6e50 726f 6a65 6374 293a 0a20 2020 2020  nProject):.     
-0001ae50: 2020 2020 2020 2070 726f 6a65 6374 203d         project =
-0001ae60: 2070 726f 6a65 6374 2e74 6f5f 6469 6374   project.to_dict
-0001ae70: 2829 0a20 2020 2020 2020 2070 726f 6a65  ().        proje
-0001ae80: 6374 5f6e 616d 6520 3d20 7072 6f6a 6563  ct_name = projec
-0001ae90: 745b 226d 6574 6164 6174 6122 5d5b 226e  t["metadata"]["n
-0001aea0: 616d 6522 5d0a 2020 2020 2020 2020 6572  ame"].        er
-0001aeb0: 726f 725f 6d65 7373 6167 6520 3d20 6622  ror_message = f"
-0001aec0: 4661 696c 6564 2063 7265 6174 696e 6720  Failed creating 
-0001aed0: 7072 6f6a 6563 7420 7b70 726f 6a65 6374  project {project
-0001aee0: 5f6e 616d 657d 220a 2020 2020 2020 2020  _name}".        
-0001aef0: 7265 7370 6f6e 7365 203d 2073 656c 662e  response = self.
-0001af00: 6170 695f 6361 6c6c 280a 2020 2020 2020  api_call(.      
-0001af10: 2020 2020 2020 2250 4f53 5422 2c0a 2020        "POST",.  
-0001af20: 2020 2020 2020 2020 2020 2320 646f 206e            # do n
-0001af30: 6f74 2077 6169 7420 666f 7220 7072 6f6a  ot wait for proj
-0001af40: 6563 7420 746f 2072 6561 6368 2074 6572  ect to reach ter
-0001af50: 6d69 6e61 6c20 7374 6174 6520 7379 6e63  minal state sync
-0001af60: 6872 6f6e 6f75 736c 792e 0a20 2020 2020  hronously..     
-0001af70: 2020 2020 2020 2023 206c 6574 2069 7420         # let it 
-0001af80: 7374 6172 7420 616e 6420 7761 6974 2066  start and wait f
-0001af90: 6f72 2069 7420 746f 2072 6561 6368 2074  or it to reach t
-0001afa0: 6572 6d69 6e61 6c20 7374 6174 6520 6173  erminal state as
-0001afb0: 796e 6368 726f 6e6f 7573 6c79 0a20 2020  ynchronously.   
-0001afc0: 2020 2020 2020 2020 2022 7072 6f6a 6563           "projec
-0001afd0: 7473 3f77 6169 742d 666f 722d 636f 6d70  ts?wait-for-comp
-0001afe0: 6c65 7469 6f6e 3d66 616c 7365 222c 0a20  letion=false",. 
-0001aff0: 2020 2020 2020 2020 2020 2065 7272 6f72             error
-0001b000: 5f6d 6573 7361 6765 2c0a 2020 2020 2020  _message,.      
-0001b010: 2020 2020 2020 626f 6479 3d64 6963 745f        body=dict_
-0001b020: 746f 5f6a 736f 6e28 7072 6f6a 6563 7429  to_json(project)
-0001b030: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-0001b040: 2020 2020 6966 2072 6573 706f 6e73 652e      if response.
-0001b050: 7374 6174 7573 5f63 6f64 6520 3d3d 2068  status_code == h
-0001b060: 7474 702e 4854 5450 5374 6174 7573 2e41  ttp.HTTPStatus.A
-0001b070: 4343 4550 5445 443a 0a20 2020 2020 2020  CCEPTED:.       
-0001b080: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0001b090: 2e5f 7761 6974 5f66 6f72 5f70 726f 6a65  ._wait_for_proje
-0001b0a0: 6374 5f74 6f5f 7265 6163 685f 7465 726d  ct_to_reach_term
-0001b0b0: 696e 616c 5f73 7461 7465 2870 726f 6a65  inal_state(proje
-0001b0c0: 6374 5f6e 616d 6529 0a20 2020 2020 2020  ct_name).       
-0001b0d0: 2072 6574 7572 6e20 6d6c 7275 6e2e 7072   return mlrun.pr
-0001b0e0: 6f6a 6563 7473 2e4d 6c72 756e 5072 6f6a  ojects.MlrunProj
-0001b0f0: 6563 742e 6672 6f6d 5f64 6963 7428 7265  ect.from_dict(re
-0001b100: 7370 6f6e 7365 2e6a 736f 6e28 2929 0a0a  sponse.json())..
-0001b110: 2020 2020 6465 6620 5f77 6169 745f 666f      def _wait_fo
-0001b120: 725f 7072 6f6a 6563 745f 746f 5f72 6561  r_project_to_rea
-0001b130: 6368 5f74 6572 6d69 6e61 6c5f 7374 6174  ch_terminal_stat
-0001b140: 6528 0a20 2020 2020 2020 2073 656c 662c  e(.        self,
-0001b150: 2070 726f 6a65 6374 5f6e 616d 653a 2073   project_name: s
-0001b160: 7472 0a20 2020 2029 202d 3e20 6d6c 7275  tr.    ) -> mlru
-0001b170: 6e2e 7072 6f6a 6563 7473 2e4d 6c72 756e  n.projects.Mlrun
-0001b180: 5072 6f6a 6563 743a 0a20 2020 2020 2020  Project:.       
-0001b190: 2064 6566 205f 7665 7269 6679 5f70 726f   def _verify_pro
-0001b1a0: 6a65 6374 5f69 6e5f 7465 726d 696e 616c  ject_in_terminal
-0001b1b0: 5f73 7461 7465 2829 3a0a 2020 2020 2020  _state():.      
-0001b1c0: 2020 2020 2020 7072 6f6a 6563 7420 3d20        project = 
-0001b1d0: 7365 6c66 2e67 6574 5f70 726f 6a65 6374  self.get_project
-0001b1e0: 2870 726f 6a65 6374 5f6e 616d 6529 0a20  (project_name). 
-0001b1f0: 2020 2020 2020 2020 2020 2069 6620 280a             if (.
-0001b200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b210: 7072 6f6a 6563 742e 7374 6174 7573 2e73  project.status.s
-0001b220: 7461 7465 0a20 2020 2020 2020 2020 2020  tate.           
-0001b230: 2020 2020 206e 6f74 2069 6e20 6d6c 7275       not in mlru
-0001b240: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
-0001b250: 2e50 726f 6a65 6374 5374 6174 652e 7465  .ProjectState.te
-0001b260: 726d 696e 616c 5f73 7461 7465 7328 290a  rminal_states().
-0001b270: 2020 2020 2020 2020 2020 2020 293a 0a20              ):. 
-0001b280: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0001b290: 6169 7365 2045 7863 6570 7469 6f6e 280a  aise Exception(.
-0001b2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b2b0: 2020 2020 6622 5072 6f6a 6563 7420 6e6f      f"Project no
-0001b2c0: 7420 696e 2074 6572 6d69 6e61 6c20 7374  t in terminal st
-0001b2d0: 6174 652e 2053 7461 7465 3a20 7b70 726f  ate. State: {pro
-0001b2e0: 6a65 6374 2e73 7461 7475 732e 7374 6174  ject.status.stat
-0001b2f0: 657d 220a 2020 2020 2020 2020 2020 2020  e}".            
-0001b300: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-0001b310: 2020 7265 7475 726e 2070 726f 6a65 6374    return project
-0001b320: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-0001b330: 206d 6c72 756e 2e75 7469 6c73 2e68 656c   mlrun.utils.hel
-0001b340: 7065 7273 2e72 6574 7279 5f75 6e74 696c  pers.retry_until
-0001b350: 5f73 7563 6365 7373 6675 6c28 0a20 2020  _successful(.   
-0001b360: 2020 2020 2020 2020 2073 656c 662e 5f77           self._w
-0001b370: 6169 745f 666f 725f 7072 6f6a 6563 745f  ait_for_project_
-0001b380: 7465 726d 696e 616c 5f73 7461 7465 5f72  terminal_state_r
-0001b390: 6574 7279 5f69 6e74 6572 7661 6c2c 0a20  etry_interval,. 
-0001b3a0: 2020 2020 2020 2020 2020 2031 3830 2c0a             180,.
-0001b3b0: 2020 2020 2020 2020 2020 2020 6c6f 6767              logg
-0001b3c0: 6572 2c0a 2020 2020 2020 2020 2020 2020  er,.            
-0001b3d0: 4661 6c73 652c 0a20 2020 2020 2020 2020  False,.         
-0001b3e0: 2020 205f 7665 7269 6679 5f70 726f 6a65     _verify_proje
-0001b3f0: 6374 5f69 6e5f 7465 726d 696e 616c 5f73  ct_in_terminal_s
-0001b400: 7461 7465 2c0a 2020 2020 2020 2020 290a  tate,.        ).
-0001b410: 0a20 2020 2064 6566 205f 7761 6974 5f66  .    def _wait_f
-0001b420: 6f72 5f62 6163 6b67 726f 756e 645f 7461  or_background_ta
-0001b430: 736b 5f74 6f5f 7265 6163 685f 7465 726d  sk_to_reach_term
-0001b440: 696e 616c 5f73 7461 7465 280a 2020 2020  inal_state(.    
-0001b450: 2020 2020 7365 6c66 2c20 6e61 6d65 3a20      self, name: 
-0001b460: 7374 722c 2070 726f 6a65 6374 3a20 7374  str, project: st
-0001b470: 7220 3d20 2222 0a20 2020 2029 202d 3e20  r = "".    ) -> 
-0001b480: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-0001b490: 656d 6173 2e42 6163 6b67 726f 756e 6454  emas.BackgroundT
-0001b4a0: 6173 6b3a 0a20 2020 2020 2020 2064 6566  ask:.        def
-0001b4b0: 205f 7665 7269 6679 5f62 6163 6b67 726f   _verify_backgro
-0001b4c0: 756e 645f 7461 736b 5f69 6e5f 7465 726d  und_task_in_term
-0001b4d0: 696e 616c 5f73 7461 7465 2829 3a0a 2020  inal_state():.  
-0001b4e0: 2020 2020 2020 2020 2020 6966 2070 726f            if pro
-0001b4f0: 6a65 6374 3a0a 2020 2020 2020 2020 2020  ject:.          
-0001b500: 2020 2020 2020 6261 636b 6772 6f75 6e64        background
-0001b510: 5f74 6173 6b20 3d20 7365 6c66 2e67 6574  _task = self.get
-0001b520: 5f70 726f 6a65 6374 5f62 6163 6b67 726f  _project_backgro
-0001b530: 756e 645f 7461 736b 2870 726f 6a65 6374  und_task(project
-0001b540: 2c20 6e61 6d65 290a 2020 2020 2020 2020  , name).        
-0001b550: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0001b560: 2020 2020 2020 2020 2020 6261 636b 6772            backgr
-0001b570: 6f75 6e64 5f74 6173 6b20 3d20 7365 6c66  ound_task = self
-0001b580: 2e67 6574 5f62 6163 6b67 726f 756e 645f  .get_background_
-0001b590: 7461 736b 286e 616d 6529 0a20 2020 2020  task(name).     
-0001b5a0: 2020 2020 2020 2073 7461 7465 203d 2062         state = b
-0001b5b0: 6163 6b67 726f 756e 645f 7461 736b 2e73  ackground_task.s
-0001b5c0: 7461 7475 732e 7374 6174 650a 2020 2020  tatus.state.    
-0001b5d0: 2020 2020 2020 2020 6966 2073 7461 7465          if state
-0001b5e0: 206e 6f74 2069 6e20 6d6c 7275 6e2e 636f   not in mlrun.co
-0001b5f0: 6d6d 6f6e 2e73 6368 656d 6173 2e42 6163  mmon.schemas.Bac
-0001b600: 6b67 726f 756e 6454 6173 6b53 7461 7465  kgroundTaskState
-0001b610: 2e74 6572 6d69 6e61 6c5f 7374 6174 6573  .terminal_states
-0001b620: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
-0001b630: 2020 2020 7261 6973 6520 4578 6365 7074      raise Except
-0001b640: 696f 6e28 0a20 2020 2020 2020 2020 2020  ion(.           
-0001b650: 2020 2020 2020 2020 2066 2242 6163 6b67           f"Backg
-0001b660: 726f 756e 6420 7461 736b 206e 6f74 2069  round task not i
-0001b670: 6e20 7465 726d 696e 616c 2073 7461 7465  n terminal state
-0001b680: 2e20 6e61 6d65 3d7b 6e61 6d65 7d2c 2073  . name={name}, s
-0001b690: 7461 7465 3d7b 7374 6174 657d 220a 2020  tate={state}".  
-0001b6a0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-0001b6b0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0001b6c0: 726e 2062 6163 6b67 726f 756e 645f 7461  rn background_ta
-0001b6d0: 736b 0a0a 2020 2020 2020 2020 7265 7475  sk..        retu
-0001b6e0: 726e 206d 6c72 756e 2e75 7469 6c73 2e68  rn mlrun.utils.h
-0001b6f0: 656c 7065 7273 2e72 6574 7279 5f75 6e74  elpers.retry_unt
-0001b700: 696c 5f73 7563 6365 7373 6675 6c28 0a20  il_successful(. 
-0001b710: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0001b720: 5f77 6169 745f 666f 725f 6261 636b 6772  _wait_for_backgr
-0001b730: 6f75 6e64 5f74 6173 6b5f 7465 726d 696e  ound_task_termin
-0001b740: 616c 5f73 7461 7465 5f72 6574 7279 5f69  al_state_retry_i
-0001b750: 6e74 6572 7661 6c2c 0a20 2020 2020 2020  nterval,.       
-0001b760: 2020 2020 2036 3020 2a20 3630 2c0a 2020       60 * 60,.  
-0001b770: 2020 2020 2020 2020 2020 6c6f 6767 6572            logger
-0001b780: 2c0a 2020 2020 2020 2020 2020 2020 4661  ,.            Fa
-0001b790: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
-0001b7a0: 205f 7665 7269 6679 5f62 6163 6b67 726f   _verify_backgro
-0001b7b0: 756e 645f 7461 736b 5f69 6e5f 7465 726d  und_task_in_term
-0001b7c0: 696e 616c 5f73 7461 7465 2c0a 2020 2020  inal_state,.    
-0001b7d0: 2020 2020 290a 0a20 2020 2064 6566 2063      )..    def c
-0001b7e0: 7265 6174 655f 7072 6f6a 6563 745f 7365  reate_project_se
-0001b7f0: 6372 6574 7328 0a20 2020 2020 2020 2073  crets(.        s
-0001b800: 656c 662c 0a20 2020 2020 2020 2070 726f  elf,.        pro
-0001b810: 6a65 6374 3a20 7374 722c 0a20 2020 2020  ject: str,.     
-0001b820: 2020 2070 726f 7669 6465 723a 2055 6e69     provider: Uni
-0001b830: 6f6e 5b0a 2020 2020 2020 2020 2020 2020  on[.            
-0001b840: 7374 722c 206d 6c72 756e 2e63 6f6d 6d6f  str, mlrun.commo
-0001b850: 6e2e 7363 6865 6d61 732e 5365 6372 6574  n.schemas.Secret
-0001b860: 5072 6f76 6964 6572 4e61 6d65 0a20 2020  ProviderName.   
-0001b870: 2020 2020 205d 203d 206d 6c72 756e 2e63       ] = mlrun.c
-0001b880: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 5365  ommon.schemas.Se
-0001b890: 6372 6574 5072 6f76 6964 6572 4e61 6d65  cretProviderName
-0001b8a0: 2e6b 7562 6572 6e65 7465 732c 0a20 2020  .kubernetes,.   
-0001b8b0: 2020 2020 2073 6563 7265 7473 3a20 6469       secrets: di
-0001b8c0: 6374 203d 204e 6f6e 652c 0a20 2020 2029  ct = None,.    )
-0001b8d0: 3a0a 2020 2020 2020 2020 2222 2243 7265  :.        """Cre
-0001b8e0: 6174 6520 7072 6f6a 6563 742d 636f 6e74  ate project-cont
-0001b8f0: 6578 7420 7365 6372 6574 7320 7573 696e  ext secrets usin
-0001b900: 6720 6569 7468 6572 2060 6076 6175 6c74  g either ``vault
-0001b910: 6060 206f 7220 6060 6b75 6265 726e 6574  `` or ``kubernet
-0001b920: 6573 6060 2070 726f 7669 6465 722e 0a20  es`` provider.. 
-0001b930: 2020 2020 2020 2057 6865 6e20 7573 696e         When usin
-0001b940: 6720 7769 7468 2056 6175 6c74 2c20 7468  g with Vault, th
-0001b950: 6973 2077 696c 6c20 6372 6561 7465 206e  is will create n
-0001b960: 6565 6465 6420 5661 756c 7420 7374 7275  eeded Vault stru
-0001b970: 6374 7572 6573 2066 6f72 2073 746f 7269  ctures for stori
-0001b980: 6e67 2073 6563 7265 7473 2069 6e20 7072  ng secrets in pr
-0001b990: 6f6a 6563 742d 636f 6e74 6578 742c 2061  oject-context, a
-0001b9a0: 6e64 0a20 2020 2020 2020 2073 746f 7265  nd.        store
-0001b9b0: 2061 2073 6574 206f 6620 7365 6372 6574   a set of secret
-0001b9c0: 2076 616c 7565 732e 2054 6865 206d 6574   values. The met
-0001b9d0: 686f 6420 6765 6e65 7261 7465 7320 4b75  hod generates Ku
-0001b9e0: 6265 726e 6574 6573 2073 6572 7669 6365  bernetes service
-0001b9f0: 2d61 6363 6f75 6e74 2061 6e64 2074 6865  -account and the
-0001ba00: 2056 6175 6c74 2061 7574 6865 6e74 6963   Vault authentic
-0001ba10: 6174 696f 6e0a 2020 2020 2020 2020 7374  ation.        st
-0001ba20: 7275 6374 7572 6573 2074 6861 7420 6172  ructures that ar
-0001ba30: 6520 7265 7175 6972 6564 2066 6f72 2066  e required for f
-0001ba40: 756e 6374 696f 6e20 506f 6473 2074 6f20  unction Pods to 
-0001ba50: 6175 7468 656e 7469 6361 7465 2077 6974  authenticate wit
-0001ba60: 6820 5661 756c 7420 616e 6420 6265 2061  h Vault and be a
-0001ba70: 626c 6520 746f 2065 7874 7261 6374 2073  ble to extract s
-0001ba80: 6563 7265 7420 7661 6c75 6573 0a20 2020  ecret values.   
-0001ba90: 2020 2020 2070 6173 7365 6420 6173 2070       passed as p
-0001baa0: 6172 7420 6f66 2074 6865 6972 2063 6f6e  art of their con
-0001bab0: 7465 7874 2e0a 0a20 2020 2020 2020 204e  text...        N
-0001bac0: 6f74 653a 0a20 2020 2020 2020 2020 2020  ote:.           
-0001bad0: 2020 2020 2054 6869 7320 6d65 7468 6f64       This method
-0001bae0: 2075 7365 6420 7769 7468 2056 6175 6c74   used with Vault
-0001baf0: 2069 7320 6375 7272 656e 746c 7920 696e   is currently in
-0001bb00: 2074 6563 686e 6963 616c 2070 7265 7669   technical previ
-0001bb10: 6577 2c20 616e 6420 7265 7175 6972 6573  ew, and requires
-0001bb20: 2061 2048 6173 6869 436f 7270 2056 6175   a HashiCorp Vau
-0001bb30: 6c74 0a20 2020 2020 2020 2020 2020 2020  lt.             
-0001bb40: 2020 2069 6e66 7261 7374 7275 6374 7572     infrastructur
-0001bb50: 6520 7072 6f70 6572 6c79 2073 6574 2075  e properly set u
-0001bb60: 7020 616e 6420 636f 6e6e 6563 7465 6420  p and connected 
-0001bb70: 746f 2074 6865 204d 4c52 756e 2041 5049  to the MLRun API
-0001bb80: 2073 6572 7665 722e 0a0a 2020 2020 2020   server...      
-0001bb90: 2020 5768 656e 2075 7365 6420 7769 7468    When used with
-0001bba0: 204b 7562 6572 6e65 7465 732c 2074 6869   Kubernetes, thi
-0001bbb0: 7320 7769 6c6c 206d 616b 6520 7375 7265  s will make sure
-0001bbc0: 2074 6861 7420 7468 6520 7072 6f6a 6563   that the projec
-0001bbd0: 742d 7370 6563 6966 6963 206b 3873 2073  t-specific k8s s
-0001bbe0: 6563 7265 7420 6973 2063 7265 6174 6564  ecret is created
-0001bbf0: 2c20 616e 6420 7769 6c6c 0a20 2020 2020  , and will.     
-0001bc00: 2020 2070 6f70 756c 6174 6520 6974 2077     populate it w
-0001bc10: 6974 6820 7468 6520 7365 6372 6574 7320  ith the secrets 
-0001bc20: 7072 6f76 6964 6564 2c20 7265 706c 6163  provided, replac
-0001bc30: 696e 6720 7468 6569 7220 7661 6c75 6573  ing their values
-0001bc40: 2069 6620 7468 6579 2065 7869 7374 2e0a   if they exist..
-0001bc50: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0001bc60: 7072 6f6a 6563 743a 2054 6865 2070 726f  project: The pro
-0001bc70: 6a65 6374 2063 6f6e 7465 7874 2066 6f72  ject context for
-0001bc80: 2077 6869 6368 2074 6f20 6765 6e65 7261   which to genera
-0001bc90: 7465 2074 6865 2069 6e66 7261 2061 6e64  te the infra and
-0001bca0: 2073 746f 7265 2073 6563 7265 7473 2e0a   store secrets..
-0001bcb0: 2020 2020 2020 2020 3a70 6172 616d 2070          :param p
-0001bcc0: 726f 7669 6465 723a 2054 6865 206e 616d  rovider: The nam
-0001bcd0: 6520 6f66 2074 6865 2073 6563 7265 7473  e of the secrets
-0001bce0: 2d70 726f 7669 6465 7220 746f 2077 6f72  -provider to wor
-0001bcf0: 6b20 7769 7468 2e20 4163 6365 7074 7320  k with. Accepts 
-0001bd00: 610a 2020 2020 2020 2020 2020 2020 3a70  a.            :p
-0001bd10: 793a 636c 6173 733a 607e 6d6c 7275 6e2e  y:class:`~mlrun.
-0001bd20: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e73  common.schemas.s
-0001bd30: 6563 7265 742e 5365 6372 6574 5072 6f76  ecret.SecretProv
-0001bd40: 6964 6572 4e61 6d65 6020 656e 756d 2e0a  iderName` enum..
-0001bd50: 2020 2020 2020 2020 3a70 6172 616d 2073          :param s
-0001bd60: 6563 7265 7473 3a20 4120 7365 7420 6f66  ecrets: A set of
-0001bd70: 2073 6563 7265 7420 7661 6c75 6573 2074   secret values t
-0001bd80: 6f20 7374 6f72 652e 0a20 2020 2020 2020  o store..       
-0001bd90: 2020 2020 2045 7861 6d70 6c65 3a3a 0a0a       Example::..
-0001bda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bdb0: 7365 6372 6574 7320 3d20 7b27 7061 7373  secrets = {'pass
-0001bdc0: 776f 7264 273a 2027 6d79 5061 7373 7730  word': 'myPassw0
-0001bdd0: 7264 272c 2027 6177 735f 6b65 7927 3a20  rd', 'aws_key': 
-0001bde0: 2731 3131 3232 3233 3333 277d 0a20 2020  '111222333'}.   
-0001bdf0: 2020 2020 2020 2020 2020 2020 2064 622e               db.
-0001be00: 6372 6561 7465 5f70 726f 6a65 6374 5f73  create_project_s
-0001be10: 6563 7265 7473 280a 2020 2020 2020 2020  ecrets(.        
-0001be20: 2020 2020 2020 2020 2020 2020 2270 726f              "pro
-0001be30: 6a65 6374 3122 2c0a 2020 2020 2020 2020  ject1",.        
-0001be40: 2020 2020 2020 2020 2020 2020 7072 6f76              prov
-0001be50: 6964 6572 3d6d 6c72 756e 2e63 6f6d 6d6f  ider=mlrun.commo
-0001be60: 6e2e 7363 6865 6d61 732e 5365 6372 6574  n.schemas.Secret
-0001be70: 5072 6f76 6964 6572 4e61 6d65 2e6b 7562  ProviderName.kub
-0001be80: 6572 6e65 7465 732c 0a20 2020 2020 2020  ernetes,.       
-0001be90: 2020 2020 2020 2020 2020 2020 2073 6563               sec
-0001bea0: 7265 7473 3d73 6563 7265 7473 0a20 2020  rets=secrets.   
-0001beb0: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-0001bec0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0001bed0: 2020 2070 6174 6820 3d20 6622 7072 6f6a     path = f"proj
-0001bee0: 6563 7473 2f7b 7072 6f6a 6563 747d 2f73  ects/{project}/s
-0001bef0: 6563 7265 7473 220a 2020 2020 2020 2020  ecrets".        
-0001bf00: 7365 6372 6574 735f 696e 7075 7420 3d20  secrets_input = 
-0001bf10: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-0001bf20: 656d 6173 2e53 6563 7265 7473 4461 7461  emas.SecretsData
-0001bf30: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
-0001bf40: 6372 6574 733d 7365 6372 6574 732c 2070  crets=secrets, p
-0001bf50: 726f 7669 6465 723d 7072 6f76 6964 6572  rovider=provider
-0001bf60: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-0001bf70: 2020 2062 6f64 7920 3d20 7365 6372 6574     body = secret
-0001bf80: 735f 696e 7075 742e 6469 6374 2829 0a20  s_input.dict(). 
-0001bf90: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
-0001bfa0: 7361 6765 203d 2066 2246 6169 6c65 6420  sage = f"Failed 
-0001bfb0: 6372 6561 7469 6e67 2073 6563 7265 7420  creating secret 
-0001bfc0: 7072 6f76 6964 6572 207b 7072 6f6a 6563  provider {projec
-0001bfd0: 747d 2f7b 7072 6f76 6964 6572 7d22 0a20  t}/{provider}". 
-0001bfe0: 2020 2020 2020 2073 656c 662e 6170 695f         self.api_
-0001bff0: 6361 6c6c 280a 2020 2020 2020 2020 2020  call(.          
-0001c000: 2020 2250 4f53 5422 2c0a 2020 2020 2020    "POST",.      
-0001c010: 2020 2020 2020 7061 7468 2c0a 2020 2020        path,.    
-0001c020: 2020 2020 2020 2020 6572 726f 725f 6d65          error_me
-0001c030: 7373 6167 652c 0a20 2020 2020 2020 2020  ssage,.         
-0001c040: 2020 2062 6f64 793d 6469 6374 5f74 6f5f     body=dict_to_
-0001c050: 6a73 6f6e 2862 6f64 7929 2c0a 2020 2020  json(body),.    
-0001c060: 2020 2020 290a 0a20 2020 2064 6566 206c      )..    def l
-0001c070: 6973 745f 7072 6f6a 6563 745f 7365 6372  ist_project_secr
-0001c080: 6574 7328 0a20 2020 2020 2020 2073 656c  ets(.        sel
-0001c090: 662c 0a20 2020 2020 2020 2070 726f 6a65  f,.        proje
-0001c0a0: 6374 3a20 7374 722c 0a20 2020 2020 2020  ct: str,.       
-0001c0b0: 2074 6f6b 656e 3a20 7374 7220 3d20 4e6f   token: str = No
-0001c0c0: 6e65 2c0a 2020 2020 2020 2020 7072 6f76  ne,.        prov
-0001c0d0: 6964 6572 3a20 556e 696f 6e5b 0a20 2020  ider: Union[.   
-0001c0e0: 2020 2020 2020 2020 2073 7472 2c20 6d6c           str, ml
-0001c0f0: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
-0001c100: 6173 2e53 6563 7265 7450 726f 7669 6465  as.SecretProvide
-0001c110: 724e 616d 650a 2020 2020 2020 2020 5d20  rName.        ] 
-0001c120: 3d20 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  = mlrun.common.s
-0001c130: 6368 656d 6173 2e53 6563 7265 7450 726f  chemas.SecretPro
-0001c140: 7669 6465 724e 616d 652e 6b75 6265 726e  viderName.kubern
-0001c150: 6574 6573 2c0a 2020 2020 2020 2020 7365  etes,.        se
-0001c160: 6372 6574 733a 206c 6973 745b 7374 725d  crets: list[str]
-0001c170: 203d 204e 6f6e 652c 0a20 2020 2029 202d   = None,.    ) -
-0001c180: 3e20 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  > mlrun.common.s
-0001c190: 6368 656d 6173 2e53 6563 7265 7473 4461  chemas.SecretsDa
-0001c1a0: 7461 3a0a 2020 2020 2020 2020 2222 2252  ta:.        """R
-0001c1b0: 6574 7269 6576 6520 7072 6f6a 6563 742d  etrieve project-
-0001c1c0: 636f 6e74 6578 7420 7365 6372 6574 7320  context secrets 
-0001c1d0: 6672 6f6d 2056 6175 6c74 2e0a 0a20 2020  from Vault...   
-0001c1e0: 2020 2020 204e 6f74 653a 0a20 2020 2020       Note:.     
-0001c1f0: 2020 2020 2020 2020 2020 2054 6869 7320             This 
-0001c200: 6d65 7468 6f64 2066 6f72 2056 6175 6c74  method for Vault
-0001c210: 2066 756e 6374 696f 6e61 6c69 7479 2069   functionality i
-0001c220: 7320 6375 7272 656e 746c 7920 696e 2074  s currently in t
-0001c230: 6563 686e 6963 616c 2070 7265 7669 6577  echnical preview
-0001c240: 2c20 616e 6420 7265 7175 6972 6573 2061  , and requires a
-0001c250: 2048 6173 6869 436f 7270 2056 6175 6c74   HashiCorp Vault
-0001c260: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001c270: 2069 6e66 7261 7374 7275 6374 7572 6520   infrastructure 
-0001c280: 7072 6f70 6572 6c79 2073 6574 2075 7020  properly set up 
-0001c290: 616e 6420 636f 6e6e 6563 7465 6420 746f  and connected to
-0001c2a0: 2074 6865 204d 4c52 756e 2041 5049 2073   the MLRun API s
-0001c2b0: 6572 7665 722e 0a0a 2020 2020 2020 2020  erver...        
-0001c2c0: 3a70 6172 616d 2070 726f 6a65 6374 3a20  :param project: 
-0001c2d0: 5468 6520 7072 6f6a 6563 7420 6e61 6d65  The project name
-0001c2e0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-0001c2f0: 2074 6f6b 656e 3a20 5661 756c 7420 746f   token: Vault to
-0001c300: 6b65 6e20 746f 2075 7365 2066 6f72 2072  ken to use for r
-0001c310: 6574 7269 6576 696e 6720 7365 6372 6574  etrieving secret
-0001c320: 732e 0a20 2020 2020 2020 2020 2020 204d  s..            M
-0001c330: 7573 7420 6265 2061 2076 616c 6964 2056  ust be a valid V
-0001c340: 6175 6c74 2074 6f6b 656e 2c20 7769 7468  ault token, with
-0001c350: 2070 6572 6d69 7373 696f 6e73 2074 6f20   permissions to 
-0001c360: 7265 7472 6965 7665 2073 6563 7265 7473  retrieve secrets
-0001c370: 206f 6620 7468 6520 7072 6f6a 6563 7420   of the project 
-0001c380: 696e 2071 7565 7374 696f 6e2e 0a20 2020  in question..   
-0001c390: 2020 2020 203a 7061 7261 6d20 7072 6f76       :param prov
-0001c3a0: 6964 6572 3a20 5468 6520 6e61 6d65 206f  ider: The name o
-0001c3b0: 6620 7468 6520 7365 6372 6574 732d 7072  f the secrets-pr
-0001c3c0: 6f76 6964 6572 2074 6f20 776f 726b 2077  ovider to work w
-0001c3d0: 6974 682e 2043 7572 7265 6e74 6c79 206f  ith. Currently o
-0001c3e0: 6e6c 7920 6060 7661 756c 7460 6020 6973  nly ``vault`` is
-0001c3f0: 2061 6363 6570 7465 642e 0a20 2020 2020   accepted..     
-0001c400: 2020 203a 7061 7261 6d20 7365 6372 6574     :param secret
-0001c410: 733a 2041 206c 6973 7420 6f66 2073 6563  s: A list of sec
-0001c420: 7265 7420 6e61 6d65 7320 746f 2072 6574  ret names to ret
-0001c430: 7269 6576 652e 2041 6e20 656d 7074 7920  rieve. An empty 
-0001c440: 6c69 7374 2060 605b 5d60 6020 7769 6c6c  list ``[]`` will
-0001c450: 2072 6574 7269 6576 6520 616c 6c20 7365   retrieve all se
-0001c460: 6372 6574 7320 6173 7369 676e 6564 0a20  crets assigned. 
-0001c470: 2020 2020 2020 2020 2020 2074 6f20 7468             to th
-0001c480: 6973 2073 7065 6369 6669 6320 7072 6f6a  is specific proj
-0001c490: 6563 742e 2060 606b 7562 6572 6e65 7465  ect. ``kubernete
-0001c4a0: 7360 6020 7072 6f76 6964 6572 206f 6e6c  s`` provider onl
-0001c4b0: 7920 7375 7070 6f72 7473 2061 6e20 656d  y supports an em
-0001c4c0: 7074 7920 6c69 7374 2e0a 2020 2020 2020  pty list..      
-0001c4d0: 2020 2222 220a 0a20 2020 2020 2020 2069    """..        i
-0001c4e0: 6620 280a 2020 2020 2020 2020 2020 2020  f (.            
-0001c4f0: 7072 6f76 6964 6572 203d 3d20 6d6c 7275  provider == mlru
-0001c500: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
-0001c510: 2e53 6563 7265 7450 726f 7669 6465 724e  .SecretProviderN
-0001c520: 616d 652e 7661 756c 742e 7661 6c75 650a  ame.vault.value.
-0001c530: 2020 2020 2020 2020 2020 2020 616e 6420              and 
-0001c540: 6e6f 7420 746f 6b65 6e0a 2020 2020 2020  not token.      
-0001c550: 2020 293a 0a20 2020 2020 2020 2020 2020    ):.           
-0001c560: 2072 6169 7365 204d 4c52 756e 496e 7661   raise MLRunInva
-0001c570: 6c69 6441 7267 756d 656e 7445 7272 6f72  lidArgumentError
-0001c580: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0001c590: 2020 2241 2076 6175 6c74 2074 6f6b 656e    "A vault token
-0001c5a0: 206d 7573 7420 6265 2070 726f 7669 6465   must be provide
-0001c5b0: 6420 7768 656e 2061 6363 6573 7369 6e67  d when accessing
-0001c5c0: 2076 6175 6c74 2073 6563 7265 7473 220a   vault secrets".
-0001c5d0: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-0001c5e0: 2020 2020 2020 2070 6174 6820 3d20 6622         path = f"
-0001c5f0: 7072 6f6a 6563 7473 2f7b 7072 6f6a 6563  projects/{projec
-0001c600: 747d 2f73 6563 7265 7473 220a 2020 2020  t}/secrets".    
-0001c610: 2020 2020 7061 7261 6d73 203d 207b 2270      params = {"p
-0001c620: 726f 7669 6465 7222 3a20 7072 6f76 6964  rovider": provid
-0001c630: 6572 2c20 2273 6563 7265 7422 3a20 7365  er, "secret": se
-0001c640: 6372 6574 737d 0a20 2020 2020 2020 2068  crets}.        h
-0001c650: 6561 6465 7273 203d 207b 6d6c 7275 6e2e  eaders = {mlrun.
-0001c660: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e48  common.schemas.H
-0001c670: 6561 6465 724e 616d 6573 2e73 6563 7265  eaderNames.secre
-0001c680: 745f 7374 6f72 655f 746f 6b65 6e3a 2074  t_store_token: t
-0001c690: 6f6b 656e 7d0a 2020 2020 2020 2020 6572  oken}.        er
-0001c6a0: 726f 725f 6d65 7373 6167 6520 3d20 6622  ror_message = f"
-0001c6b0: 4661 696c 6564 2072 6574 7269 6576 696e  Failed retrievin
-0001c6c0: 6720 7365 6372 6574 7320 7b70 726f 6a65  g secrets {proje
-0001c6d0: 6374 7d2f 7b70 726f 7669 6465 727d 220a  ct}/{provider}".
-0001c6e0: 2020 2020 2020 2020 7265 7375 6c74 203d          result =
-0001c6f0: 2073 656c 662e 6170 695f 6361 6c6c 280a   self.api_call(.
-0001c700: 2020 2020 2020 2020 2020 2020 2247 4554              "GET
-0001c710: 222c 0a20 2020 2020 2020 2020 2020 2070  ",.            p
-0001c720: 6174 682c 0a20 2020 2020 2020 2020 2020  ath,.           
-0001c730: 2065 7272 6f72 5f6d 6573 7361 6765 2c0a   error_message,.
-0001c740: 2020 2020 2020 2020 2020 2020 7061 7261              para
-0001c750: 6d73 3d70 6172 616d 732c 0a20 2020 2020  ms=params,.     
-0001c760: 2020 2020 2020 2068 6561 6465 7273 3d68         headers=h
-0001c770: 6561 6465 7273 2c0a 2020 2020 2020 2020  eaders,.        
-0001c780: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-0001c790: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
-0001c7a0: 6865 6d61 732e 5365 6372 6574 7344 6174  hemas.SecretsDat
-0001c7b0: 6128 2a2a 7265 7375 6c74 2e6a 736f 6e28  a(**result.json(
-0001c7c0: 2929 0a0a 2020 2020 6465 6620 6c69 7374  ))..    def list
-0001c7d0: 5f70 726f 6a65 6374 5f73 6563 7265 745f  _project_secret_
-0001c7e0: 6b65 7973 280a 2020 2020 2020 2020 7365  keys(.        se
-0001c7f0: 6c66 2c0a 2020 2020 2020 2020 7072 6f6a  lf,.        proj
-0001c800: 6563 743a 2073 7472 2c0a 2020 2020 2020  ect: str,.      
-0001c810: 2020 7072 6f76 6964 6572 3a20 556e 696f    provider: Unio
-0001c820: 6e5b 0a20 2020 2020 2020 2020 2020 2073  n[.            s
-0001c830: 7472 2c20 6d6c 7275 6e2e 636f 6d6d 6f6e  tr, mlrun.common
-0001c840: 2e73 6368 656d 6173 2e53 6563 7265 7450  .schemas.SecretP
-0001c850: 726f 7669 6465 724e 616d 650a 2020 2020  roviderName.    
-0001c860: 2020 2020 5d20 3d20 6d6c 7275 6e2e 636f      ] = mlrun.co
-0001c870: 6d6d 6f6e 2e73 6368 656d 6173 2e53 6563  mmon.schemas.Sec
-0001c880: 7265 7450 726f 7669 6465 724e 616d 652e  retProviderName.
-0001c890: 6b75 6265 726e 6574 6573 2c0a 2020 2020  kubernetes,.    
-0001c8a0: 2020 2020 746f 6b65 6e3a 2073 7472 203d      token: str =
-0001c8b0: 204e 6f6e 652c 0a20 2020 2029 202d 3e20   None,.    ) -> 
-0001c8c0: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-0001c8d0: 656d 6173 2e53 6563 7265 744b 6579 7344  emas.SecretKeysD
-0001c8e0: 6174 613a 0a20 2020 2020 2020 2022 2222  ata:.        """
-0001c8f0: 5265 7472 6965 7665 2070 726f 6a65 6374  Retrieve project
-0001c900: 2d63 6f6e 7465 7874 2073 6563 7265 7420  -context secret 
-0001c910: 6b65 7973 2066 726f 6d20 5661 756c 7420  keys from Vault 
-0001c920: 6f72 204b 7562 6572 6e65 7465 732e 0a0a  or Kubernetes...
-0001c930: 2020 2020 2020 2020 4e6f 7465 3a0a 2020          Note:.  
-0001c940: 2020 2020 2020 2020 2020 2020 2020 5468                Th
-0001c950: 6973 206d 6574 686f 6420 666f 7220 5661  is method for Va
-0001c960: 756c 7420 6675 6e63 7469 6f6e 616c 6974  ult functionalit
-0001c970: 7920 6973 2063 7572 7265 6e74 6c79 2069  y is currently i
-0001c980: 6e20 7465 6368 6e69 6361 6c20 7072 6576  n technical prev
-0001c990: 6965 772c 2061 6e64 2072 6571 7569 7265  iew, and require
-0001c9a0: 7320 6120 4861 7368 6943 6f72 7020 5661  s a HashiCorp Va
-0001c9b0: 756c 740a 2020 2020 2020 2020 2020 2020  ult.            
-0001c9c0: 2020 2020 696e 6672 6173 7472 7563 7475      infrastructu
-0001c9d0: 7265 2070 726f 7065 726c 7920 7365 7420  re properly set 
-0001c9e0: 7570 2061 6e64 2063 6f6e 6e65 6374 6564  up and connected
-0001c9f0: 2074 6f20 7468 6520 4d4c 5275 6e20 4150   to the MLRun AP
-0001ca00: 4920 7365 7276 6572 2e0a 0a20 2020 2020  I server...     
-0001ca10: 2020 203a 7061 7261 6d20 7072 6f6a 6563     :param projec
-0001ca20: 743a 2054 6865 2070 726f 6a65 6374 206e  t: The project n
-0001ca30: 616d 652e 0a20 2020 2020 2020 203a 7061  ame..        :pa
-0001ca40: 7261 6d20 7072 6f76 6964 6572 3a20 5468  ram provider: Th
-0001ca50: 6520 6e61 6d65 206f 6620 7468 6520 7365  e name of the se
-0001ca60: 6372 6574 732d 7072 6f76 6964 6572 2074  crets-provider t
-0001ca70: 6f20 776f 726b 2077 6974 682e 2041 6363  o work with. Acc
-0001ca80: 6570 7473 2061 0a20 2020 2020 2020 2020  epts a.         
-0001ca90: 2020 203a 7079 3a63 6c61 7373 3a60 7e6d     :py:class:`~m
-0001caa0: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
-0001cab0: 6d61 732e 7365 6372 6574 2e53 6563 7265  mas.secret.Secre
-0001cac0: 7450 726f 7669 6465 724e 616d 6560 2065  tProviderName` e
-0001cad0: 6e75 6d2e 0a20 2020 2020 2020 203a 7061  num..        :pa
-0001cae0: 7261 6d20 746f 6b65 6e3a 2056 6175 6c74  ram token: Vault
-0001caf0: 2074 6f6b 656e 2074 6f20 7573 6520 666f   token to use fo
-0001cb00: 7220 7265 7472 6965 7669 6e67 2073 6563  r retrieving sec
-0001cb10: 7265 7473 2e20 4f6e 6c79 2069 6e20 7573  rets. Only in us
-0001cb20: 6520 6966 2060 6070 726f 7669 6465 7260  e if ``provider`
-0001cb30: 6020 6973 2060 6076 6175 6c74 6060 2e0a  ` is ``vault``..
-0001cb40: 2020 2020 2020 2020 2020 2020 4d75 7374              Must
-0001cb50: 2062 6520 6120 7661 6c69 6420 5661 756c   be a valid Vaul
-0001cb60: 7420 746f 6b65 6e2c 2077 6974 6820 7065  t token, with pe
-0001cb70: 726d 6973 7369 6f6e 7320 746f 2072 6574  rmissions to ret
-0001cb80: 7269 6576 6520 7365 6372 6574 7320 6f66  rieve secrets of
-0001cb90: 2074 6865 2070 726f 6a65 6374 2069 6e20   the project in 
-0001cba0: 7175 6573 7469 6f6e 2e0a 2020 2020 2020  question..      
-0001cbb0: 2020 2222 220a 0a20 2020 2020 2020 2069    """..        i
-0001cbc0: 6620 280a 2020 2020 2020 2020 2020 2020  f (.            
-0001cbd0: 7072 6f76 6964 6572 203d 3d20 6d6c 7275  provider == mlru
-0001cbe0: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
-0001cbf0: 2e53 6563 7265 7450 726f 7669 6465 724e  .SecretProviderN
-0001cc00: 616d 652e 7661 756c 742e 7661 6c75 650a  ame.vault.value.
-0001cc10: 2020 2020 2020 2020 2020 2020 616e 6420              and 
-0001cc20: 6e6f 7420 746f 6b65 6e0a 2020 2020 2020  not token.      
-0001cc30: 2020 293a 0a20 2020 2020 2020 2020 2020    ):.           
-0001cc40: 2072 6169 7365 204d 4c52 756e 496e 7661   raise MLRunInva
-0001cc50: 6c69 6441 7267 756d 656e 7445 7272 6f72  lidArgumentError
-0001cc60: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0001cc70: 2020 2241 2076 6175 6c74 2074 6f6b 656e    "A vault token
-0001cc80: 206d 7573 7420 6265 2070 726f 7669 6465   must be provide
-0001cc90: 6420 7768 656e 2061 6363 6573 7369 6e67  d when accessing
-0001cca0: 2076 6175 6c74 2073 6563 7265 7473 220a   vault secrets".
-0001ccb0: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-0001ccc0: 2020 2020 2020 2070 6174 6820 3d20 6622         path = f"
-0001ccd0: 7072 6f6a 6563 7473 2f7b 7072 6f6a 6563  projects/{projec
-0001cce0: 747d 2f73 6563 7265 742d 6b65 7973 220a  t}/secret-keys".
-0001ccf0: 2020 2020 2020 2020 7061 7261 6d73 203d          params =
-0001cd00: 207b 2270 726f 7669 6465 7222 3a20 7072   {"provider": pr
-0001cd10: 6f76 6964 6572 7d0a 2020 2020 2020 2020  ovider}.        
-0001cd20: 6865 6164 6572 7320 3d20 280a 2020 2020  headers = (.    
-0001cd30: 2020 2020 2020 2020 7b6d 6c72 756e 2e63          {mlrun.c
-0001cd40: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 4865  ommon.schemas.He
-0001cd50: 6164 6572 4e61 6d65 732e 7365 6372 6574  aderNames.secret
-0001cd60: 5f73 746f 7265 5f74 6f6b 656e 3a20 746f  _store_token: to
-0001cd70: 6b65 6e7d 0a20 2020 2020 2020 2020 2020  ken}.           
-0001cd80: 2069 6620 7072 6f76 6964 6572 203d 3d20   if provider == 
-0001cd90: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-0001cda0: 656d 6173 2e53 6563 7265 7450 726f 7669  emas.SecretProvi
-0001cdb0: 6465 724e 616d 652e 7661 756c 742e 7661  derName.vault.va
-0001cdc0: 6c75 650a 2020 2020 2020 2020 2020 2020  lue.            
-0001cdd0: 656c 7365 204e 6f6e 650a 2020 2020 2020  else None.      
-0001cde0: 2020 290a 2020 2020 2020 2020 6572 726f    ).        erro
-0001cdf0: 725f 6d65 7373 6167 6520 3d20 6622 4661  r_message = f"Fa
-0001ce00: 696c 6564 2072 6574 7269 6576 696e 6720  iled retrieving 
-0001ce10: 7365 6372 6574 206b 6579 7320 7b70 726f  secret keys {pro
-0001ce20: 6a65 6374 7d2f 7b70 726f 7669 6465 727d  ject}/{provider}
-0001ce30: 220a 2020 2020 2020 2020 7265 7375 6c74  ".        result
-0001ce40: 203d 2073 656c 662e 6170 695f 6361 6c6c   = self.api_call
-0001ce50: 280a 2020 2020 2020 2020 2020 2020 2247  (.            "G
-0001ce60: 4554 222c 0a20 2020 2020 2020 2020 2020  ET",.           
-0001ce70: 2070 6174 682c 0a20 2020 2020 2020 2020   path,.         
-0001ce80: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
-0001ce90: 2c0a 2020 2020 2020 2020 2020 2020 7061  ,.            pa
-0001cea0: 7261 6d73 3d70 6172 616d 732c 0a20 2020  rams=params,.   
-0001ceb0: 2020 2020 2020 2020 2068 6561 6465 7273           headers
-0001cec0: 3d68 6561 6465 7273 2c0a 2020 2020 2020  =headers,.      
-0001ced0: 2020 290a 2020 2020 2020 2020 7265 7475    ).        retu
-0001cee0: 726e 206d 6c72 756e 2e63 6f6d 6d6f 6e2e  rn mlrun.common.
-0001cef0: 7363 6865 6d61 732e 5365 6372 6574 4b65  schemas.SecretKe
-0001cf00: 7973 4461 7461 282a 2a72 6573 756c 742e  ysData(**result.
-0001cf10: 6a73 6f6e 2829 290a 0a20 2020 2064 6566  json())..    def
-0001cf20: 2064 656c 6574 655f 7072 6f6a 6563 745f   delete_project_
-0001cf30: 7365 6372 6574 7328 0a20 2020 2020 2020  secrets(.       
-0001cf40: 2073 656c 662c 0a20 2020 2020 2020 2070   self,.        p
-0001cf50: 726f 6a65 6374 3a20 7374 722c 0a20 2020  roject: str,.   
-0001cf60: 2020 2020 2070 726f 7669 6465 723a 2055       provider: U
-0001cf70: 6e69 6f6e 5b0a 2020 2020 2020 2020 2020  nion[.          
-0001cf80: 2020 7374 722c 206d 6c72 756e 2e63 6f6d    str, mlrun.com
-0001cf90: 6d6f 6e2e 7363 6865 6d61 732e 5365 6372  mon.schemas.Secr
-0001cfa0: 6574 5072 6f76 6964 6572 4e61 6d65 0a20  etProviderName. 
-0001cfb0: 2020 2020 2020 205d 203d 206d 6c72 756e         ] = mlrun
-0001cfc0: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
-0001cfd0: 5365 6372 6574 5072 6f76 6964 6572 4e61  SecretProviderNa
-0001cfe0: 6d65 2e6b 7562 6572 6e65 7465 732c 0a20  me.kubernetes,. 
-0001cff0: 2020 2020 2020 2073 6563 7265 7473 3a20         secrets: 
-0001d000: 6c69 7374 5b73 7472 5d20 3d20 4e6f 6e65  list[str] = None
-0001d010: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
-0001d020: 2022 2222 4465 6c65 7465 2070 726f 6a65   """Delete proje
-0001d030: 6374 2d63 6f6e 7465 7874 2073 6563 7265  ct-context secre
-0001d040: 7473 2066 726f 6d20 4b75 6265 726e 6574  ts from Kubernet
-0001d050: 6573 2e0a 0a20 2020 2020 2020 203a 7061  es...        :pa
-0001d060: 7261 6d20 7072 6f6a 6563 743a 2054 6865  ram project: The
-0001d070: 2070 726f 6a65 6374 206e 616d 652e 0a20   project name.. 
-0001d080: 2020 2020 2020 203a 7061 7261 6d20 7072         :param pr
-0001d090: 6f76 6964 6572 3a20 5468 6520 6e61 6d65  ovider: The name
-0001d0a0: 206f 6620 7468 6520 7365 6372 6574 732d   of the secrets-
-0001d0b0: 7072 6f76 6964 6572 2074 6f20 776f 726b  provider to work
-0001d0c0: 2077 6974 682e 2043 7572 7265 6e74 6c79   with. Currently
-0001d0d0: 206f 6e6c 7920 6060 6b75 6265 726e 6574   only ``kubernet
-0001d0e0: 6573 6060 2069 7320 7375 7070 6f72 7465  es`` is supporte
-0001d0f0: 642e 0a20 2020 2020 2020 203a 7061 7261  d..        :para
-0001d100: 6d20 7365 6372 6574 733a 2041 206c 6973  m secrets: A lis
-0001d110: 7420 6f66 2073 6563 7265 7420 6e61 6d65  t of secret name
-0001d120: 7320 746f 2064 656c 6574 652e 2041 6e20  s to delete. An 
-0001d130: 656d 7074 7920 6c69 7374 2077 696c 6c20  empty list will 
-0001d140: 6465 6c65 7465 2061 6c6c 2073 6563 7265  delete all secre
-0001d150: 7473 2061 7373 6967 6e65 640a 2020 2020  ts assigned.    
-0001d160: 2020 2020 2020 2020 746f 2074 6869 7320          to this 
-0001d170: 7370 6563 6966 6963 2070 726f 6a65 6374  specific project
-0001d180: 2e0a 2020 2020 2020 2020 2222 220a 0a20  ..        """.. 
-0001d190: 2020 2020 2020 2070 6174 6820 3d20 6622         path = f"
-0001d1a0: 7072 6f6a 6563 7473 2f7b 7072 6f6a 6563  projects/{projec
-0001d1b0: 747d 2f73 6563 7265 7473 220a 2020 2020  t}/secrets".    
-0001d1c0: 2020 2020 7061 7261 6d73 203d 207b 2270      params = {"p
-0001d1d0: 726f 7669 6465 7222 3a20 7072 6f76 6964  rovider": provid
-0001d1e0: 6572 2c20 2273 6563 7265 7422 3a20 7365  er, "secret": se
-0001d1f0: 6372 6574 737d 0a20 2020 2020 2020 2065  crets}.        e
-0001d200: 7272 6f72 5f6d 6573 7361 6765 203d 2066  rror_message = f
-0001d210: 2246 6169 6c65 6420 6465 6c65 7469 6e67  "Failed deleting
-0001d220: 2073 6563 7265 7473 207b 7072 6f6a 6563   secrets {projec
-0001d230: 747d 2f7b 7072 6f76 6964 6572 7d22 0a20  t}/{provider}". 
-0001d240: 2020 2020 2020 2073 656c 662e 6170 695f         self.api_
-0001d250: 6361 6c6c 280a 2020 2020 2020 2020 2020  call(.          
-0001d260: 2020 2244 454c 4554 4522 2c0a 2020 2020    "DELETE",.    
-0001d270: 2020 2020 2020 2020 7061 7468 2c0a 2020          path,.  
-0001d280: 2020 2020 2020 2020 2020 6572 726f 725f            error_
-0001d290: 6d65 7373 6167 652c 0a20 2020 2020 2020  message,.       
-0001d2a0: 2020 2020 2070 6172 616d 733d 7061 7261       params=para
-0001d2b0: 6d73 2c0a 2020 2020 2020 2020 290a 0a20  ms,.        ).. 
-0001d2c0: 2020 2064 6566 2063 7265 6174 655f 7573     def create_us
-0001d2d0: 6572 5f73 6563 7265 7473 280a 2020 2020  er_secrets(.    
-0001d2e0: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-0001d2f0: 2020 7573 6572 3a20 7374 722c 0a20 2020    user: str,.   
-0001d300: 2020 2020 2070 726f 7669 6465 723a 2055       provider: U
-0001d310: 6e69 6f6e 5b0a 2020 2020 2020 2020 2020  nion[.          
-0001d320: 2020 7374 722c 206d 6c72 756e 2e63 6f6d    str, mlrun.com
-0001d330: 6d6f 6e2e 7363 6865 6d61 732e 5365 6372  mon.schemas.Secr
-0001d340: 6574 5072 6f76 6964 6572 4e61 6d65 0a20  etProviderName. 
-0001d350: 2020 2020 2020 205d 203d 206d 6c72 756e         ] = mlrun
-0001d360: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
-0001d370: 5365 6372 6574 5072 6f76 6964 6572 4e61  SecretProviderNa
-0001d380: 6d65 2e76 6175 6c74 2c0a 2020 2020 2020  me.vault,.      
-0001d390: 2020 7365 6372 6574 733a 2064 6963 7420    secrets: dict 
-0001d3a0: 3d20 4e6f 6e65 2c0a 2020 2020 293a 0a20  = None,.    ):. 
-0001d3b0: 2020 2020 2020 2022 2222 4372 6561 7465         """Create
-0001d3c0: 2075 7365 722d 636f 6e74 6578 7420 7365   user-context se
-0001d3d0: 6372 6574 2069 6e20 5661 756c 742e 2050  cret in Vault. P
-0001d3e0: 6c65 6173 6520 7265 6665 7220 746f 203a  lease refer to :
-0001d3f0: 7079 3a66 756e 633a 6063 7265 6174 655f  py:func:`create_
-0001d400: 7072 6f6a 6563 745f 7365 6372 6574 7360  project_secrets`
-0001d410: 2066 6f72 206d 6f72 6520 6465 7461 696c   for more detail
-0001d420: 730a 2020 2020 2020 2020 616e 6420 7374  s.        and st
-0001d430: 6174 7573 206f 6620 7468 6973 2066 756e  atus of this fun
-0001d440: 6374 696f 6e61 6c69 7479 2e0a 0a20 2020  ctionality...   
-0001d450: 2020 2020 204e 6f74 653a 0a20 2020 2020       Note:.     
-0001d460: 2020 2020 2020 2020 2020 2054 6869 7320             This 
-0001d470: 6d65 7468 6f64 2069 7320 6375 7272 656e  method is curren
-0001d480: 746c 7920 696e 2074 6563 686e 6963 616c  tly in technical
-0001d490: 2070 7265 7669 6577 2c20 616e 6420 7265   preview, and re
-0001d4a0: 7175 6972 6573 2061 2048 6173 6869 436f  quires a HashiCo
-0001d4b0: 7270 2056 6175 6c74 2069 6e66 7261 7374  rp Vault infrast
-0001d4c0: 7275 6374 7572 650a 2020 2020 2020 2020  ructure.        
-0001d4d0: 2020 2020 2020 2020 7072 6f70 6572 6c79          properly
-0001d4e0: 2073 6574 2075 7020 616e 6420 636f 6e6e   set up and conn
-0001d4f0: 6563 7465 6420 746f 2074 6865 204d 4c52  ected to the MLR
-0001d500: 756e 2041 5049 2073 6572 7665 722e 0a0a  un API server...
-0001d510: 2020 2020 2020 2020 3a70 6172 616d 2075          :param u
-0001d520: 7365 723a 2054 6865 2075 7365 7220 636f  ser: The user co
-0001d530: 6e74 6578 7420 666f 7220 7768 6963 6820  ntext for which 
-0001d540: 746f 2067 656e 6572 6174 6520 7468 6520  to generate the 
-0001d550: 696e 6672 6120 616e 6420 7374 6f72 6520  infra and store 
-0001d560: 7365 6372 6574 732e 0a20 2020 2020 2020  secrets..       
-0001d570: 203a 7061 7261 6d20 7072 6f76 6964 6572   :param provider
-0001d580: 3a20 5468 6520 6e61 6d65 206f 6620 7468  : The name of th
-0001d590: 6520 7365 6372 6574 732d 7072 6f76 6964  e secrets-provid
-0001d5a0: 6572 2074 6f20 776f 726b 2077 6974 682e  er to work with.
-0001d5b0: 2043 7572 7265 6e74 6c79 206f 6e6c 7920   Currently only 
-0001d5c0: 6060 7661 756c 7460 6020 6973 2073 7570  ``vault`` is sup
-0001d5d0: 706f 7274 6564 2e0a 2020 2020 2020 2020  ported..        
-0001d5e0: 3a70 6172 616d 2073 6563 7265 7473 3a20  :param secrets: 
-0001d5f0: 4120 7365 7420 6f66 2073 6563 7265 7420  A set of secret 
-0001d600: 7661 6c75 6573 2074 6f20 7374 6f72 6520  values to store 
-0001d610: 7769 7468 696e 2074 6865 2056 6175 6c74  within the Vault
-0001d620: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-0001d630: 2020 2020 2020 7061 7468 203d 2022 7573        path = "us
-0001d640: 6572 2d73 6563 7265 7473 220a 2020 2020  er-secrets".    
-0001d650: 2020 2020 7365 6372 6574 735f 6372 6561      secrets_crea
-0001d660: 7469 6f6e 5f72 6571 7565 7374 203d 206d  tion_request = m
-0001d670: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
-0001d680: 6d61 732e 5573 6572 5365 6372 6574 4372  mas.UserSecretCr
-0001d690: 6561 7469 6f6e 5265 7175 6573 7428 0a20  eationRequest(. 
-0001d6a0: 2020 2020 2020 2020 2020 2075 7365 723d             user=
-0001d6b0: 7573 6572 2c0a 2020 2020 2020 2020 2020  user,.          
-0001d6c0: 2020 7072 6f76 6964 6572 3d70 726f 7669    provider=provi
-0001d6d0: 6465 722c 0a20 2020 2020 2020 2020 2020  der,.           
-0001d6e0: 2073 6563 7265 7473 3d73 6563 7265 7473   secrets=secrets
-0001d6f0: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-0001d700: 2020 2020 626f 6479 203d 2073 6563 7265      body = secre
-0001d710: 7473 5f63 7265 6174 696f 6e5f 7265 7175  ts_creation_requ
-0001d720: 6573 742e 6469 6374 2829 0a20 2020 2020  est.dict().     
-0001d730: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
-0001d740: 203d 2066 2246 6169 6c65 6420 6372 6561   = f"Failed crea
-0001d750: 7469 6e67 2075 7365 7220 7365 6372 6574  ting user secret
-0001d760: 7320 2d20 7b75 7365 727d 220a 2020 2020  s - {user}".    
-0001d770: 2020 2020 7365 6c66 2e61 7069 5f63 616c      self.api_cal
-0001d780: 6c28 0a20 2020 2020 2020 2020 2020 2022  l(.            "
-0001d790: 504f 5354 222c 0a20 2020 2020 2020 2020  POST",.         
-0001d7a0: 2020 2070 6174 682c 0a20 2020 2020 2020     path,.       
-0001d7b0: 2020 2020 2065 7272 6f72 5f6d 6573 7361       error_messa
-0001d7c0: 6765 2c0a 2020 2020 2020 2020 2020 2020  ge,.            
-0001d7d0: 626f 6479 3d64 6963 745f 746f 5f6a 736f  body=dict_to_jso
-0001d7e0: 6e28 626f 6479 292c 0a20 2020 2020 2020  n(body),.       
-0001d7f0: 2029 0a0a 2020 2020 4073 7461 7469 636d   )..    @staticm
-0001d800: 6574 686f 640a 2020 2020 6465 6620 5f76  ethod.    def _v
-0001d810: 616c 6964 6174 655f 7665 7273 696f 6e5f  alidate_version_
-0001d820: 636f 6d70 6174 6962 696c 6974 7928 7365  compatibility(se
-0001d830: 7276 6572 5f76 6572 7369 6f6e 2c20 636c  rver_version, cl
-0001d840: 6965 6e74 5f76 6572 7369 6f6e 2920 2d3e  ient_version) ->
-0001d850: 2062 6f6f 6c3a 0a20 2020 2020 2020 2074   bool:.        t
-0001d860: 7279 3a0a 2020 2020 2020 2020 2020 2020  ry:.            
-0001d870: 7061 7273 6564 5f73 6572 7665 725f 7665  parsed_server_ve
-0001d880: 7273 696f 6e20 3d20 7365 6d76 6572 2e56  rsion = semver.V
-0001d890: 6572 7369 6f6e 496e 666f 2e70 6172 7365  ersionInfo.parse
-0001d8a0: 2873 6572 7665 725f 7665 7273 696f 6e29  (server_version)
-0001d8b0: 0a20 2020 2020 2020 2020 2020 2070 6172  .            par
-0001d8c0: 7365 645f 636c 6965 6e74 5f76 6572 7369  sed_client_versi
-0001d8d0: 6f6e 203d 2073 656d 7665 722e 5665 7273  on = semver.Vers
-0001d8e0: 696f 6e49 6e66 6f2e 7061 7273 6528 636c  ionInfo.parse(cl
-0001d8f0: 6965 6e74 5f76 6572 7369 6f6e 290a 2020  ient_version).  
-0001d900: 2020 2020 2020 6578 6365 7074 2056 616c        except Val
-0001d910: 7565 4572 726f 723a 0a20 2020 2020 2020  ueError:.       
-0001d920: 2020 2020 2023 2054 6869 7320 7769 6c6c       # This will
-0001d930: 206d 6f73 746c 7920 6861 7070 656e 2069   mostly happen i
-0001d940: 6e20 6465 7620 7363 656e 6172 696f 7320  n dev scenarios 
-0001d950: 7768 656e 2074 6865 2076 6572 7369 6f6e  when the version
-0001d960: 2069 7320 756e 7374 6162 6c65 2061 6e64   is unstable and
-0001d970: 2073 7563 6820 2d20 7468 6572 6566 6f72   such - therefor
-0001d980: 6520 7765 2772 6520 6967 6e6f 7269 6e67  e we're ignoring
-0001d990: 0a20 2020 2020 2020 2020 2020 206c 6f67  .            log
-0001d9a0: 6765 722e 7761 726e 696e 6728 0a20 2020  ger.warning(.   
-0001d9b0: 2020 2020 2020 2020 2020 2020 2022 556e               "Un
-0001d9c0: 6162 6c65 2074 6f20 7061 7273 6520 7365  able to parse se
-0001d9d0: 7276 6572 206f 7220 636c 6965 6e74 2076  rver or client v
-0001d9e0: 6572 7369 6f6e 2e20 4173 7375 6d69 6e67  ersion. Assuming
-0001d9f0: 2063 6f6d 7061 7469 626c 6522 2c0a 2020   compatible",.  
-0001da00: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0001da10: 7276 6572 5f76 6572 7369 6f6e 3d73 6572  rver_version=ser
-0001da20: 7665 725f 7665 7273 696f 6e2c 0a20 2020  ver_version,.   
-0001da30: 2020 2020 2020 2020 2020 2020 2063 6c69               cli
-0001da40: 656e 745f 7665 7273 696f 6e3d 636c 6965  ent_version=clie
-0001da50: 6e74 5f76 6572 7369 6f6e 2c0a 2020 2020  nt_version,.    
-0001da60: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0001da70: 2020 2020 2020 7265 7475 726e 2054 7275        return Tru
-0001da80: 650a 2020 2020 2020 2020 6966 2028 7061  e.        if (pa
-0001da90: 7273 6564 5f73 6572 7665 725f 7665 7273  rsed_server_vers
-0001daa0: 696f 6e2e 6d61 6a6f 7220 3d3d 2030 2061  ion.major == 0 a
-0001dab0: 6e64 2070 6172 7365 645f 7365 7276 6572  nd parsed_server
-0001dac0: 5f76 6572 7369 6f6e 2e6d 696e 6f72 203d  _version.minor =
-0001dad0: 3d20 3029 206f 7220 280a 2020 2020 2020  = 0) or (.      
-0001dae0: 2020 2020 2020 7061 7273 6564 5f63 6c69        parsed_cli
-0001daf0: 656e 745f 7665 7273 696f 6e2e 6d61 6a6f  ent_version.majo
-0001db00: 7220 3d3d 2030 2061 6e64 2070 6172 7365  r == 0 and parse
-0001db10: 645f 636c 6965 6e74 5f76 6572 7369 6f6e  d_client_version
-0001db20: 2e6d 696e 6f72 203d 3d20 300a 2020 2020  .minor == 0.    
-0001db30: 2020 2020 293a 0a20 2020 2020 2020 2020      ):.         
-0001db40: 2020 206c 6f67 6765 722e 7761 726e 696e     logger.warnin
-0001db50: 6728 0a20 2020 2020 2020 2020 2020 2020  g(.             
-0001db60: 2020 2022 5365 7276 6572 206f 7220 636c     "Server or cl
-0001db70: 6965 6e74 2076 6572 7369 6f6e 2069 7320  ient version is 
-0001db80: 756e 7374 6162 6c65 2e20 4173 7375 6d69  unstable. Assumi
-0001db90: 6e67 2063 6f6d 7061 7469 626c 6522 2c0a  ng compatible",.
-0001dba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dbb0: 7365 7276 6572 5f76 6572 7369 6f6e 3d73  server_version=s
-0001dbc0: 6572 7665 725f 7665 7273 696f 6e2c 0a20  erver_version,. 
-0001dbd0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-0001dbe0: 6c69 656e 745f 7665 7273 696f 6e3d 636c  lient_version=cl
-0001dbf0: 6965 6e74 5f76 6572 7369 6f6e 2c0a 2020  ient_version,.  
-0001dc00: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0001dc10: 2020 2020 2020 2020 7265 7475 726e 2054          return T
-0001dc20: 7275 650a 2020 2020 2020 2020 6966 2070  rue.        if p
-0001dc30: 6172 7365 645f 7365 7276 6572 5f76 6572  arsed_server_ver
-0001dc40: 7369 6f6e 2e6d 616a 6f72 2021 3d20 7061  sion.major != pa
-0001dc50: 7273 6564 5f63 6c69 656e 745f 7665 7273  rsed_client_vers
-0001dc60: 696f 6e2e 6d61 6a6f 723a 0a20 2020 2020  ion.major:.     
-0001dc70: 2020 2020 2020 206c 6f67 6765 722e 7761         logger.wa
-0001dc80: 726e 696e 6728 0a20 2020 2020 2020 2020  rning(.         
-0001dc90: 2020 2020 2020 2022 5365 7276 6572 2061         "Server a
-0001dca0: 6e64 2063 6c69 656e 7420 7665 7273 696f  nd client versio
-0001dcb0: 6e73 2061 7265 2069 6e63 6f6d 7061 7469  ns are incompati
-0001dcc0: 626c 6522 2c0a 2020 2020 2020 2020 2020  ble",.          
-0001dcd0: 2020 2020 2020 7061 7273 6564 5f73 6572        parsed_ser
-0001dce0: 7665 725f 7665 7273 696f 6e3d 7061 7273  ver_version=pars
-0001dcf0: 6564 5f73 6572 7665 725f 7665 7273 696f  ed_server_versio
-0001dd00: 6e2c 0a20 2020 2020 2020 2020 2020 2020  n,.             
-0001dd10: 2020 2070 6172 7365 645f 636c 6965 6e74     parsed_client
-0001dd20: 5f76 6572 7369 6f6e 3d70 6172 7365 645f  _version=parsed_
-0001dd30: 636c 6965 6e74 5f76 6572 7369 6f6e 2c0a  client_version,.
-0001dd40: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0001dd50: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0001dd60: 2046 616c 7365 0a20 2020 2020 2020 2069   False.        i
-0001dd70: 6620 7061 7273 6564 5f73 6572 7665 725f  f parsed_server_
-0001dd80: 7665 7273 696f 6e2e 6d69 6e6f 7220 3e20  version.minor > 
-0001dd90: 7061 7273 6564 5f63 6c69 656e 745f 7665  parsed_client_ve
-0001dda0: 7273 696f 6e2e 6d69 6e6f 7220 2b20 323a  rsion.minor + 2:
-0001ddb0: 0a20 2020 2020 2020 2020 2020 206c 6f67  .            log
-0001ddc0: 6765 722e 696e 666f 280a 2020 2020 2020  ger.info(.      
-0001ddd0: 2020 2020 2020 2020 2020 2242 6163 6b77            "Backw
-0001dde0: 6172 6473 2063 6f6d 7061 7469 6269 6c69  ards compatibili
-0001ddf0: 7479 206d 6967 6874 206e 6f74 2061 7070  ty might not app
-0001de00: 6c79 2062 6574 7765 656e 2074 6865 2073  ly between the s
-0001de10: 6572 7665 7220 616e 6420 636c 6965 6e74  erver and client
-0001de20: 2076 6572 7369 6f6e 222c 0a20 2020 2020   version",.     
-0001de30: 2020 2020 2020 2020 2020 2070 6172 7365             parse
-0001de40: 645f 7365 7276 6572 5f76 6572 7369 6f6e  d_server_version
-0001de50: 3d70 6172 7365 645f 7365 7276 6572 5f76  =parsed_server_v
-0001de60: 6572 7369 6f6e 2c0a 2020 2020 2020 2020  ersion,.        
-0001de70: 2020 2020 2020 2020 7061 7273 6564 5f63          parsed_c
-0001de80: 6c69 656e 745f 7665 7273 696f 6e3d 7061  lient_version=pa
-0001de90: 7273 6564 5f63 6c69 656e 745f 7665 7273  rsed_client_vers
-0001dea0: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
-0001deb0: 2029 0a20 2020 2020 2020 2020 2020 2072   ).            r
-0001dec0: 6574 7572 6e20 4661 6c73 650a 2020 2020  eturn False.    
-0001ded0: 2020 2020 6966 2070 6172 7365 645f 636c      if parsed_cl
-0001dee0: 6965 6e74 5f76 6572 7369 6f6e 2e6d 696e  ient_version.min
-0001def0: 6f72 203e 2070 6172 7365 645f 7365 7276  or > parsed_serv
-0001df00: 6572 5f76 6572 7369 6f6e 2e6d 696e 6f72  er_version.minor
-0001df10: 3a0a 2020 2020 2020 2020 2020 2020 6c6f  :.            lo
-0001df20: 6767 6572 2e77 6172 6e69 6e67 280a 2020  gger.warning(.  
-0001df30: 2020 2020 2020 2020 2020 2020 2020 2243                "C
-0001df40: 6c69 656e 7420 7665 7273 696f 6e20 7769  lient version wi
-0001df50: 7468 2068 6967 6865 7220 7665 7273 696f  th higher versio
-0001df60: 6e20 7468 616e 2073 6572 7665 7220 7665  n than server ve
-0001df70: 7273 696f 6e20 6973 6e27 7420 7375 7070  rsion isn't supp
-0001df80: 6f72 7465 642c 220a 2020 2020 2020 2020  orted,".        
-0001df90: 2020 2020 2020 2020 2220 616c 6967 6e20          " align 
-0001dfa0: 796f 7572 2063 6c69 656e 7420 746f 2074  your client to t
-0001dfb0: 6865 2073 6572 7665 7220 7665 7273 696f  he server versio
-0001dfc0: 6e22 2c0a 2020 2020 2020 2020 2020 2020  n",.            
-0001dfd0: 2020 2020 7061 7273 6564 5f73 6572 7665      parsed_serve
-0001dfe0: 725f 7665 7273 696f 6e3d 7061 7273 6564  r_version=parsed
-0001dff0: 5f73 6572 7665 725f 7665 7273 696f 6e2c  _server_version,
-0001e000: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001e010: 2070 6172 7365 645f 636c 6965 6e74 5f76   parsed_client_v
-0001e020: 6572 7369 6f6e 3d70 6172 7365 645f 636c  ersion=parsed_cl
-0001e030: 6965 6e74 5f76 6572 7369 6f6e 2c0a 2020  ient_version,.  
-0001e040: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0001e050: 2020 2020 2020 2020 7265 7475 726e 2046          return F
-0001e060: 616c 7365 0a20 2020 2020 2020 2069 6620  alse.        if 
-0001e070: 7061 7273 6564 5f73 6572 7665 725f 7665  parsed_server_ve
-0001e080: 7273 696f 6e2e 6d69 6e6f 7220 213d 2070  rsion.minor != p
-0001e090: 6172 7365 645f 636c 6965 6e74 5f76 6572  arsed_client_ver
-0001e0a0: 7369 6f6e 2e6d 696e 6f72 3a0a 2020 2020  sion.minor:.    
-0001e0b0: 2020 2020 2020 2020 6c6f 6767 6572 2e69          logger.i
-0001e0c0: 6e66 6f28 0a20 2020 2020 2020 2020 2020  nfo(.           
-0001e0d0: 2020 2020 2022 5365 7276 6572 2061 6e64       "Server and
-0001e0e0: 2063 6c69 656e 7420 7665 7273 696f 6e73   client versions
-0001e0f0: 2061 7265 206e 6f74 2074 6865 2073 616d   are not the sam
-0001e100: 6520 6275 7420 636f 6d70 6174 6962 6c65  e but compatible
-0001e110: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-0001e120: 2020 2070 6172 7365 645f 7365 7276 6572     parsed_server
-0001e130: 5f76 6572 7369 6f6e 3d70 6172 7365 645f  _version=parsed_
-0001e140: 7365 7276 6572 5f76 6572 7369 6f6e 2c0a  server_version,.
-0001e150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e160: 7061 7273 6564 5f63 6c69 656e 745f 7665  parsed_client_ve
-0001e170: 7273 696f 6e3d 7061 7273 6564 5f63 6c69  rsion=parsed_cli
-0001e180: 656e 745f 7665 7273 696f 6e2c 0a20 2020  ent_version,.   
-0001e190: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0001e1a0: 2020 2072 6574 7572 6e20 5472 7565 0a0a     return True..
-0001e1b0: 2020 2020 6465 6620 6372 6561 7465 5f6d      def create_m
-0001e1c0: 6f64 656c 5f65 6e64 706f 696e 7428 0a20  odel_endpoint(. 
-0001e1d0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-0001e1e0: 2020 2020 2070 726f 6a65 6374 3a20 7374       project: st
-0001e1f0: 722c 0a20 2020 2020 2020 2065 6e64 706f  r,.        endpo
-0001e200: 696e 745f 6964 3a20 7374 722c 0a20 2020  int_id: str,.   
-0001e210: 2020 2020 206d 6f64 656c 5f65 6e64 706f       model_endpo
-0001e220: 696e 743a 2055 6e69 6f6e 5b0a 2020 2020  int: Union[.    
-0001e230: 2020 2020 2020 2020 6d6c 7275 6e2e 6d6f          mlrun.mo
-0001e240: 6465 6c5f 6d6f 6e69 746f 7269 6e67 2e6d  del_monitoring.m
-0001e250: 6f64 656c 5f65 6e64 706f 696e 742e 4d6f  odel_endpoint.Mo
-0001e260: 6465 6c45 6e64 706f 696e 742c 2064 6963  delEndpoint, dic
-0001e270: 740a 2020 2020 2020 2020 5d2c 0a20 2020  t.        ],.   
-0001e280: 2029 3a0a 2020 2020 2020 2020 2222 220a   ):.        """.
-0001e290: 2020 2020 2020 2020 4372 6561 7465 7320          Creates 
-0001e2a0: 6120 4442 2072 6563 6f72 6420 7769 7468  a DB record with
-0001e2b0: 2074 6865 2067 6976 656e 206d 6f64 656c   the given model
-0001e2c0: 5f65 6e64 706f 696e 7420 7265 636f 7264  _endpoint record
-0001e2d0: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
-0001e2e0: 6d20 7072 6f6a 6563 743a 2054 6865 206e  m project: The n
-0001e2f0: 616d 6520 6f66 2074 6865 2070 726f 6a65  ame of the proje
-0001e300: 6374 2e0a 2020 2020 2020 2020 3a70 6172  ct..        :par
-0001e310: 616d 2065 6e64 706f 696e 745f 6964 3a20  am endpoint_id: 
-0001e320: 5468 6520 6964 206f 6620 7468 6520 656e  The id of the en
-0001e330: 6470 6f69 6e74 2e0a 2020 2020 2020 2020  dpoint..        
-0001e340: 3a70 6172 616d 206d 6f64 656c 5f65 6e64  :param model_end
-0001e350: 706f 696e 743a 2041 6e20 6f62 6a65 6374  point: An object
-0001e360: 2072 6570 7265 7365 6e74 696e 6720 7468   representing th
-0001e370: 6520 6d6f 6465 6c20 656e 6470 6f69 6e74  e model endpoint
-0001e380: 2e0a 2020 2020 2020 2020 2222 220a 0a20  ..        """.. 
-0001e390: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-0001e3a0: 616e 6365 280a 2020 2020 2020 2020 2020  ance(.          
-0001e3b0: 2020 6d6f 6465 6c5f 656e 6470 6f69 6e74    model_endpoint
-0001e3c0: 2c20 6d6c 7275 6e2e 6d6f 6465 6c5f 6d6f  , mlrun.model_mo
-0001e3d0: 6e69 746f 7269 6e67 2e6d 6f64 656c 5f65  nitoring.model_e
-0001e3e0: 6e64 706f 696e 742e 4d6f 6465 6c45 6e64  ndpoint.ModelEnd
-0001e3f0: 706f 696e 740a 2020 2020 2020 2020 293a  point.        ):
-0001e400: 0a20 2020 2020 2020 2020 2020 206d 6f64  .            mod
-0001e410: 656c 5f65 6e64 706f 696e 7420 3d20 6d6f  el_endpoint = mo
-0001e420: 6465 6c5f 656e 6470 6f69 6e74 2e74 6f5f  del_endpoint.to_
-0001e430: 6469 6374 2829 0a0a 2020 2020 2020 2020  dict()..        
-0001e440: 7061 7468 203d 2066 2270 726f 6a65 6374  path = f"project
-0001e450: 732f 7b70 726f 6a65 6374 7d2f 6d6f 6465  s/{project}/mode
-0001e460: 6c2d 656e 6470 6f69 6e74 732f 7b65 6e64  l-endpoints/{end
-0001e470: 706f 696e 745f 6964 7d22 0a20 2020 2020  point_id}".     
-0001e480: 2020 2073 656c 662e 6170 695f 6361 6c6c     self.api_call
-0001e490: 280a 2020 2020 2020 2020 2020 2020 6d65  (.            me
-0001e4a0: 7468 6f64 3d22 504f 5354 222c 0a20 2020  thod="POST",.   
-0001e4b0: 2020 2020 2020 2020 2070 6174 683d 7061           path=pa
-0001e4c0: 7468 2c0a 2020 2020 2020 2020 2020 2020  th,.            
-0001e4d0: 626f 6479 3d64 6963 745f 746f 5f6a 736f  body=dict_to_jso
-0001e4e0: 6e28 6d6f 6465 6c5f 656e 6470 6f69 6e74  n(model_endpoint
-0001e4f0: 292c 0a20 2020 2020 2020 2029 0a0a 2020  ),.        )..  
-0001e500: 2020 6465 6620 6465 6c65 7465 5f6d 6f64    def delete_mod
-0001e510: 656c 5f65 6e64 706f 696e 7428 0a20 2020  el_endpoint(.   
-0001e520: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-0001e530: 2020 2070 726f 6a65 6374 3a20 7374 722c     project: str,
-0001e540: 0a20 2020 2020 2020 2065 6e64 706f 696e  .        endpoin
-0001e550: 745f 6964 3a20 7374 722c 0a20 2020 2029  t_id: str,.    )
-0001e560: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-0001e570: 2020 2020 2020 4465 6c65 7465 7320 7468        Deletes th
-0001e580: 6520 4442 2072 6563 6f72 6420 6f66 2061  e DB record of a
-0001e590: 2067 6976 656e 206d 6f64 656c 2065 6e64   given model end
-0001e5a0: 706f 696e 742c 2070 726f 6a65 6374 2061  point, project a
-0001e5b0: 6e64 2065 6e64 706f 696e 745f 6964 2061  nd endpoint_id a
-0001e5c0: 7265 2075 7365 6420 666f 7220 6c6f 6f6b  re used for look
-0001e5d0: 7570 0a0a 2020 2020 2020 2020 3a70 6172  up..        :par
-0001e5e0: 616d 2070 726f 6a65 6374 3a20 5468 6520  am project: The 
-0001e5f0: 6e61 6d65 206f 6620 7468 6520 7072 6f6a  name of the proj
-0001e600: 6563 740a 2020 2020 2020 2020 3a70 6172  ect.        :par
-0001e610: 616d 2065 6e64 706f 696e 745f 6964 3a20  am endpoint_id: 
-0001e620: 5468 6520 6964 206f 6620 7468 6520 656e  The id of the en
-0001e630: 6470 6f69 6e74 0a20 2020 2020 2020 2022  dpoint.        "
-0001e640: 2222 0a0a 2020 2020 2020 2020 7061 7468  ""..        path
-0001e650: 203d 2066 2270 726f 6a65 6374 732f 7b70   = f"projects/{p
-0001e660: 726f 6a65 6374 7d2f 6d6f 6465 6c2d 656e  roject}/model-en
-0001e670: 6470 6f69 6e74 732f 7b65 6e64 706f 696e  dpoints/{endpoin
-0001e680: 745f 6964 7d22 0a20 2020 2020 2020 2073  t_id}".        s
-0001e690: 656c 662e 6170 695f 6361 6c6c 280a 2020  elf.api_call(.  
-0001e6a0: 2020 2020 2020 2020 2020 6d65 7468 6f64            method
-0001e6b0: 3d22 4445 4c45 5445 222c 0a20 2020 2020  ="DELETE",.     
-0001e6c0: 2020 2020 2020 2070 6174 683d 7061 7468         path=path
-0001e6d0: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
-0001e6e0: 2064 6566 206c 6973 745f 6d6f 6465 6c5f   def list_model_
-0001e6f0: 656e 6470 6f69 6e74 7328 0a20 2020 2020  endpoints(.     
-0001e700: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-0001e710: 2070 726f 6a65 6374 3a20 7374 722c 0a20   project: str,. 
-0001e720: 2020 2020 2020 206d 6f64 656c 3a20 4f70         model: Op
-0001e730: 7469 6f6e 616c 5b73 7472 5d20 3d20 4e6f  tional[str] = No
-0001e740: 6e65 2c0a 2020 2020 2020 2020 6675 6e63  ne,.        func
-0001e750: 7469 6f6e 3a20 4f70 7469 6f6e 616c 5b73  tion: Optional[s
-0001e760: 7472 5d20 3d20 4e6f 6e65 2c0a 2020 2020  tr] = None,.    
-0001e770: 2020 2020 6c61 6265 6c73 3a20 6c69 7374      labels: list
-0001e780: 5b73 7472 5d20 3d20 4e6f 6e65 2c0a 2020  [str] = None,.  
-0001e790: 2020 2020 2020 7374 6172 743a 2073 7472        start: str
-0001e7a0: 203d 2022 6e6f 772d 3168 222c 0a20 2020   = "now-1h",.   
-0001e7b0: 2020 2020 2065 6e64 3a20 7374 7220 3d20       end: str = 
-0001e7c0: 226e 6f77 222c 0a20 2020 2020 2020 206d  "now",.        m
-0001e7d0: 6574 7269 6373 3a20 4f70 7469 6f6e 616c  etrics: Optional
-0001e7e0: 5b6c 6973 745b 7374 725d 5d20 3d20 4e6f  [list[str]] = No
-0001e7f0: 6e65 2c0a 2020 2020 2020 2020 746f 705f  ne,.        top_
-0001e800: 6c65 7665 6c3a 2062 6f6f 6c20 3d20 4661  level: bool = Fa
-0001e810: 6c73 652c 0a20 2020 2020 2020 2075 6964  lse,.        uid
-0001e820: 733a 204f 7074 696f 6e61 6c5b 6c69 7374  s: Optional[list
-0001e830: 5b73 7472 5d5d 203d 204e 6f6e 652c 0a20  [str]] = None,. 
-0001e840: 2020 2029 202d 3e20 6c69 7374 5b6d 6c72     ) -> list[mlr
-0001e850: 756e 2e6d 6f64 656c 5f6d 6f6e 6974 6f72  un.model_monitor
-0001e860: 696e 672e 6d6f 6465 6c5f 656e 6470 6f69  ing.model_endpoi
-0001e870: 6e74 2e4d 6f64 656c 456e 6470 6f69 6e74  nt.ModelEndpoint
-0001e880: 5d3a 0a20 2020 2020 2020 2022 2222 0a20  ]:.        """. 
-0001e890: 2020 2020 2020 2052 6574 7572 6e73 2061         Returns a
-0001e8a0: 206c 6973 7420 6f66 2060 4d6f 6465 6c45   list of `ModelE
-0001e8b0: 6e64 706f 696e 7460 206f 626a 6563 7473  ndpoint` objects
-0001e8c0: 2e20 4561 6368 2060 4d6f 6465 6c45 6e64  . Each `ModelEnd
-0001e8d0: 706f 696e 7460 206f 626a 6563 7420 7265  point` object re
-0001e8e0: 7072 6573 656e 7473 2074 6865 2063 7572  presents the cur
-0001e8f0: 7265 6e74 2073 7461 7465 206f 6620 610a  rent state of a.
-0001e900: 2020 2020 2020 2020 6d6f 6465 6c20 656e          model en
-0001e910: 6470 6f69 6e74 2e20 5468 6973 2066 756e  dpoint. This fun
-0001e920: 6374 696f 6e73 2073 7570 706f 7274 7320  ctions supports 
-0001e930: 6669 6c74 6572 696e 6720 6279 2074 6865  filtering by the
-0001e940: 2066 6f6c 6c6f 7769 6e67 2070 6172 616d   following param
-0001e950: 6574 6572 733a 0a20 2020 2020 2020 2031  eters:.        1
-0001e960: 2920 6d6f 6465 6c0a 2020 2020 2020 2020  ) model.        
-0001e970: 3229 2066 756e 6374 696f 6e0a 2020 2020  2) function.    
-0001e980: 2020 2020 3329 206c 6162 656c 730a 2020      3) labels.  
-0001e990: 2020 2020 2020 3429 2074 6f70 206c 6576        4) top lev
-0001e9a0: 656c 0a20 2020 2020 2020 2035 2920 7569  el.        5) ui
-0001e9b0: 6473 0a20 2020 2020 2020 2042 7920 6465  ds.        By de
-0001e9c0: 6661 756c 742c 2077 6865 6e20 6e6f 2066  fault, when no f
-0001e9d0: 696c 7465 7273 2061 7265 2061 7070 6c69  ilters are appli
-0001e9e0: 6564 2c20 616c 6c20 6176 6169 6c61 626c  ed, all availabl
-0001e9f0: 6520 656e 6470 6f69 6e74 7320 666f 7220  e endpoints for 
-0001ea00: 7468 6520 6769 7665 6e20 7072 6f6a 6563  the given projec
-0001ea10: 7420 7769 6c6c 2062 6520 6c69 7374 6564  t will be listed
-0001ea20: 2e0a 0a20 2020 2020 2020 2049 6e20 6164  ...        In ad
-0001ea30: 6469 7469 6f6e 2c20 7468 6973 2066 756e  dition, this fun
-0001ea40: 6374 696f 6e73 2070 726f 7669 6465 7320  ctions provides 
-0001ea50: 6120 6661 6361 6465 2066 6f72 206c 6973  a facade for lis
-0001ea60: 7469 6e67 2065 6e64 706f 696e 7420 7265  ting endpoint re
-0001ea70: 6c61 7465 6420 6d65 7472 6963 732e 2054  lated metrics. T
-0001ea80: 6869 7320 6661 6361 6465 2069 7320 7469  his facade is ti
-0001ea90: 6d65 2d62 6173 6564 0a20 2020 2020 2020  me-based.       
-0001eaa0: 2061 6e64 2064 6570 656e 6473 206f 6e20   and depends on 
-0001eab0: 7468 6520 2773 7461 7274 2720 616e 6420  the 'start' and 
-0001eac0: 2765 6e64 2720 7061 7261 6d65 7465 7273  'end' parameters
-0001ead0: 2e20 4279 2064 6566 6175 6c74 2c20 7768  . By default, wh
-0001eae0: 656e 2074 6865 206d 6574 7269 6373 2070  en the metrics p
-0001eaf0: 6172 616d 6574 6572 2069 7320 4e6f 6e65  arameter is None
-0001eb00: 2c20 6e6f 206d 6574 7269 6373 2061 7265  , no metrics are
-0001eb10: 0a20 2020 2020 2020 2061 6464 6564 2074  .        added t
-0001eb20: 6f20 7468 6520 6f75 7470 7574 206f 6620  o the output of 
-0001eb30: 7468 6973 2066 756e 6374 696f 6e2e 0a0a  this function...
-0001eb40: 2020 2020 2020 2020 3a70 6172 616d 2070          :param p
-0001eb50: 726f 6a65 6374 3a20 5468 6520 6e61 6d65  roject: The name
-0001eb60: 206f 6620 7468 6520 7072 6f6a 6563 740a   of the project.
-0001eb70: 2020 2020 2020 2020 3a70 6172 616d 206d          :param m
-0001eb80: 6f64 656c 3a20 5468 6520 6e61 6d65 206f  odel: The name o
-0001eb90: 6620 7468 6520 6d6f 6465 6c20 746f 2066  f the model to f
-0001eba0: 696c 7465 7220 6279 0a20 2020 2020 2020  ilter by.       
-0001ebb0: 203a 7061 7261 6d20 6675 6e63 7469 6f6e   :param function
-0001ebc0: 3a20 5468 6520 6e61 6d65 206f 6620 7468  : The name of th
-0001ebd0: 6520 6675 6e63 7469 6f6e 2074 6f20 6669  e function to fi
-0001ebe0: 6c74 6572 2062 790a 2020 2020 2020 2020  lter by.        
-0001ebf0: 3a70 6172 616d 206c 6162 656c 733a 2041  :param labels: A
-0001ec00: 206c 6973 7420 6f66 206c 6162 656c 7320   list of labels 
-0001ec10: 746f 2066 696c 7465 7220 6279 2e20 4c61  to filter by. La
-0001ec20: 6265 6c20 6669 6c74 6572 7320 776f 726b  bel filters work
-0001ec30: 2062 7920 6569 7468 6572 2066 696c 7465   by either filte
-0001ec40: 7269 6e67 2061 2073 7065 6369 6669 6320  ring a specific 
-0001ec50: 7661 6c75 6520 6f66 2061 0a20 2020 2020  value of a.     
-0001ec60: 2020 2020 6c61 6265 6c20 2869 2e65 2e20      label (i.e. 
-0001ec70: 6c69 7374 2822 6b65 793d 7661 6c75 6522  list("key=value"
-0001ec80: 2929 206f 7220 6279 206c 6f6f 6b69 6e67  )) or by looking
-0001ec90: 2066 6f72 2074 6865 2065 7869 7374 656e   for the existen
-0001eca0: 6365 206f 6620 6120 6769 7665 6e20 6b65  ce of a given ke
-0001ecb0: 7920 2869 2e65 2e20 226b 6579 2229 0a20  y (i.e. "key"). 
-0001ecc0: 2020 2020 2020 203a 7061 7261 6d20 6d65         :param me
-0001ecd0: 7472 6963 733a 2041 206c 6973 7420 6f66  trics: A list of
-0001ece0: 206d 6574 7269 6373 2074 6f20 7265 7475   metrics to retu
-0001ecf0: 726e 2066 6f72 2065 6163 6820 656e 6470  rn for each endp
-0001ed00: 6f69 6e74 2c20 7265 6164 206d 6f72 6520  oint, read more 
-0001ed10: 696e 2027 5469 6d65 4d65 7472 6963 270a  in 'TimeMetric'.
-0001ed20: 2020 2020 2020 2020 3a70 6172 616d 2073          :param s
-0001ed30: 7461 7274 3a20 5468 6520 7374 6172 7420  tart: The start 
-0001ed40: 7469 6d65 206f 6620 7468 6520 6d65 7472  time of the metr
-0001ed50: 6963 732e 2043 616e 2062 6520 7265 7072  ics. Can be repr
-0001ed60: 6573 656e 7465 6420 6279 2061 2073 7472  esented by a str
-0001ed70: 696e 6720 636f 6e74 6169 6e69 6e67 2061  ing containing a
-0001ed80: 6e20 5246 4320 3333 3339 0a20 2020 2020  n RFC 3339.     
-0001ed90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001eda0: 2020 2020 2020 2020 2020 2020 7469 6d65              time
-0001edb0: 2c20 6120 556e 6978 2074 696d 6573 7461  , a Unix timesta
-0001edc0: 6d70 2069 6e20 6d69 6c6c 6973 6563 6f6e  mp in millisecon
-0001edd0: 6473 2c20 6120 7265 6c61 7469 7665 2074  ds, a relative t
-0001ede0: 696d 6520 2860 276e 6f77 2760 206f 720a  ime (`'now'` or.
-0001edf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ee00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ee10: 2060 276e 6f77 2d5b 302d 395d 2b5b 6d68   `'now-[0-9]+[mh
-0001ee20: 645d 2760 2c20 7768 6572 6520 606d 6020  d]'`, where `m` 
-0001ee30: 3d20 6d69 6e75 7465 732c 2060 6860 203d  = minutes, `h` =
-0001ee40: 2068 6f75 7273 2c20 616e 6420 6027 6427   hours, and `'d'
-0001ee50: 6020 3d0a 2020 2020 2020 2020 2020 2020  ` =.            
-0001ee60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ee70: 2020 2020 2064 6179 7329 2c20 6f72 2030       days), or 0
-0001ee80: 2066 6f72 2074 6865 2065 6172 6c69 6573   for the earlies
-0001ee90: 7420 7469 6d65 2e0a 2020 2020 2020 2020  t time..        
-0001eea0: 3a70 6172 616d 2065 6e64 3a20 5468 6520  :param end: The 
-0001eeb0: 656e 6420 7469 6d65 206f 6620 7468 6520  end time of the 
-0001eec0: 6d65 7472 6963 732e 2043 616e 2062 6520  metrics. Can be 
-0001eed0: 7265 7072 6573 656e 7465 6420 6279 2061  represented by a
-0001eee0: 2073 7472 696e 6720 636f 6e74 6169 6e69   string containi
-0001eef0: 6e67 2061 6e20 5246 4320 3333 3339 0a20  ng an RFC 3339. 
-0001ef00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ef10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ef20: 7469 6d65 2c20 6120 556e 6978 2074 696d  time, a Unix tim
-0001ef30: 6573 7461 6d70 2069 6e20 6d69 6c6c 6973  estamp in millis
-0001ef40: 6563 6f6e 6473 2c20 6120 7265 6c61 7469  econds, a relati
-0001ef50: 7665 2074 696d 6520 2860 276e 6f77 2760  ve time (`'now'`
-0001ef60: 206f 720a 2020 2020 2020 2020 2020 2020   or.            
-0001ef70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ef80: 2020 2020 2060 276e 6f77 2d5b 302d 395d       `'now-[0-9]
-0001ef90: 2b5b 6d68 645d 2760 2c20 7768 6572 6520  +[mhd]'`, where 
-0001efa0: 606d 6020 3d20 6d69 6e75 7465 732c 2060  `m` = minutes, `
-0001efb0: 6860 203d 2068 6f75 7273 2c20 616e 6420  h` = hours, and 
-0001efc0: 6027 6427 6020 3d0a 2020 2020 2020 2020  `'d'` =.        
-0001efd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001efe0: 2020 2020 2020 2020 2064 6179 7329 2c20           days), 
-0001eff0: 6f72 2030 2066 6f72 2074 6865 2065 6172  or 0 for the ear
-0001f000: 6c69 6573 7420 7469 6d65 2e0a 2020 2020  liest time..    
-0001f010: 2020 2020 3a70 6172 616d 2074 6f70 5f6c      :param top_l
-0001f020: 6576 656c 3a20 6966 2074 7275 6520 7769  evel: if true wi
-0001f030: 6c6c 2072 6574 7572 6e20 6f6e 6c79 2072  ll return only r
-0001f040: 6f75 7465 7273 2061 6e64 2065 6e64 706f  outers and endpo
-0001f050: 696e 7420 7468 6174 2061 7265 204e 4f54  int that are NOT
-0001f060: 2063 6869 6c64 7265 6e20 6f66 2061 6e79   children of any
-0001f070: 2072 6f75 7465 720a 2020 2020 2020 2020   router.        
-0001f080: 3a70 6172 616d 2075 6964 733a 2069 6620  :param uids: if 
-0001f090: 7061 7373 6564 2077 696c 6c20 7265 7475  passed will retu
-0001f0a0: 726e 2061 206c 6973 7420 604d 6f64 656c  rn a list `Model
-0001f0b0: 456e 6470 6f69 6e74 6020 6f62 6a65 6374  Endpoint` object
-0001f0c0: 2077 6974 6820 7569 6420 696e 2075 6964   with uid in uid
-0001f0d0: 730a 2020 2020 2020 2020 2222 220a 0a20  s.        """.. 
-0001f0e0: 2020 2020 2020 2070 6174 6820 3d20 6622         path = f"
-0001f0f0: 7072 6f6a 6563 7473 2f7b 7072 6f6a 6563  projects/{projec
-0001f100: 747d 2f6d 6f64 656c 2d65 6e64 706f 696e  t}/model-endpoin
-0001f110: 7473 220a 0a20 2020 2020 2020 2069 6620  ts"..        if 
-0001f120: 6c61 6265 6c73 2061 6e64 2069 7369 6e73  labels and isins
-0001f130: 7461 6e63 6528 6c61 6265 6c73 2c20 6469  tance(labels, di
-0001f140: 6374 293a 0a20 2020 2020 2020 2020 2020  ct):.           
-0001f150: 206c 6162 656c 7320 3d20 5b66 227b 6b65   labels = [f"{ke
-0001f160: 797d 3d7b 7661 6c75 657d 2220 666f 7220  y}={value}" for 
-0001f170: 6b65 792c 2076 616c 7565 2069 6e20 6c61  key, value in la
-0001f180: 6265 6c73 2e69 7465 6d73 2829 5d0a 0a20  bels.items()].. 
-0001f190: 2020 2020 2020 2072 6573 706f 6e73 6520         response 
-0001f1a0: 3d20 7365 6c66 2e61 7069 5f63 616c 6c28  = self.api_call(
-0001f1b0: 0a20 2020 2020 2020 2020 2020 206d 6574  .            met
-0001f1c0: 686f 643d 2247 4554 222c 0a20 2020 2020  hod="GET",.     
-0001f1d0: 2020 2020 2020 2070 6174 683d 7061 7468         path=path
-0001f1e0: 2c0a 2020 2020 2020 2020 2020 2020 7061  ,.            pa
-0001f1f0: 7261 6d73 3d7b 0a20 2020 2020 2020 2020  rams={.         
-0001f200: 2020 2020 2020 2022 6d6f 6465 6c22 3a20         "model": 
-0001f210: 6d6f 6465 6c2c 0a20 2020 2020 2020 2020  model,.         
-0001f220: 2020 2020 2020 2022 6675 6e63 7469 6f6e         "function
-0001f230: 223a 2066 756e 6374 696f 6e2c 0a20 2020  ": function,.   
-0001f240: 2020 2020 2020 2020 2020 2020 2022 6c61               "la
-0001f250: 6265 6c22 3a20 6c61 6265 6c73 206f 7220  bel": labels or 
-0001f260: 5b5d 2c0a 2020 2020 2020 2020 2020 2020  [],.            
-0001f270: 2020 2020 2273 7461 7274 223a 2073 7461      "start": sta
-0001f280: 7274 2c0a 2020 2020 2020 2020 2020 2020  rt,.            
-0001f290: 2020 2020 2265 6e64 223a 2065 6e64 2c0a      "end": end,.
-0001f2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f2b0: 226d 6574 7269 6322 3a20 6d65 7472 6963  "metric": metric
-0001f2c0: 7320 6f72 205b 5d2c 0a20 2020 2020 2020  s or [],.       
-0001f2d0: 2020 2020 2020 2020 2022 746f 702d 6c65           "top-le
-0001f2e0: 7665 6c22 3a20 746f 705f 6c65 7665 6c2c  vel": top_level,
-0001f2f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001f300: 2022 7569 6422 3a20 7569 6473 2c0a 2020   "uid": uids,.  
-0001f310: 2020 2020 2020 2020 2020 7d2c 0a20 2020            },.   
-0001f320: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-0001f330: 2320 4765 6e65 7261 7465 2061 206c 6973  # Generate a lis
-0001f340: 7420 6f66 2061 206d 6f64 656c 2065 6e64  t of a model end
-0001f350: 706f 696e 7420 6469 6374 696f 6e61 7269  point dictionari
-0001f360: 6573 0a20 2020 2020 2020 206d 6f64 656c  es.        model
-0001f370: 5f65 6e64 706f 696e 7473 203d 2072 6573  _endpoints = res
-0001f380: 706f 6e73 652e 6a73 6f6e 2829 5b22 656e  ponse.json()["en
-0001f390: 6470 6f69 6e74 7322 5d0a 2020 2020 2020  dpoints"].      
-0001f3a0: 2020 6966 206d 6f64 656c 5f65 6e64 706f    if model_endpo
-0001f3b0: 696e 7473 3a0a 2020 2020 2020 2020 2020  ints:.          
-0001f3c0: 2020 7265 7475 726e 205b 0a20 2020 2020    return [.     
-0001f3d0: 2020 2020 2020 2020 2020 206d 6c72 756e             mlrun
-0001f3e0: 2e6d 6f64 656c 5f6d 6f6e 6974 6f72 696e  .model_monitorin
-0001f3f0: 672e 6d6f 6465 6c5f 656e 6470 6f69 6e74  g.model_endpoint
-0001f400: 2e4d 6f64 656c 456e 6470 6f69 6e74 2e66  .ModelEndpoint.f
-0001f410: 726f 6d5f 6469 6374 286f 626a 290a 2020  rom_dict(obj).  
-0001f420: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-0001f430: 7220 6f62 6a20 696e 206d 6f64 656c 5f65  r obj in model_e
-0001f440: 6e64 706f 696e 7473 0a20 2020 2020 2020  ndpoints.       
-0001f450: 2020 2020 205d 0a20 2020 2020 2020 2072       ].        r
-0001f460: 6574 7572 6e20 5b5d 0a0a 2020 2020 6465  eturn []..    de
-0001f470: 6620 6765 745f 6d6f 6465 6c5f 656e 6470  f get_model_endp
-0001f480: 6f69 6e74 280a 2020 2020 2020 2020 7365  oint(.        se
-0001f490: 6c66 2c0a 2020 2020 2020 2020 7072 6f6a  lf,.        proj
-0001f4a0: 6563 743a 2073 7472 2c0a 2020 2020 2020  ect: str,.      
-0001f4b0: 2020 656e 6470 6f69 6e74 5f69 643a 2073    endpoint_id: s
-0001f4c0: 7472 2c0a 2020 2020 2020 2020 7374 6172  tr,.        star
-0001f4d0: 743a 204f 7074 696f 6e61 6c5b 7374 725d  t: Optional[str]
-0001f4e0: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-0001f4f0: 2065 6e64 3a20 4f70 7469 6f6e 616c 5b73   end: Optional[s
-0001f500: 7472 5d20 3d20 4e6f 6e65 2c0a 2020 2020  tr] = None,.    
-0001f510: 2020 2020 6d65 7472 6963 733a 204f 7074      metrics: Opt
-0001f520: 696f 6e61 6c5b 6c69 7374 5b73 7472 5d5d  ional[list[str]]
-0001f530: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-0001f540: 2066 6561 7475 7265 5f61 6e61 6c79 7369   feature_analysi
-0001f550: 733a 2062 6f6f 6c20 3d20 4661 6c73 652c  s: bool = False,
-0001f560: 0a20 2020 2029 202d 3e20 6d6c 7275 6e2e  .    ) -> mlrun.
-0001f570: 6d6f 6465 6c5f 6d6f 6e69 746f 7269 6e67  model_monitoring
-0001f580: 2e6d 6f64 656c 5f65 6e64 706f 696e 742e  .model_endpoint.
-0001f590: 4d6f 6465 6c45 6e64 706f 696e 743a 0a20  ModelEndpoint:. 
-0001f5a0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0001f5b0: 2020 2052 6574 7572 6e73 2061 2073 696e     Returns a sin
-0001f5c0: 676c 6520 604d 6f64 656c 456e 6470 6f69  gle `ModelEndpoi
-0001f5d0: 6e74 6020 6f62 6a65 6374 2077 6974 6820  nt` object with 
-0001f5e0: 6164 6469 7469 6f6e 616c 206d 6574 7269  additional metri
-0001f5f0: 6373 2061 6e64 2066 6561 7475 7265 2072  cs and feature r
-0001f600: 656c 6174 6564 2064 6174 612e 0a0a 2020  elated data...  
-0001f610: 2020 2020 2020 3a70 6172 616d 2070 726f        :param pro
-0001f620: 6a65 6374 3a20 2020 2020 2020 2020 2020  ject:           
-0001f630: 2020 2020 2020 2020 2054 6865 206e 616d           The nam
-0001f640: 6520 6f66 2074 6865 2070 726f 6a65 6374  e of the project
-0001f650: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0001f660: 656e 6470 6f69 6e74 5f69 643a 2020 2020  endpoint_id:    
-0001f670: 2020 2020 2020 2020 2020 2020 5468 6520              The 
-0001f680: 756e 6971 7565 2069 6420 6f66 2074 6865  unique id of the
-0001f690: 206d 6f64 656c 2065 6e64 706f 696e 742e   model endpoint.
-0001f6a0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-0001f6b0: 7374 6172 743a 2020 2020 2020 2020 2020  start:          
-0001f6c0: 2020 2020 2020 2020 2020 2020 5468 6520              The 
-0001f6d0: 7374 6172 7420 7469 6d65 206f 6620 7468  start time of th
-0001f6e0: 6520 6d65 7472 6963 732e 2043 616e 2062  e metrics. Can b
-0001f6f0: 6520 7265 7072 6573 656e 7465 6420 6279  e represented by
-0001f700: 2061 2073 7472 696e 6720 636f 6e74 6169   a string contai
-0001f710: 6e69 6e67 2061 6e0a 2020 2020 2020 2020  ning an.        
-0001f720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f740: 2020 2052 4643 2033 3333 3920 7469 6d65     RFC 3339 time
-0001f750: 2c20 6120 556e 6978 2074 696d 6573 7461  , a Unix timesta
-0001f760: 6d70 2069 6e20 6d69 6c6c 6973 6563 6f6e  mp in millisecon
-0001f770: 6473 2c20 6120 7265 6c61 7469 7665 2074  ds, a relative t
-0001f780: 696d 6520 2860 276e 6f77 2760 206f 720a  ime (`'now'` or.
-0001f790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017040: 206e 616d 653a 204e 616d 6520 6f66 2066   name: Name of f
+00017050: 6561 7475 7265 2d76 6563 746f 7220 746f  eature-vector to
+00017060: 206d 6174 6368 2e20 5468 6973 2069 7320   match. This is 
+00017070: 6120 6c69 6b65 2071 7565 7279 2c20 616e  a like query, an
+00017080: 6420 6973 2063 6173 652d 696e 7365 6e73  d is case-insens
+00017090: 6974 6976 652e 0a20 2020 2020 2020 203a  itive..        :
+000170a0: 7061 7261 6d20 7461 673a 204d 6174 6368  param tag: Match
+000170b0: 2066 6561 7475 7265 2d76 6563 746f 7273   feature-vectors
+000170c0: 2077 6974 6820 7370 6563 6966 6963 2074   with specific t
+000170d0: 6167 2e0a 2020 2020 2020 2020 3a70 6172  ag..        :par
+000170e0: 616d 2073 7461 7465 3a20 4d61 7463 6820  am state: Match 
+000170f0: 6665 6174 7572 652d 7665 6374 6f72 7320  feature-vectors 
+00017100: 7769 7468 2061 2073 7065 6369 6669 6320  with a specific 
+00017110: 7374 6174 652e 0a20 2020 2020 2020 203a  state..        :
+00017120: 7061 7261 6d20 6c61 6265 6c73 3a20 4d61  param labels: Ma
+00017130: 7463 6820 6665 6174 7572 652d 7665 6374  tch feature-vect
+00017140: 6f72 7320 7768 6963 6820 6861 7665 2074  ors which have t
+00017150: 6865 7365 206c 6162 656c 732e 0a20 2020  hese labels..   
+00017160: 2020 2020 203a 7061 7261 6d20 7061 7274       :param part
+00017170: 6974 696f 6e5f 6279 3a20 4669 656c 6420  ition_by: Field 
+00017180: 746f 2067 726f 7570 2072 6573 756c 7473  to group results
+00017190: 2062 792e 204f 6e6c 7920 616c 6c6f 7765   by. Only allowe
+000171a0: 6420 7661 6c75 6520 6973 2060 6e61 6d65  d value is `name
+000171b0: 602e 2057 6865 6e20 6070 6172 7469 7469  `. When `partiti
+000171c0: 6f6e 5f62 7960 2069 7320 7370 6563 6966  on_by` is specif
+000171d0: 6965 642c 0a20 2020 2020 2020 2020 2020  ied,.           
+000171e0: 2074 6865 2060 7061 7274 6974 696f 6e5f   the `partition_
+000171f0: 736f 7274 5f62 7960 2070 6172 616d 6574  sort_by` paramet
+00017200: 6572 206d 7573 7420 6265 2070 726f 7669  er must be provi
+00017210: 6465 6420 6173 2077 656c 6c2e 0a20 2020  ded as well..   
+00017220: 2020 2020 203a 7061 7261 6d20 726f 7773       :param rows
+00017230: 5f70 6572 5f70 6172 7469 7469 6f6e 3a20  _per_partition: 
+00017240: 486f 7720 6d61 6e79 2074 6f70 2072 6f77  How many top row
+00017250: 7320 2870 6572 2073 6f72 7469 6e67 2064  s (per sorting d
+00017260: 6566 696e 6564 2062 7920 6070 6172 7469  efined by `parti
+00017270: 7469 6f6e 5f73 6f72 745f 6279 6020 616e  tion_sort_by` an
+00017280: 6420 6070 6172 7469 7469 6f6e 5f6f 7264  d `partition_ord
+00017290: 6572 6029 0a20 2020 2020 2020 2020 2020  er`).           
+000172a0: 2074 6f20 7265 7475 726e 2070 6572 2067   to return per g
+000172b0: 726f 7570 2e20 4465 6661 756c 7420 7661  roup. Default va
+000172c0: 6c75 6520 6973 2031 2e0a 2020 2020 2020  lue is 1..      
+000172d0: 2020 3a70 6172 616d 2070 6172 7469 7469    :param partiti
+000172e0: 6f6e 5f73 6f72 745f 6279 3a20 5768 6174  on_sort_by: What
+000172f0: 2066 6965 6c64 2074 6f20 736f 7274 2074   field to sort t
+00017300: 6865 2072 6573 756c 7473 2062 792c 2077  he results by, w
+00017310: 6974 6869 6e20 6561 6368 2070 6172 7469  ithin each parti
+00017320: 7469 6f6e 2064 6566 696e 6564 2062 7920  tion defined by 
+00017330: 6070 6172 7469 7469 6f6e 5f62 7960 2e0a  `partition_by`..
+00017340: 2020 2020 2020 2020 2020 2020 4375 7272              Curr
+00017350: 656e 746c 7920 7468 6520 6f6e 6c79 2061  ently the only a
+00017360: 6c6c 6f77 6564 2076 616c 7565 7320 6172  llowed values ar
+00017370: 6520 6063 7265 6174 6564 6020 616e 6420  e `created` and 
+00017380: 6075 7064 6174 6564 602e 0a20 2020 2020  `updated`..     
+00017390: 2020 203a 7061 7261 6d20 7061 7274 6974     :param partit
+000173a0: 696f 6e5f 6f72 6465 723a 204f 7264 6572  ion_order: Order
+000173b0: 206f 6620 736f 7274 696e 6720 7769 7468   of sorting with
+000173c0: 696e 2070 6172 7469 7469 6f6e 7320 2d20  in partitions - 
+000173d0: 6061 7363 6020 6f72 2060 6465 7363 602e  `asc` or `desc`.
+000173e0: 2044 6566 6175 6c74 2069 7320 6064 6573   Default is `des
+000173f0: 6360 2e0a 2020 2020 2020 2020 3a72 6574  c`..        :ret
+00017400: 7572 6e73 3a20 4c69 7374 206f 6620 6d61  urns: List of ma
+00017410: 7463 6869 6e67 203a 7079 3a63 6c61 7373  tching :py:class
+00017420: 3a60 7e6d 6c72 756e 2e66 6561 7475 7265  :`~mlrun.feature
+00017430: 5f73 746f 7265 2e46 6561 7475 7265 5665  _store.FeatureVe
+00017440: 6374 6f72 6020 6f62 6a65 6374 732e 0a20  ctor` objects.. 
+00017450: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
+00017460: 2020 2020 7072 6f6a 6563 7420 3d20 7072      project = pr
+00017470: 6f6a 6563 7420 6f72 2063 6f6e 6669 672e  oject or config.
+00017480: 6465 6661 756c 745f 7072 6f6a 6563 740a  default_project.
+00017490: 0a20 2020 2020 2020 2070 6172 616d 7320  .        params 
+000174a0: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
+000174b0: 226e 616d 6522 3a20 6e61 6d65 2c0a 2020  "name": name,.  
+000174c0: 2020 2020 2020 2020 2020 2273 7461 7465            "state
+000174d0: 223a 2073 7461 7465 2c0a 2020 2020 2020  ": state,.      
+000174e0: 2020 2020 2020 2274 6167 223a 2074 6167        "tag": tag
+000174f0: 2c0a 2020 2020 2020 2020 2020 2020 226c  ,.            "l
+00017500: 6162 656c 223a 206c 6162 656c 7320 6f72  abel": labels or
+00017510: 205b 5d2c 0a20 2020 2020 2020 207d 0a20   [],.        }. 
+00017520: 2020 2020 2020 2069 6620 7061 7274 6974         if partit
+00017530: 696f 6e5f 6279 3a0a 2020 2020 2020 2020  ion_by:.        
+00017540: 2020 2020 7061 7261 6d73 2e75 7064 6174      params.updat
+00017550: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
+00017560: 2020 2073 656c 662e 5f67 656e 6572 6174     self._generat
+00017570: 655f 7061 7274 6974 696f 6e5f 6279 5f70  e_partition_by_p
+00017580: 6172 616d 7328 0a20 2020 2020 2020 2020  arams(.         
+00017590: 2020 2020 2020 2020 2020 206d 6c72 756e             mlrun
+000175a0: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
+000175b0: 4665 6174 7572 6553 746f 7265 5061 7274  FeatureStorePart
+000175c0: 6974 696f 6e42 7946 6965 6c64 2c0a 2020  itionByField,.  
+000175d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000175e0: 2020 7061 7274 6974 696f 6e5f 6279 2c0a    partition_by,.
+000175f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017600: 2020 2020 726f 7773 5f70 6572 5f70 6172      rows_per_par
+00017610: 7469 7469 6f6e 2c0a 2020 2020 2020 2020  tition,.        
+00017620: 2020 2020 2020 2020 2020 2020 7061 7274              part
+00017630: 6974 696f 6e5f 736f 7274 5f62 792c 0a20  ition_sort_by,. 
+00017640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017650: 2020 2070 6172 7469 7469 6f6e 5f6f 7264     partition_ord
+00017660: 6572 2c0a 2020 2020 2020 2020 2020 2020  er,.            
+00017670: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+00017680: 2020 290a 0a20 2020 2020 2020 2070 6174    )..        pat
+00017690: 6820 3d20 6622 7072 6f6a 6563 7473 2f7b  h = f"projects/{
+000176a0: 7072 6f6a 6563 747d 2f66 6561 7475 7265  project}/feature
+000176b0: 2d76 6563 746f 7273 220a 0a20 2020 2020  -vectors"..     
+000176c0: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
+000176d0: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
+000176e0: 2066 2246 6169 6c65 6420 6c69 7374 696e   f"Failed listin
+000176f0: 6720 6665 6174 7572 652d 7665 6374 6f72  g feature-vector
+00017700: 732c 2070 726f 6a65 6374 3a20 7b70 726f  s, project: {pro
+00017710: 6a65 6374 7d2c 2071 7565 7279 3a20 7b70  ject}, query: {p
+00017720: 6172 616d 737d 220a 2020 2020 2020 2020  arams}".        
+00017730: 290a 2020 2020 2020 2020 7265 7370 203d  ).        resp =
+00017740: 2073 656c 662e 6170 695f 6361 6c6c 2822   self.api_call("
+00017750: 4745 5422 2c20 7061 7468 2c20 6572 726f  GET", path, erro
+00017760: 725f 6d65 7373 6167 652c 2070 6172 616d  r_message, param
+00017770: 733d 7061 7261 6d73 290a 2020 2020 2020  s=params).      
+00017780: 2020 6665 6174 7572 655f 7665 6374 6f72    feature_vector
+00017790: 7320 3d20 7265 7370 2e6a 736f 6e28 295b  s = resp.json()[
+000177a0: 2266 6561 7475 7265 5f76 6563 746f 7273  "feature_vectors
+000177b0: 225d 0a20 2020 2020 2020 2069 6620 6665  "].        if fe
+000177c0: 6174 7572 655f 7665 6374 6f72 733a 0a20  ature_vectors:. 
+000177d0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+000177e0: 6e20 5b46 6561 7475 7265 5665 6374 6f72  n [FeatureVector
+000177f0: 2e66 726f 6d5f 6469 6374 286f 626a 2920  .from_dict(obj) 
+00017800: 666f 7220 6f62 6a20 696e 2066 6561 7475  for obj in featu
+00017810: 7265 5f76 6563 746f 7273 5d0a 0a20 2020  re_vectors]..   
+00017820: 2064 6566 2073 746f 7265 5f66 6561 7475   def store_featu
+00017830: 7265 5f76 6563 746f 7228 0a20 2020 2020  re_vector(.     
+00017840: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+00017850: 2066 6561 7475 7265 5f76 6563 746f 723a   feature_vector:
+00017860: 2055 6e69 6f6e 5b64 6963 742c 206d 6c72   Union[dict, mlr
+00017870: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+00017880: 732e 4665 6174 7572 6556 6563 746f 722c  s.FeatureVector,
+00017890: 2046 6561 7475 7265 5665 6374 6f72 5d2c   FeatureVector],
+000178a0: 0a20 2020 2020 2020 206e 616d 653d 4e6f  .        name=No
+000178b0: 6e65 2c0a 2020 2020 2020 2020 7072 6f6a  ne,.        proj
+000178c0: 6563 743d 2222 2c0a 2020 2020 2020 2020  ect="",.        
+000178d0: 7461 673d 4e6f 6e65 2c0a 2020 2020 2020  tag=None,.      
+000178e0: 2020 7569 643d 4e6f 6e65 2c0a 2020 2020    uid=None,.    
+000178f0: 2020 2020 7665 7273 696f 6e65 643d 5472      versioned=Tr
+00017900: 7565 2c0a 2020 2020 2920 2d3e 2064 6963  ue,.    ) -> dic
+00017910: 743a 0a20 2020 2020 2020 2022 2222 5374  t:.        """St
+00017920: 6f72 6520 6120 3a70 793a 636c 6173 733a  ore a :py:class:
+00017930: 607e 6d6c 7275 6e2e 6665 6174 7572 655f  `~mlrun.feature_
+00017940: 7374 6f72 652e 4665 6174 7572 6556 6563  store.FeatureVec
+00017950: 746f 7260 206f 626a 6563 7420 696e 2074  tor` object in t
+00017960: 6865 203a 7079 3a6d 6f64 3a60 6d6c 7275  he :py:mod:`mlru
+00017970: 6e60 2044 422e 2054 6865 0a20 2020 2020  n` DB. The.     
+00017980: 2020 2066 6561 7475 7265 2d76 6563 746f     feature-vecto
+00017990: 7220 6361 6e20 6265 2065 6974 6865 7220  r can be either 
+000179a0: 6120 6e65 7720 6f62 6a65 6374 206f 7220  a new object or 
+000179b0: 6120 6d6f 6469 6669 6361 7469 6f6e 2074  a modification t
+000179c0: 6f20 6578 6973 7469 6e67 206f 626a 6563  o existing objec
+000179d0: 7420 7265 6665 7265 6e63 6564 2062 7920  t referenced by 
+000179e0: 7468 6520 7061 7261 6d73 0a20 2020 2020  the params.     
+000179f0: 2020 206f 6620 7468 6520 6675 6e63 7469     of the functi
+00017a00: 6f6e 2e0a 0a20 2020 2020 2020 203a 7061  on...        :pa
+00017a10: 7261 6d20 6665 6174 7572 655f 7665 6374  ram feature_vect
+00017a20: 6f72 3a20 5468 6520 3a70 793a 636c 6173  or: The :py:clas
+00017a30: 733a 607e 6d6c 7275 6e2e 6665 6174 7572  s:`~mlrun.featur
+00017a40: 655f 7374 6f72 652e 4665 6174 7572 6556  e_store.FeatureV
+00017a50: 6563 746f 7260 2074 6f20 7374 6f72 652e  ector` to store.
+00017a60: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00017a70: 6e61 6d65 3a20 2020 204e 616d 6520 6f66  name:    Name of
+00017a80: 2066 6561 7475 7265 2076 6563 746f 722e   feature vector.
+00017a90: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00017aa0: 7072 6f6a 6563 743a 204e 616d 6520 6f66  project: Name of
+00017ab0: 2070 726f 6a65 6374 2074 6869 7320 6665   project this fe
+00017ac0: 6174 7572 652d 7665 6374 6f72 2062 656c  ature-vector bel
+00017ad0: 6f6e 6773 2074 6f2e 0a20 2020 2020 2020  ongs to..       
+00017ae0: 203a 7061 7261 6d20 7461 673a 2054 6865   :param tag: The
+00017af0: 2060 6074 6167 6060 206f 6620 7468 6520   ``tag`` of the 
+00017b00: 6f62 6a65 6374 2074 6f20 7265 706c 6163  object to replac
+00017b10: 6520 696e 2074 6865 2044 422c 2066 6f72  e in the DB, for
+00017b20: 2065 7861 6d70 6c65 2060 606c 6174 6573   example ``lates
+00017b30: 7460 602e 0a20 2020 2020 2020 203a 7061  t``..        :pa
+00017b40: 7261 6d20 7569 643a 2054 6865 2060 6075  ram uid: The ``u
+00017b50: 6964 6060 206f 6620 7468 6520 6f62 6a65  id`` of the obje
+00017b60: 6374 2074 6f20 7265 706c 6163 6520 696e  ct to replace in
+00017b70: 2074 6865 2044 422e 2049 6620 7573 696e   the DB. If usin
+00017b80: 6720 7468 6973 2070 6172 616d 6574 6572  g this parameter
+00017b90: 2c20 7468 6520 6d6f 6469 6669 6564 206f  , the modified o
+00017ba0: 626a 6563 740a 2020 2020 2020 2020 2020  bject.          
+00017bb0: 2020 6d75 7374 2068 6176 6520 7468 6520    must have the 
+00017bc0: 7361 6d65 2060 6075 6964 6060 206f 6620  same ``uid`` of 
+00017bd0: 7468 6520 7072 6576 696f 7573 6c79 2d65  the previously-e
+00017be0: 7869 7374 696e 6720 6f62 6a65 6374 2e20  xisting object. 
+00017bf0: 5468 6973 2063 616e 6e6f 7420 6265 2075  This cannot be u
+00017c00: 7365 6420 666f 7220 6e6f 6e2d 7665 7273  sed for non-vers
+00017c10: 696f 6e65 6420 6f62 6a65 6374 732e 0a20  ioned objects.. 
+00017c20: 2020 2020 2020 203a 7061 7261 6d20 7665         :param ve
+00017c30: 7273 696f 6e65 643a 2057 6865 7468 6572  rsioned: Whether
+00017c40: 2074 6f20 6d61 696e 7461 696e 2076 6572   to maintain ver
+00017c50: 7369 6f6e 7320 666f 7220 7468 6973 2066  sions for this f
+00017c60: 6561 7475 7265 2d76 6563 746f 722e 2041  eature-vector. A
+00017c70: 6c6c 2076 6572 7369 6f6e 7320 6f66 2061  ll versions of a
+00017c80: 2076 6572 7369 6f6e 6564 206f 626a 6563   versioned objec
+00017c90: 740a 2020 2020 2020 2020 2020 2020 7769  t.            wi
+00017ca0: 6c6c 2062 6520 6b65 7074 2069 6e20 7468  ll be kept in th
+00017cb0: 6520 4442 2061 6e64 2063 616e 2062 6520  e DB and can be 
+00017cc0: 7265 7472 6965 7665 6420 756e 7469 6c20  retrieved until 
+00017cd0: 6578 706c 6963 6974 6c79 2064 656c 6574  explicitly delet
+00017ce0: 6564 2e0a 2020 2020 2020 2020 3a72 6574  ed..        :ret
+00017cf0: 7572 6e73 3a20 5468 6520 3a70 793a 636c  urns: The :py:cl
+00017d00: 6173 733a 607e 6d6c 7275 6e2e 6665 6174  ass:`~mlrun.feat
+00017d10: 7572 655f 7374 6f72 652e 4665 6174 7572  ure_store.Featur
+00017d20: 6556 6563 746f 7260 206f 626a 6563 7420  eVector` object 
+00017d30: 2861 7320 6469 6374 292e 0a20 2020 2020  (as dict)..     
+00017d40: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
+00017d50: 7265 6665 7265 6e63 6520 3d20 7365 6c66  reference = self
+00017d60: 2e5f 7265 736f 6c76 655f 7265 6665 7265  ._resolve_refere
+00017d70: 6e63 6528 7461 672c 2075 6964 290a 2020  nce(tag, uid).  
+00017d80: 2020 2020 2020 7061 7261 6d73 203d 207b        params = {
+00017d90: 2276 6572 7369 6f6e 6564 223a 2076 6572  "versioned": ver
+00017da0: 7369 6f6e 6564 7d0a 0a20 2020 2020 2020  sioned}..       
+00017db0: 2069 6620 6973 696e 7374 616e 6365 2866   if isinstance(f
+00017dc0: 6561 7475 7265 5f76 6563 746f 722c 206d  eature_vector, m
+00017dd0: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
+00017de0: 6d61 732e 4665 6174 7572 6556 6563 746f  mas.FeatureVecto
+00017df0: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
+00017e00: 6665 6174 7572 655f 7665 6374 6f72 203d  feature_vector =
+00017e10: 2066 6561 7475 7265 5f76 6563 746f 722e   feature_vector.
+00017e20: 6469 6374 2829 0a20 2020 2020 2020 2065  dict().        e
+00017e30: 6c69 6620 6973 696e 7374 616e 6365 2866  lif isinstance(f
+00017e40: 6561 7475 7265 5f76 6563 746f 722c 2046  eature_vector, F
+00017e50: 6561 7475 7265 5665 6374 6f72 293a 0a20  eatureVector):. 
+00017e60: 2020 2020 2020 2020 2020 2066 6561 7475             featu
+00017e70: 7265 5f76 6563 746f 7220 3d20 6665 6174  re_vector = feat
+00017e80: 7572 655f 7665 6374 6f72 2e74 6f5f 6469  ure_vector.to_di
+00017e90: 6374 2829 0a0a 2020 2020 2020 2020 6e61  ct()..        na
+00017ea0: 6d65 203d 206e 616d 6520 6f72 2066 6561  me = name or fea
+00017eb0: 7475 7265 5f76 6563 746f 725b 226d 6574  ture_vector["met
+00017ec0: 6164 6174 6122 5d5b 226e 616d 6522 5d0a  adata"]["name"].
+00017ed0: 2020 2020 2020 2020 7072 6f6a 6563 7420          project 
+00017ee0: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
+00017ef0: 7072 6f6a 6563 740a 2020 2020 2020 2020  project.        
+00017f00: 2020 2020 6f72 2066 6561 7475 7265 5f76      or feature_v
+00017f10: 6563 746f 725b 226d 6574 6164 6174 6122  ector["metadata"
+00017f20: 5d2e 6765 7428 2270 726f 6a65 6374 2229  ].get("project")
+00017f30: 0a20 2020 2020 2020 2020 2020 206f 7220  .            or 
+00017f40: 636f 6e66 6967 2e64 6566 6175 6c74 5f70  config.default_p
+00017f50: 726f 6a65 6374 0a20 2020 2020 2020 2029  roject.        )
+00017f60: 0a20 2020 2020 2020 2070 6174 6820 3d20  .        path = 
+00017f70: 6622 7072 6f6a 6563 7473 2f7b 7072 6f6a  f"projects/{proj
+00017f80: 6563 747d 2f66 6561 7475 7265 2d76 6563  ect}/feature-vec
+00017f90: 746f 7273 2f7b 6e61 6d65 7d2f 7265 6665  tors/{name}/refe
+00017fa0: 7265 6e63 6573 2f7b 7265 6665 7265 6e63  rences/{referenc
+00017fb0: 657d 220a 2020 2020 2020 2020 6572 726f  e}".        erro
+00017fc0: 725f 6d65 7373 6167 6520 3d20 6622 4661  r_message = f"Fa
+00017fd0: 696c 6564 2073 746f 7269 6e67 2066 6561  iled storing fea
+00017fe0: 7475 7265 2d76 6563 746f 7220 7b70 726f  ture-vector {pro
+00017ff0: 6a65 6374 7d2f 7b6e 616d 657d 220a 2020  ject}/{name}".  
+00018000: 2020 2020 2020 7265 7370 203d 2073 656c        resp = sel
+00018010: 662e 6170 695f 6361 6c6c 280a 2020 2020  f.api_call(.    
+00018020: 2020 2020 2020 2020 2250 5554 222c 2070          "PUT", p
+00018030: 6174 682c 2065 7272 6f72 5f6d 6573 7361  ath, error_messa
+00018040: 6765 2c20 7061 7261 6d73 3d70 6172 616d  ge, params=param
+00018050: 732c 2062 6f64 793d 6469 6374 5f74 6f5f  s, body=dict_to_
+00018060: 6a73 6f6e 2866 6561 7475 7265 5f76 6563  json(feature_vec
+00018070: 746f 7229 0a20 2020 2020 2020 2029 0a20  tor).        ). 
+00018080: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
+00018090: 7370 2e6a 736f 6e28 290a 0a20 2020 2064  sp.json()..    d
+000180a0: 6566 2070 6174 6368 5f66 6561 7475 7265  ef patch_feature
+000180b0: 5f76 6563 746f 7228 0a20 2020 2020 2020  _vector(.       
+000180c0: 2073 656c 662c 0a20 2020 2020 2020 206e   self,.        n
+000180d0: 616d 652c 0a20 2020 2020 2020 2066 6561  ame,.        fea
+000180e0: 7475 7265 5f76 6563 746f 725f 7570 6461  ture_vector_upda
+000180f0: 7465 3a20 6469 6374 2c0a 2020 2020 2020  te: dict,.      
+00018100: 2020 7072 6f6a 6563 743d 2222 2c0a 2020    project="",.  
+00018110: 2020 2020 2020 7461 673d 4e6f 6e65 2c0a        tag=None,.
+00018120: 2020 2020 2020 2020 7569 643d 4e6f 6e65          uid=None
+00018130: 2c0a 2020 2020 2020 2020 7061 7463 685f  ,.        patch_
+00018140: 6d6f 6465 3a20 556e 696f 6e5b 0a20 2020  mode: Union[.   
+00018150: 2020 2020 2020 2020 2073 7472 2c20 6d6c           str, ml
+00018160: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
+00018170: 6173 2e50 6174 6368 4d6f 6465 0a20 2020  as.PatchMode.   
+00018180: 2020 2020 205d 203d 206d 6c72 756e 2e63       ] = mlrun.c
+00018190: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 5061  ommon.schemas.Pa
+000181a0: 7463 684d 6f64 652e 7265 706c 6163 652c  tchMode.replace,
+000181b0: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
+000181c0: 2222 224d 6f64 6966 7920 2870 6174 6368  """Modify (patch
+000181d0: 2920 616e 2065 7869 7374 696e 6720 3a70  ) an existing :p
+000181e0: 793a 636c 6173 733a 607e 6d6c 7275 6e2e  y:class:`~mlrun.
+000181f0: 6665 6174 7572 655f 7374 6f72 652e 4665  feature_store.Fe
+00018200: 6174 7572 6556 6563 746f 7260 206f 626a  atureVector` obj
+00018210: 6563 742e 0a20 2020 2020 2020 2054 6865  ect..        The
+00018220: 206f 626a 6563 7420 6973 2069 6465 6e74   object is ident
+00018230: 6966 6965 6420 6279 2069 7473 206e 616d  ified by its nam
+00018240: 6520 2861 6e64 2070 726f 6a65 6374 2069  e (and project i
+00018250: 7420 6265 6c6f 6e67 7320 746f 292c 2061  t belongs to), a
+00018260: 7320 7765 6c6c 2061 7320 6f70 7469 6f6e  s well as option
+00018270: 616c 6c79 2061 2060 6074 6167 6060 206f  ally a ``tag`` o
+00018280: 7220 6974 730a 2020 2020 2020 2020 6060  r its.        ``
+00018290: 7569 6460 6020 2866 6f72 2076 6572 7369  uid`` (for versi
+000182a0: 6f6e 6564 206f 626a 6563 7429 2e20 4966  oned object). If
+000182b0: 2062 6f74 6820 6060 7461 6760 6020 616e   both ``tag`` an
+000182c0: 6420 6060 7569 6460 6020 6172 6520 6f6d  d ``uid`` are om
+000182d0: 6974 7465 6420 7468 656e 2074 6865 206f  itted then the o
+000182e0: 626a 6563 7420 7769 7468 2074 6167 2060  bject with tag `
+000182f0: 606c 6174 6573 7460 600a 2020 2020 2020  `latest``.      
+00018300: 2020 6973 206d 6f64 6966 6965 642e 0a0a    is modified...
+00018310: 2020 2020 2020 2020 3a70 6172 616d 206e          :param n
+00018320: 616d 653a 204e 616d 6520 6f66 2074 6865  ame: Name of the
+00018330: 206f 626a 6563 7420 746f 2070 6174 6368   object to patch
+00018340: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00018350: 2066 6561 7475 7265 5f76 6563 746f 725f   feature_vector_
+00018360: 7570 6461 7465 3a20 5468 6520 6d6f 6469  update: The modi
+00018370: 6669 6361 7469 6f6e 7320 6e65 6564 6564  fications needed
+00018380: 2069 6e20 7468 6520 6f62 6a65 6374 2e20   in the object. 
+00018390: 5468 6973 2070 6172 616d 6574 6572 206f  This parameter o
+000183a0: 6e6c 7920 6861 7320 7468 6520 6368 616e  nly has the chan
+000183b0: 6765 7320 696e 2069 742c 0a20 2020 2020  ges in it,.     
+000183c0: 2020 2020 2020 206e 6f74 2061 2066 756c         not a ful
+000183d0: 6c20 6f62 6a65 6374 2e0a 2020 2020 2020  l object..      
+000183e0: 2020 3a70 6172 616d 2070 726f 6a65 6374    :param project
+000183f0: 3a20 5072 6f6a 6563 7420 7768 6963 6820  : Project which 
+00018400: 636f 6e74 6169 6e73 2074 6865 206d 6f64  contains the mod
+00018410: 6966 6965 6420 6f62 6a65 6374 2e0a 2020  ified object..  
+00018420: 2020 2020 2020 3a70 6172 616d 2074 6167        :param tag
+00018430: 3a20 5468 6520 7461 6720 6f66 2074 6865  : The tag of the
+00018440: 206f 626a 6563 7420 746f 206d 6f64 6966   object to modif
+00018450: 792e 0a20 2020 2020 2020 203a 7061 7261  y..        :para
+00018460: 6d20 7569 643a 2075 6964 206f 6620 7468  m uid: uid of th
+00018470: 6520 6f62 6a65 6374 2074 6f20 6d6f 6469  e object to modi
+00018480: 6679 2e0a 2020 2020 2020 2020 3a70 6172  fy..        :par
+00018490: 616d 2070 6174 6368 5f6d 6f64 653a 2054  am patch_mode: T
+000184a0: 6865 2073 7472 6174 6567 7920 666f 7220  he strategy for 
+000184b0: 6d65 7267 696e 6720 7468 6520 6368 616e  merging the chan
+000184c0: 6765 7320 7769 7468 2074 6865 2065 7869  ges with the exi
+000184d0: 7374 696e 6720 6f62 6a65 6374 2e20 4361  sting object. Ca
+000184e0: 6e20 6265 2065 6974 6865 7220 6060 7265  n be either ``re
+000184f0: 706c 6163 6560 600a 2020 2020 2020 2020  place``.        
+00018500: 2020 2020 6f72 2060 6061 6464 6974 6976      or ``additiv
+00018510: 6560 602e 0a20 2020 2020 2020 2022 2222  e``..        """
+00018520: 0a20 2020 2020 2020 2072 6566 6572 656e  .        referen
+00018530: 6365 203d 2073 656c 662e 5f72 6573 6f6c  ce = self._resol
+00018540: 7665 5f72 6566 6572 656e 6365 2874 6167  ve_reference(tag
+00018550: 2c20 7569 6429 0a20 2020 2020 2020 2070  , uid).        p
+00018560: 726f 6a65 6374 203d 2070 726f 6a65 6374  roject = project
+00018570: 206f 7220 636f 6e66 6967 2e64 6566 6175   or config.defau
+00018580: 6c74 5f70 726f 6a65 6374 0a20 2020 2020  lt_project.     
+00018590: 2020 2068 6561 6465 7273 203d 207b 6d6c     headers = {ml
+000185a0: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
+000185b0: 6173 2e48 6561 6465 724e 616d 6573 2e70  as.HeaderNames.p
+000185c0: 6174 6368 5f6d 6f64 653a 2070 6174 6368  atch_mode: patch
+000185d0: 5f6d 6f64 657d 0a20 2020 2020 2020 2070  _mode}.        p
+000185e0: 6174 6820 3d20 6622 7072 6f6a 6563 7473  ath = f"projects
+000185f0: 2f7b 7072 6f6a 6563 747d 2f66 6561 7475  /{project}/featu
+00018600: 7265 2d76 6563 746f 7273 2f7b 6e61 6d65  re-vectors/{name
+00018610: 7d2f 7265 6665 7265 6e63 6573 2f7b 7265  }/references/{re
+00018620: 6665 7265 6e63 657d 220a 2020 2020 2020  ference}".      
+00018630: 2020 6572 726f 725f 6d65 7373 6167 6520    error_message 
+00018640: 3d20 6622 4661 696c 6564 2075 7064 6174  = f"Failed updat
+00018650: 696e 6720 6665 6174 7572 652d 7665 6374  ing feature-vect
+00018660: 6f72 207b 7072 6f6a 6563 747d 2f7b 6e61  or {project}/{na
+00018670: 6d65 7d22 0a20 2020 2020 2020 2073 656c  me}".        sel
+00018680: 662e 6170 695f 6361 6c6c 280a 2020 2020  f.api_call(.    
+00018690: 2020 2020 2020 2020 2250 4154 4348 222c          "PATCH",
+000186a0: 0a20 2020 2020 2020 2020 2020 2070 6174  .            pat
+000186b0: 682c 0a20 2020 2020 2020 2020 2020 2065  h,.            e
+000186c0: 7272 6f72 5f6d 6573 7361 6765 2c0a 2020  rror_message,.  
+000186d0: 2020 2020 2020 2020 2020 626f 6479 3d64            body=d
+000186e0: 6963 745f 746f 5f6a 736f 6e28 6665 6174  ict_to_json(feat
+000186f0: 7572 655f 7665 6374 6f72 5f75 7064 6174  ure_vector_updat
+00018700: 6529 2c0a 2020 2020 2020 2020 2020 2020  e),.            
+00018710: 6865 6164 6572 733d 6865 6164 6572 732c  headers=headers,
+00018720: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+00018730: 6465 6620 6465 6c65 7465 5f66 6561 7475  def delete_featu
+00018740: 7265 5f76 6563 746f 7228 7365 6c66 2c20  re_vector(self, 
+00018750: 6e61 6d65 2c20 7072 6f6a 6563 743d 2222  name, project=""
+00018760: 2c20 7461 673d 4e6f 6e65 2c20 7569 643d  , tag=None, uid=
+00018770: 4e6f 6e65 293a 0a20 2020 2020 2020 2022  None):.        "
+00018780: 2222 4465 6c65 7465 2061 203a 7079 3a63  ""Delete a :py:c
+00018790: 6c61 7373 3a60 7e6d 6c72 756e 2e66 6561  lass:`~mlrun.fea
+000187a0: 7475 7265 5f73 746f 7265 2e46 6561 7475  ture_store.Featu
+000187b0: 7265 5665 6374 6f72 6020 6f62 6a65 6374  reVector` object
+000187c0: 2066 726f 6d20 7468 6520 4442 2e0a 2020   from the DB..  
+000187d0: 2020 2020 2020 4966 2060 6074 6167 6060        If ``tag``
+000187e0: 206f 7220 6060 7569 6460 6020 6172 6520   or ``uid`` are 
+000187f0: 7370 6563 6966 6965 642c 2074 6865 6e20  specified, then 
+00018800: 6a75 7374 2074 6865 2076 6572 7369 6f6e  just the version
+00018810: 2072 6566 6572 656e 6365 6420 6279 2074   referenced by t
+00018820: 6865 6d20 7769 6c6c 2062 6520 6465 6c65  hem will be dele
+00018830: 7465 642e 2055 7369 6e67 2062 6f74 680a  ted. Using both.
+00018840: 2020 2020 2020 2020 6973 206e 6f74 2061          is not a
+00018850: 6c6c 6f77 6564 2e0a 2020 2020 2020 2020  llowed..        
+00018860: 4966 206e 6f6e 6520 6172 6520 7370 6563  If none are spec
+00018870: 6966 6965 642c 2074 6865 6e20 616c 6c20  ified, then all 
+00018880: 696e 7374 616e 6365 7320 6f66 2074 6865  instances of the
+00018890: 206f 626a 6563 7420 7768 6f73 6520 6e61   object whose na
+000188a0: 6d65 2069 7320 6060 6e61 6d65 6060 2077  me is ``name`` w
+000188b0: 696c 6c20 6265 2064 656c 6574 6564 2e0a  ill be deleted..
+000188c0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+000188d0: 2020 2020 7072 6f6a 6563 7420 3d20 7072      project = pr
+000188e0: 6f6a 6563 7420 6f72 2063 6f6e 6669 672e  oject or config.
+000188f0: 6465 6661 756c 745f 7072 6f6a 6563 740a  default_project.
+00018900: 2020 2020 2020 2020 7061 7468 203d 2066          path = f
+00018910: 2270 726f 6a65 6374 732f 7b70 726f 6a65  "projects/{proje
+00018920: 6374 7d2f 6665 6174 7572 652d 7665 6374  ct}/feature-vect
+00018930: 6f72 732f 7b6e 616d 657d 220a 2020 2020  ors/{name}".    
+00018940: 2020 2020 6966 2074 6167 206f 7220 7569      if tag or ui
+00018950: 643a 0a20 2020 2020 2020 2020 2020 2072  d:.            r
+00018960: 6566 6572 656e 6365 203d 2073 656c 662e  eference = self.
+00018970: 5f72 6573 6f6c 7665 5f72 6566 6572 656e  _resolve_referen
+00018980: 6365 2874 6167 2c20 7569 6429 0a20 2020  ce(tag, uid).   
+00018990: 2020 2020 2020 2020 2070 6174 6820 3d20           path = 
+000189a0: 7061 7468 202b 2066 222f 7265 6665 7265  path + f"/refere
+000189b0: 6e63 6573 2f7b 7265 6665 7265 6e63 657d  nces/{reference}
+000189c0: 220a 0a20 2020 2020 2020 2065 7272 6f72  "..        error
+000189d0: 5f6d 6573 7361 6765 203d 2066 2246 6169  _message = f"Fai
+000189e0: 6c65 6420 6465 6c65 7469 6e67 2066 6561  led deleting fea
+000189f0: 7475 7265 2d76 6563 746f 7220 7b6e 616d  ture-vector {nam
+00018a00: 657d 220a 2020 2020 2020 2020 7365 6c66  e}".        self
+00018a10: 2e61 7069 5f63 616c 6c28 2244 454c 4554  .api_call("DELET
+00018a20: 4522 2c20 7061 7468 2c20 6572 726f 725f  E", path, error_
+00018a30: 6d65 7373 6167 6529 0a0a 2020 2020 6465  message)..    de
+00018a40: 6620 7461 675f 6f62 6a65 6374 7328 0a20  f tag_objects(. 
+00018a50: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+00018a60: 2020 2020 2070 726f 6a65 6374 3a20 7374       project: st
+00018a70: 722c 0a20 2020 2020 2020 2074 6167 5f6e  r,.        tag_n
+00018a80: 616d 653a 2073 7472 2c0a 2020 2020 2020  ame: str,.      
+00018a90: 2020 6f62 6a65 6374 733a 2055 6e69 6f6e    objects: Union
+00018aa0: 5b6d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363  [mlrun.common.sc
+00018ab0: 6865 6d61 732e 5461 674f 626a 6563 7473  hemas.TagObjects
+00018ac0: 2c20 6469 6374 5d2c 0a20 2020 2020 2020  , dict],.       
+00018ad0: 2072 6570 6c61 6365 3a20 626f 6f6c 203d   replace: bool =
+00018ae0: 2046 616c 7365 2c0a 2020 2020 293a 0a20   False,.    ):. 
+00018af0: 2020 2020 2020 2022 2222 5461 6720 6120         """Tag a 
+00018b00: 6c69 7374 206f 6620 6f62 6a65 6374 732e  list of objects.
+00018b10: 0a0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00018b20: 2070 726f 6a65 6374 3a20 5072 6f6a 6563   project: Projec
+00018b30: 7420 7768 6963 6820 636f 6e74 6169 6e73  t which contains
+00018b40: 2074 6865 206f 626a 6563 7473 2e0a 2020   the objects..  
+00018b50: 2020 2020 2020 3a70 6172 616d 2074 6167        :param tag
+00018b60: 5f6e 616d 653a 2054 6865 2074 6167 2074  _name: The tag t
+00018b70: 6f20 7365 7420 6f6e 2074 6865 206f 626a  o set on the obj
+00018b80: 6563 7473 2e0a 2020 2020 2020 2020 3a70  ects..        :p
+00018b90: 6172 616d 206f 626a 6563 7473 3a20 5468  aram objects: Th
+00018ba0: 6520 6f62 6a65 6374 7320 746f 2074 6167  e objects to tag
+00018bb0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+00018bc0: 2072 6570 6c61 6365 3a20 5768 6574 6865   replace: Whethe
+00018bd0: 7220 746f 2072 6570 6c61 6365 2074 6865  r to replace the
+00018be0: 2065 7869 7374 696e 6720 7461 6773 206f   existing tags o
+00018bf0: 6620 7468 6520 6f62 6a65 6374 7320 6f72  f the objects or
+00018c00: 2074 6f20 6164 6420 7468 6520 6e65 7720   to add the new 
+00018c10: 7461 6720 746f 2074 6865 6d2e 0a20 2020  tag to them..   
+00018c20: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
+00018c30: 2020 7061 7468 203d 2066 2270 726f 6a65    path = f"proje
+00018c40: 6374 732f 7b70 726f 6a65 6374 7d2f 7461  cts/{project}/ta
+00018c50: 6773 2f7b 7461 675f 6e61 6d65 7d22 0a20  gs/{tag_name}". 
+00018c60: 2020 2020 2020 2065 7272 6f72 5f6d 6573         error_mes
+00018c70: 7361 6765 203d 2066 2246 6169 6c65 6420  sage = f"Failed 
+00018c80: 746f 2074 6167 207b 7461 675f 6e61 6d65  to tag {tag_name
+00018c90: 7d20 6f6e 206f 626a 6563 7473 207b 6f62  } on objects {ob
+00018ca0: 6a65 6374 737d 220a 2020 2020 2020 2020  jects}".        
+00018cb0: 6d65 7468 6f64 203d 2022 504f 5354 2220  method = "POST" 
+00018cc0: 6966 2072 6570 6c61 6365 2065 6c73 6520  if replace else 
+00018cd0: 2250 5554 220a 2020 2020 2020 2020 7365  "PUT".        se
+00018ce0: 6c66 2e61 7069 5f63 616c 6c28 0a20 2020  lf.api_call(.   
+00018cf0: 2020 2020 2020 2020 206d 6574 686f 642c           method,
+00018d00: 0a20 2020 2020 2020 2020 2020 2070 6174  .            pat
+00018d10: 682c 0a20 2020 2020 2020 2020 2020 2065  h,.            e
+00018d20: 7272 6f72 5f6d 6573 7361 6765 2c0a 2020  rror_message,.  
+00018d30: 2020 2020 2020 2020 2020 626f 6479 3d64            body=d
+00018d40: 6963 745f 746f 5f6a 736f 6e28 0a20 2020  ict_to_json(.   
+00018d50: 2020 2020 2020 2020 2020 2020 206f 626a               obj
+00018d60: 6563 7473 2e64 6963 7428 290a 2020 2020  ects.dict().    
+00018d70: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+00018d80: 7369 6e73 7461 6e63 6528 6f62 6a65 6374  sinstance(object
+00018d90: 732c 206d 6c72 756e 2e63 6f6d 6d6f 6e2e  s, mlrun.common.
+00018da0: 7363 6865 6d61 732e 5461 674f 626a 6563  schemas.TagObjec
+00018db0: 7473 290a 2020 2020 2020 2020 2020 2020  ts).            
+00018dc0: 2020 2020 656c 7365 206f 626a 6563 7473      else objects
+00018dd0: 0a20 2020 2020 2020 2020 2020 2029 2c0a  .            ),.
+00018de0: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
+00018df0: 6566 2064 656c 6574 655f 6f62 6a65 6374  ef delete_object
+00018e00: 735f 7461 6728 0a20 2020 2020 2020 2073  s_tag(.        s
+00018e10: 656c 662c 0a20 2020 2020 2020 2070 726f  elf,.        pro
+00018e20: 6a65 6374 3a20 7374 722c 0a20 2020 2020  ject: str,.     
+00018e30: 2020 2074 6167 5f6e 616d 653a 2073 7472     tag_name: str
+00018e40: 2c0a 2020 2020 2020 2020 7461 675f 6f62  ,.        tag_ob
+00018e50: 6a65 6374 733a 2055 6e69 6f6e 5b6d 6c72  jects: Union[mlr
+00018e60: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+00018e70: 732e 5461 674f 626a 6563 7473 2c20 6469  s.TagObjects, di
+00018e80: 6374 5d2c 0a20 2020 2029 3a0a 2020 2020  ct],.    ):.    
+00018e90: 2020 2020 2222 2244 656c 6574 6520 6120      """Delete a 
+00018ea0: 7461 6720 6672 6f6d 2061 206c 6973 7420  tag from a list 
+00018eb0: 6f66 206f 626a 6563 7473 2e0a 0a20 2020  of objects...   
+00018ec0: 2020 2020 203a 7061 7261 6d20 7072 6f6a       :param proj
+00018ed0: 6563 743a 2050 726f 6a65 6374 2077 6869  ect: Project whi
+00018ee0: 6368 2063 6f6e 7461 696e 7320 7468 6520  ch contains the 
+00018ef0: 6f62 6a65 6374 732e 0a20 2020 2020 2020  objects..       
+00018f00: 203a 7061 7261 6d20 7461 675f 6e61 6d65   :param tag_name
+00018f10: 3a20 5468 6520 7461 6720 746f 2064 656c  : The tag to del
+00018f20: 6574 6520 6672 6f6d 2074 6865 206f 626a  ete from the obj
+00018f30: 6563 7473 2e0a 2020 2020 2020 2020 3a70  ects..        :p
+00018f40: 6172 616d 2074 6167 5f6f 626a 6563 7473  aram tag_objects
+00018f50: 3a20 5468 6520 6f62 6a65 6374 7320 746f  : The objects to
+00018f60: 2064 656c 6574 6520 7468 6520 7461 6720   delete the tag 
+00018f70: 6672 6f6d 2e0a 0a20 2020 2020 2020 2022  from...        "
+00018f80: 2222 0a20 2020 2020 2020 2070 6174 6820  "".        path 
+00018f90: 3d20 6622 7072 6f6a 6563 7473 2f7b 7072  = f"projects/{pr
+00018fa0: 6f6a 6563 747d 2f74 6167 732f 7b74 6167  oject}/tags/{tag
+00018fb0: 5f6e 616d 657d 220a 2020 2020 2020 2020  _name}".        
+00018fc0: 6572 726f 725f 6d65 7373 6167 6520 3d20  error_message = 
+00018fd0: 6622 4661 696c 6564 2064 656c 6574 696e  f"Failed deletin
+00018fe0: 6720 7461 6720 6672 6f6d 207b 7461 675f  g tag from {tag_
+00018ff0: 6e61 6d65 7d22 0a20 2020 2020 2020 2073  name}".        s
+00019000: 656c 662e 6170 695f 6361 6c6c 280a 2020  elf.api_call(.  
+00019010: 2020 2020 2020 2020 2020 2244 454c 4554            "DELET
+00019020: 4522 2c0a 2020 2020 2020 2020 2020 2020  E",.            
+00019030: 7061 7468 2c0a 2020 2020 2020 2020 2020  path,.          
+00019040: 2020 6572 726f 725f 6d65 7373 6167 652c    error_message,
+00019050: 0a20 2020 2020 2020 2020 2020 2062 6f64  .            bod
+00019060: 793d 6469 6374 5f74 6f5f 6a73 6f6e 280a  y=dict_to_json(.
+00019070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019080: 7461 675f 6f62 6a65 6374 732e 6469 6374  tag_objects.dict
+00019090: 2829 0a20 2020 2020 2020 2020 2020 2020  ().             
+000190a0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+000190b0: 2874 6167 5f6f 626a 6563 7473 2c20 6d6c  (tag_objects, ml
+000190c0: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
+000190d0: 6173 2e54 6167 4f62 6a65 6374 7329 0a20  as.TagObjects). 
+000190e0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+000190f0: 6c73 6520 7461 675f 6f62 6a65 6374 730a  lse tag_objects.
+00019100: 2020 2020 2020 2020 2020 2020 292c 0a20              ),. 
+00019110: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
+00019120: 6620 7461 675f 6172 7469 6661 6374 7328  f tag_artifacts(
+00019130: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+00019140: 2020 2020 2020 2061 7274 6966 6163 7473         artifacts
+00019150: 3a20 556e 696f 6e5b 6c69 7374 5b41 7274  : Union[list[Art
+00019160: 6966 6163 745d 2c20 6c69 7374 5b64 6963  ifact], list[dic
+00019170: 745d 2c20 4172 7469 6661 6374 2c20 6469  t], Artifact, di
+00019180: 6374 5d2c 0a20 2020 2020 2020 2070 726f  ct],.        pro
+00019190: 6a65 6374 3a20 7374 722c 0a20 2020 2020  ject: str,.     
+000191a0: 2020 2074 6167 5f6e 616d 653a 2073 7472     tag_name: str
+000191b0: 2c0a 2020 2020 2020 2020 7265 706c 6163  ,.        replac
+000191c0: 653a 2062 6f6f 6c20 3d20 4661 6c73 652c  e: bool = False,
+000191d0: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
+000191e0: 2222 2254 6167 2061 206c 6973 7420 6f66  """Tag a list of
+000191f0: 2061 7274 6966 6163 7473 2e0a 0a20 2020   artifacts...   
+00019200: 2020 2020 203a 7061 7261 6d20 6172 7469       :param arti
+00019210: 6661 6374 733a 2054 6865 2061 7274 6966  facts: The artif
+00019220: 6163 7473 2074 6f20 7461 672e 2043 616e  acts to tag. Can
+00019230: 2062 6520 6120 6c69 7374 206f 6620 3a70   be a list of :p
+00019240: 793a 636c 6173 733a 607e 6d6c 7275 6e2e  y:class:`~mlrun.
+00019250: 6172 7469 6661 6374 732e 4172 7469 6661  artifacts.Artifa
+00019260: 6374 6020 6f62 6a65 6374 7320 6f72 0a20  ct` objects or. 
+00019270: 2020 2020 2020 2020 2020 2064 6963 7469             dicti
+00019280: 6f6e 6172 6965 732c 206f 7220 6120 7369  onaries, or a si
+00019290: 6e67 6c65 206f 626a 6563 742e 0a20 2020  ngle object..   
+000192a0: 2020 2020 203a 7061 7261 6d20 7072 6f6a       :param proj
+000192b0: 6563 743a 2050 726f 6a65 6374 2077 6869  ect: Project whi
+000192c0: 6368 2063 6f6e 7461 696e 7320 7468 6520  ch contains the 
+000192d0: 6172 7469 6661 6374 732e 0a20 2020 2020  artifacts..     
+000192e0: 2020 203a 7061 7261 6d20 7461 675f 6e61     :param tag_na
+000192f0: 6d65 3a20 5468 6520 7461 6720 746f 2073  me: The tag to s
+00019300: 6574 206f 6e20 7468 6520 6172 7469 6661  et on the artifa
+00019310: 6374 732e 0a20 2020 2020 2020 203a 7061  cts..        :pa
+00019320: 7261 6d20 7265 706c 6163 653a 2049 6620  ram replace: If 
+00019330: 5472 7565 2c20 7265 706c 6163 6520 6578  True, replace ex
+00019340: 6973 7469 6e67 2074 6167 732c 206f 7468  isting tags, oth
+00019350: 6572 7769 7365 2061 7070 656e 6420 746f  erwise append to
+00019360: 2065 7869 7374 696e 6720 7461 6773 2e0a   existing tags..
+00019370: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00019380: 2020 2020 7461 675f 6f62 6a65 6374 7320      tag_objects 
+00019390: 3d20 7365 6c66 2e5f 7265 736f 6c76 655f  = self._resolve_
+000193a0: 6172 7469 6661 6374 735f 746f 5f74 6167  artifacts_to_tag
+000193b0: 5f6f 626a 6563 7473 2861 7274 6966 6163  _objects(artifac
+000193c0: 7473 290a 2020 2020 2020 2020 7365 6c66  ts).        self
+000193d0: 2e74 6167 5f6f 626a 6563 7473 2870 726f  .tag_objects(pro
+000193e0: 6a65 6374 2c20 7461 675f 6e61 6d65 2c20  ject, tag_name, 
+000193f0: 6f62 6a65 6374 733d 7461 675f 6f62 6a65  objects=tag_obje
+00019400: 6374 732c 2072 6570 6c61 6365 3d72 6570  cts, replace=rep
+00019410: 6c61 6365 290a 0a20 2020 2064 6566 2064  lace)..    def d
+00019420: 656c 6574 655f 6172 7469 6661 6374 735f  elete_artifacts_
+00019430: 7461 6773 280a 2020 2020 2020 2020 7365  tags(.        se
+00019440: 6c66 2c0a 2020 2020 2020 2020 6172 7469  lf,.        arti
+00019450: 6661 6374 732c 0a20 2020 2020 2020 2070  facts,.        p
+00019460: 726f 6a65 6374 3a20 7374 722c 0a20 2020  roject: str,.   
+00019470: 2020 2020 2074 6167 5f6e 616d 653a 2073       tag_name: s
+00019480: 7472 2c0a 2020 2020 293a 0a20 2020 2020  tr,.    ):.     
+00019490: 2020 2022 2222 4465 6c65 7465 2074 6167     """Delete tag
+000194a0: 2066 726f 6d20 6120 6c69 7374 206f 6620   from a list of 
+000194b0: 6172 7469 6661 6374 732e 0a0a 2020 2020  artifacts...    
+000194c0: 2020 2020 3a70 6172 616d 2061 7274 6966      :param artif
+000194d0: 6163 7473 3a20 5468 6520 6172 7469 6661  acts: The artifa
+000194e0: 6374 7320 746f 2064 656c 6574 6520 7468  cts to delete th
+000194f0: 6520 7461 6720 6672 6f6d 2e20 4361 6e20  e tag from. Can 
+00019500: 6265 2061 206c 6973 7420 6f66 203a 7079  be a list of :py
+00019510: 3a63 6c61 7373 3a60 7e6d 6c72 756e 2e61  :class:`~mlrun.a
+00019520: 7274 6966 6163 7473 2e41 7274 6966 6163  rtifacts.Artifac
+00019530: 7460 0a20 2020 2020 2020 2020 2020 206f  t`.            o
+00019540: 626a 6563 7473 206f 7220 6469 6374 696f  bjects or dictio
+00019550: 6e61 7269 6573 2c20 6f72 2061 2073 696e  naries, or a sin
+00019560: 676c 6520 6f62 6a65 6374 2e0a 2020 2020  gle object..    
+00019570: 2020 2020 3a70 6172 616d 2070 726f 6a65      :param proje
+00019580: 6374 3a20 5072 6f6a 6563 7420 7768 6963  ct: Project whic
+00019590: 6820 636f 6e74 6169 6e73 2074 6865 2061  h contains the a
+000195a0: 7274 6966 6163 7473 2e0a 2020 2020 2020  rtifacts..      
+000195b0: 2020 3a70 6172 616d 2074 6167 5f6e 616d    :param tag_nam
+000195c0: 653a 2054 6865 2074 6167 2074 6f20 7365  e: The tag to se
+000195d0: 7420 6f6e 2074 6865 2061 7274 6966 6163  t on the artifac
+000195e0: 7473 2e0a 2020 2020 2020 2020 2222 220a  ts..        """.
+000195f0: 2020 2020 2020 2020 7461 675f 6f62 6a65          tag_obje
+00019600: 6374 7320 3d20 7365 6c66 2e5f 7265 736f  cts = self._reso
+00019610: 6c76 655f 6172 7469 6661 6374 735f 746f  lve_artifacts_to
+00019620: 5f74 6167 5f6f 626a 6563 7473 2861 7274  _tag_objects(art
+00019630: 6966 6163 7473 290a 2020 2020 2020 2020  ifacts).        
+00019640: 7365 6c66 2e64 656c 6574 655f 6f62 6a65  self.delete_obje
+00019650: 6374 735f 7461 6728 7072 6f6a 6563 742c  cts_tag(project,
+00019660: 2074 6167 5f6e 616d 652c 2074 6167 5f6f   tag_name, tag_o
+00019670: 626a 6563 7473 290a 0a20 2020 2064 6566  bjects)..    def
+00019680: 206c 6973 745f 7072 6f6a 6563 7473 280a   list_projects(.
+00019690: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+000196a0: 2020 2020 2020 6f77 6e65 723a 2073 7472        owner: str
+000196b0: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+000196c0: 2066 6f72 6d61 745f 3a20 556e 696f 6e5b   format_: Union[
+000196d0: 0a20 2020 2020 2020 2020 2020 2073 7472  .            str
+000196e0: 2c20 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  , mlrun.common.s
+000196f0: 6368 656d 6173 2e50 726f 6a65 6374 7346  chemas.ProjectsF
+00019700: 6f72 6d61 740a 2020 2020 2020 2020 5d20  ormat.        ] 
+00019710: 3d20 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  = mlrun.common.s
+00019720: 6368 656d 6173 2e50 726f 6a65 6374 7346  chemas.ProjectsF
+00019730: 6f72 6d61 742e 6e61 6d65 5f6f 6e6c 792c  ormat.name_only,
+00019740: 0a20 2020 2020 2020 206c 6162 656c 733a  .        labels:
+00019750: 206c 6973 745b 7374 725d 203d 204e 6f6e   list[str] = Non
+00019760: 652c 0a20 2020 2020 2020 2073 7461 7465  e,.        state
+00019770: 3a20 556e 696f 6e5b 7374 722c 206d 6c72  : Union[str, mlr
+00019780: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+00019790: 732e 5072 6f6a 6563 7453 7461 7465 5d20  s.ProjectState] 
+000197a0: 3d20 4e6f 6e65 2c0a 2020 2020 2920 2d3e  = None,.    ) ->
+000197b0: 206c 6973 745b 556e 696f 6e5b 6d6c 7275   list[Union[mlru
+000197c0: 6e2e 7072 6f6a 6563 7473 2e4d 6c72 756e  n.projects.Mlrun
+000197d0: 5072 6f6a 6563 742c 2073 7472 5d5d 3a0a  Project, str]]:.
+000197e0: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
+000197f0: 6e20 6120 6c69 7374 206f 6620 7468 6520  n a list of the 
+00019800: 6578 6973 7469 6e67 2070 726f 6a65 6374  existing project
+00019810: 732c 2070 6f74 656e 7469 616c 6c79 2066  s, potentially f
+00019820: 696c 7465 7265 6420 6279 2073 7065 6369  iltered by speci
+00019830: 6669 6320 6372 6974 6572 6961 2e0a 0a20  fic criteria... 
+00019840: 2020 2020 2020 203a 7061 7261 6d20 6f77         :param ow
+00019850: 6e65 723a 204c 6973 7420 6f6e 6c79 2070  ner: List only p
+00019860: 726f 6a65 6374 7320 6265 6c6f 6e67 696e  rojects belongin
+00019870: 6720 746f 2074 6869 7320 7370 6563 6966  g to this specif
+00019880: 6963 206f 776e 6572 2e0a 2020 2020 2020  ic owner..      
+00019890: 2020 3a70 6172 616d 2066 6f72 6d61 745f    :param format_
+000198a0: 3a20 466f 726d 6174 206f 6620 7468 6520  : Format of the 
+000198b0: 7265 7375 6c74 732e 2050 6f73 7369 626c  results. Possibl
+000198c0: 6520 7661 6c75 6573 2061 7265 3a0a 0a20  e values are:.. 
+000198d0: 2020 2020 2020 2020 2020 202d 2060 606e             - ``n
+000198e0: 616d 655f 6f6e 6c79 6060 2028 6465 6661  ame_only`` (defa
+000198f0: 756c 7420 7661 6c75 6529 202d 2052 6574  ult value) - Ret
+00019900: 7572 6e20 6a75 7374 2074 6865 206e 616d  urn just the nam
+00019910: 6573 206f 6620 7468 6520 7072 6f6a 6563  es of the projec
+00019920: 7473 2e0a 2020 2020 2020 2020 2020 2020  ts..            
+00019930: 2d20 6060 6d69 6e69 6d61 6c60 6020 2d20  - ``minimal`` - 
+00019940: 5265 7475 726e 206d 696e 696d 616c 2070  Return minimal p
+00019950: 726f 6a65 6374 206f 626a 6563 7473 2028  roject objects (
+00019960: 6d69 6e69 6d69 7a61 7469 6f6e 2068 6170  minimization hap
+00019970: 7065 6e73 2069 6e20 7468 6520 4245 292e  pens in the BE).
+00019980: 0a20 2020 2020 2020 2020 2020 202d 2060  .            - `
+00019990: 6066 756c 6c60 6020 202d 2052 6574 7572  `full``  - Retur
+000199a0: 6e20 6675 6c6c 2070 726f 6a65 6374 206f  n full project o
+000199b0: 626a 6563 7473 2e0a 0a20 2020 2020 2020  bjects...       
+000199c0: 203a 7061 7261 6d20 6c61 6265 6c73 3a20   :param labels: 
+000199d0: 4669 6c74 6572 2062 7920 6c61 6265 6c73  Filter by labels
+000199e0: 2061 7474 6163 6865 6420 746f 2074 6865   attached to the
+000199f0: 2070 726f 6a65 6374 2e0a 2020 2020 2020   project..      
+00019a00: 2020 3a70 6172 616d 2073 7461 7465 3a20    :param state: 
+00019a10: 4669 6c74 6572 2062 7920 7072 6f6a 6563  Filter by projec
+00019a20: 7427 7320 7374 6174 652e 2043 616e 2062  t's state. Can b
+00019a30: 6520 6569 7468 6572 2060 606f 6e6c 696e  e either ``onlin
+00019a40: 6560 6020 6f72 2060 6061 7263 6869 7665  e`` or ``archive
+00019a50: 6460 602e 0a20 2020 2020 2020 2022 2222  d``..        """
+00019a60: 0a0a 2020 2020 2020 2020 7061 7261 6d73  ..        params
+00019a70: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
+00019a80: 2022 6f77 6e65 7222 3a20 6f77 6e65 722c   "owner": owner,
+00019a90: 0a20 2020 2020 2020 2020 2020 2022 7374  .            "st
+00019aa0: 6174 6522 3a20 7374 6174 652c 0a20 2020  ate": state,.   
+00019ab0: 2020 2020 2020 2020 2022 666f 726d 6174           "format
+00019ac0: 223a 2066 6f72 6d61 745f 2c0a 2020 2020  ": format_,.    
+00019ad0: 2020 2020 2020 2020 226c 6162 656c 223a          "label":
+00019ae0: 206c 6162 656c 7320 6f72 205b 5d2c 0a20   labels or [],. 
+00019af0: 2020 2020 2020 207d 0a0a 2020 2020 2020         }..      
+00019b00: 2020 6572 726f 725f 6d65 7373 6167 6520    error_message 
+00019b10: 3d20 6622 4661 696c 6564 206c 6973 7469  = f"Failed listi
+00019b20: 6e67 2070 726f 6a65 6374 732c 2071 7565  ng projects, que
+00019b30: 7279 3a20 7b70 6172 616d 737d 220a 2020  ry: {params}".  
+00019b40: 2020 2020 2020 7265 7370 6f6e 7365 203d        response =
+00019b50: 2073 656c 662e 6170 695f 6361 6c6c 2822   self.api_call("
+00019b60: 4745 5422 2c20 2270 726f 6a65 6374 7322  GET", "projects"
+00019b70: 2c20 6572 726f 725f 6d65 7373 6167 652c  , error_message,
+00019b80: 2070 6172 616d 733d 7061 7261 6d73 290a   params=params).
+00019b90: 2020 2020 2020 2020 6966 2066 6f72 6d61          if forma
+00019ba0: 745f 203d 3d20 6d6c 7275 6e2e 636f 6d6d  t_ == mlrun.comm
+00019bb0: 6f6e 2e73 6368 656d 6173 2e50 726f 6a65  on.schemas.Proje
+00019bc0: 6374 7346 6f72 6d61 742e 6e61 6d65 5f6f  ctsFormat.name_o
+00019bd0: 6e6c 793a 0a20 2020 2020 2020 2020 2020  nly:.           
+00019be0: 2023 2070 726f 6a65 6374 7320 6973 206a   # projects is j
+00019bf0: 7573 7420 6120 6c69 7374 206f 6620 7374  ust a list of st
+00019c00: 7269 6e67 730a 2020 2020 2020 2020 2020  rings.          
+00019c10: 2020 7265 7475 726e 2072 6573 706f 6e73    return respons
+00019c20: 652e 6a73 6f6e 2829 5b22 7072 6f6a 6563  e.json()["projec
+00019c30: 7473 225d 0a0a 2020 2020 2020 2020 2320  ts"]..        # 
+00019c40: 666f 7277 6172 6473 2063 6f6d 7061 7469  forwards compati
+00019c50: 6269 6c69 7479 202d 2077 6520 7761 6e74  bility - we want
+00019c60: 2074 6f20 6265 2061 626c 6520 746f 2068   to be able to h
+00019c70: 616e 646c 6520 6e65 7720 666f 726d 6174  andle new format
+00019c80: 7320 7468 6174 206d 6967 6874 2062 6520  s that might be 
+00019c90: 6164 6465 6420 696e 2074 6865 2066 7574  added in the fut
+00019ca0: 7572 650a 2020 2020 2020 2020 2320 6966  ure.        # if
+00019cb0: 2066 6f72 6d61 7420 6973 206e 6f74 206b   format is not k
+00019cc0: 6e6f 776e 2074 6f20 7468 6520 6170 692c  nown to the api,
+00019cd0: 2069 7420 6973 2075 7020 746f 2074 6865   it is up to the
+00019ce0: 2073 6572 7665 7220 746f 2072 6574 7572   server to retur
+00019cf0: 6e20 6569 7468 6572 2061 6e20 6572 726f  n either an erro
+00019d00: 7220 6f72 2061 2064 6566 6175 6c74 2066  r or a default f
+00019d10: 6f72 6d61 740a 2020 2020 2020 2020 7265  ormat.        re
+00019d20: 7475 726e 205b 0a20 2020 2020 2020 2020  turn [.         
+00019d30: 2020 206d 6c72 756e 2e70 726f 6a65 6374     mlrun.project
+00019d40: 732e 4d6c 7275 6e50 726f 6a65 6374 2e66  s.MlrunProject.f
+00019d50: 726f 6d5f 6469 6374 2870 726f 6a65 6374  rom_dict(project
+00019d60: 5f64 6963 7429 0a20 2020 2020 2020 2020  _dict).         
+00019d70: 2020 2066 6f72 2070 726f 6a65 6374 5f64     for project_d
+00019d80: 6963 7420 696e 2072 6573 706f 6e73 652e  ict in response.
+00019d90: 6a73 6f6e 2829 5b22 7072 6f6a 6563 7473  json()["projects
+00019da0: 225d 0a20 2020 2020 2020 205d 0a0a 2020  "].        ]..  
+00019db0: 2020 6465 6620 6765 745f 7072 6f6a 6563    def get_projec
+00019dc0: 7428 7365 6c66 2c20 6e61 6d65 3a20 7374  t(self, name: st
+00019dd0: 7229 202d 3e20 6d6c 7275 6e2e 7072 6f6a  r) -> mlrun.proj
+00019de0: 6563 7473 2e4d 6c72 756e 5072 6f6a 6563  ects.MlrunProjec
+00019df0: 743a 0a20 2020 2020 2020 2022 2222 4765  t:.        """Ge
+00019e00: 7420 6465 7461 696c 7320 666f 7220 6120  t details for a 
+00019e10: 7370 6563 6966 6963 2070 726f 6a65 6374  specific project
+00019e20: 2e22 2222 0a0a 2020 2020 2020 2020 6966  ."""..        if
+00019e30: 206e 6f74 206e 616d 653a 0a20 2020 2020   not name:.     
+00019e40: 2020 2020 2020 2072 6169 7365 204d 4c52         raise MLR
+00019e50: 756e 496e 7661 6c69 6441 7267 756d 656e  unInvalidArgumen
+00019e60: 7445 7272 6f72 2822 4e61 6d65 206d 7573  tError("Name mus
+00019e70: 7420 6265 2070 726f 7669 6465 6422 290a  t be provided").
+00019e80: 0a20 2020 2020 2020 2070 6174 6820 3d20  .        path = 
+00019e90: 6622 7072 6f6a 6563 7473 2f7b 6e61 6d65  f"projects/{name
+00019ea0: 7d22 0a20 2020 2020 2020 2065 7272 6f72  }".        error
+00019eb0: 5f6d 6573 7361 6765 203d 2066 2246 6169  _message = f"Fai
+00019ec0: 6c65 6420 7265 7472 6965 7669 6e67 2070  led retrieving p
+00019ed0: 726f 6a65 6374 207b 6e61 6d65 7d22 0a20  roject {name}". 
+00019ee0: 2020 2020 2020 2072 6573 706f 6e73 6520         response 
+00019ef0: 3d20 7365 6c66 2e61 7069 5f63 616c 6c28  = self.api_call(
+00019f00: 2247 4554 222c 2070 6174 682c 2065 7272  "GET", path, err
+00019f10: 6f72 5f6d 6573 7361 6765 290a 2020 2020  or_message).    
+00019f20: 2020 2020 7265 7475 726e 206d 6c72 756e      return mlrun
+00019f30: 2e70 726f 6a65 6374 732e 4d6c 7275 6e50  .projects.MlrunP
+00019f40: 726f 6a65 6374 2e66 726f 6d5f 6469 6374  roject.from_dict
+00019f50: 2872 6573 706f 6e73 652e 6a73 6f6e 2829  (response.json()
+00019f60: 290a 0a20 2020 2064 6566 2064 656c 6574  )..    def delet
+00019f70: 655f 7072 6f6a 6563 7428 0a20 2020 2020  e_project(.     
+00019f80: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+00019f90: 206e 616d 653a 2073 7472 2c0a 2020 2020   name: str,.    
+00019fa0: 2020 2020 6465 6c65 7469 6f6e 5f73 7472      deletion_str
+00019fb0: 6174 6567 793a 2055 6e69 6f6e 5b0a 2020  ategy: Union[.  
+00019fc0: 2020 2020 2020 2020 2020 7374 722c 206d            str, m
+00019fd0: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
+00019fe0: 6d61 732e 4465 6c65 7469 6f6e 5374 7261  mas.DeletionStra
+00019ff0: 7465 6779 0a20 2020 2020 2020 205d 203d  tegy.        ] =
+0001a000: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
+0001a010: 6865 6d61 732e 4465 6c65 7469 6f6e 5374  hemas.DeletionSt
+0001a020: 7261 7465 6779 2e64 6566 6175 6c74 2829  rategy.default()
+0001a030: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
+0001a040: 2022 2222 4465 6c65 7465 2061 2070 726f   """Delete a pro
+0001a050: 6a65 6374 2e0a 0a20 2020 2020 2020 203a  ject...        :
+0001a060: 7061 7261 6d20 6e61 6d65 3a20 4e61 6d65  param name: Name
+0001a070: 206f 6620 7468 6520 7072 6f6a 6563 7420   of the project 
+0001a080: 746f 2064 656c 6574 652e 0a20 2020 2020  to delete..     
+0001a090: 2020 203a 7061 7261 6d20 6465 6c65 7469     :param deleti
+0001a0a0: 6f6e 5f73 7472 6174 6567 793a 2048 6f77  on_strategy: How
+0001a0b0: 2074 6f20 7472 6561 7420 7265 736f 7572   to treat resour
+0001a0c0: 6365 7320 7265 6c61 7465 6420 746f 2074  ces related to t
+0001a0d0: 6865 2070 726f 6a65 6374 2e20 506f 7373  he project. Poss
+0001a0e0: 6962 6c65 2076 616c 7565 7320 6172 653a  ible values are:
+0001a0f0: 0a0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
+0001a100: 6060 7265 7374 7269 6374 6060 2028 6465  ``restrict`` (de
+0001a110: 6661 756c 7429 202d 2050 726f 6a65 6374  fault) - Project
+0001a120: 206d 7573 7420 6e6f 7420 6861 7665 2061   must not have a
+0001a130: 6e79 2072 656c 6174 6564 2072 6573 6f75  ny related resou
+0001a140: 7263 6573 2077 6865 6e20 6465 6c65 7465  rces when delete
+0001a150: 642e 2049 6620 7573 696e 670a 2020 2020  d. If using.    
+0001a160: 2020 2020 2020 2020 2020 7468 6973 206d            this m
+0001a170: 6f64 6520 7768 696c 6520 7265 6c61 7465  ode while relate
+0001a180: 6420 7265 736f 7572 6365 7320 6578 6973  d resources exis
+0001a190: 742c 2074 6865 206f 7065 7261 7469 6f6e  t, the operation
+0001a1a0: 2077 696c 6c20 6661 696c 2e0a 2020 2020   will fail..    
+0001a1b0: 2020 2020 2020 2020 2d20 6060 6361 7363          - ``casc
+0001a1c0: 6164 6560 6020 2d20 4175 746f 6d61 7469  ade`` - Automati
+0001a1d0: 6361 6c6c 7920 6465 6c65 7465 2061 6c6c  cally delete all
+0001a1e0: 2072 656c 6174 6564 2072 6573 6f75 7263   related resourc
+0001a1f0: 6573 2077 6865 6e20 6465 6c65 7469 6e67  es when deleting
+0001a200: 2074 6865 2070 726f 6a65 6374 2e0a 2020   the project..  
+0001a210: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
+0001a220: 2020 2068 6561 6465 7273 203d 207b 0a20     headers = {. 
+0001a230: 2020 2020 2020 2020 2020 206d 6c72 756e             mlrun
+0001a240: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
+0001a250: 4865 6164 6572 4e61 6d65 732e 6465 6c65  HeaderNames.dele
+0001a260: 7469 6f6e 5f73 7472 6174 6567 793a 2064  tion_strategy: d
+0001a270: 656c 6574 696f 6e5f 7374 7261 7465 6779  eletion_strategy
+0001a280: 0a20 2020 2020 2020 207d 0a20 2020 2020  .        }.     
+0001a290: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
+0001a2a0: 203d 2066 2246 6169 6c65 6420 6465 6c65   = f"Failed dele
+0001a2b0: 7469 6e67 2070 726f 6a65 6374 207b 6e61  ting project {na
+0001a2c0: 6d65 7d22 0a20 2020 2020 2020 2072 6573  me}".        res
+0001a2d0: 706f 6e73 6520 3d20 7365 6c66 2e61 7069  ponse = self.api
+0001a2e0: 5f63 616c 6c28 0a20 2020 2020 2020 2020  _call(.         
+0001a2f0: 2020 2022 4445 4c45 5445 222c 2066 2270     "DELETE", f"p
+0001a300: 726f 6a65 6374 732f 7b6e 616d 657d 222c  rojects/{name}",
+0001a310: 2065 7272 6f72 5f6d 6573 7361 6765 2c20   error_message, 
+0001a320: 6865 6164 6572 733d 6865 6164 6572 732c  headers=headers,
+0001a330: 2076 6572 7369 6f6e 3d22 7632 220a 2020   version="v2".  
+0001a340: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0001a350: 6966 2072 6573 706f 6e73 652e 7374 6174  if response.stat
+0001a360: 7573 5f63 6f64 6520 3d3d 2068 7474 702e  us_code == http.
+0001a370: 4854 5450 5374 6174 7573 2e41 4343 4550  HTTPStatus.ACCEP
+0001a380: 5445 443a 0a20 2020 2020 2020 2020 2020  TED:.           
+0001a390: 206c 6f67 6765 722e 696e 666f 2822 5072   logger.info("Pr
+0001a3a0: 6f6a 6563 7420 6973 2062 6569 6e67 2064  oject is being d
+0001a3b0: 656c 6574 6564 222c 2070 726f 6a65 6374  eleted", project
+0001a3c0: 5f6e 616d 653d 6e61 6d65 290a 2020 2020  _name=name).    
+0001a3d0: 2020 2020 2020 2020 6261 636b 6772 6f75          backgrou
+0001a3e0: 6e64 5f74 6173 6b20 3d20 6d6c 7275 6e2e  nd_task = mlrun.
+0001a3f0: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e42  common.schemas.B
+0001a400: 6163 6b67 726f 756e 6454 6173 6b28 2a2a  ackgroundTask(**
+0001a410: 7265 7370 6f6e 7365 2e6a 736f 6e28 2929  response.json())
+0001a420: 0a20 2020 2020 2020 2020 2020 2062 6163  .            bac
+0001a430: 6b67 726f 756e 645f 7461 736b 203d 2073  kground_task = s
+0001a440: 656c 662e 5f77 6169 745f 666f 725f 6261  elf._wait_for_ba
+0001a450: 636b 6772 6f75 6e64 5f74 6173 6b5f 746f  ckground_task_to
+0001a460: 5f72 6561 6368 5f74 6572 6d69 6e61 6c5f  _reach_terminal_
+0001a470: 7374 6174 6528 0a20 2020 2020 2020 2020  state(.         
+0001a480: 2020 2020 2020 2062 6163 6b67 726f 756e         backgroun
+0001a490: 645f 7461 736b 2e6d 6574 6164 6174 612e  d_task.metadata.
+0001a4a0: 6e61 6d65 0a20 2020 2020 2020 2020 2020  name.           
+0001a4b0: 2029 0a20 2020 2020 2020 2020 2020 2069   ).            i
+0001a4c0: 6620 280a 2020 2020 2020 2020 2020 2020  f (.            
+0001a4d0: 2020 2020 6261 636b 6772 6f75 6e64 5f74      background_t
+0001a4e0: 6173 6b2e 7374 6174 7573 2e73 7461 7465  ask.status.state
+0001a4f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001a500: 203d 3d20 6d6c 7275 6e2e 636f 6d6d 6f6e   == mlrun.common
+0001a510: 2e73 6368 656d 6173 2e42 6163 6b67 726f  .schemas.Backgro
+0001a520: 756e 6454 6173 6b53 7461 7465 2e73 7563  undTaskState.suc
+0001a530: 6365 6564 6564 0a20 2020 2020 2020 2020  ceeded.         
+0001a540: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
+0001a550: 2020 2020 2020 6c6f 6767 6572 2e69 6e66        logger.inf
+0001a560: 6f28 2250 726f 6a65 6374 2064 656c 6574  o("Project delet
+0001a570: 6564 222c 2070 726f 6a65 6374 5f6e 616d  ed", project_nam
+0001a580: 653d 6e61 6d65 290a 2020 2020 2020 2020  e=name).        
+0001a590: 2020 2020 2020 2020 7265 7475 726e 0a20          return. 
+0001a5a0: 2020 2020 2020 2065 6c69 6620 7265 7370         elif resp
+0001a5b0: 6f6e 7365 2e73 7461 7475 735f 636f 6465  onse.status_code
+0001a5c0: 203d 3d20 6874 7470 2e48 5454 5053 7461   == http.HTTPSta
+0001a5d0: 7475 732e 4e4f 5f43 4f4e 5445 4e54 3a0a  tus.NO_CONTENT:.
+0001a5e0: 2020 2020 2020 2020 2020 2020 6c6f 6767              logg
+0001a5f0: 6572 2e69 6e66 6f28 2250 726f 6a65 6374  er.info("Project
+0001a600: 2064 656c 6574 6564 222c 2070 726f 6a65   deleted", proje
+0001a610: 6374 5f6e 616d 653d 6e61 6d65 290a 2020  ct_name=name).  
+0001a620: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0001a630: 0a0a 2020 2020 6465 6620 7374 6f72 655f  ..    def store_
+0001a640: 7072 6f6a 6563 7428 0a20 2020 2020 2020  project(.       
+0001a650: 2073 656c 662c 0a20 2020 2020 2020 206e   self,.        n
+0001a660: 616d 653a 2073 7472 2c0a 2020 2020 2020  ame: str,.      
+0001a670: 2020 7072 6f6a 6563 743a 2055 6e69 6f6e    project: Union
+0001a680: 5b64 6963 742c 206d 6c72 756e 2e70 726f  [dict, mlrun.pro
+0001a690: 6a65 6374 732e 4d6c 7275 6e50 726f 6a65  jects.MlrunProje
+0001a6a0: 6374 2c20 6d6c 7275 6e2e 636f 6d6d 6f6e  ct, mlrun.common
+0001a6b0: 2e73 6368 656d 6173 2e50 726f 6a65 6374  .schemas.Project
+0001a6c0: 5d2c 0a20 2020 2029 202d 3e20 6d6c 7275  ],.    ) -> mlru
+0001a6d0: 6e2e 7072 6f6a 6563 7473 2e4d 6c72 756e  n.projects.Mlrun
+0001a6e0: 5072 6f6a 6563 743a 0a20 2020 2020 2020  Project:.       
+0001a6f0: 2022 2222 5374 6f72 6520 6120 7072 6f6a   """Store a proj
+0001a700: 6563 7420 696e 2074 6865 2044 422e 2054  ect in the DB. T
+0001a710: 6869 7320 6f70 6572 6174 696f 6e20 7769  his operation wi
+0001a720: 6c6c 206f 7665 7277 7269 7465 2065 7869  ll overwrite exi
+0001a730: 7374 696e 6720 7072 6f6a 6563 7420 6f66  sting project of
+0001a740: 2074 6865 2073 616d 6520 6e61 6d65 2069   the same name i
+0001a750: 6620 6578 6973 7473 2e22 2222 0a0a 2020  f exists."""..  
+0001a760: 2020 2020 2020 7061 7468 203d 2066 2270        path = f"p
+0001a770: 726f 6a65 6374 732f 7b6e 616d 657d 220a  rojects/{name}".
+0001a780: 2020 2020 2020 2020 6572 726f 725f 6d65          error_me
+0001a790: 7373 6167 6520 3d20 6622 4661 696c 6564  ssage = f"Failed
+0001a7a0: 2073 746f 7269 6e67 2070 726f 6a65 6374   storing project
+0001a7b0: 207b 6e61 6d65 7d22 0a20 2020 2020 2020   {name}".       
+0001a7c0: 2069 6620 6973 696e 7374 616e 6365 2870   if isinstance(p
+0001a7d0: 726f 6a65 6374 2c20 6d6c 7275 6e2e 636f  roject, mlrun.co
+0001a7e0: 6d6d 6f6e 2e73 6368 656d 6173 2e50 726f  mmon.schemas.Pro
+0001a7f0: 6a65 6374 293a 0a20 2020 2020 2020 2020  ject):.         
+0001a800: 2020 2070 726f 6a65 6374 203d 2070 726f     project = pro
+0001a810: 6a65 6374 2e64 6963 7428 290a 2020 2020  ject.dict().    
+0001a820: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
+0001a830: 6e63 6528 7072 6f6a 6563 742c 206d 6c72  nce(project, mlr
+0001a840: 756e 2e70 726f 6a65 6374 732e 4d6c 7275  un.projects.Mlru
+0001a850: 6e50 726f 6a65 6374 293a 0a20 2020 2020  nProject):.     
+0001a860: 2020 2020 2020 2070 726f 6a65 6374 203d         project =
+0001a870: 2070 726f 6a65 6374 2e74 6f5f 6469 6374   project.to_dict
+0001a880: 2829 0a20 2020 2020 2020 2072 6573 706f  ().        respo
+0001a890: 6e73 6520 3d20 7365 6c66 2e61 7069 5f63  nse = self.api_c
+0001a8a0: 616c 6c28 0a20 2020 2020 2020 2020 2020  all(.           
+0001a8b0: 2022 5055 5422 2c0a 2020 2020 2020 2020   "PUT",.        
+0001a8c0: 2020 2020 7061 7468 2c0a 2020 2020 2020      path,.      
+0001a8d0: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
+0001a8e0: 6167 652c 0a20 2020 2020 2020 2020 2020  age,.           
+0001a8f0: 2062 6f64 793d 6469 6374 5f74 6f5f 6a73   body=dict_to_js
+0001a900: 6f6e 2870 726f 6a65 6374 292c 0a20 2020  on(project),.   
+0001a910: 2020 2020 2029 0a20 2020 2020 2020 2069       ).        i
+0001a920: 6620 7265 7370 6f6e 7365 2e73 7461 7475  f response.statu
+0001a930: 735f 636f 6465 203d 3d20 6874 7470 2e48  s_code == http.H
+0001a940: 5454 5053 7461 7475 732e 4143 4345 5054  TTPStatus.ACCEPT
+0001a950: 4544 3a0a 2020 2020 2020 2020 2020 2020  ED:.            
+0001a960: 7265 7475 726e 2073 656c 662e 5f77 6169  return self._wai
+0001a970: 745f 666f 725f 7072 6f6a 6563 745f 746f  t_for_project_to
+0001a980: 5f72 6561 6368 5f74 6572 6d69 6e61 6c5f  _reach_terminal_
+0001a990: 7374 6174 6528 6e61 6d65 290a 2020 2020  state(name).    
+0001a9a0: 2020 2020 7265 7475 726e 206d 6c72 756e      return mlrun
+0001a9b0: 2e70 726f 6a65 6374 732e 4d6c 7275 6e50  .projects.MlrunP
+0001a9c0: 726f 6a65 6374 2e66 726f 6d5f 6469 6374  roject.from_dict
+0001a9d0: 2872 6573 706f 6e73 652e 6a73 6f6e 2829  (response.json()
+0001a9e0: 290a 0a20 2020 2064 6566 2070 6174 6368  )..    def patch
+0001a9f0: 5f70 726f 6a65 6374 280a 2020 2020 2020  _project(.      
+0001aa00: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+0001aa10: 6e61 6d65 3a20 7374 722c 0a20 2020 2020  name: str,.     
+0001aa20: 2020 2070 726f 6a65 6374 3a20 6469 6374     project: dict
+0001aa30: 2c0a 2020 2020 2020 2020 7061 7463 685f  ,.        patch_
+0001aa40: 6d6f 6465 3a20 556e 696f 6e5b 0a20 2020  mode: Union[.   
+0001aa50: 2020 2020 2020 2020 2073 7472 2c20 6d6c           str, ml
+0001aa60: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
+0001aa70: 6173 2e50 6174 6368 4d6f 6465 0a20 2020  as.PatchMode.   
+0001aa80: 2020 2020 205d 203d 206d 6c72 756e 2e63       ] = mlrun.c
+0001aa90: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 5061  ommon.schemas.Pa
+0001aaa0: 7463 684d 6f64 652e 7265 706c 6163 652c  tchMode.replace,
+0001aab0: 0a20 2020 2029 202d 3e20 6d6c 7275 6e2e  .    ) -> mlrun.
+0001aac0: 7072 6f6a 6563 7473 2e4d 6c72 756e 5072  projects.MlrunPr
+0001aad0: 6f6a 6563 743a 0a20 2020 2020 2020 2022  oject:.        "
+0001aae0: 2222 5061 7463 6820 616e 2065 7869 7374  ""Patch an exist
+0001aaf0: 696e 6720 7072 6f6a 6563 7420 6f62 6a65  ing project obje
+0001ab00: 6374 2e0a 0a20 2020 2020 2020 203a 7061  ct...        :pa
+0001ab10: 7261 6d20 6e61 6d65 3a20 4e61 6d65 206f  ram name: Name o
+0001ab20: 6620 7072 6f6a 6563 7420 746f 2070 6174  f project to pat
+0001ab30: 6368 2e0a 2020 2020 2020 2020 3a70 6172  ch..        :par
+0001ab40: 616d 2070 726f 6a65 6374 3a20 5468 6520  am project: The 
+0001ab50: 6163 7475 616c 2063 6861 6e67 6573 2074  actual changes t
+0001ab60: 6f20 7468 6520 7072 6f6a 6563 7420 6f62  o the project ob
+0001ab70: 6a65 6374 2e0a 2020 2020 2020 2020 3a70  ject..        :p
+0001ab80: 6172 616d 2070 6174 6368 5f6d 6f64 653a  aram patch_mode:
+0001ab90: 2054 6865 2073 7472 6174 6567 7920 666f   The strategy fo
+0001aba0: 7220 6d65 7267 696e 6720 7468 6520 6368  r merging the ch
+0001abb0: 616e 6765 7320 7769 7468 2074 6865 2065  anges with the e
+0001abc0: 7869 7374 696e 6720 6f62 6a65 6374 2e20  xisting object. 
+0001abd0: 4361 6e20 6265 2065 6974 6865 7220 6060  Can be either ``
+0001abe0: 7265 706c 6163 6560 600a 2020 2020 2020  replace``.      
+0001abf0: 2020 2020 2020 6f72 2060 6061 6464 6974        or ``addit
+0001ac00: 6976 6560 602e 0a20 2020 2020 2020 2022  ive``..        "
+0001ac10: 2222 0a0a 2020 2020 2020 2020 7061 7468  ""..        path
+0001ac20: 203d 2066 2270 726f 6a65 6374 732f 7b6e   = f"projects/{n
+0001ac30: 616d 657d 220a 2020 2020 2020 2020 6865  ame}".        he
+0001ac40: 6164 6572 7320 3d20 7b6d 6c72 756e 2e63  aders = {mlrun.c
+0001ac50: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 4865  ommon.schemas.He
+0001ac60: 6164 6572 4e61 6d65 732e 7061 7463 685f  aderNames.patch_
+0001ac70: 6d6f 6465 3a20 7061 7463 685f 6d6f 6465  mode: patch_mode
+0001ac80: 7d0a 2020 2020 2020 2020 6572 726f 725f  }.        error_
+0001ac90: 6d65 7373 6167 6520 3d20 6622 4661 696c  message = f"Fail
+0001aca0: 6564 2070 6174 6368 696e 6720 7072 6f6a  ed patching proj
+0001acb0: 6563 7420 7b6e 616d 657d 220a 2020 2020  ect {name}".    
+0001acc0: 2020 2020 7265 7370 6f6e 7365 203d 2073      response = s
+0001acd0: 656c 662e 6170 695f 6361 6c6c 280a 2020  elf.api_call(.  
+0001ace0: 2020 2020 2020 2020 2020 2250 4154 4348            "PATCH
+0001acf0: 222c 2070 6174 682c 2065 7272 6f72 5f6d  ", path, error_m
+0001ad00: 6573 7361 6765 2c20 626f 6479 3d64 6963  essage, body=dic
+0001ad10: 745f 746f 5f6a 736f 6e28 7072 6f6a 6563  t_to_json(projec
+0001ad20: 7429 2c20 6865 6164 6572 733d 6865 6164  t), headers=head
+0001ad30: 6572 730a 2020 2020 2020 2020 290a 2020  ers.        ).  
+0001ad40: 2020 2020 2020 7265 7475 726e 206d 6c72        return mlr
+0001ad50: 756e 2e70 726f 6a65 6374 732e 4d6c 7275  un.projects.Mlru
+0001ad60: 6e50 726f 6a65 6374 2e66 726f 6d5f 6469  nProject.from_di
+0001ad70: 6374 2872 6573 706f 6e73 652e 6a73 6f6e  ct(response.json
+0001ad80: 2829 290a 0a20 2020 2064 6566 2063 7265  ())..    def cre
+0001ad90: 6174 655f 7072 6f6a 6563 7428 0a20 2020  ate_project(.   
+0001ada0: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+0001adb0: 2020 2070 726f 6a65 6374 3a20 556e 696f     project: Unio
+0001adc0: 6e5b 6469 6374 2c20 6d6c 7275 6e2e 7072  n[dict, mlrun.pr
+0001add0: 6f6a 6563 7473 2e4d 6c72 756e 5072 6f6a  ojects.MlrunProj
+0001ade0: 6563 742c 206d 6c72 756e 2e63 6f6d 6d6f  ect, mlrun.commo
+0001adf0: 6e2e 7363 6865 6d61 732e 5072 6f6a 6563  n.schemas.Projec
+0001ae00: 745d 2c0a 2020 2020 2920 2d3e 206d 6c72  t],.    ) -> mlr
+0001ae10: 756e 2e70 726f 6a65 6374 732e 4d6c 7275  un.projects.Mlru
+0001ae20: 6e50 726f 6a65 6374 3a0a 2020 2020 2020  nProject:.      
+0001ae30: 2020 2222 2243 7265 6174 6520 6120 6e65    """Create a ne
+0001ae40: 7720 7072 6f6a 6563 742e 2041 2070 726f  w project. A pro
+0001ae50: 6a65 6374 2077 6974 6820 7468 6520 7361  ject with the sa
+0001ae60: 6d65 206e 616d 6520 6d75 7374 206e 6f74  me name must not
+0001ae70: 2065 7869 7374 2070 7269 6f72 2074 6f20   exist prior to 
+0001ae80: 6372 6561 7469 6f6e 2e22 2222 0a0a 2020  creation."""..  
+0001ae90: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
+0001aea0: 6e63 6528 7072 6f6a 6563 742c 206d 6c72  nce(project, mlr
+0001aeb0: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+0001aec0: 732e 5072 6f6a 6563 7429 3a0a 2020 2020  s.Project):.    
+0001aed0: 2020 2020 2020 2020 7072 6f6a 6563 7420          project 
+0001aee0: 3d20 7072 6f6a 6563 742e 6469 6374 2829  = project.dict()
+0001aef0: 0a20 2020 2020 2020 2065 6c69 6620 6973  .        elif is
+0001af00: 696e 7374 616e 6365 2870 726f 6a65 6374  instance(project
+0001af10: 2c20 6d6c 7275 6e2e 7072 6f6a 6563 7473  , mlrun.projects
+0001af20: 2e4d 6c72 756e 5072 6f6a 6563 7429 3a0a  .MlrunProject):.
+0001af30: 2020 2020 2020 2020 2020 2020 7072 6f6a              proj
+0001af40: 6563 7420 3d20 7072 6f6a 6563 742e 746f  ect = project.to
+0001af50: 5f64 6963 7428 290a 2020 2020 2020 2020  _dict().        
+0001af60: 7072 6f6a 6563 745f 6e61 6d65 203d 2070  project_name = p
+0001af70: 726f 6a65 6374 5b22 6d65 7461 6461 7461  roject["metadata
+0001af80: 225d 5b22 6e61 6d65 225d 0a20 2020 2020  "]["name"].     
+0001af90: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
+0001afa0: 203d 2066 2246 6169 6c65 6420 6372 6561   = f"Failed crea
+0001afb0: 7469 6e67 2070 726f 6a65 6374 207b 7072  ting project {pr
+0001afc0: 6f6a 6563 745f 6e61 6d65 7d22 0a20 2020  oject_name}".   
+0001afd0: 2020 2020 2072 6573 706f 6e73 6520 3d20       response = 
+0001afe0: 7365 6c66 2e61 7069 5f63 616c 6c28 0a20  self.api_call(. 
+0001aff0: 2020 2020 2020 2020 2020 2022 504f 5354             "POST
+0001b000: 222c 0a20 2020 2020 2020 2020 2020 2023  ",.            #
+0001b010: 2064 6f20 6e6f 7420 7761 6974 2066 6f72   do not wait for
+0001b020: 2070 726f 6a65 6374 2074 6f20 7265 6163   project to reac
+0001b030: 6820 7465 726d 696e 616c 2073 7461 7465  h terminal state
+0001b040: 2073 796e 6368 726f 6e6f 7573 6c79 2e0a   synchronously..
+0001b050: 2020 2020 2020 2020 2020 2020 2320 6c65              # le
+0001b060: 7420 6974 2073 7461 7274 2061 6e64 2077  t it start and w
+0001b070: 6169 7420 666f 7220 6974 2074 6f20 7265  ait for it to re
+0001b080: 6163 6820 7465 726d 696e 616c 2073 7461  ach terminal sta
+0001b090: 7465 2061 7379 6e63 6872 6f6e 6f75 736c  te asynchronousl
+0001b0a0: 790a 2020 2020 2020 2020 2020 2020 2270  y.            "p
+0001b0b0: 726f 6a65 6374 733f 7761 6974 2d66 6f72  rojects?wait-for
+0001b0c0: 2d63 6f6d 706c 6574 696f 6e3d 6661 6c73  -completion=fals
+0001b0d0: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
+0001b0e0: 6572 726f 725f 6d65 7373 6167 652c 0a20  error_message,. 
+0001b0f0: 2020 2020 2020 2020 2020 2062 6f64 793d             body=
+0001b100: 6469 6374 5f74 6f5f 6a73 6f6e 2870 726f  dict_to_json(pro
+0001b110: 6a65 6374 292c 0a20 2020 2020 2020 2029  ject),.        )
+0001b120: 0a20 2020 2020 2020 2069 6620 7265 7370  .        if resp
+0001b130: 6f6e 7365 2e73 7461 7475 735f 636f 6465  onse.status_code
+0001b140: 203d 3d20 6874 7470 2e48 5454 5053 7461   == http.HTTPSta
+0001b150: 7475 732e 4143 4345 5054 4544 3a0a 2020  tus.ACCEPTED:.  
+0001b160: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0001b170: 2073 656c 662e 5f77 6169 745f 666f 725f   self._wait_for_
+0001b180: 7072 6f6a 6563 745f 746f 5f72 6561 6368  project_to_reach
+0001b190: 5f74 6572 6d69 6e61 6c5f 7374 6174 6528  _terminal_state(
+0001b1a0: 7072 6f6a 6563 745f 6e61 6d65 290a 2020  project_name).  
+0001b1b0: 2020 2020 2020 7265 7475 726e 206d 6c72        return mlr
+0001b1c0: 756e 2e70 726f 6a65 6374 732e 4d6c 7275  un.projects.Mlru
+0001b1d0: 6e50 726f 6a65 6374 2e66 726f 6d5f 6469  nProject.from_di
+0001b1e0: 6374 2872 6573 706f 6e73 652e 6a73 6f6e  ct(response.json
+0001b1f0: 2829 290a 0a20 2020 2064 6566 205f 7761  ())..    def _wa
+0001b200: 6974 5f66 6f72 5f70 726f 6a65 6374 5f74  it_for_project_t
+0001b210: 6f5f 7265 6163 685f 7465 726d 696e 616c  o_reach_terminal
+0001b220: 5f73 7461 7465 280a 2020 2020 2020 2020  _state(.        
+0001b230: 7365 6c66 2c20 7072 6f6a 6563 745f 6e61  self, project_na
+0001b240: 6d65 3a20 7374 720a 2020 2020 2920 2d3e  me: str.    ) ->
+0001b250: 206d 6c72 756e 2e70 726f 6a65 6374 732e   mlrun.projects.
+0001b260: 4d6c 7275 6e50 726f 6a65 6374 3a0a 2020  MlrunProject:.  
+0001b270: 2020 2020 2020 6465 6620 5f76 6572 6966        def _verif
+0001b280: 795f 7072 6f6a 6563 745f 696e 5f74 6572  y_project_in_ter
+0001b290: 6d69 6e61 6c5f 7374 6174 6528 293a 0a20  minal_state():. 
+0001b2a0: 2020 2020 2020 2020 2020 2070 726f 6a65             proje
+0001b2b0: 6374 203d 2073 656c 662e 6765 745f 7072  ct = self.get_pr
+0001b2c0: 6f6a 6563 7428 7072 6f6a 6563 745f 6e61  oject(project_na
+0001b2d0: 6d65 290a 2020 2020 2020 2020 2020 2020  me).            
+0001b2e0: 6966 2028 0a20 2020 2020 2020 2020 2020  if (.           
+0001b2f0: 2020 2020 2070 726f 6a65 6374 2e73 7461       project.sta
+0001b300: 7475 732e 7374 6174 650a 2020 2020 2020  tus.state.      
+0001b310: 2020 2020 2020 2020 2020 6e6f 7420 696e            not in
+0001b320: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
+0001b330: 6865 6d61 732e 5072 6f6a 6563 7453 7461  hemas.ProjectSta
+0001b340: 7465 2e74 6572 6d69 6e61 6c5f 7374 6174  te.terminal_stat
+0001b350: 6573 2829 0a20 2020 2020 2020 2020 2020  es().           
+0001b360: 2029 3a0a 2020 2020 2020 2020 2020 2020   ):.            
+0001b370: 2020 2020 7261 6973 6520 4578 6365 7074      raise Except
+0001b380: 696f 6e28 0a20 2020 2020 2020 2020 2020  ion(.           
+0001b390: 2020 2020 2020 2020 2066 2250 726f 6a65           f"Proje
+0001b3a0: 6374 206e 6f74 2069 6e20 7465 726d 696e  ct not in termin
+0001b3b0: 616c 2073 7461 7465 2e20 5374 6174 653a  al state. State:
+0001b3c0: 207b 7072 6f6a 6563 742e 7374 6174 7573   {project.status
+0001b3d0: 2e73 7461 7465 7d22 0a20 2020 2020 2020  .state}".       
+0001b3e0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0001b3f0: 2020 2020 2020 2072 6574 7572 6e20 7072         return pr
+0001b400: 6f6a 6563 740a 0a20 2020 2020 2020 2072  oject..        r
+0001b410: 6574 7572 6e20 6d6c 7275 6e2e 7574 696c  eturn mlrun.util
+0001b420: 732e 6865 6c70 6572 732e 7265 7472 795f  s.helpers.retry_
+0001b430: 756e 7469 6c5f 7375 6363 6573 7366 756c  until_successful
+0001b440: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
+0001b450: 6c66 2e5f 7761 6974 5f66 6f72 5f70 726f  lf._wait_for_pro
+0001b460: 6a65 6374 5f74 6572 6d69 6e61 6c5f 7374  ject_terminal_st
+0001b470: 6174 655f 7265 7472 795f 696e 7465 7276  ate_retry_interv
+0001b480: 616c 2c0a 2020 2020 2020 2020 2020 2020  al,.            
+0001b490: 3138 302c 0a20 2020 2020 2020 2020 2020  180,.           
+0001b4a0: 206c 6f67 6765 722c 0a20 2020 2020 2020   logger,.       
+0001b4b0: 2020 2020 2046 616c 7365 2c0a 2020 2020       False,.    
+0001b4c0: 2020 2020 2020 2020 5f76 6572 6966 795f          _verify_
+0001b4d0: 7072 6f6a 6563 745f 696e 5f74 6572 6d69  project_in_termi
+0001b4e0: 6e61 6c5f 7374 6174 652c 0a20 2020 2020  nal_state,.     
+0001b4f0: 2020 2029 0a0a 2020 2020 6465 6620 5f77     )..    def _w
+0001b500: 6169 745f 666f 725f 6261 636b 6772 6f75  ait_for_backgrou
+0001b510: 6e64 5f74 6173 6b5f 746f 5f72 6561 6368  nd_task_to_reach
+0001b520: 5f74 6572 6d69 6e61 6c5f 7374 6174 6528  _terminal_state(
+0001b530: 0a20 2020 2020 2020 2073 656c 662c 206e  .        self, n
+0001b540: 616d 653a 2073 7472 2c20 7072 6f6a 6563  ame: str, projec
+0001b550: 743a 2073 7472 203d 2022 220a 2020 2020  t: str = "".    
+0001b560: 2920 2d3e 206d 6c72 756e 2e63 6f6d 6d6f  ) -> mlrun.commo
+0001b570: 6e2e 7363 6865 6d61 732e 4261 636b 6772  n.schemas.Backgr
+0001b580: 6f75 6e64 5461 736b 3a0a 2020 2020 2020  oundTask:.      
+0001b590: 2020 6465 6620 5f76 6572 6966 795f 6261    def _verify_ba
+0001b5a0: 636b 6772 6f75 6e64 5f74 6173 6b5f 696e  ckground_task_in
+0001b5b0: 5f74 6572 6d69 6e61 6c5f 7374 6174 6528  _terminal_state(
+0001b5c0: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
+0001b5d0: 6620 7072 6f6a 6563 743a 0a20 2020 2020  f project:.     
+0001b5e0: 2020 2020 2020 2020 2020 2062 6163 6b67             backg
+0001b5f0: 726f 756e 645f 7461 736b 203d 2073 656c  round_task = sel
+0001b600: 662e 6765 745f 7072 6f6a 6563 745f 6261  f.get_project_ba
+0001b610: 636b 6772 6f75 6e64 5f74 6173 6b28 7072  ckground_task(pr
+0001b620: 6f6a 6563 742c 206e 616d 6529 0a20 2020  oject, name).   
+0001b630: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+0001b640: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+0001b650: 6163 6b67 726f 756e 645f 7461 736b 203d  ackground_task =
+0001b660: 2073 656c 662e 6765 745f 6261 636b 6772   self.get_backgr
+0001b670: 6f75 6e64 5f74 6173 6b28 6e61 6d65 290a  ound_task(name).
+0001b680: 2020 2020 2020 2020 2020 2020 7374 6174              stat
+0001b690: 6520 3d20 6261 636b 6772 6f75 6e64 5f74  e = background_t
+0001b6a0: 6173 6b2e 7374 6174 7573 2e73 7461 7465  ask.status.state
+0001b6b0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0001b6c0: 7374 6174 6520 6e6f 7420 696e 206d 6c72  state not in mlr
+0001b6d0: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+0001b6e0: 732e 4261 636b 6772 6f75 6e64 5461 736b  s.BackgroundTask
+0001b6f0: 5374 6174 652e 7465 726d 696e 616c 5f73  State.terminal_s
+0001b700: 7461 7465 7328 293a 0a20 2020 2020 2020  tates():.       
+0001b710: 2020 2020 2020 2020 2072 6169 7365 2045           raise E
+0001b720: 7863 6570 7469 6f6e 280a 2020 2020 2020  xception(.      
+0001b730: 2020 2020 2020 2020 2020 2020 2020 6622                f"
+0001b740: 4261 636b 6772 6f75 6e64 2074 6173 6b20  Background task 
+0001b750: 6e6f 7420 696e 2074 6572 6d69 6e61 6c20  not in terminal 
+0001b760: 7374 6174 652e 206e 616d 653d 7b6e 616d  state. name={nam
+0001b770: 657d 2c20 7374 6174 653d 7b73 7461 7465  e}, state={state
+0001b780: 7d22 0a20 2020 2020 2020 2020 2020 2020  }".             
+0001b790: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+0001b7a0: 2072 6574 7572 6e20 6261 636b 6772 6f75   return backgrou
+0001b7b0: 6e64 5f74 6173 6b0a 0a20 2020 2020 2020  nd_task..       
+0001b7c0: 2072 6574 7572 6e20 6d6c 7275 6e2e 7574   return mlrun.ut
+0001b7d0: 696c 732e 6865 6c70 6572 732e 7265 7472  ils.helpers.retr
+0001b7e0: 795f 756e 7469 6c5f 7375 6363 6573 7366  y_until_successf
+0001b7f0: 756c 280a 2020 2020 2020 2020 2020 2020  ul(.            
+0001b800: 7365 6c66 2e5f 7761 6974 5f66 6f72 5f62  self._wait_for_b
+0001b810: 6163 6b67 726f 756e 645f 7461 736b 5f74  ackground_task_t
+0001b820: 6572 6d69 6e61 6c5f 7374 6174 655f 7265  erminal_state_re
+0001b830: 7472 795f 696e 7465 7276 616c 2c0a 2020  try_interval,.  
+0001b840: 2020 2020 2020 2020 2020 3630 202a 2036            60 * 6
+0001b850: 302c 0a20 2020 2020 2020 2020 2020 206c  0,.            l
+0001b860: 6f67 6765 722c 0a20 2020 2020 2020 2020  ogger,.         
+0001b870: 2020 2046 616c 7365 2c0a 2020 2020 2020     False,.      
+0001b880: 2020 2020 2020 5f76 6572 6966 795f 6261        _verify_ba
+0001b890: 636b 6772 6f75 6e64 5f74 6173 6b5f 696e  ckground_task_in
+0001b8a0: 5f74 6572 6d69 6e61 6c5f 7374 6174 652c  _terminal_state,
+0001b8b0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+0001b8c0: 6465 6620 6372 6561 7465 5f70 726f 6a65  def create_proje
+0001b8d0: 6374 5f73 6563 7265 7473 280a 2020 2020  ct_secrets(.    
+0001b8e0: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+0001b8f0: 2020 7072 6f6a 6563 743a 2073 7472 2c0a    project: str,.
+0001b900: 2020 2020 2020 2020 7072 6f76 6964 6572          provider
+0001b910: 3a20 556e 696f 6e5b 0a20 2020 2020 2020  : Union[.       
+0001b920: 2020 2020 2073 7472 2c20 6d6c 7275 6e2e       str, mlrun.
+0001b930: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e53  common.schemas.S
+0001b940: 6563 7265 7450 726f 7669 6465 724e 616d  ecretProviderNam
+0001b950: 650a 2020 2020 2020 2020 5d20 3d20 6d6c  e.        ] = ml
+0001b960: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
+0001b970: 6173 2e53 6563 7265 7450 726f 7669 6465  as.SecretProvide
+0001b980: 724e 616d 652e 6b75 6265 726e 6574 6573  rName.kubernetes
+0001b990: 2c0a 2020 2020 2020 2020 7365 6372 6574  ,.        secret
+0001b9a0: 733a 2064 6963 7420 3d20 4e6f 6e65 2c0a  s: dict = None,.
+0001b9b0: 2020 2020 293a 0a20 2020 2020 2020 2022      ):.        "
+0001b9c0: 2222 4372 6561 7465 2070 726f 6a65 6374  ""Create project
+0001b9d0: 2d63 6f6e 7465 7874 2073 6563 7265 7473  -context secrets
+0001b9e0: 2075 7369 6e67 2065 6974 6865 7220 6060   using either ``
+0001b9f0: 7661 756c 7460 6020 6f72 2060 606b 7562  vault`` or ``kub
+0001ba00: 6572 6e65 7465 7360 6020 7072 6f76 6964  ernetes`` provid
+0001ba10: 6572 2e0a 2020 2020 2020 2020 5768 656e  er..        When
+0001ba20: 2075 7369 6e67 2077 6974 6820 5661 756c   using with Vaul
+0001ba30: 742c 2074 6869 7320 7769 6c6c 2063 7265  t, this will cre
+0001ba40: 6174 6520 6e65 6564 6564 2056 6175 6c74  ate needed Vault
+0001ba50: 2073 7472 7563 7475 7265 7320 666f 7220   structures for 
+0001ba60: 7374 6f72 696e 6720 7365 6372 6574 7320  storing secrets 
+0001ba70: 696e 2070 726f 6a65 6374 2d63 6f6e 7465  in project-conte
+0001ba80: 7874 2c20 616e 640a 2020 2020 2020 2020  xt, and.        
+0001ba90: 7374 6f72 6520 6120 7365 7420 6f66 2073  store a set of s
+0001baa0: 6563 7265 7420 7661 6c75 6573 2e20 5468  ecret values. Th
+0001bab0: 6520 6d65 7468 6f64 2067 656e 6572 6174  e method generat
+0001bac0: 6573 204b 7562 6572 6e65 7465 7320 7365  es Kubernetes se
+0001bad0: 7276 6963 652d 6163 636f 756e 7420 616e  rvice-account an
+0001bae0: 6420 7468 6520 5661 756c 7420 6175 7468  d the Vault auth
+0001baf0: 656e 7469 6361 7469 6f6e 0a20 2020 2020  entication.     
+0001bb00: 2020 2073 7472 7563 7475 7265 7320 7468     structures th
+0001bb10: 6174 2061 7265 2072 6571 7569 7265 6420  at are required 
+0001bb20: 666f 7220 6675 6e63 7469 6f6e 2050 6f64  for function Pod
+0001bb30: 7320 746f 2061 7574 6865 6e74 6963 6174  s to authenticat
+0001bb40: 6520 7769 7468 2056 6175 6c74 2061 6e64  e with Vault and
+0001bb50: 2062 6520 6162 6c65 2074 6f20 6578 7472   be able to extr
+0001bb60: 6163 7420 7365 6372 6574 2076 616c 7565  act secret value
+0001bb70: 730a 2020 2020 2020 2020 7061 7373 6564  s.        passed
+0001bb80: 2061 7320 7061 7274 206f 6620 7468 6569   as part of thei
+0001bb90: 7220 636f 6e74 6578 742e 0a0a 2020 2020  r context...    
+0001bba0: 2020 2020 4e6f 7465 3a0a 2020 2020 2020      Note:.      
+0001bbb0: 2020 2020 2020 2020 2020 5468 6973 206d            This m
+0001bbc0: 6574 686f 6420 7573 6564 2077 6974 6820  ethod used with 
+0001bbd0: 5661 756c 7420 6973 2063 7572 7265 6e74  Vault is current
+0001bbe0: 6c79 2069 6e20 7465 6368 6e69 6361 6c20  ly in technical 
+0001bbf0: 7072 6576 6965 772c 2061 6e64 2072 6571  preview, and req
+0001bc00: 7569 7265 7320 6120 4861 7368 6943 6f72  uires a HashiCor
+0001bc10: 7020 5661 756c 740a 2020 2020 2020 2020  p Vault.        
+0001bc20: 2020 2020 2020 2020 696e 6672 6173 7472          infrastr
+0001bc30: 7563 7475 7265 2070 726f 7065 726c 7920  ucture properly 
+0001bc40: 7365 7420 7570 2061 6e64 2063 6f6e 6e65  set up and conne
+0001bc50: 6374 6564 2074 6f20 7468 6520 4d4c 5275  cted to the MLRu
+0001bc60: 6e20 4150 4920 7365 7276 6572 2e0a 0a20  n API server... 
+0001bc70: 2020 2020 2020 2057 6865 6e20 7573 6564         When used
+0001bc80: 2077 6974 6820 4b75 6265 726e 6574 6573   with Kubernetes
+0001bc90: 2c20 7468 6973 2077 696c 6c20 6d61 6b65  , this will make
+0001bca0: 2073 7572 6520 7468 6174 2074 6865 2070   sure that the p
+0001bcb0: 726f 6a65 6374 2d73 7065 6369 6669 6320  roject-specific 
+0001bcc0: 6b38 7320 7365 6372 6574 2069 7320 6372  k8s secret is cr
+0001bcd0: 6561 7465 642c 2061 6e64 2077 696c 6c0a  eated, and will.
+0001bce0: 2020 2020 2020 2020 706f 7075 6c61 7465          populate
+0001bcf0: 2069 7420 7769 7468 2074 6865 2073 6563   it with the sec
+0001bd00: 7265 7473 2070 726f 7669 6465 642c 2072  rets provided, r
+0001bd10: 6570 6c61 6369 6e67 2074 6865 6972 2076  eplacing their v
+0001bd20: 616c 7565 7320 6966 2074 6865 7920 6578  alues if they ex
+0001bd30: 6973 742e 0a0a 2020 2020 2020 2020 3a70  ist...        :p
+0001bd40: 6172 616d 2070 726f 6a65 6374 3a20 5468  aram project: Th
+0001bd50: 6520 7072 6f6a 6563 7420 636f 6e74 6578  e project contex
+0001bd60: 7420 666f 7220 7768 6963 6820 746f 2067  t for which to g
+0001bd70: 656e 6572 6174 6520 7468 6520 696e 6672  enerate the infr
+0001bd80: 6120 616e 6420 7374 6f72 6520 7365 6372  a and store secr
+0001bd90: 6574 732e 0a20 2020 2020 2020 203a 7061  ets..        :pa
+0001bda0: 7261 6d20 7072 6f76 6964 6572 3a20 5468  ram provider: Th
+0001bdb0: 6520 6e61 6d65 206f 6620 7468 6520 7365  e name of the se
+0001bdc0: 6372 6574 732d 7072 6f76 6964 6572 2074  crets-provider t
+0001bdd0: 6f20 776f 726b 2077 6974 682e 2041 6363  o work with. Acc
+0001bde0: 6570 7473 2061 0a20 2020 2020 2020 2020  epts a.         
+0001bdf0: 2020 203a 7079 3a63 6c61 7373 3a60 7e6d     :py:class:`~m
+0001be00: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
+0001be10: 6d61 732e 7365 6372 6574 2e53 6563 7265  mas.secret.Secre
+0001be20: 7450 726f 7669 6465 724e 616d 6560 2065  tProviderName` e
+0001be30: 6e75 6d2e 0a20 2020 2020 2020 203a 7061  num..        :pa
+0001be40: 7261 6d20 7365 6372 6574 733a 2041 2073  ram secrets: A s
+0001be50: 6574 206f 6620 7365 6372 6574 2076 616c  et of secret val
+0001be60: 7565 7320 746f 2073 746f 7265 2e0a 2020  ues to store..  
+0001be70: 2020 2020 2020 2020 2020 4578 616d 706c            Exampl
+0001be80: 653a 3a0a 0a20 2020 2020 2020 2020 2020  e::..           
+0001be90: 2020 2020 2073 6563 7265 7473 203d 207b       secrets = {
+0001bea0: 2770 6173 7377 6f72 6427 3a20 276d 7950  'password': 'myP
+0001beb0: 6173 7377 3072 6427 2c20 2761 7773 5f6b  assw0rd', 'aws_k
+0001bec0: 6579 273a 2027 3131 3132 3232 3333 3327  ey': '111222333'
+0001bed0: 7d0a 2020 2020 2020 2020 2020 2020 2020  }.              
+0001bee0: 2020 6462 2e63 7265 6174 655f 7072 6f6a    db.create_proj
+0001bef0: 6563 745f 7365 6372 6574 7328 0a20 2020  ect_secrets(.   
+0001bf00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bf10: 2022 7072 6f6a 6563 7431 222c 0a20 2020   "project1",.   
+0001bf20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bf30: 2070 726f 7669 6465 723d 6d6c 7275 6e2e   provider=mlrun.
+0001bf40: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e53  common.schemas.S
+0001bf50: 6563 7265 7450 726f 7669 6465 724e 616d  ecretProviderNam
+0001bf60: 652e 6b75 6265 726e 6574 6573 2c0a 2020  e.kubernetes,.  
+0001bf70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bf80: 2020 7365 6372 6574 733d 7365 6372 6574    secrets=secret
+0001bf90: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
+0001bfa0: 2020 290a 2020 2020 2020 2020 2222 220a    ).        """.
+0001bfb0: 2020 2020 2020 2020 7061 7468 203d 2066          path = f
+0001bfc0: 2270 726f 6a65 6374 732f 7b70 726f 6a65  "projects/{proje
+0001bfd0: 6374 7d2f 7365 6372 6574 7322 0a20 2020  ct}/secrets".   
+0001bfe0: 2020 2020 2073 6563 7265 7473 5f69 6e70       secrets_inp
+0001bff0: 7574 203d 206d 6c72 756e 2e63 6f6d 6d6f  ut = mlrun.commo
+0001c000: 6e2e 7363 6865 6d61 732e 5365 6372 6574  n.schemas.Secret
+0001c010: 7344 6174 6128 0a20 2020 2020 2020 2020  sData(.         
+0001c020: 2020 2073 6563 7265 7473 3d73 6563 7265     secrets=secre
+0001c030: 7473 2c20 7072 6f76 6964 6572 3d70 726f  ts, provider=pro
+0001c040: 7669 6465 720a 2020 2020 2020 2020 290a  vider.        ).
+0001c050: 2020 2020 2020 2020 626f 6479 203d 2073          body = s
+0001c060: 6563 7265 7473 5f69 6e70 7574 2e64 6963  ecrets_input.dic
+0001c070: 7428 290a 2020 2020 2020 2020 6572 726f  t().        erro
+0001c080: 725f 6d65 7373 6167 6520 3d20 6622 4661  r_message = f"Fa
+0001c090: 696c 6564 2063 7265 6174 696e 6720 7365  iled creating se
+0001c0a0: 6372 6574 2070 726f 7669 6465 7220 7b70  cret provider {p
+0001c0b0: 726f 6a65 6374 7d2f 7b70 726f 7669 6465  roject}/{provide
+0001c0c0: 727d 220a 2020 2020 2020 2020 7365 6c66  r}".        self
+0001c0d0: 2e61 7069 5f63 616c 6c28 0a20 2020 2020  .api_call(.     
+0001c0e0: 2020 2020 2020 2022 504f 5354 222c 0a20         "POST",. 
+0001c0f0: 2020 2020 2020 2020 2020 2070 6174 682c             path,
+0001c100: 0a20 2020 2020 2020 2020 2020 2065 7272  .            err
+0001c110: 6f72 5f6d 6573 7361 6765 2c0a 2020 2020  or_message,.    
+0001c120: 2020 2020 2020 2020 626f 6479 3d64 6963          body=dic
+0001c130: 745f 746f 5f6a 736f 6e28 626f 6479 292c  t_to_json(body),
+0001c140: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+0001c150: 6465 6620 6c69 7374 5f70 726f 6a65 6374  def list_project
+0001c160: 5f73 6563 7265 7473 280a 2020 2020 2020  _secrets(.      
+0001c170: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+0001c180: 7072 6f6a 6563 743a 2073 7472 2c0a 2020  project: str,.  
+0001c190: 2020 2020 2020 746f 6b65 6e3a 2073 7472        token: str
+0001c1a0: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+0001c1b0: 2070 726f 7669 6465 723a 2055 6e69 6f6e   provider: Union
+0001c1c0: 5b0a 2020 2020 2020 2020 2020 2020 7374  [.            st
+0001c1d0: 722c 206d 6c72 756e 2e63 6f6d 6d6f 6e2e  r, mlrun.common.
+0001c1e0: 7363 6865 6d61 732e 5365 6372 6574 5072  schemas.SecretPr
+0001c1f0: 6f76 6964 6572 4e61 6d65 0a20 2020 2020  oviderName.     
+0001c200: 2020 205d 203d 206d 6c72 756e 2e63 6f6d     ] = mlrun.com
+0001c210: 6d6f 6e2e 7363 6865 6d61 732e 5365 6372  mon.schemas.Secr
+0001c220: 6574 5072 6f76 6964 6572 4e61 6d65 2e6b  etProviderName.k
+0001c230: 7562 6572 6e65 7465 732c 0a20 2020 2020  ubernetes,.     
+0001c240: 2020 2073 6563 7265 7473 3a20 6c69 7374     secrets: list
+0001c250: 5b73 7472 5d20 3d20 4e6f 6e65 2c0a 2020  [str] = None,.  
+0001c260: 2020 2920 2d3e 206d 6c72 756e 2e63 6f6d    ) -> mlrun.com
+0001c270: 6d6f 6e2e 7363 6865 6d61 732e 5365 6372  mon.schemas.Secr
+0001c280: 6574 7344 6174 613a 0a20 2020 2020 2020  etsData:.       
+0001c290: 2022 2222 5265 7472 6965 7665 2070 726f   """Retrieve pro
+0001c2a0: 6a65 6374 2d63 6f6e 7465 7874 2073 6563  ject-context sec
+0001c2b0: 7265 7473 2066 726f 6d20 5661 756c 742e  rets from Vault.
+0001c2c0: 0a0a 2020 2020 2020 2020 4e6f 7465 3a0a  ..        Note:.
+0001c2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c2e0: 5468 6973 206d 6574 686f 6420 666f 7220  This method for 
+0001c2f0: 5661 756c 7420 6675 6e63 7469 6f6e 616c  Vault functional
+0001c300: 6974 7920 6973 2063 7572 7265 6e74 6c79  ity is currently
+0001c310: 2069 6e20 7465 6368 6e69 6361 6c20 7072   in technical pr
+0001c320: 6576 6965 772c 2061 6e64 2072 6571 7569  eview, and requi
+0001c330: 7265 7320 6120 4861 7368 6943 6f72 7020  res a HashiCorp 
+0001c340: 5661 756c 740a 2020 2020 2020 2020 2020  Vault.          
+0001c350: 2020 2020 2020 696e 6672 6173 7472 7563        infrastruc
+0001c360: 7475 7265 2070 726f 7065 726c 7920 7365  ture properly se
+0001c370: 7420 7570 2061 6e64 2063 6f6e 6e65 6374  t up and connect
+0001c380: 6564 2074 6f20 7468 6520 4d4c 5275 6e20  ed to the MLRun 
+0001c390: 4150 4920 7365 7276 6572 2e0a 0a20 2020  API server...   
+0001c3a0: 2020 2020 203a 7061 7261 6d20 7072 6f6a       :param proj
+0001c3b0: 6563 743a 2054 6865 2070 726f 6a65 6374  ect: The project
+0001c3c0: 206e 616d 652e 0a20 2020 2020 2020 203a   name..        :
+0001c3d0: 7061 7261 6d20 746f 6b65 6e3a 2056 6175  param token: Vau
+0001c3e0: 6c74 2074 6f6b 656e 2074 6f20 7573 6520  lt token to use 
+0001c3f0: 666f 7220 7265 7472 6965 7669 6e67 2073  for retrieving s
+0001c400: 6563 7265 7473 2e0a 2020 2020 2020 2020  ecrets..        
+0001c410: 2020 2020 4d75 7374 2062 6520 6120 7661      Must be a va
+0001c420: 6c69 6420 5661 756c 7420 746f 6b65 6e2c  lid Vault token,
+0001c430: 2077 6974 6820 7065 726d 6973 7369 6f6e   with permission
+0001c440: 7320 746f 2072 6574 7269 6576 6520 7365  s to retrieve se
+0001c450: 6372 6574 7320 6f66 2074 6865 2070 726f  crets of the pro
+0001c460: 6a65 6374 2069 6e20 7175 6573 7469 6f6e  ject in question
+0001c470: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+0001c480: 2070 726f 7669 6465 723a 2054 6865 206e   provider: The n
+0001c490: 616d 6520 6f66 2074 6865 2073 6563 7265  ame of the secre
+0001c4a0: 7473 2d70 726f 7669 6465 7220 746f 2077  ts-provider to w
+0001c4b0: 6f72 6b20 7769 7468 2e20 4375 7272 656e  ork with. Curren
+0001c4c0: 746c 7920 6f6e 6c79 2060 6076 6175 6c74  tly only ``vault
+0001c4d0: 6060 2069 7320 6163 6365 7074 6564 2e0a  `` is accepted..
+0001c4e0: 2020 2020 2020 2020 3a70 6172 616d 2073          :param s
+0001c4f0: 6563 7265 7473 3a20 4120 6c69 7374 206f  ecrets: A list o
+0001c500: 6620 7365 6372 6574 206e 616d 6573 2074  f secret names t
+0001c510: 6f20 7265 7472 6965 7665 2e20 416e 2065  o retrieve. An e
+0001c520: 6d70 7479 206c 6973 7420 6060 5b5d 6060  mpty list ``[]``
+0001c530: 2077 696c 6c20 7265 7472 6965 7665 2061   will retrieve a
+0001c540: 6c6c 2073 6563 7265 7473 2061 7373 6967  ll secrets assig
+0001c550: 6e65 640a 2020 2020 2020 2020 2020 2020  ned.            
+0001c560: 746f 2074 6869 7320 7370 6563 6966 6963  to this specific
+0001c570: 2070 726f 6a65 6374 2e20 6060 6b75 6265   project. ``kube
+0001c580: 726e 6574 6573 6060 2070 726f 7669 6465  rnetes`` provide
+0001c590: 7220 6f6e 6c79 2073 7570 706f 7274 7320  r only supports 
+0001c5a0: 616e 2065 6d70 7479 206c 6973 742e 0a20  an empty list.. 
+0001c5b0: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
+0001c5c0: 2020 2020 6966 2028 0a20 2020 2020 2020      if (.       
+0001c5d0: 2020 2020 2070 726f 7669 6465 7220 3d3d       provider ==
+0001c5e0: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
+0001c5f0: 6865 6d61 732e 5365 6372 6574 5072 6f76  hemas.SecretProv
+0001c600: 6964 6572 4e61 6d65 2e76 6175 6c74 2e76  iderName.vault.v
+0001c610: 616c 7565 0a20 2020 2020 2020 2020 2020  alue.           
+0001c620: 2061 6e64 206e 6f74 2074 6f6b 656e 0a20   and not token. 
+0001c630: 2020 2020 2020 2029 3a0a 2020 2020 2020         ):.      
+0001c640: 2020 2020 2020 7261 6973 6520 4d4c 5275        raise MLRu
+0001c650: 6e49 6e76 616c 6964 4172 6775 6d65 6e74  nInvalidArgument
+0001c660: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
+0001c670: 2020 2020 2020 2022 4120 7661 756c 7420         "A vault 
+0001c680: 746f 6b65 6e20 6d75 7374 2062 6520 7072  token must be pr
+0001c690: 6f76 6964 6564 2077 6865 6e20 6163 6365  ovided when acce
+0001c6a0: 7373 696e 6720 7661 756c 7420 7365 6372  ssing vault secr
+0001c6b0: 6574 7322 0a20 2020 2020 2020 2020 2020  ets".           
+0001c6c0: 2029 0a0a 2020 2020 2020 2020 7061 7468   )..        path
+0001c6d0: 203d 2066 2270 726f 6a65 6374 732f 7b70   = f"projects/{p
+0001c6e0: 726f 6a65 6374 7d2f 7365 6372 6574 7322  roject}/secrets"
+0001c6f0: 0a20 2020 2020 2020 2070 6172 616d 7320  .        params 
+0001c700: 3d20 7b22 7072 6f76 6964 6572 223a 2070  = {"provider": p
+0001c710: 726f 7669 6465 722c 2022 7365 6372 6574  rovider, "secret
+0001c720: 223a 2073 6563 7265 7473 7d0a 2020 2020  ": secrets}.    
+0001c730: 2020 2020 6865 6164 6572 7320 3d20 7b6d      headers = {m
+0001c740: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
+0001c750: 6d61 732e 4865 6164 6572 4e61 6d65 732e  mas.HeaderNames.
+0001c760: 7365 6372 6574 5f73 746f 7265 5f74 6f6b  secret_store_tok
+0001c770: 656e 3a20 746f 6b65 6e7d 0a20 2020 2020  en: token}.     
+0001c780: 2020 2065 7272 6f72 5f6d 6573 7361 6765     error_message
+0001c790: 203d 2066 2246 6169 6c65 6420 7265 7472   = f"Failed retr
+0001c7a0: 6965 7669 6e67 2073 6563 7265 7473 207b  ieving secrets {
+0001c7b0: 7072 6f6a 6563 747d 2f7b 7072 6f76 6964  project}/{provid
+0001c7c0: 6572 7d22 0a20 2020 2020 2020 2072 6573  er}".        res
+0001c7d0: 756c 7420 3d20 7365 6c66 2e61 7069 5f63  ult = self.api_c
+0001c7e0: 616c 6c28 0a20 2020 2020 2020 2020 2020  all(.           
+0001c7f0: 2022 4745 5422 2c0a 2020 2020 2020 2020   "GET",.        
+0001c800: 2020 2020 7061 7468 2c0a 2020 2020 2020      path,.      
+0001c810: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
+0001c820: 6167 652c 0a20 2020 2020 2020 2020 2020  age,.           
+0001c830: 2070 6172 616d 733d 7061 7261 6d73 2c0a   params=params,.
+0001c840: 2020 2020 2020 2020 2020 2020 6865 6164              head
+0001c850: 6572 733d 6865 6164 6572 732c 0a20 2020  ers=headers,.   
+0001c860: 2020 2020 2029 0a20 2020 2020 2020 2072       ).        r
+0001c870: 6574 7572 6e20 6d6c 7275 6e2e 636f 6d6d  eturn mlrun.comm
+0001c880: 6f6e 2e73 6368 656d 6173 2e53 6563 7265  on.schemas.Secre
+0001c890: 7473 4461 7461 282a 2a72 6573 756c 742e  tsData(**result.
+0001c8a0: 6a73 6f6e 2829 290a 0a20 2020 2064 6566  json())..    def
+0001c8b0: 206c 6973 745f 7072 6f6a 6563 745f 7365   list_project_se
+0001c8c0: 6372 6574 5f6b 6579 7328 0a20 2020 2020  cret_keys(.     
+0001c8d0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+0001c8e0: 2070 726f 6a65 6374 3a20 7374 722c 0a20   project: str,. 
+0001c8f0: 2020 2020 2020 2070 726f 7669 6465 723a         provider:
+0001c900: 2055 6e69 6f6e 5b0a 2020 2020 2020 2020   Union[.        
+0001c910: 2020 2020 7374 722c 206d 6c72 756e 2e63      str, mlrun.c
+0001c920: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 5365  ommon.schemas.Se
+0001c930: 6372 6574 5072 6f76 6964 6572 4e61 6d65  cretProviderName
+0001c940: 0a20 2020 2020 2020 205d 203d 206d 6c72  .        ] = mlr
+0001c950: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+0001c960: 732e 5365 6372 6574 5072 6f76 6964 6572  s.SecretProvider
+0001c970: 4e61 6d65 2e6b 7562 6572 6e65 7465 732c  Name.kubernetes,
+0001c980: 0a20 2020 2020 2020 2074 6f6b 656e 3a20  .        token: 
+0001c990: 7374 7220 3d20 4e6f 6e65 2c0a 2020 2020  str = None,.    
+0001c9a0: 2920 2d3e 206d 6c72 756e 2e63 6f6d 6d6f  ) -> mlrun.commo
+0001c9b0: 6e2e 7363 6865 6d61 732e 5365 6372 6574  n.schemas.Secret
+0001c9c0: 4b65 7973 4461 7461 3a0a 2020 2020 2020  KeysData:.      
+0001c9d0: 2020 2222 2252 6574 7269 6576 6520 7072    """Retrieve pr
+0001c9e0: 6f6a 6563 742d 636f 6e74 6578 7420 7365  oject-context se
+0001c9f0: 6372 6574 206b 6579 7320 6672 6f6d 2056  cret keys from V
+0001ca00: 6175 6c74 206f 7220 4b75 6265 726e 6574  ault or Kubernet
+0001ca10: 6573 2e0a 0a20 2020 2020 2020 204e 6f74  es...        Not
+0001ca20: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+0001ca30: 2020 2054 6869 7320 6d65 7468 6f64 2066     This method f
+0001ca40: 6f72 2056 6175 6c74 2066 756e 6374 696f  or Vault functio
+0001ca50: 6e61 6c69 7479 2069 7320 6375 7272 656e  nality is curren
+0001ca60: 746c 7920 696e 2074 6563 686e 6963 616c  tly in technical
+0001ca70: 2070 7265 7669 6577 2c20 616e 6420 7265   preview, and re
+0001ca80: 7175 6972 6573 2061 2048 6173 6869 436f  quires a HashiCo
+0001ca90: 7270 2056 6175 6c74 0a20 2020 2020 2020  rp Vault.       
+0001caa0: 2020 2020 2020 2020 2069 6e66 7261 7374           infrast
+0001cab0: 7275 6374 7572 6520 7072 6f70 6572 6c79  ructure properly
+0001cac0: 2073 6574 2075 7020 616e 6420 636f 6e6e   set up and conn
+0001cad0: 6563 7465 6420 746f 2074 6865 204d 4c52  ected to the MLR
+0001cae0: 756e 2041 5049 2073 6572 7665 722e 0a0a  un API server...
+0001caf0: 2020 2020 2020 2020 3a70 6172 616d 2070          :param p
+0001cb00: 726f 6a65 6374 3a20 5468 6520 7072 6f6a  roject: The proj
+0001cb10: 6563 7420 6e61 6d65 2e0a 2020 2020 2020  ect name..      
+0001cb20: 2020 3a70 6172 616d 2070 726f 7669 6465    :param provide
+0001cb30: 723a 2054 6865 206e 616d 6520 6f66 2074  r: The name of t
+0001cb40: 6865 2073 6563 7265 7473 2d70 726f 7669  he secrets-provi
+0001cb50: 6465 7220 746f 2077 6f72 6b20 7769 7468  der to work with
+0001cb60: 2e20 4163 6365 7074 7320 610a 2020 2020  . Accepts a.    
+0001cb70: 2020 2020 2020 2020 3a70 793a 636c 6173          :py:clas
+0001cb80: 733a 607e 6d6c 7275 6e2e 636f 6d6d 6f6e  s:`~mlrun.common
+0001cb90: 2e73 6368 656d 6173 2e73 6563 7265 742e  .schemas.secret.
+0001cba0: 5365 6372 6574 5072 6f76 6964 6572 4e61  SecretProviderNa
+0001cbb0: 6d65 6020 656e 756d 2e0a 2020 2020 2020  me` enum..      
+0001cbc0: 2020 3a70 6172 616d 2074 6f6b 656e 3a20    :param token: 
+0001cbd0: 5661 756c 7420 746f 6b65 6e20 746f 2075  Vault token to u
+0001cbe0: 7365 2066 6f72 2072 6574 7269 6576 696e  se for retrievin
+0001cbf0: 6720 7365 6372 6574 732e 204f 6e6c 7920  g secrets. Only 
+0001cc00: 696e 2075 7365 2069 6620 6060 7072 6f76  in use if ``prov
+0001cc10: 6964 6572 6060 2069 7320 6060 7661 756c  ider`` is ``vaul
+0001cc20: 7460 602e 0a20 2020 2020 2020 2020 2020  t``..           
+0001cc30: 204d 7573 7420 6265 2061 2076 616c 6964   Must be a valid
+0001cc40: 2056 6175 6c74 2074 6f6b 656e 2c20 7769   Vault token, wi
+0001cc50: 7468 2070 6572 6d69 7373 696f 6e73 2074  th permissions t
+0001cc60: 6f20 7265 7472 6965 7665 2073 6563 7265  o retrieve secre
+0001cc70: 7473 206f 6620 7468 6520 7072 6f6a 6563  ts of the projec
+0001cc80: 7420 696e 2071 7565 7374 696f 6e2e 0a20  t in question.. 
+0001cc90: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
+0001cca0: 2020 2020 6966 2028 0a20 2020 2020 2020      if (.       
+0001ccb0: 2020 2020 2070 726f 7669 6465 7220 3d3d       provider ==
+0001ccc0: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
+0001ccd0: 6865 6d61 732e 5365 6372 6574 5072 6f76  hemas.SecretProv
+0001cce0: 6964 6572 4e61 6d65 2e76 6175 6c74 2e76  iderName.vault.v
+0001ccf0: 616c 7565 0a20 2020 2020 2020 2020 2020  alue.           
+0001cd00: 2061 6e64 206e 6f74 2074 6f6b 656e 0a20   and not token. 
+0001cd10: 2020 2020 2020 2029 3a0a 2020 2020 2020         ):.      
+0001cd20: 2020 2020 2020 7261 6973 6520 4d4c 5275        raise MLRu
+0001cd30: 6e49 6e76 616c 6964 4172 6775 6d65 6e74  nInvalidArgument
+0001cd40: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
+0001cd50: 2020 2020 2020 2022 4120 7661 756c 7420         "A vault 
+0001cd60: 746f 6b65 6e20 6d75 7374 2062 6520 7072  token must be pr
+0001cd70: 6f76 6964 6564 2077 6865 6e20 6163 6365  ovided when acce
+0001cd80: 7373 696e 6720 7661 756c 7420 7365 6372  ssing vault secr
+0001cd90: 6574 7322 0a20 2020 2020 2020 2020 2020  ets".           
+0001cda0: 2029 0a0a 2020 2020 2020 2020 7061 7468   )..        path
+0001cdb0: 203d 2066 2270 726f 6a65 6374 732f 7b70   = f"projects/{p
+0001cdc0: 726f 6a65 6374 7d2f 7365 6372 6574 2d6b  roject}/secret-k
+0001cdd0: 6579 7322 0a20 2020 2020 2020 2070 6172  eys".        par
+0001cde0: 616d 7320 3d20 7b22 7072 6f76 6964 6572  ams = {"provider
+0001cdf0: 223a 2070 726f 7669 6465 727d 0a20 2020  ": provider}.   
+0001ce00: 2020 2020 2068 6561 6465 7273 203d 2028       headers = (
+0001ce10: 0a20 2020 2020 2020 2020 2020 207b 6d6c  .            {ml
+0001ce20: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
+0001ce30: 6173 2e48 6561 6465 724e 616d 6573 2e73  as.HeaderNames.s
+0001ce40: 6563 7265 745f 7374 6f72 655f 746f 6b65  ecret_store_toke
+0001ce50: 6e3a 2074 6f6b 656e 7d0a 2020 2020 2020  n: token}.      
+0001ce60: 2020 2020 2020 6966 2070 726f 7669 6465        if provide
+0001ce70: 7220 3d3d 206d 6c72 756e 2e63 6f6d 6d6f  r == mlrun.commo
+0001ce80: 6e2e 7363 6865 6d61 732e 5365 6372 6574  n.schemas.Secret
+0001ce90: 5072 6f76 6964 6572 4e61 6d65 2e76 6175  ProviderName.vau
+0001cea0: 6c74 2e76 616c 7565 0a20 2020 2020 2020  lt.value.       
+0001ceb0: 2020 2020 2065 6c73 6520 4e6f 6e65 0a20       else None. 
+0001cec0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0001ced0: 2065 7272 6f72 5f6d 6573 7361 6765 203d   error_message =
+0001cee0: 2066 2246 6169 6c65 6420 7265 7472 6965   f"Failed retrie
+0001cef0: 7669 6e67 2073 6563 7265 7420 6b65 7973  ving secret keys
+0001cf00: 207b 7072 6f6a 6563 747d 2f7b 7072 6f76   {project}/{prov
+0001cf10: 6964 6572 7d22 0a20 2020 2020 2020 2072  ider}".        r
+0001cf20: 6573 756c 7420 3d20 7365 6c66 2e61 7069  esult = self.api
+0001cf30: 5f63 616c 6c28 0a20 2020 2020 2020 2020  _call(.         
+0001cf40: 2020 2022 4745 5422 2c0a 2020 2020 2020     "GET",.      
+0001cf50: 2020 2020 2020 7061 7468 2c0a 2020 2020        path,.    
+0001cf60: 2020 2020 2020 2020 6572 726f 725f 6d65          error_me
+0001cf70: 7373 6167 652c 0a20 2020 2020 2020 2020  ssage,.         
+0001cf80: 2020 2070 6172 616d 733d 7061 7261 6d73     params=params
+0001cf90: 2c0a 2020 2020 2020 2020 2020 2020 6865  ,.            he
+0001cfa0: 6164 6572 733d 6865 6164 6572 732c 0a20  aders=headers,. 
+0001cfb0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0001cfc0: 2072 6574 7572 6e20 6d6c 7275 6e2e 636f   return mlrun.co
+0001cfd0: 6d6d 6f6e 2e73 6368 656d 6173 2e53 6563  mmon.schemas.Sec
+0001cfe0: 7265 744b 6579 7344 6174 6128 2a2a 7265  retKeysData(**re
+0001cff0: 7375 6c74 2e6a 736f 6e28 2929 0a0a 2020  sult.json())..  
+0001d000: 2020 6465 6620 6465 6c65 7465 5f70 726f    def delete_pro
+0001d010: 6a65 6374 5f73 6563 7265 7473 280a 2020  ject_secrets(.  
+0001d020: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+0001d030: 2020 2020 7072 6f6a 6563 743a 2073 7472      project: str
+0001d040: 2c0a 2020 2020 2020 2020 7072 6f76 6964  ,.        provid
+0001d050: 6572 3a20 556e 696f 6e5b 0a20 2020 2020  er: Union[.     
+0001d060: 2020 2020 2020 2073 7472 2c20 6d6c 7275         str, mlru
+0001d070: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
+0001d080: 2e53 6563 7265 7450 726f 7669 6465 724e  .SecretProviderN
+0001d090: 616d 650a 2020 2020 2020 2020 5d20 3d20  ame.        ] = 
+0001d0a0: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+0001d0b0: 656d 6173 2e53 6563 7265 7450 726f 7669  emas.SecretProvi
+0001d0c0: 6465 724e 616d 652e 6b75 6265 726e 6574  derName.kubernet
+0001d0d0: 6573 2c0a 2020 2020 2020 2020 7365 6372  es,.        secr
+0001d0e0: 6574 733a 206c 6973 745b 7374 725d 203d  ets: list[str] =
+0001d0f0: 204e 6f6e 652c 0a20 2020 2029 3a0a 2020   None,.    ):.  
+0001d100: 2020 2020 2020 2222 2244 656c 6574 6520        """Delete 
+0001d110: 7072 6f6a 6563 742d 636f 6e74 6578 7420  project-context 
+0001d120: 7365 6372 6574 7320 6672 6f6d 204b 7562  secrets from Kub
+0001d130: 6572 6e65 7465 732e 0a0a 2020 2020 2020  ernetes...      
+0001d140: 2020 3a70 6172 616d 2070 726f 6a65 6374    :param project
+0001d150: 3a20 5468 6520 7072 6f6a 6563 7420 6e61  : The project na
+0001d160: 6d65 2e0a 2020 2020 2020 2020 3a70 6172  me..        :par
+0001d170: 616d 2070 726f 7669 6465 723a 2054 6865  am provider: The
+0001d180: 206e 616d 6520 6f66 2074 6865 2073 6563   name of the sec
+0001d190: 7265 7473 2d70 726f 7669 6465 7220 746f  rets-provider to
+0001d1a0: 2077 6f72 6b20 7769 7468 2e20 4375 7272   work with. Curr
+0001d1b0: 656e 746c 7920 6f6e 6c79 2060 606b 7562  ently only ``kub
+0001d1c0: 6572 6e65 7465 7360 6020 6973 2073 7570  ernetes`` is sup
+0001d1d0: 706f 7274 6564 2e0a 2020 2020 2020 2020  ported..        
+0001d1e0: 3a70 6172 616d 2073 6563 7265 7473 3a20  :param secrets: 
+0001d1f0: 4120 6c69 7374 206f 6620 7365 6372 6574  A list of secret
+0001d200: 206e 616d 6573 2074 6f20 6465 6c65 7465   names to delete
+0001d210: 2e20 416e 2065 6d70 7479 206c 6973 7420  . An empty list 
+0001d220: 7769 6c6c 2064 656c 6574 6520 616c 6c20  will delete all 
+0001d230: 7365 6372 6574 7320 6173 7369 676e 6564  secrets assigned
+0001d240: 0a20 2020 2020 2020 2020 2020 2074 6f20  .            to 
+0001d250: 7468 6973 2073 7065 6369 6669 6320 7072  this specific pr
+0001d260: 6f6a 6563 742e 0a20 2020 2020 2020 2022  oject..        "
+0001d270: 2222 0a0a 2020 2020 2020 2020 7061 7468  ""..        path
+0001d280: 203d 2066 2270 726f 6a65 6374 732f 7b70   = f"projects/{p
+0001d290: 726f 6a65 6374 7d2f 7365 6372 6574 7322  roject}/secrets"
+0001d2a0: 0a20 2020 2020 2020 2070 6172 616d 7320  .        params 
+0001d2b0: 3d20 7b22 7072 6f76 6964 6572 223a 2070  = {"provider": p
+0001d2c0: 726f 7669 6465 722c 2022 7365 6372 6574  rovider, "secret
+0001d2d0: 223a 2073 6563 7265 7473 7d0a 2020 2020  ": secrets}.    
+0001d2e0: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
+0001d2f0: 6520 3d20 6622 4661 696c 6564 2064 656c  e = f"Failed del
+0001d300: 6574 696e 6720 7365 6372 6574 7320 7b70  eting secrets {p
+0001d310: 726f 6a65 6374 7d2f 7b70 726f 7669 6465  roject}/{provide
+0001d320: 727d 220a 2020 2020 2020 2020 7365 6c66  r}".        self
+0001d330: 2e61 7069 5f63 616c 6c28 0a20 2020 2020  .api_call(.     
+0001d340: 2020 2020 2020 2022 4445 4c45 5445 222c         "DELETE",
+0001d350: 0a20 2020 2020 2020 2020 2020 2070 6174  .            pat
+0001d360: 682c 0a20 2020 2020 2020 2020 2020 2065  h,.            e
+0001d370: 7272 6f72 5f6d 6573 7361 6765 2c0a 2020  rror_message,.  
+0001d380: 2020 2020 2020 2020 2020 7061 7261 6d73            params
+0001d390: 3d70 6172 616d 732c 0a20 2020 2020 2020  =params,.       
+0001d3a0: 2029 0a0a 2020 2020 6465 6620 6372 6561   )..    def crea
+0001d3b0: 7465 5f75 7365 725f 7365 6372 6574 7328  te_user_secrets(
+0001d3c0: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+0001d3d0: 2020 2020 2020 2075 7365 723a 2073 7472         user: str
+0001d3e0: 2c0a 2020 2020 2020 2020 7072 6f76 6964  ,.        provid
+0001d3f0: 6572 3a20 556e 696f 6e5b 0a20 2020 2020  er: Union[.     
+0001d400: 2020 2020 2020 2073 7472 2c20 6d6c 7275         str, mlru
+0001d410: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
+0001d420: 2e53 6563 7265 7450 726f 7669 6465 724e  .SecretProviderN
+0001d430: 616d 650a 2020 2020 2020 2020 5d20 3d20  ame.        ] = 
+0001d440: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+0001d450: 656d 6173 2e53 6563 7265 7450 726f 7669  emas.SecretProvi
+0001d460: 6465 724e 616d 652e 7661 756c 742c 0a20  derName.vault,. 
+0001d470: 2020 2020 2020 2073 6563 7265 7473 3a20         secrets: 
+0001d480: 6469 6374 203d 204e 6f6e 652c 0a20 2020  dict = None,.   
+0001d490: 2029 3a0a 2020 2020 2020 2020 2222 2243   ):.        """C
+0001d4a0: 7265 6174 6520 7573 6572 2d63 6f6e 7465  reate user-conte
+0001d4b0: 7874 2073 6563 7265 7420 696e 2056 6175  xt secret in Vau
+0001d4c0: 6c74 2e20 506c 6561 7365 2072 6566 6572  lt. Please refer
+0001d4d0: 2074 6f20 3a70 793a 6675 6e63 3a60 6372   to :py:func:`cr
+0001d4e0: 6561 7465 5f70 726f 6a65 6374 5f73 6563  eate_project_sec
+0001d4f0: 7265 7473 6020 666f 7220 6d6f 7265 2064  rets` for more d
+0001d500: 6574 6169 6c73 0a20 2020 2020 2020 2061  etails.        a
+0001d510: 6e64 2073 7461 7475 7320 6f66 2074 6869  nd status of thi
+0001d520: 7320 6675 6e63 7469 6f6e 616c 6974 792e  s functionality.
+0001d530: 0a0a 2020 2020 2020 2020 4e6f 7465 3a0a  ..        Note:.
+0001d540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d550: 5468 6973 206d 6574 686f 6420 6973 2063  This method is c
+0001d560: 7572 7265 6e74 6c79 2069 6e20 7465 6368  urrently in tech
+0001d570: 6e69 6361 6c20 7072 6576 6965 772c 2061  nical preview, a
+0001d580: 6e64 2072 6571 7569 7265 7320 6120 4861  nd requires a Ha
+0001d590: 7368 6943 6f72 7020 5661 756c 7420 696e  shiCorp Vault in
+0001d5a0: 6672 6173 7472 7563 7475 7265 0a20 2020  frastructure.   
+0001d5b0: 2020 2020 2020 2020 2020 2020 2070 726f               pro
+0001d5c0: 7065 726c 7920 7365 7420 7570 2061 6e64  perly set up and
+0001d5d0: 2063 6f6e 6e65 6374 6564 2074 6f20 7468   connected to th
+0001d5e0: 6520 4d4c 5275 6e20 4150 4920 7365 7276  e MLRun API serv
+0001d5f0: 6572 2e0a 0a20 2020 2020 2020 203a 7061  er...        :pa
+0001d600: 7261 6d20 7573 6572 3a20 5468 6520 7573  ram user: The us
+0001d610: 6572 2063 6f6e 7465 7874 2066 6f72 2077  er context for w
+0001d620: 6869 6368 2074 6f20 6765 6e65 7261 7465  hich to generate
+0001d630: 2074 6865 2069 6e66 7261 2061 6e64 2073   the infra and s
+0001d640: 746f 7265 2073 6563 7265 7473 2e0a 2020  tore secrets..  
+0001d650: 2020 2020 2020 3a70 6172 616d 2070 726f        :param pro
+0001d660: 7669 6465 723a 2054 6865 206e 616d 6520  vider: The name 
+0001d670: 6f66 2074 6865 2073 6563 7265 7473 2d70  of the secrets-p
+0001d680: 726f 7669 6465 7220 746f 2077 6f72 6b20  rovider to work 
+0001d690: 7769 7468 2e20 4375 7272 656e 746c 7920  with. Currently 
+0001d6a0: 6f6e 6c79 2060 6076 6175 6c74 6060 2069  only ``vault`` i
+0001d6b0: 7320 7375 7070 6f72 7465 642e 0a20 2020  s supported..   
+0001d6c0: 2020 2020 203a 7061 7261 6d20 7365 6372       :param secr
+0001d6d0: 6574 733a 2041 2073 6574 206f 6620 7365  ets: A set of se
+0001d6e0: 6372 6574 2076 616c 7565 7320 746f 2073  cret values to s
+0001d6f0: 746f 7265 2077 6974 6869 6e20 7468 6520  tore within the 
+0001d700: 5661 756c 742e 0a20 2020 2020 2020 2022  Vault..        "
+0001d710: 2222 0a20 2020 2020 2020 2070 6174 6820  "".        path 
+0001d720: 3d20 2275 7365 722d 7365 6372 6574 7322  = "user-secrets"
+0001d730: 0a20 2020 2020 2020 2073 6563 7265 7473  .        secrets
+0001d740: 5f63 7265 6174 696f 6e5f 7265 7175 6573  _creation_reques
+0001d750: 7420 3d20 6d6c 7275 6e2e 636f 6d6d 6f6e  t = mlrun.common
+0001d760: 2e73 6368 656d 6173 2e55 7365 7253 6563  .schemas.UserSec
+0001d770: 7265 7443 7265 6174 696f 6e52 6571 7565  retCreationReque
+0001d780: 7374 280a 2020 2020 2020 2020 2020 2020  st(.            
+0001d790: 7573 6572 3d75 7365 722c 0a20 2020 2020  user=user,.     
+0001d7a0: 2020 2020 2020 2070 726f 7669 6465 723d         provider=
+0001d7b0: 7072 6f76 6964 6572 2c0a 2020 2020 2020  provider,.      
+0001d7c0: 2020 2020 2020 7365 6372 6574 733d 7365        secrets=se
+0001d7d0: 6372 6574 732c 0a20 2020 2020 2020 2029  crets,.        )
+0001d7e0: 0a20 2020 2020 2020 2062 6f64 7920 3d20  .        body = 
+0001d7f0: 7365 6372 6574 735f 6372 6561 7469 6f6e  secrets_creation
+0001d800: 5f72 6571 7565 7374 2e64 6963 7428 290a  _request.dict().
+0001d810: 2020 2020 2020 2020 6572 726f 725f 6d65          error_me
+0001d820: 7373 6167 6520 3d20 6622 4661 696c 6564  ssage = f"Failed
+0001d830: 2063 7265 6174 696e 6720 7573 6572 2073   creating user s
+0001d840: 6563 7265 7473 202d 207b 7573 6572 7d22  ecrets - {user}"
+0001d850: 0a20 2020 2020 2020 2073 656c 662e 6170  .        self.ap
+0001d860: 695f 6361 6c6c 280a 2020 2020 2020 2020  i_call(.        
+0001d870: 2020 2020 2250 4f53 5422 2c0a 2020 2020      "POST",.    
+0001d880: 2020 2020 2020 2020 7061 7468 2c0a 2020          path,.  
+0001d890: 2020 2020 2020 2020 2020 6572 726f 725f            error_
+0001d8a0: 6d65 7373 6167 652c 0a20 2020 2020 2020  message,.       
+0001d8b0: 2020 2020 2062 6f64 793d 6469 6374 5f74       body=dict_t
+0001d8c0: 6f5f 6a73 6f6e 2862 6f64 7929 2c0a 2020  o_json(body),.  
+0001d8d0: 2020 2020 2020 290a 0a20 2020 2040 7374        )..    @st
+0001d8e0: 6174 6963 6d65 7468 6f64 0a20 2020 2064  aticmethod.    d
+0001d8f0: 6566 205f 7661 6c69 6461 7465 5f76 6572  ef _validate_ver
+0001d900: 7369 6f6e 5f63 6f6d 7061 7469 6269 6c69  sion_compatibili
+0001d910: 7479 2873 6572 7665 725f 7665 7273 696f  ty(server_versio
+0001d920: 6e2c 2063 6c69 656e 745f 7665 7273 696f  n, client_versio
+0001d930: 6e29 202d 3e20 626f 6f6c 3a0a 2020 2020  n) -> bool:.    
+0001d940: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
+0001d950: 2020 2020 2070 6172 7365 645f 7365 7276       parsed_serv
+0001d960: 6572 5f76 6572 7369 6f6e 203d 2073 656d  er_version = sem
+0001d970: 7665 722e 5665 7273 696f 6e49 6e66 6f2e  ver.VersionInfo.
+0001d980: 7061 7273 6528 7365 7276 6572 5f76 6572  parse(server_ver
+0001d990: 7369 6f6e 290a 2020 2020 2020 2020 2020  sion).          
+0001d9a0: 2020 7061 7273 6564 5f63 6c69 656e 745f    parsed_client_
+0001d9b0: 7665 7273 696f 6e20 3d20 7365 6d76 6572  version = semver
+0001d9c0: 2e56 6572 7369 6f6e 496e 666f 2e70 6172  .VersionInfo.par
+0001d9d0: 7365 2863 6c69 656e 745f 7665 7273 696f  se(client_versio
+0001d9e0: 6e29 0a20 2020 2020 2020 2065 7863 6570  n).        excep
+0001d9f0: 7420 5661 6c75 6545 7272 6f72 3a0a 2020  t ValueError:.  
+0001da00: 2020 2020 2020 2020 2020 2320 5468 6973            # This
+0001da10: 2077 696c 6c20 6d6f 7374 6c79 2068 6170   will mostly hap
+0001da20: 7065 6e20 696e 2064 6576 2073 6365 6e61  pen in dev scena
+0001da30: 7269 6f73 2077 6865 6e20 7468 6520 7665  rios when the ve
+0001da40: 7273 696f 6e20 6973 2075 6e73 7461 626c  rsion is unstabl
+0001da50: 6520 616e 6420 7375 6368 202d 2074 6865  e and such - the
+0001da60: 7265 666f 7265 2077 6527 7265 2069 676e  refore we're ign
+0001da70: 6f72 696e 670a 2020 2020 2020 2020 2020  oring.          
+0001da80: 2020 6c6f 6767 6572 2e77 6172 6e69 6e67    logger.warning
+0001da90: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0001daa0: 2020 2255 6e61 626c 6520 746f 2070 6172    "Unable to par
+0001dab0: 7365 2073 6572 7665 7220 6f72 2063 6c69  se server or cli
+0001dac0: 656e 7420 7665 7273 696f 6e2e 2041 7373  ent version. Ass
+0001dad0: 756d 696e 6720 636f 6d70 6174 6962 6c65  uming compatible
+0001dae0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+0001daf0: 2020 2073 6572 7665 725f 7665 7273 696f     server_versio
+0001db00: 6e3d 7365 7276 6572 5f76 6572 7369 6f6e  n=server_version
+0001db10: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001db20: 2020 636c 6965 6e74 5f76 6572 7369 6f6e    client_version
+0001db30: 3d63 6c69 656e 745f 7665 7273 696f 6e2c  =client_version,
+0001db40: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+0001db50: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0001db60: 6e20 5472 7565 0a20 2020 2020 2020 2069  n True.        i
+0001db70: 6620 2870 6172 7365 645f 7365 7276 6572  f (parsed_server
+0001db80: 5f76 6572 7369 6f6e 2e6d 616a 6f72 203d  _version.major =
+0001db90: 3d20 3020 616e 6420 7061 7273 6564 5f73  = 0 and parsed_s
+0001dba0: 6572 7665 725f 7665 7273 696f 6e2e 6d69  erver_version.mi
+0001dbb0: 6e6f 7220 3d3d 2030 2920 6f72 2028 0a20  nor == 0) or (. 
+0001dbc0: 2020 2020 2020 2020 2020 2070 6172 7365             parse
+0001dbd0: 645f 636c 6965 6e74 5f76 6572 7369 6f6e  d_client_version
+0001dbe0: 2e6d 616a 6f72 203d 3d20 3020 616e 6420  .major == 0 and 
+0001dbf0: 7061 7273 6564 5f63 6c69 656e 745f 7665  parsed_client_ve
+0001dc00: 7273 696f 6e2e 6d69 6e6f 7220 3d3d 2030  rsion.minor == 0
+0001dc10: 0a20 2020 2020 2020 2029 3a0a 2020 2020  .        ):.    
+0001dc20: 2020 2020 2020 2020 6c6f 6767 6572 2e77          logger.w
+0001dc30: 6172 6e69 6e67 280a 2020 2020 2020 2020  arning(.        
+0001dc40: 2020 2020 2020 2020 2253 6572 7665 7220          "Server 
+0001dc50: 6f72 2063 6c69 656e 7420 7665 7273 696f  or client versio
+0001dc60: 6e20 6973 2075 6e73 7461 626c 652e 2041  n is unstable. A
+0001dc70: 7373 756d 696e 6720 636f 6d70 6174 6962  ssuming compatib
+0001dc80: 6c65 222c 0a20 2020 2020 2020 2020 2020  le",.           
+0001dc90: 2020 2020 2073 6572 7665 725f 7665 7273       server_vers
+0001dca0: 696f 6e3d 7365 7276 6572 5f76 6572 7369  ion=server_versi
+0001dcb0: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
+0001dcc0: 2020 2020 636c 6965 6e74 5f76 6572 7369      client_versi
+0001dcd0: 6f6e 3d63 6c69 656e 745f 7665 7273 696f  on=client_versio
+0001dce0: 6e2c 0a20 2020 2020 2020 2020 2020 2029  n,.            )
+0001dcf0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0001dd00: 7572 6e20 5472 7565 0a20 2020 2020 2020  urn True.       
+0001dd10: 2069 6620 7061 7273 6564 5f73 6572 7665   if parsed_serve
+0001dd20: 725f 7665 7273 696f 6e2e 6d61 6a6f 7220  r_version.major 
+0001dd30: 213d 2070 6172 7365 645f 636c 6965 6e74  != parsed_client
+0001dd40: 5f76 6572 7369 6f6e 2e6d 616a 6f72 3a0a  _version.major:.
+0001dd50: 2020 2020 2020 2020 2020 2020 6c6f 6767              logg
+0001dd60: 6572 2e77 6172 6e69 6e67 280a 2020 2020  er.warning(.    
+0001dd70: 2020 2020 2020 2020 2020 2020 2253 6572              "Ser
+0001dd80: 7665 7220 616e 6420 636c 6965 6e74 2076  ver and client v
+0001dd90: 6572 7369 6f6e 7320 6172 6520 696e 636f  ersions are inco
+0001dda0: 6d70 6174 6962 6c65 222c 0a20 2020 2020  mpatible",.     
+0001ddb0: 2020 2020 2020 2020 2020 2070 6172 7365             parse
+0001ddc0: 645f 7365 7276 6572 5f76 6572 7369 6f6e  d_server_version
+0001ddd0: 3d70 6172 7365 645f 7365 7276 6572 5f76  =parsed_server_v
+0001dde0: 6572 7369 6f6e 2c0a 2020 2020 2020 2020  ersion,.        
+0001ddf0: 2020 2020 2020 2020 7061 7273 6564 5f63          parsed_c
+0001de00: 6c69 656e 745f 7665 7273 696f 6e3d 7061  lient_version=pa
+0001de10: 7273 6564 5f63 6c69 656e 745f 7665 7273  rsed_client_vers
+0001de20: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
+0001de30: 2029 0a20 2020 2020 2020 2020 2020 2072   ).            r
+0001de40: 6574 7572 6e20 4661 6c73 650a 2020 2020  eturn False.    
+0001de50: 2020 2020 6966 2070 6172 7365 645f 7365      if parsed_se
+0001de60: 7276 6572 5f76 6572 7369 6f6e 2e6d 696e  rver_version.min
+0001de70: 6f72 203e 2070 6172 7365 645f 636c 6965  or > parsed_clie
+0001de80: 6e74 5f76 6572 7369 6f6e 2e6d 696e 6f72  nt_version.minor
+0001de90: 202b 2032 3a0a 2020 2020 2020 2020 2020   + 2:.          
+0001dea0: 2020 6c6f 6767 6572 2e69 6e66 6f28 0a20    logger.info(. 
+0001deb0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0001dec0: 4261 636b 7761 7264 7320 636f 6d70 6174  Backwards compat
+0001ded0: 6962 696c 6974 7920 6d69 6768 7420 6e6f  ibility might no
+0001dee0: 7420 6170 706c 7920 6265 7477 6565 6e20  t apply between 
+0001def0: 7468 6520 7365 7276 6572 2061 6e64 2063  the server and c
+0001df00: 6c69 656e 7420 7665 7273 696f 6e22 2c0a  lient version",.
+0001df10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001df20: 7061 7273 6564 5f73 6572 7665 725f 7665  parsed_server_ve
+0001df30: 7273 696f 6e3d 7061 7273 6564 5f73 6572  rsion=parsed_ser
+0001df40: 7665 725f 7665 7273 696f 6e2c 0a20 2020  ver_version,.   
+0001df50: 2020 2020 2020 2020 2020 2020 2070 6172               par
+0001df60: 7365 645f 636c 6965 6e74 5f76 6572 7369  sed_client_versi
+0001df70: 6f6e 3d70 6172 7365 645f 636c 6965 6e74  on=parsed_client
+0001df80: 5f76 6572 7369 6f6e 2c0a 2020 2020 2020  _version,.      
+0001df90: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0001dfa0: 2020 2020 7265 7475 726e 2046 616c 7365      return False
+0001dfb0: 0a20 2020 2020 2020 2069 6620 7061 7273  .        if pars
+0001dfc0: 6564 5f63 6c69 656e 745f 7665 7273 696f  ed_client_versio
+0001dfd0: 6e2e 6d69 6e6f 7220 3e20 7061 7273 6564  n.minor > parsed
+0001dfe0: 5f73 6572 7665 725f 7665 7273 696f 6e2e  _server_version.
+0001dff0: 6d69 6e6f 723a 0a20 2020 2020 2020 2020  minor:.         
+0001e000: 2020 206c 6f67 6765 722e 7761 726e 696e     logger.warnin
+0001e010: 6728 0a20 2020 2020 2020 2020 2020 2020  g(.             
+0001e020: 2020 2022 436c 6965 6e74 2076 6572 7369     "Client versi
+0001e030: 6f6e 2077 6974 6820 6869 6768 6572 2076  on with higher v
+0001e040: 6572 7369 6f6e 2074 6861 6e20 7365 7276  ersion than serv
+0001e050: 6572 2076 6572 7369 6f6e 2069 736e 2774  er version isn't
+0001e060: 2073 7570 706f 7274 6564 2c22 0a20 2020   supported,".   
+0001e070: 2020 2020 2020 2020 2020 2020 2022 2061               " a
+0001e080: 6c69 676e 2079 6f75 7220 636c 6965 6e74  lign your client
+0001e090: 2074 6f20 7468 6520 7365 7276 6572 2076   to the server v
+0001e0a0: 6572 7369 6f6e 222c 0a20 2020 2020 2020  ersion",.       
+0001e0b0: 2020 2020 2020 2020 2070 6172 7365 645f           parsed_
+0001e0c0: 7365 7276 6572 5f76 6572 7369 6f6e 3d70  server_version=p
+0001e0d0: 6172 7365 645f 7365 7276 6572 5f76 6572  arsed_server_ver
+0001e0e0: 7369 6f6e 2c0a 2020 2020 2020 2020 2020  sion,.          
+0001e0f0: 2020 2020 2020 7061 7273 6564 5f63 6c69        parsed_cli
+0001e100: 656e 745f 7665 7273 696f 6e3d 7061 7273  ent_version=pars
+0001e110: 6564 5f63 6c69 656e 745f 7665 7273 696f  ed_client_versio
+0001e120: 6e2c 0a20 2020 2020 2020 2020 2020 2029  n,.            )
+0001e130: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0001e140: 7572 6e20 4661 6c73 650a 2020 2020 2020  urn False.      
+0001e150: 2020 6966 2070 6172 7365 645f 7365 7276    if parsed_serv
+0001e160: 6572 5f76 6572 7369 6f6e 2e6d 696e 6f72  er_version.minor
+0001e170: 2021 3d20 7061 7273 6564 5f63 6c69 656e   != parsed_clien
+0001e180: 745f 7665 7273 696f 6e2e 6d69 6e6f 723a  t_version.minor:
+0001e190: 0a20 2020 2020 2020 2020 2020 206c 6f67  .            log
+0001e1a0: 6765 722e 696e 666f 280a 2020 2020 2020  ger.info(.      
+0001e1b0: 2020 2020 2020 2020 2020 2253 6572 7665            "Serve
+0001e1c0: 7220 616e 6420 636c 6965 6e74 2076 6572  r and client ver
+0001e1d0: 7369 6f6e 7320 6172 6520 6e6f 7420 7468  sions are not th
+0001e1e0: 6520 7361 6d65 2062 7574 2063 6f6d 7061  e same but compa
+0001e1f0: 7469 626c 6522 2c0a 2020 2020 2020 2020  tible",.        
+0001e200: 2020 2020 2020 2020 7061 7273 6564 5f73          parsed_s
+0001e210: 6572 7665 725f 7665 7273 696f 6e3d 7061  erver_version=pa
+0001e220: 7273 6564 5f73 6572 7665 725f 7665 7273  rsed_server_vers
+0001e230: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
+0001e240: 2020 2020 2070 6172 7365 645f 636c 6965       parsed_clie
+0001e250: 6e74 5f76 6572 7369 6f6e 3d70 6172 7365  nt_version=parse
+0001e260: 645f 636c 6965 6e74 5f76 6572 7369 6f6e  d_client_version
+0001e270: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
+0001e280: 2020 2020 2020 2020 7265 7475 726e 2054          return T
+0001e290: 7275 650a 0a20 2020 2064 6566 2063 7265  rue..    def cre
+0001e2a0: 6174 655f 6d6f 6465 6c5f 656e 6470 6f69  ate_model_endpoi
+0001e2b0: 6e74 280a 2020 2020 2020 2020 7365 6c66  nt(.        self
+0001e2c0: 2c0a 2020 2020 2020 2020 7072 6f6a 6563  ,.        projec
+0001e2d0: 743a 2073 7472 2c0a 2020 2020 2020 2020  t: str,.        
+0001e2e0: 656e 6470 6f69 6e74 5f69 643a 2073 7472  endpoint_id: str
+0001e2f0: 2c0a 2020 2020 2020 2020 6d6f 6465 6c5f  ,.        model_
+0001e300: 656e 6470 6f69 6e74 3a20 556e 696f 6e5b  endpoint: Union[
+0001e310: 0a20 2020 2020 2020 2020 2020 206d 6c72  .            mlr
+0001e320: 756e 2e6d 6f64 656c 5f6d 6f6e 6974 6f72  un.model_monitor
+0001e330: 696e 672e 6d6f 6465 6c5f 656e 6470 6f69  ing.model_endpoi
+0001e340: 6e74 2e4d 6f64 656c 456e 6470 6f69 6e74  nt.ModelEndpoint
+0001e350: 2c20 6469 6374 0a20 2020 2020 2020 205d  , dict.        ]
+0001e360: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
+0001e370: 2022 2222 0a20 2020 2020 2020 2043 7265   """.        Cre
+0001e380: 6174 6573 2061 2044 4220 7265 636f 7264  ates a DB record
+0001e390: 2077 6974 6820 7468 6520 6769 7665 6e20   with the given 
+0001e3a0: 6d6f 6465 6c5f 656e 6470 6f69 6e74 2072  model_endpoint r
+0001e3b0: 6563 6f72 642e 0a0a 2020 2020 2020 2020  ecord...        
+0001e3c0: 3a70 6172 616d 2070 726f 6a65 6374 3a20  :param project: 
+0001e3d0: 5468 6520 6e61 6d65 206f 6620 7468 6520  The name of the 
+0001e3e0: 7072 6f6a 6563 742e 0a20 2020 2020 2020  project..       
+0001e3f0: 203a 7061 7261 6d20 656e 6470 6f69 6e74   :param endpoint
+0001e400: 5f69 643a 2054 6865 2069 6420 6f66 2074  _id: The id of t
+0001e410: 6865 2065 6e64 706f 696e 742e 0a20 2020  he endpoint..   
+0001e420: 2020 2020 203a 7061 7261 6d20 6d6f 6465       :param mode
+0001e430: 6c5f 656e 6470 6f69 6e74 3a20 416e 206f  l_endpoint: An o
+0001e440: 626a 6563 7420 7265 7072 6573 656e 7469  bject representi
+0001e450: 6e67 2074 6865 206d 6f64 656c 2065 6e64  ng the model end
+0001e460: 706f 696e 742e 0a20 2020 2020 2020 2022  point..        "
+0001e470: 2222 0a0a 2020 2020 2020 2020 6966 2069  ""..        if i
+0001e480: 7369 6e73 7461 6e63 6528 0a20 2020 2020  sinstance(.     
+0001e490: 2020 2020 2020 206d 6f64 656c 5f65 6e64         model_end
+0001e4a0: 706f 696e 742c 206d 6c72 756e 2e6d 6f64  point, mlrun.mod
+0001e4b0: 656c 5f6d 6f6e 6974 6f72 696e 672e 6d6f  el_monitoring.mo
+0001e4c0: 6465 6c5f 656e 6470 6f69 6e74 2e4d 6f64  del_endpoint.Mod
+0001e4d0: 656c 456e 6470 6f69 6e74 0a20 2020 2020  elEndpoint.     
+0001e4e0: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
+0001e4f0: 2020 6d6f 6465 6c5f 656e 6470 6f69 6e74    model_endpoint
+0001e500: 203d 206d 6f64 656c 5f65 6e64 706f 696e   = model_endpoin
+0001e510: 742e 746f 5f64 6963 7428 290a 0a20 2020  t.to_dict()..   
+0001e520: 2020 2020 2070 6174 6820 3d20 6622 7072       path = f"pr
+0001e530: 6f6a 6563 7473 2f7b 7072 6f6a 6563 747d  ojects/{project}
+0001e540: 2f6d 6f64 656c 2d65 6e64 706f 696e 7473  /model-endpoints
+0001e550: 2f7b 656e 6470 6f69 6e74 5f69 647d 220a  /{endpoint_id}".
+0001e560: 2020 2020 2020 2020 7365 6c66 2e61 7069          self.api
+0001e570: 5f63 616c 6c28 0a20 2020 2020 2020 2020  _call(.         
+0001e580: 2020 206d 6574 686f 643d 2250 4f53 5422     method="POST"
+0001e590: 2c0a 2020 2020 2020 2020 2020 2020 7061  ,.            pa
+0001e5a0: 7468 3d70 6174 682c 0a20 2020 2020 2020  th=path,.       
+0001e5b0: 2020 2020 2062 6f64 793d 6469 6374 5f74       body=dict_t
+0001e5c0: 6f5f 6a73 6f6e 286d 6f64 656c 5f65 6e64  o_json(model_end
+0001e5d0: 706f 696e 7429 2c0a 2020 2020 2020 2020  point),.        
+0001e5e0: 290a 0a20 2020 2064 6566 2064 656c 6574  )..    def delet
+0001e5f0: 655f 6d6f 6465 6c5f 656e 6470 6f69 6e74  e_model_endpoint
+0001e600: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+0001e610: 2020 2020 2020 2020 7072 6f6a 6563 743a          project:
+0001e620: 2073 7472 2c0a 2020 2020 2020 2020 656e   str,.        en
+0001e630: 6470 6f69 6e74 5f69 643a 2073 7472 2c0a  dpoint_id: str,.
+0001e640: 2020 2020 293a 0a20 2020 2020 2020 2022      ):.        "
+0001e650: 2222 0a20 2020 2020 2020 2044 656c 6574  "".        Delet
+0001e660: 6573 2074 6865 2044 4220 7265 636f 7264  es the DB record
+0001e670: 206f 6620 6120 6769 7665 6e20 6d6f 6465   of a given mode
+0001e680: 6c20 656e 6470 6f69 6e74 2c20 7072 6f6a  l endpoint, proj
+0001e690: 6563 7420 616e 6420 656e 6470 6f69 6e74  ect and endpoint
+0001e6a0: 5f69 6420 6172 6520 7573 6564 2066 6f72  _id are used for
+0001e6b0: 206c 6f6f 6b75 700a 0a20 2020 2020 2020   lookup..       
+0001e6c0: 203a 7061 7261 6d20 7072 6f6a 6563 743a   :param project:
+0001e6d0: 2054 6865 206e 616d 6520 6f66 2074 6865   The name of the
+0001e6e0: 2070 726f 6a65 6374 0a20 2020 2020 2020   project.       
+0001e6f0: 203a 7061 7261 6d20 656e 6470 6f69 6e74   :param endpoint
+0001e700: 5f69 643a 2054 6865 2069 6420 6f66 2074  _id: The id of t
+0001e710: 6865 2065 6e64 706f 696e 740a 2020 2020  he endpoint.    
+0001e720: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
+0001e730: 2070 6174 6820 3d20 6622 7072 6f6a 6563   path = f"projec
+0001e740: 7473 2f7b 7072 6f6a 6563 747d 2f6d 6f64  ts/{project}/mod
+0001e750: 656c 2d65 6e64 706f 696e 7473 2f7b 656e  el-endpoints/{en
+0001e760: 6470 6f69 6e74 5f69 647d 220a 2020 2020  dpoint_id}".    
+0001e770: 2020 2020 7365 6c66 2e61 7069 5f63 616c      self.api_cal
+0001e780: 6c28 0a20 2020 2020 2020 2020 2020 206d  l(.            m
+0001e790: 6574 686f 643d 2244 454c 4554 4522 2c0a  ethod="DELETE",.
+0001e7a0: 2020 2020 2020 2020 2020 2020 7061 7468              path
+0001e7b0: 3d70 6174 682c 0a20 2020 2020 2020 2029  =path,.        )
+0001e7c0: 0a0a 2020 2020 6465 6620 6c69 7374 5f6d  ..    def list_m
+0001e7d0: 6f64 656c 5f65 6e64 706f 696e 7473 280a  odel_endpoints(.
+0001e7e0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+0001e7f0: 2020 2020 2020 7072 6f6a 6563 743a 2073        project: s
+0001e800: 7472 2c0a 2020 2020 2020 2020 6d6f 6465  tr,.        mode
+0001e810: 6c3a 204f 7074 696f 6e61 6c5b 7374 725d  l: Optional[str]
+0001e820: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+0001e830: 2066 756e 6374 696f 6e3a 204f 7074 696f   function: Optio
+0001e840: 6e61 6c5b 7374 725d 203d 204e 6f6e 652c  nal[str] = None,
+0001e850: 0a20 2020 2020 2020 206c 6162 656c 733a  .        labels:
+0001e860: 206c 6973 745b 7374 725d 203d 204e 6f6e   list[str] = Non
+0001e870: 652c 0a20 2020 2020 2020 2073 7461 7274  e,.        start
+0001e880: 3a20 7374 7220 3d20 226e 6f77 2d31 6822  : str = "now-1h"
+0001e890: 2c0a 2020 2020 2020 2020 656e 643a 2073  ,.        end: s
+0001e8a0: 7472 203d 2022 6e6f 7722 2c0a 2020 2020  tr = "now",.    
+0001e8b0: 2020 2020 6d65 7472 6963 733a 204f 7074      metrics: Opt
+0001e8c0: 696f 6e61 6c5b 6c69 7374 5b73 7472 5d5d  ional[list[str]]
+0001e8d0: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+0001e8e0: 2074 6f70 5f6c 6576 656c 3a20 626f 6f6c   top_level: bool
+0001e8f0: 203d 2046 616c 7365 2c0a 2020 2020 2020   = False,.      
+0001e900: 2020 7569 6473 3a20 4f70 7469 6f6e 616c    uids: Optional
+0001e910: 5b6c 6973 745b 7374 725d 5d20 3d20 4e6f  [list[str]] = No
+0001e920: 6e65 2c0a 2020 2020 2920 2d3e 206c 6973  ne,.    ) -> lis
+0001e930: 745b 6d6c 7275 6e2e 6d6f 6465 6c5f 6d6f  t[mlrun.model_mo
+0001e940: 6e69 746f 7269 6e67 2e6d 6f64 656c 5f65  nitoring.model_e
+0001e950: 6e64 706f 696e 742e 4d6f 6465 6c45 6e64  ndpoint.ModelEnd
+0001e960: 706f 696e 745d 3a0a 2020 2020 2020 2020  point]:.        
+0001e970: 2222 220a 2020 2020 2020 2020 5265 7475  """.        Retu
+0001e980: 726e 7320 6120 6c69 7374 206f 6620 604d  rns a list of `M
+0001e990: 6f64 656c 456e 6470 6f69 6e74 6020 6f62  odelEndpoint` ob
+0001e9a0: 6a65 6374 732e 2045 6163 6820 604d 6f64  jects. Each `Mod
+0001e9b0: 656c 456e 6470 6f69 6e74 6020 6f62 6a65  elEndpoint` obje
+0001e9c0: 6374 2072 6570 7265 7365 6e74 7320 7468  ct represents th
+0001e9d0: 6520 6375 7272 656e 7420 7374 6174 6520  e current state 
+0001e9e0: 6f66 2061 0a20 2020 2020 2020 206d 6f64  of a.        mod
+0001e9f0: 656c 2065 6e64 706f 696e 742e 2054 6869  el endpoint. Thi
+0001ea00: 7320 6675 6e63 7469 6f6e 7320 7375 7070  s functions supp
+0001ea10: 6f72 7473 2066 696c 7465 7269 6e67 2062  orts filtering b
+0001ea20: 7920 7468 6520 666f 6c6c 6f77 696e 6720  y the following 
+0001ea30: 7061 7261 6d65 7465 7273 3a0a 2020 2020  parameters:.    
+0001ea40: 2020 2020 3129 206d 6f64 656c 0a20 2020      1) model.   
+0001ea50: 2020 2020 2032 2920 6675 6e63 7469 6f6e       2) function
+0001ea60: 0a20 2020 2020 2020 2033 2920 6c61 6265  .        3) labe
+0001ea70: 6c73 0a20 2020 2020 2020 2034 2920 746f  ls.        4) to
+0001ea80: 7020 6c65 7665 6c0a 2020 2020 2020 2020  p level.        
+0001ea90: 3529 2075 6964 730a 2020 2020 2020 2020  5) uids.        
+0001eaa0: 4279 2064 6566 6175 6c74 2c20 7768 656e  By default, when
+0001eab0: 206e 6f20 6669 6c74 6572 7320 6172 6520   no filters are 
+0001eac0: 6170 706c 6965 642c 2061 6c6c 2061 7661  applied, all ava
+0001ead0: 696c 6162 6c65 2065 6e64 706f 696e 7473  ilable endpoints
+0001eae0: 2066 6f72 2074 6865 2067 6976 656e 2070   for the given p
+0001eaf0: 726f 6a65 6374 2077 696c 6c20 6265 206c  roject will be l
+0001eb00: 6973 7465 642e 0a0a 2020 2020 2020 2020  isted...        
+0001eb10: 496e 2061 6464 6974 696f 6e2c 2074 6869  In addition, thi
+0001eb20: 7320 6675 6e63 7469 6f6e 7320 7072 6f76  s functions prov
+0001eb30: 6964 6573 2061 2066 6163 6164 6520 666f  ides a facade fo
+0001eb40: 7220 6c69 7374 696e 6720 656e 6470 6f69  r listing endpoi
+0001eb50: 6e74 2072 656c 6174 6564 206d 6574 7269  nt related metri
+0001eb60: 6373 2e20 5468 6973 2066 6163 6164 6520  cs. This facade 
+0001eb70: 6973 2074 696d 652d 6261 7365 640a 2020  is time-based.  
+0001eb80: 2020 2020 2020 616e 6420 6465 7065 6e64        and depend
+0001eb90: 7320 6f6e 2074 6865 2027 7374 6172 7427  s on the 'start'
+0001eba0: 2061 6e64 2027 656e 6427 2070 6172 616d   and 'end' param
+0001ebb0: 6574 6572 732e 2042 7920 6465 6661 756c  eters. By defaul
+0001ebc0: 742c 2077 6865 6e20 7468 6520 6d65 7472  t, when the metr
+0001ebd0: 6963 7320 7061 7261 6d65 7465 7220 6973  ics parameter is
+0001ebe0: 204e 6f6e 652c 206e 6f20 6d65 7472 6963   None, no metric
+0001ebf0: 7320 6172 650a 2020 2020 2020 2020 6164  s are.        ad
+0001ec00: 6465 6420 746f 2074 6865 206f 7574 7075  ded to the outpu
+0001ec10: 7420 6f66 2074 6869 7320 6675 6e63 7469  t of this functi
+0001ec20: 6f6e 2e0a 0a20 2020 2020 2020 203a 7061  on...        :pa
+0001ec30: 7261 6d20 7072 6f6a 6563 743a 2054 6865  ram project: The
+0001ec40: 206e 616d 6520 6f66 2074 6865 2070 726f   name of the pro
+0001ec50: 6a65 6374 0a20 2020 2020 2020 203a 7061  ject.        :pa
+0001ec60: 7261 6d20 6d6f 6465 6c3a 2054 6865 206e  ram model: The n
+0001ec70: 616d 6520 6f66 2074 6865 206d 6f64 656c  ame of the model
+0001ec80: 2074 6f20 6669 6c74 6572 2062 790a 2020   to filter by.  
+0001ec90: 2020 2020 2020 3a70 6172 616d 2066 756e        :param fun
+0001eca0: 6374 696f 6e3a 2054 6865 206e 616d 6520  ction: The name 
+0001ecb0: 6f66 2074 6865 2066 756e 6374 696f 6e20  of the function 
+0001ecc0: 746f 2066 696c 7465 7220 6279 0a20 2020  to filter by.   
+0001ecd0: 2020 2020 203a 7061 7261 6d20 6c61 6265       :param labe
+0001ece0: 6c73 3a20 4120 6c69 7374 206f 6620 6c61  ls: A list of la
+0001ecf0: 6265 6c73 2074 6f20 6669 6c74 6572 2062  bels to filter b
+0001ed00: 792e 204c 6162 656c 2066 696c 7465 7273  y. Label filters
+0001ed10: 2077 6f72 6b20 6279 2065 6974 6865 7220   work by either 
+0001ed20: 6669 6c74 6572 696e 6720 6120 7370 6563  filtering a spec
+0001ed30: 6966 6963 2076 616c 7565 206f 6620 610a  ific value of a.
+0001ed40: 2020 2020 2020 2020 206c 6162 656c 2028           label (
+0001ed50: 692e 652e 206c 6973 7428 226b 6579 3d76  i.e. list("key=v
+0001ed60: 616c 7565 2229 2920 6f72 2062 7920 6c6f  alue")) or by lo
+0001ed70: 6f6b 696e 6720 666f 7220 7468 6520 6578  oking for the ex
+0001ed80: 6973 7465 6e63 6520 6f66 2061 2067 6976  istence of a giv
+0001ed90: 656e 206b 6579 2028 692e 652e 2022 6b65  en key (i.e. "ke
+0001eda0: 7922 290a 2020 2020 2020 2020 3a70 6172  y").        :par
+0001edb0: 616d 206d 6574 7269 6373 3a20 4120 6c69  am metrics: A li
+0001edc0: 7374 206f 6620 6d65 7472 6963 7320 746f  st of metrics to
+0001edd0: 2072 6574 7572 6e20 666f 7220 6561 6368   return for each
+0001ede0: 2065 6e64 706f 696e 742c 2072 6561 6420   endpoint, read 
+0001edf0: 6d6f 7265 2069 6e20 2754 696d 654d 6574  more in 'TimeMet
+0001ee00: 7269 6327 0a20 2020 2020 2020 203a 7061  ric'.        :pa
+0001ee10: 7261 6d20 7374 6172 743a 2054 6865 2073  ram start: The s
+0001ee20: 7461 7274 2074 696d 6520 6f66 2074 6865  tart time of the
+0001ee30: 206d 6574 7269 6373 2e20 4361 6e20 6265   metrics. Can be
+0001ee40: 2072 6570 7265 7365 6e74 6564 2062 7920   represented by 
+0001ee50: 6120 7374 7269 6e67 2063 6f6e 7461 696e  a string contain
+0001ee60: 696e 6720 616e 2052 4643 2033 3333 390a  ing an RFC 3339.
+0001ee70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ee80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ee90: 2074 696d 652c 2061 2055 6e69 7820 7469   time, a Unix ti
+0001eea0: 6d65 7374 616d 7020 696e 206d 696c 6c69  mestamp in milli
+0001eeb0: 7365 636f 6e64 732c 2061 2072 656c 6174  seconds, a relat
+0001eec0: 6976 6520 7469 6d65 2028 6027 6e6f 7727  ive time (`'now'
+0001eed0: 6020 6f72 0a20 2020 2020 2020 2020 2020  ` or.           
+0001eee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001eef0: 2020 2020 2020 6027 6e6f 772d 5b30 2d39        `'now-[0-9
+0001ef00: 5d2b 5b6d 6864 5d27 602c 2077 6865 7265  ]+[mhd]'`, where
+0001ef10: 2060 6d60 203d 206d 696e 7574 6573 2c20   `m` = minutes, 
+0001ef20: 6068 6020 3d20 686f 7572 732c 2061 6e64  `h` = hours, and
+0001ef30: 2060 2764 2760 203d 0a20 2020 2020 2020   `'d'` =.       
+0001ef40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ef50: 2020 2020 2020 2020 2020 6461 7973 292c            days),
+0001ef60: 206f 7220 3020 666f 7220 7468 6520 6561   or 0 for the ea
+0001ef70: 726c 6965 7374 2074 696d 652e 0a20 2020  rliest time..   
+0001ef80: 2020 2020 203a 7061 7261 6d20 656e 643a       :param end:
+0001ef90: 2054 6865 2065 6e64 2074 696d 6520 6f66   The end time of
+0001efa0: 2074 6865 206d 6574 7269 6373 2e20 4361   the metrics. Ca
+0001efb0: 6e20 6265 2072 6570 7265 7365 6e74 6564  n be represented
+0001efc0: 2062 7920 6120 7374 7269 6e67 2063 6f6e   by a string con
+0001efd0: 7461 696e 696e 6720 616e 2052 4643 2033  taining an RFC 3
+0001efe0: 3333 390a 2020 2020 2020 2020 2020 2020  339.            
+0001eff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f000: 2020 2020 2074 696d 652c 2061 2055 6e69       time, a Uni
+0001f010: 7820 7469 6d65 7374 616d 7020 696e 206d  x timestamp in m
+0001f020: 696c 6c69 7365 636f 6e64 732c 2061 2072  illiseconds, a r
+0001f030: 656c 6174 6976 6520 7469 6d65 2028 6027  elative time (`'
+0001f040: 6e6f 7727 6020 6f72 0a20 2020 2020 2020  now'` or.       
+0001f050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f060: 2020 2020 2020 2020 2020 6027 6e6f 772d            `'now-
+0001f070: 5b30 2d39 5d2b 5b6d 6864 5d27 602c 2077  [0-9]+[mhd]'`, w
+0001f080: 6865 7265 2060 6d60 203d 206d 696e 7574  here `m` = minut
+0001f090: 6573 2c20 6068 6020 3d20 686f 7572 732c  es, `h` = hours,
+0001f0a0: 2061 6e64 2060 2764 2760 203d 0a20 2020   and `'d'` =.   
+0001f0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f0c0: 2020 2020 2020 2020 2020 2020 2020 6461                da
+0001f0d0: 7973 292c 206f 7220 3020 666f 7220 7468  ys), or 0 for th
+0001f0e0: 6520 6561 726c 6965 7374 2074 696d 652e  e earliest time.
+0001f0f0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0001f100: 746f 705f 6c65 7665 6c3a 2069 6620 7472  top_level: if tr
+0001f110: 7565 2077 696c 6c20 7265 7475 726e 206f  ue will return o
+0001f120: 6e6c 7920 726f 7574 6572 7320 616e 6420  nly routers and 
+0001f130: 656e 6470 6f69 6e74 2074 6861 7420 6172  endpoint that ar
+0001f140: 6520 4e4f 5420 6368 696c 6472 656e 206f  e NOT children o
+0001f150: 6620 616e 7920 726f 7574 6572 0a20 2020  f any router.   
+0001f160: 2020 2020 203a 7061 7261 6d20 7569 6473       :param uids
+0001f170: 3a20 6966 2070 6173 7365 6420 7769 6c6c  : if passed will
+0001f180: 2072 6574 7572 6e20 6120 6c69 7374 2060   return a list `
+0001f190: 4d6f 6465 6c45 6e64 706f 696e 7460 206f  ModelEndpoint` o
+0001f1a0: 626a 6563 7420 7769 7468 2075 6964 2069  bject with uid i
+0001f1b0: 6e20 7569 6473 0a20 2020 2020 2020 2022  n uids.        "
+0001f1c0: 2222 0a0a 2020 2020 2020 2020 7061 7468  ""..        path
+0001f1d0: 203d 2066 2270 726f 6a65 6374 732f 7b70   = f"projects/{p
+0001f1e0: 726f 6a65 6374 7d2f 6d6f 6465 6c2d 656e  roject}/model-en
+0001f1f0: 6470 6f69 6e74 7322 0a0a 2020 2020 2020  dpoints"..      
+0001f200: 2020 6966 206c 6162 656c 7320 616e 6420    if labels and 
+0001f210: 6973 696e 7374 616e 6365 286c 6162 656c  isinstance(label
+0001f220: 732c 2064 6963 7429 3a0a 2020 2020 2020  s, dict):.      
+0001f230: 2020 2020 2020 6c61 6265 6c73 203d 205b        labels = [
+0001f240: 6622 7b6b 6579 7d3d 7b76 616c 7565 7d22  f"{key}={value}"
+0001f250: 2066 6f72 206b 6579 2c20 7661 6c75 6520   for key, value 
+0001f260: 696e 206c 6162 656c 732e 6974 656d 7328  in labels.items(
+0001f270: 295d 0a0a 2020 2020 2020 2020 7265 7370  )]..        resp
+0001f280: 6f6e 7365 203d 2073 656c 662e 6170 695f  onse = self.api_
+0001f290: 6361 6c6c 280a 2020 2020 2020 2020 2020  call(.          
+0001f2a0: 2020 6d65 7468 6f64 3d22 4745 5422 2c0a    method="GET",.
+0001f2b0: 2020 2020 2020 2020 2020 2020 7061 7468              path
+0001f2c0: 3d70 6174 682c 0a20 2020 2020 2020 2020  =path,.         
+0001f2d0: 2020 2070 6172 616d 733d 7b0a 2020 2020     params={.    
+0001f2e0: 2020 2020 2020 2020 2020 2020 226d 6f64              "mod
+0001f2f0: 656c 223a 206d 6f64 656c 2c0a 2020 2020  el": model,.    
+0001f300: 2020 2020 2020 2020 2020 2020 2266 756e              "fun
+0001f310: 6374 696f 6e22 3a20 6675 6e63 7469 6f6e  ction": function
+0001f320: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001f330: 2020 226c 6162 656c 223a 206c 6162 656c    "label": label
+0001f340: 7320 6f72 205b 5d2c 0a20 2020 2020 2020  s or [],.       
+0001f350: 2020 2020 2020 2020 2022 7374 6172 7422           "start"
+0001f360: 3a20 7374 6172 742c 0a20 2020 2020 2020  : start,.       
+0001f370: 2020 2020 2020 2020 2022 656e 6422 3a20           "end": 
+0001f380: 656e 642c 0a20 2020 2020 2020 2020 2020  end,.           
+0001f390: 2020 2020 2022 6d65 7472 6963 223a 206d       "metric": m
+0001f3a0: 6574 7269 6373 206f 7220 5b5d 2c0a 2020  etrics or [],.  
+0001f3b0: 2020 2020 2020 2020 2020 2020 2020 2274                "t
+0001f3c0: 6f70 2d6c 6576 656c 223a 2074 6f70 5f6c  op-level": top_l
+0001f3d0: 6576 656c 2c0a 2020 2020 2020 2020 2020  evel,.          
+0001f3e0: 2020 2020 2020 2275 6964 223a 2075 6964        "uid": uid
+0001f3f0: 732c 0a20 2020 2020 2020 2020 2020 207d  s,.            }
+0001f400: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
+0001f410: 2020 2020 2023 2047 656e 6572 6174 6520       # Generate 
+0001f420: 6120 6c69 7374 206f 6620 6120 6d6f 6465  a list of a mode
+0001f430: 6c20 656e 6470 6f69 6e74 2064 6963 7469  l endpoint dicti
+0001f440: 6f6e 6172 6965 730a 2020 2020 2020 2020  onaries.        
+0001f450: 6d6f 6465 6c5f 656e 6470 6f69 6e74 7320  model_endpoints 
+0001f460: 3d20 7265 7370 6f6e 7365 2e6a 736f 6e28  = response.json(
+0001f470: 295b 2265 6e64 706f 696e 7473 225d 0a20  )["endpoints"]. 
+0001f480: 2020 2020 2020 2069 6620 6d6f 6465 6c5f         if model_
+0001f490: 656e 6470 6f69 6e74 733a 0a20 2020 2020  endpoints:.     
+0001f4a0: 2020 2020 2020 2072 6574 7572 6e20 5b0a         return [.
+0001f4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f4c0: 6d6c 7275 6e2e 6d6f 6465 6c5f 6d6f 6e69  mlrun.model_moni
+0001f4d0: 746f 7269 6e67 2e6d 6f64 656c 5f65 6e64  toring.model_end
+0001f4e0: 706f 696e 742e 4d6f 6465 6c45 6e64 706f  point.ModelEndpo
+0001f4f0: 696e 742e 6672 6f6d 5f64 6963 7428 6f62  int.from_dict(ob
+0001f500: 6a29 0a20 2020 2020 2020 2020 2020 2020  j).             
+0001f510: 2020 2066 6f72 206f 626a 2069 6e20 6d6f     for obj in mo
+0001f520: 6465 6c5f 656e 6470 6f69 6e74 730a 2020  del_endpoints.  
+0001f530: 2020 2020 2020 2020 2020 5d0a 2020 2020            ].    
+0001f540: 2020 2020 7265 7475 726e 205b 5d0a 0a20      return [].. 
+0001f550: 2020 2064 6566 2067 6574 5f6d 6f64 656c     def get_model
+0001f560: 5f65 6e64 706f 696e 7428 0a20 2020 2020  _endpoint(.     
+0001f570: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+0001f580: 2070 726f 6a65 6374 3a20 7374 722c 0a20   project: str,. 
+0001f590: 2020 2020 2020 2065 6e64 706f 696e 745f         endpoint_
+0001f5a0: 6964 3a20 7374 722c 0a20 2020 2020 2020  id: str,.       
+0001f5b0: 2073 7461 7274 3a20 4f70 7469 6f6e 616c   start: Optional
+0001f5c0: 5b73 7472 5d20 3d20 4e6f 6e65 2c0a 2020  [str] = None,.  
+0001f5d0: 2020 2020 2020 656e 643a 204f 7074 696f        end: Optio
+0001f5e0: 6e61 6c5b 7374 725d 203d 204e 6f6e 652c  nal[str] = None,
+0001f5f0: 0a20 2020 2020 2020 206d 6574 7269 6373  .        metrics
+0001f600: 3a20 4f70 7469 6f6e 616c 5b6c 6973 745b  : Optional[list[
+0001f610: 7374 725d 5d20 3d20 4e6f 6e65 2c0a 2020  str]] = None,.  
+0001f620: 2020 2020 2020 6665 6174 7572 655f 616e        feature_an
+0001f630: 616c 7973 6973 3a20 626f 6f6c 203d 2046  alysis: bool = F
+0001f640: 616c 7365 2c0a 2020 2020 2920 2d3e 206d  alse,.    ) -> m
+0001f650: 6c72 756e 2e6d 6f64 656c 5f6d 6f6e 6974  lrun.model_monit
+0001f660: 6f72 696e 672e 6d6f 6465 6c5f 656e 6470  oring.model_endp
+0001f670: 6f69 6e74 2e4d 6f64 656c 456e 6470 6f69  oint.ModelEndpoi
+0001f680: 6e74 3a0a 2020 2020 2020 2020 2222 220a  nt:.        """.
+0001f690: 2020 2020 2020 2020 5265 7475 726e 7320          Returns 
+0001f6a0: 6120 7369 6e67 6c65 2060 4d6f 6465 6c45  a single `ModelE
+0001f6b0: 6e64 706f 696e 7460 206f 626a 6563 7420  ndpoint` object 
+0001f6c0: 7769 7468 2061 6464 6974 696f 6e61 6c20  with additional 
+0001f6d0: 6d65 7472 6963 7320 616e 6420 6665 6174  metrics and feat
+0001f6e0: 7572 6520 7265 6c61 7465 6420 6461 7461  ure related data
+0001f6f0: 2e0a 0a20 2020 2020 2020 203a 7061 7261  ...        :para
+0001f700: 6d20 7072 6f6a 6563 743a 2020 2020 2020  m project:      
+0001f710: 2020 2020 2020 2020 2020 2020 2020 5468                Th
+0001f720: 6520 6e61 6d65 206f 6620 7468 6520 7072  e name of the pr
+0001f730: 6f6a 6563 740a 2020 2020 2020 2020 3a70  oject.        :p
+0001f740: 6172 616d 2065 6e64 706f 696e 745f 6964  aram endpoint_id
+0001f750: 3a20 2020 2020 2020 2020 2020 2020 2020  :               
+0001f760: 2054 6865 2075 6e69 7175 6520 6964 206f   The unique id o
+0001f770: 6620 7468 6520 6d6f 6465 6c20 656e 6470  f the model endp
+0001f780: 6f69 6e74 2e0a 2020 2020 2020 2020 3a70  oint..        :p
+0001f790: 6172 616d 2073 7461 7274 3a20 2020 2020  aram start:     
 0001f7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f7b0: 2020 2020 2020 2020 2020 2060 276e 6f77             `'now
-0001f7c0: 2d5b 302d 395d 2b5b 6d68 645d 2760 2c20  -[0-9]+[mhd]'`, 
-0001f7d0: 7768 6572 6520 606d 6020 3d20 6d69 6e75  where `m` = minu
-0001f7e0: 7465 732c 2060 6860 203d 2068 6f75 7273  tes, `h` = hours
-0001f7f0: 2c20 616e 6420 6027 6427 6020 3d20 6461  , and `'d'` = da
-0001f800: 7973 292c 206f 720a 2020 2020 2020 2020  ys), or.        
+0001f7b0: 2054 6865 2073 7461 7274 2074 696d 6520   The start time 
+0001f7c0: 6f66 2074 6865 206d 6574 7269 6373 2e20  of the metrics. 
+0001f7d0: 4361 6e20 6265 2072 6570 7265 7365 6e74  Can be represent
+0001f7e0: 6564 2062 7920 6120 7374 7269 6e67 2063  ed by a string c
+0001f7f0: 6f6e 7461 696e 696e 6720 616e 0a20 2020  ontaining an.   
+0001f800: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001f810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f830: 2020 2030 2066 6f72 2074 6865 2065 6172     0 for the ear
-0001f840: 6c69 6573 7420 7469 6d65 2e0a 2020 2020  liest time..    
-0001f850: 2020 2020 3a70 6172 616d 2065 6e64 3a20      :param end: 
-0001f860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f870: 2020 2020 2020 2054 6865 2065 6e64 2074         The end t
-0001f880: 696d 6520 6f66 2074 6865 206d 6574 7269  ime of the metri
-0001f890: 6373 2e20 4361 6e20 6265 2072 6570 7265  cs. Can be repre
-0001f8a0: 7365 6e74 6564 2062 7920 6120 7374 7269  sented by a stri
-0001f8b0: 6e67 2063 6f6e 7461 696e 696e 6720 616e  ng containing an
-0001f8c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001f8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f8e0: 2020 2020 2020 2020 2020 2020 5246 4320              RFC 
-0001f8f0: 3333 3339 2074 696d 652c 2061 2055 6e69  3339 time, a Uni
-0001f900: 7820 7469 6d65 7374 616d 7020 696e 206d  x timestamp in m
-0001f910: 696c 6c69 7365 636f 6e64 732c 2061 2072  illiseconds, a r
-0001f920: 656c 6174 6976 6520 7469 6d65 2028 6027  elative time (`'
-0001f930: 6e6f 7727 6020 6f72 0a20 2020 2020 2020  now'` or.       
-0001f940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f960: 2020 2020 6027 6e6f 772d 5b30 2d39 5d2b      `'now-[0-9]+
-0001f970: 5b6d 6864 5d27 602c 2077 6865 7265 2060  [mhd]'`, where `
-0001f980: 6d60 203d 206d 696e 7574 6573 2c20 6068  m` = minutes, `h
-0001f990: 6020 3d20 686f 7572 732c 2061 6e64 2060  ` = hours, and `
-0001f9a0: 2764 2760 203d 2064 6179 7329 2c20 6f72  'd'` = days), or
-0001f9b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001f820: 2020 2020 2020 2020 5246 4320 3333 3339          RFC 3339
+0001f830: 2074 696d 652c 2061 2055 6e69 7820 7469   time, a Unix ti
+0001f840: 6d65 7374 616d 7020 696e 206d 696c 6c69  mestamp in milli
+0001f850: 7365 636f 6e64 732c 2061 2072 656c 6174  seconds, a relat
+0001f860: 6976 6520 7469 6d65 2028 6027 6e6f 7727  ive time (`'now'
+0001f870: 6020 6f72 0a20 2020 2020 2020 2020 2020  ` or.           
+0001f880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f8a0: 6027 6e6f 772d 5b30 2d39 5d2b 5b6d 6864  `'now-[0-9]+[mhd
+0001f8b0: 5d27 602c 2077 6865 7265 2060 6d60 203d  ]'`, where `m` =
+0001f8c0: 206d 696e 7574 6573 2c20 6068 6020 3d20   minutes, `h` = 
+0001f8d0: 686f 7572 732c 2061 6e64 2060 2764 2760  hours, and `'d'`
+0001f8e0: 203d 2064 6179 7329 2c20 6f72 0a20 2020   = days), or.   
+0001f8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f910: 2020 2020 2020 2020 3020 666f 7220 7468          0 for th
+0001f920: 6520 6561 726c 6965 7374 2074 696d 652e  e earliest time.
+0001f930: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+0001f940: 656e 643a 2020 2020 2020 2020 2020 2020  end:            
+0001f950: 2020 2020 2020 2020 2020 2020 5468 6520              The 
+0001f960: 656e 6420 7469 6d65 206f 6620 7468 6520  end time of the 
+0001f970: 6d65 7472 6963 732e 2043 616e 2062 6520  metrics. Can be 
+0001f980: 7265 7072 6573 656e 7465 6420 6279 2061  represented by a
+0001f990: 2073 7472 696e 6720 636f 6e74 6169 6e69   string containi
+0001f9a0: 6e67 2061 6e0a 2020 2020 2020 2020 2020  ng an.          
+0001f9b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001f9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f9d0: 2020 2020 2020 2020 2020 2020 3020 666f              0 fo
-0001f9e0: 7220 7468 6520 6561 726c 6965 7374 2074  r the earliest t
-0001f9f0: 696d 652e 0a20 2020 2020 2020 203a 7061  ime..        :pa
-0001fa00: 7261 6d20 6d65 7472 6963 733a 2020 2020  ram metrics:    
-0001fa10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fa20: 4120 6c69 7374 206f 6620 6d65 7472 6963  A list of metric
-0001fa30: 7320 746f 2072 6574 7572 6e20 666f 7220  s to return for 
-0001fa40: 7468 6520 6d6f 6465 6c20 656e 6470 6f69  the model endpoi
-0001fa50: 6e74 2e20 5468 6572 6520 6172 6520 7072  nt. There are pr
-0001fa60: 652d 6465 6669 6e65 640a 2020 2020 2020  e-defined.      
-0001fa70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fa80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fa90: 2020 2020 206d 6574 7269 6373 2066 6f72       metrics for
-0001faa0: 206d 6f64 656c 2065 6e64 706f 696e 7473   model endpoints
-0001fab0: 2073 7563 6820 6173 2070 7265 6469 6374   such as predict
-0001fac0: 696f 6e73 5f70 6572 5f73 6563 6f6e 6420  ions_per_second 
-0001fad0: 616e 640a 2020 2020 2020 2020 2020 2020  and.            
-0001fae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001faf0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-0001fb00: 6174 656e 6379 5f61 7667 5f35 6d20 6275  atency_avg_5m bu
-0001fb10: 7420 616c 736f 2063 7573 746f 6d20 6d65  t also custom me
-0001fb20: 7472 6963 7320 6465 6669 6e65 6420 6279  trics defined by
-0001fb30: 2074 6865 2075 7365 722e 2050 6c65 6173   the user. Pleas
-0001fb40: 6520 6e6f 7465 2074 6861 740a 2020 2020  e note that.    
+0001f9d0: 2052 4643 2033 3333 3920 7469 6d65 2c20   RFC 3339 time, 
+0001f9e0: 6120 556e 6978 2074 696d 6573 7461 6d70  a Unix timestamp
+0001f9f0: 2069 6e20 6d69 6c6c 6973 6563 6f6e 6473   in milliseconds
+0001fa00: 2c20 6120 7265 6c61 7469 7665 2074 696d  , a relative tim
+0001fa10: 6520 2860 276e 6f77 2760 206f 720a 2020  e (`'now'` or.  
+0001fa20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fa30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fa40: 2020 2020 2020 2020 2060 276e 6f77 2d5b           `'now-[
+0001fa50: 302d 395d 2b5b 6d68 645d 2760 2c20 7768  0-9]+[mhd]'`, wh
+0001fa60: 6572 6520 606d 6020 3d20 6d69 6e75 7465  ere `m` = minute
+0001fa70: 732c 2060 6860 203d 2068 6f75 7273 2c20  s, `h` = hours, 
+0001fa80: 616e 6420 6027 6427 6020 3d20 6461 7973  and `'d'` = days
+0001fa90: 292c 206f 720a 2020 2020 2020 2020 2020  ), or.          
+0001faa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fac0: 2030 2066 6f72 2074 6865 2065 6172 6c69   0 for the earli
+0001fad0: 6573 7420 7469 6d65 2e0a 2020 2020 2020  est time..      
+0001fae0: 2020 3a70 6172 616d 206d 6574 7269 6373    :param metrics
+0001faf0: 3a20 2020 2020 2020 2020 2020 2020 2020  :               
+0001fb00: 2020 2020 2041 206c 6973 7420 6f66 206d       A list of m
+0001fb10: 6574 7269 6373 2074 6f20 7265 7475 726e  etrics to return
+0001fb20: 2066 6f72 2074 6865 206d 6f64 656c 2065   for the model e
+0001fb30: 6e64 706f 696e 742e 2054 6865 7265 2061  ndpoint. There a
+0001fb40: 7265 2070 7265 2d64 6566 696e 6564 0a20  re pre-defined. 
 0001fb50: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001fb60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fb70: 2020 2020 2020 2074 6865 7365 206d 6574         these met
-0001fb80: 7269 6373 2061 7265 2073 746f 7265 6420  rics are stored 
-0001fb90: 696e 2074 6865 2074 696d 6520 7365 7269  in the time seri
-0001fba0: 6573 2044 4220 616e 6420 7468 6520 7265  es DB and the re
-0001fbb0: 7375 6c74 7320 7769 6c6c 2062 650a 2020  sults will be.  
+0001fb70: 2020 2020 2020 2020 2020 6d65 7472 6963            metric
+0001fb80: 7320 666f 7220 6d6f 6465 6c20 656e 6470  s for model endp
+0001fb90: 6f69 6e74 7320 7375 6368 2061 7320 7072  oints such as pr
+0001fba0: 6564 6963 7469 6f6e 735f 7065 725f 7365  edictions_per_se
+0001fbb0: 636f 6e64 2061 6e64 0a20 2020 2020 2020  cond and.       
 0001fbc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0001fbd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fbe0: 2020 2020 2020 2020 2061 7070 6561 7265           appeare
-0001fbf0: 6420 756e 6465 7220 6d6f 6465 6c5f 656e  d under model_en
-0001fc00: 6470 6f69 6e74 2e73 7065 632e 6d65 7472  dpoint.spec.metr
-0001fc10: 6963 732e 0a20 2020 2020 2020 203a 7061  ics..        :pa
-0001fc20: 7261 6d20 6665 6174 7572 655f 616e 616c  ram feature_anal
-0001fc30: 7973 6973 3a20 2020 2020 2020 2020 2020  ysis:           
-0001fc40: 5768 656e 2054 7275 652c 2074 6865 2062  When True, the b
-0001fc50: 6173 6520 6665 6174 7572 6520 7374 6174  ase feature stat
-0001fc60: 6973 7469 6373 2061 6e64 2063 7572 7265  istics and curre
-0001fc70: 6e74 2066 6561 7475 7265 2073 7461 7469  nt feature stati
-0001fc80: 7374 6963 7320 7769 6c6c 0a20 2020 2020  stics will.     
-0001fc90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fcb0: 2020 2020 2020 6265 2061 6464 6564 2074        be added t
-0001fcc0: 6f20 7468 6520 6f75 7470 7574 206f 6620  o the output of 
-0001fcd0: 7468 6520 7265 7375 6c74 696e 6720 6f62  the resulting ob
-0001fce0: 6a65 6374 2e0a 0a20 2020 2020 2020 203a  ject...        :
-0001fcf0: 7265 7475 726e 3a20 4120 604d 6f64 656c  return: A `Model
-0001fd00: 456e 6470 6f69 6e74 6020 6f62 6a65 6374  Endpoint` object
-0001fd10: 2e0a 2020 2020 2020 2020 2222 220a 0a20  ..        """.. 
-0001fd20: 2020 2020 2020 2070 6174 6820 3d20 6622         path = f"
-0001fd30: 7072 6f6a 6563 7473 2f7b 7072 6f6a 6563  projects/{projec
-0001fd40: 747d 2f6d 6f64 656c 2d65 6e64 706f 696e  t}/model-endpoin
-0001fd50: 7473 2f7b 656e 6470 6f69 6e74 5f69 647d  ts/{endpoint_id}
-0001fd60: 220a 2020 2020 2020 2020 7265 7370 6f6e  ".        respon
-0001fd70: 7365 203d 2073 656c 662e 6170 695f 6361  se = self.api_ca
-0001fd80: 6c6c 280a 2020 2020 2020 2020 2020 2020  ll(.            
-0001fd90: 6d65 7468 6f64 3d22 4745 5422 2c0a 2020  method="GET",.  
-0001fda0: 2020 2020 2020 2020 2020 7061 7468 3d70            path=p
-0001fdb0: 6174 682c 0a20 2020 2020 2020 2020 2020  ath,.           
-0001fdc0: 2070 6172 616d 733d 7b0a 2020 2020 2020   params={.      
-0001fdd0: 2020 2020 2020 2020 2020 2273 7461 7274            "start
-0001fde0: 223a 2073 7461 7274 2c0a 2020 2020 2020  ": start,.      
-0001fdf0: 2020 2020 2020 2020 2020 2265 6e64 223a            "end":
-0001fe00: 2065 6e64 2c0a 2020 2020 2020 2020 2020   end,.          
-0001fe10: 2020 2020 2020 226d 6574 7269 6322 3a20        "metric": 
-0001fe20: 6d65 7472 6963 7320 6f72 205b 5d2c 0a20  metrics or [],. 
-0001fe30: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0001fe40: 6665 6174 7572 655f 616e 616c 7973 6973  feature_analysis
-0001fe50: 223a 2066 6561 7475 7265 5f61 6e61 6c79  ": feature_analy
-0001fe60: 7369 732c 0a20 2020 2020 2020 2020 2020  sis,.           
-0001fe70: 207d 2c0a 2020 2020 2020 2020 290a 0a20   },.        ).. 
-0001fe80: 2020 2020 2020 2072 6574 7572 6e20 6d6c         return ml
-0001fe90: 7275 6e2e 6d6f 6465 6c5f 6d6f 6e69 746f  run.model_monito
-0001fea0: 7269 6e67 2e6d 6f64 656c 5f65 6e64 706f  ring.model_endpo
-0001feb0: 696e 742e 4d6f 6465 6c45 6e64 706f 696e  int.ModelEndpoin
-0001fec0: 742e 6672 6f6d 5f64 6963 7428 0a20 2020  t.from_dict(.   
-0001fed0: 2020 2020 2020 2020 2072 6573 706f 6e73           respons
-0001fee0: 652e 6a73 6f6e 2829 0a20 2020 2020 2020  e.json().       
-0001fef0: 2029 0a0a 2020 2020 6465 6620 7061 7463   )..    def patc
-0001ff00: 685f 6d6f 6465 6c5f 656e 6470 6f69 6e74  h_model_endpoint
-0001ff10: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-0001ff20: 2020 2020 2020 2020 7072 6f6a 6563 743a          project:
-0001ff30: 2073 7472 2c0a 2020 2020 2020 2020 656e   str,.        en
-0001ff40: 6470 6f69 6e74 5f69 643a 2073 7472 2c0a  dpoint_id: str,.
-0001ff50: 2020 2020 2020 2020 6174 7472 6962 7574          attribut
-0001ff60: 6573 3a20 6469 6374 2c0a 2020 2020 293a  es: dict,.    ):
-0001ff70: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0001ff80: 2020 2020 2055 7064 6174 6573 206d 6f64       Updates mod
-0001ff90: 656c 2065 6e64 706f 696e 7420 7769 7468  el endpoint with
-0001ffa0: 2070 726f 7669 6465 6420 6174 7472 6962   provided attrib
-0001ffb0: 7574 6573 2e0a 0a20 2020 2020 2020 203a  utes...        :
-0001ffc0: 7061 7261 6d20 7072 6f6a 6563 743a 2054  param project: T
-0001ffd0: 6865 206e 616d 6520 6f66 2074 6865 2070  he name of the p
-0001ffe0: 726f 6a65 6374 2e0a 2020 2020 2020 2020  roject..        
-0001fff0: 3a70 6172 616d 2065 6e64 706f 696e 745f  :param endpoint_
-00020000: 6964 3a20 5468 6520 6964 206f 6620 7468  id: The id of th
-00020010: 6520 656e 6470 6f69 6e74 2e0a 2020 2020  e endpoint..    
-00020020: 2020 2020 3a70 6172 616d 2061 7474 7269      :param attri
-00020030: 6275 7465 733a 2044 6963 7469 6f6e 6172  butes: Dictionar
-00020040: 7920 6f66 2061 7474 7269 6275 7465 7320  y of attributes 
-00020050: 7468 6174 2077 696c 6c20 6265 2075 7365  that will be use
-00020060: 6420 666f 7220 7570 6461 7465 2074 6865  d for update the
-00020070: 206d 6f64 656c 2065 6e64 706f 696e 742e   model endpoint.
-00020080: 2054 6865 206b 6579 730a 2020 2020 2020   The keys.      
-00020090: 2020 2020 2020 6f66 2074 6869 7320 6469        of this di
-000200a0: 6374 696f 6e61 7279 2073 686f 756c 6420  ctionary should 
-000200b0: 6578 6973 7420 696e 2074 6865 2074 6172  exist in the tar
-000200c0: 6765 7420 7461 626c 652e 204e 6f74 6520  get table. Note 
-000200d0: 7468 6174 2074 6865 2076 616c 7565 7320  that the values 
-000200e0: 7368 6f75 6c64 2062 6520 6672 6f6d 2074  should be from t
-000200f0: 7970 6520 7374 7269 6e67 206f 7220 6672  ype string or fr
-00020100: 6f6d 0a20 2020 2020 2020 2020 2020 2061  om.            a
-00020110: 2076 616c 6964 206e 756d 6572 6963 616c   valid numerical
-00020120: 2074 7970 6520 7375 6368 2061 7320 696e   type such as in
-00020130: 7420 6f72 2066 6c6f 6174 2e20 4d6f 7265  t or float. More
-00020140: 2064 6574 6169 6c73 2061 626f 7574 2074   details about t
-00020150: 6865 206d 6f64 656c 2065 6e64 706f 696e  he model endpoin
-00020160: 7420 6176 6169 6c61 626c 6520 6174 7472  t available attr
-00020170: 6962 7574 6573 2063 616e 0a20 2020 2020  ibutes can.     
-00020180: 2020 2020 2020 2062 6520 666f 756e 6420         be found 
-00020190: 756e 6465 7220 3a70 793a 636c 6173 733a  under :py:class:
-000201a0: 607e 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  `~mlrun.common.s
-000201b0: 6368 656d 6173 2e4d 6f64 656c 456e 6470  chemas.ModelEndp
-000201c0: 6f69 6e74 602e 0a0a 2020 2020 2020 2020  oint`...        
-000201d0: 4578 616d 706c 653a 3a0a 0a20 2020 2020  Example::..     
-000201e0: 2020 2020 2020 2023 2047 656e 6572 6174         # Generat
-000201f0: 6520 6375 7272 656e 7420 7374 6174 7320  e current stats 
-00020200: 666f 7220 7477 6f20 6665 6174 7572 6573  for two features
-00020210: 0a20 2020 2020 2020 2020 2020 2063 7572  .            cur
-00020220: 7265 6e74 5f73 7461 7473 203d 207b 2774  rent_stats = {'t
-00020230: 7664 5f73 756d 273a 2032 2e32 2c0a 2020  vd_sum': 2.2,.  
-00020240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020250: 2020 2020 2020 2020 2020 2027 7476 645f             'tvd_
-00020260: 6d65 616e 273a 2030 2e35 2c0a 2020 2020  mean': 0.5,.    
-00020270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020280: 2020 2020 2020 2020 2027 6865 6c6c 696e           'hellin
-00020290: 6765 725f 7375 6d27 3a20 332e 362c 0a20  ger_sum': 3.6,. 
-000202a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000202b0: 2020 2020 2020 2020 2020 2020 2768 656c              'hel
-000202c0: 6c69 6e67 6572 5f6d 6561 6e27 3a20 302e  linger_mean': 0.
-000202d0: 392c 0a20 2020 2020 2020 2020 2020 2020  9,.             
-000202e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000202f0: 276b 6c64 5f73 756d 273a 2032 342e 322c  'kld_sum': 24.2,
-00020300: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00020310: 2020 2020 2020 2020 2020 2020 2020 276b                'k
-00020320: 6c64 5f6d 6561 6e27 3a20 362e 302c 0a20  ld_mean': 6.0,. 
+0001fbe0: 2020 2020 6c61 7465 6e63 795f 6176 675f      latency_avg_
+0001fbf0: 356d 2062 7574 2061 6c73 6f20 6375 7374  5m but also cust
+0001fc00: 6f6d 206d 6574 7269 6373 2064 6566 696e  om metrics defin
+0001fc10: 6564 2062 7920 7468 6520 7573 6572 2e20  ed by the user. 
+0001fc20: 506c 6561 7365 206e 6f74 6520 7468 6174  Please note that
+0001fc30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001fc40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fc50: 2020 2020 2020 2020 2020 2020 7468 6573              thes
+0001fc60: 6520 6d65 7472 6963 7320 6172 6520 7374  e metrics are st
+0001fc70: 6f72 6564 2069 6e20 7468 6520 7469 6d65  ored in the time
+0001fc80: 2073 6572 6965 7320 4442 2061 6e64 2074   series DB and t
+0001fc90: 6865 2072 6573 756c 7473 2077 696c 6c20  he results will 
+0001fca0: 6265 0a20 2020 2020 2020 2020 2020 2020  be.             
+0001fcb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fcc0: 2020 2020 2020 2020 2020 2020 2020 6170                ap
+0001fcd0: 7065 6172 6564 2075 6e64 6572 206d 6f64  peared under mod
+0001fce0: 656c 5f65 6e64 706f 696e 742e 7370 6563  el_endpoint.spec
+0001fcf0: 2e6d 6574 7269 6373 2e0a 2020 2020 2020  .metrics..      
+0001fd00: 2020 3a70 6172 616d 2066 6561 7475 7265    :param feature
+0001fd10: 5f61 6e61 6c79 7369 733a 2020 2020 2020  _analysis:      
+0001fd20: 2020 2020 2057 6865 6e20 5472 7565 2c20       When True, 
+0001fd30: 7468 6520 6261 7365 2066 6561 7475 7265  the base feature
+0001fd40: 2073 7461 7469 7374 6963 7320 616e 6420   statistics and 
+0001fd50: 6375 7272 656e 7420 6665 6174 7572 6520  current feature 
+0001fd60: 7374 6174 6973 7469 6373 2077 696c 6c0a  statistics will.
+0001fd70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fd80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fd90: 2020 2020 2020 2020 2020 2062 6520 6164             be ad
+0001fda0: 6465 6420 746f 2074 6865 206f 7574 7075  ded to the outpu
+0001fdb0: 7420 6f66 2074 6865 2072 6573 756c 7469  t of the resulti
+0001fdc0: 6e67 206f 626a 6563 742e 0a0a 2020 2020  ng object...    
+0001fdd0: 2020 2020 3a72 6574 7572 6e3a 2041 2060      :return: A `
+0001fde0: 4d6f 6465 6c45 6e64 706f 696e 7460 206f  ModelEndpoint` o
+0001fdf0: 626a 6563 742e 0a20 2020 2020 2020 2022  bject..        "
+0001fe00: 2222 0a0a 2020 2020 2020 2020 7061 7468  ""..        path
+0001fe10: 203d 2066 2270 726f 6a65 6374 732f 7b70   = f"projects/{p
+0001fe20: 726f 6a65 6374 7d2f 6d6f 6465 6c2d 656e  roject}/model-en
+0001fe30: 6470 6f69 6e74 732f 7b65 6e64 706f 696e  dpoints/{endpoin
+0001fe40: 745f 6964 7d22 0a20 2020 2020 2020 2072  t_id}".        r
+0001fe50: 6573 706f 6e73 6520 3d20 7365 6c66 2e61  esponse = self.a
+0001fe60: 7069 5f63 616c 6c28 0a20 2020 2020 2020  pi_call(.       
+0001fe70: 2020 2020 206d 6574 686f 643d 2247 4554       method="GET
+0001fe80: 222c 0a20 2020 2020 2020 2020 2020 2070  ",.            p
+0001fe90: 6174 683d 7061 7468 2c0a 2020 2020 2020  ath=path,.      
+0001fea0: 2020 2020 2020 7061 7261 6d73 3d7b 0a20        params={. 
+0001feb0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0001fec0: 7374 6172 7422 3a20 7374 6172 742c 0a20  start": start,. 
+0001fed0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0001fee0: 656e 6422 3a20 656e 642c 0a20 2020 2020  end": end,.     
+0001fef0: 2020 2020 2020 2020 2020 2022 6d65 7472             "metr
+0001ff00: 6963 223a 206d 6574 7269 6373 206f 7220  ic": metrics or 
+0001ff10: 5b5d 2c0a 2020 2020 2020 2020 2020 2020  [],.            
+0001ff20: 2020 2020 2266 6561 7475 7265 5f61 6e61      "feature_ana
+0001ff30: 6c79 7369 7322 3a20 6665 6174 7572 655f  lysis": feature_
+0001ff40: 616e 616c 7973 6973 2c0a 2020 2020 2020  analysis,.      
+0001ff50: 2020 2020 2020 7d2c 0a20 2020 2020 2020        },.       
+0001ff60: 2029 0a0a 2020 2020 2020 2020 7265 7475   )..        retu
+0001ff70: 726e 206d 6c72 756e 2e6d 6f64 656c 5f6d  rn mlrun.model_m
+0001ff80: 6f6e 6974 6f72 696e 672e 6d6f 6465 6c5f  onitoring.model_
+0001ff90: 656e 6470 6f69 6e74 2e4d 6f64 656c 456e  endpoint.ModelEn
+0001ffa0: 6470 6f69 6e74 2e66 726f 6d5f 6469 6374  dpoint.from_dict
+0001ffb0: 280a 2020 2020 2020 2020 2020 2020 7265  (.            re
+0001ffc0: 7370 6f6e 7365 2e6a 736f 6e28 290a 2020  sponse.json().  
+0001ffd0: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
+0001ffe0: 2070 6174 6368 5f6d 6f64 656c 5f65 6e64   patch_model_end
+0001fff0: 706f 696e 7428 0a20 2020 2020 2020 2073  point(.        s
+00020000: 656c 662c 0a20 2020 2020 2020 2070 726f  elf,.        pro
+00020010: 6a65 6374 3a20 7374 722c 0a20 2020 2020  ject: str,.     
+00020020: 2020 2065 6e64 706f 696e 745f 6964 3a20     endpoint_id: 
+00020030: 7374 722c 0a20 2020 2020 2020 2061 7474  str,.        att
+00020040: 7269 6275 7465 733a 2064 6963 742c 0a20  ributes: dict,. 
+00020050: 2020 2029 3a0a 2020 2020 2020 2020 2222     ):.        ""
+00020060: 220a 2020 2020 2020 2020 5570 6461 7465  ".        Update
+00020070: 7320 6d6f 6465 6c20 656e 6470 6f69 6e74  s model endpoint
+00020080: 2077 6974 6820 7072 6f76 6964 6564 2061   with provided a
+00020090: 7474 7269 6275 7465 732e 0a0a 2020 2020  ttributes...    
+000200a0: 2020 2020 3a70 6172 616d 2070 726f 6a65      :param proje
+000200b0: 6374 3a20 5468 6520 6e61 6d65 206f 6620  ct: The name of 
+000200c0: 7468 6520 7072 6f6a 6563 742e 0a20 2020  the project..   
+000200d0: 2020 2020 203a 7061 7261 6d20 656e 6470       :param endp
+000200e0: 6f69 6e74 5f69 643a 2054 6865 2069 6420  oint_id: The id 
+000200f0: 6f66 2074 6865 2065 6e64 706f 696e 742e  of the endpoint.
+00020100: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00020110: 6174 7472 6962 7574 6573 3a20 4469 6374  attributes: Dict
+00020120: 696f 6e61 7279 206f 6620 6174 7472 6962  ionary of attrib
+00020130: 7574 6573 2074 6861 7420 7769 6c6c 2062  utes that will b
+00020140: 6520 7573 6564 2066 6f72 2075 7064 6174  e used for updat
+00020150: 6520 7468 6520 6d6f 6465 6c20 656e 6470  e the model endp
+00020160: 6f69 6e74 2e20 5468 6520 6b65 7973 0a20  oint. The keys. 
+00020170: 2020 2020 2020 2020 2020 206f 6620 7468             of th
+00020180: 6973 2064 6963 7469 6f6e 6172 7920 7368  is dictionary sh
+00020190: 6f75 6c64 2065 7869 7374 2069 6e20 7468  ould exist in th
+000201a0: 6520 7461 7267 6574 2074 6162 6c65 2e20  e target table. 
+000201b0: 4e6f 7465 2074 6861 7420 7468 6520 7661  Note that the va
+000201c0: 6c75 6573 2073 686f 756c 6420 6265 2066  lues should be f
+000201d0: 726f 6d20 7479 7065 2073 7472 696e 6720  rom type string 
+000201e0: 6f72 2066 726f 6d0a 2020 2020 2020 2020  or from.        
+000201f0: 2020 2020 6120 7661 6c69 6420 6e75 6d65      a valid nume
+00020200: 7269 6361 6c20 7479 7065 2073 7563 6820  rical type such 
+00020210: 6173 2069 6e74 206f 7220 666c 6f61 742e  as int or float.
+00020220: 204d 6f72 6520 6465 7461 696c 7320 6162   More details ab
+00020230: 6f75 7420 7468 6520 6d6f 6465 6c20 656e  out the model en
+00020240: 6470 6f69 6e74 2061 7661 696c 6162 6c65  dpoint available
+00020250: 2061 7474 7269 6275 7465 7320 6361 6e0a   attributes can.
+00020260: 2020 2020 2020 2020 2020 2020 6265 2066              be f
+00020270: 6f75 6e64 2075 6e64 6572 203a 7079 3a63  ound under :py:c
+00020280: 6c61 7373 3a60 7e6d 6c72 756e 2e63 6f6d  lass:`~mlrun.com
+00020290: 6d6f 6e2e 7363 6865 6d61 732e 4d6f 6465  mon.schemas.Mode
+000202a0: 6c45 6e64 706f 696e 7460 2e0a 0a20 2020  lEndpoint`...   
+000202b0: 2020 2020 2045 7861 6d70 6c65 3a3a 0a0a       Example::..
+000202c0: 2020 2020 2020 2020 2020 2020 2320 4765              # Ge
+000202d0: 6e65 7261 7465 2063 7572 7265 6e74 2073  nerate current s
+000202e0: 7461 7473 2066 6f72 2074 776f 2066 6561  tats for two fea
+000202f0: 7475 7265 730a 2020 2020 2020 2020 2020  tures.          
+00020300: 2020 6375 7272 656e 745f 7374 6174 7320    current_stats 
+00020310: 3d20 7b27 7476 645f 7375 6d27 3a20 322e  = {'tvd_sum': 2.
+00020320: 322c 0a20 2020 2020 2020 2020 2020 2020  2,.             
 00020330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020340: 2020 2020 2020 2020 2020 2020 2766 3127              'f1'
-00020350: 3a20 7b27 7476 6427 3a20 302e 352c 2027  : {'tvd': 0.5, '
-00020360: 6865 6c6c 696e 6765 7227 3a20 312e 302c  hellinger': 1.0,
-00020370: 2027 6b6c 6427 3a20 362e 347d 2c0a 2020   'kld': 6.4},.  
-00020380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020390: 2020 2020 2020 2020 2020 2027 6632 273a             'f2':
-000203a0: 207b 2774 7664 273a 2030 2e35 2c20 2768   {'tvd': 0.5, 'h
-000203b0: 656c 6c69 6e67 6572 273a 2031 2e30 2c20  ellinger': 1.0, 
-000203c0: 276b 6c64 273a 2036 2e35 7d7d 0a0a 2020  'kld': 6.5}}..  
-000203d0: 2020 2020 2020 2020 2020 2320 4372 6561            # Crea
-000203e0: 7465 2061 7474 7269 6275 7465 7320 6469  te attributes di
-000203f0: 6374 696f 6e61 7279 2061 6363 6f72 6469  ctionary accordi
-00020400: 6e67 2074 6f20 7468 6520 7265 7175 6972  ng to the requir
-00020410: 6564 2066 6f72 6d61 740a 2020 2020 2020  ed format.      
-00020420: 2020 2020 2020 6174 7472 6962 7574 6573        attributes
-00020430: 203d 207b 6063 7572 7265 6e74 5f73 7461   = {`current_sta
-00020440: 7473 603a 206a 736f 6e2e 6475 6d70 7328  ts`: json.dumps(
-00020450: 6375 7272 656e 745f 7374 6174 7329 2c0a  current_stats),.
-00020460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020470: 2020 2020 2020 2020 2020 6064 7269 6674            `drift
-00020480: 5f73 7461 7475 7360 3a20 2244 5249 4654  _status`: "DRIFT
-00020490: 5f44 4554 4543 5445 4422 7d0a 0a20 2020  _DETECTED"}..   
-000204a0: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
-000204b0: 2020 6174 7472 6962 7574 6573 203d 207b    attributes = {
-000204c0: 2261 7474 7269 6275 7465 7322 3a20 5f61  "attributes": _a
-000204d0: 735f 6a73 6f6e 2861 7474 7269 6275 7465  s_json(attribute
-000204e0: 7329 7d0a 2020 2020 2020 2020 7061 7468  s)}.        path
-000204f0: 203d 2066 2270 726f 6a65 6374 732f 7b70   = f"projects/{p
-00020500: 726f 6a65 6374 7d2f 6d6f 6465 6c2d 656e  roject}/model-en
-00020510: 6470 6f69 6e74 732f 7b65 6e64 706f 696e  dpoints/{endpoin
-00020520: 745f 6964 7d22 0a20 2020 2020 2020 2073  t_id}".        s
-00020530: 656c 662e 6170 695f 6361 6c6c 280a 2020  elf.api_call(.  
-00020540: 2020 2020 2020 2020 2020 6d65 7468 6f64            method
-00020550: 3d22 5041 5443 4822 2c0a 2020 2020 2020  ="PATCH",.      
-00020560: 2020 2020 2020 7061 7468 3d70 6174 682c        path=path,
-00020570: 0a20 2020 2020 2020 2020 2020 2070 6172  .            par
-00020580: 616d 733d 6174 7472 6962 7574 6573 2c0a  ams=attributes,.
-00020590: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
-000205a0: 6566 2064 6570 6c6f 795f 6d6f 6e69 746f  ef deploy_monito
-000205b0: 7269 6e67 5f62 6174 6368 5f6a 6f62 280a  ring_batch_job(.
-000205c0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-000205d0: 2020 2020 2020 7072 6f6a 6563 743a 2073        project: s
-000205e0: 7472 203d 2022 222c 0a20 2020 2020 2020  tr = "",.       
-000205f0: 2064 6566 6175 6c74 5f62 6174 6368 5f69   default_batch_i
-00020600: 6d61 6765 3a20 7374 7220 3d20 226d 6c72  mage: str = "mlr
-00020610: 756e 2f6d 6c72 756e 222c 0a20 2020 2020  un/mlrun",.     
-00020620: 2020 2077 6974 685f 7363 6865 6475 6c65     with_schedule
-00020630: 3a20 626f 6f6c 203d 2046 616c 7365 2c0a  : bool = False,.
-00020640: 2020 2020 293a 0a20 2020 2020 2020 2022      ):.        "
-00020650: 2222 0a20 2020 2020 2020 2053 7562 6d69  "".        Submi
-00020660: 7420 6d6f 6465 6c20 6d6f 6e69 746f 7269  t model monitori
-00020670: 6e67 2062 6174 6368 206a 6f62 2e20 4279  ng batch job. By
-00020680: 2064 6566 6175 6c74 2c20 7375 626d 6974   default, submit
-00020690: 206f 6e6c 7920 7468 6520 6261 7463 6820   only the batch 
-000206a0: 6a6f 6220 6173 204d 4c20 6675 6e63 7469  job as ML functi
-000206b0: 6f6e 2077 6974 686f 7574 2073 6368 6564  on without sched
-000206c0: 756c 696e 672e 0a20 2020 2020 2020 2054  uling..        T
-000206d0: 6f20 7375 626d 6974 2061 2073 6368 6564  o submit a sched
-000206e0: 756c 6564 206a 6f62 2061 7320 7765 6c6c  uled job as well
-000206f0: 2c20 706c 6561 7365 2073 6574 2077 6974  , please set wit
-00020700: 685f 7363 6865 6475 6c65 203d 2054 7275  h_schedule = Tru
-00020710: 652e 0a0a 2020 2020 2020 2020 3a70 6172  e...        :par
-00020720: 616d 2070 726f 6a65 6374 3a20 2020 2020  am project:     
-00020730: 2020 2020 2020 2020 5072 6f6a 6563 7420          Project 
-00020740: 6e61 6d65 2e0a 2020 2020 2020 2020 3a70  name..        :p
-00020750: 6172 616d 2064 6566 6175 6c74 5f62 6174  aram default_bat
-00020760: 6368 5f69 6d61 6765 3a20 5468 6520 6465  ch_image: The de
-00020770: 6661 756c 7420 696d 6167 6520 6f66 2074  fault image of t
-00020780: 6865 206d 6f64 656c 206d 6f6e 6974 6f72  he model monitor
-00020790: 696e 6720 6261 7463 6820 6a6f 622e 2042  ing batch job. B
-000207a0: 7920 6465 6661 756c 742c 2074 6865 2069  y default, the i
-000207b0: 6d61 6765 0a20 2020 2020 2020 2020 2020  mage.           
-000207c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000207d0: 2020 2020 2020 2020 2069 7320 6d6c 7275           is mlru
-000207e0: 6e2f 6d6c 7275 6e2e 0a20 2020 2020 2020  n/mlrun..       
-000207f0: 203a 7061 7261 6d20 7769 7468 5f73 6368   :param with_sch
-00020800: 6564 756c 653a 2020 2020 2020 2049 6620  edule:       If 
-00020810: 7472 7565 2c20 7375 626d 6974 2074 6865  true, submit the
-00020820: 206d 6f64 656c 206d 6f6e 6974 6f72 696e   model monitorin
-00020830: 6720 7363 6865 6475 6c65 6420 6a6f 6220  g scheduled job 
-00020840: 6173 2077 656c 6c2e 0a0a 0a20 2020 2020  as well....     
-00020850: 2020 203a 7265 7475 726e 733a 206d 6f64     :returns: mod
-00020860: 656c 206d 6f6e 6974 6f72 696e 6720 6261  el monitoring ba
-00020870: 7463 6820 6a6f 6220 6173 2061 2064 6963  tch job as a dic
-00020880: 7469 6f6e 6172 792e 2059 6f75 2063 616e  tionary. You can
-00020890: 2065 6173 696c 7920 636f 6e76 6572 7420   easily convert 
-000208a0: 7468 6520 7265 7475 726e 6564 2066 756e  the returned fun
-000208b0: 6374 696f 6e20 696e 746f 2061 0a20 2020  ction into a.   
-000208c0: 2020 2020 2020 2020 2020 2020 2020 7275                ru
-000208d0: 6e74 696d 6520 6f62 6a65 6374 2062 7920  ntime object by 
-000208e0: 6361 6c6c 696e 6720 7e6d 6c72 756e 2e6e  calling ~mlrun.n
-000208f0: 6577 5f66 756e 6374 696f 6e2e 0a20 2020  ew_function..   
-00020900: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
-00020910: 2020 7061 7261 6d73 203d 207b 0a20 2020    params = {.   
-00020920: 2020 2020 2020 2020 2022 6465 6661 756c           "defaul
-00020930: 745f 6261 7463 685f 696d 6167 6522 3a20  t_batch_image": 
-00020940: 6465 6661 756c 745f 6261 7463 685f 696d  default_batch_im
-00020950: 6167 652c 0a20 2020 2020 2020 2020 2020  age,.           
-00020960: 2022 7769 7468 5f73 6368 6564 756c 6522   "with_schedule"
-00020970: 3a20 7769 7468 5f73 6368 6564 756c 652c  : with_schedule,
-00020980: 0a20 2020 2020 2020 207d 0a20 2020 2020  .        }.     
-00020990: 2020 2070 6174 6820 3d20 6622 7072 6f6a     path = f"proj
-000209a0: 6563 7473 2f7b 7072 6f6a 6563 747d 2f6a  ects/{project}/j
-000209b0: 6f62 732f 6261 7463 682d 6d6f 6e69 746f  obs/batch-monito
-000209c0: 7269 6e67 220a 0a20 2020 2020 2020 2072  ring"..        r
-000209d0: 6573 7020 3d20 7365 6c66 2e61 7069 5f63  esp = self.api_c
-000209e0: 616c 6c28 6d65 7468 6f64 3d22 504f 5354  all(method="POST
-000209f0: 222c 2070 6174 683d 7061 7468 2c20 7061  ", path=path, pa
-00020a00: 7261 6d73 3d70 6172 616d 7329 0a20 2020  rams=params).   
-00020a10: 2020 2020 2072 6574 7572 6e20 7265 7370       return resp
-00020a20: 2e6a 736f 6e28 295b 2266 756e 6322 5d0a  .json()["func"].
-00020a30: 0a20 2020 2064 6566 2075 7064 6174 655f  .    def update_
-00020a40: 6d6f 6465 6c5f 6d6f 6e69 746f 7269 6e67  model_monitoring
-00020a50: 5f63 6f6e 7472 6f6c 6c65 7228 0a20 2020  _controller(.   
-00020a60: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-00020a70: 2020 2070 726f 6a65 6374 3a20 7374 722c     project: str,
-00020a80: 0a20 2020 2020 2020 2062 6173 655f 7065  .        base_pe
-00020a90: 7269 6f64 3a20 696e 7420 3d20 3130 2c0a  riod: int = 10,.
-00020aa0: 2020 2020 2020 2020 696d 6167 653a 2073          image: s
-00020ab0: 7472 203d 2022 6d6c 7275 6e2f 6d6c 7275  tr = "mlrun/mlru
-00020ac0: 6e22 2c0a 2020 2020 293a 0a20 2020 2020  n",.    ):.     
-00020ad0: 2020 2022 2222 0a20 2020 2020 2020 2052     """.        R
-00020ae0: 6564 6570 6c6f 7920 6d6f 6465 6c20 6d6f  edeploy model mo
-00020af0: 6e69 746f 7269 6e67 2061 7070 6c69 6361  nitoring applica
-00020b00: 7469 6f6e 2063 6f6e 7472 6f6c 6c65 7220  tion controller 
-00020b10: 6675 6e63 7469 6f6e 2e0a 0a20 2020 2020  function...     
-00020b20: 2020 203a 7061 7261 6d20 7072 6f6a 6563     :param projec
-00020b30: 743a 2020 2020 2020 2020 2020 2020 2020  t:              
-00020b40: 2020 2020 5072 6f6a 6563 7420 6e61 6d65      Project name
-00020b50: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00020b60: 2062 6173 655f 7065 7269 6f64 3a20 2020   base_period:   
-00020b70: 2020 2020 2020 2020 2020 2054 6865 2074             The t
-00020b80: 696d 6520 7065 7269 6f64 2069 6e20 6d69  ime period in mi
-00020b90: 6e75 7465 7320 696e 2077 6869 6368 2074  nutes in which t
-00020ba0: 6865 206d 6f64 656c 206d 6f6e 6974 6f72  he model monitor
-00020bb0: 696e 6720 636f 6e74 726f 6c6c 6572 2066  ing controller f
-00020bc0: 756e 6374 696f 6e0a 2020 2020 2020 2020  unction.        
-00020bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020bf0: 2074 7269 6767 6572 732e 2042 7920 6465   triggers. By de
-00020c00: 6661 756c 742c 2074 6865 2062 6173 6520  fault, the base 
-00020c10: 7065 7269 6f64 2069 7320 3130 206d 696e  period is 10 min
-00020c20: 7574 6573 2e0a 2020 2020 2020 2020 3a70  utes..        :p
-00020c30: 6172 616d 2069 6d61 6765 3a20 5468 6520  aram image: The 
-00020c40: 696d 6167 6520 6f66 2074 6865 206d 6f64  image of the mod
-00020c50: 656c 206d 6f6e 6974 6f72 696e 6720 636f  el monitoring co
-00020c60: 6e74 726f 6c6c 6572 2066 756e 6374 696f  ntroller functio
-00020c70: 6e2e 0a20 2020 2020 2020 2020 2020 2020  n..             
-00020c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020c90: 2020 2020 2020 2020 2020 2020 4279 2064              By d
-00020ca0: 6566 6175 6c74 2c20 7468 6520 696d 6167  efault, the imag
-00020cb0: 6520 6973 206d 6c72 756e 2f6d 6c72 756e  e is mlrun/mlrun
-00020cc0: 2e0a 2020 2020 2020 2020 2222 220a 0a20  ..        """.. 
-00020cd0: 2020 2020 2020 2070 6172 616d 7320 3d20         params = 
-00020ce0: 7b0a 2020 2020 2020 2020 2020 2020 2269  {.            "i
-00020cf0: 6d61 6765 223a 2069 6d61 6765 2c0a 2020  mage": image,.  
-00020d00: 2020 2020 2020 2020 2020 2262 6173 655f            "base_
-00020d10: 7065 7269 6f64 223a 2062 6173 655f 7065  period": base_pe
-00020d20: 7269 6f64 2c0a 2020 2020 2020 2020 7d0a  riod,.        }.
-00020d30: 2020 2020 2020 2020 7061 7468 203d 2066          path = f
-00020d40: 2270 726f 6a65 6374 732f 7b70 726f 6a65  "projects/{proje
-00020d50: 6374 7d2f 6d6f 6465 6c2d 6d6f 6e69 746f  ct}/model-monito
-00020d60: 7269 6e67 2f6d 6f64 656c 2d6d 6f6e 6974  ring/model-monit
-00020d70: 6f72 696e 672d 636f 6e74 726f 6c6c 6572  oring-controller
-00020d80: 220a 2020 2020 2020 2020 7365 6c66 2e61  ".        self.a
-00020d90: 7069 5f63 616c 6c28 6d65 7468 6f64 3d22  pi_call(method="
-00020da0: 504f 5354 222c 2070 6174 683d 7061 7468  POST", path=path
-00020db0: 2c20 7061 7261 6d73 3d70 6172 616d 7329  , params=params)
-00020dc0: 0a0a 2020 2020 6465 6620 656e 6162 6c65  ..    def enable
-00020dd0: 5f6d 6f64 656c 5f6d 6f6e 6974 6f72 696e  _model_monitorin
-00020de0: 6728 0a20 2020 2020 2020 2073 656c 662c  g(.        self,
-00020df0: 0a20 2020 2020 2020 2070 726f 6a65 6374  .        project
-00020e00: 3a20 7374 722c 0a20 2020 2020 2020 2062  : str,.        b
-00020e10: 6173 655f 7065 7269 6f64 3a20 696e 7420  ase_period: int 
-00020e20: 3d20 3130 2c0a 2020 2020 2020 2020 696d  = 10,.        im
-00020e30: 6167 653a 2073 7472 203d 2022 6d6c 7275  age: str = "mlru
-00020e40: 6e2f 6d6c 7275 6e22 2c0a 2020 2020 293a  n/mlrun",.    ):
-00020e50: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00020e60: 2020 2020 2044 6570 6c6f 7920 6d6f 6465       Deploy mode
-00020e70: 6c20 6d6f 6e69 746f 7269 6e67 2061 7070  l monitoring app
-00020e80: 6c69 6361 7469 6f6e 2063 6f6e 7472 6f6c  lication control
-00020e90: 6c65 722c 2077 7269 7465 7220 616e 6420  ler, writer and 
-00020ea0: 7374 7265 616d 2066 756e 6374 696f 6e73  stream functions
-00020eb0: 2e0a 2020 2020 2020 2020 5768 696c 6520  ..        While 
-00020ec0: 7468 6520 6d61 696e 2067 6f61 6c20 6f66  the main goal of
-00020ed0: 2074 6865 2063 6f6e 7472 6f6c 6c65 7220   the controller 
-00020ee0: 6675 6e63 7469 6f6e 2069 7320 746f 2068  function is to h
-00020ef0: 616e 646c 6520 7468 6520 6d6f 6e69 746f  andle the monito
-00020f00: 7269 6e67 2070 726f 6365 7373 696e 6720  ring processing 
-00020f10: 616e 6420 7472 6967 6765 7269 6e67 0a20  and triggering. 
-00020f20: 2020 2020 2020 2061 7070 6c69 6361 7469         applicati
-00020f30: 6f6e 732c 2074 6865 2067 6f61 6c20 6f66  ons, the goal of
-00020f40: 2074 6865 206d 6f64 656c 206d 6f6e 6974   the model monit
-00020f50: 6f72 696e 6720 7772 6974 6572 2066 756e  oring writer fun
-00020f60: 6374 696f 6e20 6973 2074 6f20 7772 6974  ction is to writ
-00020f70: 6520 616c 6c20 7468 6520 6d6f 6e69 746f  e all the monito
-00020f80: 7269 6e67 0a20 2020 2020 2020 2061 7070  ring.        app
-00020f90: 6c69 6361 7469 6f6e 2072 6573 756c 7473  lication results
-00020fa0: 2074 6f20 7468 6520 6461 7461 6261 7365   to the database
-00020fb0: 732e 0a20 2020 2020 2020 2054 6865 2073  s..        The s
-00020fc0: 7472 6561 6d20 6675 6e63 7469 6f6e 2067  tream function g
-00020fd0: 6f61 6c20 6973 2074 6f20 6d6f 6e69 746f  oal is to monito
-00020fe0: 7220 7468 6520 6c6f 6720 6f66 2074 6865  r the log of the
-00020ff0: 2064 6174 6120 7374 7265 616d 2e20 4974   data stream. It
-00021000: 2069 7320 7472 6967 6765 7265 6420 7768   is triggered wh
-00021010: 656e 2061 206e 6577 206c 6f67 2065 6e74  en a new log ent
-00021020: 7279 0a20 2020 2020 2020 2069 7320 6465  ry.        is de
-00021030: 7465 6374 6564 2e20 4974 2070 726f 6365  tected. It proce
-00021040: 7373 6573 2074 6865 206e 6577 2065 7665  sses the new eve
-00021050: 6e74 7320 696e 746f 2073 7461 7469 7374  nts into statist
-00021060: 6963 7320 7468 6174 2061 7265 2074 6865  ics that are the
-00021070: 6e20 7772 6974 7465 6e20 746f 2073 7461  n written to sta
-00021080: 7469 7374 6963 7320 6461 7461 6261 7365  tistics database
-00021090: 732e 0a0a 0a20 2020 2020 2020 203a 7061  s....        :pa
-000210a0: 7261 6d20 7072 6f6a 6563 743a 2020 2020  ram project:    
-000210b0: 2020 2020 2020 2020 2020 2020 2020 5072                Pr
-000210c0: 6f6a 6563 7420 6e61 6d65 2e0a 2020 2020  oject name..    
-000210d0: 2020 2020 3a70 6172 616d 2062 6173 655f      :param base_
-000210e0: 7065 7269 6f64 3a20 2020 2020 2020 2020  period:         
-000210f0: 2020 2020 2054 6865 2074 696d 6520 7065       The time pe
-00021100: 7269 6f64 2069 6e20 6d69 6e75 7465 7320  riod in minutes 
-00021110: 696e 2077 6869 6368 2074 6865 206d 6f64  in which the mod
-00021120: 656c 206d 6f6e 6974 6f72 696e 6720 636f  el monitoring co
-00021130: 6e74 726f 6c6c 6572 2066 756e 6374 696f  ntroller functio
-00021140: 6e0a 2020 2020 2020 2020 2020 2020 2020  n.              
-00021150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021160: 2020 2020 2020 2020 2020 2074 7269 6767             trigg
-00021170: 6572 732e 2042 7920 6465 6661 756c 742c  ers. By default,
-00021180: 2074 6865 2062 6173 6520 7065 7269 6f64   the base period
-00021190: 2069 7320 3130 206d 696e 7574 6573 2e0a   is 10 minutes..
-000211a0: 2020 2020 2020 2020 3a70 6172 616d 2069          :param i
-000211b0: 6d61 6765 3a20 2020 2020 2020 2020 2020  mage:           
-000211c0: 2020 2020 2020 2020 2054 6865 2069 6d61           The ima
-000211d0: 6765 206f 6620 7468 6520 6d6f 6465 6c20  ge of the model 
-000211e0: 6d6f 6e69 746f 7269 6e67 2063 6f6e 7472  monitoring contr
-000211f0: 6f6c 6c65 722c 2077 7269 7465 7220 2620  oller, writer & 
-00021200: 6d6f 6e69 746f 7269 6e67 0a20 2020 2020  monitoring.     
-00021210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021230: 2020 2020 7374 7265 616d 2066 756e 6374      stream funct
-00021240: 696f 6e73 2c20 7768 6963 6820 6172 6520  ions, which are 
-00021250: 7265 616c 2074 696d 6520 6e75 636c 696f  real time nuclio
-00021260: 2066 756e 6374 696f 6e73 2e0a 2020 2020   functions..    
-00021270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021290: 2020 2020 2042 7920 6465 6661 756c 742c       By default,
-000212a0: 2074 6865 2069 6d61 6765 2069 7320 6d6c   the image is ml
-000212b0: 7275 6e2f 6d6c 7275 6e2e 0a20 2020 2020  run/mlrun..     
-000212c0: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
-000212d0: 7061 7261 6d73 203d 207b 0a20 2020 2020  params = {.     
-000212e0: 2020 2020 2020 2022 6261 7365 5f70 6572         "base_per
-000212f0: 696f 6422 3a20 6261 7365 5f70 6572 696f  iod": base_perio
-00021300: 642c 0a20 2020 2020 2020 2020 2020 2022  d,.            "
-00021310: 696d 6167 6522 3a20 696d 6167 652c 0a20  image": image,. 
-00021320: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
-00021330: 2070 6174 6820 3d20 6622 7072 6f6a 6563   path = f"projec
-00021340: 7473 2f7b 7072 6f6a 6563 747d 2f6d 6f64  ts/{project}/mod
-00021350: 656c 2d6d 6f6e 6974 6f72 696e 672f 656e  el-monitoring/en
-00021360: 6162 6c65 2d6d 6f64 656c 2d6d 6f6e 6974  able-model-monit
-00021370: 6f72 696e 6722 0a20 2020 2020 2020 2073  oring".        s
-00021380: 656c 662e 6170 695f 6361 6c6c 286d 6574  elf.api_call(met
-00021390: 686f 643d 2250 4f53 5422 2c20 7061 7468  hod="POST", path
-000213a0: 3d70 6174 682c 2070 6172 616d 733d 7061  =path, params=pa
-000213b0: 7261 6d73 290a 0a20 2020 2064 6566 2063  rams)..    def c
-000213c0: 7265 6174 655f 6875 625f 736f 7572 6365  reate_hub_source
-000213d0: 280a 2020 2020 2020 2020 7365 6c66 2c20  (.        self, 
-000213e0: 736f 7572 6365 3a20 556e 696f 6e5b 6469  source: Union[di
-000213f0: 6374 2c20 6d6c 7275 6e2e 636f 6d6d 6f6e  ct, mlrun.common
-00021400: 2e73 6368 656d 6173 2e49 6e64 6578 6564  .schemas.Indexed
-00021410: 4875 6253 6f75 7263 655d 0a20 2020 2029  HubSource].    )
-00021420: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-00021430: 2020 2020 2020 4164 6420 6120 6e65 7720        Add a new 
-00021440: 6875 6220 736f 7572 6365 2e0a 0a20 2020  hub source...   
-00021450: 2020 2020 204d 4c52 756e 206d 6169 6e74       MLRun maint
-00021460: 6169 6e73 2061 6e20 6f72 6465 7265 6420  ains an ordered 
-00021470: 6c69 7374 206f 6620 6875 6220 736f 7572  list of hub sour
-00021480: 6365 7320 28e2 809c 736f 7572 6365 73e2  ces (...sources.
-00021490: 809d 2920 4561 6368 2073 6f75 7263 6520  ..) Each source 
-000214a0: 6861 730a 2020 2020 2020 2020 6974 7320  has.        its 
-000214b0: 6465 7461 696c 7320 7265 6769 7374 6572  details register
-000214c0: 6564 2061 6e64 2069 7473 206f 7264 6572  ed and its order
-000214d0: 2077 6974 6869 6e20 7468 6520 6c69 7374   within the list
-000214e0: 2e20 5768 656e 2063 7265 6174 696e 6720  . When creating 
-000214f0: 6120 6e65 7720 736f 7572 6365 2c20 7468  a new source, th
-00021500: 6520 7370 6563 6961 6c20 6f72 6465 7220  e special order 
-00021510: 6060 2d31 6060 0a20 2020 2020 2020 2063  ``-1``.        c
-00021520: 616e 2062 6520 7573 6564 2074 6f20 6d61  an be used to ma
-00021530: 726b 2074 6869 7320 736f 7572 6365 2061  rk this source a
-00021540: 7320 6c61 7374 2069 6e20 7468 6520 6c69  s last in the li
-00021550: 7374 2e20 486f 7765 7665 722c 206f 6e63  st. However, onc
-00021560: 6520 7468 6520 736f 7572 6365 2069 7320  e the source is 
-00021570: 696e 2074 6865 204d 4c52 756e 206c 6973  in the MLRun lis
-00021580: 742c 0a20 2020 2020 2020 2069 7473 206f  t,.        its o
-00021590: 7264 6572 2077 696c 6c20 616c 7761 7973  rder will always
-000215a0: 2062 6520 6060 3e30 6060 2e0a 0a20 2020   be ``>0``...   
-000215b0: 2020 2020 2054 6865 2067 6c6f 6261 6c20       The global 
-000215c0: 6875 6220 736f 7572 6365 2061 6c77 6179  hub source alway
-000215d0: 7320 6578 6973 7473 2069 6e20 7468 6520  s exists in the 
-000215e0: 6c69 7374 2c20 616e 6420 6973 2061 6c77  list, and is alw
-000215f0: 6179 7320 7468 6520 6c61 7374 2073 6f75  ays the last sou
-00021600: 7263 650a 2020 2020 2020 2020 2860 606f  rce.        (``o
-00021610: 7264 6572 203d 202d 3160 6029 2e20 4974  rder = -1``). It
-00021620: 2063 616e 6e6f 7420 6265 206d 6f64 6966   cannot be modif
-00021630: 6965 6420 6e6f 7220 6361 6e20 6974 2062  ied nor can it b
-00021640: 6520 6d6f 7665 6420 746f 2061 6e6f 7468  e moved to anoth
-00021650: 6572 206f 7264 6572 2069 6e20 7468 6520  er order in the 
-00021660: 6c69 7374 2e0a 0a20 2020 2020 2020 2054  list...        T
-00021670: 6865 2073 6f75 7263 6520 6f62 6a65 6374  he source object
-00021680: 206d 6179 2063 6f6e 7461 696e 2063 7265   may contain cre
-00021690: 6465 6e74 6961 6c73 2077 6869 6368 2061  dentials which a
-000216a0: 7265 206e 6565 6465 6420 746f 2061 6363  re needed to acc
-000216b0: 6573 7320 7468 6520 6461 7461 7374 6f72  ess the datastor
-000216c0: 6520 7768 6572 6520 7468 6520 736f 7572  e where the sour
-000216d0: 6365 2069 7320 7374 6f72 6564 2e0a 2020  ce is stored..  
-000216e0: 2020 2020 2020 5468 6573 6520 6372 6564        These cred
-000216f0: 656e 7469 616c 7320 6172 6520 6e6f 7420  entials are not 
-00021700: 6b65 7074 2069 6e20 7468 6520 4d4c 5275  kept in the MLRu
-00021710: 6e20 4442 2c20 6275 7420 6172 6520 7374  n DB, but are st
-00021720: 6f72 6564 2069 6e73 6964 6520 6120 6b75  ored inside a ku
-00021730: 6265 726e 6574 6573 2073 6563 7265 7420  bernetes secret 
-00021740: 6f62 6a65 6374 206d 6169 6e74 6169 6e65  object maintaine
-00021750: 6420 6279 0a20 2020 2020 2020 204d 4c52  d by.        MLR
-00021760: 756e 2e20 5468 6579 2061 7265 206e 6f74  un. They are not
-00021770: 2072 6574 7572 6e65 6420 7468 726f 7567   returned throug
-00021780: 6820 616e 7920 4150 4920 6672 6f6d 204d  h any API from M
-00021790: 4c52 756e 2e0a 0a20 2020 2020 2020 2045  LRun...        E
-000217a0: 7861 6d70 6c65 3a3a 0a0a 2020 2020 2020  xample::..      
-000217b0: 2020 2020 2020 696d 706f 7274 206d 6c72        import mlr
-000217c0: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
-000217d0: 730a 0a20 2020 2020 2020 2020 2020 2023  s..            #
-000217e0: 2041 6464 2061 2070 7269 7661 7465 2073   Add a private s
-000217f0: 6f75 7263 6520 6173 2074 6865 206c 6173  ource as the las
-00021800: 7420 6f6e 6520 2877 696c 6c20 6265 2023  t one (will be #
-00021810: 3120 696e 2074 6865 206c 6973 7429 0a20  1 in the list). 
-00021820: 2020 2020 2020 2020 2020 2070 7269 7661             priva
-00021830: 7465 5f73 6f75 7263 6520 3d20 6d6c 7275  te_source = mlru
-00021840: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
-00021850: 2e49 6e64 6578 6564 4875 6253 6f75 7263  .IndexedHubSourc
-00021860: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
-00021870: 2020 206f 7264 6572 3d2d 312c 0a20 2020     order=-1,.   
-00021880: 2020 2020 2020 2020 2020 2020 2073 6f75               sou
-00021890: 7263 653d 6d6c 7275 6e2e 636f 6d6d 6f6e  rce=mlrun.common
-000218a0: 2e73 6368 656d 6173 2e48 7562 536f 7572  .schemas.HubSour
-000218b0: 6365 280a 2020 2020 2020 2020 2020 2020  ce(.            
-000218c0: 2020 2020 2020 2020 6d65 7461 6461 7461          metadata
-000218d0: 3d6d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363  =mlrun.common.sc
-000218e0: 6865 6d61 732e 4875 624f 626a 6563 744d  hemas.HubObjectM
-000218f0: 6574 6164 6174 6128 0a20 2020 2020 2020  etadata(.       
-00021900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021910: 206e 616d 653d 2270 7269 7622 2c20 6465   name="priv", de
-00021920: 7363 7269 7074 696f 6e3d 2261 2070 7269  scription="a pri
-00021930: 7661 7465 2073 6f75 7263 6522 0a20 2020  vate source".   
-00021940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021950: 2029 2c0a 2020 2020 2020 2020 2020 2020   ),.            
-00021960: 2020 2020 2020 2020 7370 6563 3d6d 6c72          spec=mlr
-00021970: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
-00021980: 732e 4875 6253 6f75 7263 6553 7065 6328  s.HubSourceSpec(
-00021990: 7061 7468 3d22 2f6c 6f63 616c 2f70 6174  path="/local/pat
-000219a0: 682f 746f 2f73 6f75 7263 6522 2c20 6368  h/to/source", ch
-000219b0: 616e 6e65 6c3d 2264 6576 656c 6f70 6d65  annel="developme
-000219c0: 6e74 2229 0a20 2020 2020 2020 2020 2020  nt").           
-000219d0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-000219e0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-000219f0: 2064 622e 6372 6561 7465 5f68 7562 5f73   db.create_hub_s
-00021a00: 6f75 7263 6528 7072 6976 6174 655f 736f  ource(private_so
-00021a10: 7572 6365 290a 0a20 2020 2020 2020 2020  urce)..         
-00021a20: 2020 2023 2041 6464 2061 6e6f 7468 6572     # Add another
-00021a30: 2073 6f75 7263 6520 6173 2031 7374 2069   source as 1st i
-00021a40: 6e20 7468 6520 6c69 7374 202d 2077 696c  n the list - wil
-00021a50: 6c20 7075 7368 2070 7265 7669 6f75 7320  l push previous 
-00021a60: 6f6e 6520 746f 2062 6520 2332 0a20 2020  one to be #2.   
-00021a70: 2020 2020 2020 2020 2061 6e6f 7468 6572           another
-00021a80: 5f73 6f75 7263 6520 3d20 6d6c 7275 6e2e  _source = mlrun.
-00021a90: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e49  common.schemas.I
-00021aa0: 6e64 6578 6564 4875 6253 6f75 7263 6528  ndexedHubSource(
-00021ab0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00021ac0: 206f 7264 6572 3d31 2c0a 2020 2020 2020   order=1,.      
-00021ad0: 2020 2020 2020 2020 2020 736f 7572 6365            source
-00021ae0: 3d6d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363  =mlrun.common.sc
-00021af0: 6865 6d61 732e 4875 6253 6f75 7263 6528  hemas.HubSource(
-00021b00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00021b10: 2020 2020 206d 6574 6164 6174 613d 6d6c       metadata=ml
-00021b20: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
-00021b30: 6173 2e48 7562 4f62 6a65 6374 4d65 7461  as.HubObjectMeta
-00021b40: 6461 7461 280a 2020 2020 2020 2020 2020  data(.          
-00021b50: 2020 2020 2020 2020 2020 2020 2020 6e61                na
-00021b60: 6d65 3d22 7072 6976 2d32 222c 2064 6573  me="priv-2", des
-00021b70: 6372 6970 7469 6f6e 3d22 616e 6f74 6865  cription="anothe
-00021b80: 7220 736f 7572 6365 220a 2020 2020 2020  r source".      
-00021b90: 2020 2020 2020 2020 2020 2020 2020 292c                ),
-00021ba0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00021bb0: 2020 2020 2073 7065 633d 6d6c 7275 6e2e       spec=mlrun.
-00021bc0: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e48  common.schemas.H
-00021bd0: 7562 536f 7572 6365 5370 6563 280a 2020  ubSourceSpec(.  
-00021be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021bf0: 2020 2020 2020 7061 7468 3d22 2f6c 6f63        path="/loc
-00021c00: 616c 2f70 6174 682f 746f 2f73 6f75 7263  al/path/to/sourc
-00021c10: 652f 3222 2c0a 2020 2020 2020 2020 2020  e/2",.          
-00021c20: 2020 2020 2020 2020 2020 2020 2020 6368                ch
-00021c30: 616e 6e65 6c3d 2264 6576 656c 6f70 6d65  annel="developme
-00021c40: 6e74 222c 0a20 2020 2020 2020 2020 2020  nt",.           
-00021c50: 2020 2020 2020 2020 2020 2020 2063 7265               cre
-00021c60: 6465 6e74 6961 6c73 3d7b 2e2e 2e7d 0a20  dentials={...}. 
-00021c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021c80: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-00021c90: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-00021ca0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-00021cb0: 2064 622e 6372 6561 7465 5f68 7562 5f73   db.create_hub_s
-00021cc0: 6f75 7263 6528 616e 6f74 6865 725f 736f  ource(another_so
-00021cd0: 7572 6365 290a 0a20 2020 2020 2020 203a  urce)..        :
-00021ce0: 7061 7261 6d20 736f 7572 6365 3a20 5468  param source: Th
-00021cf0: 6520 736f 7572 6365 2061 6e64 2069 7473  e source and its
-00021d00: 206f 7264 6572 2c20 6f66 2074 7970 650a   order, of type.
-00021d10: 2020 2020 2020 2020 2020 2020 3a70 793a              :py:
-00021d20: 636c 6173 733a 607e 6d6c 7275 6e2e 636f  class:`~mlrun.co
-00021d30: 6d6d 6f6e 2e73 6368 656d 6173 2e68 7562  mmon.schemas.hub
-00021d40: 2e49 6e64 6578 6564 4875 6253 6f75 7263  .IndexedHubSourc
-00021d50: 6560 2c20 6f72 2069 6e20 6469 6374 696f  e`, or in dictio
-00021d60: 6e61 7279 2066 6f72 6d2e 0a20 2020 2020  nary form..     
-00021d70: 2020 203a 7265 7475 726e 733a 2054 6865     :returns: The
-00021d80: 2073 6f75 7263 6520 6f62 6a65 6374 2061   source object a
-00021d90: 7320 696e 7365 7274 6564 2069 6e74 6f20  s inserted into 
-00021da0: 7468 6520 6461 7461 6261 7365 2c20 7769  the database, wi
-00021db0: 7468 2063 7265 6465 6e74 6961 6c73 2073  th credentials s
-00021dc0: 7472 6970 7065 642e 0a20 2020 2020 2020  tripped..       
-00021dd0: 2022 2222 0a20 2020 2020 2020 2070 6174   """.        pat
-00021de0: 6820 3d20 2268 7562 2f73 6f75 7263 6573  h = "hub/sources
-00021df0: 220a 2020 2020 2020 2020 6966 2069 7369  ".        if isi
-00021e00: 6e73 7461 6e63 6528 736f 7572 6365 2c20  nstance(source, 
-00021e10: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-00021e20: 656d 6173 2e49 6e64 6578 6564 4875 6253  emas.IndexedHubS
-00021e30: 6f75 7263 6529 3a0a 2020 2020 2020 2020  ource):.        
-00021e40: 2020 2020 736f 7572 6365 203d 2073 6f75      source = sou
-00021e50: 7263 652e 6469 6374 2829 0a20 2020 2020  rce.dict().     
-00021e60: 2020 2072 6573 706f 6e73 6520 3d20 7365     response = se
-00021e70: 6c66 2e61 7069 5f63 616c 6c28 6d65 7468  lf.api_call(meth
-00021e80: 6f64 3d22 504f 5354 222c 2070 6174 683d  od="POST", path=
-00021e90: 7061 7468 2c20 6a73 6f6e 3d73 6f75 7263  path, json=sourc
-00021ea0: 6529 0a20 2020 2020 2020 2072 6574 7572  e).        retur
-00021eb0: 6e20 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  n mlrun.common.s
-00021ec0: 6368 656d 6173 2e49 6e64 6578 6564 4875  chemas.IndexedHu
-00021ed0: 6253 6f75 7263 6528 2a2a 7265 7370 6f6e  bSource(**respon
-00021ee0: 7365 2e6a 736f 6e28 2929 0a0a 2020 2020  se.json())..    
-00021ef0: 6465 6620 7374 6f72 655f 6875 625f 736f  def store_hub_so
-00021f00: 7572 6365 280a 2020 2020 2020 2020 7365  urce(.        se
-00021f10: 6c66 2c0a 2020 2020 2020 2020 736f 7572  lf,.        sour
-00021f20: 6365 5f6e 616d 653a 2073 7472 2c0a 2020  ce_name: str,.  
-00021f30: 2020 2020 2020 736f 7572 6365 3a20 556e        source: Un
-00021f40: 696f 6e5b 6469 6374 2c20 6d6c 7275 6e2e  ion[dict, mlrun.
-00021f50: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e49  common.schemas.I
-00021f60: 6e64 6578 6564 4875 6253 6f75 7263 655d  ndexedHubSource]
-00021f70: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
-00021f80: 2022 2222 0a20 2020 2020 2020 2043 7265   """.        Cre
-00021f90: 6174 6520 6f72 2072 6570 6c61 6365 2061  ate or replace a
-00021fa0: 2068 7562 2073 6f75 7263 652e 0a20 2020   hub source..   
-00021fb0: 2020 2020 2046 6f72 2061 6e20 6578 616d       For an exam
-00021fc0: 706c 6520 6f66 2074 6865 2073 6f75 7263  ple of the sourc
-00021fd0: 6520 666f 726d 6174 2061 6e64 2065 7870  e format and exp
-00021fe0: 6c61 6e61 7469 6f6e 206f 6620 7468 6520  lanation of the 
-00021ff0: 736f 7572 6365 206f 7264 6572 206c 6f67  source order log
-00022000: 6963 2c0a 2020 2020 2020 2020 706c 6561  ic,.        plea
-00022010: 7365 2073 6565 203a 7079 3a66 756e 633a  se see :py:func:
-00022020: 607e 6372 6561 7465 5f68 7562 5f73 6f75  `~create_hub_sou
-00022030: 7263 6560 2e20 5468 6973 206d 6574 686f  rce`. This metho
-00022040: 6420 6361 6e20 6265 2075 7365 6420 746f  d can be used to
-00022050: 206d 6f64 6966 7920 7468 6520 736f 7572   modify the sour
-00022060: 6365 2069 7473 656c 6620 6f72 2069 7473  ce itself or its
-00022070: 0a20 2020 2020 2020 206f 7264 6572 2069  .        order i
-00022080: 6e20 7468 6520 6c69 7374 206f 6620 736f  n the list of so
-00022090: 7572 6365 732e 0a0a 2020 2020 2020 2020  urces...        
-000220a0: 3a70 6172 616d 2073 6f75 7263 655f 6e61  :param source_na
-000220b0: 6d65 3a20 4e61 6d65 206f 6620 7468 6520  me: Name of the 
-000220c0: 736f 7572 6365 206f 626a 6563 7420 746f  source object to
-000220d0: 206d 6f64 6966 792f 6372 6561 7465 2e20   modify/create. 
-000220e0: 4974 206d 7573 7420 6d61 7463 6820 7468  It must match th
-000220f0: 6520 6060 736f 7572 6365 2e6d 6574 6164  e ``source.metad
-00022100: 6174 612e 6e61 6d65 6060 0a20 2020 2020  ata.name``.     
-00022110: 2020 2020 2020 2070 6172 616d 6574 6572         parameter
-00022120: 2069 6e20 7468 6520 736f 7572 6365 2069   in the source i
-00022130: 7473 656c 662e 0a20 2020 2020 2020 203a  tself..        :
-00022140: 7061 7261 6d20 736f 7572 6365 3a20 536f  param source: So
-00022150: 7572 6365 206f 626a 6563 7420 746f 2073  urce object to s
-00022160: 746f 7265 2069 6e20 7468 6520 6461 7461  tore in the data
-00022170: 6261 7365 2e0a 2020 2020 2020 2020 3a72  base..        :r
-00022180: 6574 7572 6e73 3a20 5468 6520 736f 7572  eturns: The sour
-00022190: 6365 206f 626a 6563 7420 6173 2073 746f  ce object as sto
-000221a0: 7265 6420 696e 2074 6865 2044 422e 0a20  red in the DB.. 
-000221b0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-000221c0: 2020 2070 6174 6820 3d20 6622 6875 622f     path = f"hub/
-000221d0: 736f 7572 6365 732f 7b73 6f75 7263 655f  sources/{source_
-000221e0: 6e61 6d65 7d22 0a20 2020 2020 2020 2069  name}".        i
-000221f0: 6620 6973 696e 7374 616e 6365 2873 6f75  f isinstance(sou
-00022200: 7263 652c 206d 6c72 756e 2e63 6f6d 6d6f  rce, mlrun.commo
-00022210: 6e2e 7363 6865 6d61 732e 496e 6465 7865  n.schemas.Indexe
-00022220: 6448 7562 536f 7572 6365 293a 0a20 2020  dHubSource):.   
-00022230: 2020 2020 2020 2020 2073 6f75 7263 6520           source 
-00022240: 3d20 736f 7572 6365 2e64 6963 7428 290a  = source.dict().
-00022250: 0a20 2020 2020 2020 2072 6573 706f 6e73  .        respons
-00022260: 6520 3d20 7365 6c66 2e61 7069 5f63 616c  e = self.api_cal
-00022270: 6c28 6d65 7468 6f64 3d22 5055 5422 2c20  l(method="PUT", 
-00022280: 7061 7468 3d70 6174 682c 206a 736f 6e3d  path=path, json=
-00022290: 736f 7572 6365 290a 2020 2020 2020 2020  source).        
-000222a0: 7265 7475 726e 206d 6c72 756e 2e63 6f6d  return mlrun.com
-000222b0: 6d6f 6e2e 7363 6865 6d61 732e 496e 6465  mon.schemas.Inde
-000222c0: 7865 6448 7562 536f 7572 6365 282a 2a72  xedHubSource(**r
-000222d0: 6573 706f 6e73 652e 6a73 6f6e 2829 290a  esponse.json()).
-000222e0: 0a20 2020 2064 6566 206c 6973 745f 6875  .    def list_hu
-000222f0: 625f 736f 7572 6365 7328 0a20 2020 2020  b_sources(.     
-00022300: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-00022310: 2069 7465 6d5f 6e61 6d65 3a20 4f70 7469   item_name: Opti
-00022320: 6f6e 616c 5b73 7472 5d20 3d20 4e6f 6e65  onal[str] = None
-00022330: 2c0a 2020 2020 2020 2020 7461 673a 204f  ,.        tag: O
-00022340: 7074 696f 6e61 6c5b 7374 725d 203d 204e  ptional[str] = N
-00022350: 6f6e 652c 0a20 2020 2020 2020 2076 6572  one,.        ver
-00022360: 7369 6f6e 3a20 4f70 7469 6f6e 616c 5b73  sion: Optional[s
-00022370: 7472 5d20 3d20 4e6f 6e65 2c0a 2020 2020  tr] = None,.    
-00022380: 2920 2d3e 206c 6973 745b 6d6c 7275 6e2e  ) -> list[mlrun.
-00022390: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e68  common.schemas.h
-000223a0: 7562 2e49 6e64 6578 6564 4875 6253 6f75  ub.IndexedHubSou
-000223b0: 7263 655d 3a0a 2020 2020 2020 2020 2222  rce]:.        ""
-000223c0: 220a 2020 2020 2020 2020 4c69 7374 2068  ".        List h
-000223d0: 7562 2073 6f75 7263 6573 2069 6e20 7468  ub sources in th
-000223e0: 6520 4d4c 5275 6e20 4442 2e0a 0a20 2020  e MLRun DB...   
-000223f0: 2020 2020 203a 7061 7261 6d20 6974 656d       :param item
-00022400: 5f6e 616d 653a 2020 2053 6f75 7263 6573  _name:   Sources
-00022410: 2063 6f6e 7461 696e 2074 6869 7320 6974   contain this it
-00022420: 656d 2077 696c 6c20 6265 2072 6574 7572  em will be retur
-00022430: 6e65 642c 2049 6620 6e6f 7420 7072 6f76  ned, If not prov
-00022440: 6964 6564 2061 6c6c 2073 6f75 7263 6573  ided all sources
-00022450: 2077 696c 6c20 6265 2072 6574 7572 6e65   will be returne
-00022460: 642e 0a20 2020 2020 2020 203a 7061 7261  d..        :para
-00022470: 6d20 7461 673a 2020 2020 2020 2020 2049  m tag:         I
-00022480: 7465 6d20 7461 6720 746f 2066 696c 7465  tem tag to filte
-00022490: 7220 6279 2c20 7375 7070 6f72 7465 6420  r by, supported 
-000224a0: 6f6e 6c79 2069 6620 6974 656d 206e 616d  only if item nam
-000224b0: 6520 6973 2070 726f 7669 6465 642e 0a20  e is provided.. 
-000224c0: 2020 2020 2020 203a 7061 7261 6d20 7665         :param ve
-000224d0: 7273 696f 6e3a 2020 2020 2049 7465 6d20  rsion:     Item 
-000224e0: 7665 7273 696f 6e20 746f 2066 696c 7465  version to filte
-000224f0: 7220 6279 2c20 7375 7070 6f72 7465 6420  r by, supported 
-00022500: 6f6e 6c79 2069 6620 6974 656d 206e 616d  only if item nam
-00022510: 6520 6973 2070 726f 7669 6465 6420 616e  e is provided an
-00022520: 6420 7461 6720 6973 206e 6f74 2e0a 0a20  d tag is not... 
-00022530: 2020 2020 2020 203a 7265 7475 726e 733a         :returns:
-00022540: 204c 6973 7420 6f66 2069 6e64 6578 6564   List of indexed
-00022550: 2068 7562 2073 6f75 7263 6573 2e0a 2020   hub sources..  
-00022560: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00022570: 2020 7061 7468 203d 2022 6875 622f 736f    path = "hub/so
-00022580: 7572 6365 7322 0a20 2020 2020 2020 2070  urces".        p
-00022590: 6172 616d 7320 3d20 7b7d 0a20 2020 2020  arams = {}.     
-000225a0: 2020 2069 6620 6974 656d 5f6e 616d 653a     if item_name:
-000225b0: 0a20 2020 2020 2020 2020 2020 2070 6172  .            par
-000225c0: 616d 735b 2269 7465 6d2d 6e61 6d65 225d  ams["item-name"]
-000225d0: 203d 206e 6f72 6d61 6c69 7a65 5f6e 616d   = normalize_nam
-000225e0: 6528 6974 656d 5f6e 616d 6529 0a20 2020  e(item_name).   
-000225f0: 2020 2020 2069 6620 7461 673a 0a20 2020       if tag:.   
-00022600: 2020 2020 2020 2020 2070 6172 616d 735b           params[
-00022610: 2274 6167 225d 203d 2074 6167 0a20 2020  "tag"] = tag.   
-00022620: 2020 2020 2069 6620 7665 7273 696f 6e3a       if version:
-00022630: 0a20 2020 2020 2020 2020 2020 2070 6172  .            par
-00022640: 616d 735b 2276 6572 7369 6f6e 225d 203d  ams["version"] =
-00022650: 2076 6572 7369 6f6e 0a20 2020 2020 2020   version.       
-00022660: 2072 6573 706f 6e73 6520 3d20 7365 6c66   response = self
-00022670: 2e61 7069 5f63 616c 6c28 6d65 7468 6f64  .api_call(method
-00022680: 3d22 4745 5422 2c20 7061 7468 3d70 6174  ="GET", path=pat
-00022690: 682c 2070 6172 616d 733d 7061 7261 6d73  h, params=params
-000226a0: 292e 6a73 6f6e 2829 0a20 2020 2020 2020  ).json().       
-000226b0: 2072 6573 756c 7473 203d 205b 5d0a 2020   results = [].  
-000226c0: 2020 2020 2020 666f 7220 6974 656d 2069        for item i
-000226d0: 6e20 7265 7370 6f6e 7365 3a0a 2020 2020  n response:.    
-000226e0: 2020 2020 2020 2020 7265 7375 6c74 732e          results.
-000226f0: 6170 7065 6e64 286d 6c72 756e 2e63 6f6d  append(mlrun.com
-00022700: 6d6f 6e2e 7363 6865 6d61 732e 496e 6465  mon.schemas.Inde
-00022710: 7865 6448 7562 536f 7572 6365 282a 2a69  xedHubSource(**i
-00022720: 7465 6d29 290a 2020 2020 2020 2020 7265  tem)).        re
-00022730: 7475 726e 2072 6573 756c 7473 0a0a 2020  turn results..  
-00022740: 2020 6465 6620 6765 745f 6875 625f 736f    def get_hub_so
-00022750: 7572 6365 2873 656c 662c 2073 6f75 7263  urce(self, sourc
-00022760: 655f 6e61 6d65 3a20 7374 7229 3a0a 2020  e_name: str):.  
-00022770: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00022780: 2020 5265 7472 6965 7665 2061 2068 7562    Retrieve a hub
-00022790: 2073 6f75 7263 6520 6672 6f6d 2074 6865   source from the
-000227a0: 2044 422e 0a0a 2020 2020 2020 2020 3a70   DB...        :p
-000227b0: 6172 616d 2073 6f75 7263 655f 6e61 6d65  aram source_name
-000227c0: 3a20 4e61 6d65 206f 6620 7468 6520 6875  : Name of the hu
-000227d0: 6220 736f 7572 6365 2074 6f20 7265 7472  b source to retr
-000227e0: 6965 7665 2e0a 2020 2020 2020 2020 2222  ieve..        ""
-000227f0: 220a 2020 2020 2020 2020 7061 7468 203d  ".        path =
-00022800: 2066 2268 7562 2f73 6f75 7263 6573 2f7b   f"hub/sources/{
-00022810: 736f 7572 6365 5f6e 616d 657d 220a 2020  source_name}".  
-00022820: 2020 2020 2020 7265 7370 6f6e 7365 203d        response =
-00022830: 2073 656c 662e 6170 695f 6361 6c6c 286d   self.api_call(m
-00022840: 6574 686f 643d 2247 4554 222c 2070 6174  ethod="GET", pat
-00022850: 683d 7061 7468 290a 2020 2020 2020 2020  h=path).        
-00022860: 7265 7475 726e 206d 6c72 756e 2e63 6f6d  return mlrun.com
-00022870: 6d6f 6e2e 7363 6865 6d61 732e 496e 6465  mon.schemas.Inde
-00022880: 7865 6448 7562 536f 7572 6365 282a 2a72  xedHubSource(**r
-00022890: 6573 706f 6e73 652e 6a73 6f6e 2829 290a  esponse.json()).
-000228a0: 0a20 2020 2064 6566 2064 656c 6574 655f  .    def delete_
-000228b0: 6875 625f 736f 7572 6365 2873 656c 662c  hub_source(self,
-000228c0: 2073 6f75 7263 655f 6e61 6d65 3a20 7374   source_name: st
-000228d0: 7229 3a0a 2020 2020 2020 2020 2222 220a  r):.        """.
-000228e0: 2020 2020 2020 2020 4465 6c65 7465 2061          Delete a
-000228f0: 2068 7562 2073 6f75 7263 6520 6672 6f6d   hub source from
-00022900: 2074 6865 2044 422e 0a20 2020 2020 2020   the DB..       
-00022910: 2054 6865 2073 6f75 7263 6520 7769 6c6c   The source will
-00022920: 2062 6520 6465 6c65 7465 6420 6672 6f6d   be deleted from
-00022930: 2074 6865 206c 6973 742c 2061 6e64 2061   the list, and a
-00022940: 6e79 2066 6f6c 6c6f 7769 6e67 2073 6f75  ny following sou
-00022950: 7263 6573 2077 696c 6c20 6265 2070 726f  rces will be pro
-00022960: 6d6f 7465 6420 2d20 666f 7220 6578 616d  moted - for exam
-00022970: 706c 652c 2069 6620 7468 650a 2020 2020  ple, if the.    
-00022980: 2020 2020 3173 7420 736f 7572 6365 2069      1st source i
-00022990: 7320 6465 6c65 7465 642c 2074 6865 2032  s deleted, the 2
-000229a0: 6e64 2073 6f75 7263 6520 7769 6c6c 2062  nd source will b
-000229b0: 6563 6f6d 6520 2331 2069 6e20 7468 6520  ecome #1 in the 
-000229c0: 6c69 7374 2e0a 2020 2020 2020 2020 5468  list..        Th
-000229d0: 6520 676c 6f62 616c 2068 7562 2073 6f75  e global hub sou
-000229e0: 7263 6520 6361 6e6e 6f74 2062 6520 6465  rce cannot be de
-000229f0: 6c65 7465 642e 0a0a 2020 2020 2020 2020  leted...        
-00022a00: 3a70 6172 616d 2073 6f75 7263 655f 6e61  :param source_na
-00022a10: 6d65 3a20 4e61 6d65 206f 6620 7468 6520  me: Name of the 
-00022a20: 6875 6220 736f 7572 6365 2074 6f20 6465  hub source to de
-00022a30: 6c65 7465 2e0a 2020 2020 2020 2020 2222  lete..        ""
-00022a40: 220a 2020 2020 2020 2020 7061 7468 203d  ".        path =
-00022a50: 2066 2268 7562 2f73 6f75 7263 6573 2f7b   f"hub/sources/{
-00022a60: 736f 7572 6365 5f6e 616d 657d 220a 2020  source_name}".  
-00022a70: 2020 2020 2020 7365 6c66 2e61 7069 5f63        self.api_c
-00022a80: 616c 6c28 6d65 7468 6f64 3d22 4445 4c45  all(method="DELE
-00022a90: 5445 222c 2070 6174 683d 7061 7468 290a  TE", path=path).
-00022aa0: 0a20 2020 2064 6566 2067 6574 5f68 7562  .    def get_hub
-00022ab0: 5f63 6174 616c 6f67 280a 2020 2020 2020  _catalog(.      
-00022ac0: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-00022ad0: 736f 7572 6365 5f6e 616d 653a 2073 7472  source_name: str
-00022ae0: 2c0a 2020 2020 2020 2020 7665 7273 696f  ,.        versio
-00022af0: 6e3a 2073 7472 203d 204e 6f6e 652c 0a20  n: str = None,. 
-00022b00: 2020 2020 2020 2074 6167 3a20 7374 7220         tag: str 
-00022b10: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-00022b20: 666f 7263 655f 7265 6672 6573 683a 2062  force_refresh: b
-00022b30: 6f6f 6c20 3d20 4661 6c73 652c 0a20 2020  ool = False,.   
-00022b40: 2029 3a0a 2020 2020 2020 2020 2222 220a   ):.        """.
-00022b50: 2020 2020 2020 2020 5265 7472 6965 7665          Retrieve
-00022b60: 2074 6865 2069 7465 6d20 6361 7461 6c6f   the item catalo
-00022b70: 6720 666f 7220 6120 7370 6563 6966 6965  g for a specifie
-00022b80: 6420 6875 6220 736f 7572 6365 2e0a 2020  d hub source..  
-00022b90: 2020 2020 2020 5468 6520 6c69 7374 206f        The list o
-00022ba0: 6620 6974 656d 7320 6361 6e20 6265 2066  f items can be f
-00022bb0: 696c 7465 7265 6420 6163 636f 7264 696e  iltered accordin
-00022bc0: 6720 746f 2076 6172 696f 7573 2066 696c  g to various fil
-00022bd0: 7465 7273 2c20 7573 696e 6720 6974 656d  ters, using item
-00022be0: 2773 206d 6574 6164 6174 6120 746f 2066  's metadata to f
-00022bf0: 696c 7465 722e 0a0a 2020 2020 2020 2020  ilter...        
-00022c00: 3a70 6172 616d 2073 6f75 7263 655f 6e61  :param source_na
-00022c10: 6d65 3a20 4e61 6d65 206f 6620 7468 6520  me: Name of the 
-00022c20: 736f 7572 6365 2e0a 2020 2020 2020 2020  source..        
-00022c30: 3a70 6172 616d 2076 6572 7369 6f6e 3a20  :param version: 
-00022c40: 4669 6c74 6572 2069 7465 6d73 2061 6363  Filter items acc
-00022c50: 6f72 6469 6e67 2074 6f20 7468 6569 7220  ording to their 
-00022c60: 7665 7273 696f 6e2e 0a20 2020 2020 2020  version..       
-00022c70: 203a 7061 7261 6d20 7461 673a 2046 696c   :param tag: Fil
-00022c80: 7465 7220 6974 656d 7320 6261 7365 6420  ter items based 
-00022c90: 6f6e 2074 6167 2e0a 2020 2020 2020 2020  on tag..        
-00022ca0: 3a70 6172 616d 2066 6f72 6365 5f72 6566  :param force_ref
-00022cb0: 7265 7368 3a20 4d61 6b65 2074 6865 2073  resh: Make the s
-00022cc0: 6572 7665 7220 6665 7463 6820 7468 6520  erver fetch the 
-00022cd0: 6361 7461 6c6f 6720 6672 6f6d 2074 6865  catalog from the
-00022ce0: 2061 6374 7561 6c20 6875 6220 736f 7572   actual hub sour
-00022cf0: 6365 2c0a 2020 2020 2020 2020 2020 2020  ce,.            
-00022d00: 7261 7468 6572 2074 6861 6e20 7265 6c79  rather than rely
-00022d10: 206f 6e20 6361 6368 6564 2069 6e66 6f72   on cached infor
-00022d20: 6d61 7469 6f6e 2077 6869 6368 206d 6179  mation which may
-00022d30: 2065 7869 7374 2066 726f 6d20 7072 6576   exist from prev
-00022d40: 696f 7573 2067 6574 2072 6571 7565 7374  ious get request
-00022d50: 732e 2046 6f72 2065 7861 6d70 6c65 2c0a  s. For example,.
-00022d60: 2020 2020 2020 2020 2020 2020 6966 2074              if t
-00022d70: 6865 2073 6f75 7263 6520 7761 7320 7265  he source was re
-00022d80: 2d62 7569 6c74 2c0a 2020 2020 2020 2020  -built,.        
-00022d90: 2020 2020 7468 6973 2077 696c 6c20 6d61      this will ma
-00022da0: 6b65 2074 6865 2073 6572 7665 7220 6765  ke the server ge
-00022db0: 7420 7468 6520 7570 6461 7465 6420 696e  t the updated in
-00022dc0: 666f 726d 6174 696f 6e2e 2044 6566 6175  formation. Defau
-00022dd0: 6c74 2069 7320 6060 4661 6c73 6560 602e  lt is ``False``.
-00022de0: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
-00022df0: 733a 203a 7079 3a63 6c61 7373 3a60 7e6d  s: :py:class:`~m
-00022e00: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
-00022e10: 6d61 732e 6875 622e 4875 6243 6174 616c  mas.hub.HubCatal
-00022e20: 6f67 6020 6f62 6a65 6374 2c20 7768 6963  og` object, whic
-00022e30: 6820 6973 2065 7373 656e 7469 616c 6c79  h is essentially
-00022e40: 2061 206c 6973 740a 2020 2020 2020 2020   a list.        
-00022e50: 2020 2020 6f66 203a 7079 3a63 6c61 7373      of :py:class
-00022e60: 3a60 7e6d 6c72 756e 2e63 6f6d 6d6f 6e2e  :`~mlrun.common.
-00022e70: 7363 6865 6d61 732e 6875 622e 4875 6249  schemas.hub.HubI
-00022e80: 7465 6d60 2065 6e74 7269 6573 2e0a 2020  tem` entries..  
-00022e90: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00022ea0: 2020 7061 7468 203d 2066 2268 7562 2f73    path = f"hub/s
-00022eb0: 6f75 7263 6573 2f7b 736f 7572 6365 5f6e  ources/{source_n
-00022ec0: 616d 657d 2f69 7465 6d73 220a 2020 2020  ame}/items".    
-00022ed0: 2020 2020 7061 7261 6d73 203d 207b 0a20      params = {. 
-00022ee0: 2020 2020 2020 2020 2020 2022 7665 7273             "vers
-00022ef0: 696f 6e22 3a20 7665 7273 696f 6e2c 0a20  ion": version,. 
-00022f00: 2020 2020 2020 2020 2020 2022 7461 6722             "tag"
-00022f10: 3a20 7461 672c 0a20 2020 2020 2020 2020  : tag,.         
-00022f20: 2020 2022 666f 7263 652d 7265 6672 6573     "force-refres
-00022f30: 6822 3a20 666f 7263 655f 7265 6672 6573  h": force_refres
-00022f40: 682c 0a20 2020 2020 2020 207d 0a20 2020  h,.        }.   
-00022f50: 2020 2020 2072 6573 706f 6e73 6520 3d20       response = 
-00022f60: 7365 6c66 2e61 7069 5f63 616c 6c28 6d65  self.api_call(me
-00022f70: 7468 6f64 3d22 4745 5422 2c20 7061 7468  thod="GET", path
-00022f80: 3d70 6174 682c 2070 6172 616d 733d 7061  =path, params=pa
-00022f90: 7261 6d73 290a 2020 2020 2020 2020 7265  rams).        re
-00022fa0: 7475 726e 206d 6c72 756e 2e63 6f6d 6d6f  turn mlrun.commo
-00022fb0: 6e2e 7363 6865 6d61 732e 4875 6243 6174  n.schemas.HubCat
-00022fc0: 616c 6f67 282a 2a72 6573 706f 6e73 652e  alog(**response.
-00022fd0: 6a73 6f6e 2829 290a 0a20 2020 2064 6566  json())..    def
-00022fe0: 2067 6574 5f68 7562 5f69 7465 6d28 0a20   get_hub_item(. 
-00022ff0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-00023000: 2020 2020 2073 6f75 7263 655f 6e61 6d65       source_name
-00023010: 3a20 7374 722c 0a20 2020 2020 2020 2069  : str,.        i
-00023020: 7465 6d5f 6e61 6d65 3a20 7374 722c 0a20  tem_name: str,. 
-00023030: 2020 2020 2020 2076 6572 7369 6f6e 3a20         version: 
-00023040: 7374 7220 3d20 4e6f 6e65 2c0a 2020 2020  str = None,.    
-00023050: 2020 2020 7461 673a 2073 7472 203d 2022      tag: str = "
-00023060: 6c61 7465 7374 222c 0a20 2020 2020 2020  latest",.       
-00023070: 2066 6f72 6365 5f72 6566 7265 7368 3a20   force_refresh: 
-00023080: 626f 6f6c 203d 2046 616c 7365 2c0a 2020  bool = False,.  
-00023090: 2020 293a 0a20 2020 2020 2020 2022 2222    ):.        """
-000230a0: 0a20 2020 2020 2020 2052 6574 7269 6576  .        Retriev
-000230b0: 6520 6120 7370 6563 6966 6963 2068 7562  e a specific hub
-000230c0: 2069 7465 6d2e 0a0a 2020 2020 2020 2020   item...        
-000230d0: 3a70 6172 616d 2073 6f75 7263 655f 6e61  :param source_na
-000230e0: 6d65 3a20 4e61 6d65 206f 6620 736f 7572  me: Name of sour
-000230f0: 6365 2e0a 2020 2020 2020 2020 3a70 6172  ce..        :par
-00023100: 616d 2069 7465 6d5f 6e61 6d65 3a20 4e61  am item_name: Na
-00023110: 6d65 206f 6620 7468 6520 6974 656d 2074  me of the item t
-00023120: 6f20 7265 7472 6965 7665 2c20 6173 2069  o retrieve, as i
-00023130: 7420 6170 7065 6172 7320 696e 2074 6865  t appears in the
-00023140: 2063 6174 616c 6f67 2e0a 2020 2020 2020   catalog..      
-00023150: 2020 3a70 6172 616d 2076 6572 7369 6f6e    :param version
-00023160: 3a20 4765 7420 6120 7370 6563 6966 6963  : Get a specific
-00023170: 2076 6572 7369 6f6e 206f 6620 7468 6520   version of the 
-00023180: 6974 656d 2e20 4465 6661 756c 7420 6973  item. Default is
-00023190: 2060 604e 6f6e 6560 602e 0a20 2020 2020   ``None``..     
-000231a0: 2020 203a 7061 7261 6d20 7461 673a 2047     :param tag: G
-000231b0: 6574 2061 2073 7065 6369 6669 6320 7665  et a specific ve
-000231c0: 7273 696f 6e20 6f66 2074 6865 2069 7465  rsion of the ite
-000231d0: 6d20 6964 656e 7469 6669 6564 2062 7920  m identified by 
-000231e0: 7461 672e 2044 6566 6175 6c74 2069 7320  tag. Default is 
-000231f0: 6060 6c61 7465 7374 6060 2e0a 2020 2020  ``latest``..    
-00023200: 2020 2020 3a70 6172 616d 2066 6f72 6365      :param force
-00023210: 5f72 6566 7265 7368 3a20 4d61 6b65 2074  _refresh: Make t
-00023220: 6865 2073 6572 7665 7220 6665 7463 6820  he server fetch 
-00023230: 7468 6520 696e 666f 726d 6174 696f 6e20  the information 
-00023240: 6672 6f6d 2074 6865 2061 6374 7561 6c20  from the actual 
-00023250: 6875 620a 2020 2020 2020 2020 2020 2020  hub.            
-00023260: 736f 7572 6365 2c20 7261 7468 6572 2074  source, rather t
-00023270: 6861 6e0a 2020 2020 2020 2020 2020 2020  han.            
-00023280: 7265 6c79 206f 6e20 6361 6368 6564 2069  rely on cached i
-00023290: 6e66 6f72 6d61 7469 6f6e 2e20 4465 6661  nformation. Defa
-000232a0: 756c 7420 6973 2060 6046 616c 7365 6060  ult is ``False``
-000232b0: 2e0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
-000232c0: 6e73 3a20 3a70 793a 636c 6173 733a 607e  ns: :py:class:`~
-000232d0: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-000232e0: 656d 6173 2e68 7562 2e48 7562 4974 656d  emas.hub.HubItem
-000232f0: 602e 0a20 2020 2020 2020 2022 2222 0a20  `..        """. 
-00023300: 2020 2020 2020 2070 6174 6820 3d20 2866         path = (f
-00023310: 2268 7562 2f73 6f75 7263 6573 2f7b 736f  "hub/sources/{so
-00023320: 7572 6365 5f6e 616d 657d 2f69 7465 6d73  urce_name}/items
-00023330: 2f7b 6974 656d 5f6e 616d 657d 222c 290a  /{item_name}",).
-00023340: 2020 2020 2020 2020 7061 7261 6d73 203d          params =
-00023350: 207b 0a20 2020 2020 2020 2020 2020 2022   {.            "
-00023360: 7665 7273 696f 6e22 3a20 7665 7273 696f  version": versio
-00023370: 6e2c 0a20 2020 2020 2020 2020 2020 2022  n,.            "
-00023380: 7461 6722 3a20 7461 672c 0a20 2020 2020  tag": tag,.     
-00023390: 2020 2020 2020 2022 666f 7263 652d 7265         "force-re
-000233a0: 6672 6573 6822 3a20 666f 7263 655f 7265  fresh": force_re
-000233b0: 6672 6573 682c 0a20 2020 2020 2020 207d  fresh,.        }
-000233c0: 0a20 2020 2020 2020 2072 6573 706f 6e73  .        respons
-000233d0: 6520 3d20 7365 6c66 2e61 7069 5f63 616c  e = self.api_cal
-000233e0: 6c28 6d65 7468 6f64 3d22 4745 5422 2c20  l(method="GET", 
-000233f0: 7061 7468 3d70 6174 682c 2070 6172 616d  path=path, param
-00023400: 733d 7061 7261 6d73 290a 2020 2020 2020  s=params).      
-00023410: 2020 7265 7475 726e 206d 6c72 756e 2e63    return mlrun.c
-00023420: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 4875  ommon.schemas.Hu
-00023430: 6249 7465 6d28 2a2a 7265 7370 6f6e 7365  bItem(**response
-00023440: 2e6a 736f 6e28 2929 0a0a 2020 2020 6465  .json())..    de
-00023450: 6620 6765 745f 6875 625f 6173 7365 7428  f get_hub_asset(
-00023460: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-00023470: 2020 2020 2020 2073 6f75 7263 655f 6e61         source_na
-00023480: 6d65 3a20 7374 722c 0a20 2020 2020 2020  me: str,.       
-00023490: 2069 7465 6d5f 6e61 6d65 3a20 7374 722c   item_name: str,
-000234a0: 0a20 2020 2020 2020 2061 7373 6574 5f6e  .        asset_n
-000234b0: 616d 653a 2073 7472 2c0a 2020 2020 2020  ame: str,.      
-000234c0: 2020 7665 7273 696f 6e3a 2073 7472 203d    version: str =
-000234d0: 204e 6f6e 652c 0a20 2020 2020 2020 2074   None,.        t
-000234e0: 6167 3a20 7374 7220 3d20 226c 6174 6573  ag: str = "lates
-000234f0: 7422 2c0a 2020 2020 293a 0a20 2020 2020  t",.    ):.     
-00023500: 2020 2022 2222 0a20 2020 2020 2020 2047     """.        G
-00023510: 6574 2068 7562 2061 7373 6574 2066 726f  et hub asset fro
-00023520: 6d20 6974 656d 2e0a 0a20 2020 2020 2020  m item...       
-00023530: 203a 7061 7261 6d20 736f 7572 6365 5f6e   :param source_n
-00023540: 616d 653a 204e 616d 6520 6f66 2073 6f75  ame: Name of sou
-00023550: 7263 652e 0a20 2020 2020 2020 203a 7061  rce..        :pa
-00023560: 7261 6d20 6974 656d 5f6e 616d 653a 2020  ram item_name:  
-00023570: 204e 616d 6520 6f66 2074 6865 2069 7465   Name of the ite
-00023580: 6d20 7768 6963 6820 686f 6c64 7320 7468  m which holds th
-00023590: 6520 6173 7365 742e 0a20 2020 2020 2020  e asset..       
-000235a0: 203a 7061 7261 6d20 6173 7365 745f 6e61   :param asset_na
-000235b0: 6d65 3a20 204e 616d 6520 6f66 2074 6865  me:  Name of the
-000235c0: 2061 7373 6574 2074 6f20 7265 7472 6965   asset to retrie
-000235d0: 7665 2e0a 2020 2020 2020 2020 3a70 6172  ve..        :par
-000235e0: 616d 2076 6572 7369 6f6e 3a20 4765 7420  am version: Get 
-000235f0: 6120 7370 6563 6966 6963 2076 6572 7369  a specific versi
-00023600: 6f6e 206f 6620 7468 6520 6974 656d 2e20  on of the item. 
-00023610: 4465 6661 756c 7420 6973 2060 604e 6f6e  Default is ``Non
-00023620: 6560 602e 0a20 2020 2020 2020 203a 7061  e``..        :pa
-00023630: 7261 6d20 7461 673a 2047 6574 2061 2073  ram tag: Get a s
-00023640: 7065 6369 6669 6320 7665 7273 696f 6e20  pecific version 
-00023650: 6f66 2074 6865 2069 7465 6d20 6964 656e  of the item iden
-00023660: 7469 6669 6564 2062 7920 7461 672e 2044  tified by tag. D
-00023670: 6566 6175 6c74 2069 7320 6060 6c61 7465  efault is ``late
-00023680: 7374 6060 2e0a 0a20 2020 2020 2020 203a  st``...        :
-00023690: 7265 7475 726e 3a20 6874 7470 2072 6573  return: http res
-000236a0: 706f 6e73 6520 7769 7468 2074 6865 2061  ponse with the a
-000236b0: 7373 6574 2069 6e20 7468 6520 636f 6e74  sset in the cont
-000236c0: 656e 7420 6174 7472 6962 7574 650a 2020  ent attribute.  
-000236d0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-000236e0: 2020 7061 7468 203d 2066 2268 7562 2f73    path = f"hub/s
-000236f0: 6f75 7263 6573 2f7b 736f 7572 6365 5f6e  ources/{source_n
-00023700: 616d 657d 2f69 7465 6d73 2f7b 6974 656d  ame}/items/{item
-00023710: 5f6e 616d 657d 2f61 7373 6574 732f 7b61  _name}/assets/{a
-00023720: 7373 6574 5f6e 616d 657d 220a 2020 2020  sset_name}".    
-00023730: 2020 2020 7061 7261 6d73 203d 207b 0a20      params = {. 
-00023740: 2020 2020 2020 2020 2020 2022 7665 7273             "vers
-00023750: 696f 6e22 3a20 7665 7273 696f 6e2c 0a20  ion": version,. 
-00023760: 2020 2020 2020 2020 2020 2022 7461 6722             "tag"
-00023770: 3a20 7461 672c 0a20 2020 2020 2020 207d  : tag,.        }
-00023780: 0a20 2020 2020 2020 2072 6573 706f 6e73  .        respons
-00023790: 6520 3d20 7365 6c66 2e61 7069 5f63 616c  e = self.api_cal
-000237a0: 6c28 6d65 7468 6f64 3d22 4745 5422 2c20  l(method="GET", 
-000237b0: 7061 7468 3d70 6174 682c 2070 6172 616d  path=path, param
-000237c0: 733d 7061 7261 6d73 290a 2020 2020 2020  s=params).      
-000237d0: 2020 7265 7475 726e 2072 6573 706f 6e73    return respons
-000237e0: 650a 0a20 2020 2064 6566 2076 6572 6966  e..    def verif
-000237f0: 795f 6175 7468 6f72 697a 6174 696f 6e28  y_authorization(
-00023800: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-00023810: 2020 2020 2020 2061 7574 686f 7269 7a61         authoriza
-00023820: 7469 6f6e 5f76 6572 6966 6963 6174 696f  tion_verificatio
-00023830: 6e5f 696e 7075 743a 206d 6c72 756e 2e63  n_input: mlrun.c
-00023840: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 4175  ommon.schemas.Au
-00023850: 7468 6f72 697a 6174 696f 6e56 6572 6966  thorizationVerif
-00023860: 6963 6174 696f 6e49 6e70 7574 2c0a 2020  icationInput,.  
-00023870: 2020 293a 0a20 2020 2020 2020 2022 2222    ):.        """
-00023880: 5665 7269 6669 6573 2061 7574 686f 7269  Verifies authori
-00023890: 7a61 7469 6f6e 2066 6f72 2074 6865 2070  zation for the p
-000238a0: 726f 7669 6465 6420 6163 7469 6f6e 206f  rovided action o
-000238b0: 6e20 7468 6520 7072 6f76 6964 6564 2072  n the provided r
-000238c0: 6573 6f75 7263 652e 0a0a 2020 2020 2020  esource...      
-000238d0: 2020 3a70 6172 616d 2061 7574 686f 7269    :param authori
-000238e0: 7a61 7469 6f6e 5f76 6572 6966 6963 6174  zation_verificat
-000238f0: 696f 6e5f 696e 7075 743a 2049 6e73 7461  ion_input: Insta
-00023900: 6e63 6520 6f66 0a20 2020 2020 2020 2020  nce of.         
-00023910: 2020 203a 7079 3a63 6c61 7373 3a60 7e6d     :py:class:`~m
-00023920: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
-00023930: 6d61 732e 4175 7468 6f72 697a 6174 696f  mas.Authorizatio
-00023940: 6e56 6572 6966 6963 6174 696f 6e49 6e70  nVerificationInp
-00023950: 7574 6020 7468 6174 2069 6e63 6c75 6465  ut` that include
-00023960: 7320 616c 6c20 7468 6520 6e65 6564 6564  s all the needed
-00023970: 2070 6172 616d 6574 6572 7320 666f 720a   parameters for.
-00023980: 2020 2020 2020 2020 2020 2020 7468 6520              the 
-00023990: 6175 7468 2076 6572 6966 6963 6174 696f  auth verificatio
-000239a0: 6e0a 2020 2020 2020 2020 2222 220a 2020  n.        """.  
-000239b0: 2020 2020 2020 6572 726f 725f 6d65 7373        error_mess
-000239c0: 6167 6520 3d20 2241 7574 686f 7269 7a61  age = "Authoriza
-000239d0: 7469 6f6e 2063 6865 636b 2066 6169 6c65  tion check faile
-000239e0: 6422 0a20 2020 2020 2020 2073 656c 662e  d".        self.
-000239f0: 6170 695f 6361 6c6c 280a 2020 2020 2020  api_call(.      
-00023a00: 2020 2020 2020 2250 4f53 5422 2c0a 2020        "POST",.  
-00023a10: 2020 2020 2020 2020 2020 2261 7574 686f            "autho
-00023a20: 7269 7a61 7469 6f6e 2f76 6572 6966 6963  rization/verific
-00023a30: 6174 696f 6e73 222c 0a20 2020 2020 2020  ations",.       
-00023a40: 2020 2020 2065 7272 6f72 5f6d 6573 7361       error_messa
-00023a50: 6765 2c0a 2020 2020 2020 2020 2020 2020  ge,.            
-00023a60: 626f 6479 3d64 6963 745f 746f 5f6a 736f  body=dict_to_jso
-00023a70: 6e28 6175 7468 6f72 697a 6174 696f 6e5f  n(authorization_
-00023a80: 7665 7269 6669 6361 7469 6f6e 5f69 6e70  verification_inp
-00023a90: 7574 2e64 6963 7428 2929 2c0a 2020 2020  ut.dict()),.    
-00023aa0: 2020 2020 290a 0a20 2020 2064 6566 206c      )..    def l
-00023ab0: 6973 745f 6170 695f 6761 7465 7761 7973  ist_api_gateways
-00023ac0: 2873 656c 662c 2070 726f 6a65 6374 3d4e  (self, project=N
-00023ad0: 6f6e 6529 202d 3e20 6d6c 7275 6e2e 636f  one) -> mlrun.co
-00023ae0: 6d6d 6f6e 2e73 6368 656d 6173 2e41 5049  mmon.schemas.API
-00023af0: 4761 7465 7761 7973 4f75 7470 7574 3a0a  GatewaysOutput:.
-00023b00: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00023b10: 2020 2020 5265 7475 726e 7320 6120 6c69      Returns a li
-00023b20: 7374 206f 6620 4e75 636c 696f 2061 7069  st of Nuclio api
-00023b30: 2067 6174 6577 6179 730a 2020 2020 2020   gateways.      
-00023b40: 2020 3a70 6172 616d 2070 726f 6a65 6374    :param project
-00023b50: 3a20 6f70 7469 6f6e 616c 2073 7472 2070  : optional str p
-00023b60: 6172 616d 6574 6572 2074 6f20 6669 6c74  arameter to filt
-00023b70: 6572 2062 7920 7072 6f6a 6563 742c 2069  er by project, i
-00023b80: 6620 6e6f 7420 7061 7373 6564 2c20 6465  f not passed, de
-00023b90: 6661 756c 7420 7072 6f6a 6563 7420 7661  fault project va
-00023ba0: 6c75 6520 6973 2074 616b 656e 0a0a 2020  lue is taken..  
-00023bb0: 2020 2020 2020 3a72 6574 7572 6e3a 203a        :return: :
-00023bc0: 7079 3a63 6c61 7373 3a60 7e6d 6c72 756e  py:class:`~mlrun
-00023bd0: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
-00023be0: 4150 4947 6174 6577 6179 7360 2e0a 2020  APIGateways`..  
-00023bf0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00023c00: 2020 7072 6f6a 6563 7420 3d20 7072 6f6a    project = proj
-00023c10: 6563 7420 6f72 2063 6f6e 6669 672e 6465  ect or config.de
-00023c20: 6661 756c 745f 7072 6f6a 6563 740a 2020  fault_project.  
-00023c30: 2020 2020 2020 6572 726f 7220 3d20 226c        error = "l
-00023c40: 6973 7420 6170 6920 6761 7465 7761 7973  ist api gateways
-00023c50: 220a 2020 2020 2020 2020 656e 6470 6f69  ".        endpoi
-00023c60: 6e74 5f70 6174 6820 3d20 6622 7072 6f6a  nt_path = f"proj
-00023c70: 6563 7473 2f7b 7072 6f6a 6563 747d 2f61  ects/{project}/a
-00023c80: 7069 2d67 6174 6577 6179 7322 0a20 2020  pi-gateways".   
-00023c90: 2020 2020 2072 6573 706f 6e73 6520 3d20       response = 
-00023ca0: 7365 6c66 2e61 7069 5f63 616c 6c28 2247  self.api_call("G
-00023cb0: 4554 222c 2065 6e64 706f 696e 745f 7061  ET", endpoint_pa
-00023cc0: 7468 2c20 6572 726f 7229 0a20 2020 2020  th, error).     
-00023cd0: 2020 2072 6574 7572 6e20 6d6c 7275 6e2e     return mlrun.
-00023ce0: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e41  common.schemas.A
-00023cf0: 5049 4761 7465 7761 7973 4f75 7470 7574  PIGatewaysOutput
-00023d00: 282a 2a72 6573 706f 6e73 652e 6a73 6f6e  (**response.json
-00023d10: 2829 290a 0a20 2020 2064 6566 2067 6574  ())..    def get
-00023d20: 5f61 7069 5f67 6174 6577 6179 2873 656c  _api_gateway(sel
-00023d30: 662c 206e 616d 652c 2070 726f 6a65 6374  f, name, project
-00023d40: 3d4e 6f6e 6529 202d 3e20 6d6c 7275 6e2e  =None) -> mlrun.
-00023d50: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e41  common.schemas.A
-00023d60: 5049 4761 7465 7761 793a 0a20 2020 2020  PIGateway:.     
-00023d70: 2020 2022 2222 0a20 2020 2020 2020 2052     """.        R
-00023d80: 6574 7572 6e73 2061 6e20 4150 4920 6761  eturns an API ga
-00023d90: 7465 7761 790a 2020 2020 2020 2020 3a70  teway.        :p
-00023da0: 6172 616d 206e 616d 653a 2041 5049 2067  aram name: API g
-00023db0: 6174 6577 6179 206e 616d 650a 2020 2020  ateway name.    
-00023dc0: 2020 2020 3a70 6172 616d 2070 726f 6a65      :param proje
-00023dd0: 6374 3a20 6f70 7469 6f6e 616c 2073 7472  ct: optional str
-00023de0: 2070 6172 616d 6574 6572 2074 6f20 6669   parameter to fi
-00023df0: 6c74 6572 2062 7920 7072 6f6a 6563 742c  lter by project,
-00023e00: 2069 6620 6e6f 7420 7061 7373 6564 2c20   if not passed, 
-00023e10: 6465 6661 756c 7420 7072 6f6a 6563 7420  default project 
-00023e20: 7661 6c75 6520 6973 2074 616b 656e 0a0a  value is taken..
-00023e30: 2020 2020 2020 2020 3a72 6574 7572 6e3a          :return:
-00023e40: 2020 3a70 793a 636c 6173 733a 607e 6d6c    :py:class:`~ml
-00023e50: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
-00023e60: 6173 2e41 5049 4761 7465 7761 7960 2e0a  as.APIGateway`..
-00023e70: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00023e80: 2020 2020 7072 6f6a 6563 7420 3d20 7072      project = pr
-00023e90: 6f6a 6563 7420 6f72 2063 6f6e 6669 672e  oject or config.
-00023ea0: 6465 6661 756c 745f 7072 6f6a 6563 740a  default_project.
-00023eb0: 2020 2020 2020 2020 6572 726f 7220 3d20          error = 
-00023ec0: 2267 6574 2061 7069 2067 6174 6577 6179  "get api gateway
-00023ed0: 220a 2020 2020 2020 2020 656e 6470 6f69  ".        endpoi
-00023ee0: 6e74 5f70 6174 6820 3d20 6622 7072 6f6a  nt_path = f"proj
-00023ef0: 6563 7473 2f7b 7072 6f6a 6563 747d 2f61  ects/{project}/a
-00023f00: 7069 2d67 6174 6577 6179 732f 7b6e 616d  pi-gateways/{nam
-00023f10: 657d 220a 2020 2020 2020 2020 7265 7370  e}".        resp
-00023f20: 6f6e 7365 203d 2073 656c 662e 6170 695f  onse = self.api_
-00023f30: 6361 6c6c 2822 4745 5422 2c20 656e 6470  call("GET", endp
-00023f40: 6f69 6e74 5f70 6174 682c 2065 7272 6f72  oint_path, error
-00023f50: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-00023f60: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
-00023f70: 6865 6d61 732e 4150 4947 6174 6577 6179  hemas.APIGateway
-00023f80: 282a 2a72 6573 706f 6e73 652e 6a73 6f6e  (**response.json
-00023f90: 2829 290a 0a20 2020 2064 6566 2073 746f  ())..    def sto
-00023fa0: 7265 5f61 7069 5f67 6174 6577 6179 280a  re_api_gateway(.
-00023fb0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-00023fc0: 2020 2020 2020 6170 695f 6761 7465 7761        api_gatewa
-00023fd0: 793a 2055 6e69 6f6e 5b0a 2020 2020 2020  y: Union[.      
-00023fe0: 2020 2020 2020 6d6c 7275 6e2e 636f 6d6d        mlrun.comm
-00023ff0: 6f6e 2e73 6368 656d 6173 2e41 5049 4761  on.schemas.APIGa
-00024000: 7465 7761 792c 0a20 2020 2020 2020 2020  teway,.         
-00024010: 2020 206d 6c72 756e 2e72 756e 7469 6d65     mlrun.runtime
-00024020: 732e 6e75 636c 696f 2e61 7069 5f67 6174  s.nuclio.api_gat
-00024030: 6577 6179 2e41 5049 4761 7465 7761 792c  eway.APIGateway,
-00024040: 0a20 2020 2020 2020 205d 2c0a 2020 2020  .        ],.    
-00024050: 2020 2020 7072 6f6a 6563 743a 204f 7074      project: Opt
-00024060: 696f 6e61 6c5b 7374 725d 203d 204e 6f6e  ional[str] = Non
-00024070: 652c 0a20 2020 2029 202d 3e20 6d6c 7275  e,.    ) -> mlru
-00024080: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
-00024090: 2e41 5049 4761 7465 7761 793a 0a20 2020  .APIGateway:.   
-000240a0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-000240b0: 2053 746f 7265 7320 616e 2041 5049 2047   Stores an API G
-000240c0: 6174 6577 6179 2e0a 2020 2020 2020 2020  ateway..        
-000240d0: 3a70 6172 616d 2061 7069 5f67 6174 6577  :param api_gatew
-000240e0: 6179 203a 7079 3a63 6c61 7373 3a60 7e6d  ay :py:class:`~m
-000240f0: 6c72 756e 2e72 756e 7469 6d65 732e 6e75  lrun.runtimes.nu
-00024100: 636c 696f 2e41 5049 4761 7465 7761 7960  clio.APIGateway`
-00024110: 0a20 2020 2020 2020 2020 2020 206f 7220  .            or 
-00024120: 3a70 793a 636c 6173 733a 607e 6d6c 7275  :py:class:`~mlru
-00024130: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
-00024140: 2e41 5049 4761 7465 7761 7960 3a20 4150  .APIGateway`: AP
-00024150: 4920 4761 7465 7761 7920 656e 7469 7479  I Gateway entity
-00024160: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
-00024170: 2070 726f 6a65 6374 3a20 7072 6f6a 6563   project: projec
-00024180: 7420 6e61 6d65 2e20 4d61 6e64 6174 6f72  t name. Mandator
-00024190: 7920 6966 2061 7069 5f67 6174 6577 6179  y if api_gateway
-000241a0: 2069 7320 6d6c 7275 6e2e 636f 6d6d 6f6e   is mlrun.common
-000241b0: 2e73 6368 656d 6173 2e41 5049 4761 7465  .schemas.APIGate
-000241c0: 7761 792e 0a0a 2020 2020 2020 2020 3a72  way...        :r
-000241d0: 6574 7572 6e3a 2020 3a70 793a 636c 6173  eturn:  :py:clas
-000241e0: 733a 607e 6d6c 7275 6e2e 636f 6d6d 6f6e  s:`~mlrun.common
-000241f0: 2e73 6368 656d 6173 2e41 5049 4761 7465  .schemas.APIGate
-00024200: 7761 7960 2e0a 2020 2020 2020 2020 2222  way`..        ""
-00024210: 220a 0a20 2020 2020 2020 2069 6620 6973  "..        if is
-00024220: 696e 7374 616e 6365 2861 7069 5f67 6174  instance(api_gat
-00024230: 6577 6179 2c20 6d6c 7275 6e2e 7275 6e74  eway, mlrun.runt
-00024240: 696d 6573 2e6e 7563 6c69 6f2e 6170 695f  imes.nuclio.api_
-00024250: 6761 7465 7761 792e 4150 4947 6174 6577  gateway.APIGatew
-00024260: 6179 293a 0a20 2020 2020 2020 2020 2020  ay):.           
-00024270: 2061 7069 5f67 6174 6577 6179 203d 2061   api_gateway = a
-00024280: 7069 5f67 6174 6577 6179 2e74 6f5f 7363  pi_gateway.to_sc
-00024290: 6865 6d65 2829 0a20 2020 2020 2020 2065  heme().        e
-000242a0: 6e64 706f 696e 745f 7061 7468 203d 2066  ndpoint_path = f
-000242b0: 2270 726f 6a65 6374 732f 7b70 726f 6a65  "projects/{proje
-000242c0: 6374 7d2f 6170 692d 6761 7465 7761 7973  ct}/api-gateways
-000242d0: 2f7b 6170 695f 6761 7465 7761 792e 6d65  /{api_gateway.me
-000242e0: 7461 6461 7461 2e6e 616d 657d 220a 2020  tadata.name}".  
-000242f0: 2020 2020 2020 6572 726f 7220 3d20 2273        error = "s
-00024300: 746f 7265 2061 7069 2067 6174 6577 6179  tore api gateway
-00024310: 7322 0a20 2020 2020 2020 2072 6573 706f  s".        respo
-00024320: 6e73 6520 3d20 7365 6c66 2e61 7069 5f63  nse = self.api_c
-00024330: 616c 6c28 0a20 2020 2020 2020 2020 2020  all(.           
-00024340: 2022 5055 5422 2c0a 2020 2020 2020 2020   "PUT",.        
-00024350: 2020 2020 656e 6470 6f69 6e74 5f70 6174      endpoint_pat
-00024360: 682c 0a20 2020 2020 2020 2020 2020 2065  h,.            e
-00024370: 7272 6f72 2c0a 2020 2020 2020 2020 2020  rror,.          
-00024380: 2020 6a73 6f6e 3d61 7069 5f67 6174 6577    json=api_gatew
-00024390: 6179 2e64 6963 7428 6578 636c 7564 655f  ay.dict(exclude_
-000243a0: 756e 7365 743d 5472 7565 2c20 6578 636c  unset=True, excl
-000243b0: 7564 655f 6e6f 6e65 3d54 7275 6529 2c0a  ude_none=True),.
-000243c0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-000243d0: 2020 7265 7475 726e 206d 6c72 756e 2e63    return mlrun.c
-000243e0: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 4150  ommon.schemas.AP
-000243f0: 4947 6174 6577 6179 282a 2a72 6573 706f  IGateway(**respo
-00024400: 6e73 652e 6a73 6f6e 2829 290a 0a20 2020  nse.json())..   
-00024410: 2064 6566 2074 7269 6767 6572 5f6d 6967   def trigger_mig
-00024420: 7261 7469 6f6e 7328 7365 6c66 2920 2d3e  rations(self) ->
-00024430: 204f 7074 696f 6e61 6c5b 6d6c 7275 6e2e   Optional[mlrun.
-00024440: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e42  common.schemas.B
-00024450: 6163 6b67 726f 756e 6454 6173 6b5d 3a0a  ackgroundTask]:.
-00024460: 2020 2020 2020 2020 2222 2254 7269 6767          """Trigg
-00024470: 6572 206d 6967 7261 7469 6f6e 7320 2877  er migrations (w
-00024480: 696c 6c20 646f 206e 6f74 6869 6e67 2069  ill do nothing i
-00024490: 6620 6e6f 206d 6967 7261 7469 6f6e 7320  f no migrations 
-000244a0: 6172 6520 6e65 6564 6564 2920 616e 6420  are needed) and 
-000244b0: 7761 6974 2066 6f72 2074 6865 6d20 746f  wait for them to
-000244c0: 2066 696e 6973 6820 6966 2061 6374 7561   finish if actua
-000244d0: 6c6c 790a 2020 2020 2020 2020 7472 6967  lly.        trig
-000244e0: 6765 7265 640a 2020 2020 2020 2020 3a72  gered.        :r
-000244f0: 6574 7572 6e73 3a20 3a70 793a 636c 6173  eturns: :py:clas
-00024500: 733a 607e 6d6c 7275 6e2e 636f 6d6d 6f6e  s:`~mlrun.common
-00024510: 2e73 6368 656d 6173 2e42 6163 6b67 726f  .schemas.Backgro
-00024520: 756e 6454 6173 6b60 2e0a 2020 2020 2020  undTask`..      
-00024530: 2020 2222 220a 2020 2020 2020 2020 7265    """.        re
-00024540: 7370 6f6e 7365 203d 2073 656c 662e 6170  sponse = self.ap
-00024550: 695f 6361 6c6c 280a 2020 2020 2020 2020  i_call(.        
-00024560: 2020 2020 2250 4f53 5422 2c0a 2020 2020      "POST",.    
-00024570: 2020 2020 2020 2020 226f 7065 7261 7469          "operati
-00024580: 6f6e 732f 6d69 6772 6174 696f 6e73 222c  ons/migrations",
-00024590: 0a20 2020 2020 2020 2020 2020 2022 4661  .            "Fa
-000245a0: 696c 6564 2074 7269 6767 6572 696e 6720  iled triggering 
-000245b0: 6d69 6772 6174 696f 6e73 222c 0a20 2020  migrations",.   
-000245c0: 2020 2020 2029 0a20 2020 2020 2020 2069       ).        i
-000245d0: 6620 7265 7370 6f6e 7365 2e73 7461 7475  f response.statu
-000245e0: 735f 636f 6465 203d 3d20 6874 7470 2e48  s_code == http.H
-000245f0: 5454 5053 7461 7475 732e 4143 4345 5054  TTPStatus.ACCEPT
-00024600: 4544 3a0a 2020 2020 2020 2020 2020 2020  ED:.            
-00024610: 6261 636b 6772 6f75 6e64 5f74 6173 6b20  background_task 
-00024620: 3d20 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  = mlrun.common.s
-00024630: 6368 656d 6173 2e42 6163 6b67 726f 756e  chemas.Backgroun
-00024640: 6454 6173 6b28 2a2a 7265 7370 6f6e 7365  dTask(**response
-00024650: 2e6a 736f 6e28 2929 0a20 2020 2020 2020  .json()).       
-00024660: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00024670: 2e5f 7761 6974 5f66 6f72 5f62 6163 6b67  ._wait_for_backg
-00024680: 726f 756e 645f 7461 736b 5f74 6f5f 7265  round_task_to_re
-00024690: 6163 685f 7465 726d 696e 616c 5f73 7461  ach_terminal_sta
-000246a0: 7465 280a 2020 2020 2020 2020 2020 2020  te(.            
-000246b0: 2020 2020 6261 636b 6772 6f75 6e64 5f74      background_t
-000246c0: 6173 6b2e 6d65 7461 6461 7461 2e6e 616d  ask.metadata.nam
-000246d0: 650a 2020 2020 2020 2020 2020 2020 290a  e.            ).
-000246e0: 2020 2020 2020 2020 7265 7475 726e 204e          return N
-000246f0: 6f6e 650a 0a20 2020 2064 6566 2073 6574  one..    def set
-00024700: 5f72 756e 5f6e 6f74 6966 6963 6174 696f  _run_notificatio
-00024710: 6e73 280a 2020 2020 2020 2020 7365 6c66  ns(.        self
-00024720: 2c0a 2020 2020 2020 2020 7072 6f6a 6563  ,.        projec
-00024730: 743a 2073 7472 2c0a 2020 2020 2020 2020  t: str,.        
-00024740: 7275 6e5f 7569 643a 2073 7472 2c0a 2020  run_uid: str,.  
-00024750: 2020 2020 2020 6e6f 7469 6669 6361 7469        notificati
-00024760: 6f6e 733a 206c 6973 745b 6d6c 7275 6e2e  ons: list[mlrun.
-00024770: 6d6f 6465 6c2e 4e6f 7469 6669 6361 7469  model.Notificati
-00024780: 6f6e 5d20 3d20 4e6f 6e65 2c0a 2020 2020  on] = None,.    
-00024790: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
-000247a0: 2020 2020 2020 2053 6574 206e 6f74 6966         Set notif
-000247b0: 6963 6174 696f 6e73 206f 6e20 6120 7275  ications on a ru
-000247c0: 6e2e 2054 6869 7320 7769 6c6c 206f 7665  n. This will ove
-000247d0: 7272 6964 6520 616e 7920 6578 6973 7469  rride any existi
-000247e0: 6e67 206e 6f74 6966 6963 6174 696f 6e73  ng notifications
-000247f0: 206f 6e20 7468 6520 7275 6e2e 0a20 2020   on the run..   
-00024800: 2020 2020 203a 7061 7261 6d20 7072 6f6a       :param proj
-00024810: 6563 743a 2050 726f 6a65 6374 2063 6f6e  ect: Project con
-00024820: 7461 696e 696e 6720 7468 6520 7275 6e2e  taining the run.
-00024830: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
-00024840: 7275 6e5f 7569 643a 2055 4944 206f 6620  run_uid: UID of 
-00024850: 7468 6520 7275 6e2e 0a20 2020 2020 2020  the run..       
-00024860: 203a 7061 7261 6d20 6e6f 7469 6669 6361   :param notifica
-00024870: 7469 6f6e 733a 204c 6973 7420 6f66 206e  tions: List of n
-00024880: 6f74 6966 6963 6174 696f 6e73 2074 6f20  otifications to 
-00024890: 7365 7420 6f6e 2074 6865 2072 756e 2e20  set on the run. 
-000248a0: 4465 6661 756c 7420 6973 2061 6e20 656d  Default is an em
-000248b0: 7074 7920 6c69 7374 2e0a 2020 2020 2020  pty list..      
-000248c0: 2020 2222 220a 2020 2020 2020 2020 6e6f    """.        no
-000248d0: 7469 6669 6361 7469 6f6e 7320 3d20 6e6f  tifications = no
-000248e0: 7469 6669 6361 7469 6f6e 7320 6f72 205b  tifications or [
-000248f0: 5d0a 0a20 2020 2020 2020 2073 656c 662e  ]..        self.
-00024900: 6170 695f 6361 6c6c 280a 2020 2020 2020  api_call(.      
-00024910: 2020 2020 2020 2250 5554 222c 0a20 2020        "PUT",.   
-00024920: 2020 2020 2020 2020 2066 2270 726f 6a65           f"proje
-00024930: 6374 732f 7b70 726f 6a65 6374 7d2f 7275  cts/{project}/ru
-00024940: 6e73 2f7b 7275 6e5f 7569 647d 2f6e 6f74  ns/{run_uid}/not
-00024950: 6966 6963 6174 696f 6e73 222c 0a20 2020  ifications",.   
-00024960: 2020 2020 2020 2020 2066 2246 6169 6c65           f"Faile
-00024970: 6420 746f 2073 6574 206e 6f74 6966 6963  d to set notific
-00024980: 6174 696f 6e73 206f 6e20 7275 6e2e 2075  ations on run. u
-00024990: 6964 3d7b 7275 6e5f 7569 647d 2c20 7072  id={run_uid}, pr
-000249a0: 6f6a 6563 743d 7b70 726f 6a65 6374 7d22  oject={project}"
-000249b0: 2c0a 2020 2020 2020 2020 2020 2020 6a73  ,.            js
-000249c0: 6f6e 3d7b 0a20 2020 2020 2020 2020 2020  on={.           
-000249d0: 2020 2020 2022 6e6f 7469 6669 6361 7469       "notificati
-000249e0: 6f6e 7322 3a20 5b0a 2020 2020 2020 2020  ons": [.        
-000249f0: 2020 2020 2020 2020 2020 2020 6e6f 7469              noti
-00024a00: 6669 6361 7469 6f6e 2e74 6f5f 6469 6374  fication.to_dict
-00024a10: 2829 2066 6f72 206e 6f74 6966 6963 6174  () for notificat
-00024a20: 696f 6e20 696e 206e 6f74 6966 6963 6174  ion in notificat
-00024a30: 696f 6e73 0a20 2020 2020 2020 2020 2020  ions.           
-00024a40: 2020 2020 205d 2c0a 2020 2020 2020 2020       ],.        
-00024a50: 2020 2020 7d2c 0a20 2020 2020 2020 2029      },.        )
-00024a60: 0a0a 2020 2020 6465 6620 7365 745f 7363  ..    def set_sc
-00024a70: 6865 6475 6c65 5f6e 6f74 6966 6963 6174  hedule_notificat
-00024a80: 696f 6e73 280a 2020 2020 2020 2020 7365  ions(.        se
-00024a90: 6c66 2c0a 2020 2020 2020 2020 7072 6f6a  lf,.        proj
-00024aa0: 6563 743a 2073 7472 2c0a 2020 2020 2020  ect: str,.      
-00024ab0: 2020 7363 6865 6475 6c65 5f6e 616d 653a    schedule_name:
-00024ac0: 2073 7472 2c0a 2020 2020 2020 2020 6e6f   str,.        no
-00024ad0: 7469 6669 6361 7469 6f6e 733a 206c 6973  tifications: lis
-00024ae0: 745b 6d6c 7275 6e2e 6d6f 6465 6c2e 4e6f  t[mlrun.model.No
-00024af0: 7469 6669 6361 7469 6f6e 5d20 3d20 4e6f  tification] = No
-00024b00: 6e65 2c0a 2020 2020 293a 0a20 2020 2020  ne,.    ):.     
-00024b10: 2020 2022 2222 0a20 2020 2020 2020 2053     """.        S
-00024b20: 6574 206e 6f74 6966 6963 6174 696f 6e73  et notifications
-00024b30: 206f 6e20 6120 7363 6865 6475 6c65 2e20   on a schedule. 
-00024b40: 5468 6973 2077 696c 6c20 6f76 6572 7269  This will overri
-00024b50: 6465 2061 6e79 2065 7869 7374 696e 6720  de any existing 
-00024b60: 6e6f 7469 6669 6361 7469 6f6e 7320 6f6e  notifications on
-00024b70: 2074 6865 2073 6368 6564 756c 652e 0a20   the schedule.. 
-00024b80: 2020 2020 2020 203a 7061 7261 6d20 7072         :param pr
-00024b90: 6f6a 6563 743a 2050 726f 6a65 6374 2063  oject: Project c
-00024ba0: 6f6e 7461 696e 696e 6720 7468 6520 7363  ontaining the sc
-00024bb0: 6865 6475 6c65 2e0a 2020 2020 2020 2020  hedule..        
-00024bc0: 3a70 6172 616d 2073 6368 6564 756c 655f  :param schedule_
-00024bd0: 6e61 6d65 3a20 4e61 6d65 206f 6620 7468  name: Name of th
-00024be0: 6520 7363 6865 6475 6c65 2e0a 2020 2020  e schedule..    
-00024bf0: 2020 2020 3a70 6172 616d 206e 6f74 6966      :param notif
-00024c00: 6963 6174 696f 6e73 3a20 4c69 7374 206f  ications: List o
-00024c10: 6620 6e6f 7469 6669 6361 7469 6f6e 7320  f notifications 
-00024c20: 746f 2073 6574 206f 6e20 7468 6520 7363  to set on the sc
-00024c30: 6865 6475 6c65 2e20 4465 6661 756c 7420  hedule. Default 
-00024c40: 6973 2061 6e20 656d 7074 7920 6c69 7374  is an empty list
-00024c50: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00024c60: 2020 2020 2020 6e6f 7469 6669 6361 7469        notificati
-00024c70: 6f6e 7320 3d20 6e6f 7469 6669 6361 7469  ons = notificati
-00024c80: 6f6e 7320 6f72 205b 5d0a 0a20 2020 2020  ons or []..     
-00024c90: 2020 2073 656c 662e 6170 695f 6361 6c6c     self.api_call
-00024ca0: 280a 2020 2020 2020 2020 2020 2020 2250  (.            "P
-00024cb0: 5554 222c 0a20 2020 2020 2020 2020 2020  UT",.           
-00024cc0: 2066 2270 726f 6a65 6374 732f 7b70 726f   f"projects/{pro
-00024cd0: 6a65 6374 7d2f 7363 6865 6475 6c65 732f  ject}/schedules/
-00024ce0: 7b73 6368 6564 756c 655f 6e61 6d65 7d2f  {schedule_name}/
-00024cf0: 6e6f 7469 6669 6361 7469 6f6e 7322 2c0a  notifications",.
-00024d00: 2020 2020 2020 2020 2020 2020 6622 4661              f"Fa
-00024d10: 696c 6564 2074 6f20 7365 7420 6e6f 7469  iled to set noti
-00024d20: 6669 6361 7469 6f6e 7320 6f6e 2073 6368  fications on sch
-00024d30: 6564 756c 652e 2073 6368 6564 756c 653d  edule. schedule=
-00024d40: 7b73 6368 6564 756c 655f 6e61 6d65 7d2c  {schedule_name},
-00024d50: 2070 726f 6a65 6374 3d7b 7072 6f6a 6563   project={projec
-00024d60: 747d 222c 0a20 2020 2020 2020 2020 2020  t}",.           
-00024d70: 206a 736f 6e3d 7b0a 2020 2020 2020 2020   json={.        
-00024d80: 2020 2020 2020 2020 226e 6f74 6966 6963          "notific
-00024d90: 6174 696f 6e73 223a 205b 0a20 2020 2020  ations": [.     
-00024da0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-00024db0: 6f74 6966 6963 6174 696f 6e2e 746f 5f64  otification.to_d
-00024dc0: 6963 7428 2920 666f 7220 6e6f 7469 6669  ict() for notifi
-00024dd0: 6361 7469 6f6e 2069 6e20 6e6f 7469 6669  cation in notifi
-00024de0: 6361 7469 6f6e 730a 2020 2020 2020 2020  cations.        
-00024df0: 2020 2020 2020 2020 5d2c 0a20 2020 2020          ],.     
-00024e00: 2020 2020 2020 207d 2c0a 2020 2020 2020         },.      
-00024e10: 2020 290a 0a20 2020 2064 6566 2073 746f    )..    def sto
-00024e20: 7265 5f72 756e 5f6e 6f74 6966 6963 6174  re_run_notificat
-00024e30: 696f 6e73 280a 2020 2020 2020 2020 7365  ions(.        se
-00024e40: 6c66 2c0a 2020 2020 2020 2020 6e6f 7469  lf,.        noti
-00024e50: 6669 6361 7469 6f6e 5f6f 626a 6563 7473  fication_objects
-00024e60: 3a20 6c69 7374 5b6d 6c72 756e 2e6d 6f64  : list[mlrun.mod
-00024e70: 656c 2e4e 6f74 6966 6963 6174 696f 6e5d  el.Notification]
-00024e80: 2c0a 2020 2020 2020 2020 7275 6e5f 7569  ,.        run_ui
-00024e90: 643a 2073 7472 2c0a 2020 2020 2020 2020  d: str,.        
-00024ea0: 7072 6f6a 6563 743a 2073 7472 203d 204e  project: str = N
-00024eb0: 6f6e 652c 0a20 2020 2020 2020 206d 6173  one,.        mas
-00024ec0: 6b5f 7061 7261 6d73 3a20 626f 6f6c 203d  k_params: bool =
-00024ed0: 2054 7275 652c 0a20 2020 2029 3a0a 2020   True,.    ):.  
-00024ee0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00024ef0: 2020 466f 7220 696e 7465 726e 616c 2075    For internal u
-00024f00: 7365 2e0a 2020 2020 2020 2020 5468 6520  se..        The 
-00024f10: 6e6f 7469 6669 6361 7469 6f6e 206d 6563  notification mec
-00024f20: 6861 6e69 736d 206d 6179 2072 756e 2022  hanism may run "
-00024f30: 6c6f 6361 6c6c 7922 2066 6f72 2063 6572  locally" for cer
-00024f40: 7461 696e 2072 756e 7469 6d65 732e 0a20  tain runtimes.. 
-00024f50: 2020 2020 2020 2048 6f77 6576 6572 2c20         However, 
-00024f60: 7468 6520 7570 6461 7465 7320 6f63 6375  the updates occu
-00024f70: 7220 696e 2074 6865 2041 5049 2073 6f20  r in the API so 
-00024f80: 6e6f 7468 696e 6720 746f 2064 6f20 6865  nothing to do he
-00024f90: 7265 2e0a 2020 2020 2020 2020 2222 220a  re..        """.
-00024fa0: 2020 2020 2020 2020 7061 7373 0a0a 2020          pass..  
-00024fb0: 2020 6465 6620 7375 626d 6974 5f77 6f72    def submit_wor
-00024fc0: 6b66 6c6f 7728 0a20 2020 2020 2020 2073  kflow(.        s
-00024fd0: 656c 662c 0a20 2020 2020 2020 2070 726f  elf,.        pro
-00024fe0: 6a65 6374 3a20 7374 722c 0a20 2020 2020  ject: str,.     
-00024ff0: 2020 206e 616d 653a 2073 7472 2c0a 2020     name: str,.  
-00025000: 2020 2020 2020 776f 726b 666c 6f77 5f73        workflow_s
-00025010: 7065 633a 2055 6e69 6f6e 5b0a 2020 2020  pec: Union[.    
-00025020: 2020 2020 2020 2020 6d6c 7275 6e2e 7072          mlrun.pr
-00025030: 6f6a 6563 7473 2e70 6970 656c 696e 6573  ojects.pipelines
-00025040: 2e57 6f72 6b66 6c6f 7753 7065 632c 0a20  .WorkflowSpec,. 
-00025050: 2020 2020 2020 2020 2020 206d 6c72 756e             mlrun
-00025060: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
-00025070: 576f 726b 666c 6f77 5370 6563 2c0a 2020  WorkflowSpec,.  
-00025080: 2020 2020 2020 2020 2020 6469 6374 2c0a            dict,.
-00025090: 2020 2020 2020 2020 5d2c 0a20 2020 2020          ],.     
-000250a0: 2020 2061 7267 756d 656e 7473 3a20 4f70     arguments: Op
-000250b0: 7469 6f6e 616c 5b64 6963 745d 203d 204e  tional[dict] = N
-000250c0: 6f6e 652c 0a20 2020 2020 2020 2061 7274  one,.        art
-000250d0: 6966 6163 745f 7061 7468 3a20 4f70 7469  ifact_path: Opti
-000250e0: 6f6e 616c 5b73 7472 5d20 3d20 4e6f 6e65  onal[str] = None
-000250f0: 2c0a 2020 2020 2020 2020 736f 7572 6365  ,.        source
-00025100: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
-00025110: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-00025120: 7275 6e5f 6e61 6d65 3a20 4f70 7469 6f6e  run_name: Option
-00025130: 616c 5b73 7472 5d20 3d20 4e6f 6e65 2c0a  al[str] = None,.
-00025140: 2020 2020 2020 2020 6e61 6d65 7370 6163          namespac
-00025150: 653a 204f 7074 696f 6e61 6c5b 7374 725d  e: Optional[str]
-00025160: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-00025170: 206e 6f74 6966 6963 6174 696f 6e73 3a20   notifications: 
-00025180: 6c69 7374 5b6d 6c72 756e 2e6d 6f64 656c  list[mlrun.model
-00025190: 2e4e 6f74 6966 6963 6174 696f 6e5d 203d  .Notification] =
-000251a0: 204e 6f6e 652c 0a20 2020 2029 202d 3e20   None,.    ) -> 
-000251b0: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-000251c0: 656d 6173 2e57 6f72 6b66 6c6f 7752 6573  emas.WorkflowRes
-000251d0: 706f 6e73 653a 0a20 2020 2020 2020 2022  ponse:.        "
-000251e0: 2222 0a20 2020 2020 2020 2053 7562 6d69  "".        Submi
-000251f0: 7474 696e 6720 776f 726b 666c 6f77 2066  tting workflow f
-00025200: 6f72 2061 2072 656d 6f74 6520 6578 6563  or a remote exec
-00025210: 7574 696f 6e2e 0a0a 2020 2020 2020 2020  ution...        
-00025220: 3a70 6172 616d 2070 726f 6a65 6374 3a20  :param project: 
-00025230: 2020 2020 2020 2020 7072 6f6a 6563 7420          project 
-00025240: 6e61 6d65 0a20 2020 2020 2020 203a 7061  name.        :pa
-00025250: 7261 6d20 6e61 6d65 3a20 2020 2020 2020  ram name:       
-00025260: 2020 2020 2077 6f72 6b66 6c6f 7720 6e61       workflow na
-00025270: 6d65 0a20 2020 2020 2020 203a 7061 7261  me.        :para
-00025280: 6d20 776f 726b 666c 6f77 5f73 7065 633a  m workflow_spec:
-00025290: 2020 2074 6865 2077 6f72 6b66 6c6f 7720     the workflow 
-000252a0: 7370 6563 2074 6f20 6578 6563 7574 650a  spec to execute.
-000252b0: 2020 2020 2020 2020 3a70 6172 616d 2061          :param a
-000252c0: 7267 756d 656e 7473 3a20 2020 2020 2020  rguments:       
-000252d0: 6172 6775 6d65 6e74 7320 666f 7220 7468  arguments for th
-000252e0: 6520 776f 726b 666c 6f77 0a20 2020 2020  e workflow.     
-000252f0: 2020 203a 7061 7261 6d20 6172 7469 6661     :param artifa
-00025300: 6374 5f70 6174 683a 2020 2061 7274 6966  ct_path:   artif
-00025310: 6163 7420 7461 7267 6574 2070 6174 6820  act target path 
-00025320: 6f66 2074 6865 2077 6f72 6b66 6c6f 770a  of the workflow.
-00025330: 2020 2020 2020 2020 3a70 6172 616d 2073          :param s
-00025340: 6f75 7263 653a 2020 2020 2020 2020 2020  ource:          
-00025350: 736f 7572 6365 2075 726c 206f 6620 7468  source url of th
-00025360: 6520 7072 6f6a 6563 740a 2020 2020 2020  e project.      
-00025370: 2020 3a70 6172 616d 2072 756e 5f6e 616d    :param run_nam
-00025380: 653a 2020 2020 2020 2020 7275 6e20 6e61  e:        run na
-00025390: 6d65 2074 6f20 6f76 6572 7269 6465 2074  me to override t
-000253a0: 6865 2064 6566 6175 6c74 3a20 2777 6f72  he default: 'wor
-000253b0: 6b66 6c6f 772d 7275 6e6e 6572 2d3c 776f  kflow-runner-<wo
-000253c0: 726b 666c 6f77 206e 616d 653e 270a 2020  rkflow name>'.  
-000253d0: 2020 2020 2020 3a70 6172 616d 206e 616d        :param nam
-000253e0: 6573 7061 6365 3a20 2020 2020 2020 6b75  espace:       ku
-000253f0: 6265 726e 6574 6573 206e 616d 6573 7061  bernetes namespa
-00025400: 6365 2069 6620 6f74 6865 7220 7468 616e  ce if other than
-00025410: 2064 6566 6175 6c74 0a20 2020 2020 2020   default.       
-00025420: 203a 7061 7261 6d20 6e6f 7469 6669 6361   :param notifica
-00025430: 7469 6f6e 733a 2020 206c 6973 7420 6f66  tions:   list of
-00025440: 206e 6f74 6966 6963 6174 696f 6e73 2074   notifications t
-00025450: 6f20 7365 6e64 2077 6865 6e20 776f 726b  o send when work
-00025460: 666c 6f77 2065 7865 6375 7469 6f6e 2069  flow execution i
-00025470: 7320 636f 6d70 6c65 7465 640a 0a20 2020  s completed..   
-00025480: 2020 2020 203a 7265 7475 726e 733a 2020       :returns:  
-00025490: 2020 3a70 793a 636c 6173 733a 607e 6d6c    :py:class:`~ml
-000254a0: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
-000254b0: 6173 2e57 6f72 6b66 6c6f 7752 6573 706f  as.WorkflowRespo
-000254c0: 6e73 6560 2e0a 2020 2020 2020 2020 2222  nse`..        ""
-000254d0: 220a 2020 2020 2020 2020 696d 6167 6520  ".        image 
-000254e0: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
-000254f0: 776f 726b 666c 6f77 5f73 7065 632e 696d  workflow_spec.im
-00025500: 6167 650a 2020 2020 2020 2020 2020 2020  age.            
-00025510: 6966 2068 6173 6174 7472 2877 6f72 6b66  if hasattr(workf
-00025520: 6c6f 775f 7370 6563 2c20 2269 6d61 6765  low_spec, "image
-00025530: 2229 0a20 2020 2020 2020 2020 2020 2065  ").            e
-00025540: 6c73 6520 776f 726b 666c 6f77 5f73 7065  lse workflow_spe
-00025550: 632e 6765 7428 2269 6d61 6765 222c 204e  c.get("image", N
-00025560: 6f6e 6529 0a20 2020 2020 2020 2029 0a20  one).        ). 
-00025570: 2020 2020 2020 2077 6f72 6b66 6c6f 775f         workflow_
-00025580: 6e61 6d65 203d 206e 616d 6520 6f72 2028  name = name or (
-00025590: 0a20 2020 2020 2020 2020 2020 2077 6f72  .            wor
-000255a0: 6b66 6c6f 775f 7370 6563 2e6e 616d 650a  kflow_spec.name.
-000255b0: 2020 2020 2020 2020 2020 2020 6966 2068              if h
-000255c0: 6173 6174 7472 2877 6f72 6b66 6c6f 775f  asattr(workflow_
-000255d0: 7370 6563 2c20 226e 616d 6522 290a 2020  spec, "name").  
-000255e0: 2020 2020 2020 2020 2020 656c 7365 2077            else w
-000255f0: 6f72 6b66 6c6f 775f 7370 6563 2e67 6574  orkflow_spec.get
-00025600: 2822 6e61 6d65 222c 204e 6f6e 6529 0a20  ("name", None). 
-00025610: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00025620: 2072 6571 203d 207b 0a20 2020 2020 2020   req = {.       
-00025630: 2020 2020 2022 6172 6775 6d65 6e74 7322       "arguments"
-00025640: 3a20 6172 6775 6d65 6e74 732c 0a20 2020  : arguments,.   
-00025650: 2020 2020 2020 2020 2022 6172 7469 6661           "artifa
-00025660: 6374 5f70 6174 6822 3a20 6172 7469 6661  ct_path": artifa
-00025670: 6374 5f70 6174 682c 0a20 2020 2020 2020  ct_path,.       
-00025680: 2020 2020 2022 736f 7572 6365 223a 2073       "source": s
-00025690: 6f75 7263 652c 0a20 2020 2020 2020 2020  ource,.         
-000256a0: 2020 2022 7275 6e5f 6e61 6d65 223a 2072     "run_name": r
-000256b0: 756e 5f6e 616d 652c 0a20 2020 2020 2020  un_name,.       
-000256c0: 2020 2020 2022 6e61 6d65 7370 6163 6522       "namespace"
-000256d0: 3a20 6e61 6d65 7370 6163 652c 0a20 2020  : namespace,.   
-000256e0: 2020 2020 207d 0a20 2020 2020 2020 2069       }.        i
-000256f0: 6620 6973 696e 7374 616e 6365 280a 2020  f isinstance(.  
-00025700: 2020 2020 2020 2020 2020 776f 726b 666c            workfl
-00025710: 6f77 5f73 7065 632c 0a20 2020 2020 2020  ow_spec,.       
-00025720: 2020 2020 206d 6c72 756e 2e63 6f6d 6d6f       mlrun.commo
-00025730: 6e2e 7363 6865 6d61 732e 576f 726b 666c  n.schemas.Workfl
-00025740: 6f77 5370 6563 2c0a 2020 2020 2020 2020  owSpec,.        
-00025750: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
-00025760: 6571 5b22 7370 6563 225d 203d 2077 6f72  eq["spec"] = wor
-00025770: 6b66 6c6f 775f 7370 6563 2e64 6963 7428  kflow_spec.dict(
-00025780: 290a 2020 2020 2020 2020 656c 6966 2069  ).        elif i
-00025790: 7369 6e73 7461 6e63 6528 776f 726b 666c  sinstance(workfl
-000257a0: 6f77 5f73 7065 632c 206d 6c72 756e 2e70  ow_spec, mlrun.p
-000257b0: 726f 6a65 6374 732e 7069 7065 6c69 6e65  rojects.pipeline
-000257c0: 732e 576f 726b 666c 6f77 5370 6563 293a  s.WorkflowSpec):
-000257d0: 0a20 2020 2020 2020 2020 2020 2072 6571  .            req
-000257e0: 5b22 7370 6563 225d 203d 2077 6f72 6b66  ["spec"] = workf
-000257f0: 6c6f 775f 7370 6563 2e74 6f5f 6469 6374  low_spec.to_dict
-00025800: 2829 0a20 2020 2020 2020 2065 6c73 653a  ().        else:
-00025810: 0a20 2020 2020 2020 2020 2020 2072 6571  .            req
-00025820: 5b22 7370 6563 225d 203d 2077 6f72 6b66  ["spec"] = workf
-00025830: 6c6f 775f 7370 6563 0a20 2020 2020 2020  low_spec.       
-00025840: 2072 6571 5b22 7370 6563 225d 5b22 696d   req["spec"]["im
-00025850: 6167 6522 5d20 3d20 696d 6167 650a 2020  age"] = image.  
-00025860: 2020 2020 2020 7265 715b 2273 7065 6322        req["spec"
-00025870: 5d5b 226e 616d 6522 5d20 3d20 776f 726b  ]["name"] = work
-00025880: 666c 6f77 5f6e 616d 650a 2020 2020 2020  flow_name.      
-00025890: 2020 6966 206e 6f74 6966 6963 6174 696f    if notificatio
-000258a0: 6e73 3a0a 2020 2020 2020 2020 2020 2020  ns:.            
-000258b0: 7265 715b 226e 6f74 6966 6963 6174 696f  req["notificatio
-000258c0: 6e73 225d 203d 205b 0a20 2020 2020 2020  ns"] = [.       
-000258d0: 2020 2020 2020 2020 206e 6f74 6966 6963           notific
-000258e0: 6174 696f 6e2e 746f 5f64 6963 7428 2920  ation.to_dict() 
-000258f0: 666f 7220 6e6f 7469 6669 6361 7469 6f6e  for notification
-00025900: 2069 6e20 6e6f 7469 6669 6361 7469 6f6e   in notification
-00025910: 730a 2020 2020 2020 2020 2020 2020 5d0a  s.            ].
-00025920: 0a20 2020 2020 2020 2072 6573 706f 6e73  .        respons
-00025930: 6520 3d20 7365 6c66 2e61 7069 5f63 616c  e = self.api_cal
-00025940: 6c28 0a20 2020 2020 2020 2020 2020 2022  l(.            "
-00025950: 504f 5354 222c 0a20 2020 2020 2020 2020  POST",.         
-00025960: 2020 2066 2270 726f 6a65 6374 732f 7b70     f"projects/{p
-00025970: 726f 6a65 6374 7d2f 776f 726b 666c 6f77  roject}/workflow
-00025980: 732f 7b77 6f72 6b66 6c6f 775f 6e61 6d65  s/{workflow_name
-00025990: 7d2f 7375 626d 6974 222c 0a20 2020 2020  }/submit",.     
-000259a0: 2020 2020 2020 206a 736f 6e3d 7265 712c         json=req,
-000259b0: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-000259c0: 2020 2072 6574 7572 6e20 6d6c 7275 6e2e     return mlrun.
-000259d0: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e57  common.schemas.W
-000259e0: 6f72 6b66 6c6f 7752 6573 706f 6e73 6528  orkflowResponse(
-000259f0: 2a2a 7265 7370 6f6e 7365 2e6a 736f 6e28  **response.json(
-00025a00: 2929 0a0a 2020 2020 6465 6620 6765 745f  ))..    def get_
-00025a10: 776f 726b 666c 6f77 5f69 6428 0a20 2020  workflow_id(.   
-00025a20: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-00025a30: 2020 2070 726f 6a65 6374 3a20 7374 722c     project: str,
-00025a40: 0a20 2020 2020 2020 206e 616d 653a 2073  .        name: s
-00025a50: 7472 2c0a 2020 2020 2020 2020 7275 6e5f  tr,.        run_
-00025a60: 6964 3a20 7374 722c 0a20 2020 2020 2020  id: str,.       
-00025a70: 2065 6e67 696e 653a 2073 7472 203d 2022   engine: str = "
-00025a80: 222c 0a20 2020 2029 3a0a 2020 2020 2020  ",.    ):.      
-00025a90: 2020 2222 220a 2020 2020 2020 2020 5265    """.        Re
-00025aa0: 7472 6965 7665 2077 6f72 6b66 6c6f 7720  trieve workflow 
-00025ab0: 6964 2066 726f 6d20 7468 6520 7569 6420  id from the uid 
-00025ac0: 6f66 2074 6865 2077 6f72 6b66 6c6f 7720  of the workflow 
-00025ad0: 7275 6e6e 6572 2e0a 0a20 2020 2020 2020  runner...       
-00025ae0: 203a 7061 7261 6d20 7072 6f6a 6563 743a   :param project:
-00025af0: 2070 726f 6a65 6374 206e 616d 650a 2020   project name.  
-00025b00: 2020 2020 2020 3a70 6172 616d 206e 616d        :param nam
-00025b10: 653a 2020 2020 776f 726b 666c 6f77 206e  e:    workflow n
-00025b20: 616d 650a 2020 2020 2020 2020 3a70 6172  ame.        :par
-00025b30: 616d 2072 756e 5f69 643a 2020 7468 6520  am run_id:  the 
-00025b40: 6964 206f 6620 7468 6520 776f 726b 666c  id of the workfl
-00025b50: 6f77 2072 756e 6e65 7220 2d20 7468 6520  ow runner - the 
-00025b60: 6a6f 6220 7468 6174 2072 756e 7320 7468  job that runs th
-00025b70: 6520 776f 726b 666c 6f77 0a20 2020 2020  e workflow.     
-00025b80: 2020 203a 7061 7261 6d20 656e 6769 6e65     :param engine
-00025b90: 3a20 2070 6970 656c 696e 6520 7275 6e6e  :  pipeline runn
-00025ba0: 6572 0a0a 2020 2020 2020 2020 3a72 6574  er..        :ret
-00025bb0: 7572 6e73 3a20 2020 3a70 793a 636c 6173  urns:   :py:clas
-00025bc0: 733a 607e 6d6c 7275 6e2e 636f 6d6d 6f6e  s:`~mlrun.common
-00025bd0: 2e73 6368 656d 6173 2e47 6574 576f 726b  .schemas.GetWork
-00025be0: 666c 6f77 5265 7370 6f6e 7365 602e 0a20  flowResponse`.. 
-00025bf0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00025c00: 2020 2070 6172 616d 7320 3d20 7b7d 0a20     params = {}. 
-00025c10: 2020 2020 2020 2069 6620 656e 6769 6e65         if engine
-00025c20: 3a0a 2020 2020 2020 2020 2020 2020 7061  :.            pa
-00025c30: 7261 6d73 5b22 656e 6769 6e65 225d 203d  rams["engine"] =
-00025c40: 2065 6e67 696e 650a 2020 2020 2020 2020   engine.        
-00025c50: 7265 7370 6f6e 7365 203d 2073 656c 662e  response = self.
-00025c60: 6170 695f 6361 6c6c 280a 2020 2020 2020  api_call(.      
-00025c70: 2020 2020 2020 2247 4554 222c 0a20 2020        "GET",.   
-00025c80: 2020 2020 2020 2020 2066 2270 726f 6a65           f"proje
-00025c90: 6374 732f 7b70 726f 6a65 6374 7d2f 776f  cts/{project}/wo
-00025ca0: 726b 666c 6f77 732f 7b6e 616d 657d 2f72  rkflows/{name}/r
-00025cb0: 756e 732f 7b72 756e 5f69 647d 222c 0a20  uns/{run_id}",. 
-00025cc0: 2020 2020 2020 2020 2020 2070 6172 616d             param
-00025cd0: 733d 7061 7261 6d73 2c0a 2020 2020 2020  s=params,.      
-00025ce0: 2020 290a 2020 2020 2020 2020 7265 7475    ).        retu
-00025cf0: 726e 206d 6c72 756e 2e63 6f6d 6d6f 6e2e  rn mlrun.common.
-00025d00: 7363 6865 6d61 732e 4765 7457 6f72 6b66  schemas.GetWorkf
-00025d10: 6c6f 7752 6573 706f 6e73 6528 2a2a 7265  lowResponse(**re
-00025d20: 7370 6f6e 7365 2e6a 736f 6e28 2929 0a0a  sponse.json())..
-00025d30: 2020 2020 6465 6620 6c6f 6164 5f70 726f      def load_pro
-00025d40: 6a65 6374 280a 2020 2020 2020 2020 7365  ject(.        se
-00025d50: 6c66 2c0a 2020 2020 2020 2020 6e61 6d65  lf,.        name
-00025d60: 3a20 7374 722c 0a20 2020 2020 2020 2075  : str,.        u
-00025d70: 726c 3a20 7374 722c 0a20 2020 2020 2020  rl: str,.       
-00025d80: 2073 6563 7265 7473 3a20 4f70 7469 6f6e   secrets: Option
-00025d90: 616c 5b64 6963 745d 203d 204e 6f6e 652c  al[dict] = None,
-00025da0: 0a20 2020 2020 2020 2073 6176 655f 7365  .        save_se
-00025db0: 6372 6574 733a 2062 6f6f 6c20 3d20 5472  crets: bool = Tr
-00025dc0: 7565 2c0a 2020 2020 2920 2d3e 2073 7472  ue,.    ) -> str
-00025dd0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-00025de0: 2020 2020 2020 4c6f 6164 696e 6720 6120        Loading a 
-00025df0: 7072 6f6a 6563 7420 7265 6d6f 7465 6c79  project remotely
-00025e00: 2066 726f 6d20 7468 6520 6769 7665 6e20   from the given 
-00025e10: 736f 7572 6365 2e0a 2020 2020 2020 2020  source..        
-00025e20: 3a70 6172 616d 206e 616d 653a 2020 2020  :param name:    
-00025e30: 7072 6f6a 6563 7420 6e61 6d65 0a20 2020  project name.   
-00025e40: 2020 2020 203a 7061 7261 6d20 7572 6c3a       :param url:
-00025e50: 2020 2020 2067 6974 206f 7220 7461 722e       git or tar.
-00025e60: 677a 206f 7220 2e7a 6970 2073 6f75 7263  gz or .zip sourc
-00025e70: 6573 2061 7263 6869 7665 2070 6174 6820  es archive path 
-00025e80: 652e 672e 3a0a 2020 2020 2020 2020 6769  e.g.:.        gi
-00025e90: 743a 2f2f 6769 7468 7562 2e63 6f6d 2f6d  t://github.com/m
-00025ea0: 6c72 756e 2f64 656d 6f2d 7867 622d 7072  lrun/demo-xgb-pr
-00025eb0: 6f6a 6563 742e 6769 740a 2020 2020 2020  oject.git.      
-00025ec0: 2020 6874 7470 3a2f 2f6d 7973 6974 652f    http://mysite/
-00025ed0: 6172 6368 6976 6564 2d70 726f 6a65 6374  archived-project
-00025ee0: 2e7a 6970 0a20 2020 2020 2020 2054 6865  .zip.        The
-00025ef0: 2067 6974 2070 726f 6a65 6374 2073 686f   git project sho
-00025f00: 756c 6420 696e 636c 7564 6520 7468 6520  uld include the 
-00025f10: 7072 6f6a 6563 7420 7961 6d6c 2066 696c  project yaml fil
-00025f20: 652e 0a20 2020 2020 2020 203a 7061 7261  e..        :para
-00025f30: 6d20 7365 6372 6574 733a 2020 2020 2020  m secrets:      
-00025f40: 2020 2053 6563 7265 7473 2074 6f20 7374     Secrets to st
-00025f50: 6f72 6520 696e 2070 726f 6a65 6374 2069  ore in project i
-00025f60: 6e20 6f72 6465 7220 746f 206c 6f61 6420  n order to load 
-00025f70: 6974 2066 726f 6d20 7468 6520 7072 6f76  it from the prov
-00025f80: 6964 6564 2075 726c 2e20 466f 7220 6d6f  ided url. For mo
-00025f90: 7265 0a20 2020 2020 2020 2069 6e66 6f72  re.        infor
-00025fa0: 6d61 7469 6f6e 2073 6565 203a 7079 3a66  mation see :py:f
-00025fb0: 756e 633a 606d 6c72 756e 2e6c 6f61 645f  unc:`mlrun.load_
-00025fc0: 7072 6f6a 6563 7460 2066 756e 6374 696f  project` functio
-00025fd0: 6e2e 0a20 2020 2020 2020 203a 7061 7261  n..        :para
-00025fe0: 6d20 7361 7665 5f73 6563 7265 7473 3a20  m save_secrets: 
-00025ff0: 2020 2057 6865 7468 6572 2074 6f20 7374     Whether to st
-00026000: 6f72 6520 7365 6372 6574 7320 696e 2074  ore secrets in t
-00026010: 6865 206c 6f61 6465 6420 7072 6f6a 6563  he loaded projec
-00026020: 742e 2053 6574 7469 6e67 2074 6f20 4661  t. Setting to Fa
-00026030: 6c73 6520 7769 6c6c 2063 6175 7365 2077  lse will cause w
-00026040: 6169 7469 6e67 0a20 2020 2020 2020 2066  aiting.        f
-00026050: 6f72 2074 6865 2070 726f 6365 7373 2063  or the process c
-00026060: 6f6d 706c 6574 696f 6e2e 0a0a 2020 2020  ompletion...    
-00026070: 2020 2020 3a72 6574 7572 6e73 3a20 2020      :returns:   
-00026080: 2020 2020 2020 2020 2020 2020 5468 6520              The 
-00026090: 7465 726d 696e 616c 2073 7461 7465 206f  terminal state o
-000260a0: 6620 6c6f 6164 2070 726f 6a65 6374 2070  f load project p
-000260b0: 726f 6365 7373 2e0a 2020 2020 2020 2020  rocess..        
-000260c0: 2222 220a 2020 2020 2020 2020 7061 7261  """.        para
-000260d0: 6d73 203d 207b 2275 726c 223a 2075 726c  ms = {"url": url
-000260e0: 7d0a 2020 2020 2020 2020 626f 6479 203d  }.        body =
-000260f0: 204e 6f6e 650a 2020 2020 2020 2020 6966   None.        if
-00026100: 2073 6563 7265 7473 3a0a 2020 2020 2020   secrets:.      
-00026110: 2020 2020 2020 7072 6f76 6964 6572 203d        provider =
-00026120: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
-00026130: 6865 6d61 732e 5365 6372 6574 5072 6f76  hemas.SecretProv
-00026140: 6964 6572 4e61 6d65 2e6b 7562 6572 6e65  iderName.kuberne
-00026150: 7465 730a 2020 2020 2020 2020 2020 2020  tes.            
-00026160: 7365 6372 6574 735f 696e 7075 7420 3d20  secrets_input = 
-00026170: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-00026180: 656d 6173 2e53 6563 7265 7473 4461 7461  emas.SecretsData
-00026190: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-000261a0: 2020 7072 6f76 6964 6572 3d70 726f 7669    provider=provi
-000261b0: 6465 722c 2073 6563 7265 7473 3d73 6563  der, secrets=sec
-000261c0: 7265 7473 0a20 2020 2020 2020 2020 2020  rets.           
-000261d0: 2029 0a20 2020 2020 2020 2020 2020 2062   ).            b
-000261e0: 6f64 7920 3d20 7365 6372 6574 735f 696e  ody = secrets_in
-000261f0: 7075 742e 6469 6374 2829 0a20 2020 2020  put.dict().     
-00026200: 2020 2072 6573 706f 6e73 6520 3d20 7365     response = se
-00026210: 6c66 2e61 7069 5f63 616c 6c28 0a20 2020  lf.api_call(.   
-00026220: 2020 2020 2020 2020 2022 504f 5354 222c           "POST",
-00026230: 2066 2270 726f 6a65 6374 732f 7b6e 616d   f"projects/{nam
-00026240: 657d 2f6c 6f61 6422 2c20 7061 7261 6d73  e}/load", params
-00026250: 3d70 6172 616d 732c 2062 6f64 793d 6469  =params, body=di
-00026260: 6374 5f74 6f5f 6a73 6f6e 2862 6f64 7929  ct_to_json(body)
-00026270: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-00026280: 2020 2072 6573 706f 6e73 6520 3d20 7265     response = re
-00026290: 7370 6f6e 7365 2e6a 736f 6e28 290a 2020  sponse.json().  
-000262a0: 2020 2020 2020 7275 6e20 3d20 6d6c 7275        run = mlru
-000262b0: 6e2e 5275 6e4f 626a 6563 742e 6672 6f6d  n.RunObject.from
-000262c0: 5f64 6963 7428 7265 7370 6f6e 7365 5b22  _dict(response["
-000262d0: 6461 7461 225d 290a 2020 2020 2020 2020  data"]).        
-000262e0: 7374 6174 652c 205f 203d 2072 756e 2e6c  state, _ = run.l
-000262f0: 6f67 7328 290a 0a20 2020 2020 2020 2069  ogs()..        i
-00026300: 6620 7365 6372 6574 7320 616e 6420 6e6f  f secrets and no
-00026310: 7420 7361 7665 5f73 6563 7265 7473 3a0a  t save_secrets:.
-00026320: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00026330: 2e64 656c 6574 655f 7072 6f6a 6563 745f  .delete_project_
-00026340: 7365 6372 6574 7328 7072 6f6a 6563 743d  secrets(project=
-00026350: 6e61 6d65 2c20 7365 6372 6574 733d 6c69  name, secrets=li
-00026360: 7374 2873 6563 7265 7473 2e6b 6579 7328  st(secrets.keys(
-00026370: 2929 290a 2020 2020 2020 2020 2020 2020  ))).            
-00026380: 6966 2073 7461 7465 2021 3d20 2263 6f6d  if state != "com
-00026390: 706c 6574 6564 223a 0a20 2020 2020 2020  pleted":.       
-000263a0: 2020 2020 2020 2020 206c 6f67 6765 722e           logger.
-000263b0: 6572 726f 7228 224c 6f61 6420 7072 6f6a  error("Load proj
-000263c0: 6563 7420 7461 736b 2066 6169 6c65 642c  ect task failed,
-000263d0: 2064 656c 6574 696e 6720 7072 6f6a 6563   deleting projec
-000263e0: 7422 290a 2020 2020 2020 2020 2020 2020  t").            
-000263f0: 2020 2020 7365 6c66 2e64 656c 6574 655f      self.delete_
-00026400: 7072 6f6a 6563 7428 6e61 6d65 2c20 6d6c  project(name, ml
-00026410: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
-00026420: 6173 2e44 656c 6574 696f 6e53 7472 6174  as.DeletionStrat
-00026430: 6567 792e 6361 7363 6164 6529 0a0a 2020  egy.cascade)..  
-00026440: 2020 2020 2020 7265 7475 726e 2073 7461        return sta
-00026450: 7465 0a0a 2020 2020 6465 6620 6765 745f  te..    def get_
-00026460: 6461 7461 7374 6f72 655f 7072 6f66 696c  datastore_profil
-00026470: 6528 0a20 2020 2020 2020 2073 656c 662c  e(.        self,
-00026480: 206e 616d 653a 2073 7472 2c20 7072 6f6a   name: str, proj
-00026490: 6563 743a 2073 7472 0a20 2020 2029 202d  ect: str.    ) -
-000264a0: 3e20 4f70 7469 6f6e 616c 5b6d 6c72 756e  > Optional[mlrun
-000264b0: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
-000264c0: 4461 7461 7374 6f72 6550 726f 6669 6c65  DatastoreProfile
-000264d0: 5d3a 0a20 2020 2020 2020 2070 726f 6a65  ]:.        proje
-000264e0: 6374 203d 2070 726f 6a65 6374 206f 7220  ct = project or 
-000264f0: 636f 6e66 6967 2e64 6566 6175 6c74 5f70  config.default_p
-00026500: 726f 6a65 6374 0a20 2020 2020 2020 205f  roject.        _
-00026510: 7061 7468 203d 2073 656c 662e 5f70 6174  path = self._pat
-00026520: 685f 6f66 2822 6461 7461 7374 6f72 652d  h_of("datastore-
-00026530: 7072 6f66 696c 6573 222c 2070 726f 6a65  profiles", proje
-00026540: 6374 2c20 6e61 6d65 290a 0a20 2020 2020  ct, name)..     
-00026550: 2020 2072 6573 203d 2073 656c 662e 6170     res = self.ap
-00026560: 695f 6361 6c6c 286d 6574 686f 643d 2247  i_call(method="G
-00026570: 4554 222c 2070 6174 683d 5f70 6174 6829  ET", path=_path)
-00026580: 0a20 2020 2020 2020 2069 6620 7265 733a  .        if res:
-00026590: 0a20 2020 2020 2020 2020 2020 2070 7562  .            pub
-000265a0: 6c69 635f 7772 6170 7065 7220 3d20 7265  lic_wrapper = re
-000265b0: 732e 6a73 6f6e 2829 0a20 2020 2020 2020  s.json().       
-000265c0: 2020 2020 2064 6174 6173 746f 7265 203d       datastore =
-000265d0: 2044 6174 6173 746f 7265 5072 6f66 696c   DatastoreProfil
-000265e0: 6532 4a73 6f6e 2e63 7265 6174 655f 6672  e2Json.create_fr
-000265f0: 6f6d 5f6a 736f 6e28 0a20 2020 2020 2020  om_json(.       
-00026600: 2020 2020 2020 2020 2070 7562 6c69 635f           public_
-00026610: 6a73 6f6e 3d70 7562 6c69 635f 7772 6170  json=public_wrap
-00026620: 7065 725b 226f 626a 6563 7422 5d0a 2020  per["object"].  
-00026630: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00026640: 2020 2020 2020 2020 7265 7475 726e 2064          return d
-00026650: 6174 6173 746f 7265 0a20 2020 2020 2020  atastore.       
-00026660: 2072 6574 7572 6e20 4e6f 6e65 0a0a 2020   return None..  
-00026670: 2020 6465 6620 6465 6c65 7465 5f64 6174    def delete_dat
-00026680: 6173 746f 7265 5f70 726f 6669 6c65 2873  astore_profile(s
-00026690: 656c 662c 206e 616d 653a 2073 7472 2c20  elf, name: str, 
-000266a0: 7072 6f6a 6563 743a 2073 7472 293a 0a20  project: str):. 
-000266b0: 2020 2020 2020 2070 726f 6a65 6374 203d         project =
-000266c0: 2070 726f 6a65 6374 206f 7220 636f 6e66   project or conf
-000266d0: 6967 2e64 6566 6175 6c74 5f70 726f 6a65  ig.default_proje
-000266e0: 6374 0a20 2020 2020 2020 205f 7061 7468  ct.        _path
-000266f0: 203d 2073 656c 662e 5f70 6174 685f 6f66   = self._path_of
-00026700: 2822 6461 7461 7374 6f72 652d 7072 6f66  ("datastore-prof
-00026710: 696c 6573 222c 2070 726f 6a65 6374 2c20  iles", project, 
-00026720: 6e61 6d65 290a 2020 2020 2020 2020 7365  name).        se
-00026730: 6c66 2e61 7069 5f63 616c 6c28 6d65 7468  lf.api_call(meth
-00026740: 6f64 3d22 4445 4c45 5445 222c 2070 6174  od="DELETE", pat
-00026750: 683d 5f70 6174 6829 0a20 2020 2020 2020  h=_path).       
-00026760: 2072 6574 7572 6e20 4e6f 6e65 0a0a 2020   return None..  
-00026770: 2020 6465 6620 6c69 7374 5f64 6174 6173    def list_datas
-00026780: 746f 7265 5f70 726f 6669 6c65 7328 0a20  tore_profiles(. 
-00026790: 2020 2020 2020 2073 656c 662c 2070 726f         self, pro
-000267a0: 6a65 6374 3a20 7374 720a 2020 2020 2920  ject: str.    ) 
-000267b0: 2d3e 206c 6973 745b 6d6c 7275 6e2e 636f  -> list[mlrun.co
-000267c0: 6d6d 6f6e 2e73 6368 656d 6173 2e44 6174  mmon.schemas.Dat
-000267d0: 6173 746f 7265 5072 6f66 696c 655d 3a0a  astoreProfile]:.
-000267e0: 2020 2020 2020 2020 7072 6f6a 6563 7420          project 
-000267f0: 3d20 7072 6f6a 6563 7420 6f72 2063 6f6e  = project or con
-00026800: 6669 672e 6465 6661 756c 745f 7072 6f6a  fig.default_proj
-00026810: 6563 740a 2020 2020 2020 2020 5f70 6174  ect.        _pat
-00026820: 6820 3d20 7365 6c66 2e5f 7061 7468 5f6f  h = self._path_o
-00026830: 6628 2264 6174 6173 746f 7265 2d70 726f  f("datastore-pro
-00026840: 6669 6c65 7322 2c20 7072 6f6a 6563 7429  files", project)
-00026850: 0a0a 2020 2020 2020 2020 7265 7320 3d20  ..        res = 
-00026860: 7365 6c66 2e61 7069 5f63 616c 6c28 6d65  self.api_call(me
-00026870: 7468 6f64 3d22 4745 5422 2c20 7061 7468  thod="GET", path
-00026880: 3d5f 7061 7468 290a 2020 2020 2020 2020  =_path).        
-00026890: 6966 2072 6573 3a0a 2020 2020 2020 2020  if res:.        
-000268a0: 2020 2020 7075 626c 6963 5f77 7261 7070      public_wrapp
-000268b0: 6572 203d 2072 6573 2e6a 736f 6e28 290a  er = res.json().
-000268c0: 2020 2020 2020 2020 2020 2020 6461 7461              data
-000268d0: 7374 6f72 6573 203d 205b 0a20 2020 2020  stores = [.     
-000268e0: 2020 2020 2020 2020 2020 2044 6174 6173             Datas
-000268f0: 746f 7265 5072 6f66 696c 6532 4a73 6f6e  toreProfile2Json
-00026900: 2e63 7265 6174 655f 6672 6f6d 5f6a 736f  .create_from_jso
-00026910: 6e28 785b 226f 626a 6563 7422 5d29 0a20  n(x["object"]). 
-00026920: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00026930: 6f72 2078 2069 6e20 7075 626c 6963 5f77  or x in public_w
-00026940: 7261 7070 6572 0a20 2020 2020 2020 2020  rapper.         
-00026950: 2020 205d 0a20 2020 2020 2020 2020 2020     ].           
-00026960: 2072 6574 7572 6e20 6461 7461 7374 6f72   return datastor
-00026970: 6573 0a20 2020 2020 2020 2072 6574 7572  es.        retur
-00026980: 6e20 4e6f 6e65 0a0a 2020 2020 6465 6620  n None..    def 
-00026990: 7374 6f72 655f 6461 7461 7374 6f72 655f  store_datastore_
-000269a0: 7072 6f66 696c 6528 0a20 2020 2020 2020  profile(.       
-000269b0: 2073 656c 662c 2070 726f 6669 6c65 3a20   self, profile: 
-000269c0: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
-000269d0: 656d 6173 2e44 6174 6173 746f 7265 5072  emas.DatastorePr
-000269e0: 6f66 696c 652c 2070 726f 6a65 6374 3a20  ofile, project: 
-000269f0: 7374 720a 2020 2020 293a 0a20 2020 2020  str.    ):.     
-00026a00: 2020 2022 2222 0a20 2020 2020 2020 2043     """.        C
-00026a10: 7265 6174 6520 6f72 2072 6570 6c61 6365  reate or replace
-00026a20: 2061 2064 6174 6173 746f 7265 2070 726f   a datastore pro
-00026a30: 6669 6c65 2e0a 2020 2020 2020 2020 3a72  file..        :r
-00026a40: 6574 7572 6e73 3a20 4e6f 6e65 0a20 2020  eturns: None.   
-00026a50: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00026a60: 2070 726f 6a65 6374 203d 2070 726f 6a65   project = proje
-00026a70: 6374 206f 7220 636f 6e66 6967 2e64 6566  ct or config.def
-00026a80: 6175 6c74 5f70 726f 6a65 6374 0a20 2020  ault_project.   
-00026a90: 2020 2020 205f 7061 7468 203d 2073 656c       _path = sel
-00026aa0: 662e 5f70 6174 685f 6f66 2822 6461 7461  f._path_of("data
-00026ab0: 7374 6f72 652d 7072 6f66 696c 6573 222c  store-profiles",
-00026ac0: 2070 726f 6a65 6374 290a 0a20 2020 2020   project)..     
-00026ad0: 2020 2073 656c 662e 6170 695f 6361 6c6c     self.api_call
-00026ae0: 286d 6574 686f 643d 2250 5554 222c 2070  (method="PUT", p
-00026af0: 6174 683d 5f70 6174 682c 206a 736f 6e3d  ath=_path, json=
-00026b00: 7072 6f66 696c 652e 6469 6374 2829 290a  profile.dict()).
-00026b10: 0a0a 6465 6620 5f61 735f 6a73 6f6e 286f  ..def _as_json(o
-00026b20: 626a 293a 0a20 2020 2066 6e20 3d20 6765  bj):.    fn = ge
-00026b30: 7461 7474 7228 6f62 6a2c 2022 746f 5f6a  tattr(obj, "to_j
-00026b40: 736f 6e22 2c20 4e6f 6e65 290a 2020 2020  son", None).    
-00026b50: 6966 2066 6e3a 0a20 2020 2020 2020 2072  if fn:.        r
-00026b60: 6574 7572 6e20 666e 2829 0a20 2020 2072  eturn fn().    r
-00026b70: 6574 7572 6e20 6469 6374 5f74 6f5f 6a73  eturn dict_to_js
-00026b80: 6f6e 286f 626a 290a                      on(obj).
+00020340: 2774 7664 5f6d 6561 6e27 3a20 302e 352c  'tvd_mean': 0.5,
+00020350: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00020360: 2020 2020 2020 2020 2020 2020 2020 2768                'h
+00020370: 656c 6c69 6e67 6572 5f73 756d 273a 2033  ellinger_sum': 3
+00020380: 2e36 2c0a 2020 2020 2020 2020 2020 2020  .6,.            
+00020390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000203a0: 2027 6865 6c6c 696e 6765 725f 6d65 616e   'hellinger_mean
+000203b0: 273a 2030 2e39 2c0a 2020 2020 2020 2020  ': 0.9,.        
+000203c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000203d0: 2020 2020 2027 6b6c 645f 7375 6d27 3a20       'kld_sum': 
+000203e0: 3234 2e32 2c0a 2020 2020 2020 2020 2020  24.2,.          
+000203f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020400: 2020 2027 6b6c 645f 6d65 616e 273a 2036     'kld_mean': 6
+00020410: 2e30 2c0a 2020 2020 2020 2020 2020 2020  .0,.            
+00020420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020430: 2027 6631 273a 207b 2774 7664 273a 2030   'f1': {'tvd': 0
+00020440: 2e35 2c20 2768 656c 6c69 6e67 6572 273a  .5, 'hellinger':
+00020450: 2031 2e30 2c20 276b 6c64 273a 2036 2e34   1.0, 'kld': 6.4
+00020460: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
+00020470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020480: 2766 3227 3a20 7b27 7476 6427 3a20 302e  'f2': {'tvd': 0.
+00020490: 352c 2027 6865 6c6c 696e 6765 7227 3a20  5, 'hellinger': 
+000204a0: 312e 302c 2027 6b6c 6427 3a20 362e 357d  1.0, 'kld': 6.5}
+000204b0: 7d0a 0a20 2020 2020 2020 2020 2020 2023  }..            #
+000204c0: 2043 7265 6174 6520 6174 7472 6962 7574   Create attribut
+000204d0: 6573 2064 6963 7469 6f6e 6172 7920 6163  es dictionary ac
+000204e0: 636f 7264 696e 6720 746f 2074 6865 2072  cording to the r
+000204f0: 6571 7569 7265 6420 666f 726d 6174 0a20  equired format. 
+00020500: 2020 2020 2020 2020 2020 2061 7474 7269             attri
+00020510: 6275 7465 7320 3d20 7b60 6375 7272 656e  butes = {`curren
+00020520: 745f 7374 6174 7360 3a20 6a73 6f6e 2e64  t_stats`: json.d
+00020530: 756d 7073 2863 7572 7265 6e74 5f73 7461  umps(current_sta
+00020540: 7473 292c 0a20 2020 2020 2020 2020 2020  ts),.           
+00020550: 2020 2020 2020 2020 2020 2020 2020 2060                 `
+00020560: 6472 6966 745f 7374 6174 7573 603a 2022  drift_status`: "
+00020570: 4452 4946 545f 4445 5445 4354 4544 227d  DRIFT_DETECTED"}
+00020580: 0a0a 2020 2020 2020 2020 2222 220a 0a20  ..        """.. 
+00020590: 2020 2020 2020 2061 7474 7269 6275 7465         attribute
+000205a0: 7320 3d20 7b22 6174 7472 6962 7574 6573  s = {"attributes
+000205b0: 223a 205f 6173 5f6a 736f 6e28 6174 7472  ": _as_json(attr
+000205c0: 6962 7574 6573 297d 0a20 2020 2020 2020  ibutes)}.       
+000205d0: 2070 6174 6820 3d20 6622 7072 6f6a 6563   path = f"projec
+000205e0: 7473 2f7b 7072 6f6a 6563 747d 2f6d 6f64  ts/{project}/mod
+000205f0: 656c 2d65 6e64 706f 696e 7473 2f7b 656e  el-endpoints/{en
+00020600: 6470 6f69 6e74 5f69 647d 220a 2020 2020  dpoint_id}".    
+00020610: 2020 2020 7365 6c66 2e61 7069 5f63 616c      self.api_cal
+00020620: 6c28 0a20 2020 2020 2020 2020 2020 206d  l(.            m
+00020630: 6574 686f 643d 2250 4154 4348 222c 0a20  ethod="PATCH",. 
+00020640: 2020 2020 2020 2020 2020 2070 6174 683d             path=
+00020650: 7061 7468 2c0a 2020 2020 2020 2020 2020  path,.          
+00020660: 2020 7061 7261 6d73 3d61 7474 7269 6275    params=attribu
+00020670: 7465 732c 0a20 2020 2020 2020 2029 0a0a  tes,.        )..
+00020680: 2020 2020 6465 6620 7570 6461 7465 5f6d      def update_m
+00020690: 6f64 656c 5f6d 6f6e 6974 6f72 696e 675f  odel_monitoring_
+000206a0: 636f 6e74 726f 6c6c 6572 280a 2020 2020  controller(.    
+000206b0: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+000206c0: 2020 7072 6f6a 6563 743a 2073 7472 2c0a    project: str,.
+000206d0: 2020 2020 2020 2020 6261 7365 5f70 6572          base_per
+000206e0: 696f 643a 2069 6e74 203d 2031 302c 0a20  iod: int = 10,. 
+000206f0: 2020 2020 2020 2069 6d61 6765 3a20 7374         image: st
+00020700: 7220 3d20 226d 6c72 756e 2f6d 6c72 756e  r = "mlrun/mlrun
+00020710: 222c 0a20 2020 2029 3a0a 2020 2020 2020  ",.    ):.      
+00020720: 2020 2222 220a 2020 2020 2020 2020 5265    """.        Re
+00020730: 6465 706c 6f79 206d 6f64 656c 206d 6f6e  deploy model mon
+00020740: 6974 6f72 696e 6720 6170 706c 6963 6174  itoring applicat
+00020750: 696f 6e20 636f 6e74 726f 6c6c 6572 2066  ion controller f
+00020760: 756e 6374 696f 6e2e 0a0a 2020 2020 2020  unction...      
+00020770: 2020 3a70 6172 616d 2070 726f 6a65 6374    :param project
+00020780: 3a20 2020 2020 2020 2020 2020 2020 2020  :               
+00020790: 2020 2050 726f 6a65 6374 206e 616d 652e     Project name.
+000207a0: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+000207b0: 6261 7365 5f70 6572 696f 643a 2020 2020  base_period:    
+000207c0: 2020 2020 2020 2020 2020 5468 6520 7469            The ti
+000207d0: 6d65 2070 6572 696f 6420 696e 206d 696e  me period in min
+000207e0: 7574 6573 2069 6e20 7768 6963 6820 7468  utes in which th
+000207f0: 6520 6d6f 6465 6c20 6d6f 6e69 746f 7269  e model monitori
+00020800: 6e67 2063 6f6e 7472 6f6c 6c65 7220 6675  ng controller fu
+00020810: 6e63 7469 6f6e 0a20 2020 2020 2020 2020  nction.         
+00020820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020840: 7472 6967 6765 7273 2e20 4279 2064 6566  triggers. By def
+00020850: 6175 6c74 2c20 7468 6520 6261 7365 2070  ault, the base p
+00020860: 6572 696f 6420 6973 2031 3020 6d69 6e75  eriod is 10 minu
+00020870: 7465 732e 0a20 2020 2020 2020 203a 7061  tes..        :pa
+00020880: 7261 6d20 696d 6167 653a 2054 6865 2069  ram image: The i
+00020890: 6d61 6765 206f 6620 7468 6520 6d6f 6465  mage of the mode
+000208a0: 6c20 6d6f 6e69 746f 7269 6e67 2063 6f6e  l monitoring con
+000208b0: 7472 6f6c 6c65 7220 6675 6e63 7469 6f6e  troller function
+000208c0: 2e0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000208d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000208e0: 2020 2020 2020 2020 2020 2042 7920 6465             By de
+000208f0: 6661 756c 742c 2074 6865 2069 6d61 6765  fault, the image
+00020900: 2069 7320 6d6c 7275 6e2f 6d6c 7275 6e2e   is mlrun/mlrun.
+00020910: 0a20 2020 2020 2020 2022 2222 0a0a 2020  .        """..  
+00020920: 2020 2020 2020 7061 7261 6d73 203d 207b        params = {
+00020930: 0a20 2020 2020 2020 2020 2020 2022 696d  .            "im
+00020940: 6167 6522 3a20 696d 6167 652c 0a20 2020  age": image,.   
+00020950: 2020 2020 2020 2020 2022 6261 7365 5f70           "base_p
+00020960: 6572 696f 6422 3a20 6261 7365 5f70 6572  eriod": base_per
+00020970: 696f 642c 0a20 2020 2020 2020 207d 0a20  iod,.        }. 
+00020980: 2020 2020 2020 2070 6174 6820 3d20 6622         path = f"
+00020990: 7072 6f6a 6563 7473 2f7b 7072 6f6a 6563  projects/{projec
+000209a0: 747d 2f6d 6f64 656c 2d6d 6f6e 6974 6f72  t}/model-monitor
+000209b0: 696e 672f 6d6f 6465 6c2d 6d6f 6e69 746f  ing/model-monito
+000209c0: 7269 6e67 2d63 6f6e 7472 6f6c 6c65 7222  ring-controller"
+000209d0: 0a20 2020 2020 2020 2073 656c 662e 6170  .        self.ap
+000209e0: 695f 6361 6c6c 286d 6574 686f 643d 2250  i_call(method="P
+000209f0: 4f53 5422 2c20 7061 7468 3d70 6174 682c  OST", path=path,
+00020a00: 2070 6172 616d 733d 7061 7261 6d73 290a   params=params).
+00020a10: 0a20 2020 2064 6566 2065 6e61 626c 655f  .    def enable_
+00020a20: 6d6f 6465 6c5f 6d6f 6e69 746f 7269 6e67  model_monitoring
+00020a30: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+00020a40: 2020 2020 2020 2020 7072 6f6a 6563 743a          project:
+00020a50: 2073 7472 2c0a 2020 2020 2020 2020 6261   str,.        ba
+00020a60: 7365 5f70 6572 696f 643a 2069 6e74 203d  se_period: int =
+00020a70: 2031 302c 0a20 2020 2020 2020 2069 6d61   10,.        ima
+00020a80: 6765 3a20 7374 7220 3d20 226d 6c72 756e  ge: str = "mlrun
+00020a90: 2f6d 6c72 756e 222c 0a20 2020 2020 2020  /mlrun",.       
+00020aa0: 2064 6570 6c6f 795f 6869 7374 6f67 7261   deploy_histogra
+00020ab0: 6d5f 6461 7461 5f64 7269 6674 5f61 7070  m_data_drift_app
+00020ac0: 3a20 626f 6f6c 203d 2054 7275 652c 0a20  : bool = True,. 
+00020ad0: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
+00020ae0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00020af0: 2020 4465 706c 6f79 206d 6f64 656c 206d    Deploy model m
+00020b00: 6f6e 6974 6f72 696e 6720 6170 706c 6963  onitoring applic
+00020b10: 6174 696f 6e20 636f 6e74 726f 6c6c 6572  ation controller
+00020b20: 2c20 7772 6974 6572 2061 6e64 2073 7472  , writer and str
+00020b30: 6561 6d20 6675 6e63 7469 6f6e 732e 0a20  eam functions.. 
+00020b40: 2020 2020 2020 2057 6869 6c65 2074 6865         While the
+00020b50: 206d 6169 6e20 676f 616c 206f 6620 7468   main goal of th
+00020b60: 6520 636f 6e74 726f 6c6c 6572 2066 756e  e controller fun
+00020b70: 6374 696f 6e20 6973 2074 6f20 6861 6e64  ction is to hand
+00020b80: 6c65 2074 6865 206d 6f6e 6974 6f72 696e  le the monitorin
+00020b90: 6720 7072 6f63 6573 7369 6e67 2061 6e64  g processing and
+00020ba0: 2074 7269 6767 6572 696e 670a 2020 2020   triggering.    
+00020bb0: 2020 2020 6170 706c 6963 6174 696f 6e73      applications
+00020bc0: 2c20 7468 6520 676f 616c 206f 6620 7468  , the goal of th
+00020bd0: 6520 6d6f 6465 6c20 6d6f 6e69 746f 7269  e model monitori
+00020be0: 6e67 2077 7269 7465 7220 6675 6e63 7469  ng writer functi
+00020bf0: 6f6e 2069 7320 746f 2077 7269 7465 2061  on is to write a
+00020c00: 6c6c 2074 6865 206d 6f6e 6974 6f72 696e  ll the monitorin
+00020c10: 670a 2020 2020 2020 2020 6170 706c 6963  g.        applic
+00020c20: 6174 696f 6e20 7265 7375 6c74 7320 746f  ation results to
+00020c30: 2074 6865 2064 6174 6162 6173 6573 2e0a   the databases..
+00020c40: 2020 2020 2020 2020 5468 6520 7374 7265          The stre
+00020c50: 616d 2066 756e 6374 696f 6e20 676f 616c  am function goal
+00020c60: 2069 7320 746f 206d 6f6e 6974 6f72 2074   is to monitor t
+00020c70: 6865 206c 6f67 206f 6620 7468 6520 6461  he log of the da
+00020c80: 7461 2073 7472 6561 6d2e 2049 7420 6973  ta stream. It is
+00020c90: 2074 7269 6767 6572 6564 2077 6865 6e20   triggered when 
+00020ca0: 6120 6e65 7720 6c6f 6720 656e 7472 790a  a new log entry.
+00020cb0: 2020 2020 2020 2020 6973 2064 6574 6563          is detec
+00020cc0: 7465 642e 2049 7420 7072 6f63 6573 7365  ted. It processe
+00020cd0: 7320 7468 6520 6e65 7720 6576 656e 7473  s the new events
+00020ce0: 2069 6e74 6f20 7374 6174 6973 7469 6373   into statistics
+00020cf0: 2074 6861 7420 6172 6520 7468 656e 2077   that are then w
+00020d00: 7269 7474 656e 2074 6f20 7374 6174 6973  ritten to statis
+00020d10: 7469 6373 2064 6174 6162 6173 6573 2e0a  tics databases..
+00020d20: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00020d30: 7072 6f6a 6563 743a 2020 2020 2050 726f  project:     Pro
+00020d40: 6a65 6374 206e 616d 652e 0a20 2020 2020  ject name..     
+00020d50: 2020 203a 7061 7261 6d20 6261 7365 5f70     :param base_p
+00020d60: 6572 696f 643a 2054 6865 2074 696d 6520  eriod: The time 
+00020d70: 7065 7269 6f64 2069 6e20 6d69 6e75 7465  period in minute
+00020d80: 7320 696e 2077 6869 6368 2074 6865 206d  s in which the m
+00020d90: 6f64 656c 206d 6f6e 6974 6f72 696e 6720  odel monitoring 
+00020da0: 636f 6e74 726f 6c6c 6572 2066 756e 6374  controller funct
+00020db0: 696f 6e0a 2020 2020 2020 2020 2020 2020  ion.            
+00020dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020dd0: 7472 6967 6765 7273 2e20 4279 2064 6566  triggers. By def
+00020de0: 6175 6c74 2c20 7468 6520 6261 7365 2070  ault, the base p
+00020df0: 6572 696f 6420 6973 2031 3020 6d69 6e75  eriod is 10 minu
+00020e00: 7465 732e 0a20 2020 2020 2020 203a 7061  tes..        :pa
+00020e10: 7261 6d20 696d 6167 653a 2020 2020 2020  ram image:      
+00020e20: 2054 6865 2069 6d61 6765 206f 6620 7468   The image of th
+00020e30: 6520 6d6f 6465 6c20 6d6f 6e69 746f 7269  e model monitori
+00020e40: 6e67 2063 6f6e 7472 6f6c 6c65 722c 2077  ng controller, w
+00020e50: 7269 7465 7220 2620 6d6f 6e69 746f 7269  riter & monitori
+00020e60: 6e67 0a20 2020 2020 2020 2020 2020 2020  ng.             
+00020e70: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00020e80: 7472 6561 6d20 6675 6e63 7469 6f6e 732c  tream functions,
+00020e90: 2077 6869 6368 2061 7265 2072 6561 6c20   which are real 
+00020ea0: 7469 6d65 206e 7563 6c69 6f20 6675 6e63  time nuclio func
+00020eb0: 7469 6f6e 732e 0a20 2020 2020 2020 2020  tions..         
+00020ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020ed0: 2020 2042 7920 6465 6661 756c 742c 2074     By default, t
+00020ee0: 6865 2069 6d61 6765 2069 7320 6d6c 7275  he image is mlru
+00020ef0: 6e2f 6d6c 7275 6e2e 0a20 2020 2020 2020  n/mlrun..       
+00020f00: 203a 7061 7261 6d20 6465 706c 6f79 5f68   :param deploy_h
+00020f10: 6973 746f 6772 616d 5f64 6174 615f 6472  istogram_data_dr
+00020f20: 6966 745f 6170 703a 2049 6620 7472 7565  ift_app: If true
+00020f30: 2c20 6465 706c 6f79 2074 6865 2064 6566  , deploy the def
+00020f40: 6175 6c74 2068 6973 746f 6772 616d 2d62  ault histogram-b
+00020f50: 6173 6564 2064 6174 6120 6472 6966 7420  ased data drift 
+00020f60: 6170 706c 6963 6174 696f 6e2e 0a20 2020  application..   
+00020f70: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00020f80: 2073 656c 662e 6170 695f 6361 6c6c 280a   self.api_call(.
+00020f90: 2020 2020 2020 2020 2020 2020 6d65 7468              meth
+00020fa0: 6f64 3d6d 6c72 756e 2e63 6f6d 6d6f 6e2e  od=mlrun.common.
+00020fb0: 7479 7065 732e 4854 5450 4d65 7468 6f64  types.HTTPMethod
+00020fc0: 2e50 4f53 542c 0a20 2020 2020 2020 2020  .POST,.         
+00020fd0: 2020 2070 6174 683d 6622 7072 6f6a 6563     path=f"projec
+00020fe0: 7473 2f7b 7072 6f6a 6563 747d 2f6d 6f64  ts/{project}/mod
+00020ff0: 656c 2d6d 6f6e 6974 6f72 696e 672f 656e  el-monitoring/en
+00021000: 6162 6c65 2d6d 6f64 656c 2d6d 6f6e 6974  able-model-monit
+00021010: 6f72 696e 6722 2c0a 2020 2020 2020 2020  oring",.        
+00021020: 2020 2020 7061 7261 6d73 3d7b 0a20 2020      params={.   
+00021030: 2020 2020 2020 2020 2020 2020 2022 6261               "ba
+00021040: 7365 5f70 6572 696f 6422 3a20 6261 7365  se_period": base
+00021050: 5f70 6572 696f 642c 0a20 2020 2020 2020  _period,.       
+00021060: 2020 2020 2020 2020 2022 696d 6167 6522           "image"
+00021070: 3a20 696d 6167 652c 0a20 2020 2020 2020  : image,.       
+00021080: 2020 2020 2020 2020 2022 6465 706c 6f79           "deploy
+00021090: 5f68 6973 746f 6772 616d 5f64 6174 615f  _histogram_data_
+000210a0: 6472 6966 745f 6170 7022 3a20 6465 706c  drift_app": depl
+000210b0: 6f79 5f68 6973 746f 6772 616d 5f64 6174  oy_histogram_dat
+000210c0: 615f 6472 6966 745f 6170 702c 0a20 2020  a_drift_app,.   
+000210d0: 2020 2020 2020 2020 207d 2c0a 2020 2020           },.    
+000210e0: 2020 2020 290a 0a20 2020 2064 6566 2064      )..    def d
+000210f0: 6570 6c6f 795f 6869 7374 6f67 7261 6d5f  eploy_histogram_
+00021100: 6461 7461 5f64 7269 6674 5f61 7070 280a  data_drift_app(.
+00021110: 2020 2020 2020 2020 7365 6c66 2c20 7072          self, pr
+00021120: 6f6a 6563 743a 2073 7472 2c20 696d 6167  oject: str, imag
+00021130: 653a 2073 7472 203d 2022 6d6c 7275 6e2f  e: str = "mlrun/
+00021140: 6d6c 7275 6e22 0a20 2020 2029 202d 3e20  mlrun".    ) -> 
+00021150: 4e6f 6e65 3a0a 2020 2020 2020 2020 2222  None:.        ""
+00021160: 220a 2020 2020 2020 2020 4465 706c 6f79  ".        Deploy
+00021170: 2074 6865 2068 6973 746f 6772 616d 2064   the histogram d
+00021180: 6174 6120 6472 6966 7420 6170 706c 6963  ata drift applic
+00021190: 6174 696f 6e2e 0a0a 2020 2020 2020 2020  ation...        
+000211a0: 3a70 6172 616d 2070 726f 6a65 6374 3a20  :param project: 
+000211b0: 5072 6f6a 6563 7420 6e61 6d65 2e0a 2020  Project name..  
+000211c0: 2020 2020 2020 3a70 6172 616d 2069 6d61        :param ima
+000211d0: 6765 3a20 2020 5468 6520 696d 6167 6520  ge:   The image 
+000211e0: 6f6e 2077 6869 6368 2074 6865 2061 7070  on which the app
+000211f0: 6c69 6361 7469 6f6e 2077 696c 6c20 7275  lication will ru
+00021200: 6e2e 0a20 2020 2020 2020 2022 2222 0a20  n..        """. 
+00021210: 2020 2020 2020 2073 656c 662e 6170 695f         self.api_
+00021220: 6361 6c6c 280a 2020 2020 2020 2020 2020  call(.          
+00021230: 2020 6d65 7468 6f64 3d6d 6c72 756e 2e63    method=mlrun.c
+00021240: 6f6d 6d6f 6e2e 7479 7065 732e 4854 5450  ommon.types.HTTP
+00021250: 4d65 7468 6f64 2e50 4f53 542c 0a20 2020  Method.POST,.   
+00021260: 2020 2020 2020 2020 2070 6174 683d 6622           path=f"
+00021270: 7072 6f6a 6563 7473 2f7b 7072 6f6a 6563  projects/{projec
+00021280: 747d 2f6d 6f64 656c 2d6d 6f6e 6974 6f72  t}/model-monitor
+00021290: 696e 672f 6465 706c 6f79 2d68 6973 746f  ing/deploy-histo
+000212a0: 6772 616d 2d64 6174 612d 6472 6966 742d  gram-data-drift-
+000212b0: 6170 7022 2c0a 2020 2020 2020 2020 2020  app",.          
+000212c0: 2020 7061 7261 6d73 3d7b 2269 6d61 6765    params={"image
+000212d0: 223a 2069 6d61 6765 7d2c 0a20 2020 2020  ": image},.     
+000212e0: 2020 2029 0a0a 2020 2020 6465 6620 6372     )..    def cr
+000212f0: 6561 7465 5f68 7562 5f73 6f75 7263 6528  eate_hub_source(
+00021300: 0a20 2020 2020 2020 2073 656c 662c 2073  .        self, s
+00021310: 6f75 7263 653a 2055 6e69 6f6e 5b64 6963  ource: Union[dic
+00021320: 742c 206d 6c72 756e 2e63 6f6d 6d6f 6e2e  t, mlrun.common.
+00021330: 7363 6865 6d61 732e 496e 6465 7865 6448  schemas.IndexedH
+00021340: 7562 536f 7572 6365 5d0a 2020 2020 293a  ubSource].    ):
+00021350: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00021360: 2020 2020 2041 6464 2061 206e 6577 2068       Add a new h
+00021370: 7562 2073 6f75 7263 652e 0a0a 2020 2020  ub source...    
+00021380: 2020 2020 4d4c 5275 6e20 6d61 696e 7461      MLRun mainta
+00021390: 696e 7320 616e 206f 7264 6572 6564 206c  ins an ordered l
+000213a0: 6973 7420 6f66 2068 7562 2073 6f75 7263  ist of hub sourc
+000213b0: 6573 2028 e280 9c73 6f75 7263 6573 e280  es (...sources..
+000213c0: 9d29 2045 6163 6820 736f 7572 6365 2068  .) Each source h
+000213d0: 6173 0a20 2020 2020 2020 2069 7473 2064  as.        its d
+000213e0: 6574 6169 6c73 2072 6567 6973 7465 7265  etails registere
+000213f0: 6420 616e 6420 6974 7320 6f72 6465 7220  d and its order 
+00021400: 7769 7468 696e 2074 6865 206c 6973 742e  within the list.
+00021410: 2057 6865 6e20 6372 6561 7469 6e67 2061   When creating a
+00021420: 206e 6577 2073 6f75 7263 652c 2074 6865   new source, the
+00021430: 2073 7065 6369 616c 206f 7264 6572 2060   special order `
+00021440: 602d 3160 600a 2020 2020 2020 2020 6361  `-1``.        ca
+00021450: 6e20 6265 2075 7365 6420 746f 206d 6172  n be used to mar
+00021460: 6b20 7468 6973 2073 6f75 7263 6520 6173  k this source as
+00021470: 206c 6173 7420 696e 2074 6865 206c 6973   last in the lis
+00021480: 742e 2048 6f77 6576 6572 2c20 6f6e 6365  t. However, once
+00021490: 2074 6865 2073 6f75 7263 6520 6973 2069   the source is i
+000214a0: 6e20 7468 6520 4d4c 5275 6e20 6c69 7374  n the MLRun list
+000214b0: 2c0a 2020 2020 2020 2020 6974 7320 6f72  ,.        its or
+000214c0: 6465 7220 7769 6c6c 2061 6c77 6179 7320  der will always 
+000214d0: 6265 2060 603e 3060 602e 0a0a 2020 2020  be ``>0``...    
+000214e0: 2020 2020 5468 6520 676c 6f62 616c 2068      The global h
+000214f0: 7562 2073 6f75 7263 6520 616c 7761 7973  ub source always
+00021500: 2065 7869 7374 7320 696e 2074 6865 206c   exists in the l
+00021510: 6973 742c 2061 6e64 2069 7320 616c 7761  ist, and is alwa
+00021520: 7973 2074 6865 206c 6173 7420 736f 7572  ys the last sour
+00021530: 6365 0a20 2020 2020 2020 2028 6060 6f72  ce.        (``or
+00021540: 6465 7220 3d20 2d31 6060 292e 2049 7420  der = -1``). It 
+00021550: 6361 6e6e 6f74 2062 6520 6d6f 6469 6669  cannot be modifi
+00021560: 6564 206e 6f72 2063 616e 2069 7420 6265  ed nor can it be
+00021570: 206d 6f76 6564 2074 6f20 616e 6f74 6865   moved to anothe
+00021580: 7220 6f72 6465 7220 696e 2074 6865 206c  r order in the l
+00021590: 6973 742e 0a0a 2020 2020 2020 2020 5468  ist...        Th
+000215a0: 6520 736f 7572 6365 206f 626a 6563 7420  e source object 
+000215b0: 6d61 7920 636f 6e74 6169 6e20 6372 6564  may contain cred
+000215c0: 656e 7469 616c 7320 7768 6963 6820 6172  entials which ar
+000215d0: 6520 6e65 6564 6564 2074 6f20 6163 6365  e needed to acce
+000215e0: 7373 2074 6865 2064 6174 6173 746f 7265  ss the datastore
+000215f0: 2077 6865 7265 2074 6865 2073 6f75 7263   where the sourc
+00021600: 6520 6973 2073 746f 7265 642e 0a20 2020  e is stored..   
+00021610: 2020 2020 2054 6865 7365 2063 7265 6465       These crede
+00021620: 6e74 6961 6c73 2061 7265 206e 6f74 206b  ntials are not k
+00021630: 6570 7420 696e 2074 6865 204d 4c52 756e  ept in the MLRun
+00021640: 2044 422c 2062 7574 2061 7265 2073 746f   DB, but are sto
+00021650: 7265 6420 696e 7369 6465 2061 206b 7562  red inside a kub
+00021660: 6572 6e65 7465 7320 7365 6372 6574 206f  ernetes secret o
+00021670: 626a 6563 7420 6d61 696e 7461 696e 6564  bject maintained
+00021680: 2062 790a 2020 2020 2020 2020 4d4c 5275   by.        MLRu
+00021690: 6e2e 2054 6865 7920 6172 6520 6e6f 7420  n. They are not 
+000216a0: 7265 7475 726e 6564 2074 6872 6f75 6768  returned through
+000216b0: 2061 6e79 2041 5049 2066 726f 6d20 4d4c   any API from ML
+000216c0: 5275 6e2e 0a0a 2020 2020 2020 2020 4578  Run...        Ex
+000216d0: 616d 706c 653a 3a0a 0a20 2020 2020 2020  ample::..       
+000216e0: 2020 2020 2069 6d70 6f72 7420 6d6c 7275       import mlru
+000216f0: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
+00021700: 0a0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+00021710: 4164 6420 6120 7072 6976 6174 6520 736f  Add a private so
+00021720: 7572 6365 2061 7320 7468 6520 6c61 7374  urce as the last
+00021730: 206f 6e65 2028 7769 6c6c 2062 6520 2331   one (will be #1
+00021740: 2069 6e20 7468 6520 6c69 7374 290a 2020   in the list).  
+00021750: 2020 2020 2020 2020 2020 7072 6976 6174            privat
+00021760: 655f 736f 7572 6365 203d 206d 6c72 756e  e_source = mlrun
+00021770: 2e63 6f6d 6d6f 6e2e 7363 6865 6d61 732e  .common.schemas.
+00021780: 496e 6465 7865 6448 7562 536f 7572 6365  IndexedHubSource
+00021790: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+000217a0: 2020 6f72 6465 723d 2d31 2c0a 2020 2020    order=-1,.    
+000217b0: 2020 2020 2020 2020 2020 2020 736f 7572              sour
+000217c0: 6365 3d6d 6c72 756e 2e63 6f6d 6d6f 6e2e  ce=mlrun.common.
+000217d0: 7363 6865 6d61 732e 4875 6253 6f75 7263  schemas.HubSourc
+000217e0: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
+000217f0: 2020 2020 2020 206d 6574 6164 6174 613d         metadata=
+00021800: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+00021810: 656d 6173 2e48 7562 4f62 6a65 6374 4d65  emas.HubObjectMe
+00021820: 7461 6461 7461 280a 2020 2020 2020 2020  tadata(.        
+00021830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021840: 6e61 6d65 3d22 7072 6976 222c 2064 6573  name="priv", des
+00021850: 6372 6970 7469 6f6e 3d22 6120 7072 6976  cription="a priv
+00021860: 6174 6520 736f 7572 6365 220a 2020 2020  ate source".    
+00021870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021880: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+00021890: 2020 2020 2020 2073 7065 633d 6d6c 7275         spec=mlru
+000218a0: 6e2e 636f 6d6d 6f6e 2e73 6368 656d 6173  n.common.schemas
+000218b0: 2e48 7562 536f 7572 6365 5370 6563 2870  .HubSourceSpec(p
+000218c0: 6174 683d 222f 6c6f 6361 6c2f 7061 7468  ath="/local/path
+000218d0: 2f74 6f2f 736f 7572 6365 222c 2063 6861  /to/source", cha
+000218e0: 6e6e 656c 3d22 6465 7665 6c6f 706d 656e  nnel="developmen
+000218f0: 7422 290a 2020 2020 2020 2020 2020 2020  t").            
+00021900: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+00021910: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00021920: 6462 2e63 7265 6174 655f 6875 625f 736f  db.create_hub_so
+00021930: 7572 6365 2870 7269 7661 7465 5f73 6f75  urce(private_sou
+00021940: 7263 6529 0a0a 2020 2020 2020 2020 2020  rce)..          
+00021950: 2020 2320 4164 6420 616e 6f74 6865 7220    # Add another 
+00021960: 736f 7572 6365 2061 7320 3173 7420 696e  source as 1st in
+00021970: 2074 6865 206c 6973 7420 2d20 7769 6c6c   the list - will
+00021980: 2070 7573 6820 7072 6576 696f 7573 206f   push previous o
+00021990: 6e65 2074 6f20 6265 2023 320a 2020 2020  ne to be #2.    
+000219a0: 2020 2020 2020 2020 616e 6f74 6865 725f          another_
+000219b0: 736f 7572 6365 203d 206d 6c72 756e 2e63  source = mlrun.c
+000219c0: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 496e  ommon.schemas.In
+000219d0: 6465 7865 6448 7562 536f 7572 6365 280a  dexedHubSource(.
+000219e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000219f0: 6f72 6465 723d 312c 0a20 2020 2020 2020  order=1,.       
+00021a00: 2020 2020 2020 2020 2073 6f75 7263 653d           source=
+00021a10: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+00021a20: 656d 6173 2e48 7562 536f 7572 6365 280a  emas.HubSource(.
+00021a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021a40: 2020 2020 6d65 7461 6461 7461 3d6d 6c72      metadata=mlr
+00021a50: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+00021a60: 732e 4875 624f 626a 6563 744d 6574 6164  s.HubObjectMetad
+00021a70: 6174 6128 0a20 2020 2020 2020 2020 2020  ata(.           
+00021a80: 2020 2020 2020 2020 2020 2020 206e 616d               nam
+00021a90: 653d 2270 7269 762d 3222 2c20 6465 7363  e="priv-2", desc
+00021aa0: 7269 7074 696f 6e3d 2261 6e6f 7468 6572  ription="another
+00021ab0: 2073 6f75 7263 6522 0a20 2020 2020 2020   source".       
+00021ac0: 2020 2020 2020 2020 2020 2020 2029 2c0a               ),.
+00021ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021ae0: 2020 2020 7370 6563 3d6d 6c72 756e 2e63      spec=mlrun.c
+00021af0: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 4875  ommon.schemas.Hu
+00021b00: 6253 6f75 7263 6553 7065 6328 0a20 2020  bSourceSpec(.   
+00021b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021b20: 2020 2020 2070 6174 683d 222f 6c6f 6361       path="/loca
+00021b30: 6c2f 7061 7468 2f74 6f2f 736f 7572 6365  l/path/to/source
+00021b40: 2f32 222c 0a20 2020 2020 2020 2020 2020  /2",.           
+00021b50: 2020 2020 2020 2020 2020 2020 2063 6861               cha
+00021b60: 6e6e 656c 3d22 6465 7665 6c6f 706d 656e  nnel="developmen
+00021b70: 7422 2c0a 2020 2020 2020 2020 2020 2020  t",.            
+00021b80: 2020 2020 2020 2020 2020 2020 6372 6564              cred
+00021b90: 656e 7469 616c 733d 7b2e 2e2e 7d0a 2020  entials={...}.  
+00021ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021bb0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00021bc0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+00021bd0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00021be0: 6462 2e63 7265 6174 655f 6875 625f 736f  db.create_hub_so
+00021bf0: 7572 6365 2861 6e6f 7468 6572 5f73 6f75  urce(another_sou
+00021c00: 7263 6529 0a0a 2020 2020 2020 2020 3a70  rce)..        :p
+00021c10: 6172 616d 2073 6f75 7263 653a 2054 6865  aram source: The
+00021c20: 2073 6f75 7263 6520 616e 6420 6974 7320   source and its 
+00021c30: 6f72 6465 722c 206f 6620 7479 7065 0a20  order, of type. 
+00021c40: 2020 2020 2020 2020 2020 203a 7079 3a63             :py:c
+00021c50: 6c61 7373 3a60 7e6d 6c72 756e 2e63 6f6d  lass:`~mlrun.com
+00021c60: 6d6f 6e2e 7363 6865 6d61 732e 6875 622e  mon.schemas.hub.
+00021c70: 496e 6465 7865 6448 7562 536f 7572 6365  IndexedHubSource
+00021c80: 602c 206f 7220 696e 2064 6963 7469 6f6e  `, or in diction
+00021c90: 6172 7920 666f 726d 2e0a 2020 2020 2020  ary form..      
+00021ca0: 2020 3a72 6574 7572 6e73 3a20 5468 6520    :returns: The 
+00021cb0: 736f 7572 6365 206f 626a 6563 7420 6173  source object as
+00021cc0: 2069 6e73 6572 7465 6420 696e 746f 2074   inserted into t
+00021cd0: 6865 2064 6174 6162 6173 652c 2077 6974  he database, wit
+00021ce0: 6820 6372 6564 656e 7469 616c 7320 7374  h credentials st
+00021cf0: 7269 7070 6564 2e0a 2020 2020 2020 2020  ripped..        
+00021d00: 2222 220a 2020 2020 2020 2020 7061 7468  """.        path
+00021d10: 203d 2022 6875 622f 736f 7572 6365 7322   = "hub/sources"
+00021d20: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
+00021d30: 7374 616e 6365 2873 6f75 7263 652c 206d  stance(source, m
+00021d40: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
+00021d50: 6d61 732e 496e 6465 7865 6448 7562 536f  mas.IndexedHubSo
+00021d60: 7572 6365 293a 0a20 2020 2020 2020 2020  urce):.         
+00021d70: 2020 2073 6f75 7263 6520 3d20 736f 7572     source = sour
+00021d80: 6365 2e64 6963 7428 290a 2020 2020 2020  ce.dict().      
+00021d90: 2020 7265 7370 6f6e 7365 203d 2073 656c    response = sel
+00021da0: 662e 6170 695f 6361 6c6c 286d 6574 686f  f.api_call(metho
+00021db0: 643d 2250 4f53 5422 2c20 7061 7468 3d70  d="POST", path=p
+00021dc0: 6174 682c 206a 736f 6e3d 736f 7572 6365  ath, json=source
+00021dd0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+00021de0: 206d 6c72 756e 2e63 6f6d 6d6f 6e2e 7363   mlrun.common.sc
+00021df0: 6865 6d61 732e 496e 6465 7865 6448 7562  hemas.IndexedHub
+00021e00: 536f 7572 6365 282a 2a72 6573 706f 6e73  Source(**respons
+00021e10: 652e 6a73 6f6e 2829 290a 0a20 2020 2064  e.json())..    d
+00021e20: 6566 2073 746f 7265 5f68 7562 5f73 6f75  ef store_hub_sou
+00021e30: 7263 6528 0a20 2020 2020 2020 2073 656c  rce(.        sel
+00021e40: 662c 0a20 2020 2020 2020 2073 6f75 7263  f,.        sourc
+00021e50: 655f 6e61 6d65 3a20 7374 722c 0a20 2020  e_name: str,.   
+00021e60: 2020 2020 2073 6f75 7263 653a 2055 6e69       source: Uni
+00021e70: 6f6e 5b64 6963 742c 206d 6c72 756e 2e63  on[dict, mlrun.c
+00021e80: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 496e  ommon.schemas.In
+00021e90: 6465 7865 6448 7562 536f 7572 6365 5d2c  dexedHubSource],
+00021ea0: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
+00021eb0: 2222 220a 2020 2020 2020 2020 4372 6561  """.        Crea
+00021ec0: 7465 206f 7220 7265 706c 6163 6520 6120  te or replace a 
+00021ed0: 6875 6220 736f 7572 6365 2e0a 2020 2020  hub source..    
+00021ee0: 2020 2020 466f 7220 616e 2065 7861 6d70      For an examp
+00021ef0: 6c65 206f 6620 7468 6520 736f 7572 6365  le of the source
+00021f00: 2066 6f72 6d61 7420 616e 6420 6578 706c   format and expl
+00021f10: 616e 6174 696f 6e20 6f66 2074 6865 2073  anation of the s
+00021f20: 6f75 7263 6520 6f72 6465 7220 6c6f 6769  ource order logi
+00021f30: 632c 0a20 2020 2020 2020 2070 6c65 6173  c,.        pleas
+00021f40: 6520 7365 6520 3a70 793a 6675 6e63 3a60  e see :py:func:`
+00021f50: 7e63 7265 6174 655f 6875 625f 736f 7572  ~create_hub_sour
+00021f60: 6365 602e 2054 6869 7320 6d65 7468 6f64  ce`. This method
+00021f70: 2063 616e 2062 6520 7573 6564 2074 6f20   can be used to 
+00021f80: 6d6f 6469 6679 2074 6865 2073 6f75 7263  modify the sourc
+00021f90: 6520 6974 7365 6c66 206f 7220 6974 730a  e itself or its.
+00021fa0: 2020 2020 2020 2020 6f72 6465 7220 696e          order in
+00021fb0: 2074 6865 206c 6973 7420 6f66 2073 6f75   the list of sou
+00021fc0: 7263 6573 2e0a 0a20 2020 2020 2020 203a  rces...        :
+00021fd0: 7061 7261 6d20 736f 7572 6365 5f6e 616d  param source_nam
+00021fe0: 653a 204e 616d 6520 6f66 2074 6865 2073  e: Name of the s
+00021ff0: 6f75 7263 6520 6f62 6a65 6374 2074 6f20  ource object to 
+00022000: 6d6f 6469 6679 2f63 7265 6174 652e 2049  modify/create. I
+00022010: 7420 6d75 7374 206d 6174 6368 2074 6865  t must match the
+00022020: 2060 6073 6f75 7263 652e 6d65 7461 6461   ``source.metada
+00022030: 7461 2e6e 616d 6560 600a 2020 2020 2020  ta.name``.      
+00022040: 2020 2020 2020 7061 7261 6d65 7465 7220        parameter 
+00022050: 696e 2074 6865 2073 6f75 7263 6520 6974  in the source it
+00022060: 7365 6c66 2e0a 2020 2020 2020 2020 3a70  self..        :p
+00022070: 6172 616d 2073 6f75 7263 653a 2053 6f75  aram source: Sou
+00022080: 7263 6520 6f62 6a65 6374 2074 6f20 7374  rce object to st
+00022090: 6f72 6520 696e 2074 6865 2064 6174 6162  ore in the datab
+000220a0: 6173 652e 0a20 2020 2020 2020 203a 7265  ase..        :re
+000220b0: 7475 726e 733a 2054 6865 2073 6f75 7263  turns: The sourc
+000220c0: 6520 6f62 6a65 6374 2061 7320 7374 6f72  e object as stor
+000220d0: 6564 2069 6e20 7468 6520 4442 2e0a 2020  ed in the DB..  
+000220e0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+000220f0: 2020 7061 7468 203d 2066 2268 7562 2f73    path = f"hub/s
+00022100: 6f75 7263 6573 2f7b 736f 7572 6365 5f6e  ources/{source_n
+00022110: 616d 657d 220a 2020 2020 2020 2020 6966  ame}".        if
+00022120: 2069 7369 6e73 7461 6e63 6528 736f 7572   isinstance(sour
+00022130: 6365 2c20 6d6c 7275 6e2e 636f 6d6d 6f6e  ce, mlrun.common
+00022140: 2e73 6368 656d 6173 2e49 6e64 6578 6564  .schemas.Indexed
+00022150: 4875 6253 6f75 7263 6529 3a0a 2020 2020  HubSource):.    
+00022160: 2020 2020 2020 2020 736f 7572 6365 203d          source =
+00022170: 2073 6f75 7263 652e 6469 6374 2829 0a0a   source.dict()..
+00022180: 2020 2020 2020 2020 7265 7370 6f6e 7365          response
+00022190: 203d 2073 656c 662e 6170 695f 6361 6c6c   = self.api_call
+000221a0: 286d 6574 686f 643d 2250 5554 222c 2070  (method="PUT", p
+000221b0: 6174 683d 7061 7468 2c20 6a73 6f6e 3d73  ath=path, json=s
+000221c0: 6f75 7263 6529 0a20 2020 2020 2020 2072  ource).        r
+000221d0: 6574 7572 6e20 6d6c 7275 6e2e 636f 6d6d  eturn mlrun.comm
+000221e0: 6f6e 2e73 6368 656d 6173 2e49 6e64 6578  on.schemas.Index
+000221f0: 6564 4875 6253 6f75 7263 6528 2a2a 7265  edHubSource(**re
+00022200: 7370 6f6e 7365 2e6a 736f 6e28 2929 0a0a  sponse.json())..
+00022210: 2020 2020 6465 6620 6c69 7374 5f68 7562      def list_hub
+00022220: 5f73 6f75 7263 6573 280a 2020 2020 2020  _sources(.      
+00022230: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+00022240: 6974 656d 5f6e 616d 653a 204f 7074 696f  item_name: Optio
+00022250: 6e61 6c5b 7374 725d 203d 204e 6f6e 652c  nal[str] = None,
+00022260: 0a20 2020 2020 2020 2074 6167 3a20 4f70  .        tag: Op
+00022270: 7469 6f6e 616c 5b73 7472 5d20 3d20 4e6f  tional[str] = No
+00022280: 6e65 2c0a 2020 2020 2020 2020 7665 7273  ne,.        vers
+00022290: 696f 6e3a 204f 7074 696f 6e61 6c5b 7374  ion: Optional[st
+000222a0: 725d 203d 204e 6f6e 652c 0a20 2020 2029  r] = None,.    )
+000222b0: 202d 3e20 6c69 7374 5b6d 6c72 756e 2e63   -> list[mlrun.c
+000222c0: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 6875  ommon.schemas.hu
+000222d0: 622e 496e 6465 7865 6448 7562 536f 7572  b.IndexedHubSour
+000222e0: 6365 5d3a 0a20 2020 2020 2020 2022 2222  ce]:.        """
+000222f0: 0a20 2020 2020 2020 204c 6973 7420 6875  .        List hu
+00022300: 6220 736f 7572 6365 7320 696e 2074 6865  b sources in the
+00022310: 204d 4c52 756e 2044 422e 0a0a 2020 2020   MLRun DB...    
+00022320: 2020 2020 3a70 6172 616d 2069 7465 6d5f      :param item_
+00022330: 6e61 6d65 3a20 2020 536f 7572 6365 7320  name:   Sources 
+00022340: 636f 6e74 6169 6e20 7468 6973 2069 7465  contain this ite
+00022350: 6d20 7769 6c6c 2062 6520 7265 7475 726e  m will be return
+00022360: 6564 2c20 4966 206e 6f74 2070 726f 7669  ed, If not provi
+00022370: 6465 6420 616c 6c20 736f 7572 6365 7320  ded all sources 
+00022380: 7769 6c6c 2062 6520 7265 7475 726e 6564  will be returned
+00022390: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+000223a0: 2074 6167 3a20 2020 2020 2020 2020 4974   tag:         It
+000223b0: 656d 2074 6167 2074 6f20 6669 6c74 6572  em tag to filter
+000223c0: 2062 792c 2073 7570 706f 7274 6564 206f   by, supported o
+000223d0: 6e6c 7920 6966 2069 7465 6d20 6e61 6d65  nly if item name
+000223e0: 2069 7320 7072 6f76 6964 6564 2e0a 2020   is provided..  
+000223f0: 2020 2020 2020 3a70 6172 616d 2076 6572        :param ver
+00022400: 7369 6f6e 3a20 2020 2020 4974 656d 2076  sion:     Item v
+00022410: 6572 7369 6f6e 2074 6f20 6669 6c74 6572  ersion to filter
+00022420: 2062 792c 2073 7570 706f 7274 6564 206f   by, supported o
+00022430: 6e6c 7920 6966 2069 7465 6d20 6e61 6d65  nly if item name
+00022440: 2069 7320 7072 6f76 6964 6564 2061 6e64   is provided and
+00022450: 2074 6167 2069 7320 6e6f 742e 0a0a 2020   tag is not...  
+00022460: 2020 2020 2020 3a72 6574 7572 6e73 3a20        :returns: 
+00022470: 4c69 7374 206f 6620 696e 6465 7865 6420  List of indexed 
+00022480: 6875 6220 736f 7572 6365 732e 0a20 2020  hub sources..   
+00022490: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+000224a0: 2070 6174 6820 3d20 2268 7562 2f73 6f75   path = "hub/sou
+000224b0: 7263 6573 220a 2020 2020 2020 2020 7061  rces".        pa
+000224c0: 7261 6d73 203d 207b 7d0a 2020 2020 2020  rams = {}.      
+000224d0: 2020 6966 2069 7465 6d5f 6e61 6d65 3a0a    if item_name:.
+000224e0: 2020 2020 2020 2020 2020 2020 7061 7261              para
+000224f0: 6d73 5b22 6974 656d 2d6e 616d 6522 5d20  ms["item-name"] 
+00022500: 3d20 6e6f 726d 616c 697a 655f 6e61 6d65  = normalize_name
+00022510: 2869 7465 6d5f 6e61 6d65 290a 2020 2020  (item_name).    
+00022520: 2020 2020 6966 2074 6167 3a0a 2020 2020      if tag:.    
+00022530: 2020 2020 2020 2020 7061 7261 6d73 5b22          params["
+00022540: 7461 6722 5d20 3d20 7461 670a 2020 2020  tag"] = tag.    
+00022550: 2020 2020 6966 2076 6572 7369 6f6e 3a0a      if version:.
+00022560: 2020 2020 2020 2020 2020 2020 7061 7261              para
+00022570: 6d73 5b22 7665 7273 696f 6e22 5d20 3d20  ms["version"] = 
+00022580: 7665 7273 696f 6e0a 2020 2020 2020 2020  version.        
+00022590: 7265 7370 6f6e 7365 203d 2073 656c 662e  response = self.
+000225a0: 6170 695f 6361 6c6c 286d 6574 686f 643d  api_call(method=
+000225b0: 2247 4554 222c 2070 6174 683d 7061 7468  "GET", path=path
+000225c0: 2c20 7061 7261 6d73 3d70 6172 616d 7329  , params=params)
+000225d0: 2e6a 736f 6e28 290a 2020 2020 2020 2020  .json().        
+000225e0: 7265 7375 6c74 7320 3d20 5b5d 0a20 2020  results = [].   
+000225f0: 2020 2020 2066 6f72 2069 7465 6d20 696e       for item in
+00022600: 2072 6573 706f 6e73 653a 0a20 2020 2020   response:.     
+00022610: 2020 2020 2020 2072 6573 756c 7473 2e61         results.a
+00022620: 7070 656e 6428 6d6c 7275 6e2e 636f 6d6d  ppend(mlrun.comm
+00022630: 6f6e 2e73 6368 656d 6173 2e49 6e64 6578  on.schemas.Index
+00022640: 6564 4875 6253 6f75 7263 6528 2a2a 6974  edHubSource(**it
+00022650: 656d 2929 0a20 2020 2020 2020 2072 6574  em)).        ret
+00022660: 7572 6e20 7265 7375 6c74 730a 0a20 2020  urn results..   
+00022670: 2064 6566 2067 6574 5f68 7562 5f73 6f75   def get_hub_sou
+00022680: 7263 6528 7365 6c66 2c20 736f 7572 6365  rce(self, source
+00022690: 5f6e 616d 653a 2073 7472 293a 0a20 2020  _name: str):.   
+000226a0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+000226b0: 2052 6574 7269 6576 6520 6120 6875 6220   Retrieve a hub 
+000226c0: 736f 7572 6365 2066 726f 6d20 7468 6520  source from the 
+000226d0: 4442 2e0a 0a20 2020 2020 2020 203a 7061  DB...        :pa
+000226e0: 7261 6d20 736f 7572 6365 5f6e 616d 653a  ram source_name:
+000226f0: 204e 616d 6520 6f66 2074 6865 2068 7562   Name of the hub
+00022700: 2073 6f75 7263 6520 746f 2072 6574 7269   source to retri
+00022710: 6576 652e 0a20 2020 2020 2020 2022 2222  eve..        """
+00022720: 0a20 2020 2020 2020 2070 6174 6820 3d20  .        path = 
+00022730: 6622 6875 622f 736f 7572 6365 732f 7b73  f"hub/sources/{s
+00022740: 6f75 7263 655f 6e61 6d65 7d22 0a20 2020  ource_name}".   
+00022750: 2020 2020 2072 6573 706f 6e73 6520 3d20       response = 
+00022760: 7365 6c66 2e61 7069 5f63 616c 6c28 6d65  self.api_call(me
+00022770: 7468 6f64 3d22 4745 5422 2c20 7061 7468  thod="GET", path
+00022780: 3d70 6174 6829 0a20 2020 2020 2020 2072  =path).        r
+00022790: 6574 7572 6e20 6d6c 7275 6e2e 636f 6d6d  eturn mlrun.comm
+000227a0: 6f6e 2e73 6368 656d 6173 2e49 6e64 6578  on.schemas.Index
+000227b0: 6564 4875 6253 6f75 7263 6528 2a2a 7265  edHubSource(**re
+000227c0: 7370 6f6e 7365 2e6a 736f 6e28 2929 0a0a  sponse.json())..
+000227d0: 2020 2020 6465 6620 6465 6c65 7465 5f68      def delete_h
+000227e0: 7562 5f73 6f75 7263 6528 7365 6c66 2c20  ub_source(self, 
+000227f0: 736f 7572 6365 5f6e 616d 653a 2073 7472  source_name: str
+00022800: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+00022810: 2020 2020 2020 2044 656c 6574 6520 6120         Delete a 
+00022820: 6875 6220 736f 7572 6365 2066 726f 6d20  hub source from 
+00022830: 7468 6520 4442 2e0a 2020 2020 2020 2020  the DB..        
+00022840: 5468 6520 736f 7572 6365 2077 696c 6c20  The source will 
+00022850: 6265 2064 656c 6574 6564 2066 726f 6d20  be deleted from 
+00022860: 7468 6520 6c69 7374 2c20 616e 6420 616e  the list, and an
+00022870: 7920 666f 6c6c 6f77 696e 6720 736f 7572  y following sour
+00022880: 6365 7320 7769 6c6c 2062 6520 7072 6f6d  ces will be prom
+00022890: 6f74 6564 202d 2066 6f72 2065 7861 6d70  oted - for examp
+000228a0: 6c65 2c20 6966 2074 6865 0a20 2020 2020  le, if the.     
+000228b0: 2020 2031 7374 2073 6f75 7263 6520 6973     1st source is
+000228c0: 2064 656c 6574 6564 2c20 7468 6520 326e   deleted, the 2n
+000228d0: 6420 736f 7572 6365 2077 696c 6c20 6265  d source will be
+000228e0: 636f 6d65 2023 3120 696e 2074 6865 206c  come #1 in the l
+000228f0: 6973 742e 0a20 2020 2020 2020 2054 6865  ist..        The
+00022900: 2067 6c6f 6261 6c20 6875 6220 736f 7572   global hub sour
+00022910: 6365 2063 616e 6e6f 7420 6265 2064 656c  ce cannot be del
+00022920: 6574 6564 2e0a 0a20 2020 2020 2020 203a  eted...        :
+00022930: 7061 7261 6d20 736f 7572 6365 5f6e 616d  param source_nam
+00022940: 653a 204e 616d 6520 6f66 2074 6865 2068  e: Name of the h
+00022950: 7562 2073 6f75 7263 6520 746f 2064 656c  ub source to del
+00022960: 6574 652e 0a20 2020 2020 2020 2022 2222  ete..        """
+00022970: 0a20 2020 2020 2020 2070 6174 6820 3d20  .        path = 
+00022980: 6622 6875 622f 736f 7572 6365 732f 7b73  f"hub/sources/{s
+00022990: 6f75 7263 655f 6e61 6d65 7d22 0a20 2020  ource_name}".   
+000229a0: 2020 2020 2073 656c 662e 6170 695f 6361       self.api_ca
+000229b0: 6c6c 286d 6574 686f 643d 2244 454c 4554  ll(method="DELET
+000229c0: 4522 2c20 7061 7468 3d70 6174 6829 0a0a  E", path=path)..
+000229d0: 2020 2020 6465 6620 6765 745f 6875 625f      def get_hub_
+000229e0: 6361 7461 6c6f 6728 0a20 2020 2020 2020  catalog(.       
+000229f0: 2073 656c 662c 0a20 2020 2020 2020 2073   self,.        s
+00022a00: 6f75 7263 655f 6e61 6d65 3a20 7374 722c  ource_name: str,
+00022a10: 0a20 2020 2020 2020 2076 6572 7369 6f6e  .        version
+00022a20: 3a20 7374 7220 3d20 4e6f 6e65 2c0a 2020  : str = None,.  
+00022a30: 2020 2020 2020 7461 673a 2073 7472 203d        tag: str =
+00022a40: 204e 6f6e 652c 0a20 2020 2020 2020 2066   None,.        f
+00022a50: 6f72 6365 5f72 6566 7265 7368 3a20 626f  orce_refresh: bo
+00022a60: 6f6c 203d 2046 616c 7365 2c0a 2020 2020  ol = False,.    
+00022a70: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+00022a80: 2020 2020 2020 2052 6574 7269 6576 6520         Retrieve 
+00022a90: 7468 6520 6974 656d 2063 6174 616c 6f67  the item catalog
+00022aa0: 2066 6f72 2061 2073 7065 6369 6669 6564   for a specified
+00022ab0: 2068 7562 2073 6f75 7263 652e 0a20 2020   hub source..   
+00022ac0: 2020 2020 2054 6865 206c 6973 7420 6f66       The list of
+00022ad0: 2069 7465 6d73 2063 616e 2062 6520 6669   items can be fi
+00022ae0: 6c74 6572 6564 2061 6363 6f72 6469 6e67  ltered according
+00022af0: 2074 6f20 7661 7269 6f75 7320 6669 6c74   to various filt
+00022b00: 6572 732c 2075 7369 6e67 2069 7465 6d27  ers, using item'
+00022b10: 7320 6d65 7461 6461 7461 2074 6f20 6669  s metadata to fi
+00022b20: 6c74 6572 2e0a 0a20 2020 2020 2020 203a  lter...        :
+00022b30: 7061 7261 6d20 736f 7572 6365 5f6e 616d  param source_nam
+00022b40: 653a 204e 616d 6520 6f66 2074 6865 2073  e: Name of the s
+00022b50: 6f75 7263 652e 0a20 2020 2020 2020 203a  ource..        :
+00022b60: 7061 7261 6d20 7665 7273 696f 6e3a 2046  param version: F
+00022b70: 696c 7465 7220 6974 656d 7320 6163 636f  ilter items acco
+00022b80: 7264 696e 6720 746f 2074 6865 6972 2076  rding to their v
+00022b90: 6572 7369 6f6e 2e0a 2020 2020 2020 2020  ersion..        
+00022ba0: 3a70 6172 616d 2074 6167 3a20 4669 6c74  :param tag: Filt
+00022bb0: 6572 2069 7465 6d73 2062 6173 6564 206f  er items based o
+00022bc0: 6e20 7461 672e 0a20 2020 2020 2020 203a  n tag..        :
+00022bd0: 7061 7261 6d20 666f 7263 655f 7265 6672  param force_refr
+00022be0: 6573 683a 204d 616b 6520 7468 6520 7365  esh: Make the se
+00022bf0: 7276 6572 2066 6574 6368 2074 6865 2063  rver fetch the c
+00022c00: 6174 616c 6f67 2066 726f 6d20 7468 6520  atalog from the 
+00022c10: 6163 7475 616c 2068 7562 2073 6f75 7263  actual hub sourc
+00022c20: 652c 0a20 2020 2020 2020 2020 2020 2072  e,.            r
+00022c30: 6174 6865 7220 7468 616e 2072 656c 7920  ather than rely 
+00022c40: 6f6e 2063 6163 6865 6420 696e 666f 726d  on cached inform
+00022c50: 6174 696f 6e20 7768 6963 6820 6d61 7920  ation which may 
+00022c60: 6578 6973 7420 6672 6f6d 2070 7265 7669  exist from previ
+00022c70: 6f75 7320 6765 7420 7265 7175 6573 7473  ous get requests
+00022c80: 2e20 466f 7220 6578 616d 706c 652c 0a20  . For example,. 
+00022c90: 2020 2020 2020 2020 2020 2069 6620 7468             if th
+00022ca0: 6520 736f 7572 6365 2077 6173 2072 652d  e source was re-
+00022cb0: 6275 696c 742c 0a20 2020 2020 2020 2020  built,.         
+00022cc0: 2020 2074 6869 7320 7769 6c6c 206d 616b     this will mak
+00022cd0: 6520 7468 6520 7365 7276 6572 2067 6574  e the server get
+00022ce0: 2074 6865 2075 7064 6174 6564 2069 6e66   the updated inf
+00022cf0: 6f72 6d61 7469 6f6e 2e20 4465 6661 756c  ormation. Defaul
+00022d00: 7420 6973 2060 6046 616c 7365 6060 2e0a  t is ``False``..
+00022d10: 2020 2020 2020 2020 3a72 6574 7572 6e73          :returns
+00022d20: 3a20 3a70 793a 636c 6173 733a 607e 6d6c  : :py:class:`~ml
+00022d30: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
+00022d40: 6173 2e68 7562 2e48 7562 4361 7461 6c6f  as.hub.HubCatalo
+00022d50: 6760 206f 626a 6563 742c 2077 6869 6368  g` object, which
+00022d60: 2069 7320 6573 7365 6e74 6961 6c6c 7920   is essentially 
+00022d70: 6120 6c69 7374 0a20 2020 2020 2020 2020  a list.         
+00022d80: 2020 206f 6620 3a70 793a 636c 6173 733a     of :py:class:
+00022d90: 607e 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73  `~mlrun.common.s
+00022da0: 6368 656d 6173 2e68 7562 2e48 7562 4974  chemas.hub.HubIt
+00022db0: 656d 6020 656e 7472 6965 732e 0a20 2020  em` entries..   
+00022dc0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00022dd0: 2070 6174 6820 3d20 6622 6875 622f 736f   path = f"hub/so
+00022de0: 7572 6365 732f 7b73 6f75 7263 655f 6e61  urces/{source_na
+00022df0: 6d65 7d2f 6974 656d 7322 0a20 2020 2020  me}/items".     
+00022e00: 2020 2070 6172 616d 7320 3d20 7b0a 2020     params = {.  
+00022e10: 2020 2020 2020 2020 2020 2276 6572 7369            "versi
+00022e20: 6f6e 223a 2076 6572 7369 6f6e 2c0a 2020  on": version,.  
+00022e30: 2020 2020 2020 2020 2020 2274 6167 223a            "tag":
+00022e40: 2074 6167 2c0a 2020 2020 2020 2020 2020   tag,.          
+00022e50: 2020 2266 6f72 6365 2d72 6566 7265 7368    "force-refresh
+00022e60: 223a 2066 6f72 6365 5f72 6566 7265 7368  ": force_refresh
+00022e70: 2c0a 2020 2020 2020 2020 7d0a 2020 2020  ,.        }.    
+00022e80: 2020 2020 7265 7370 6f6e 7365 203d 2073      response = s
+00022e90: 656c 662e 6170 695f 6361 6c6c 286d 6574  elf.api_call(met
+00022ea0: 686f 643d 2247 4554 222c 2070 6174 683d  hod="GET", path=
+00022eb0: 7061 7468 2c20 7061 7261 6d73 3d70 6172  path, params=par
+00022ec0: 616d 7329 0a20 2020 2020 2020 2072 6574  ams).        ret
+00022ed0: 7572 6e20 6d6c 7275 6e2e 636f 6d6d 6f6e  urn mlrun.common
+00022ee0: 2e73 6368 656d 6173 2e48 7562 4361 7461  .schemas.HubCata
+00022ef0: 6c6f 6728 2a2a 7265 7370 6f6e 7365 2e6a  log(**response.j
+00022f00: 736f 6e28 2929 0a0a 2020 2020 6465 6620  son())..    def 
+00022f10: 6765 745f 6875 625f 6974 656d 280a 2020  get_hub_item(.  
+00022f20: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+00022f30: 2020 2020 736f 7572 6365 5f6e 616d 653a      source_name:
+00022f40: 2073 7472 2c0a 2020 2020 2020 2020 6974   str,.        it
+00022f50: 656d 5f6e 616d 653a 2073 7472 2c0a 2020  em_name: str,.  
+00022f60: 2020 2020 2020 7665 7273 696f 6e3a 2073        version: s
+00022f70: 7472 203d 204e 6f6e 652c 0a20 2020 2020  tr = None,.     
+00022f80: 2020 2074 6167 3a20 7374 7220 3d20 226c     tag: str = "l
+00022f90: 6174 6573 7422 2c0a 2020 2020 2020 2020  atest",.        
+00022fa0: 666f 7263 655f 7265 6672 6573 683a 2062  force_refresh: b
+00022fb0: 6f6f 6c20 3d20 4661 6c73 652c 0a20 2020  ool = False,.   
+00022fc0: 2029 3a0a 2020 2020 2020 2020 2222 220a   ):.        """.
+00022fd0: 2020 2020 2020 2020 5265 7472 6965 7665          Retrieve
+00022fe0: 2061 2073 7065 6369 6669 6320 6875 6220   a specific hub 
+00022ff0: 6974 656d 2e0a 0a20 2020 2020 2020 203a  item...        :
+00023000: 7061 7261 6d20 736f 7572 6365 5f6e 616d  param source_nam
+00023010: 653a 204e 616d 6520 6f66 2073 6f75 7263  e: Name of sourc
+00023020: 652e 0a20 2020 2020 2020 203a 7061 7261  e..        :para
+00023030: 6d20 6974 656d 5f6e 616d 653a 204e 616d  m item_name: Nam
+00023040: 6520 6f66 2074 6865 2069 7465 6d20 746f  e of the item to
+00023050: 2072 6574 7269 6576 652c 2061 7320 6974   retrieve, as it
+00023060: 2061 7070 6561 7273 2069 6e20 7468 6520   appears in the 
+00023070: 6361 7461 6c6f 672e 0a20 2020 2020 2020  catalog..       
+00023080: 203a 7061 7261 6d20 7665 7273 696f 6e3a   :param version:
+00023090: 2047 6574 2061 2073 7065 6369 6669 6320   Get a specific 
+000230a0: 7665 7273 696f 6e20 6f66 2074 6865 2069  version of the i
+000230b0: 7465 6d2e 2044 6566 6175 6c74 2069 7320  tem. Default is 
+000230c0: 6060 4e6f 6e65 6060 2e0a 2020 2020 2020  ``None``..      
+000230d0: 2020 3a70 6172 616d 2074 6167 3a20 4765    :param tag: Ge
+000230e0: 7420 6120 7370 6563 6966 6963 2076 6572  t a specific ver
+000230f0: 7369 6f6e 206f 6620 7468 6520 6974 656d  sion of the item
+00023100: 2069 6465 6e74 6966 6965 6420 6279 2074   identified by t
+00023110: 6167 2e20 4465 6661 756c 7420 6973 2060  ag. Default is `
+00023120: 606c 6174 6573 7460 602e 0a20 2020 2020  `latest``..     
+00023130: 2020 203a 7061 7261 6d20 666f 7263 655f     :param force_
+00023140: 7265 6672 6573 683a 204d 616b 6520 7468  refresh: Make th
+00023150: 6520 7365 7276 6572 2066 6574 6368 2074  e server fetch t
+00023160: 6865 2069 6e66 6f72 6d61 7469 6f6e 2066  he information f
+00023170: 726f 6d20 7468 6520 6163 7475 616c 2068  rom the actual h
+00023180: 7562 0a20 2020 2020 2020 2020 2020 2073  ub.            s
+00023190: 6f75 7263 652c 2072 6174 6865 7220 7468  ource, rather th
+000231a0: 616e 0a20 2020 2020 2020 2020 2020 2072  an.            r
+000231b0: 656c 7920 6f6e 2063 6163 6865 6420 696e  ely on cached in
+000231c0: 666f 726d 6174 696f 6e2e 2044 6566 6175  formation. Defau
+000231d0: 6c74 2069 7320 6060 4661 6c73 6560 602e  lt is ``False``.
+000231e0: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
+000231f0: 733a 203a 7079 3a63 6c61 7373 3a60 7e6d  s: :py:class:`~m
+00023200: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
+00023210: 6d61 732e 6875 622e 4875 6249 7465 6d60  mas.hub.HubItem`
+00023220: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+00023230: 2020 2020 2020 7061 7468 203d 2028 6622        path = (f"
+00023240: 6875 622f 736f 7572 6365 732f 7b73 6f75  hub/sources/{sou
+00023250: 7263 655f 6e61 6d65 7d2f 6974 656d 732f  rce_name}/items/
+00023260: 7b69 7465 6d5f 6e61 6d65 7d22 2c29 0a20  {item_name}",). 
+00023270: 2020 2020 2020 2070 6172 616d 7320 3d20         params = 
+00023280: 7b0a 2020 2020 2020 2020 2020 2020 2276  {.            "v
+00023290: 6572 7369 6f6e 223a 2076 6572 7369 6f6e  ersion": version
+000232a0: 2c0a 2020 2020 2020 2020 2020 2020 2274  ,.            "t
+000232b0: 6167 223a 2074 6167 2c0a 2020 2020 2020  ag": tag,.      
+000232c0: 2020 2020 2020 2266 6f72 6365 2d72 6566        "force-ref
+000232d0: 7265 7368 223a 2066 6f72 6365 5f72 6566  resh": force_ref
+000232e0: 7265 7368 2c0a 2020 2020 2020 2020 7d0a  resh,.        }.
+000232f0: 2020 2020 2020 2020 7265 7370 6f6e 7365          response
+00023300: 203d 2073 656c 662e 6170 695f 6361 6c6c   = self.api_call
+00023310: 286d 6574 686f 643d 2247 4554 222c 2070  (method="GET", p
+00023320: 6174 683d 7061 7468 2c20 7061 7261 6d73  ath=path, params
+00023330: 3d70 6172 616d 7329 0a20 2020 2020 2020  =params).       
+00023340: 2072 6574 7572 6e20 6d6c 7275 6e2e 636f   return mlrun.co
+00023350: 6d6d 6f6e 2e73 6368 656d 6173 2e48 7562  mmon.schemas.Hub
+00023360: 4974 656d 282a 2a72 6573 706f 6e73 652e  Item(**response.
+00023370: 6a73 6f6e 2829 290a 0a20 2020 2064 6566  json())..    def
+00023380: 2067 6574 5f68 7562 5f61 7373 6574 280a   get_hub_asset(.
+00023390: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+000233a0: 2020 2020 2020 736f 7572 6365 5f6e 616d        source_nam
+000233b0: 653a 2073 7472 2c0a 2020 2020 2020 2020  e: str,.        
+000233c0: 6974 656d 5f6e 616d 653a 2073 7472 2c0a  item_name: str,.
+000233d0: 2020 2020 2020 2020 6173 7365 745f 6e61          asset_na
+000233e0: 6d65 3a20 7374 722c 0a20 2020 2020 2020  me: str,.       
+000233f0: 2076 6572 7369 6f6e 3a20 7374 7220 3d20   version: str = 
+00023400: 4e6f 6e65 2c0a 2020 2020 2020 2020 7461  None,.        ta
+00023410: 673a 2073 7472 203d 2022 6c61 7465 7374  g: str = "latest
+00023420: 222c 0a20 2020 2029 3a0a 2020 2020 2020  ",.    ):.      
+00023430: 2020 2222 220a 2020 2020 2020 2020 4765    """.        Ge
+00023440: 7420 6875 6220 6173 7365 7420 6672 6f6d  t hub asset from
+00023450: 2069 7465 6d2e 0a0a 2020 2020 2020 2020   item...        
+00023460: 3a70 6172 616d 2073 6f75 7263 655f 6e61  :param source_na
+00023470: 6d65 3a20 4e61 6d65 206f 6620 736f 7572  me: Name of sour
+00023480: 6365 2e0a 2020 2020 2020 2020 3a70 6172  ce..        :par
+00023490: 616d 2069 7465 6d5f 6e61 6d65 3a20 2020  am item_name:   
+000234a0: 4e61 6d65 206f 6620 7468 6520 6974 656d  Name of the item
+000234b0: 2077 6869 6368 2068 6f6c 6473 2074 6865   which holds the
+000234c0: 2061 7373 6574 2e0a 2020 2020 2020 2020   asset..        
+000234d0: 3a70 6172 616d 2061 7373 6574 5f6e 616d  :param asset_nam
+000234e0: 653a 2020 4e61 6d65 206f 6620 7468 6520  e:  Name of the 
+000234f0: 6173 7365 7420 746f 2072 6574 7269 6576  asset to retriev
+00023500: 652e 0a20 2020 2020 2020 203a 7061 7261  e..        :para
+00023510: 6d20 7665 7273 696f 6e3a 2047 6574 2061  m version: Get a
+00023520: 2073 7065 6369 6669 6320 7665 7273 696f   specific versio
+00023530: 6e20 6f66 2074 6865 2069 7465 6d2e 2044  n of the item. D
+00023540: 6566 6175 6c74 2069 7320 6060 4e6f 6e65  efault is ``None
+00023550: 6060 2e0a 2020 2020 2020 2020 3a70 6172  ``..        :par
+00023560: 616d 2074 6167 3a20 4765 7420 6120 7370  am tag: Get a sp
+00023570: 6563 6966 6963 2076 6572 7369 6f6e 206f  ecific version o
+00023580: 6620 7468 6520 6974 656d 2069 6465 6e74  f the item ident
+00023590: 6966 6965 6420 6279 2074 6167 2e20 4465  ified by tag. De
+000235a0: 6661 756c 7420 6973 2060 606c 6174 6573  fault is ``lates
+000235b0: 7460 602e 0a0a 2020 2020 2020 2020 3a72  t``...        :r
+000235c0: 6574 7572 6e3a 2068 7474 7020 7265 7370  eturn: http resp
+000235d0: 6f6e 7365 2077 6974 6820 7468 6520 6173  onse with the as
+000235e0: 7365 7420 696e 2074 6865 2063 6f6e 7465  set in the conte
+000235f0: 6e74 2061 7474 7269 6275 7465 0a20 2020  nt attribute.   
+00023600: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00023610: 2070 6174 6820 3d20 6622 6875 622f 736f   path = f"hub/so
+00023620: 7572 6365 732f 7b73 6f75 7263 655f 6e61  urces/{source_na
+00023630: 6d65 7d2f 6974 656d 732f 7b69 7465 6d5f  me}/items/{item_
+00023640: 6e61 6d65 7d2f 6173 7365 7473 2f7b 6173  name}/assets/{as
+00023650: 7365 745f 6e61 6d65 7d22 0a20 2020 2020  set_name}".     
+00023660: 2020 2070 6172 616d 7320 3d20 7b0a 2020     params = {.  
+00023670: 2020 2020 2020 2020 2020 2276 6572 7369            "versi
+00023680: 6f6e 223a 2076 6572 7369 6f6e 2c0a 2020  on": version,.  
+00023690: 2020 2020 2020 2020 2020 2274 6167 223a            "tag":
+000236a0: 2074 6167 2c0a 2020 2020 2020 2020 7d0a   tag,.        }.
+000236b0: 2020 2020 2020 2020 7265 7370 6f6e 7365          response
+000236c0: 203d 2073 656c 662e 6170 695f 6361 6c6c   = self.api_call
+000236d0: 286d 6574 686f 643d 2247 4554 222c 2070  (method="GET", p
+000236e0: 6174 683d 7061 7468 2c20 7061 7261 6d73  ath=path, params
+000236f0: 3d70 6172 616d 7329 0a20 2020 2020 2020  =params).       
+00023700: 2072 6574 7572 6e20 7265 7370 6f6e 7365   return response
+00023710: 0a0a 2020 2020 6465 6620 7665 7269 6679  ..    def verify
+00023720: 5f61 7574 686f 7269 7a61 7469 6f6e 280a  _authorization(.
+00023730: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+00023740: 2020 2020 2020 6175 7468 6f72 697a 6174        authorizat
+00023750: 696f 6e5f 7665 7269 6669 6361 7469 6f6e  ion_verification
+00023760: 5f69 6e70 7574 3a20 6d6c 7275 6e2e 636f  _input: mlrun.co
+00023770: 6d6d 6f6e 2e73 6368 656d 6173 2e41 7574  mmon.schemas.Aut
+00023780: 686f 7269 7a61 7469 6f6e 5665 7269 6669  horizationVerifi
+00023790: 6361 7469 6f6e 496e 7075 742c 0a20 2020  cationInput,.   
+000237a0: 2029 3a0a 2020 2020 2020 2020 2222 2256   ):.        """V
+000237b0: 6572 6966 6965 7320 6175 7468 6f72 697a  erifies authoriz
+000237c0: 6174 696f 6e20 666f 7220 7468 6520 7072  ation for the pr
+000237d0: 6f76 6964 6564 2061 6374 696f 6e20 6f6e  ovided action on
+000237e0: 2074 6865 2070 726f 7669 6465 6420 7265   the provided re
+000237f0: 736f 7572 6365 2e0a 0a20 2020 2020 2020  source...       
+00023800: 203a 7061 7261 6d20 6175 7468 6f72 697a   :param authoriz
+00023810: 6174 696f 6e5f 7665 7269 6669 6361 7469  ation_verificati
+00023820: 6f6e 5f69 6e70 7574 3a20 496e 7374 616e  on_input: Instan
+00023830: 6365 206f 660a 2020 2020 2020 2020 2020  ce of.          
+00023840: 2020 3a70 793a 636c 6173 733a 607e 6d6c    :py:class:`~ml
+00023850: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
+00023860: 6173 2e41 7574 686f 7269 7a61 7469 6f6e  as.Authorization
+00023870: 5665 7269 6669 6361 7469 6f6e 496e 7075  VerificationInpu
+00023880: 7460 2074 6861 7420 696e 636c 7564 6573  t` that includes
+00023890: 2061 6c6c 2074 6865 206e 6565 6465 6420   all the needed 
+000238a0: 7061 7261 6d65 7465 7273 2066 6f72 0a20  parameters for. 
+000238b0: 2020 2020 2020 2020 2020 2074 6865 2061             the a
+000238c0: 7574 6820 7665 7269 6669 6361 7469 6f6e  uth verification
+000238d0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+000238e0: 2020 2020 2065 7272 6f72 5f6d 6573 7361       error_messa
+000238f0: 6765 203d 2022 4175 7468 6f72 697a 6174  ge = "Authorizat
+00023900: 696f 6e20 6368 6563 6b20 6661 696c 6564  ion check failed
+00023910: 220a 2020 2020 2020 2020 7365 6c66 2e61  ".        self.a
+00023920: 7069 5f63 616c 6c28 0a20 2020 2020 2020  pi_call(.       
+00023930: 2020 2020 2022 504f 5354 222c 0a20 2020       "POST",.   
+00023940: 2020 2020 2020 2020 2022 6175 7468 6f72           "author
+00023950: 697a 6174 696f 6e2f 7665 7269 6669 6361  ization/verifica
+00023960: 7469 6f6e 7322 2c0a 2020 2020 2020 2020  tions",.        
+00023970: 2020 2020 6572 726f 725f 6d65 7373 6167      error_messag
+00023980: 652c 0a20 2020 2020 2020 2020 2020 2062  e,.            b
+00023990: 6f64 793d 6469 6374 5f74 6f5f 6a73 6f6e  ody=dict_to_json
+000239a0: 2861 7574 686f 7269 7a61 7469 6f6e 5f76  (authorization_v
+000239b0: 6572 6966 6963 6174 696f 6e5f 696e 7075  erification_inpu
+000239c0: 742e 6469 6374 2829 292c 0a20 2020 2020  t.dict()),.     
+000239d0: 2020 2029 0a0a 2020 2020 6465 6620 6c69     )..    def li
+000239e0: 7374 5f61 7069 5f67 6174 6577 6179 7328  st_api_gateways(
+000239f0: 7365 6c66 2c20 7072 6f6a 6563 743d 4e6f  self, project=No
+00023a00: 6e65 2920 2d3e 206d 6c72 756e 2e63 6f6d  ne) -> mlrun.com
+00023a10: 6d6f 6e2e 7363 6865 6d61 732e 4150 4947  mon.schemas.APIG
+00023a20: 6174 6577 6179 734f 7574 7075 743a 0a20  atewaysOutput:. 
+00023a30: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00023a40: 2020 2052 6574 7572 6e73 2061 206c 6973     Returns a lis
+00023a50: 7420 6f66 204e 7563 6c69 6f20 6170 6920  t of Nuclio api 
+00023a60: 6761 7465 7761 7973 0a20 2020 2020 2020  gateways.       
+00023a70: 203a 7061 7261 6d20 7072 6f6a 6563 743a   :param project:
+00023a80: 206f 7074 696f 6e61 6c20 7374 7220 7061   optional str pa
+00023a90: 7261 6d65 7465 7220 746f 2066 696c 7465  rameter to filte
+00023aa0: 7220 6279 2070 726f 6a65 6374 2c20 6966  r by project, if
+00023ab0: 206e 6f74 2070 6173 7365 642c 2064 6566   not passed, def
+00023ac0: 6175 6c74 2070 726f 6a65 6374 2076 616c  ault project val
+00023ad0: 7565 2069 7320 7461 6b65 6e0a 0a20 2020  ue is taken..   
+00023ae0: 2020 2020 203a 7265 7475 726e 3a20 3a70       :return: :p
+00023af0: 793a 636c 6173 733a 607e 6d6c 7275 6e2e  y:class:`~mlrun.
+00023b00: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e41  common.schemas.A
+00023b10: 5049 4761 7465 7761 7973 602e 0a20 2020  PIGateways`..   
+00023b20: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00023b30: 2070 726f 6a65 6374 203d 2070 726f 6a65   project = proje
+00023b40: 6374 206f 7220 636f 6e66 6967 2e64 6566  ct or config.def
+00023b50: 6175 6c74 5f70 726f 6a65 6374 0a20 2020  ault_project.   
+00023b60: 2020 2020 2065 7272 6f72 203d 2022 6c69       error = "li
+00023b70: 7374 2061 7069 2067 6174 6577 6179 7322  st api gateways"
+00023b80: 0a20 2020 2020 2020 2065 6e64 706f 696e  .        endpoin
+00023b90: 745f 7061 7468 203d 2066 2270 726f 6a65  t_path = f"proje
+00023ba0: 6374 732f 7b70 726f 6a65 6374 7d2f 6170  cts/{project}/ap
+00023bb0: 692d 6761 7465 7761 7973 220a 2020 2020  i-gateways".    
+00023bc0: 2020 2020 7265 7370 6f6e 7365 203d 2073      response = s
+00023bd0: 656c 662e 6170 695f 6361 6c6c 2822 4745  elf.api_call("GE
+00023be0: 5422 2c20 656e 6470 6f69 6e74 5f70 6174  T", endpoint_pat
+00023bf0: 682c 2065 7272 6f72 290a 2020 2020 2020  h, error).      
+00023c00: 2020 7265 7475 726e 206d 6c72 756e 2e63    return mlrun.c
+00023c10: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 4150  ommon.schemas.AP
+00023c20: 4947 6174 6577 6179 734f 7574 7075 7428  IGatewaysOutput(
+00023c30: 2a2a 7265 7370 6f6e 7365 2e6a 736f 6e28  **response.json(
+00023c40: 2929 0a0a 2020 2020 6465 6620 6765 745f  ))..    def get_
+00023c50: 6170 695f 6761 7465 7761 7928 7365 6c66  api_gateway(self
+00023c60: 2c20 6e61 6d65 2c20 7072 6f6a 6563 743d  , name, project=
+00023c70: 4e6f 6e65 2920 2d3e 206d 6c72 756e 2e63  None) -> mlrun.c
+00023c80: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 4150  ommon.schemas.AP
+00023c90: 4947 6174 6577 6179 3a0a 2020 2020 2020  IGateway:.      
+00023ca0: 2020 2222 220a 2020 2020 2020 2020 5265    """.        Re
+00023cb0: 7475 726e 7320 616e 2041 5049 2067 6174  turns an API gat
+00023cc0: 6577 6179 0a20 2020 2020 2020 203a 7061  eway.        :pa
+00023cd0: 7261 6d20 6e61 6d65 3a20 4150 4920 6761  ram name: API ga
+00023ce0: 7465 7761 7920 6e61 6d65 0a20 2020 2020  teway name.     
+00023cf0: 2020 203a 7061 7261 6d20 7072 6f6a 6563     :param projec
+00023d00: 743a 206f 7074 696f 6e61 6c20 7374 7220  t: optional str 
+00023d10: 7061 7261 6d65 7465 7220 746f 2066 696c  parameter to fil
+00023d20: 7465 7220 6279 2070 726f 6a65 6374 2c20  ter by project, 
+00023d30: 6966 206e 6f74 2070 6173 7365 642c 2064  if not passed, d
+00023d40: 6566 6175 6c74 2070 726f 6a65 6374 2076  efault project v
+00023d50: 616c 7565 2069 7320 7461 6b65 6e0a 0a20  alue is taken.. 
+00023d60: 2020 2020 2020 203a 7265 7475 726e 3a20         :return: 
+00023d70: 203a 7079 3a63 6c61 7373 3a60 7e6d 6c72   :py:class:`~mlr
+00023d80: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+00023d90: 732e 4150 4947 6174 6577 6179 602e 0a20  s.APIGateway`.. 
+00023da0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00023db0: 2020 2070 726f 6a65 6374 203d 2070 726f     project = pro
+00023dc0: 6a65 6374 206f 7220 636f 6e66 6967 2e64  ject or config.d
+00023dd0: 6566 6175 6c74 5f70 726f 6a65 6374 0a20  efault_project. 
+00023de0: 2020 2020 2020 2065 7272 6f72 203d 2022         error = "
+00023df0: 6765 7420 6170 6920 6761 7465 7761 7922  get api gateway"
+00023e00: 0a20 2020 2020 2020 2065 6e64 706f 696e  .        endpoin
+00023e10: 745f 7061 7468 203d 2066 2270 726f 6a65  t_path = f"proje
+00023e20: 6374 732f 7b70 726f 6a65 6374 7d2f 6170  cts/{project}/ap
+00023e30: 692d 6761 7465 7761 7973 2f7b 6e61 6d65  i-gateways/{name
+00023e40: 7d22 0a20 2020 2020 2020 2072 6573 706f  }".        respo
+00023e50: 6e73 6520 3d20 7365 6c66 2e61 7069 5f63  nse = self.api_c
+00023e60: 616c 6c28 2247 4554 222c 2065 6e64 706f  all("GET", endpo
+00023e70: 696e 745f 7061 7468 2c20 6572 726f 7229  int_path, error)
+00023e80: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00023e90: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+00023ea0: 656d 6173 2e41 5049 4761 7465 7761 7928  emas.APIGateway(
+00023eb0: 2a2a 7265 7370 6f6e 7365 2e6a 736f 6e28  **response.json(
+00023ec0: 2929 0a0a 2020 2020 6465 6620 6465 6c65  ))..    def dele
+00023ed0: 7465 5f61 7069 5f67 6174 6577 6179 2873  te_api_gateway(s
+00023ee0: 656c 662c 206e 616d 652c 2070 726f 6a65  elf, name, proje
+00023ef0: 6374 3d4e 6f6e 6529 3a0a 2020 2020 2020  ct=None):.      
+00023f00: 2020 2222 220a 2020 2020 2020 2020 4465    """.        De
+00023f10: 6c65 7465 7320 616e 2041 5049 2067 6174  letes an API gat
+00023f20: 6577 6179 0a20 2020 2020 2020 203a 7061  eway.        :pa
+00023f30: 7261 6d20 6e61 6d65 3a20 4150 4920 6761  ram name: API ga
+00023f40: 7465 7761 7920 6e61 6d65 0a20 2020 2020  teway name.     
+00023f50: 2020 203a 7061 7261 6d20 7072 6f6a 6563     :param projec
+00023f60: 743a 2050 726f 6a65 6374 206e 616d 650a  t: Project name.
+00023f70: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00023f80: 2020 2020 7072 6f6a 6563 7420 3d20 7072      project = pr
+00023f90: 6f6a 6563 7420 6f72 2063 6f6e 6669 672e  oject or config.
+00023fa0: 6465 6661 756c 745f 7072 6f6a 6563 740a  default_project.
+00023fb0: 2020 2020 2020 2020 6572 726f 7220 3d20          error = 
+00023fc0: 2264 656c 6574 6520 6170 6920 6761 7465  "delete api gate
+00023fd0: 7761 7922 0a20 2020 2020 2020 2065 6e64  way".        end
+00023fe0: 706f 696e 745f 7061 7468 203d 2066 2270  point_path = f"p
+00023ff0: 726f 6a65 6374 732f 7b70 726f 6a65 6374  rojects/{project
+00024000: 7d2f 6170 692d 6761 7465 7761 7973 2f7b  }/api-gateways/{
+00024010: 6e61 6d65 7d22 0a20 2020 2020 2020 2073  name}".        s
+00024020: 656c 662e 6170 695f 6361 6c6c 2822 4445  elf.api_call("DE
+00024030: 4c45 5445 222c 2065 6e64 706f 696e 745f  LETE", endpoint_
+00024040: 7061 7468 2c20 6572 726f 7229 0a0a 2020  path, error)..  
+00024050: 2020 6465 6620 7374 6f72 655f 6170 695f    def store_api_
+00024060: 6761 7465 7761 7928 0a20 2020 2020 2020  gateway(.       
+00024070: 2073 656c 662c 0a20 2020 2020 2020 2061   self,.        a
+00024080: 7069 5f67 6174 6577 6179 3a20 556e 696f  pi_gateway: Unio
+00024090: 6e5b 0a20 2020 2020 2020 2020 2020 206d  n[.            m
+000240a0: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
+000240b0: 6d61 732e 4150 4947 6174 6577 6179 2c0a  mas.APIGateway,.
+000240c0: 2020 2020 2020 2020 2020 2020 6d6c 7275              mlru
+000240d0: 6e2e 7275 6e74 696d 6573 2e6e 7563 6c69  n.runtimes.nucli
+000240e0: 6f2e 6170 695f 6761 7465 7761 792e 4150  o.api_gateway.AP
+000240f0: 4947 6174 6577 6179 2c0a 2020 2020 2020  IGateway,.      
+00024100: 2020 5d2c 0a20 2020 2020 2020 2070 726f    ],.        pro
+00024110: 6a65 6374 3a20 4f70 7469 6f6e 616c 5b73  ject: Optional[s
+00024120: 7472 5d20 3d20 4e6f 6e65 2c0a 2020 2020  tr] = None,.    
+00024130: 2920 2d3e 206d 6c72 756e 2e63 6f6d 6d6f  ) -> mlrun.commo
+00024140: 6e2e 7363 6865 6d61 732e 4150 4947 6174  n.schemas.APIGat
+00024150: 6577 6179 3a0a 2020 2020 2020 2020 2222  eway:.        ""
+00024160: 220a 2020 2020 2020 2020 5374 6f72 6573  ".        Stores
+00024170: 2061 6e20 4150 4920 4761 7465 7761 792e   an API Gateway.
+00024180: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00024190: 6170 695f 6761 7465 7761 7920 3a70 793a  api_gateway :py:
+000241a0: 636c 6173 733a 607e 6d6c 7275 6e2e 7275  class:`~mlrun.ru
+000241b0: 6e74 696d 6573 2e6e 7563 6c69 6f2e 4150  ntimes.nuclio.AP
+000241c0: 4947 6174 6577 6179 600a 2020 2020 2020  IGateway`.      
+000241d0: 2020 2020 2020 6f72 203a 7079 3a63 6c61        or :py:cla
+000241e0: 7373 3a60 7e6d 6c72 756e 2e63 6f6d 6d6f  ss:`~mlrun.commo
+000241f0: 6e2e 7363 6865 6d61 732e 4150 4947 6174  n.schemas.APIGat
+00024200: 6577 6179 603a 2041 5049 2047 6174 6577  eway`: API Gatew
+00024210: 6179 2065 6e74 6974 792e 0a20 2020 2020  ay entity..     
+00024220: 2020 203a 7061 7261 6d20 7072 6f6a 6563     :param projec
+00024230: 743a 2070 726f 6a65 6374 206e 616d 652e  t: project name.
+00024240: 204d 616e 6461 746f 7279 2069 6620 6170   Mandatory if ap
+00024250: 695f 6761 7465 7761 7920 6973 206d 6c72  i_gateway is mlr
+00024260: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+00024270: 732e 4150 4947 6174 6577 6179 2e0a 0a20  s.APIGateway... 
+00024280: 2020 2020 2020 203a 7265 7475 726e 3a20         :return: 
+00024290: 203a 7079 3a63 6c61 7373 3a60 7e6d 6c72   :py:class:`~mlr
+000242a0: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+000242b0: 732e 4150 4947 6174 6577 6179 602e 0a20  s.APIGateway`.. 
+000242c0: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
+000242d0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+000242e0: 6528 6170 695f 6761 7465 7761 792c 206d  e(api_gateway, m
+000242f0: 6c72 756e 2e72 756e 7469 6d65 732e 6e75  lrun.runtimes.nu
+00024300: 636c 696f 2e61 7069 5f67 6174 6577 6179  clio.api_gateway
+00024310: 2e41 5049 4761 7465 7761 7929 3a0a 2020  .APIGateway):.  
+00024320: 2020 2020 2020 2020 2020 6170 695f 6761            api_ga
+00024330: 7465 7761 7920 3d20 6170 695f 6761 7465  teway = api_gate
+00024340: 7761 792e 746f 5f73 6368 656d 6528 290a  way.to_scheme().
+00024350: 2020 2020 2020 2020 656e 6470 6f69 6e74          endpoint
+00024360: 5f70 6174 6820 3d20 6622 7072 6f6a 6563  _path = f"projec
+00024370: 7473 2f7b 7072 6f6a 6563 747d 2f61 7069  ts/{project}/api
+00024380: 2d67 6174 6577 6179 732f 7b61 7069 5f67  -gateways/{api_g
+00024390: 6174 6577 6179 2e6d 6574 6164 6174 612e  ateway.metadata.
+000243a0: 6e61 6d65 7d22 0a20 2020 2020 2020 2065  name}".        e
+000243b0: 7272 6f72 203d 2022 7374 6f72 6520 6170  rror = "store ap
+000243c0: 6920 6761 7465 7761 7973 220a 2020 2020  i gateways".    
+000243d0: 2020 2020 7265 7370 6f6e 7365 203d 2073      response = s
+000243e0: 656c 662e 6170 695f 6361 6c6c 280a 2020  elf.api_call(.  
+000243f0: 2020 2020 2020 2020 2020 2250 5554 222c            "PUT",
+00024400: 0a20 2020 2020 2020 2020 2020 2065 6e64  .            end
+00024410: 706f 696e 745f 7061 7468 2c0a 2020 2020  point_path,.    
+00024420: 2020 2020 2020 2020 6572 726f 722c 0a20          error,. 
+00024430: 2020 2020 2020 2020 2020 206a 736f 6e3d             json=
+00024440: 6170 695f 6761 7465 7761 792e 6469 6374  api_gateway.dict
+00024450: 2865 7863 6c75 6465 5f6e 6f6e 653d 5472  (exclude_none=Tr
+00024460: 7565 292c 0a20 2020 2020 2020 2029 0a20  ue),.        ). 
+00024470: 2020 2020 2020 2072 6574 7572 6e20 6d6c         return ml
+00024480: 7275 6e2e 636f 6d6d 6f6e 2e73 6368 656d  run.common.schem
+00024490: 6173 2e41 5049 4761 7465 7761 7928 2a2a  as.APIGateway(**
+000244a0: 7265 7370 6f6e 7365 2e6a 736f 6e28 2929  response.json())
+000244b0: 0a0a 2020 2020 6465 6620 7472 6967 6765  ..    def trigge
+000244c0: 725f 6d69 6772 6174 696f 6e73 2873 656c  r_migrations(sel
+000244d0: 6629 202d 3e20 4f70 7469 6f6e 616c 5b6d  f) -> Optional[m
+000244e0: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
+000244f0: 6d61 732e 4261 636b 6772 6f75 6e64 5461  mas.BackgroundTa
+00024500: 736b 5d3a 0a20 2020 2020 2020 2022 2222  sk]:.        """
+00024510: 5472 6967 6765 7220 6d69 6772 6174 696f  Trigger migratio
+00024520: 6e73 2028 7769 6c6c 2064 6f20 6e6f 7468  ns (will do noth
+00024530: 696e 6720 6966 206e 6f20 6d69 6772 6174  ing if no migrat
+00024540: 696f 6e73 2061 7265 206e 6565 6465 6429  ions are needed)
+00024550: 2061 6e64 2077 6169 7420 666f 7220 7468   and wait for th
+00024560: 656d 2074 6f20 6669 6e69 7368 2069 6620  em to finish if 
+00024570: 6163 7475 616c 6c79 0a20 2020 2020 2020  actually.       
+00024580: 2074 7269 6767 6572 6564 0a20 2020 2020   triggered.     
+00024590: 2020 203a 7265 7475 726e 733a 203a 7079     :returns: :py
+000245a0: 3a63 6c61 7373 3a60 7e6d 6c72 756e 2e63  :class:`~mlrun.c
+000245b0: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 4261  ommon.schemas.Ba
+000245c0: 636b 6772 6f75 6e64 5461 736b 602e 0a20  ckgroundTask`.. 
+000245d0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+000245e0: 2020 2072 6573 706f 6e73 6520 3d20 7365     response = se
+000245f0: 6c66 2e61 7069 5f63 616c 6c28 0a20 2020  lf.api_call(.   
+00024600: 2020 2020 2020 2020 2022 504f 5354 222c           "POST",
+00024610: 0a20 2020 2020 2020 2020 2020 2022 6f70  .            "op
+00024620: 6572 6174 696f 6e73 2f6d 6967 7261 7469  erations/migrati
+00024630: 6f6e 7322 2c0a 2020 2020 2020 2020 2020  ons",.          
+00024640: 2020 2246 6169 6c65 6420 7472 6967 6765    "Failed trigge
+00024650: 7269 6e67 206d 6967 7261 7469 6f6e 7322  ring migrations"
+00024660: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+00024670: 2020 2020 6966 2072 6573 706f 6e73 652e      if response.
+00024680: 7374 6174 7573 5f63 6f64 6520 3d3d 2068  status_code == h
+00024690: 7474 702e 4854 5450 5374 6174 7573 2e41  ttp.HTTPStatus.A
+000246a0: 4343 4550 5445 443a 0a20 2020 2020 2020  CCEPTED:.       
+000246b0: 2020 2020 2062 6163 6b67 726f 756e 645f       background_
+000246c0: 7461 736b 203d 206d 6c72 756e 2e63 6f6d  task = mlrun.com
+000246d0: 6d6f 6e2e 7363 6865 6d61 732e 4261 636b  mon.schemas.Back
+000246e0: 6772 6f75 6e64 5461 736b 282a 2a72 6573  groundTask(**res
+000246f0: 706f 6e73 652e 6a73 6f6e 2829 290a 2020  ponse.json()).  
+00024700: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00024710: 2073 656c 662e 5f77 6169 745f 666f 725f   self._wait_for_
+00024720: 6261 636b 6772 6f75 6e64 5f74 6173 6b5f  background_task_
+00024730: 746f 5f72 6561 6368 5f74 6572 6d69 6e61  to_reach_termina
+00024740: 6c5f 7374 6174 6528 0a20 2020 2020 2020  l_state(.       
+00024750: 2020 2020 2020 2020 2062 6163 6b67 726f           backgro
+00024760: 756e 645f 7461 736b 2e6d 6574 6164 6174  und_task.metadat
+00024770: 612e 6e61 6d65 0a20 2020 2020 2020 2020  a.name.         
+00024780: 2020 2029 0a20 2020 2020 2020 2072 6574     ).        ret
+00024790: 7572 6e20 4e6f 6e65 0a0a 2020 2020 6465  urn None..    de
+000247a0: 6620 7365 745f 7275 6e5f 6e6f 7469 6669  f set_run_notifi
+000247b0: 6361 7469 6f6e 7328 0a20 2020 2020 2020  cations(.       
+000247c0: 2073 656c 662c 0a20 2020 2020 2020 2070   self,.        p
+000247d0: 726f 6a65 6374 3a20 7374 722c 0a20 2020  roject: str,.   
+000247e0: 2020 2020 2072 756e 5f75 6964 3a20 7374       run_uid: st
+000247f0: 722c 0a20 2020 2020 2020 206e 6f74 6966  r,.        notif
+00024800: 6963 6174 696f 6e73 3a20 6c69 7374 5b6d  ications: list[m
+00024810: 6c72 756e 2e6d 6f64 656c 2e4e 6f74 6966  lrun.model.Notif
+00024820: 6963 6174 696f 6e5d 203d 204e 6f6e 652c  ication] = None,
+00024830: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
+00024840: 2222 220a 2020 2020 2020 2020 5365 7420  """.        Set 
+00024850: 6e6f 7469 6669 6361 7469 6f6e 7320 6f6e  notifications on
+00024860: 2061 2072 756e 2e20 5468 6973 2077 696c   a run. This wil
+00024870: 6c20 6f76 6572 7269 6465 2061 6e79 2065  l override any e
+00024880: 7869 7374 696e 6720 6e6f 7469 6669 6361  xisting notifica
+00024890: 7469 6f6e 7320 6f6e 2074 6865 2072 756e  tions on the run
+000248a0: 2e0a 2020 2020 2020 2020 3a70 6172 616d  ..        :param
+000248b0: 2070 726f 6a65 6374 3a20 5072 6f6a 6563   project: Projec
+000248c0: 7420 636f 6e74 6169 6e69 6e67 2074 6865  t containing the
+000248d0: 2072 756e 2e0a 2020 2020 2020 2020 3a70   run..        :p
+000248e0: 6172 616d 2072 756e 5f75 6964 3a20 5549  aram run_uid: UI
+000248f0: 4420 6f66 2074 6865 2072 756e 2e0a 2020  D of the run..  
+00024900: 2020 2020 2020 3a70 6172 616d 206e 6f74        :param not
+00024910: 6966 6963 6174 696f 6e73 3a20 4c69 7374  ifications: List
+00024920: 206f 6620 6e6f 7469 6669 6361 7469 6f6e   of notification
+00024930: 7320 746f 2073 6574 206f 6e20 7468 6520  s to set on the 
+00024940: 7275 6e2e 2044 6566 6175 6c74 2069 7320  run. Default is 
+00024950: 616e 2065 6d70 7479 206c 6973 742e 0a20  an empty list.. 
+00024960: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00024970: 2020 206e 6f74 6966 6963 6174 696f 6e73     notifications
+00024980: 203d 206e 6f74 6966 6963 6174 696f 6e73   = notifications
+00024990: 206f 7220 5b5d 0a0a 2020 2020 2020 2020   or []..        
+000249a0: 7365 6c66 2e61 7069 5f63 616c 6c28 0a20  self.api_call(. 
+000249b0: 2020 2020 2020 2020 2020 2022 5055 5422             "PUT"
+000249c0: 2c0a 2020 2020 2020 2020 2020 2020 6622  ,.            f"
+000249d0: 7072 6f6a 6563 7473 2f7b 7072 6f6a 6563  projects/{projec
+000249e0: 747d 2f72 756e 732f 7b72 756e 5f75 6964  t}/runs/{run_uid
+000249f0: 7d2f 6e6f 7469 6669 6361 7469 6f6e 7322  }/notifications"
+00024a00: 2c0a 2020 2020 2020 2020 2020 2020 6622  ,.            f"
+00024a10: 4661 696c 6564 2074 6f20 7365 7420 6e6f  Failed to set no
+00024a20: 7469 6669 6361 7469 6f6e 7320 6f6e 2072  tifications on r
+00024a30: 756e 2e20 7569 643d 7b72 756e 5f75 6964  un. uid={run_uid
+00024a40: 7d2c 2070 726f 6a65 6374 3d7b 7072 6f6a  }, project={proj
+00024a50: 6563 747d 222c 0a20 2020 2020 2020 2020  ect}",.         
+00024a60: 2020 206a 736f 6e3d 7b0a 2020 2020 2020     json={.      
+00024a70: 2020 2020 2020 2020 2020 226e 6f74 6966            "notif
+00024a80: 6963 6174 696f 6e73 223a 205b 0a20 2020  ications": [.   
+00024a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024aa0: 206e 6f74 6966 6963 6174 696f 6e2e 746f   notification.to
+00024ab0: 5f64 6963 7428 2920 666f 7220 6e6f 7469  _dict() for noti
+00024ac0: 6669 6361 7469 6f6e 2069 6e20 6e6f 7469  fication in noti
+00024ad0: 6669 6361 7469 6f6e 730a 2020 2020 2020  fications.      
+00024ae0: 2020 2020 2020 2020 2020 5d2c 0a20 2020            ],.   
+00024af0: 2020 2020 2020 2020 207d 2c0a 2020 2020           },.    
+00024b00: 2020 2020 290a 0a20 2020 2064 6566 2073      )..    def s
+00024b10: 6574 5f73 6368 6564 756c 655f 6e6f 7469  et_schedule_noti
+00024b20: 6669 6361 7469 6f6e 7328 0a20 2020 2020  fications(.     
+00024b30: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+00024b40: 2070 726f 6a65 6374 3a20 7374 722c 0a20   project: str,. 
+00024b50: 2020 2020 2020 2073 6368 6564 756c 655f         schedule_
+00024b60: 6e61 6d65 3a20 7374 722c 0a20 2020 2020  name: str,.     
+00024b70: 2020 206e 6f74 6966 6963 6174 696f 6e73     notifications
+00024b80: 3a20 6c69 7374 5b6d 6c72 756e 2e6d 6f64  : list[mlrun.mod
+00024b90: 656c 2e4e 6f74 6966 6963 6174 696f 6e5d  el.Notification]
+00024ba0: 203d 204e 6f6e 652c 0a20 2020 2029 3a0a   = None,.    ):.
+00024bb0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00024bc0: 2020 2020 5365 7420 6e6f 7469 6669 6361      Set notifica
+00024bd0: 7469 6f6e 7320 6f6e 2061 2073 6368 6564  tions on a sched
+00024be0: 756c 652e 2054 6869 7320 7769 6c6c 206f  ule. This will o
+00024bf0: 7665 7272 6964 6520 616e 7920 6578 6973  verride any exis
+00024c00: 7469 6e67 206e 6f74 6966 6963 6174 696f  ting notificatio
+00024c10: 6e73 206f 6e20 7468 6520 7363 6865 6475  ns on the schedu
+00024c20: 6c65 2e0a 2020 2020 2020 2020 3a70 6172  le..        :par
+00024c30: 616d 2070 726f 6a65 6374 3a20 5072 6f6a  am project: Proj
+00024c40: 6563 7420 636f 6e74 6169 6e69 6e67 2074  ect containing t
+00024c50: 6865 2073 6368 6564 756c 652e 0a20 2020  he schedule..   
+00024c60: 2020 2020 203a 7061 7261 6d20 7363 6865       :param sche
+00024c70: 6475 6c65 5f6e 616d 653a 204e 616d 6520  dule_name: Name 
+00024c80: 6f66 2074 6865 2073 6368 6564 756c 652e  of the schedule.
+00024c90: 0a20 2020 2020 2020 203a 7061 7261 6d20  .        :param 
+00024ca0: 6e6f 7469 6669 6361 7469 6f6e 733a 204c  notifications: L
+00024cb0: 6973 7420 6f66 206e 6f74 6966 6963 6174  ist of notificat
+00024cc0: 696f 6e73 2074 6f20 7365 7420 6f6e 2074  ions to set on t
+00024cd0: 6865 2073 6368 6564 756c 652e 2044 6566  he schedule. Def
+00024ce0: 6175 6c74 2069 7320 616e 2065 6d70 7479  ault is an empty
+00024cf0: 206c 6973 742e 0a20 2020 2020 2020 2022   list..        "
+00024d00: 2222 0a20 2020 2020 2020 206e 6f74 6966  "".        notif
+00024d10: 6963 6174 696f 6e73 203d 206e 6f74 6966  ications = notif
+00024d20: 6963 6174 696f 6e73 206f 7220 5b5d 0a0a  ications or []..
+00024d30: 2020 2020 2020 2020 7365 6c66 2e61 7069          self.api
+00024d40: 5f63 616c 6c28 0a20 2020 2020 2020 2020  _call(.         
+00024d50: 2020 2022 5055 5422 2c0a 2020 2020 2020     "PUT",.      
+00024d60: 2020 2020 2020 6622 7072 6f6a 6563 7473        f"projects
+00024d70: 2f7b 7072 6f6a 6563 747d 2f73 6368 6564  /{project}/sched
+00024d80: 756c 6573 2f7b 7363 6865 6475 6c65 5f6e  ules/{schedule_n
+00024d90: 616d 657d 2f6e 6f74 6966 6963 6174 696f  ame}/notificatio
+00024da0: 6e73 222c 0a20 2020 2020 2020 2020 2020  ns",.           
+00024db0: 2066 2246 6169 6c65 6420 746f 2073 6574   f"Failed to set
+00024dc0: 206e 6f74 6966 6963 6174 696f 6e73 206f   notifications o
+00024dd0: 6e20 7363 6865 6475 6c65 2e20 7363 6865  n schedule. sche
+00024de0: 6475 6c65 3d7b 7363 6865 6475 6c65 5f6e  dule={schedule_n
+00024df0: 616d 657d 2c20 7072 6f6a 6563 743d 7b70  ame}, project={p
+00024e00: 726f 6a65 6374 7d22 2c0a 2020 2020 2020  roject}",.      
+00024e10: 2020 2020 2020 6a73 6f6e 3d7b 0a20 2020        json={.   
+00024e20: 2020 2020 2020 2020 2020 2020 2022 6e6f               "no
+00024e30: 7469 6669 6361 7469 6f6e 7322 3a20 5b0a  tifications": [.
+00024e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024e50: 2020 2020 6e6f 7469 6669 6361 7469 6f6e      notification
+00024e60: 2e74 6f5f 6469 6374 2829 2066 6f72 206e  .to_dict() for n
+00024e70: 6f74 6966 6963 6174 696f 6e20 696e 206e  otification in n
+00024e80: 6f74 6966 6963 6174 696f 6e73 0a20 2020  otifications.   
+00024e90: 2020 2020 2020 2020 2020 2020 205d 2c0a               ],.
+00024ea0: 2020 2020 2020 2020 2020 2020 7d2c 0a20              },. 
+00024eb0: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
+00024ec0: 6620 7374 6f72 655f 7275 6e5f 6e6f 7469  f store_run_noti
+00024ed0: 6669 6361 7469 6f6e 7328 0a20 2020 2020  fications(.     
+00024ee0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+00024ef0: 206e 6f74 6966 6963 6174 696f 6e5f 6f62   notification_ob
+00024f00: 6a65 6374 733a 206c 6973 745b 6d6c 7275  jects: list[mlru
+00024f10: 6e2e 6d6f 6465 6c2e 4e6f 7469 6669 6361  n.model.Notifica
+00024f20: 7469 6f6e 5d2c 0a20 2020 2020 2020 2072  tion],.        r
+00024f30: 756e 5f75 6964 3a20 7374 722c 0a20 2020  un_uid: str,.   
+00024f40: 2020 2020 2070 726f 6a65 6374 3a20 7374       project: st
+00024f50: 7220 3d20 4e6f 6e65 2c0a 2020 2020 2020  r = None,.      
+00024f60: 2020 6d61 736b 5f70 6172 616d 733a 2062    mask_params: b
+00024f70: 6f6f 6c20 3d20 5472 7565 2c0a 2020 2020  ool = True,.    
+00024f80: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+00024f90: 2020 2020 2020 2046 6f72 2069 6e74 6572         For inter
+00024fa0: 6e61 6c20 7573 652e 0a20 2020 2020 2020  nal use..       
+00024fb0: 2054 6865 206e 6f74 6966 6963 6174 696f   The notificatio
+00024fc0: 6e20 6d65 6368 616e 6973 6d20 6d61 7920  n mechanism may 
+00024fd0: 7275 6e20 226c 6f63 616c 6c79 2220 666f  run "locally" fo
+00024fe0: 7220 6365 7274 6169 6e20 7275 6e74 696d  r certain runtim
+00024ff0: 6573 2e0a 2020 2020 2020 2020 486f 7765  es..        Howe
+00025000: 7665 722c 2074 6865 2075 7064 6174 6573  ver, the updates
+00025010: 206f 6363 7572 2069 6e20 7468 6520 4150   occur in the AP
+00025020: 4920 736f 206e 6f74 6869 6e67 2074 6f20  I so nothing to 
+00025030: 646f 2068 6572 652e 0a20 2020 2020 2020  do here..       
+00025040: 2022 2222 0a20 2020 2020 2020 2070 6173   """.        pas
+00025050: 730a 0a20 2020 2064 6566 2073 7562 6d69  s..    def submi
+00025060: 745f 776f 726b 666c 6f77 280a 2020 2020  t_workflow(.    
+00025070: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+00025080: 2020 7072 6f6a 6563 743a 2073 7472 2c0a    project: str,.
+00025090: 2020 2020 2020 2020 6e61 6d65 3a20 7374          name: st
+000250a0: 722c 0a20 2020 2020 2020 2077 6f72 6b66  r,.        workf
+000250b0: 6c6f 775f 7370 6563 3a20 556e 696f 6e5b  low_spec: Union[
+000250c0: 0a20 2020 2020 2020 2020 2020 206d 6c72  .            mlr
+000250d0: 756e 2e70 726f 6a65 6374 732e 7069 7065  un.projects.pipe
+000250e0: 6c69 6e65 732e 576f 726b 666c 6f77 5370  lines.WorkflowSp
+000250f0: 6563 2c0a 2020 2020 2020 2020 2020 2020  ec,.            
+00025100: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+00025110: 656d 6173 2e57 6f72 6b66 6c6f 7753 7065  emas.WorkflowSpe
+00025120: 632c 0a20 2020 2020 2020 2020 2020 2064  c,.            d
+00025130: 6963 742c 0a20 2020 2020 2020 205d 2c0a  ict,.        ],.
+00025140: 2020 2020 2020 2020 6172 6775 6d65 6e74          argument
+00025150: 733a 204f 7074 696f 6e61 6c5b 6469 6374  s: Optional[dict
+00025160: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
+00025170: 2020 6172 7469 6661 6374 5f70 6174 683a    artifact_path:
+00025180: 204f 7074 696f 6e61 6c5b 7374 725d 203d   Optional[str] =
+00025190: 204e 6f6e 652c 0a20 2020 2020 2020 2073   None,.        s
+000251a0: 6f75 7263 653a 204f 7074 696f 6e61 6c5b  ource: Optional[
+000251b0: 7374 725d 203d 204e 6f6e 652c 0a20 2020  str] = None,.   
+000251c0: 2020 2020 2072 756e 5f6e 616d 653a 204f       run_name: O
+000251d0: 7074 696f 6e61 6c5b 7374 725d 203d 204e  ptional[str] = N
+000251e0: 6f6e 652c 0a20 2020 2020 2020 206e 616d  one,.        nam
+000251f0: 6573 7061 6365 3a20 4f70 7469 6f6e 616c  espace: Optional
+00025200: 5b73 7472 5d20 3d20 4e6f 6e65 2c0a 2020  [str] = None,.  
+00025210: 2020 2020 2020 6e6f 7469 6669 6361 7469        notificati
+00025220: 6f6e 733a 206c 6973 745b 6d6c 7275 6e2e  ons: list[mlrun.
+00025230: 6d6f 6465 6c2e 4e6f 7469 6669 6361 7469  model.Notificati
+00025240: 6f6e 5d20 3d20 4e6f 6e65 2c0a 2020 2020  on] = None,.    
+00025250: 2920 2d3e 206d 6c72 756e 2e63 6f6d 6d6f  ) -> mlrun.commo
+00025260: 6e2e 7363 6865 6d61 732e 576f 726b 666c  n.schemas.Workfl
+00025270: 6f77 5265 7370 6f6e 7365 3a0a 2020 2020  owResponse:.    
+00025280: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00025290: 5375 626d 6974 7469 6e67 2077 6f72 6b66  Submitting workf
+000252a0: 6c6f 7720 666f 7220 6120 7265 6d6f 7465  low for a remote
+000252b0: 2065 7865 6375 7469 6f6e 2e0a 0a20 2020   execution...   
+000252c0: 2020 2020 203a 7061 7261 6d20 7072 6f6a       :param proj
+000252d0: 6563 743a 2020 2020 2020 2020 2070 726f  ect:         pro
+000252e0: 6a65 6374 206e 616d 650a 2020 2020 2020  ject name.      
+000252f0: 2020 3a70 6172 616d 206e 616d 653a 2020    :param name:  
+00025300: 2020 2020 2020 2020 2020 776f 726b 666c            workfl
+00025310: 6f77 206e 616d 650a 2020 2020 2020 2020  ow name.        
+00025320: 3a70 6172 616d 2077 6f72 6b66 6c6f 775f  :param workflow_
+00025330: 7370 6563 3a20 2020 7468 6520 776f 726b  spec:   the work
+00025340: 666c 6f77 2073 7065 6320 746f 2065 7865  flow spec to exe
+00025350: 6375 7465 0a20 2020 2020 2020 203a 7061  cute.        :pa
+00025360: 7261 6d20 6172 6775 6d65 6e74 733a 2020  ram arguments:  
+00025370: 2020 2020 2061 7267 756d 656e 7473 2066       arguments f
+00025380: 6f72 2074 6865 2077 6f72 6b66 6c6f 770a  or the workflow.
+00025390: 2020 2020 2020 2020 3a70 6172 616d 2061          :param a
+000253a0: 7274 6966 6163 745f 7061 7468 3a20 2020  rtifact_path:   
+000253b0: 6172 7469 6661 6374 2074 6172 6765 7420  artifact target 
+000253c0: 7061 7468 206f 6620 7468 6520 776f 726b  path of the work
+000253d0: 666c 6f77 0a20 2020 2020 2020 203a 7061  flow.        :pa
+000253e0: 7261 6d20 736f 7572 6365 3a20 2020 2020  ram source:     
+000253f0: 2020 2020 2073 6f75 7263 6520 7572 6c20       source url 
+00025400: 6f66 2074 6865 2070 726f 6a65 6374 0a20  of the project. 
+00025410: 2020 2020 2020 203a 7061 7261 6d20 7275         :param ru
+00025420: 6e5f 6e61 6d65 3a20 2020 2020 2020 2072  n_name:        r
+00025430: 756e 206e 616d 6520 746f 206f 7665 7272  un name to overr
+00025440: 6964 6520 7468 6520 6465 6661 756c 743a  ide the default:
+00025450: 2027 776f 726b 666c 6f77 2d72 756e 6e65   'workflow-runne
+00025460: 722d 3c77 6f72 6b66 6c6f 7720 6e61 6d65  r-<workflow name
+00025470: 3e27 0a20 2020 2020 2020 203a 7061 7261  >'.        :para
+00025480: 6d20 6e61 6d65 7370 6163 653a 2020 2020  m namespace:    
+00025490: 2020 206b 7562 6572 6e65 7465 7320 6e61     kubernetes na
+000254a0: 6d65 7370 6163 6520 6966 206f 7468 6572  mespace if other
+000254b0: 2074 6861 6e20 6465 6661 756c 740a 2020   than default.  
+000254c0: 2020 2020 2020 3a70 6172 616d 206e 6f74        :param not
+000254d0: 6966 6963 6174 696f 6e73 3a20 2020 6c69  ifications:   li
+000254e0: 7374 206f 6620 6e6f 7469 6669 6361 7469  st of notificati
+000254f0: 6f6e 7320 746f 2073 656e 6420 7768 656e  ons to send when
+00025500: 2077 6f72 6b66 6c6f 7720 6578 6563 7574   workflow execut
+00025510: 696f 6e20 6973 2063 6f6d 706c 6574 6564  ion is completed
+00025520: 0a0a 2020 2020 2020 2020 3a72 6574 7572  ..        :retur
+00025530: 6e73 3a20 2020 203a 7079 3a63 6c61 7373  ns:    :py:class
+00025540: 3a60 7e6d 6c72 756e 2e63 6f6d 6d6f 6e2e  :`~mlrun.common.
+00025550: 7363 6865 6d61 732e 576f 726b 666c 6f77  schemas.Workflow
+00025560: 5265 7370 6f6e 7365 602e 0a20 2020 2020  Response`..     
+00025570: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
+00025580: 6d61 6765 203d 2028 0a20 2020 2020 2020  mage = (.       
+00025590: 2020 2020 2077 6f72 6b66 6c6f 775f 7370       workflow_sp
+000255a0: 6563 2e69 6d61 6765 0a20 2020 2020 2020  ec.image.       
+000255b0: 2020 2020 2069 6620 6861 7361 7474 7228       if hasattr(
+000255c0: 776f 726b 666c 6f77 5f73 7065 632c 2022  workflow_spec, "
+000255d0: 696d 6167 6522 290a 2020 2020 2020 2020  image").        
+000255e0: 2020 2020 656c 7365 2077 6f72 6b66 6c6f      else workflo
+000255f0: 775f 7370 6563 2e67 6574 2822 696d 6167  w_spec.get("imag
+00025600: 6522 2c20 4e6f 6e65 290a 2020 2020 2020  e", None).      
+00025610: 2020 290a 2020 2020 2020 2020 776f 726b    ).        work
+00025620: 666c 6f77 5f6e 616d 6520 3d20 6e61 6d65  flow_name = name
+00025630: 206f 7220 280a 2020 2020 2020 2020 2020   or (.          
+00025640: 2020 776f 726b 666c 6f77 5f73 7065 632e    workflow_spec.
+00025650: 6e61 6d65 0a20 2020 2020 2020 2020 2020  name.           
+00025660: 2069 6620 6861 7361 7474 7228 776f 726b   if hasattr(work
+00025670: 666c 6f77 5f73 7065 632c 2022 6e61 6d65  flow_spec, "name
+00025680: 2229 0a20 2020 2020 2020 2020 2020 2065  ").            e
+00025690: 6c73 6520 776f 726b 666c 6f77 5f73 7065  lse workflow_spe
+000256a0: 632e 6765 7428 226e 616d 6522 2c20 4e6f  c.get("name", No
+000256b0: 6e65 290a 2020 2020 2020 2020 290a 2020  ne).        ).  
+000256c0: 2020 2020 2020 7265 7120 3d20 7b0a 2020        req = {.  
+000256d0: 2020 2020 2020 2020 2020 2261 7267 756d            "argum
+000256e0: 656e 7473 223a 2061 7267 756d 656e 7473  ents": arguments
+000256f0: 2c0a 2020 2020 2020 2020 2020 2020 2261  ,.            "a
+00025700: 7274 6966 6163 745f 7061 7468 223a 2061  rtifact_path": a
+00025710: 7274 6966 6163 745f 7061 7468 2c0a 2020  rtifact_path,.  
+00025720: 2020 2020 2020 2020 2020 2273 6f75 7263            "sourc
+00025730: 6522 3a20 736f 7572 6365 2c0a 2020 2020  e": source,.    
+00025740: 2020 2020 2020 2020 2272 756e 5f6e 616d          "run_nam
+00025750: 6522 3a20 7275 6e5f 6e61 6d65 2c0a 2020  e": run_name,.  
+00025760: 2020 2020 2020 2020 2020 226e 616d 6573            "names
+00025770: 7061 6365 223a 206e 616d 6573 7061 6365  pace": namespace
+00025780: 2c0a 2020 2020 2020 2020 7d0a 2020 2020  ,.        }.    
+00025790: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+000257a0: 6528 0a20 2020 2020 2020 2020 2020 2077  e(.            w
+000257b0: 6f72 6b66 6c6f 775f 7370 6563 2c0a 2020  orkflow_spec,.  
+000257c0: 2020 2020 2020 2020 2020 6d6c 7275 6e2e            mlrun.
+000257d0: 636f 6d6d 6f6e 2e73 6368 656d 6173 2e57  common.schemas.W
+000257e0: 6f72 6b66 6c6f 7753 7065 632c 0a20 2020  orkflowSpec,.   
+000257f0: 2020 2020 2029 3a0a 2020 2020 2020 2020       ):.        
+00025800: 2020 2020 7265 715b 2273 7065 6322 5d20      req["spec"] 
+00025810: 3d20 776f 726b 666c 6f77 5f73 7065 632e  = workflow_spec.
+00025820: 6469 6374 2829 0a20 2020 2020 2020 2065  dict().        e
+00025830: 6c69 6620 6973 696e 7374 616e 6365 2877  lif isinstance(w
+00025840: 6f72 6b66 6c6f 775f 7370 6563 2c20 6d6c  orkflow_spec, ml
+00025850: 7275 6e2e 7072 6f6a 6563 7473 2e70 6970  run.projects.pip
+00025860: 656c 696e 6573 2e57 6f72 6b66 6c6f 7753  elines.WorkflowS
+00025870: 7065 6329 3a0a 2020 2020 2020 2020 2020  pec):.          
+00025880: 2020 7265 715b 2273 7065 6322 5d20 3d20    req["spec"] = 
+00025890: 776f 726b 666c 6f77 5f73 7065 632e 746f  workflow_spec.to
+000258a0: 5f64 6963 7428 290a 2020 2020 2020 2020  _dict().        
+000258b0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+000258c0: 2020 7265 715b 2273 7065 6322 5d20 3d20    req["spec"] = 
+000258d0: 776f 726b 666c 6f77 5f73 7065 630a 2020  workflow_spec.  
+000258e0: 2020 2020 2020 7265 715b 2273 7065 6322        req["spec"
+000258f0: 5d5b 2269 6d61 6765 225d 203d 2069 6d61  ]["image"] = ima
+00025900: 6765 0a20 2020 2020 2020 2072 6571 5b22  ge.        req["
+00025910: 7370 6563 225d 5b22 6e61 6d65 225d 203d  spec"]["name"] =
+00025920: 2077 6f72 6b66 6c6f 775f 6e61 6d65 0a20   workflow_name. 
+00025930: 2020 2020 2020 2069 6620 6e6f 7469 6669         if notifi
+00025940: 6361 7469 6f6e 733a 0a20 2020 2020 2020  cations:.       
+00025950: 2020 2020 2072 6571 5b22 6e6f 7469 6669       req["notifi
+00025960: 6361 7469 6f6e 7322 5d20 3d20 5b0a 2020  cations"] = [.  
+00025970: 2020 2020 2020 2020 2020 2020 2020 6e6f                no
+00025980: 7469 6669 6361 7469 6f6e 2e74 6f5f 6469  tification.to_di
+00025990: 6374 2829 2066 6f72 206e 6f74 6966 6963  ct() for notific
+000259a0: 6174 696f 6e20 696e 206e 6f74 6966 6963  ation in notific
+000259b0: 6174 696f 6e73 0a20 2020 2020 2020 2020  ations.         
+000259c0: 2020 205d 0a0a 2020 2020 2020 2020 7265     ]..        re
+000259d0: 7370 6f6e 7365 203d 2073 656c 662e 6170  sponse = self.ap
+000259e0: 695f 6361 6c6c 280a 2020 2020 2020 2020  i_call(.        
+000259f0: 2020 2020 2250 4f53 5422 2c0a 2020 2020      "POST",.    
+00025a00: 2020 2020 2020 2020 6622 7072 6f6a 6563          f"projec
+00025a10: 7473 2f7b 7072 6f6a 6563 747d 2f77 6f72  ts/{project}/wor
+00025a20: 6b66 6c6f 7773 2f7b 776f 726b 666c 6f77  kflows/{workflow
+00025a30: 5f6e 616d 657d 2f73 7562 6d69 7422 2c0a  _name}/submit",.
+00025a40: 2020 2020 2020 2020 2020 2020 6a73 6f6e              json
+00025a50: 3d72 6571 2c0a 2020 2020 2020 2020 290a  =req,.        ).
+00025a60: 2020 2020 2020 2020 7265 7475 726e 206d          return m
+00025a70: 6c72 756e 2e63 6f6d 6d6f 6e2e 7363 6865  lrun.common.sche
+00025a80: 6d61 732e 576f 726b 666c 6f77 5265 7370  mas.WorkflowResp
+00025a90: 6f6e 7365 282a 2a72 6573 706f 6e73 652e  onse(**response.
+00025aa0: 6a73 6f6e 2829 290a 0a20 2020 2064 6566  json())..    def
+00025ab0: 2067 6574 5f77 6f72 6b66 6c6f 775f 6964   get_workflow_id
+00025ac0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+00025ad0: 2020 2020 2020 2020 7072 6f6a 6563 743a          project:
+00025ae0: 2073 7472 2c0a 2020 2020 2020 2020 6e61   str,.        na
+00025af0: 6d65 3a20 7374 722c 0a20 2020 2020 2020  me: str,.       
+00025b00: 2072 756e 5f69 643a 2073 7472 2c0a 2020   run_id: str,.  
+00025b10: 2020 2020 2020 656e 6769 6e65 3a20 7374        engine: st
+00025b20: 7220 3d20 2222 2c0a 2020 2020 293a 0a20  r = "",.    ):. 
+00025b30: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00025b40: 2020 2052 6574 7269 6576 6520 776f 726b     Retrieve work
+00025b50: 666c 6f77 2069 6420 6672 6f6d 2074 6865  flow id from the
+00025b60: 2075 6964 206f 6620 7468 6520 776f 726b   uid of the work
+00025b70: 666c 6f77 2072 756e 6e65 722e 0a0a 2020  flow runner...  
+00025b80: 2020 2020 2020 3a70 6172 616d 2070 726f        :param pro
+00025b90: 6a65 6374 3a20 7072 6f6a 6563 7420 6e61  ject: project na
+00025ba0: 6d65 0a20 2020 2020 2020 203a 7061 7261  me.        :para
+00025bb0: 6d20 6e61 6d65 3a20 2020 2077 6f72 6b66  m name:    workf
+00025bc0: 6c6f 7720 6e61 6d65 0a20 2020 2020 2020  low name.       
+00025bd0: 203a 7061 7261 6d20 7275 6e5f 6964 3a20   :param run_id: 
+00025be0: 2074 6865 2069 6420 6f66 2074 6865 2077   the id of the w
+00025bf0: 6f72 6b66 6c6f 7720 7275 6e6e 6572 202d  orkflow runner -
+00025c00: 2074 6865 206a 6f62 2074 6861 7420 7275   the job that ru
+00025c10: 6e73 2074 6865 2077 6f72 6b66 6c6f 770a  ns the workflow.
+00025c20: 2020 2020 2020 2020 3a70 6172 616d 2065          :param e
+00025c30: 6e67 696e 653a 2020 7069 7065 6c69 6e65  ngine:  pipeline
+00025c40: 2072 756e 6e65 720a 0a20 2020 2020 2020   runner..       
+00025c50: 203a 7265 7475 726e 733a 2020 203a 7079   :returns:   :py
+00025c60: 3a63 6c61 7373 3a60 7e6d 6c72 756e 2e63  :class:`~mlrun.c
+00025c70: 6f6d 6d6f 6e2e 7363 6865 6d61 732e 4765  ommon.schemas.Ge
+00025c80: 7457 6f72 6b66 6c6f 7752 6573 706f 6e73  tWorkflowRespons
+00025c90: 6560 2e0a 2020 2020 2020 2020 2222 220a  e`..        """.
+00025ca0: 2020 2020 2020 2020 7061 7261 6d73 203d          params =
+00025cb0: 207b 7d0a 2020 2020 2020 2020 6966 2065   {}.        if e
+00025cc0: 6e67 696e 653a 0a20 2020 2020 2020 2020  ngine:.         
+00025cd0: 2020 2070 6172 616d 735b 2265 6e67 696e     params["engin
+00025ce0: 6522 5d20 3d20 656e 6769 6e65 0a20 2020  e"] = engine.   
+00025cf0: 2020 2020 2072 6573 706f 6e73 6520 3d20       response = 
+00025d00: 7365 6c66 2e61 7069 5f63 616c 6c28 0a20  self.api_call(. 
+00025d10: 2020 2020 2020 2020 2020 2022 4745 5422             "GET"
+00025d20: 2c0a 2020 2020 2020 2020 2020 2020 6622  ,.            f"
+00025d30: 7072 6f6a 6563 7473 2f7b 7072 6f6a 6563  projects/{projec
+00025d40: 747d 2f77 6f72 6b66 6c6f 7773 2f7b 6e61  t}/workflows/{na
+00025d50: 6d65 7d2f 7275 6e73 2f7b 7275 6e5f 6964  me}/runs/{run_id
+00025d60: 7d22 2c0a 2020 2020 2020 2020 2020 2020  }",.            
+00025d70: 7061 7261 6d73 3d70 6172 616d 732c 0a20  params=params,. 
+00025d80: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00025d90: 2072 6574 7572 6e20 6d6c 7275 6e2e 636f   return mlrun.co
+00025da0: 6d6d 6f6e 2e73 6368 656d 6173 2e47 6574  mmon.schemas.Get
+00025db0: 576f 726b 666c 6f77 5265 7370 6f6e 7365  WorkflowResponse
+00025dc0: 282a 2a72 6573 706f 6e73 652e 6a73 6f6e  (**response.json
+00025dd0: 2829 290a 0a20 2020 2064 6566 206c 6f61  ())..    def loa
+00025de0: 645f 7072 6f6a 6563 7428 0a20 2020 2020  d_project(.     
+00025df0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+00025e00: 206e 616d 653a 2073 7472 2c0a 2020 2020   name: str,.    
+00025e10: 2020 2020 7572 6c3a 2073 7472 2c0a 2020      url: str,.  
+00025e20: 2020 2020 2020 7365 6372 6574 733a 204f        secrets: O
+00025e30: 7074 696f 6e61 6c5b 6469 6374 5d20 3d20  ptional[dict] = 
+00025e40: 4e6f 6e65 2c0a 2020 2020 2020 2020 7361  None,.        sa
+00025e50: 7665 5f73 6563 7265 7473 3a20 626f 6f6c  ve_secrets: bool
+00025e60: 203d 2054 7275 652c 0a20 2020 2029 202d   = True,.    ) -
+00025e70: 3e20 7374 723a 0a20 2020 2020 2020 2022  > str:.        "
+00025e80: 2222 0a20 2020 2020 2020 204c 6f61 6469  "".        Loadi
+00025e90: 6e67 2061 2070 726f 6a65 6374 2072 656d  ng a project rem
+00025ea0: 6f74 656c 7920 6672 6f6d 2074 6865 2067  otely from the g
+00025eb0: 6976 656e 2073 6f75 7263 652e 0a20 2020  iven source..   
+00025ec0: 2020 2020 203a 7061 7261 6d20 6e61 6d65       :param name
+00025ed0: 3a20 2020 2070 726f 6a65 6374 206e 616d  :    project nam
+00025ee0: 650a 2020 2020 2020 2020 3a70 6172 616d  e.        :param
+00025ef0: 2075 726c 3a20 2020 2020 6769 7420 6f72   url:     git or
+00025f00: 2074 6172 2e67 7a20 6f72 202e 7a69 7020   tar.gz or .zip 
+00025f10: 736f 7572 6365 7320 6172 6368 6976 6520  sources archive 
+00025f20: 7061 7468 2065 2e67 2e3a 0a20 2020 2020  path e.g.:.     
+00025f30: 2020 2067 6974 3a2f 2f67 6974 6875 622e     git://github.
+00025f40: 636f 6d2f 6d6c 7275 6e2f 6465 6d6f 2d78  com/mlrun/demo-x
+00025f50: 6762 2d70 726f 6a65 6374 2e67 6974 0a20  gb-project.git. 
+00025f60: 2020 2020 2020 2068 7474 703a 2f2f 6d79         http://my
+00025f70: 7369 7465 2f61 7263 6869 7665 642d 7072  site/archived-pr
+00025f80: 6f6a 6563 742e 7a69 700a 2020 2020 2020  oject.zip.      
+00025f90: 2020 5468 6520 6769 7420 7072 6f6a 6563    The git projec
+00025fa0: 7420 7368 6f75 6c64 2069 6e63 6c75 6465  t should include
+00025fb0: 2074 6865 2070 726f 6a65 6374 2079 616d   the project yam
+00025fc0: 6c20 6669 6c65 2e0a 2020 2020 2020 2020  l file..        
+00025fd0: 3a70 6172 616d 2073 6563 7265 7473 3a20  :param secrets: 
+00025fe0: 2020 2020 2020 2020 5365 6372 6574 7320          Secrets 
+00025ff0: 746f 2073 746f 7265 2069 6e20 7072 6f6a  to store in proj
+00026000: 6563 7420 696e 206f 7264 6572 2074 6f20  ect in order to 
+00026010: 6c6f 6164 2069 7420 6672 6f6d 2074 6865  load it from the
+00026020: 2070 726f 7669 6465 6420 7572 6c2e 2046   provided url. F
+00026030: 6f72 206d 6f72 650a 2020 2020 2020 2020  or more.        
+00026040: 696e 666f 726d 6174 696f 6e20 7365 6520  information see 
+00026050: 3a70 793a 6675 6e63 3a60 6d6c 7275 6e2e  :py:func:`mlrun.
+00026060: 6c6f 6164 5f70 726f 6a65 6374 6020 6675  load_project` fu
+00026070: 6e63 7469 6f6e 2e0a 2020 2020 2020 2020  nction..        
+00026080: 3a70 6172 616d 2073 6176 655f 7365 6372  :param save_secr
+00026090: 6574 733a 2020 2020 5768 6574 6865 7220  ets:    Whether 
+000260a0: 746f 2073 746f 7265 2073 6563 7265 7473  to store secrets
+000260b0: 2069 6e20 7468 6520 6c6f 6164 6564 2070   in the loaded p
+000260c0: 726f 6a65 6374 2e20 5365 7474 696e 6720  roject. Setting 
+000260d0: 746f 2046 616c 7365 2077 696c 6c20 6361  to False will ca
+000260e0: 7573 6520 7761 6974 696e 670a 2020 2020  use waiting.    
+000260f0: 2020 2020 666f 7220 7468 6520 7072 6f63      for the proc
+00026100: 6573 7320 636f 6d70 6c65 7469 6f6e 2e0a  ess completion..
+00026110: 0a20 2020 2020 2020 203a 7265 7475 726e  .        :return
+00026120: 733a 2020 2020 2020 2020 2020 2020 2020  s:              
+00026130: 2054 6865 2074 6572 6d69 6e61 6c20 7374   The terminal st
+00026140: 6174 6520 6f66 206c 6f61 6420 7072 6f6a  ate of load proj
+00026150: 6563 7420 7072 6f63 6573 732e 0a20 2020  ect process..   
+00026160: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00026170: 2070 6172 616d 7320 3d20 7b22 7572 6c22   params = {"url"
+00026180: 3a20 7572 6c7d 0a20 2020 2020 2020 2062  : url}.        b
+00026190: 6f64 7920 3d20 4e6f 6e65 0a20 2020 2020  ody = None.     
+000261a0: 2020 2069 6620 7365 6372 6574 733a 0a20     if secrets:. 
+000261b0: 2020 2020 2020 2020 2020 2070 726f 7669             provi
+000261c0: 6465 7220 3d20 6d6c 7275 6e2e 636f 6d6d  der = mlrun.comm
+000261d0: 6f6e 2e73 6368 656d 6173 2e53 6563 7265  on.schemas.Secre
+000261e0: 7450 726f 7669 6465 724e 616d 652e 6b75  tProviderName.ku
+000261f0: 6265 726e 6574 6573 0a20 2020 2020 2020  bernetes.       
+00026200: 2020 2020 2073 6563 7265 7473 5f69 6e70       secrets_inp
+00026210: 7574 203d 206d 6c72 756e 2e63 6f6d 6d6f  ut = mlrun.commo
+00026220: 6e2e 7363 6865 6d61 732e 5365 6372 6574  n.schemas.Secret
+00026230: 7344 6174 6128 0a20 2020 2020 2020 2020  sData(.         
+00026240: 2020 2020 2020 2070 726f 7669 6465 723d         provider=
+00026250: 7072 6f76 6964 6572 2c20 7365 6372 6574  provider, secret
+00026260: 733d 7365 6372 6574 730a 2020 2020 2020  s=secrets.      
+00026270: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00026280: 2020 2020 626f 6479 203d 2073 6563 7265      body = secre
+00026290: 7473 5f69 6e70 7574 2e64 6963 7428 290a  ts_input.dict().
+000262a0: 2020 2020 2020 2020 7265 7370 6f6e 7365          response
+000262b0: 203d 2073 656c 662e 6170 695f 6361 6c6c   = self.api_call
+000262c0: 280a 2020 2020 2020 2020 2020 2020 2250  (.            "P
+000262d0: 4f53 5422 2c20 6622 7072 6f6a 6563 7473  OST", f"projects
+000262e0: 2f7b 6e61 6d65 7d2f 6c6f 6164 222c 2070  /{name}/load", p
+000262f0: 6172 616d 733d 7061 7261 6d73 2c20 626f  arams=params, bo
+00026300: 6479 3d64 6963 745f 746f 5f6a 736f 6e28  dy=dict_to_json(
+00026310: 626f 6479 290a 2020 2020 2020 2020 290a  body).        ).
+00026320: 2020 2020 2020 2020 7265 7370 6f6e 7365          response
+00026330: 203d 2072 6573 706f 6e73 652e 6a73 6f6e   = response.json
+00026340: 2829 0a20 2020 2020 2020 2072 756e 203d  ().        run =
+00026350: 206d 6c72 756e 2e52 756e 4f62 6a65 6374   mlrun.RunObject
+00026360: 2e66 726f 6d5f 6469 6374 2872 6573 706f  .from_dict(respo
+00026370: 6e73 655b 2264 6174 6122 5d29 0a20 2020  nse["data"]).   
+00026380: 2020 2020 2073 7461 7465 2c20 5f20 3d20       state, _ = 
+00026390: 7275 6e2e 6c6f 6773 2829 0a0a 2020 2020  run.logs()..    
+000263a0: 2020 2020 6966 2073 6563 7265 7473 2061      if secrets a
+000263b0: 6e64 206e 6f74 2073 6176 655f 7365 6372  nd not save_secr
+000263c0: 6574 733a 0a20 2020 2020 2020 2020 2020  ets:.           
+000263d0: 2073 656c 662e 6465 6c65 7465 5f70 726f   self.delete_pro
+000263e0: 6a65 6374 5f73 6563 7265 7473 2870 726f  ject_secrets(pro
+000263f0: 6a65 6374 3d6e 616d 652c 2073 6563 7265  ject=name, secre
+00026400: 7473 3d6c 6973 7428 7365 6372 6574 732e  ts=list(secrets.
+00026410: 6b65 7973 2829 2929 0a20 2020 2020 2020  keys())).       
+00026420: 2020 2020 2069 6620 7374 6174 6520 213d       if state !=
+00026430: 2022 636f 6d70 6c65 7465 6422 3a0a 2020   "completed":.  
+00026440: 2020 2020 2020 2020 2020 2020 2020 6c6f                lo
+00026450: 6767 6572 2e65 7272 6f72 2822 4c6f 6164  gger.error("Load
+00026460: 2070 726f 6a65 6374 2074 6173 6b20 6661   project task fa
+00026470: 696c 6564 2c20 6465 6c65 7469 6e67 2070  iled, deleting p
+00026480: 726f 6a65 6374 2229 0a20 2020 2020 2020  roject").       
+00026490: 2020 2020 2020 2020 2073 656c 662e 6465           self.de
+000264a0: 6c65 7465 5f70 726f 6a65 6374 286e 616d  lete_project(nam
+000264b0: 652c 206d 6c72 756e 2e63 6f6d 6d6f 6e2e  e, mlrun.common.
+000264c0: 7363 6865 6d61 732e 4465 6c65 7469 6f6e  schemas.Deletion
+000264d0: 5374 7261 7465 6779 2e63 6173 6361 6465  Strategy.cascade
+000264e0: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
+000264f0: 6e20 7374 6174 650a 0a20 2020 2064 6566  n state..    def
+00026500: 2067 6574 5f64 6174 6173 746f 7265 5f70   get_datastore_p
+00026510: 726f 6669 6c65 280a 2020 2020 2020 2020  rofile(.        
+00026520: 7365 6c66 2c20 6e61 6d65 3a20 7374 722c  self, name: str,
+00026530: 2070 726f 6a65 6374 3a20 7374 720a 2020   project: str.  
+00026540: 2020 2920 2d3e 204f 7074 696f 6e61 6c5b    ) -> Optional[
+00026550: 6d6c 7275 6e2e 636f 6d6d 6f6e 2e73 6368  mlrun.common.sch
+00026560: 656d 6173 2e44 6174 6173 746f 7265 5072  emas.DatastorePr
+00026570: 6f66 696c 655d 3a0a 2020 2020 2020 2020  ofile]:.        
+00026580: 7072 6f6a 6563 7420 3d20 7072 6f6a 6563  project = projec
+00026590: 7420 6f72 2063 6f6e 6669 672e 6465 6661  t or config.defa
+000265a0: 756c 745f 7072 6f6a 6563 740a 2020 2020  ult_project.    
+000265b0: 2020 2020 5f70 6174 6820 3d20 7365 6c66      _path = self
+000265c0: 2e5f 7061 7468 5f6f 6628 2264 6174 6173  ._path_of("datas
+000265d0: 746f 7265 2d70 726f 6669 6c65 7322 2c20  tore-profiles", 
+000265e0: 7072 6f6a 6563 742c 206e 616d 6529 0a0a  project, name)..
+000265f0: 2020 2020 2020 2020 7265 7320 3d20 7365          res = se
+00026600: 6c66 2e61 7069 5f63 616c 6c28 6d65 7468  lf.api_call(meth
+00026610: 6f64 3d22 4745 5422 2c20 7061 7468 3d5f  od="GET", path=_
+00026620: 7061 7468 290a 2020 2020 2020 2020 6966  path).        if
+00026630: 2072 6573 3a0a 2020 2020 2020 2020 2020   res:.          
+00026640: 2020 7075 626c 6963 5f77 7261 7070 6572    public_wrapper
+00026650: 203d 2072 6573 2e6a 736f 6e28 290a 2020   = res.json().  
+00026660: 2020 2020 2020 2020 2020 6461 7461 7374            datast
+00026670: 6f72 6520 3d20 4461 7461 7374 6f72 6550  ore = DatastoreP
+00026680: 726f 6669 6c65 324a 736f 6e2e 6372 6561  rofile2Json.crea
+00026690: 7465 5f66 726f 6d5f 6a73 6f6e 280a 2020  te_from_json(.  
+000266a0: 2020 2020 2020 2020 2020 2020 2020 7075                pu
+000266b0: 626c 6963 5f6a 736f 6e3d 7075 626c 6963  blic_json=public
+000266c0: 5f77 7261 7070 6572 5b22 6f62 6a65 6374  _wrapper["object
+000266d0: 225d 0a20 2020 2020 2020 2020 2020 2029  "].            )
+000266e0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+000266f0: 7572 6e20 6461 7461 7374 6f72 650a 2020  urn datastore.  
+00026700: 2020 2020 2020 7265 7475 726e 204e 6f6e        return Non
+00026710: 650a 0a20 2020 2064 6566 2064 656c 6574  e..    def delet
+00026720: 655f 6461 7461 7374 6f72 655f 7072 6f66  e_datastore_prof
+00026730: 696c 6528 7365 6c66 2c20 6e61 6d65 3a20  ile(self, name: 
+00026740: 7374 722c 2070 726f 6a65 6374 3a20 7374  str, project: st
+00026750: 7229 3a0a 2020 2020 2020 2020 7072 6f6a  r):.        proj
+00026760: 6563 7420 3d20 7072 6f6a 6563 7420 6f72  ect = project or
+00026770: 2063 6f6e 6669 672e 6465 6661 756c 745f   config.default_
+00026780: 7072 6f6a 6563 740a 2020 2020 2020 2020  project.        
+00026790: 5f70 6174 6820 3d20 7365 6c66 2e5f 7061  _path = self._pa
+000267a0: 7468 5f6f 6628 2264 6174 6173 746f 7265  th_of("datastore
+000267b0: 2d70 726f 6669 6c65 7322 2c20 7072 6f6a  -profiles", proj
+000267c0: 6563 742c 206e 616d 6529 0a20 2020 2020  ect, name).     
+000267d0: 2020 2073 656c 662e 6170 695f 6361 6c6c     self.api_call
+000267e0: 286d 6574 686f 643d 2244 454c 4554 4522  (method="DELETE"
+000267f0: 2c20 7061 7468 3d5f 7061 7468 290a 2020  , path=_path).  
+00026800: 2020 2020 2020 7265 7475 726e 204e 6f6e        return Non
+00026810: 650a 0a20 2020 2064 6566 206c 6973 745f  e..    def list_
+00026820: 6461 7461 7374 6f72 655f 7072 6f66 696c  datastore_profil
+00026830: 6573 280a 2020 2020 2020 2020 7365 6c66  es(.        self
+00026840: 2c20 7072 6f6a 6563 743a 2073 7472 0a20  , project: str. 
+00026850: 2020 2029 202d 3e20 6c69 7374 5b6d 6c72     ) -> list[mlr
+00026860: 756e 2e63 6f6d 6d6f 6e2e 7363 6865 6d61  un.common.schema
+00026870: 732e 4461 7461 7374 6f72 6550 726f 6669  s.DatastoreProfi
+00026880: 6c65 5d3a 0a20 2020 2020 2020 2070 726f  le]:.        pro
+00026890: 6a65 6374 203d 2070 726f 6a65 6374 206f  ject = project o
+000268a0: 7220 636f 6e66 6967 2e64 6566 6175 6c74  r config.default
+000268b0: 5f70 726f 6a65 6374 0a20 2020 2020 2020  _project.       
+000268c0: 205f 7061 7468 203d 2073 656c 662e 5f70   _path = self._p
+000268d0: 6174 685f 6f66 2822 6461 7461 7374 6f72  ath_of("datastor
+000268e0: 652d 7072 6f66 696c 6573 222c 2070 726f  e-profiles", pro
+000268f0: 6a65 6374 290a 0a20 2020 2020 2020 2072  ject)..        r
+00026900: 6573 203d 2073 656c 662e 6170 695f 6361  es = self.api_ca
+00026910: 6c6c 286d 6574 686f 643d 2247 4554 222c  ll(method="GET",
+00026920: 2070 6174 683d 5f70 6174 6829 0a20 2020   path=_path).   
+00026930: 2020 2020 2069 6620 7265 733a 0a20 2020       if res:.   
+00026940: 2020 2020 2020 2020 2070 7562 6c69 635f           public_
+00026950: 7772 6170 7065 7220 3d20 7265 732e 6a73  wrapper = res.js
+00026960: 6f6e 2829 0a20 2020 2020 2020 2020 2020  on().           
+00026970: 2064 6174 6173 746f 7265 7320 3d20 5b0a   datastores = [.
+00026980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026990: 4461 7461 7374 6f72 6550 726f 6669 6c65  DatastoreProfile
+000269a0: 324a 736f 6e2e 6372 6561 7465 5f66 726f  2Json.create_fro
+000269b0: 6d5f 6a73 6f6e 2878 5b22 6f62 6a65 6374  m_json(x["object
+000269c0: 225d 290a 2020 2020 2020 2020 2020 2020  "]).            
+000269d0: 2020 2020 666f 7220 7820 696e 2070 7562      for x in pub
+000269e0: 6c69 635f 7772 6170 7065 720a 2020 2020  lic_wrapper.    
+000269f0: 2020 2020 2020 2020 5d0a 2020 2020 2020          ].      
+00026a00: 2020 2020 2020 7265 7475 726e 2064 6174        return dat
+00026a10: 6173 746f 7265 730a 2020 2020 2020 2020  astores.        
+00026a20: 7265 7475 726e 204e 6f6e 650a 0a20 2020  return None..   
+00026a30: 2064 6566 2073 746f 7265 5f64 6174 6173   def store_datas
+00026a40: 746f 7265 5f70 726f 6669 6c65 280a 2020  tore_profile(.  
+00026a50: 2020 2020 2020 7365 6c66 2c20 7072 6f66        self, prof
+00026a60: 696c 653a 206d 6c72 756e 2e63 6f6d 6d6f  ile: mlrun.commo
+00026a70: 6e2e 7363 6865 6d61 732e 4461 7461 7374  n.schemas.Datast
+00026a80: 6f72 6550 726f 6669 6c65 2c20 7072 6f6a  oreProfile, proj
+00026a90: 6563 743a 2073 7472 0a20 2020 2029 3a0a  ect: str.    ):.
+00026aa0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00026ab0: 2020 2020 4372 6561 7465 206f 7220 7265      Create or re
+00026ac0: 706c 6163 6520 6120 6461 7461 7374 6f72  place a datastor
+00026ad0: 6520 7072 6f66 696c 652e 0a20 2020 2020  e profile..     
+00026ae0: 2020 203a 7265 7475 726e 733a 204e 6f6e     :returns: Non
+00026af0: 650a 2020 2020 2020 2020 2222 220a 2020  e.        """.  
+00026b00: 2020 2020 2020 7072 6f6a 6563 7420 3d20        project = 
+00026b10: 7072 6f6a 6563 7420 6f72 2063 6f6e 6669  project or confi
+00026b20: 672e 6465 6661 756c 745f 7072 6f6a 6563  g.default_projec
+00026b30: 740a 2020 2020 2020 2020 5f70 6174 6820  t.        _path 
+00026b40: 3d20 7365 6c66 2e5f 7061 7468 5f6f 6628  = self._path_of(
+00026b50: 2264 6174 6173 746f 7265 2d70 726f 6669  "datastore-profi
+00026b60: 6c65 7322 2c20 7072 6f6a 6563 7429 0a0a  les", project)..
+00026b70: 2020 2020 2020 2020 7365 6c66 2e61 7069          self.api
+00026b80: 5f63 616c 6c28 6d65 7468 6f64 3d22 5055  _call(method="PU
+00026b90: 5422 2c20 7061 7468 3d5f 7061 7468 2c20  T", path=_path, 
+00026ba0: 6a73 6f6e 3d70 726f 6669 6c65 2e64 6963  json=profile.dic
+00026bb0: 7428 2929 0a0a 0a64 6566 205f 6173 5f6a  t())...def _as_j
+00026bc0: 736f 6e28 6f62 6a29 3a0a 2020 2020 666e  son(obj):.    fn
+00026bd0: 203d 2067 6574 6174 7472 286f 626a 2c20   = getattr(obj, 
+00026be0: 2274 6f5f 6a73 6f6e 222c 204e 6f6e 6529  "to_json", None)
+00026bf0: 0a20 2020 2069 6620 666e 3a0a 2020 2020  .    if fn:.    
+00026c00: 2020 2020 7265 7475 726e 2066 6e28 290a      return fn().
+00026c10: 2020 2020 7265 7475 726e 2064 6963 745f      return dict_
+00026c20: 746f 5f6a 736f 6e28 6f62 6a29 0a         to_json(obj).
```

## mlrun/db/nopdb.py

```diff
@@ -515,14 +515,17 @@
 
     def list_api_gateways(self, project=None):
         pass
 
     def get_api_gateway(self, name, project=None):
         pass
 
+    def delete_api_gateway(self, name, project=None):
+        pass
+
     def verify_authorization(
         self,
         authorization_verification_input: mlrun.common.schemas.AuthorizationVerificationInput,
     ):
         pass
 
     def get_datastore_profile(
```

## mlrun/model_monitoring/__init__.py

```diff
@@ -11,11 +11,11 @@
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 #
 # flake8: noqa  - this is until we take care of the F401 violations with respect to __all__ & sphinx
 # for backwards compatibility
 
+from .db import get_store_object
 from .helpers import get_stream_path
 from .model_endpoint import ModelEndpoint
-from .stores import ModelEndpointStore, ModelEndpointStoreType, get_model_endpoint_store
 from .tracking_policy import TrackingPolicy
```

## mlrun/model_monitoring/api.py

```diff
@@ -9,30 +9,30 @@
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import hashlib
-import json
 import typing
+import warnings
 from datetime import datetime
 
 import numpy as np
 import pandas as pd
 
 import mlrun.artifacts
 import mlrun.common.helpers
+import mlrun.common.schemas.model_monitoring.constants as mm_consts
 import mlrun.feature_store
-from mlrun.common.schemas.model_monitoring import EventFieldType, ModelMonitoringMode
+import mlrun.model_monitoring.application
+import mlrun.serving
 from mlrun.data_types.infer import InferOptions, get_df_stats
 from mlrun.utils import datetime_now, logger
 
-from .batch import VirtualDrift
-from .features_drift_table import FeaturesDriftTablePlot
 from .helpers import update_model_endpoint_last_request
 from .model_endpoint import ModelEndpoint
 
 # A union of all supported dataset types:
 DatasetType = typing.Union[
     mlrun.DataItem, list, dict, pd.DataFrame, pd.Series, np.ndarray, typing.Any
 ]
@@ -44,15 +44,15 @@
     model_endpoint_name: str = "",
     endpoint_id: str = "",
     function_name: str = "",
     context: mlrun.MLClientCtx = None,
     sample_set_statistics: dict[str, typing.Any] = None,
     drift_threshold: float = None,
     possible_drift_threshold: float = None,
-    monitoring_mode: ModelMonitoringMode = ModelMonitoringMode.disabled,
+    monitoring_mode: mm_consts.ModelMonitoringMode = mm_consts.ModelMonitoringMode.disabled,
     db_session=None,
 ) -> ModelEndpoint:
     """
     Get a single model endpoint object. If not exist, generate a new model endpoint with the provided parameters. Note
     that in case of generating a new model endpoint, by default the monitoring features are disabled. To enable these
     features, set `monitoring_mode=enabled`.
 
@@ -124,28 +124,27 @@
     model_path: str,
     model_endpoint_name: str,
     endpoint_id: str = "",
     function_name: str = "",
     context: typing.Optional[mlrun.MLClientCtx] = None,
     infer_results_df: typing.Optional[pd.DataFrame] = None,
     sample_set_statistics: typing.Optional[dict[str, typing.Any]] = None,
-    monitoring_mode: ModelMonitoringMode = ModelMonitoringMode.enabled,
+    monitoring_mode: mm_consts.ModelMonitoringMode = mm_consts.ModelMonitoringMode.enabled,
+    # Deprecated arguments:
     drift_threshold: typing.Optional[float] = None,
     possible_drift_threshold: typing.Optional[float] = None,
     trigger_monitoring_job: bool = False,
     artifacts_tag: str = "",
-    default_batch_image="mlrun/mlrun",
+    default_batch_image: str = "mlrun/mlrun",
 ) -> ModelEndpoint:
     """
     Write a provided inference dataset to model endpoint parquet target. If not exist, generate a new model endpoint
     record and use the provided sample set statistics as feature stats that will be used later for the drift analysis.
-    To manually trigger the monitoring batch job, set `trigger_monitoring_job=True` and then the batch
-    job will immediately perform drift analysis between the sample set statistics stored in the model and the new
-    input data (along with the outputs). The drift rule is the value per-feature mean of the TVD and Hellinger scores
-    according to the provided thresholds.
+    To activate model monitoring, run `project.enable_model_monitoring()`. The model monitoring applications will be
+    triggered with the recorded data according to a periodic schedule.
 
     :param project:                  Project name.
     :param model_path:               The model Store path.
     :param model_endpoint_name:      If a new model endpoint is generated, the model endpoint name will be presented
                                      under this endpoint.
     :param endpoint_id:              Model endpoint unique ID. If not exist in DB, will generate a new record based
                                      on the provided `endpoint_id`.
@@ -156,37 +155,65 @@
     :param infer_results_df:         DataFrame that will be stored under the model endpoint parquet target. Will be
                                      used for doing the drift analysis. Please make sure that the dataframe includes
                                      both feature names and label columns.
     :param sample_set_statistics:    Dictionary of sample set statistics that will be used as a reference data for
                                      the current model endpoint.
     :param monitoring_mode:          If enabled, apply model monitoring features on the provided endpoint id. Enabled
                                      by default.
-    :param drift_threshold:          The threshold of which to mark drifts.
-    :param possible_drift_threshold: The threshold of which to mark possible drifts.
-    :param trigger_monitoring_job:   If true, run the batch drift job. If not exists, the monitoring batch function
-                                     will be registered through MLRun API with the provided image.
-    :param artifacts_tag:            Tag to use for all the artifacts resulted from the function. Will be relevant
-                                     only if the monitoring batch job has been triggered.
-
-    :param default_batch_image:      The image that will be used when registering the model monitoring batch job.
+    :param drift_threshold:          (deprecated) The threshold of which to mark drifts.
+    :param possible_drift_threshold: (deprecated) The threshold of which to mark possible drifts.
+    :param trigger_monitoring_job:   (deprecated) If true, run the batch drift job. If not exists, the monitoring
+                                     batch function will be registered through MLRun API with the provided image.
+    :param artifacts_tag:            (deprecated) Tag to use for all the artifacts resulted from the function.
+                                     Will be relevant only if the monitoring batch job has been triggered.
+    :param default_batch_image:      (deprecated) The image that will be used when registering the model monitoring
+                                     batch job.
 
     :return: A ModelEndpoint object
     """
+
+    if drift_threshold is not None or possible_drift_threshold is not None:
+        warnings.warn(
+            "Custom drift threshold arguments are deprecated since version "
+            "1.7.0 and have no effect. They will be removed in version 1.9.0.\n"
+            "To enable the default histogram data drift application, run:\n"
+            "`project.enable_model_monitoring()`.",
+            FutureWarning,
+        )
+    if trigger_monitoring_job is not False:
+        warnings.warn(
+            "`trigger_monitoring_job` argument is deprecated since version "
+            "1.7.0 and has no effect. It will be removed in version 1.9.0.\n"
+            "To enable the default histogram data drift application, run:\n"
+            "`project.enable_model_monitoring()`.",
+            FutureWarning,
+        )
+    if artifacts_tag != "":
+        warnings.warn(
+            "`artifacts_tag` argument is deprecated since version "
+            "1.7.0 and has no effect. It will be removed in version 1.9.0.",
+            FutureWarning,
+        )
+    if default_batch_image != "mlrun/mlrun":
+        warnings.warn(
+            "`default_batch_image` argument is deprecated since version "
+            "1.7.0 and has no effect. It will be removed in version 1.9.0.",
+            FutureWarning,
+        )
+
     db = mlrun.get_run_db()
 
     model_endpoint = get_or_create_model_endpoint(
         project=project,
         endpoint_id=endpoint_id,
         model_path=model_path,
         model_endpoint_name=model_endpoint_name,
         function_name=function_name,
         context=context,
         sample_set_statistics=sample_set_statistics,
-        drift_threshold=drift_threshold,
-        possible_drift_threshold=possible_drift_threshold,
         monitoring_mode=monitoring_mode,
         db_session=db,
     )
     logger.debug("Model endpoint", endpoint=model_endpoint.to_dict())
 
     timestamp = datetime_now()
     if infer_results_df is not None:
@@ -202,41 +229,14 @@
     update_model_endpoint_last_request(
         project=project,
         model_endpoint=model_endpoint,
         current_request=timestamp,
         db=db,
     )
 
-    if trigger_monitoring_job:
-        # Run the monitoring batch drift job
-        trigger_drift_batch_job(
-            project=project,
-            default_batch_image=default_batch_image,
-            model_endpoints_ids=[model_endpoint.metadata.uid],
-            db_session=db,
-        )
-
-        # Getting drift thresholds if not provided
-        drift_threshold, possible_drift_threshold = get_drift_thresholds_if_not_none(
-            model_endpoint=model_endpoint,
-            drift_threshold=drift_threshold,
-            possible_drift_threshold=possible_drift_threshold,
-        )
-
-        perform_drift_analysis(
-            project=project,
-            context=context,
-            sample_set_statistics=model_endpoint.status.feature_stats,
-            drift_threshold=drift_threshold,
-            possible_drift_threshold=possible_drift_threshold,
-            artifacts_tag=artifacts_tag,
-            endpoint_id=model_endpoint.metadata.uid,
-            db_session=db,
-        )
-
     return model_endpoint
 
 
 def _model_endpoint_validations(
     model_endpoint: ModelEndpoint,
     model_path: str = "",
     sample_set_statistics: dict[str, typing.Any] = None,
@@ -278,69 +278,35 @@
         logger.warning(
             "Provided sample set statistics is different from the registered statistics. "
             "If new sample set statistics is to be used, new model endpoint should be created"
         )
     # drift and possible drift thresholds
     if drift_threshold:
         current_drift_threshold = model_endpoint.spec.monitor_configuration.get(
-            EventFieldType.DRIFT_DETECTED_THRESHOLD,
+            mm_consts.EventFieldType.DRIFT_DETECTED_THRESHOLD,
             mlrun.mlconf.model_endpoint_monitoring.drift_thresholds.default.drift_detected,
         )
         if current_drift_threshold != drift_threshold:
             raise mlrun.errors.MLRunInvalidArgumentError(
                 f"Cannot change existing drift threshold. Expected {current_drift_threshold}, got {drift_threshold} "
                 f"Please update drift threshold or generate a new model endpoint record"
             )
 
     if possible_drift_threshold:
         current_possible_drift_threshold = model_endpoint.spec.monitor_configuration.get(
-            EventFieldType.POSSIBLE_DRIFT_THRESHOLD,
+            mm_consts.EventFieldType.POSSIBLE_DRIFT_THRESHOLD,
             mlrun.mlconf.model_endpoint_monitoring.drift_thresholds.default.possible_drift,
         )
         if current_possible_drift_threshold != possible_drift_threshold:
             raise mlrun.errors.MLRunInvalidArgumentError(
                 f"Cannot change existing possible drift threshold. Expected {current_possible_drift_threshold}, "
                 f"got {possible_drift_threshold}. Please update drift threshold or generate a new model endpoint record"
             )
 
 
-def get_drift_thresholds_if_not_none(
-    model_endpoint: ModelEndpoint,
-    drift_threshold: float = None,
-    possible_drift_threshold: float = None,
-) -> tuple[float, float]:
-    """
-    Get drift and possible drift thresholds. If one of the thresholds is missing, will try to retrieve
-    it from the `ModelEndpoint` object. If not defined under the `ModelEndpoint` as well, will retrieve it from
-    the default mlrun configuration.
-
-    :param model_endpoint:           `ModelEndpoint` object.
-    :param drift_threshold:           The threshold of which to mark drifts.
-    :param possible_drift_threshold:  The threshold of which to mark possible drifts.
-
-    :return: A Tuple of:
-            [0] drift threshold as a float
-            [1] possible drift threshold as a float
-    """
-    if not drift_threshold:
-        # Getting drift threshold value from either model endpoint or monitoring default configurations
-        drift_threshold = model_endpoint.spec.monitor_configuration.get(
-            EventFieldType.DRIFT_DETECTED_THRESHOLD,
-            mlrun.mlconf.model_endpoint_monitoring.drift_thresholds.default.drift_detected,
-        )
-    if not possible_drift_threshold:
-        # Getting possible drift threshold value from either model endpoint or monitoring default configurations
-        possible_drift_threshold = model_endpoint.spec.monitor_configuration.get(
-            EventFieldType.POSSIBLE_DRIFT_THRESHOLD,
-            mlrun.mlconf.model_endpoint_monitoring.drift_thresholds.default.possible_drift,
-        )
-
-    return drift_threshold, possible_drift_threshold
-
-
 def write_monitoring_df(
     endpoint_id: str,
     infer_results_df: pd.DataFrame,
     infer_datetime: datetime,
     monitoring_feature_set: typing.Optional[mlrun.feature_store.FeatureSet] = None,
     feature_set_uri: str = "",
 ) -> None:
@@ -362,22 +328,22 @@
             )
 
         monitoring_feature_set = mlrun.feature_store.get_feature_set(
             uri=feature_set_uri
         )
 
     # Modify the DataFrame to the required structure that will be used later by the monitoring batch job
-    if EventFieldType.TIMESTAMP not in infer_results_df.columns:
+    if mm_consts.EventFieldType.TIMESTAMP not in infer_results_df.columns:
         # Initialize timestamp column with the current time
-        infer_results_df[EventFieldType.TIMESTAMP] = infer_datetime
+        infer_results_df[mm_consts.EventFieldType.TIMESTAMP] = infer_datetime
 
     # `endpoint_id` is the monitoring feature set entity and therefore it should be defined as the df index before
     # the ingest process
-    infer_results_df[EventFieldType.ENDPOINT_ID] = endpoint_id
-    infer_results_df.set_index(EventFieldType.ENDPOINT_ID, inplace=True)
+    infer_results_df[mm_consts.EventFieldType.ENDPOINT_ID] = endpoint_id
+    infer_results_df.set_index(mm_consts.EventFieldType.ENDPOINT_ID, inplace=True)
 
     monitoring_feature_set.ingest(source=infer_results_df, overwrite=False)
 
 
 def _generate_model_endpoint(
     project: str,
     db_session,
@@ -385,15 +351,15 @@
     model_path: str,
     model_endpoint_name: str,
     function_name: str,
     context: mlrun.MLClientCtx,
     sample_set_statistics: dict[str, typing.Any],
     drift_threshold: float,
     possible_drift_threshold: float,
-    monitoring_mode: ModelMonitoringMode = ModelMonitoringMode.disabled,
+    monitoring_mode: mm_consts.ModelMonitoringMode = mm_consts.ModelMonitoringMode.disabled,
 ) -> ModelEndpoint:
     """
     Write a new model endpoint record.
 
     :param project:                  Project name.
 
     :param db_session:               A session that manages the current dialog with the database.
@@ -424,19 +390,19 @@
     else:
         model_endpoint.spec.function_uri = context.to_dict()["spec"]["function"]
     model_endpoint.spec.model_uri = model_path
     model_endpoint.spec.model = model_endpoint_name
     model_endpoint.spec.model_class = "drift-analysis"
     if drift_threshold:
         model_endpoint.spec.monitor_configuration[
-            EventFieldType.DRIFT_DETECTED_THRESHOLD
+            mm_consts.EventFieldType.DRIFT_DETECTED_THRESHOLD
         ] = drift_threshold
     if possible_drift_threshold:
         model_endpoint.spec.monitor_configuration[
-            EventFieldType.POSSIBLE_DRIFT_THRESHOLD
+            mm_consts.EventFieldType.POSSIBLE_DRIFT_THRESHOLD
         ] = possible_drift_threshold
 
     model_endpoint.spec.monitoring_mode = monitoring_mode
     model_endpoint.status.first_request = model_endpoint.status.last_request = (
         datetime_now().isoformat()
     )
     if sample_set_statistics:
@@ -445,79 +411,14 @@
     db_session.create_model_endpoint(
         project=project, endpoint_id=endpoint_id, model_endpoint=model_endpoint
     )
 
     return db_session.get_model_endpoint(project=project, endpoint_id=endpoint_id)
 
 
-def trigger_drift_batch_job(
-    project: str,
-    default_batch_image="mlrun/mlrun",
-    model_endpoints_ids: list[str] = None,
-    batch_intervals_dict: dict[str, float] = None,
-    db_session=None,
-):
-    """
-    Run model monitoring drift analysis job. If not exists, the monitoring batch function will be registered through
-    MLRun API with the provided image.
-
-    :param project:              Project name.
-    :param default_batch_image:  The image that will be used when registering the model monitoring batch job.
-    :param model_endpoints_ids:  List of model endpoints to include in the current run.
-    :param batch_intervals_dict: Batch interval range (days, hours, minutes). By default, the batch interval is
-                                 configured to run through the last hour.
-    :param db_session:           A runtime session that manages the current dialog with the database.
-
-    """
-    if not model_endpoints_ids:
-        raise mlrun.errors.MLRunNotFoundError(
-            "No model endpoints provided",
-        )
-    if not db_session:
-        db_session = mlrun.get_run_db()
-
-    # Register the monitoring batch job (do nothing if already exist) and get the job function as a dictionary
-    batch_function_dict: dict[str, typing.Any] = db_session.deploy_monitoring_batch_job(
-        project=project,
-        default_batch_image=default_batch_image,
-    )
-
-    # Prepare current run params
-    job_params = _generate_job_params(
-        model_endpoints_ids=model_endpoints_ids,
-        batch_intervals_dict=batch_intervals_dict,
-    )
-
-    # Generate runtime and trigger the job function
-    batch_function = mlrun.new_function(runtime=batch_function_dict)
-    batch_function.run(name="model-monitoring-batch", params=job_params, watch=True)
-
-
-def _generate_job_params(
-    model_endpoints_ids: list[str],
-    batch_intervals_dict: dict[str, float] = None,
-):
-    """
-    Generate the required params for the model monitoring batch job function.
-
-    :param model_endpoints_ids:  List of model endpoints to include in the current run.
-    :param batch_intervals_dict: Batch interval range (days, hours, minutes). By default, the batch interval is
-                                 configured to run through the last hour.
-
-    """
-    if not batch_intervals_dict:
-        # Generate default batch intervals dict
-        batch_intervals_dict = {"minutes": 0, "hours": 1, "days": 0}
-
-    return {
-        "model_endpoints": model_endpoints_ids,
-        "batch_intervals_dict": batch_intervals_dict,
-    }
-
-
 def get_sample_set_statistics(
     sample_set: DatasetType = None,
     model_artifact_feature_stats: dict = None,
     sample_set_columns: typing.Optional[list] = None,
     sample_set_drop_columns: typing.Optional[list] = None,
     sample_set_label_columns: typing.Optional[list] = None,
 ) -> dict:
@@ -655,153 +556,14 @@
         label_columns = []
     elif isinstance(label_columns, (str, int)):
         label_columns = [label_columns]
 
     return dataset, label_columns
 
 
-def perform_drift_analysis(
-    project: str,
-    endpoint_id: str,
-    context: mlrun.MLClientCtx,
-    sample_set_statistics: dict,
-    drift_threshold: float,
-    possible_drift_threshold: float,
-    artifacts_tag: str = "",
-    db_session=None,
-) -> None:
-    """
-    Calculate drift per feature and produce the drift table artifact for logging post prediction. Note that most of
-    the calculations were already made through the monitoring batch job.
-
-    :param project:                  Project name.
-    :param endpoint_id:              Model endpoint unique ID.
-    :param context:                  MLRun context. Will log the artifacts.
-    :param sample_set_statistics:    The statistics of the sample set logged along a model.
-    :param drift_threshold:          The threshold of which to mark drifts.
-    :param possible_drift_threshold: The threshold of which to mark possible drifts.
-    :param artifacts_tag:            Tag to use for all the artifacts resulted from the function.
-    :param db_session:               A runtime session that manages the current dialog with the database.
-
-    """
-    if not db_session:
-        db_session = mlrun.get_run_db()
-
-    model_endpoint = db_session.get_model_endpoint(
-        project=project, endpoint_id=endpoint_id
-    )
-
-    # Get the drift metrics results along with the feature statistics from the latest batch
-    metrics = model_endpoint.status.drift_measures
-    inputs_statistics = model_endpoint.status.current_stats
-
-    inputs_statistics.pop(EventFieldType.TIMESTAMP, None)
-
-    # Calculate drift for each feature
-    virtual_drift = VirtualDrift()
-    drift_results = virtual_drift.check_for_drift_per_feature(
-        metrics_results_dictionary=metrics,
-        possible_drift_threshold=possible_drift_threshold,
-        drift_detected_threshold=drift_threshold,
-    )
-
-    # Drift table artifact
-    plotly_artifact = FeaturesDriftTablePlot().produce(
-        sample_set_statistics=sample_set_statistics,
-        inputs_statistics=inputs_statistics,
-        metrics=metrics,
-        drift_results=drift_results,
-    )
-
-    # Prepare drift result per feature dictionary
-    metrics_per_feature = {
-        feature: _get_drift_result(
-            tvd=metric_dictionary["tvd"],
-            hellinger=metric_dictionary["hellinger"],
-            threshold=drift_threshold,
-        )[1]
-        for feature, metric_dictionary in metrics.items()
-        if isinstance(metric_dictionary, dict)
-    }
-
-    # Calculate the final analysis result as well
-    drift_status, drift_metric = _get_drift_result(
-        tvd=metrics["tvd_mean"],
-        hellinger=metrics["hellinger_mean"],
-        threshold=drift_threshold,
-    )
-    # Log the different artifacts
-    _log_drift_artifacts(
-        context=context,
-        plotly_artifact=plotly_artifact,
-        metrics_per_feature=metrics_per_feature,
-        drift_status=drift_status,
-        drift_metric=drift_metric,
-        artifacts_tag=artifacts_tag,
-    )
-
-
-def _log_drift_artifacts(
-    context: mlrun.MLClientCtx,
-    plotly_artifact: mlrun.artifacts.Artifact,
-    metrics_per_feature: dict[str, float],
-    drift_status: bool,
-    drift_metric: float,
-    artifacts_tag: str,
-):
-    """
-    Log the following artifacts/results:
-    1 - Drift table plot which includes a detailed drift analysis per feature
-    2 - Drift result per feature in a JSON format
-    3 - Results of the total drift analysis
-
-    :param context:             MLRun context. Will log the artifacts.
-    :param plotly_artifact:     The plotly artifact.
-    :param metrics_per_feature: Dictionary in which the key is a feature name and the value is the drift numerical
-                                result.
-    :param drift_status:        Boolean value that represents the final drift analysis result.
-    :param drift_metric:        The final drift numerical result.
-    :param artifacts_tag:       Tag to use for all the artifacts resulted from the function.
-    """
-    context.log_artifact(plotly_artifact, tag=artifacts_tag)
-    context.log_artifact(
-        mlrun.artifacts.Artifact(
-            body=json.dumps(metrics_per_feature),
-            format="json",
-            key="features_drift_results",
-        ),
-        tag=artifacts_tag,
-    )
-    context.log_results(
-        results={"drift_status": drift_status, "drift_metric": drift_metric}
-    )
-
-
-def _get_drift_result(
-    tvd: float,
-    hellinger: float,
-    threshold: float,
-) -> tuple[bool, float]:
-    """
-    Calculate the drift result by the following equation: (tvd + hellinger) / 2
-
-    :param tvd:       The feature's TVD value.
-    :param hellinger: The feature's Hellinger value.
-    :param threshold: The threshold from which the value is considered a drift.
-
-    :returns: A tuple of:
-              [0] = Boolean value as the drift status.
-              [1] = The result.
-    """
-    result = (tvd + hellinger) / 2
-    if result >= threshold:
-        return True, result
-    return False, result
-
-
 def log_result(
     context: mlrun.MLClientCtx,
     result_set_name: str,
     result_set: pd.DataFrame,
     artifacts_tag: str,
     batch_id: str,
 ) -> None:
@@ -816,7 +578,54 @@
     # Log the batch ID:
     if batch_id is None:
         batch_id = hashlib.sha224(str(datetime_now()).encode()).hexdigest()
     context.log_result(
         key="batch_id",
         value=batch_id,
     )
+
+
+def _create_model_monitoring_function_base(
+    *,
+    project: str,
+    func: typing.Union[str, None] = None,
+    application_class: typing.Union[
+        str, mlrun.model_monitoring.application.ModelMonitoringApplicationBase, None
+    ] = None,
+    name: typing.Optional[str] = None,
+    image: typing.Optional[str] = None,
+    tag: typing.Optional[str] = None,
+    requirements: typing.Union[str, list[str], None] = None,
+    requirements_file: str = "",
+    **application_kwargs,
+) -> mlrun.runtimes.ServingRuntime:
+    """
+    Note: this is an internal API only.
+    This function does not set the labels or mounts v3io.
+    """
+    if func is None:
+        func = ""
+    func_obj = typing.cast(
+        mlrun.runtimes.ServingRuntime,
+        mlrun.code_to_function(
+            filename=func,
+            name=name,
+            project=project,
+            tag=tag,
+            kind=mlrun.run.RuntimeKinds.serving,
+            image=image,
+            requirements=requirements,
+            requirements_file=requirements_file,
+        ),
+    )
+    graph = func_obj.set_topology(mlrun.serving.states.StepKinds.flow)
+    if isinstance(application_class, str):
+        first_step = graph.to(class_name=application_class, **application_kwargs)
+    else:
+        first_step = graph.to(class_name=application_class)
+    first_step.to(
+        class_name="mlrun.model_monitoring.application.PushToMonitoringWriter",
+        name="PushToMonitoringWriter",
+        project=project,
+        writer_application_name=mm_consts.MonitoringFunctionNames.WRITER,
+    ).respond()
+    return func_obj
```

## mlrun/model_monitoring/controller.py

```diff
@@ -17,43 +17,40 @@
 import json
 import os
 import re
 from collections.abc import Iterator
 from typing import Any, NamedTuple, Optional, Union, cast
 
 import nuclio
-from v3io.dataplane.response import HttpResponseError
 
 import mlrun
 import mlrun.common.schemas.model_monitoring.constants as mm_constants
 import mlrun.data_types.infer
 import mlrun.feature_store as fstore
+import mlrun.model_monitoring.db.stores
 from mlrun.common.model_monitoring.helpers import FeatureStats, pad_features_hist
 from mlrun.datastore import get_stream_pusher
 from mlrun.datastore.targets import ParquetTarget
 from mlrun.errors import err_to_str
 from mlrun.model_monitoring.helpers import (
     _BatchDict,
     batch_dict2timedelta,
     calculate_inputs_statistics,
     get_monitoring_parquet_path,
     get_stream_path,
 )
-from mlrun.utils import create_logger, datetime_now, logger
-from mlrun.utils.v3io_clients import get_v3io_client
+from mlrun.utils import datetime_now, logger
 
 
 class _Interval(NamedTuple):
     start: datetime.datetime
     end: datetime.datetime
 
 
 class _BatchWindow:
-    V3IO_CONTAINER_FORMAT = "users/pipelines/{project}/monitoring-schedules/functions"
-
     def __init__(
         self,
         project: str,
         endpoint: str,
         application: str,
         timedelta_seconds: int,
         last_updated: Optional[int],
@@ -61,58 +58,52 @@
     ) -> None:
         """
         Initialize a batch window object that handles the batch interval time range
         for the monitoring functions.
         All the time values are in seconds.
         The start and stop time are in seconds since the epoch.
         """
+        self.project = project
         self._endpoint = endpoint
         self._application = application
         self._first_request = first_request
-        self._kv_storage = get_v3io_client(
-            endpoint=mlrun.mlconf.v3io_api,
-            # Avoid noisy warning logs before the KV table is created
-            logger=create_logger(name="v3io_client", level="error"),
-        ).kv
-        self._v3io_container = self.V3IO_CONTAINER_FORMAT.format(project=project)
         self._stop = last_updated
         self._step = timedelta_seconds
+        self._db = mlrun.model_monitoring.get_store_object(project=self.project)
         self._start = self._get_last_analyzed()
 
     def _get_last_analyzed(self) -> Optional[int]:
         try:
-            data = self._kv_storage.get(
-                container=self._v3io_container,
-                table_path=self._endpoint,
-                key=self._application,
+            last_analyzed = self._db.get_last_analyzed(
+                endpoint_id=self._endpoint,
+                application_name=self._application,
             )
-        except HttpResponseError as err:
+        except mlrun.errors.MLRunNotFoundError:
             logger.info(
                 "No last analyzed time was found for this endpoint and "
                 "application, as this is probably the first time this "
                 "application is running. Using the latest between first "
                 "request time or last update time minus one day instead",
                 endpoint=self._endpoint,
                 application=self._application,
                 first_request=self._first_request,
                 last_updated=self._stop,
             )
-            logger.debug("Error while getting last analyzed time", err=err)
+
             if self._first_request and self._stop:
                 # TODO : Change the timedelta according to the policy.
                 first_period_in_seconds = max(
                     int(datetime.timedelta(days=1).total_seconds()), self._step
                 )  # max between one day and the base period
                 return max(
                     self._first_request,
                     self._stop - first_period_in_seconds,
                 )
             return self._first_request
 
-        last_analyzed = data.output.item[mm_constants.SchedulingKeys.LAST_ANALYZED]
         logger.info(
             "Got the last analyzed time for this endpoint and application",
             endpoint=self._endpoint,
             application=self._application,
             last_analyzed=last_analyzed,
         )
         return last_analyzed
@@ -120,19 +111,19 @@
     def _update_last_analyzed(self, last_analyzed: int) -> None:
         logger.info(
             "Updating the last analyzed time for this endpoint and application",
             endpoint=self._endpoint,
             application=self._application,
             last_analyzed=last_analyzed,
         )
-        self._kv_storage.put(
-            container=self._v3io_container,
-            table_path=self._endpoint,
-            key=self._application,
-            attributes={mm_constants.SchedulingKeys.LAST_ANALYZED: last_analyzed},
+
+        self._db.update_last_analyzed(
+            endpoint_id=self._endpoint,
+            application_name=self._application,
+            last_analyzed=last_analyzed,
         )
 
     def get_intervals(
         self,
     ) -> Iterator[_Interval]:
         """Generate the batch interval time ranges."""
         if self._start is not None and self._stop is not None:
@@ -297,15 +288,15 @@
         self.project = project
         self.project_obj = mlrun.get_or_create_project(project)
 
         mlrun_context.logger.debug(
             f"Initializing {self.__class__.__name__}", project=project
         )
 
-        self.db = mlrun.model_monitoring.get_model_endpoint_store(project=project)
+        self.db = mlrun.model_monitoring.get_store_object(project=project)
 
         self._batch_window_generator = _BatchWindowGenerator(
             batch_dict=json.loads(
                 mlrun.get_secret_or_env(
                     mm_constants.EventFieldType.BATCH_INTERVALS_DICT
                 )
             )
@@ -355,22 +346,31 @@
             monitoring_functions = self.project_obj.list_model_monitoring_functions()
             if monitoring_functions:
                 # Gets only application in ready state
                 applications_names = list(
                     {
                         app.metadata.name
                         for app in monitoring_functions
-                        if app.status.state == "ready"
+                        if (
+                            app.status.state == "ready"
+                            # workaround for the default app, as its `status.state` is `None`
+                            or app.metadata.name
+                            == mm_constants.MLRUN_HISTOGRAM_DATA_DRIFT_APP_NAME
+                        )
                     }
                 )
             if not applications_names:
                 self.context.logger.info(
                     "No monitoring functions found", project=self.project
                 )
                 return
+            self.context.logger.info(
+                "Starting to iterate over the applications",
+                applications=applications_names,
+            )
 
         except Exception as e:
             self.context.logger.error(
                 "Failed to list endpoints and monitoring applications",
                 exc=err_to_str(e),
             )
             return
```

## mlrun/model_monitoring/helpers.py

```diff
@@ -50,16 +50,14 @@
     :param function_name:    Application name. Default is model_monitoring_stream.
 
     :return:                    Monitoring stream path to the relevant application.
     """
 
     stream_uri = mlrun.get_secret_or_env(
         mlrun.common.schemas.model_monitoring.ProjectSecretKeys.STREAM_PATH
-        if function_name is mm_constants.MonitoringFunctionNames.STREAM
-        else ""
     ) or mlrun.mlconf.get_model_monitoring_file_target_path(
         project=project,
         kind=mlrun.common.schemas.model_monitoring.FileTargetKind.STREAM,
         target="online",
         function_name=function_name,
     )
```

## mlrun/model_monitoring/stream_processing.py

```diff
@@ -20,26 +20,29 @@
 
 import storey
 
 import mlrun
 import mlrun.common.model_monitoring.helpers
 import mlrun.config
 import mlrun.datastore.targets
+import mlrun.feature_store as fstore
 import mlrun.feature_store.steps
+import mlrun.model_monitoring.db
 import mlrun.model_monitoring.prometheus
 import mlrun.serving.states
 import mlrun.utils
 import mlrun.utils.v3io_clients
 from mlrun.common.schemas.model_monitoring.constants import (
     EventFieldType,
     EventKeyMetrics,
     EventLiveStats,
     FileTargetKind,
     ModelEndpointTarget,
     ProjectSecretKeys,
+    PrometheusEndpoints,
 )
 from mlrun.utils import logger
 
 
 # Stream processing code
 class EventStreamProcessor:
     def __init__(
@@ -179,19 +182,19 @@
             ).respond()
 
         apply_event_routing()
 
         # Step 2 - Filter out events with '-' in the path basename from going forward
         # through the next steps of the stream graph
         def apply_storey_filter_stream_events():
-            # Remove none values from each event
+            # Filter events with Prometheus endpoints path
             graph.add_step(
                 "storey.Filter",
                 "filter_stream_event",
-                _fn="('-' not in event.path.split('/')[-1])",
+                _fn=f"(event.path not in {PrometheusEndpoints.list()})",
                 full_event=True,
             )
 
         apply_storey_filter_stream_events()
 
         # Step 3 - Process endpoint event: splitting into sub-events and validate event data
         def apply_process_endpoint_event():
@@ -929,14 +932,16 @@
             ):
                 return self.label_columns[endpoint_id]
         return None
 
     def do(self, event: dict):
         endpoint_id = event[EventFieldType.ENDPOINT_ID]
 
+        feature_values = event[EventFieldType.FEATURES]
+        label_values = event[EventFieldType.PREDICTION]
         # Get feature names and label columns
         if endpoint_id not in self.feature_names:
             endpoint_record = get_endpoint_record(
                 project=self.project,
                 endpoint_id=endpoint_id,
             )
             feature_names = endpoint_record.get(EventFieldType.FEATURE_NAMES)
@@ -964,14 +969,20 @@
                     project=self.project,
                     endpoint_id=endpoint_id,
                     attributes={
                         EventFieldType.FEATURE_NAMES: json.dumps(feature_names)
                     },
                 )
 
+                update_monitoring_feature_set(
+                    endpoint_record=endpoint_record,
+                    feature_names=feature_names,
+                    feature_values=feature_values,
+                )
+
             # Similar process with label columns
             if not label_columns and self._infer_columns_from_data:
                 label_columns = self._infer_label_columns_from_data(event)
 
             if not label_columns:
                 logger.warn(
                     "label column names are not initialized, they will be automatically generated",
@@ -982,14 +993,19 @@
                 ]
 
                 update_endpoint_record(
                     project=self.project,
                     endpoint_id=endpoint_id,
                     attributes={EventFieldType.LABEL_NAMES: json.dumps(label_columns)},
                 )
+                update_monitoring_feature_set(
+                    endpoint_record=endpoint_record,
+                    feature_names=label_columns,
+                    feature_values=label_values,
+                )
 
             self.label_columns[endpoint_id] = label_columns
             self.feature_names[endpoint_id] = feature_names
 
             logger.info(
                 "Label columns", endpoint_id=endpoint_id, label_columns=label_columns
             )
@@ -999,25 +1015,23 @@
 
             # Update the endpoint type within the endpoint types dictionary
             endpoint_type = int(endpoint_record.get(EventFieldType.ENDPOINT_TYPE))
             self.endpoint_type[endpoint_id] = endpoint_type
 
         # Add feature_name:value pairs along with a mapping dictionary of all of these pairs
         feature_names = self.feature_names[endpoint_id]
-        feature_values = event[EventFieldType.FEATURES]
         self._map_dictionary_values(
             event=event,
             named_iters=feature_names,
             values_iters=feature_values,
             mapping_dictionary=EventFieldType.NAMED_FEATURES,
         )
 
         # Add label_name:value pairs along with a mapping dictionary of all of these pairs
         label_names = self.label_columns[endpoint_id]
-        label_values = event[EventFieldType.PREDICTION]
         self._map_dictionary_values(
             event=event,
             named_iters=label_names,
             values_iters=label_values,
             mapping_dictionary=EventFieldType.NAMED_PREDICTIONS,
         )
 
@@ -1135,27 +1149,27 @@
         project: str,
         **kwargs,
     ):
         super().__init__(**kwargs)
         self.project: str = project
 
     def do(self, event):
-        if event.path == "/model-monitoring-metrics":
+        if event.path == PrometheusEndpoints.MODEL_MONITORING_METRICS:
             # Return a parsed Prometheus registry file
             event.body = mlrun.model_monitoring.prometheus.get_registry()
-        elif event.path == "/monitoring-batch-metrics":
+        elif event.path == PrometheusEndpoints.MONITORING_BATCH_METRICS:
             # Update statistical metrics
             for event_metric in event.body:
                 mlrun.model_monitoring.prometheus.write_drift_metrics(
                     project=self.project,
                     endpoint_id=event_metric[EventFieldType.ENDPOINT_ID],
                     metric=event_metric[EventFieldType.METRIC],
                     value=event_metric[EventFieldType.VALUE],
                 )
-        elif event.path == "/monitoring-drift-status":
+        elif event.path == PrometheusEndpoints.MONITORING_DRIFT_STATUS:
             # Update drift status
             mlrun.model_monitoring.prometheus.write_drift_status(
                 project=self.project,
                 endpoint_id=event.body[EventFieldType.ENDPOINT_ID],
                 drift_status=event.body[EventFieldType.DRIFT_STATUS],
             )
 
@@ -1207,21 +1221,39 @@
 
 
 def update_endpoint_record(
     project: str,
     endpoint_id: str,
     attributes: dict,
 ):
-    model_endpoint_store = mlrun.model_monitoring.get_model_endpoint_store(
+    model_endpoint_store = mlrun.model_monitoring.get_store_object(
         project=project,
     )
 
     model_endpoint_store.update_model_endpoint(
         endpoint_id=endpoint_id, attributes=attributes
     )
 
 
 def get_endpoint_record(project: str, endpoint_id: str):
-    model_endpoint_store = mlrun.model_monitoring.get_model_endpoint_store(
+    model_endpoint_store = mlrun.model_monitoring.get_store_object(
         project=project,
     )
     return model_endpoint_store.get_model_endpoint(endpoint_id=endpoint_id)
+
+
+def update_monitoring_feature_set(
+    endpoint_record: dict[str, typing.Any],
+    feature_names: list[str],
+    feature_values: list[typing.Any],
+):
+    monitoring_feature_set = fstore.get_feature_set(
+        endpoint_record[
+            mlrun.common.schemas.model_monitoring.EventFieldType.FEATURE_SET_URI
+        ]
+    )
+    for name, val in zip(feature_names, feature_values):
+        monitoring_feature_set.add_feature(
+            fstore.Feature(name=name, value_type=type(val))
+        )
+
+    monitoring_feature_set.save()
```

## mlrun/model_monitoring/tracking_policy.py

```diff
@@ -7,16 +7,16 @@
 #   http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
-#
 
+import warnings
 from typing import Union
 
 import mlrun.common.schemas.schedule
 import mlrun.model
 
 
 class TrackingPolicy(mlrun.model.ModelObj):
@@ -51,14 +51,20 @@
                                             the image is mlrun/mlrun.
         :param base_period:                 Minutes to determine the frequency in which the model monitoring controller
                                             job is running. By default, the base period is 10 minutes.
         :param default_controller_image:    The default image of the model monitoring controller job. Note that the
                                             writer function, which is a real time nuclio functino, will be deployed
                                             with the same image. By default, the image is mlrun/mlrun.
         """
+        warnings.warn(
+            "The `TrackingPolicy` class is deprecated from version 1.7.0 and is not "
+            "used anymore. It will be removed in 1.9.0.",
+            FutureWarning,
+        )
+
         if isinstance(default_batch_intervals, str):
             default_batch_intervals = (
                 mlrun.common.schemas.schedule.ScheduleCronTrigger.from_crontab(
                     default_batch_intervals
                 )
             )
         self.default_batch_intervals = default_batch_intervals
```

## mlrun/model_monitoring/writer.py

```diff
@@ -10,25 +10,25 @@
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import datetime
 import json
-from http import HTTPStatus
 from typing import Any, NewType
 
 import pandas as pd
 from v3io.dataplane import Client as V3IOClient
 from v3io_frames.client import ClientBase as V3IOFramesClient
 from v3io_frames.errors import Error as V3IOFramesError
 from v3io_frames.frames_pb2 import IGNORE
 
 import mlrun.common.model_monitoring
 import mlrun.model_monitoring
+import mlrun.model_monitoring.db.stores
 import mlrun.utils.v3io_clients
 from mlrun.common.schemas.model_monitoring.constants import ResultStatusApp, WriterEvent
 from mlrun.common.schemas.notification import NotificationKind, NotificationSeverity
 from mlrun.serving.utils import StepToDict
 from mlrun.utils import logger
 from mlrun.utils.notifications.notification_pusher import CustomNotificationPusher
 
@@ -102,21 +102,19 @@
 
     kind = "monitoring_application_stream_pusher"
 
     def __init__(self, project: str) -> None:
         self.project = project
         self.name = project  # required for the deployment process
         self._v3io_container = self.get_v3io_container(self.name)
-        self._kv_client = self._get_v3io_client().kv
         self._tsdb_client = self._get_v3io_frames_client(self._v3io_container)
         self._custom_notifier = CustomNotificationPusher(
             notification_types=[NotificationKind.slack]
         )
         self._create_tsdb_table()
-        self._kv_schemas = []
 
     @staticmethod
     def get_v3io_container(project_name: str) -> str:
         return f"users/pipelines/{project_name}/monitoring-apps"
 
     @staticmethod
     def _get_v3io_client() -> V3IOClient:
@@ -137,48 +135,18 @@
             table=_TSDB_TABLE,
             if_exists=IGNORE,
             rate=_TSDB_RATE,
         )
 
     def _update_kv_db(self, event: _AppResultEvent) -> None:
         event = _AppResultEvent(event.copy())
-        endpoint_id = event.pop(WriterEvent.ENDPOINT_ID)
-        app_name = event.pop(WriterEvent.APPLICATION_NAME)
-        metric_name = event.pop(WriterEvent.RESULT_NAME)
-        attributes = {metric_name: json.dumps(event)}
-        self._kv_client.update(
-            container=self._v3io_container,
-            table_path=endpoint_id,
-            key=app_name,
-            attributes=attributes,
-        )
-        if endpoint_id not in self._kv_schemas:
-            self._generate_kv_schema(endpoint_id)
-        logger.info("Updated V3IO KV successfully", key=app_name)
-
-    def _generate_kv_schema(self, endpoint_id: str):
-        """Generate V3IO KV schema file which will be used by the model monitoring applications dashboard in Grafana."""
-        fields = [
-            {"name": WriterEvent.RESULT_NAME, "type": "string", "nullable": False}
-        ]
-        res = self._kv_client.create_schema(
-            container=self._v3io_container,
-            table_path=endpoint_id,
-            key=WriterEvent.APPLICATION_NAME,
-            fields=fields,
-        )
-        if res.status_code != HTTPStatus.OK.value:
-            raise mlrun.errors.MLRunBadRequestError(
-                f"Couldn't infer schema for endpoint {endpoint_id} which is required for Grafana dashboards"
-            )
-        else:
-            logger.info(
-                "Generated V3IO KV schema successfully", endpoint_id=endpoint_id
-            )
-            self._kv_schemas.append(endpoint_id)
+        application_result_store = mlrun.model_monitoring.get_store_object(
+            project=self.project
+        )
+        application_result_store.write_application_result(event=event)
 
     def _update_tsdb(self, event: _AppResultEvent) -> None:
         event = _AppResultEvent(event.copy())
         event[WriterEvent.END_INFER_TIME] = datetime.datetime.fromisoformat(
             event[WriterEvent.END_INFER_TIME]
         )
         del event[WriterEvent.RESULT_EXTRA_DATA]
```

## mlrun/projects/pipelines.py

```diff
@@ -408,14 +408,19 @@
             f.prepare_image_for_deploy()
 
     if project.spec.default_requirements:
         f.with_requirements(project.spec.default_requirements)
     if decorator:
         decorator(f)
 
+    if project.spec.default_function_node_selector:
+        f.enrich_runtime_spec(
+            project.spec.default_function_node_selector,
+        )
+
     if try_auto_mount:
         if (
             decorator and AutoMountType.is_auto_modifier(decorator)
         ) or project.spec.disable_auto_mount:
             f.spec.disable_auto_mount = True
         f.try_auto_mount_based_on_config()
 
@@ -604,14 +609,15 @@
             workflow_handler,
             project=project.metadata.name,
             arguments=workflow_spec.args,
             experiment=name or workflow_spec.name,
             namespace=namespace,
             artifact_path=artifact_path,
             cleanup_ttl=workflow_spec.cleanup_ttl,
+            timeout=int(mlrun.mlconf.workflows.timeouts.kfp),
         )
 
         # The user provided workflow code might have made changes to function specs that require cleanup
         for func in project.spec._function_objects.values():
             try:
                 func.spec.discard_changes()
             except AttributeError:
@@ -861,23 +867,29 @@
             if workflow_spec.schedule:
                 logger.info(
                     "Workflow scheduled successfully",
                     workflow_response=workflow_response,
                 )
                 return
 
+            get_workflow_id_timeout = max(
+                int(mlrun.mlconf.workflows.timeouts.remote),
+                int(getattr(mlrun.mlconf.workflows.timeouts, inner_engine.engine)),
+            )
+
             logger.debug(
                 "Workflow submitted, waiting for pipeline run to start",
                 workflow_name=workflow_response.name,
+                get_workflow_id_timeout=get_workflow_id_timeout,
             )
 
             # Getting workflow id from run:
             response = retry_until_successful(
                 1,
-                getattr(mlrun.mlconf.workflows.timeouts, inner_engine.engine),
+                get_workflow_id_timeout,
                 logger,
                 False,
                 run_db.get_workflow_id,
                 project=project.name,
                 name=workflow_response.name,
                 run_id=workflow_response.run_id,
                 engine=workflow_spec.engine,
```

## mlrun/projects/project.py

```diff
@@ -7,14 +7,15 @@
 #   http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
+
 import datetime
 import getpass
 import glob
 import http
 import importlib.util as imputil
 import json
 import pathlib
@@ -40,26 +41,26 @@
 import mlrun.db
 import mlrun.errors
 import mlrun.k8s_utils
 import mlrun.runtimes
 import mlrun.runtimes.nuclio.api_gateway
 import mlrun.runtimes.pod
 import mlrun.runtimes.utils
+import mlrun.serving
 import mlrun.utils.regex
 from mlrun.datastore.datastore_profile import DatastoreProfile, DatastoreProfile2Json
 from mlrun.runtimes.nuclio.function import RemoteRuntime
 
 from ..artifacts import Artifact, ArtifactProducer, DatasetArtifact, ModelArtifact
 from ..artifacts.manager import ArtifactManager, dict_to_artifact, extend_artifact_path
 from ..datastore import store_manager
 from ..features import Feature
 from ..model import EntrypointParam, ImageBuilder, ModelObj
 from ..model_monitoring.application import (
     ModelMonitoringApplicationBase,
-    PushToMonitoringWriter,
 )
 from ..run import code_to_function, get_object, import_function, new_function
 from ..secrets import SecretsStore
 from ..utils import (
     is_ipython,
     is_legacy_artifact,
     is_relative_path,
@@ -756,14 +757,15 @@
         desired_state=mlrun.common.schemas.ProjectState.online.value,
         owner=None,
         disable_auto_mount=None,
         workdir=None,
         default_image=None,
         build=None,
         custom_packagers: list[tuple[str, bool]] = None,
+        default_function_node_selector=None,
     ):
         self.repo = None
 
         self.description = description
         self.context = ""
         self._mountdir = None
         self._source = None
@@ -795,14 +797,15 @@
 
         self.build = build
 
         # A list of custom packagers to include when running the functions of the project. A custom packager is stored
         # in a tuple where the first index is the packager module's path (str) and the second is a flag (bool) for
         # whether it is mandatory for a run (raise exception on collection error) or not.
         self.custom_packagers = custom_packagers or []
+        self.default_function_node_selector = default_function_node_selector or {}
 
     @property
     def source(self) -> str:
         """source url or git repo"""
         if not self._source:
             if self.repo:
                 url = get_repo_url(self.repo)
@@ -1840,18 +1843,18 @@
         :param requirements:            A list of python packages
         :param requirements_file:       Path to a python requirements file
         :param application_class:       Name or an Instance of a class that implements the monitoring application.
         :param application_kwargs:      Additional keyword arguments to be passed to the
                                         monitoring application's constructor.
         """
 
-        if name in mm_constants.MonitoringFunctionNames.all():
+        if name in mm_constants.MonitoringFunctionNames.list():
             raise mlrun.errors.MLRunInvalidArgumentError(
-                f"Application name can not be on of the following name : "
-                f"{mm_constants.MonitoringFunctionNames.all()}"
+                f"An application cannot have the following names: "
+                f"{mm_constants.MonitoringFunctionNames.list()}"
             )
         function_object: RemoteRuntime = None
         (
             resolved_function_name,
             function_object,
             func,
         ) = self._instantiate_model_monitoring_function(
@@ -1862,24 +1865,14 @@
             handler,
             with_repo,
             tag,
             requirements,
             requirements_file,
             **application_kwargs,
         )
-        models_names = "all"
-        function_object.set_label(
-            mm_constants.ModelMonitoringAppLabel.KEY,
-            mm_constants.ModelMonitoringAppLabel.VAL,
-        )
-        function_object.set_label("models", models_names)
-
-        if not mlrun.mlconf.is_ce_mode():
-            function_object.apply(mlrun.mount_v3io())
-
         # save to project spec
         self.spec.set_function(resolved_function_name, function_object, func)
 
         return function_object
 
     def create_model_monitoring_function(
         self,
@@ -1930,57 +1923,46 @@
             requirements_file,
             **application_kwargs,
         )
         return function_object
 
     def _instantiate_model_monitoring_function(
         self,
-        func: typing.Union[str, mlrun.runtimes.BaseRuntime] = None,
-        application_class: typing.Union[str, ModelMonitoringApplicationBase] = None,
-        name: str = None,
-        image: str = None,
-        handler: str = None,
-        with_repo: bool = None,
-        tag: str = None,
-        requirements: typing.Union[str, list[str]] = None,
+        func: typing.Union[str, mlrun.runtimes.BaseRuntime, None] = None,
+        application_class: typing.Union[
+            str, ModelMonitoringApplicationBase, None
+        ] = None,
+        name: typing.Optional[str] = None,
+        image: typing.Optional[str] = None,
+        handler: typing.Optional[str] = None,
+        with_repo: typing.Optional[bool] = None,
+        tag: typing.Optional[str] = None,
+        requirements: typing.Union[str, list[str], None] = None,
         requirements_file: str = "",
         **application_kwargs,
     ) -> tuple[str, mlrun.runtimes.BaseRuntime, dict]:
+        import mlrun.model_monitoring.api
+
         function_object: RemoteRuntime = None
         kind = None
         if (isinstance(func, str) or func is None) and application_class is not None:
-            kind = "serving"
-            if func is None:
-                func = ""
-            func = mlrun.code_to_function(
-                filename=func,
+            kind = mlrun.run.RuntimeKinds.serving
+            func = mlrun.model_monitoring.api._create_model_monitoring_function_base(
+                project=self.name,
+                func=func,
+                application_class=application_class,
                 name=name,
-                project=self.metadata.name,
-                tag=tag,
-                kind=kind,
                 image=image,
+                tag=tag,
                 requirements=requirements,
                 requirements_file=requirements_file,
+                **application_kwargs,
             )
-            graph = func.set_topology("flow")
-            if isinstance(application_class, str):
-                first_step = graph.to(
-                    class_name=application_class, **application_kwargs
-                )
-            else:
-                first_step = graph.to(class_name=application_class)
-            first_step.to(
-                class_name=PushToMonitoringWriter(
-                    project=self.metadata.name,
-                    writer_application_name=mm_constants.MonitoringFunctionNames.WRITER,
-                    stream_uri=None,
-                ),
-            ).respond()
         elif isinstance(func, str) and isinstance(handler, str):
-            kind = "nuclio"
+            kind = mlrun.run.RuntimeKinds.nuclio
 
         (
             resolved_function_name,
             tag,
             function_object,
             func,
         ) = self._instantiate_function(
@@ -1990,20 +1972,18 @@
             image,
             handler,
             with_repo,
             tag,
             requirements,
             requirements_file,
         )
-        models_names = "all"
         function_object.set_label(
             mm_constants.ModelMonitoringAppLabel.KEY,
             mm_constants.ModelMonitoringAppLabel.VAL,
         )
-        function_object.set_label("models", models_names)
 
         if not mlrun.mlconf.is_ce_mode():
             function_object.apply(mlrun.mount_v3io())
 
         return resolved_function_name, function_object, func
 
     def enable_model_monitoring(
@@ -2025,42 +2005,46 @@
         :param default_controller_image:        Deprecated.
         :param base_period:                     The time period in minutes in which the model monitoring controller
                                                 function is triggered. By default, the base period is 10 minutes.
         :param image:                           The image of the model monitoring controller, writer, monitoring
                                                 stream & histogram data drift functions, which are real time nuclio
                                                 functions. By default, the image is mlrun/mlrun.
         :param deploy_histogram_data_drift_app: If true, deploy the default histogram-based data drift application.
-
-        :returns: model monitoring controller job as a dictionary.
         """
         if default_controller_image != "mlrun/mlrun":
             # TODO: Remove this in 1.9.0
             warnings.warn(
                 "'default_controller_image' is deprecated and will be removed in 1.9.0, "
                 "use 'image' instead",
                 FutureWarning,
             )
             image = default_controller_image
         db = mlrun.db.get_run_db(secrets=self._secrets)
         db.enable_model_monitoring(
             project=self.name,
             image=image,
             base_period=base_period,
+            deploy_histogram_data_drift_app=deploy_histogram_data_drift_app,
         )
-        if deploy_histogram_data_drift_app:
-            fn = self.set_model_monitoring_function(
-                func=str(
-                    pathlib.Path(__file__).parent.parent
-                    / "model_monitoring/applications/histogram_data_drift.py"
-                ),
-                name=mm_constants.MLRUN_HISTOGRAM_DATA_DRIFT_APP_NAME,
-                application_class="HistogramDataDriftApplication",
-                image=image,
-            )
-            fn.deploy()
+
+    def deploy_histogram_data_drift_app(
+        self,
+        *,
+        image: str = "mlrun/mlrun",
+        db: Optional[mlrun.db.RunDBInterface] = None,
+    ) -> None:
+        """
+        Deploy the histogram data drift application.
+
+        :param image: The image on which the application will run.
+        :param db:    An optional DB object.
+        """
+        if db is None:
+            db = mlrun.db.get_run_db(secrets=self._secrets)
+        db.deploy_histogram_data_drift_app(project=self.name, image=image)
 
     def update_model_monitoring_controller(
         self,
         base_period: int = 10,
         image: str = "mlrun/mlrun",
     ) -> None:
         """
@@ -2077,28 +2061,30 @@
         db = mlrun.db.get_run_db(secrets=self._secrets)
         db.update_model_monitoring_controller(
             project=self.name,
             base_period=base_period,
             image=image,
         )
 
-    def disable_model_monitoring(self):
+    def disable_model_monitoring(
+        self, *, delete_histogram_data_drift_app: bool = True
+    ) -> None:
+        """
+        Note: This method is currently not advised for use. See ML-3432.
+        Disable model monitoring by deleting the underlying functions infrastructure from MLRun database.
+
+        :param delete_histogram_data_drift_app: Whether to delete the histogram data drift app.
+        """
         db = mlrun.db.get_run_db(secrets=self._secrets)
-        db.delete_function(
-            project=self.name,
-            name=mm_constants.MonitoringFunctionNames.APPLICATION_CONTROLLER,
-        )
-        db.delete_function(
-            project=self.name,
-            name=mm_constants.MonitoringFunctionNames.WRITER,
-        )
-        db.delete_function(
-            project=self.name,
-            name=mm_constants.MonitoringFunctionNames.STREAM,
-        )
+        for fn_name in mm_constants.MonitoringFunctionNames.list():
+            db.delete_function(project=self.name, name=fn_name)
+        if delete_histogram_data_drift_app:
+            db.delete_function(
+                project=self.name, name=mm_constants.MLRUN_HISTOGRAM_DATA_DRIFT_APP_NAME
+            )
 
     def set_function(
         self,
         func: typing.Union[str, mlrun.runtimes.BaseRuntime] = None,
         name: str = "",
         kind: str = "",
         image: str = None,
@@ -2743,48 +2729,49 @@
             str, mlrun.common.schemas.ScheduleCronTrigger, bool
         ] = None,
         timeout: int = None,
         source: str = None,
         cleanup_ttl: int = None,
         notifications: list[mlrun.model.Notification] = None,
     ) -> _PipelineRunStatus:
-        """run a workflow using kubeflow pipelines
+        """Run a workflow using kubeflow pipelines
 
-        :param name:      name of the workflow
-        :param workflow_path:
-                          url to a workflow file, if not a project workflow
-        :param arguments:
-                          kubeflow pipelines arguments (parameters)
-        :param artifact_path:
-                          target path/url for workflow artifacts, the string
-                          '{{workflow.uid}}' will be replaced by workflow id
-        :param workflow_handler:
-                          workflow function handler (for running workflow function directly)
-        :param namespace: kubernetes namespace if other than default
-        :param sync:      force functions sync before run
-        :param watch:     wait for pipeline completion
-        :param dirty:     allow running the workflow when the git repo is dirty
-        :param engine:    workflow engine running the workflow.
-                          supported values are 'kfp' (default), 'local' or 'remote'.
-                          for setting engine for remote running use 'remote:local' or 'remote:kfp'.
-        :param local:     run local pipeline with local functions (set local=True in function.run())
+        :param name:                Name of the workflow
+        :param workflow_path:       URL to a workflow file, if not a project workflow
+        :param arguments:           Kubeflow pipelines arguments (parameters)
+        :param artifact_path:       Target path/URL for workflow artifacts, the string '{{workflow.uid}}' will be
+                                    replaced by workflow id.
+        :param workflow_handler:    Workflow function handler (for running workflow function directly)
+        :param namespace: Kubernetes namespace if other than default
+        :param sync:      Force functions sync before run
+        :param watch:     Wait for pipeline completion
+        :param dirty:     Allow running the workflow when the git repo is dirty
+        :param engine:    Workflow engine running the workflow.
+                          Supported values are 'kfp' (default), 'local' or 'remote'.
+                          For setting engine for remote running use 'remote:local' or 'remote:kfp'.
+        :param local:     Run local pipeline with local functions (set local=True in function.run())
         :param schedule:  ScheduleCronTrigger class instance or a standard crontab expression string
                           (which will be converted to the class using its `from_crontab` constructor),
                           see this link for help:
                           https://apscheduler.readthedocs.io/en/3.x/modules/triggers/cron.html#module-apscheduler.triggers.cron
                           for using the pre-defined workflow's schedule, set `schedule=True`
-        :param timeout:   timeout in seconds to wait for pipeline completion (watch will be activated)
-        :param source:    remote source to use instead of the actual `project.spec.source` (used when engine is remote).
-                          for other engines the source is to validate that the code is up-to-date
+        :param timeout:   Timeout in seconds to wait for pipeline completion (watch will be activated)
+        :param source:    Source to use instead of the actual `project.spec.source` (used when engine is remote).
+                          Can be a one of:
+                            1. Remote URL which is loaded dynamically to the workflow runner.
+                            2. A path to the project's context on the workflow runner's image.
+                          Path can be absolute or relative to `project.spec.build.source_code_target_dir` if defined
+                          (enriched when building a project image with source, see `MlrunProject.build_image`).
+                          For other engines the source is used to validate that the code is up-to-date.
         :param cleanup_ttl:
-                          pipeline cleanup ttl in secs (time to wait after workflow completion, at which point the
-                          workflow and all its resources are deleted)
+                          Pipeline cleanup ttl in secs (time to wait after workflow completion, at which point the
+                          Workflow and all its resources are deleted)
         :param notifications:
-                          list of notifications to send for workflow completion
-        :returns: run id
+                          List of notifications to send for workflow completion
+        :returns: Run id
         """
 
         arguments = arguments or {}
         need_repo = self.spec._need_repo()
         if self.spec.repo and self.spec.repo.is_dirty():
             msg = "You seem to have uncommitted git changes, use .push()"
             if dirty or not need_repo:
@@ -3175,14 +3162,15 @@
         commands: list = None,
         secret_name: str = None,
         requirements: typing.Union[str, list[str]] = None,
         overwrite_build_params: bool = False,
         requirements_file: str = None,
         builder_env: dict = None,
         extra_args: str = None,
+        source_code_target_dir: str = None,
     ):
         """specify builder configuration for the project
 
         :param image: target image name/path. If not specified the project's existing `default_image` name will be
             used. If not set, the `mlconf.default_project_image_name` value will be used
         :param set_as_default: set `image` to be the project's default image (default False)
         :param with_mlrun: add the current mlrun package to the container build
@@ -3195,14 +3183,16 @@
             requirements and commands)
             * False: The new params are merged with the existing
             * True: The existing params are replaced by the new ones
         :param builder_env: Kaniko builder pod env vars dict (for config/credentials)
             e.g. builder_env={"GIT_TOKEN": token}, does not work yet in KFP
         :param extra_args:  A string containing additional builder arguments in the format of command-line options,
             e.g. extra_args="--skip-tls-verify --build-arg A=val"
+        :param source_code_target_dir: Path on the image where source code would be extracted
+            (by default `/home/mlrun_code`)
         """
         if not overwrite_build_params:
             # TODO: change overwrite_build_params default to True in 1.8.0
             warnings.warn(
                 "The `overwrite_build_params` parameter default will change from 'False' to 'True' in 1.8.0.",
                 mlrun.utils.OverwriteBuildParamsWarning,
             )
@@ -3218,14 +3208,15 @@
             secret=secret_name,
             with_mlrun=with_mlrun,
             requirements=requirements,
             requirements_file=requirements_file,
             overwrite=overwrite_build_params,
             builder_env=builder_env,
             extra_args=extra_args,
+            source_code_target_dir=source_code_target_dir,
         )
 
         if set_as_default and image != self.default_image:
             self.set_default_image(image)
 
     def build_image(
         self,
@@ -3264,15 +3255,15 @@
         :param builder_env:     Kaniko builder pod env vars dict (for config/credentials)
             e.g. builder_env={"GIT_TOKEN": token}, does not work yet in KFP
         :param overwrite_build_params:  Overwrite existing build configuration (currently applies to
             requirements and commands)
             * False: The new params are merged with the existing
             * True: The existing params are replaced by the new ones
         :param extra_args:  A string containing additional builder arguments in the format of command-line options,
-            e.g. extra_args="--skip-tls-verify --build-arg A=val"r
+            e.g. extra_args="--skip-tls-verify --build-arg A=val"
         :param target_dir: Path on the image where source code would be extracted (by default `/home/mlrun_code`)
         """
         if not base_image:
             base_image = mlrun.mlconf.default_base_image
             logger.info(
                 "Base image not specified, using default base image",
                 base_image=base_image,
@@ -3332,14 +3323,19 @@
                 overwrite_build_params=overwrite_build_params,
                 mlrun_version_specifier=mlrun_version_specifier,
                 builder_env=builder_env,
                 extra_args=extra_args,
                 force_build=True,
             )
 
+            # Get the enriched target dir from the function
+            self.spec.build.source_code_target_dir = (
+                function.spec.build.source_code_target_dir
+            )
+
         try:
             mlrun.db.get_run_db(secrets=self._secrets).delete_function(
                 name=function.metadata.name
             )
         except Exception as exc:
             logger.warning(
                 f"Image was successfully built, but failed to delete temporary function {function.metadata.name}."
@@ -3745,14 +3741,26 @@
 
         Returns:
             mlrun.runtimes.nuclio.APIGateway: An instance of APIGateway.
         """
 
         return mlrun.db.get_run_db().get_api_gateway(name=name, project=self.name)
 
+    def delete_api_gateway(
+        self,
+        name: str,
+    ):
+        """
+        Deletes an API gateway by name.
+
+        :param name: The name of the API gateway to delete.
+        """
+
+        mlrun.db.get_run_db().delete_api_gateway(name=name, project=self.name)
+
     def _run_authenticated_git_action(
         self,
         action: Callable,
         remote: str,
         args: list = [],
         kwargs: dict = {},
         secrets: Union[SecretsStore, dict] = None,
```

## mlrun/runtimes/base.py

```diff
@@ -836,14 +836,20 @@
         build = self.spec.build
         return (
             build.commands
             or build.requirements
             or (build.source and not build.load_source_on_run)
         )
 
+    def enrich_runtime_spec(
+        self,
+        project_node_selector: dict[str, str],
+    ):
+        pass
+
     def prepare_image_for_deploy(self):
         """
         if a function has a 'spec.image' it is considered to be deployed,
         but because we allow the user to set 'spec.image' for usability purposes,
         we need to check whether this is a built image or it requires to be built on top.
         """
         launcher = mlrun.launcher.factory.LauncherFactory().create_launcher(
```

## mlrun/runtimes/pod.py

```diff
@@ -1053,14 +1053,40 @@
     def is_env_exists(self, name):
         """Check whether there is an environment variable define for the given key"""
         for env_var in self.spec.env:
             if get_item_name(env_var) == name:
                 return True
         return False
 
+    def enrich_runtime_spec(
+        self,
+        project_node_selector: dict[str, str],
+    ):
+        """
+        Enriches the runtime spec with the project-level node selector.
+
+        This method merges the project-level node selector with the existing function node_selector.
+        The merge logic used here combines the two dictionaries, giving precedence to
+        the keys in the runtime node_selector. If there are conflicting keys between the
+        two dictionaries, the values from self.spec.node_selector will overwrite the
+        values from project_node_selector.
+
+        Example:
+        Suppose self.spec.node_selector = {"type": "gpu", "zone": "us-east-1"}
+        and project_node_selector = {"type": "cpu", "environment": "production"}.
+        After the merge, the resulting node_selector will be:
+        {"type": "gpu", "zone": "us-east-1", "environment": "production"}
+
+        Note:
+        - The merge uses the ** operator, also known as the "unpacking" operator in Python,
+          combining key-value pairs from each dictionary. Later dictionaries take precedence
+          when there are conflicting keys.
+        """
+        self.spec.node_selector = {**project_node_selector, **self.spec.node_selector}
+
     def _set_env(self, name, value=None, value_from=None):
         new_var = k8s_client.V1EnvVar(name=name, value=value, value_from=value_from)
         i = 0
         for v in self.spec.env:
             if get_item_name(v) == name:
                 self.spec.env[i] = new_var
                 return self
```

## mlrun/runtimes/nuclio/api_gateway.py

```diff
@@ -8,30 +8,93 @@
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 import base64
+import typing
 from typing import Optional, Union
 from urllib.parse import urljoin
 
 import requests
+from requests.auth import HTTPBasicAuth
 
 import mlrun
 import mlrun.common.schemas
 
-from .function import RemoteRuntime
+from .function import RemoteRuntime, get_fullname
 from .serving import ServingRuntime
 
 NUCLIO_API_GATEWAY_AUTHENTICATION_MODE_BASIC_AUTH = "basicAuth"
 NUCLIO_API_GATEWAY_AUTHENTICATION_MODE_NONE = "none"
 PROJECT_NAME_LABEL = "nuclio.io/project-name"
 
 
+class APIGatewayAuthenticator(typing.Protocol):
+    @property
+    def authentication_mode(self) -> str:
+        return NUCLIO_API_GATEWAY_AUTHENTICATION_MODE_NONE
+
+    @classmethod
+    def from_scheme(cls, api_gateway_spec: mlrun.common.schemas.APIGatewaySpec):
+        if (
+            api_gateway_spec.authenticationMode
+            == NUCLIO_API_GATEWAY_AUTHENTICATION_MODE_BASIC_AUTH
+        ):
+            if api_gateway_spec.authentication:
+                return BasicAuth(
+                    username=api_gateway_spec.authentication.get("username", ""),
+                    password=api_gateway_spec.authentication.get("password", ""),
+                )
+            else:
+                return BasicAuth()
+        else:
+            return NoneAuth()
+
+    def to_scheme(
+        self,
+    ) -> Optional[dict[str, Optional[mlrun.common.schemas.APIGatewayBasicAuth]]]:
+        return None
+
+
+class NoneAuth(APIGatewayAuthenticator):
+    """
+    An API gateway authenticator with no authentication.
+    """
+
+    pass
+
+
+class BasicAuth(APIGatewayAuthenticator):
+    """
+    An API gateway authenticator with basic authentication.
+
+    :param username: (str) The username for basic authentication.
+    :param password: (str) The password for basic authentication.
+    """
+
+    def __init__(self, username=None, password=None):
+        self._username = username
+        self._password = password
+
+    @property
+    def authentication_mode(self) -> str:
+        return NUCLIO_API_GATEWAY_AUTHENTICATION_MODE_BASIC_AUTH
+
+    def to_scheme(
+        self,
+    ) -> Optional[dict[str, Optional[mlrun.common.schemas.APIGatewayBasicAuth]]]:
+        return {
+            "authentication": mlrun.common.schemas.APIGatewayBasicAuth(
+                username=self._username, password=self._password
+            )
+        }
+
+
 class APIGateway:
     def __init__(
         self,
         project,
         name: str,
         functions: Union[
             list[str],
@@ -43,82 +106,158 @@
                     ]
                 ],
                 Union[RemoteRuntime, ServingRuntime],
             ],
         ],
         description: str = "",
         path: str = "/",
-        authentication_mode: Optional[
-            str
-        ] = NUCLIO_API_GATEWAY_AUTHENTICATION_MODE_NONE,
+        authentication: Optional[APIGatewayAuthenticator] = NoneAuth(),
         host: Optional[str] = None,
         canary: Optional[list[int]] = None,
-        username: Optional[str] = None,
-        password: Optional[str] = None,
     ):
+        """
+        Initialize the APIGateway instance.
+
+        :param project: The project name
+        :param name: The name of the API gateway
+        :param functions: The list of functions associated with the API gateway
+            Can be a list of function names (["my-func1", "my-func2"])
+            or a list or a single entity of
+            :py:class:`~mlrun.runtimes.nuclio.function.RemoteRuntime` OR
+            :py:class:`~mlrun.runtimes.nuclio.serving.ServingRuntime`
+
+        :param description: Optional description of the API gateway
+        :param path: Optional path of the API gateway, default value is "/"
+        :param authentication: The authentication for the API gateway of type
+                :py:class:`~mlrun.runtimes.nuclio.api_gateway.BasicAuth`
+        :param host:  The host of the API gateway (optional). If not set, it will be automatically generated
+        :param canary: The canary percents for the API gateway of type list[int]; for instance: [20,80]
+        """
         self.functions = None
         self._validate(
             project=project,
             functions=functions,
             name=name,
             canary=canary,
-            username=username,
-            password=password,
         )
         self.project = project
         self.name = name
         self.host = host
 
         self.path = path
         self.description = description
-        self.authentication_mode = (
-            authentication_mode
-            if authentication_mode
-            else self._enrich_authentication_mode(username=username, password=password)
-        )
         self.canary = canary
-        self._username = username
-        self._password = password
+        self.authentication = authentication
 
     def invoke(
         self,
         method="POST",
         headers: dict = {},
         auth: Optional[tuple[str, str]] = None,
         **kwargs,
     ):
+        """
+        Invoke the API gateway.
+
+        :param method: (str, optional) The HTTP method for the invocation.
+        :param headers: (dict, optional) The HTTP headers for the invocation.
+        :param auth: (Optional[tuple[str, str]], optional) The authentication creds for the invocation if required.
+        :param kwargs: (dict) Additional keyword arguments.
+
+        :return: The response from the API gateway invocation.
+        """
         if not self.invoke_url:
-            raise mlrun.errors.MLRunInvalidArgumentError(
-                "Invocation url is not set. Set up gateway's `invoke_url` attribute."
-            )
+            # try to resolve invoke_url before fail
+            self.sync()
+            if not self.invoke_url:
+                raise mlrun.errors.MLRunInvalidArgumentError(
+                    "Invocation url is not set. Set up gateway's `invoke_url` attribute."
+                )
         if (
-            self.authentication_mode
+            self.authentication.authentication_mode
             == NUCLIO_API_GATEWAY_AUTHENTICATION_MODE_BASIC_AUTH
             and not auth
         ):
             raise mlrun.errors.MLRunInvalidArgumentError(
                 "API Gateway invocation requires authentication. Please pass credentials"
             )
-        if auth:
-            headers["Authorization"] = self._generate_basic_auth(*auth)
         return requests.request(
-            method=method, url=self.invoke_url, headers=headers, **kwargs
+            method=method,
+            url=self.invoke_url,
+            headers=headers,
+            **kwargs,
+            auth=HTTPBasicAuth(*auth) if auth else None,
         )
 
+    def sync(self):
+        """
+        Synchronize the API gateway from the server.
+        """
+        synced_gateway = mlrun.get_run_db().get_api_gateway(self.name, self.project)
+        synced_gateway = self.from_scheme(synced_gateway)
+
+        self.host = synced_gateway.host
+        self.path = synced_gateway.path
+        self.authentication = synced_gateway.authentication
+        self.functions = synced_gateway.functions
+        self.canary = synced_gateway.canary
+        self.description = synced_gateway.description
+
+    def with_basic_auth(self, username: str, password: str):
+        """
+        Set basic authentication for the API gateway.
+
+        :param username: (str) The username for basic authentication.
+        :param password: (str) The password for basic authentication.
+        """
+        self.authentication = BasicAuth(username=username, password=password)
+
+    def with_canary(
+        self,
+        functions: Union[
+            list[str],
+            list[
+                Union[
+                    RemoteRuntime,
+                    ServingRuntime,
+                ]
+            ],
+        ],
+        canary: list[int],
+    ):
+        """
+        Set canary function for the API gateway
+
+        :param functions: The list of functions associated with the API gateway
+            Can be a list of function names (["my-func1", "my-func2"])
+            or a list of nuclio functions of types
+            :py:class:`~mlrun.runtimes.nuclio.function.RemoteRuntime` OR
+            :py:class:`~mlrun.runtimes.nuclio.serving.ServingRuntime`
+        :param canary: The canary percents for the API gateway of type list[int]; for instance: [20,80]
+
+        """
+        if len(functions) != 2:
+            raise mlrun.errors.MLRunInvalidArgumentError(
+                f"Gateway with canary can be created only with two functions, "
+                f"the number of functions passed is {len(functions)}"
+            )
+        self.functions = self._validate_functions(self.project, functions)
+        self.canary = self._validate_canary(canary)
+
     @classmethod
     def from_scheme(cls, api_gateway: mlrun.common.schemas.APIGateway):
         project = api_gateway.metadata.labels.get(PROJECT_NAME_LABEL)
         functions, canary = cls._resolve_canary(api_gateway.spec.upstreams)
         return cls(
             project=project,
             description=api_gateway.spec.description,
             name=api_gateway.spec.name,
             host=api_gateway.spec.host,
             path=api_gateway.spec.path,
-            authentication_mode=str(api_gateway.spec.authenticationMode),
+            authentication=APIGatewayAuthenticator.from_scheme(api_gateway.spec),
             functions=functions,
             canary=canary,
         )
 
     def to_scheme(self) -> mlrun.common.schemas.APIGateway:
         upstreams = (
             [
@@ -137,34 +276,34 @@
             ]
         )
         api_gateway = mlrun.common.schemas.APIGateway(
             metadata=mlrun.common.schemas.APIGatewayMetadata(name=self.name, labels={}),
             spec=mlrun.common.schemas.APIGatewaySpec(
                 name=self.name,
                 description=self.description,
+                host=self.host,
                 path=self.path,
-                authentication_mode=mlrun.common.schemas.APIGatewayAuthenticationMode.from_str(
-                    self.authentication_mode
+                authenticationMode=mlrun.common.schemas.APIGatewayAuthenticationMode.from_str(
+                    self.authentication.authentication_mode
                 ),
                 upstreams=upstreams,
             ),
         )
-        if (
-            self.authentication_mode
-            is NUCLIO_API_GATEWAY_AUTHENTICATION_MODE_BASIC_AUTH
-        ):
-            api_gateway.spec.authentication = mlrun.common.schemas.APIGatewayBasicAuth(
-                username=self._username, password=self._password
-            )
+        api_gateway.spec.authentication = self.authentication.to_scheme()
         return api_gateway
 
     @property
     def invoke_url(
         self,
     ):
+        """
+        Get the invoke URL.
+
+        :return: (str) The invoke URL.
+        """
         return urljoin(self.host, self.path)
 
     def _validate(
         self,
         name: str,
         project: str,
         functions: Union[
@@ -176,46 +315,41 @@
                         ServingRuntime,
                     ]
                 ],
                 Union[RemoteRuntime, ServingRuntime],
             ],
         ],
         canary: Optional[list[int]] = None,
-        username: Optional[str] = None,
-        password: Optional[str] = None,
     ):
         if not name:
             raise mlrun.errors.MLRunInvalidArgumentError(
                 "API Gateway name cannot be empty"
             )
 
         self.functions = self._validate_functions(project=project, functions=functions)
 
         # validating canary
         if canary:
-            if len(self.functions) != len(canary):
-                raise mlrun.errors.MLRunInvalidArgumentError(
-                    "Function and canary lists lengths do not match"
-                )
-            for canary_percent in canary:
-                if canary_percent < 0 or canary_percent > 100:
-                    raise mlrun.errors.MLRunInvalidArgumentError(
-                        "The percentage value must be in the range from 0 to 100"
-                    )
-            if sum(canary) != 100:
+            self._validate_canary(canary)
+
+    def _validate_canary(self, canary: list[int]):
+        if len(self.functions) != len(canary):
+            raise mlrun.errors.MLRunInvalidArgumentError(
+                "Function and canary lists lengths do not match"
+            )
+        for canary_percent in canary:
+            if canary_percent < 0 or canary_percent > 100:
                 raise mlrun.errors.MLRunInvalidArgumentError(
-                    "The sum of canary function percents should be equal to 100"
+                    "The percentage value must be in the range from 0 to 100"
                 )
-
-        # validating auth
-        if username and not password:
-            raise mlrun.errors.MLRunInvalidArgumentError("Password is not specified")
-
-        if password and not username:
-            raise mlrun.errors.MLRunInvalidArgumentError("Username is not specified")
+        if sum(canary) != 100:
+            raise mlrun.errors.MLRunInvalidArgumentError(
+                "The sum of canary function percents should be equal to 100"
+            )
+        return canary
 
     @staticmethod
     def _validate_functions(
         project: str,
         functions: Union[
             list[str],
             Union[
@@ -253,26 +387,19 @@
                     f"Input function {function_name} is not a Nuclio function"
                 )
             if func.metadata.project != project:
                 raise mlrun.errors.MLRunInvalidArgumentError(
                     f"input function {function_name} "
                     f"does not belong to this project"
                 )
-            function_names.append(func.uri)
+            nuclio_name = get_fullname(function_name, project, func.metadata.tag)
+            function_names.append(nuclio_name)
         return function_names
 
     @staticmethod
-    def _enrich_authentication_mode(username, password):
-        return (
-            NUCLIO_API_GATEWAY_AUTHENTICATION_MODE_NONE
-            if username is not None and password is not None
-            else NUCLIO_API_GATEWAY_AUTHENTICATION_MODE_BASIC_AUTH
-        )
-
-    @staticmethod
     def _generate_basic_auth(username: str, password: str):
         token = base64.b64encode(f"{username}:{password}".encode()).decode()
         return f"Basic {token}"
 
     @staticmethod
     def _resolve_canary(
         upstreams: list[mlrun.common.schemas.APIGatewayUpstream],
```

## mlrun/runtimes/nuclio/function.py

```diff
@@ -771,14 +771,17 @@
             runtime_env["MLRUN_NAMESPACE"] = mlconf.namespace
         if self.metadata.credentials.access_key:
             runtime_env[
                 mlrun.runtimes.constants.FunctionEnvironmentVariables.auth_session
             ] = self.metadata.credentials.access_key
         return runtime_env
 
+    def _get_serving_spec(self):
+        return None
+
     def _get_nuclio_config_spec_env(self):
         env_dict = {}
         external_source_env_dict = {}
 
         api = client.ApiClient()
         for env_var in self.spec.env:
             # sanitize env if not sanitized
```

## mlrun/runtimes/nuclio/serving.py

```diff
@@ -10,25 +10,25 @@
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import json
 import os
+import warnings
 from copy import deepcopy
-from typing import Union
+from typing import TYPE_CHECKING, Optional, Union
 
 import nuclio
 from nuclio import KafkaTrigger
 
 import mlrun
 import mlrun.common.schemas
 from mlrun.datastore import parse_kafka_url
 from mlrun.model import ObjectList
-from mlrun.model_monitoring.tracking_policy import TrackingPolicy
 from mlrun.runtimes.function_reference import FunctionReference
 from mlrun.secrets import SecretsStore
 from mlrun.serving.server import GraphServer, create_graph_server
 from mlrun.serving.states import (
     RootFlowStep,
     RouterStep,
     StepKinds,
@@ -39,14 +39,18 @@
 )
 from mlrun.utils import get_caller_globals, logger, set_paths
 
 from .function import NuclioSpec, RemoteRuntime
 
 serving_subkind = "serving_v2"
 
+if TYPE_CHECKING:
+    # remove this block in 1.9.0
+    from mlrun.model_monitoring import TrackingPolicy
+
 
 def new_v2_model_server(
     name,
     model_class: str,
     models: dict = None,
     filename="",
     protocol="",
@@ -287,74 +291,70 @@
             if class_name and hasattr(class_name, "to_dict"):
                 _, step = params_to_step(class_name, None)
                 if step.kind != StepKinds.router:
                     raise mlrun.errors.MLRunInvalidArgumentError(
                         "provided class is not a router step, must provide a router class in router topology"
                     )
             else:
-                step = RouterStep(class_name=class_name, class_args=class_args)
+                step = RouterStep(
+                    class_name=class_name, class_args=class_args, engine=engine
+                )
             self.spec.graph = step
         elif topology == StepKinds.flow:
             self.spec.graph = RootFlowStep(engine=engine)
         else:
             raise mlrun.errors.MLRunInvalidArgumentError(
                 f"unsupported topology {topology}, use 'router' or 'flow'"
             )
         return self.spec.graph
 
     def set_tracking(
         self,
-        stream_path: str = None,
-        batch: int = None,
-        sample: int = None,
-        stream_args: dict = None,
-        tracking_policy: Union[TrackingPolicy, dict] = None,
-    ):
+        stream_path: Optional[str] = None,
+        batch: Optional[int] = None,
+        sample: Optional[int] = None,
+        stream_args: Optional[dict] = None,
+        tracking_policy: Optional[Union["TrackingPolicy", dict]] = None,
+    ) -> None:
         """apply on your serving function to monitor a deployed model, including real-time dashboards to detect drift
            and analyze performance.
 
         :param stream_path:     Path/url of the tracking stream e.g. v3io:///users/mike/mystream
                                 you can use the "dummy://" path for test/simulation.
         :param batch:           Micro batch size (send micro batches of N records at a time).
         :param sample:          Sample size (send only one of N records).
         :param stream_args:     Stream initialization parameters, e.g. shards, retention_in_hours, ..
-        :param tracking_policy: Tracking policy object or a dictionary that will be converted into a tracking policy
-                                object. By using TrackingPolicy, the user can apply his model monitoring requirements,
-                                such as setting the scheduling policy of the model monitoring batch job or changing
-                                the image of the model monitoring stream.
 
                                 example::
 
                                     # initialize a new serving function
                                     serving_fn = mlrun.import_function("hub://v2-model-server", new_name="serving")
-                                    # apply model monitoring and set monitoring batch job to run every 3 hours
-                                    tracking_policy = {'default_batch_intervals':"0 */3 * * *"}
-                                    serving_fn.set_tracking(tracking_policy=tracking_policy)
+                                    # apply model monitoring
+                                    serving_fn.set_tracking()
 
         """
-
         # Applying model monitoring configurations
         self.spec.track_models = True
-        self.spec.tracking_policy = None
-        if tracking_policy:
-            if isinstance(tracking_policy, dict):
-                # Convert tracking policy dictionary into `model_monitoring.TrackingPolicy` object
-                self.spec.tracking_policy = TrackingPolicy.from_dict(tracking_policy)
-            else:
-                # Tracking_policy is already a `model_monitoring.TrackingPolicy` object
-                self.spec.tracking_policy = tracking_policy
 
         if stream_path:
             self.spec.parameters["log_stream"] = stream_path
         if batch:
             self.spec.parameters["log_stream_batch"] = batch
         if sample:
             self.spec.parameters["log_stream_sample"] = sample
         if stream_args:
             self.spec.parameters["stream_args"] = stream_args
+        if tracking_policy is not None:
+            warnings.warn(
+                "The `tracking_policy` argument is deprecated from version 1.7.0 "
+                "and has no effect. It will be removed in 1.9.0.\n"
+                "To set the desired model monitoring time window and schedule, use "
+                "the `base_period` argument in `project.enable_model_monitoring()`.",
+                FutureWarning,
+            )
 
     def add_model(
         self,
         key: str,
         model_path: str = None,
         class_name: str = None,
         model_url: str = None,
@@ -640,40 +640,36 @@
             tag,
             verbose,
             auth_info,
             builder_env=builder_env,
             force_build=force_build,
         )
 
-    def _get_runtime_env(self):
-        env = super()._get_runtime_env()
+    def _get_serving_spec(self):
         function_name_uri_map = {f.name: f.uri(self) for f in self.spec.function_refs}
 
         serving_spec = {
             "function_uri": self._function_uri(),
             "version": "v2",
             "parameters": self.spec.parameters,
             "graph": self.spec.graph.to_dict() if self.spec.graph else {},
             "load_mode": self.spec.load_mode,
             "functions": function_name_uri_map,
             "graph_initializer": self.spec.graph_initializer,
             "error_stream": self.spec.error_stream,
             "track_models": self.spec.track_models,
-            "tracking_policy": self.spec.tracking_policy.to_dict()
-            if self.spec.tracking_policy
-            else None,
+            "tracking_policy": None,
             "default_content_type": self.spec.default_content_type,
         }
 
         if self.spec.secret_sources:
             self._secrets = SecretsStore.from_list(self.spec.secret_sources)
             serving_spec["secret_sources"] = self._secrets.to_serial()
 
-        env["SERVING_SPEC_ENV"] = json.dumps(serving_spec)
-        return env
+        return json.dumps(serving_spec)
 
     def to_mock_server(
         self,
         namespace=None,
         current_function="*",
         track_models=False,
         workdir=None,
```

## mlrun/serving/server.py

```diff
@@ -19,14 +19,15 @@
 import os
 import socket
 import traceback
 import uuid
 from typing import Optional, Union
 
 import mlrun
+import mlrun.common.constants
 import mlrun.common.helpers
 import mlrun.model_monitoring
 from mlrun.config import config
 from mlrun.errors import err_to_str
 from mlrun.secrets import SecretsStore
 
 from ..common.helpers import parse_versioned_object_uri
@@ -307,19 +308,16 @@
         """wait for async operation to complete"""
         return self.graph.wait_for_completion()
 
 
 def v2_serving_init(context, namespace=None):
     """hook for nuclio init_context()"""
 
-    data = os.environ.get("SERVING_SPEC_ENV", "")
-    if not data:
-        raise MLRunInvalidArgumentError("failed to find spec env var")
-    spec = json.loads(data)
     context.logger.info("Initializing server from spec")
+    spec = mlrun.utils.get_serving_spec()
     server = GraphServer.from_dict(spec)
     if config.log_level.lower() == "debug":
         server.verbose = True
     if hasattr(context, "trigger"):
         server.http_trigger = getattr(context.trigger, "kind", "http") == "http"
     context.logger.info_with(
         "Setting current function",
@@ -351,27 +349,27 @@
     ):
         context.logger.info(
             "Setting termination callback to terminate graph on worker shutdown"
         )
 
         async def termination_callback():
             context.logger.info("Termination callback called")
-            await server.wait_for_completion()
+            server.wait_for_completion()
             context.logger.info("Termination of async flow is completed")
 
         context.platform.set_termination_callback(termination_callback)
 
     if hasattr(context, "platform") and hasattr(context.platform, "set_drain_callback"):
         context.logger.info(
             "Setting drain callback to terminate and restart the graph on a drain event (such as rebalancing)"
         )
 
         async def drain_callback():
             context.logger.info("Drain callback called")
-            await server.wait_for_completion()
+            server.wait_for_completion()
             context.logger.info(
                 "Termination of async flow is completed. Rerunning async flow."
             )
             # Rerun the flow without reconstructing it
             server.graph._run_async_flow()
             context.logger.info("Async flow restarted")
```

## mlrun/serving/states.py

```diff
@@ -10,15 +10,14 @@
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 __all__ = ["TaskStep", "RouterStep", "RootFlowStep", "ErrorStep"]
 
-import asyncio
 import os
 import pathlib
 import traceback
 from copy import copy, deepcopy
 from inspect import getfullargspec, signature
 from typing import Union
 
@@ -587,39 +586,42 @@
 
 
 class RouterStep(TaskStep):
     """router step, implement routing logic for running child routes"""
 
     kind = "router"
     default_shape = "doubleoctagon"
-    _dict_fields = _task_step_fields + ["routes"]
+    _dict_fields = _task_step_fields + ["routes", "engine"]
     _default_class = "mlrun.serving.ModelRouter"
 
     def __init__(
         self,
         class_name: Union[str, type] = None,
         class_args: dict = None,
         handler: str = None,
         routes: list = None,
         name: str = None,
         function: str = None,
         input_path: str = None,
         result_path: str = None,
+        engine: str = None,
     ):
         super().__init__(
             class_name,
             class_args,
             handler,
             name=name,
             function=function,
             input_path=input_path,
             result_path=result_path,
         )
         self._routes: ObjectDict = None
         self.routes = routes
+        self.engine = engine
+        self._controller = None
 
     def get_children(self):
         """get child steps (routes)"""
         return self._routes.values()
 
     @property
     def routes(self):
@@ -681,14 +683,41 @@
                 route.function = self.function
             route.set_parent(self)
             route.init_object(context, namespace, mode, reset=reset)
 
         self._set_error_handler()
         self._post_init(mode)
 
+        if self.engine == "async":
+            self._build_async_flow()
+            self._run_async_flow()
+
+    def _build_async_flow(self):
+        """initialize and build the async/storey DAG"""
+
+        self.respond()
+        source, self._wait_for_result = _init_async_objects(self.context, [self])
+        source.to(self.async_object)
+
+        self._async_flow = source
+
+    def _run_async_flow(self):
+        self._controller = self._async_flow.run()
+
+    def run(self, event, *args, **kwargs):
+        if self._controller:
+            # async flow (using storey)
+            event._awaitable_result = None
+            resp = self._controller.emit(
+                event, return_awaitable_result=self._wait_for_result
+            )
+            return resp.await_result()
+
+        return super().run(event, *args, **kwargs)
+
     def __getitem__(self, name):
         return self._routes[name]
 
     def __setitem__(self, name, route):
         self.add_route(name, route)
 
     def __delitem__(self, key):
@@ -1201,26 +1230,17 @@
             next_obj = self[next[0]] if next else None
         return event
 
     def wait_for_completion(self):
         """wait for completion of run in async flows"""
 
         if self._controller:
-            if asyncio.iscoroutinefunction(self._controller.await_termination):
-
-                async def terminate_and_await_termination():
-                    if hasattr(self._controller, "terminate"):
-                        await self._controller.terminate()
-                    return await self._controller.await_termination()
-
-                return terminate_and_await_termination()
-            else:
-                if hasattr(self._controller, "terminate"):
-                    self._controller.terminate()
-                return self._controller.await_termination()
+            if hasattr(self._controller, "terminate"):
+                self._controller.terminate()
+            return self._controller.await_termination()
 
     def plot(self, filename=None, format=None, source=None, targets=None, **kw):
         """plot/save graph using graphviz
 
         :param filename:  target filepath for the graph image (None for the notebook)
         :param format:    the output format used for rendering (``'pdf'``, ``'png'``, etc.)
         :param source:    source step to add to the graph image
```

## mlrun/utils/helpers.py

```diff
@@ -1401,14 +1401,26 @@
 def as_number(field_name, field_value):
     if isinstance(field_value, str) and not field_value.isnumeric():
         raise ValueError(f"'{field_name}' must be numeric (str/int types)")
     return int(field_value)
 
 
 def filter_warnings(action, category):
+    """
+    Decorator to filter warnings
+
+    Example::
+        @filter_warnings("ignore", FutureWarning)
+        def my_function():
+            pass
+
+    :param action:      one of "error", "ignore", "always", "default", "module", or "once"
+    :param category:    a class that the warning must be a subclass of
+    """
+
     def decorator(function):
         def wrapper(*args, **kwargs):
             # context manager that copies and, upon exit, restores the warnings filter and the showwarning() function.
             with warnings.catch_warnings():
                 warnings.simplefilter(action, category)
                 return function(*args, **kwargs)
 
@@ -1558,7 +1570,29 @@
 
 def is_safe_path(base, filepath, is_symlink=False):
     # Avoid path traversal attacks by ensuring that the path is safe
     resolved_filepath = (
         os.path.abspath(filepath) if not is_symlink else os.path.realpath(filepath)
     )
     return base == os.path.commonpath((base, resolved_filepath))
+
+
+def get_serving_spec():
+    data = None
+
+    # we will have the serving spec in either mounted config map
+    # or env depending on the size of the spec and configuration
+
+    try:
+        with open(mlrun.common.constants.MLRUN_SERVING_SPEC_PATH) as f:
+            data = f.read()
+    except FileNotFoundError:
+        pass
+
+    if data is None:
+        data = os.environ.get("SERVING_SPEC_ENV", "")
+        if not data:
+            raise mlrun.errors.MLRunInvalidArgumentError(
+                "Failed to find serving spec in env var or config file"
+            )
+    spec = json.loads(data)
+    return spec
```

## mlrun/utils/version/version.json

### Pretty-printed

 * *Similarity: 0.5%*

 * *Differences: {"'git_commit'": "'06b1879c4a1857b20f07e805c46f51aa4ac74cef'", "'version'": "'1.7.0-rc7'"}*

```diff
@@ -1,4 +1,4 @@
 {
-    "git_commit": "cbfd1ee5f41bee97ff90efbce14bac0a56b58dce",
-    "version": "1.7.0-rc6"
+    "git_commit": "06b1879c4a1857b20f07e805c46f51aa4ac74cef",
+    "version": "1.7.0-rc7"
 }
```

## Comparing `mlrun/model_monitoring/stores/__init__.py` & `mlrun/model_monitoring/db/stores/__init__.py`

 * *Files 12% similar despite different names*

```diff
@@ -1,8 +1,8 @@
-# Copyright 2023 Iguazio
+# Copyright 2024 Iguazio
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #   http://www.apache.org/licenses/LICENSE-2.0
 #
@@ -12,68 +12,62 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 # flake8: noqa  - this is until we take care of the F401 violations with respect to __all__ & sphinx
 
 import enum
 import typing
+import warnings
 
 import mlrun.common.schemas.secret
 import mlrun.errors
 
-from .model_endpoint_store import ModelEndpointStore
+from .base import StoreBase
 
 
-class ModelEndpointStoreType(enum.Enum):
-    """Enum class to handle the different store type values for saving a model endpoint record."""
+class ObjectStoreFactory(enum.Enum):
+    """Enum class to handle the different store type values for saving model monitoring records."""
 
     v3io_nosql = "v3io-nosql"
     SQL = "sql"
 
-    def to_endpoint_store(
+    def to_object_store(
         self,
         project: str,
         access_key: str = None,
-        endpoint_store_connection: str = None,
         secret_provider: typing.Callable = None,
-    ) -> ModelEndpointStore:
+    ) -> StoreBase:
         """
-        Return a ModelEndpointStore object based on the provided enum value.
+        Return a StoreBase object based on the provided enum value.
 
-        :param project:                    The name of the project.
-        :param access_key:                 Access key with permission to the DB table. Note that if access key is None
-                                           and the endpoint target is from type KV then the access key will be
-                                           retrieved from the environment variable.
-        :param endpoint_store_connection: A valid connection string for model endpoint target. Contains several
-                                          key-value pairs that required for the database connection.
-                                          e.g. A root user with password 1234, tries to connect a schema called
-                                          mlrun within a local MySQL DB instance:
-                                          'mysql+pymysql://root:1234@localhost:3306/mlrun'.
+        :param project:                   The name of the project.
+        :param access_key:                Access key with permission to the DB table. Note that if access key is None
+                                          and the endpoint target is from type KV then the access key will be
+                                          retrieved from the environment variable.
         :param secret_provider:           An optional secret provider to get the connection string secret.
 
-        :return: `ModelEndpointStore` object.
+        :return: `StoreBase` object.
 
         """
 
-        if self.value == ModelEndpointStoreType.v3io_nosql.value:
-            from .kv_model_endpoint_store import KVModelEndpointStore
+        if self == self.v3io_nosql:
+            from mlrun.model_monitoring.db.stores.v3io_kv.kv_store import KVStoreBase
 
             # Get V3IO access key from env
             access_key = access_key or mlrun.mlconf.get_v3io_access_key()
 
-            return KVModelEndpointStore(project=project, access_key=access_key)
+            return KVStoreBase(project=project, access_key=access_key)
 
         # Assuming SQL store target if store type is not KV.
         # Update these lines once there are more than two store target types.
 
-        from .sql_model_endpoint_store import SQLModelEndpointStore
+        from mlrun.model_monitoring.db.stores.sqldb.sql_store import SQLStoreBase
 
-        return SQLModelEndpointStore(
+        return SQLStoreBase(
             project=project,
-            sql_connection_string=endpoint_store_connection,
             secret_provider=secret_provider,
         )
 
     @classmethod
     def _missing_(cls, value: typing.Any):
         """A lookup function to handle an invalid value.
         :param value: Provided enum (invalid) value.
@@ -84,28 +78,43 @@
         )
 
 
 def get_model_endpoint_store(
     project: str,
     access_key: str = None,
     secret_provider: typing.Callable = None,
-) -> ModelEndpointStore:
+) -> StoreBase:
+    # Leaving here for backwards compatibility
+    warnings.warn(
+        "The 'get_model_endpoint_store' function is deprecated and will be removed in 1.9.0. "
+        "Please use `get_store_object` instead.",
+        # TODO: remove in 1.9.0
+        FutureWarning,
+    )
+    return get_store_object(
+        project=project, access_key=access_key, secret_provider=secret_provider
+    )
+
+
+def get_store_object(
+    project: str,
+    access_key: str = None,
+    secret_provider: typing.Callable = None,
+) -> StoreBase:
     """
     Getting the DB target type based on mlrun.config.model_endpoint_monitoring.store_type.
 
     :param project:         The name of the project.
     :param access_key:      Access key with permission to the DB table.
     :param secret_provider: An optional secret provider to get the connection string secret.
 
-    :return: `ModelEndpointStore` object. Using this object, the user can apply different operations on the
-             model endpoint record such as write, update, get and delete.
+    :return: `StoreBase` object. Using this object, the user can apply different operations on the
+             model monitoring record such as write, update, get and delete a model endpoint.
     """
 
-    # Get store type value from ModelEndpointStoreType enum class
-    model_endpoint_store_type = ModelEndpointStoreType(
-        mlrun.mlconf.model_endpoint_monitoring.store_type
-    )
+    # Get store type value from ObjectStoreFactory enum class
+    store_type = ObjectStoreFactory(mlrun.mlconf.model_endpoint_monitoring.store_type)
 
-    # Convert into model endpoint store target object
-    return model_endpoint_store_type.to_endpoint_store(
+    # Convert into store target object
+    return store_type.to_object_store(
         project=project, access_key=access_key, secret_provider=secret_provider
     )
```

## Comparing `mlrun/model_monitoring/stores/kv_model_endpoint_store.py` & `mlrun/model_monitoring/db/stores/v3io_kv/kv_store.py`

 * *Files 18% similar despite different names*

```diff
@@ -12,33 +12,34 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 #
 
 import json
 import os
 import typing
+from http import HTTPStatus
 
 import v3io.dataplane
+import v3io.dataplane.response
 import v3io_frames
 
 import mlrun.common.model_monitoring.helpers
 import mlrun.common.schemas.model_monitoring
+import mlrun.model_monitoring.db
 import mlrun.utils.v3io_clients
 from mlrun.utils import logger
 
-from .model_endpoint_store import ModelEndpointStore
-
 # Fields to encode before storing in the KV table or to decode after retrieving
 fields_to_encode_decode = [
     mlrun.common.schemas.model_monitoring.EventFieldType.FEATURE_STATS,
     mlrun.common.schemas.model_monitoring.EventFieldType.CURRENT_STATS,
 ]
 
 
-class KVModelEndpointStore(ModelEndpointStore):
+class KVStoreBase(mlrun.model_monitoring.db.StoreBase):
     """
     Handles the DB operations when the DB target is from type KV. For the KV operations, we use an instance of V3IO
     client and usually the KV table can be found under v3io:///users/pipelines/project-name/model-endpoints/endpoints/.
     """
 
     def __init__(self, project: str, access_key: str):
         super().__init__(project=project)
@@ -390,14 +391,136 @@
                 metrics_mapping[metric] = values
 
         except v3io_frames.errors.ReadError:
             logger.warn("Failed to read tsdb", endpoint=endpoint_id)
 
         return metrics_mapping
 
+    def write_application_result(self, event: dict[str, typing.Any]):
+        """
+        Write a new application result event in the target table.
+
+        :param event: An event dictionary that represents the application result, should be corresponded to the
+                      schema defined in the :py:class:`~mlrun.common.schemas.model_monitoring.constants.WriterEvent`
+                      object.
+        """
+        endpoint_id = event.pop(
+            mlrun.common.schemas.model_monitoring.WriterEvent.ENDPOINT_ID
+        )
+        app_name = event.pop(
+            mlrun.common.schemas.model_monitoring.WriterEvent.APPLICATION_NAME
+        )
+        metric_name = event.pop(
+            mlrun.common.schemas.model_monitoring.WriterEvent.RESULT_NAME
+        )
+        attributes = {metric_name: json.dumps(event)}
+
+        v3io_monitoring_apps_container = self.get_v3io_monitoring_apps_container(
+            project_name=self.project
+        )
+
+        self.client.kv.update(
+            container=v3io_monitoring_apps_container,
+            table_path=endpoint_id,
+            key=app_name,
+            attributes=attributes,
+        )
+
+        schema_file = self.client.kv.new_cursor(
+            container=v3io_monitoring_apps_container,
+            table_path=endpoint_id,
+            filter_expression='__name==".#schema"',
+        )
+
+        if not schema_file.all():
+            logger.info(
+                "Generate a new V3IO KV schema file",
+                container=v3io_monitoring_apps_container,
+                endpoint_id=endpoint_id,
+            )
+            self._generate_kv_schema(endpoint_id, v3io_monitoring_apps_container)
+        logger.info("Updated V3IO KV successfully", key=app_name)
+
+    def _generate_kv_schema(
+        self, endpoint_id: str, v3io_monitoring_apps_container: str
+    ):
+        """Generate V3IO KV schema file which will be used by the model monitoring applications dashboard in Grafana."""
+        fields = [
+            {
+                "name": mlrun.common.schemas.model_monitoring.WriterEvent.RESULT_NAME,
+                "type": "string",
+                "nullable": False,
+            }
+        ]
+        res = self.client.kv.create_schema(
+            container=v3io_monitoring_apps_container,
+            table_path=endpoint_id,
+            key=mlrun.common.schemas.model_monitoring.WriterEvent.APPLICATION_NAME,
+            fields=fields,
+        )
+        if res.status_code != HTTPStatus.OK:
+            raise mlrun.errors.MLRunBadRequestError(
+                f"Couldn't infer schema for endpoint {endpoint_id} which is required for Grafana dashboards"
+            )
+        else:
+            logger.info(
+                "Generated V3IO KV schema successfully", endpoint_id=endpoint_id
+            )
+
+    def get_last_analyzed(self, endpoint_id: str, application_name: str) -> int:
+        """
+        Get the last analyzed time for the provided model endpoint and application.
+
+        :param endpoint_id:      The unique id of the model endpoint.
+        :param application_name: Registered application name.
+
+        :return: Timestamp as a Unix time.
+        :raise:  MLRunNotFoundError if last analyzed value is not found.
+
+        """
+        try:
+            data = self.client.kv.get(
+                container=self._get_monitoring_schedules_container(
+                    project_name=self.project
+                ),
+                table_path=endpoint_id,
+                key=application_name,
+            )
+            return data.output.item[
+                mlrun.common.schemas.model_monitoring.SchedulingKeys.LAST_ANALYZED
+            ]
+        except v3io.dataplane.response.HttpResponseError as err:
+            logger.debug("Error while getting last analyzed time", err=err)
+            raise mlrun.errors.MLRunNotFoundError(
+                f"No last analyzed value has been found for {application_name} "
+                f"that processes model endpoint {endpoint_id}",
+            )
+
+    def update_last_analyzed(
+        self, endpoint_id: str, application_name: str, last_analyzed: int
+    ):
+        """
+        Update the last analyzed time for the provided model endpoint and application.
+
+        :param endpoint_id:      The unique id of the model endpoint.
+        :param application_name: Registered application name.
+        :param last_analyzed:    Timestamp as a Unix time that represents the last analyzed time of a certain
+                                 application and model endpoint.
+        """
+        self.client.kv.put(
+            container=self._get_monitoring_schedules_container(
+                project_name=self.project
+            ),
+            table_path=endpoint_id,
+            key=application_name,
+            attributes={
+                mlrun.common.schemas.model_monitoring.SchedulingKeys.LAST_ANALYZED: last_analyzed
+            },
+        )
+
     def _generate_tsdb_paths(self) -> tuple[str, str]:
         """Generate a short path to the TSDB resources and a filtered path for the frames object
         :return: A tuple of:
              [0] = Short path to the TSDB resources
              [1] = Filtered path to TSDB events without schema and container
         """
         # Full path for the time series DB events
@@ -568,7 +691,15 @@
     @staticmethod
     def _decode_field(field: typing.Union[str, bytes]) -> str:
         """Decode a provided field. Mainly used when retrieving data from the KV table."""
 
         if isinstance(field, bytes):
             return field.decode()
         return field
+
+    @staticmethod
+    def get_v3io_monitoring_apps_container(project_name: str) -> str:
+        return f"users/pipelines/{project_name}/monitoring-apps"
+
+    @staticmethod
+    def _get_monitoring_schedules_container(project_name: str) -> str:
+        return f"users/pipelines/{project_name}/monitoring-schedules/functions"
```

## Comparing `mlrun/model_monitoring/stores/model_endpoint_store.py` & `mlrun/model_monitoring/db/stores/base/store.py`

 * *Files 16% similar despite different names*

```diff
@@ -1,36 +1,35 @@
-# Copyright 2023 Iguazio
+# Copyright 2024 Iguazio
 #
 # Licensed under the Apache License, Version 2.0 (the "License");
 # you may not use this file except in compliance with the License.
 # You may obtain a copy of the License at
 #
 #   http://www.apache.org/licenses/LICENSE-2.0
 #
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
-#
 
 import typing
 from abc import ABC, abstractmethod
 
 
-class ModelEndpointStore(ABC):
+class StoreBase(ABC):
     """
-    An abstract class to handle the model endpoint in the DB target.
+    An abstract class to handle the store object in the DB target.
     """
 
     def __init__(self, project: str):
         """
-        Initialize a new model endpoint target.
+        Initialize a new store target.
 
-        :param project:             The name of the project.
+        :param project: The name of the project.
         """
         self.project = project
 
     @abstractmethod
     def write_model_endpoint(self, endpoint: dict[str, typing.Any]):
         """
         Create a new endpoint record in the DB table.
@@ -139,7 +138,49 @@
                                  provided, the access key will be retrieved from the environment variables.
 
         :return: A dictionary of metrics in which the key is a metric name and the value is a list of tuples that
                  includes timestamps and the values.
         """
 
         pass
+
+    @abstractmethod
+    def write_application_result(self, event: dict[str, typing.Any]):
+        """
+        Write a new application result event in the target table.
+
+        :param event: An event dictionary that represents the application result, should be corresponded to the
+                      schema defined in the :py:class:`~mlrun.common.schemas.model_monitoring.constants.WriterEvent`
+                      object.
+        """
+        pass
+
+    @abstractmethod
+    def get_last_analyzed(self, endpoint_id: str, application_name: str) -> int:
+        """
+        Get the last analyzed time for the provided model endpoint and application.
+
+        :param endpoint_id:      The unique id of the model endpoint.
+        :param application_name: Registered application name.
+
+        :return: Timestamp as a Unix time.
+        :raise:  MLRunNotFoundError if last analyzed value is not found.
+        """
+        pass
+
+    @abstractmethod
+    def update_last_analyzed(
+        self,
+        endpoint_id: str,
+        application_name: str,
+        last_analyzed: int,
+    ):
+        """
+        Update the last analyzed time for the provided model endpoint and application.
+
+        :param endpoint_id:      The unique id of the model endpoint.
+        :param application_name: Registered application name.
+        :param last_analyzed:    Timestamp as a Unix time that represents the last analyzed time of a certain
+                                 application and model endpoint.
+
+        """
+        pass
```

## Comparing `mlrun/model_monitoring/stores/models/mysql.py` & `mlrun/model_monitoring/db/stores/sqldb/models/mysql.py`

 * *Files 23% similar despite different names*

```diff
@@ -9,26 +9,60 @@
 # Unless required by applicable law or agreed to in writing, software
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 import sqlalchemy.dialects.mysql
-from sqlalchemy import Column
-from sqlalchemy.ext.declarative import declarative_base
+from sqlalchemy import Column, ForeignKey, String
+from sqlalchemy.ext.declarative import declarative_base, declared_attr
 
-from mlrun.common.schemas.model_monitoring import EventFieldType
-
-from .base import ModelEndpointsBaseTable
+from mlrun.common.schemas.model_monitoring import (
+    EventFieldType,
+    WriterEvent,
+)
+
+from .base import (
+    ApplicationResultBaseTable,
+    ModelEndpointsBaseTable,
+    MonitoringSchedulesBaseTable,
+)
 
 Base = declarative_base()
 
 
 class ModelEndpointsTable(Base, ModelEndpointsBaseTable):
     first_request = Column(
         EventFieldType.FIRST_REQUEST,
         sqlalchemy.dialects.mysql.TIMESTAMP(fsp=3),
     )
     last_request = Column(
         EventFieldType.LAST_REQUEST,
         sqlalchemy.dialects.mysql.TIMESTAMP(fsp=3),
     )
+
+
+class ApplicationResultTable(Base, ApplicationResultBaseTable):
+    start_infer_time = Column(
+        WriterEvent.START_INFER_TIME,
+        sqlalchemy.dialects.mysql.TIMESTAMP(fsp=3),
+    )
+    end_infer_time = Column(
+        WriterEvent.END_INFER_TIME,
+        sqlalchemy.dialects.mysql.TIMESTAMP(fsp=3),
+    )
+
+    @declared_attr
+    def endpoint_id(cls):
+        return Column(
+            String(40),
+            ForeignKey(f"{EventFieldType.MODEL_ENDPOINTS}.{EventFieldType.UID}"),
+        )
+
+
+class MonitoringSchedulesTable(Base, MonitoringSchedulesBaseTable):
+    @declared_attr
+    def endpoint_id(cls):
+        return Column(
+            String(40),
+            ForeignKey(f"{EventFieldType.MODEL_ENDPOINTS}.{EventFieldType.UID}"),
+        )
```

## Comparing `mlrun/model_monitoring/stores/models/sqlite.py` & `mlrun/model_monitoring/db/stores/sqldb/models/sqlite.py`

 * *Files 22% similar despite different names*

```diff
@@ -10,14 +10,26 @@
 # distributed under the License is distributed on an "AS IS" BASIS,
 # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
 from sqlalchemy.ext.declarative import declarative_base
 
-from .base import ModelEndpointsBaseTable
+from .base import (
+    ApplicationResultBaseTable,
+    ModelEndpointsBaseTable,
+    MonitoringSchedulesBaseTable,
+)
 
 Base = declarative_base()
 
 
 class ModelEndpointsTable(Base, ModelEndpointsBaseTable):
     pass
+
+
+class ApplicationResultTable(Base, ApplicationResultBaseTable):
+    pass
+
+
+class MonitoringSchedulesTable(Base, MonitoringSchedulesBaseTable):
+    pass
```

## Comparing `mlrun-1.7.0rc6.dist-info/LICENSE` & `mlrun-1.7.0rc7.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `mlrun-1.7.0rc6.dist-info/METADATA` & `mlrun-1.7.0rc7.dist-info/METADATA`

 * *Files 2% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: mlrun
-Version: 1.7.0rc6
+Version: 1.7.0rc7
 Summary: Tracking and config of machine learning runs
 Home-page: https://github.com/mlrun/mlrun
 Author: Yaron Haviv
 Author-email: yaronh@iguazio.com
 License: Apache License 2.0
 Keywords: mlrun,mlops,data-science,machine-learning,experiment-tracking
 Classifier: Development Status :: 4 - Beta
@@ -32,29 +32,32 @@
 Requires-Dist: nuclio-jupyter ~=0.9.16
 Requires-Dist: numpy <1.27.0,>=1.16.5
 Requires-Dist: pandas <2.2,>=1.2
 Requires-Dist: pyarrow <15,>=10.0
 Requires-Dist: pyyaml ~=5.1
 Requires-Dist: requests ~=2.31
 Requires-Dist: tabulate ~=0.8.6
-Requires-Dist: v3io ~=0.6.2
+Requires-Dist: v3io ~=0.6.4
 Requires-Dist: pydantic >=1.10.8,~=1.10
 Requires-Dist: mergedeep ~=1.3
 Requires-Dist: v3io-frames ~=0.10.12
 Requires-Dist: semver ~=3.0
 Requires-Dist: dependency-injector ~=4.41
 Requires-Dist: fsspec ==2023.9.2
 Requires-Dist: v3iofs ~=0.1.17
-Requires-Dist: storey ~=1.7.5
+Requires-Dist: storey ~=1.7.6
 Requires-Dist: inflection ~=0.5.0
 Requires-Dist: python-dotenv ~=0.17.0
 Requires-Dist: setuptools ~=69.1
 Requires-Dist: deprecated ~=1.2
 Requires-Dist: jinja2 >=3.1.3,~=3.1
 Requires-Dist: orjson ~=3.9
+Provides-Extra: alibaba-oss
+Requires-Dist: ossfs ==2023.12.0 ; extra == 'alibaba-oss'
+Requires-Dist: oss2 ==2.18.1 ; extra == 'alibaba-oss'
 Provides-Extra: all
 Requires-Dist: adlfs ==2023.9.0 ; extra == 'all'
 Requires-Dist: aiobotocore <2.8,>=2.5.0 ; extra == 'all'
 Requires-Dist: avro ~=1.11 ; extra == 'all'
 Requires-Dist: azure-core ~=1.24 ; extra == 'all'
 Requires-Dist: azure-identity ~=1.5 ; extra == 'all'
 Requires-Dist: azure-keyvault-secrets ~=4.2 ; extra == 'all'
@@ -67,25 +70,27 @@
 Requires-Dist: google-cloud-bigquery[bqstorage,pandas] ==3.14.1 ; extra == 'all'
 Requires-Dist: google-cloud-storage ==2.14.0 ; extra == 'all'
 Requires-Dist: google-cloud ==0.34 ; extra == 'all'
 Requires-Dist: graphviz ~=0.20.0 ; extra == 'all'
 Requires-Dist: kafka-python ~=2.0 ; extra == 'all'
 Requires-Dist: mlflow ~=2.8 ; extra == 'all'
 Requires-Dist: msrest ~=0.6.21 ; extra == 'all'
+Requires-Dist: oss2 ==2.18.1 ; extra == 'all'
+Requires-Dist: ossfs ==2023.12.0 ; extra == 'all'
 Requires-Dist: plotly <5.12.0,~=5.4 ; extra == 'all'
 Requires-Dist: pyopenssl >=23 ; extra == 'all'
 Requires-Dist: redis ~=4.3 ; extra == 'all'
 Requires-Dist: s3fs ==2023.9.2 ; extra == 'all'
 Requires-Dist: sqlalchemy ~=1.4 ; extra == 'all'
 Provides-Extra: api
 Requires-Dist: uvicorn ~=0.27.1 ; extra == 'api'
 Requires-Dist: dask-kubernetes ~=0.11.0 ; extra == 'api'
 Requires-Dist: apscheduler <4,>=3.10.3 ; extra == 'api'
 Requires-Dist: objgraph ~=3.6 ; extra == 'api'
-Requires-Dist: igz-mgmt ~=0.1.0 ; extra == 'api'
+Requires-Dist: igz-mgmt ~=0.1.1 ; extra == 'api'
 Requires-Dist: humanfriendly ~=10.0 ; extra == 'api'
 Requires-Dist: fastapi ~=0.110.0 ; extra == 'api'
 Requires-Dist: sqlalchemy ~=1.4 ; extra == 'api'
 Requires-Dist: pymysql ~=1.0 ; extra == 'api'
 Requires-Dist: alembic ~=1.9 ; extra == 'api'
 Requires-Dist: timelength ~=1.1 ; extra == 'api'
 Provides-Extra: azure-blob-storage
@@ -112,14 +117,16 @@
 Requires-Dist: distributed ~=2023.9.0 ; extra == 'complete'
 Requires-Dist: gcsfs ==2023.9.2 ; extra == 'complete'
 Requires-Dist: google-cloud-bigquery[bqstorage,pandas] ==3.14.1 ; extra == 'complete'
 Requires-Dist: graphviz ~=0.20.0 ; extra == 'complete'
 Requires-Dist: kafka-python ~=2.0 ; extra == 'complete'
 Requires-Dist: mlflow ~=2.8 ; extra == 'complete'
 Requires-Dist: msrest ~=0.6.21 ; extra == 'complete'
+Requires-Dist: oss2 ==2.18.1 ; extra == 'complete'
+Requires-Dist: ossfs ==2023.12.0 ; extra == 'complete'
 Requires-Dist: plotly <5.12.0,~=5.4 ; extra == 'complete'
 Requires-Dist: pyopenssl >=23 ; extra == 'complete'
 Requires-Dist: redis ~=4.3 ; extra == 'complete'
 Requires-Dist: s3fs ==2023.9.2 ; extra == 'complete'
 Requires-Dist: sqlalchemy ~=1.4 ; extra == 'complete'
 Provides-Extra: complete-api
 Requires-Dist: adlfs ==2023.9.0 ; extra == 'complete-api'
@@ -136,19 +143,21 @@
 Requires-Dist: databricks-sdk ~=0.13.0 ; extra == 'complete-api'
 Requires-Dist: distributed ~=2023.9.0 ; extra == 'complete-api'
 Requires-Dist: fastapi ~=0.110.0 ; extra == 'complete-api'
 Requires-Dist: gcsfs ==2023.9.2 ; extra == 'complete-api'
 Requires-Dist: google-cloud-bigquery[bqstorage,pandas] ==3.14.1 ; extra == 'complete-api'
 Requires-Dist: graphviz ~=0.20.0 ; extra == 'complete-api'
 Requires-Dist: humanfriendly ~=10.0 ; extra == 'complete-api'
-Requires-Dist: igz-mgmt ~=0.1.0 ; extra == 'complete-api'
+Requires-Dist: igz-mgmt ~=0.1.1 ; extra == 'complete-api'
 Requires-Dist: kafka-python ~=2.0 ; extra == 'complete-api'
 Requires-Dist: mlflow ~=2.8 ; extra == 'complete-api'
 Requires-Dist: msrest ~=0.6.21 ; extra == 'complete-api'
 Requires-Dist: objgraph ~=3.6 ; extra == 'complete-api'
+Requires-Dist: oss2 ==2.18.1 ; extra == 'complete-api'
+Requires-Dist: ossfs ==2023.12.0 ; extra == 'complete-api'
 Requires-Dist: plotly <5.12.0,~=5.4 ; extra == 'complete-api'
 Requires-Dist: pymysql ~=1.0 ; extra == 'complete-api'
 Requires-Dist: pyopenssl >=23 ; extra == 'complete-api'
 Requires-Dist: redis ~=4.3 ; extra == 'complete-api'
 Requires-Dist: s3fs ==2023.9.2 ; extra == 'complete-api'
 Requires-Dist: sqlalchemy ~=1.4 ; extra == 'complete-api'
 Requires-Dist: timelength ~=1.1 ; extra == 'complete-api'
```

## Comparing `mlrun-1.7.0rc6.dist-info/RECORD` & `mlrun-1.7.0rc7.dist-info/RECORD`

 * *Files 10% similar despite different names*

```diff
@@ -1,37 +1,37 @@
 mlrun/__init__.py,sha256=o9dHUfVFADfsi6GnOPLr2OkfkHdPvOnA7rkoECen0-I,7248
 mlrun/__main__.py,sha256=vg-HMhJqQ3OYt31YmijjBh6-6AZQVe4FvDYn4MwEpYs,49229
-mlrun/config.py,sha256=DMwxalJOY6E5_JyygKq1LFKUN2vL_sop3gssHm4LWyg,62775
+mlrun/config.py,sha256=dfX2Q7IcmLct9BSkQM92jARN3gCMNph2qG4m3wxsJ5Q,63044
 mlrun/errors.py,sha256=HmOAdfpL0bCDisZMUoJPOumneq71ko49Ph-XBL-A4xA,7080
 mlrun/execution.py,sha256=meZ_qSdTmnpqW7DKv7LdBmuE1Ut34E1RbK2kO0MD_QM,40866
 mlrun/features.py,sha256=nPDvy8tJuxwbRr843oWcnLBrqMJDPUanzn2Sb3BBi6w,15569
 mlrun/k8s_utils.py,sha256=YyFZT2WNZrJkcZoqxrkduQgzQ1X-7195O0mmEqvaIug,7023
 mlrun/kfpops.py,sha256=nVQUjLVBhXqkL2OTWJUo4qFIfNVEXUKIXJmRpBW0MVU,30481
 mlrun/lists.py,sha256=ev-gLBPc_az03yQEHrKyDPq_Bjosa4D_XFiVbRIpmRY,8286
-mlrun/model.py,sha256=e9tJG8-wP3gPywDu7wJMNsusLTGpVA9WpBbILFwR5Ns,70583
+mlrun/model.py,sha256=BkPHhOQZJUQI4YB74FE8gEBOHwY1rpEhiEBcjzWIJtw,70641
 mlrun/render.py,sha256=aMH3U2z7ELpW8MwYEGOrqLdEUwMX29shqy6V6-KbgiM,13009
-mlrun/run.py,sha256=br2oHhmDvcMSwEEuEBWITTRqGXiFaaIEzNYG21RVhKc,42822
+mlrun/run.py,sha256=WHGTAzQf-HgKLULVYcYvxlOd9Ku-53pRVwvJ_d5JDuo,42879
 mlrun/secrets.py,sha256=Nl_7ZNSErd-AOH19vVx_PjrLg9bJM9L-BvEYoPolB1c,7776
 mlrun/api/schemas/__init__.py,sha256=LhfO3myrnLVxC0MYCAc1_LTuqhRlYV3H7BwJkjOu3dQ,14211
 mlrun/artifacts/__init__.py,sha256=LxEWcMYPawJYvNOl6H2_UvrxdLTNYfKeZcMEKFZnGgA,1187
 mlrun/artifacts/base.py,sha256=2UYjwp7o_Fxhr1sMYE5mSUpxGA8yt2ZU1_UicreL7hk,34978
 mlrun/artifacts/dataset.py,sha256=hKdKtyAJqPWUGs1yefOAxa10s_ar3o7MaO7oiiD_HqU,22360
 mlrun/artifacts/manager.py,sha256=p6CmIJH91vm9DsEZHgHxKYTHU2BvF9IwpLv85cqoHNs,14425
 mlrun/artifacts/model.py,sha256=DXT24CH1ZgQLz9HcWBfjRAEhCBfznoa7-pB52N9qMOI,25205
 mlrun/artifacts/plots.py,sha256=RPJxfzS_3dKAXiY2N1LchS7c9LsrJMg42OAVyDn0mK0,15860
 mlrun/common/__init__.py,sha256=xY3wHC4TEJgez7qtnn1pQvHosi8-5UJOCtyGBS7FcGE,571
-mlrun/common/constants.py,sha256=OwcN3HroG3l94Kx1B-247cp1UyqC0IVLc_TCFGWmrg4,745
+mlrun/common/constants.py,sha256=7SLxtvq1VGO9ed0xQ87jM09ScTKMuv_2qx_IBE6hybg,991
 mlrun/common/helpers.py,sha256=BAhyuUnZvD_BT43i0_1EszuSbKgZx7bFy2KRIWP0XeA,1087
 mlrun/common/secrets.py,sha256=vc8WV82EZsCB5ENjUkObFOzZP59aZ1w8F82PTnqwBnc,5181
-mlrun/common/types.py,sha256=V_jCEFCJZcycFVsPzEToCRQja5bqW0zRAAVaGN_QYxQ,790
+mlrun/common/types.py,sha256=nNqNqNpn-xl4xliy-ofBAWVX02q5NFh6wxmvOnD4wW8,949
 mlrun/common/db/__init__.py,sha256=xY3wHC4TEJgez7qtnn1pQvHosi8-5UJOCtyGBS7FcGE,571
 mlrun/common/db/sql_session.py,sha256=Znc8KE2oLy4lg3_vRki1sVlNx59TgDSOTCXfU561hBU,2659
 mlrun/common/model_monitoring/__init__.py,sha256=x0EMEvxVjHsm858J1t6IEA9dtKTdFpJ9sKhss10ld8A,721
 mlrun/common/model_monitoring/helpers.py,sha256=1CpxIDQPumFnpUB1eqcvCpLlyPFVeW2sL6prM-N5A1A,4405
-mlrun/common/schemas/__init__.py,sha256=PKOeaerKRHOIWCmaIhCYdlieOZhZDDf8cubNOWlJQaM,4935
+mlrun/common/schemas/__init__.py,sha256=8gTYVVxSI8-IvbHVf7LyI1SXrhgGufQtx-7k-UoxkcM,4984
 mlrun/common/schemas/api_gateway.py,sha256=lDXnA0mE9PCyeB0p7VSoj7TN0xSF-e6XUrTYJjLqbbQ,2344
 mlrun/common/schemas/artifact.py,sha256=d6srME_eWn2MpGuqvPQZtePRFkjDfNJgQ6JDd51qVrI,2796
 mlrun/common/schemas/auth.py,sha256=KOQfABIXTrcMh3Us5vlmnN4w3bJB7Rl3Xd5GTAFpr-g,5970
 mlrun/common/schemas/background_task.py,sha256=2qZxib2qrF_nPZj0ncitCG-2jxz2hg1qj0hFc8eswWQ,1707
 mlrun/common/schemas/client_spec.py,sha256=EFYUSstblo13-O0LTwJfnsYmxbGPAypY3idy8SHpq1c,2858
 mlrun/common/schemas/clusterization_spec.py,sha256=aeaFJZms7r7h2HDv6ML_GDAT6gboW-PxBbc3GKPalGk,888
 mlrun/common/schemas/common.py,sha256=00upzVLPN7O511Q87yt-fvRcDQFbXra4j0_lqMGg6rs,1557
@@ -44,58 +44,59 @@
 mlrun/common/schemas/http.py,sha256=1PtYFhF6sqLSBRcuPMtYcUGmroBhaleqLmYidSdL9LM,705
 mlrun/common/schemas/hub.py,sha256=HOlUwmrlhXaigJ8H8NgFykttoktTaedpIr-SYA2XcCM,4203
 mlrun/common/schemas/k8s.py,sha256=nmMnhgjVMLem5jyumoG2eQKioGK9eUVhQnOSb3hG7yw,1395
 mlrun/common/schemas/memory_reports.py,sha256=tpS3fpvxa6VcBpzCRzcZTt0fCF0h6ReUetYs7j6kdps,892
 mlrun/common/schemas/notification.py,sha256=Ge7eWNGf_XUFkjOnUkyUOubdEbmXh9z_OSGcSturt4w,1768
 mlrun/common/schemas/object.py,sha256=VleJSUmDJMl92knLgaDE8SWCi3ky0UaHcwcwOIapPQ8,1980
 mlrun/common/schemas/pipeline.py,sha256=GhrIsf5tRUQtQYboZ2feXdMjpFelVvduM-SIQoV5TZw,1177
-mlrun/common/schemas/project.py,sha256=OsWVDDShfgKnNMFXHep7EhbL75_hZmfwKbED10HCRZg,4277
+mlrun/common/schemas/project.py,sha256=TvzqyNtWtSdj373_Wm6gQTIZXMPmBgny0_Wco_wot4g,4340
 mlrun/common/schemas/regex.py,sha256=8_vbDeAE0SODJDj7yUFg1FbaB9CNydYQTJ29JxE74Kc,776
 mlrun/common/schemas/runs.py,sha256=H9QhaN83cFUN42eE9TLgi1gs6Xdq11oQSZ96ESM94mI,745
 mlrun/common/schemas/runtime_resource.py,sha256=2rSuYL-9JkESSomlnU91mYDbfV-IkqZeXx6OHuMmDxs,1554
 mlrun/common/schemas/schedule.py,sha256=e9nAeRkZkyk37Ws1cBNseHVKPOQqmWV16rt-zr_eAJU,4287
 mlrun/common/schemas/secret.py,sha256=51tCN1F8DFTq4y_XdHIMDy3I1TnMEBX8kO8BHKavYF4,1484
 mlrun/common/schemas/tag.py,sha256=OAn9Qt6z8ibqw8uU8WQSvuwY8irUv45Dhx2Ko5FzUss,884
 mlrun/common/schemas/workflow.py,sha256=eRoaOBFiWbvP0iwZ6Aof5JmheV81A0-0PGi8L4vuXmI,1823
-mlrun/common/schemas/model_monitoring/__init__.py,sha256=aBpxCS3CqAuhzSIdlqLEfRBneOW0FtID701C00J1L0Q,1415
-mlrun/common/schemas/model_monitoring/constants.py,sha256=qEZfe3DabmiDIoTDuYZiKEqXtaIjm19sN91ly0iK_KA,7822
+mlrun/common/schemas/model_monitoring/__init__.py,sha256=SH3RBljBadT43eEyWttG1-gJCsYMjbfGVno1jYy8UEU,1501
+mlrun/common/schemas/model_monitoring/constants.py,sha256=gJg4SI2R7lHNcKydC6qZua4ktE11X7dCBK3jZ45wJDA,8322
 mlrun/common/schemas/model_monitoring/grafana.py,sha256=aiNK8iL_fIzDVO_bj4fted9P6fAwaymcPC2OnRk36po,1431
 mlrun/common/schemas/model_monitoring/model_endpoints.py,sha256=ct8Jd-08KwrFw2uVjdwO_jmNrbhYmQvHBAPLO7AVpn4,12000
 mlrun/data_types/__init__.py,sha256=EkxfkFoHb91zz3Aymq-KZfCHlPMzEc3bBqgzPUwmHWY,1087
-mlrun/data_types/data_types.py,sha256=qgRIdlSl9X-rAnwOW-F0hwPbDKOZI05JlSzV1O8ReaU,4647
+mlrun/data_types/data_types.py,sha256=hWiL5TPOj9EK7_nd1yttLBUhXTmBYLDZzmG-hWzzhHE,4751
 mlrun/data_types/infer.py,sha256=z2EbSpR6xWEE5-HRUtDZkapHQld3xMbzXtTX83K-690,6134
 mlrun/data_types/spark.py,sha256=qKQ2TIAPQWDgmIOmpyV5_uuyUX3AnXWSq6GPpVjVIek,9457
 mlrun/data_types/to_pandas.py,sha256=_8_M9WclYNkPeHLo0eXhrnLE6SiLkvNTreeqfJ9G5yY,9945
 mlrun/datastore/__init__.py,sha256=bsRzu39UOocQAAl_nOKCbhxrZhWUEXrAc8WV3zs0VyI,4118
-mlrun/datastore/azure_blob.py,sha256=W8mR9t3WChITQHJ3oY3DEfFDKKx1wjFNMzB07wf8Il0,9168
-mlrun/datastore/base.py,sha256=XsjmFOeLzkTnokkoEJLYtWdcy1m9V7i1PuE8zHUj9X4,24175
-mlrun/datastore/datastore.py,sha256=yEdiPzMx69zTCMtY4fZ7aQafyAMHynQs2papTQ-Sc0E,9018
+mlrun/datastore/alibaba_oss.py,sha256=OfQ9AbsJNBFF9DFgUdq38TvKw6qwnHmEcnH-nze6ZZg,4827
+mlrun/datastore/azure_blob.py,sha256=NpkEoIie7mH171tOwlrwpEwzRYGoo9SF3FAAegEENhU,9019
+mlrun/datastore/base.py,sha256=QNiYoeyMRnZiyp7HRT68sfjWeSyu0zLLGfzTkTdkyl8,24421
+mlrun/datastore/datastore.py,sha256=GGo8XPnKVWWgY0b-18D93V1g8DJgeBNafa6knnHEabw,9111
 mlrun/datastore/datastore_profile.py,sha256=JSfZaxP1DZRnbRUTu00FEYp-C4bCKJziNgd5xRGrBaI,15985
 mlrun/datastore/dbfs_store.py,sha256=5IkxnFQXkW0fdx-ca5jjQnUdTsTfNdJzMvV31ZpDNrM,6634
 mlrun/datastore/filestore.py,sha256=nS3Ie6jG41NDiW_as9tF8Nu5maaSVEKYKUr1IQtPhuA,3767
-mlrun/datastore/google_cloud_storage.py,sha256=ri5bTqTNLij3ujlPoKlptDPi7oN6JgqIiVGWYoEmgsE,6112
+mlrun/datastore/google_cloud_storage.py,sha256=Du5qYYUCSkLt9acQDeQ-PgEjttsE7D2eAoLebO43kiw,6110
 mlrun/datastore/hdfs.py,sha256=jCuuPbnITezNYug9iYNLEJW87GGXSqW6H-UiqAynfdw,1674
 mlrun/datastore/helpers.py,sha256=-bKveE9rteLd0hJd6OSMuMbfz09W_OXyu1G5O2ihZjs,622
 mlrun/datastore/inmem.py,sha256=6PAltUk7uyYlDgnsaJPOkg_P98iku1ys2e2wpAmPRkc,2779
 mlrun/datastore/redis.py,sha256=yJ8xYHAR4DyYzsAMLQmsdzO-VVUTQABkIxcWhVHeUFI,5575
 mlrun/datastore/s3.py,sha256=EIPAXJGZ9kpQVbb_utFFZskDM21fAGz4m6QEAGecABU,8110
-mlrun/datastore/sources.py,sha256=1cQ697He_2avwLH6_6bMB2LBl1arBvSfdL-cYmH3UP8,40160
+mlrun/datastore/sources.py,sha256=3BgqVgJzdiK7OWbbSJiGBnIY1OnP4W9lLEdk--RGruQ,40125
 mlrun/datastore/spark_udf.py,sha256=NnnB3DZxZb-rqpRy7b-NC7QWXuuqFn3XkBDc86tU4mQ,1498
 mlrun/datastore/spark_utils.py,sha256=50rllp6xXpXY__1LbU7aTXUU5ca8dKAfoskPre3npZo,1611
 mlrun/datastore/store_resources.py,sha256=dfMdFy2urilECtlwLJr5CSG12MA645b-NPYDnbr5s1A,6839
 mlrun/datastore/targets.py,sha256=YjjvXnaEEj0ojxiOxoRSuIrbzAvuRSpFxX-9_zJFaZ0,70714
 mlrun/datastore/utils.py,sha256=YKK9q1C0LmveQFnbh1Dkb8LwA4WbOYFTsNxziC8d0E4,5227
 mlrun/datastore/v3io.py,sha256=oCAMpST6sKnjm5CaNsTrcwqk3bvUFzuKBvNFmUJpPfw,9252
 mlrun/datastore/wasbfs/__init__.py,sha256=s5Ul-0kAhYqFjKDR2X0O2vDGDbLQQduElb32Ev56Te4,1343
 mlrun/datastore/wasbfs/fs.py,sha256=MnSj7Q4OKA2L55ihCmUnj2t3GA3B77oLMdAw-yxvN9w,6151
 mlrun/db/__init__.py,sha256=WqJ4x8lqJ7ZoKbhEyFqkYADd9P6E3citckx9e9ZLcIU,1163
-mlrun/db/base.py,sha256=d6J2g2uFvJh8CcAYoFR4DxPvKsAjByKxLqGENWDoluc,18906
+mlrun/db/base.py,sha256=Qrh0RqYRvmE4ZfmMXCg2xyxFeBQfzpNib7sOWFCQ5uA,19171
 mlrun/db/factory.py,sha256=ibIrE5QkIIyzDU1FXKrfbc31cZiRLYKDZb8dqCpQwyU,2397
-mlrun/db/httpdb.py,sha256=JtVbbetPzhpZNYb5meXMevPIRGkGu2KBbb9QTADYvLs,158600
-mlrun/db/nopdb.py,sha256=FoEFMfnh1aSs-mcXlwA8GnnbQCIoTtFkflbFpUF5bMY,14814
+mlrun/db/httpdb.py,sha256=kR8sfnIv9W6S3FrFTPrTmNKIdIQh-Q7n3W6LmT8wxls,158765
+mlrun/db/nopdb.py,sha256=LM7rmx6TnSLFi6ASWs4XUsQhoAVRkIvKRPj85IztNOA,14882
 mlrun/feature_store/__init__.py,sha256=n1F5m1svFW2chbE2dJdWzZJJiYS4E-y8PQsG9Q-F0lU,1584
 mlrun/feature_store/api.py,sha256=bO5I_lkIPLv8j3AXYOAseSBI8RrsGwQ9m7isepuADkw,49480
 mlrun/feature_store/common.py,sha256=DKmoRk04NCS1gv7qZuEUa2-g8WsfR6IWjYctcrqKVlg,12853
 mlrun/feature_store/feature_set.py,sha256=iIEFt85Bpc4Q0jNqNXLptVZfULpFBHT5iLSzrZVYvbY,55295
 mlrun/feature_store/feature_vector.py,sha256=2sGbHAXdkm92-R29HXeFxwScvZM4M2gk-t9RteaHc4c,43560
 mlrun/feature_store/ingestion.py,sha256=GZkrke5_JJfA_PGOFc6ekbHKujHgMgqr6t4vop5n_bg,11210
 mlrun/feature_store/steps.py,sha256=bx9pjdiV2teE1wNrigriT2Xp4RQ_TwC46-yboLnpQw0,28882
@@ -193,40 +194,43 @@
 mlrun/frameworks/xgboost/utils.py,sha256=5zLzHoeI3n2FuA_rdGzi404QCTLfQx1TYEyUWhZogs8,1069
 mlrun/launcher/__init__.py,sha256=JL8qkT1lLr1YvW6iP0hmwDTaSR2RfrMDx0-1gWRhTOE,571
 mlrun/launcher/base.py,sha256=GHEZoxrgW1EIjYu9y6rGKLWwKBxEj6TqZd1ntSJ0CuY,16432
 mlrun/launcher/client.py,sha256=q3bmydSpO2x2Fbgy18W1uvaLbtxzJFlj1Uq6YNVndUU,6048
 mlrun/launcher/factory.py,sha256=RW7mfzEFi8fR0M-4W1JQg1iq3_muUU6OTqT_3l4Ubrk,2338
 mlrun/launcher/local.py,sha256=6E83lCJ8Ma4WPCQYzo3P6c4tvpIipJsokZ3zMrCORbk,10909
 mlrun/launcher/remote.py,sha256=2DGInyx0um5BRUEA5DYcnLXzVKTIv8JxeXogWdxl48o,7469
-mlrun/model_monitoring/__init__.py,sha256=XaYyvWsIXpjJQ2gCPj8tFvfSbRSEEqgDtNz4tCE5H4g,915
-mlrun/model_monitoring/api.py,sha256=urggp5P_lpfLO1RO4YVdT_jDhIMF8Xqr22H3OYhRZnw,36535
+mlrun/model_monitoring/__init__.py,sha256=fS93sGyotiurc2lf1x49JiM3MaN8zm4YxKYN42Ecc4U,859
+mlrun/model_monitoring/api.py,sha256=_prcm5Z3YhENwwFnfTNvWKkLn1eK51jiwyaz687n2z4,29276
 mlrun/model_monitoring/application.py,sha256=w87IuSgkIUXV5T6HpMiWWCsxFoikD6Mk8JpoyoefUCg,12504
-mlrun/model_monitoring/batch.py,sha256=nVEj-NtgqE4m9-LPMiWht-ZEbw4YY24jjaskuTcsPqs,38184
-mlrun/model_monitoring/controller.py,sha256=OUqrZkYuCP2_t5pSEZ4gOemejWbjnNLTcdMEAKTBths,27925
+mlrun/model_monitoring/controller.py,sha256=DtrEOHGOlBm2PYPESjo5ea4ubHgUD7eEy0A1YMQPGEY,27745
 mlrun/model_monitoring/controller_handler.py,sha256=J9Y9ppLsQaxyYRl21165Rr7QuI9EM-mk-5veAqs4Bi0,1336
 mlrun/model_monitoring/evidently_application.py,sha256=o9PsDsjyRfcbuC1X1gb2ww5nzWCsR_KheabtpxKZ5yY,4824
 mlrun/model_monitoring/features_drift_table.py,sha256=c6GpKtpOJbuT1u5uMWDL_S-6N4YPOmlktWMqPme3KFY,25308
-mlrun/model_monitoring/helpers.py,sha256=OsMBvRS_kSFe4cdarwVrrlwGeRDOesUm8zmasfRcfQg,9013
+mlrun/model_monitoring/helpers.py,sha256=wod0L2Q9GCah9x1TtbajjkuQvQ4XKX5qGxQeJDx70hc,8925
 mlrun/model_monitoring/model_endpoint.py,sha256=BBtxdY5ciormI_al4zshmIp0GN7hGhOCn-hLgpCXek0,3938
 mlrun/model_monitoring/prometheus.py,sha256=cUR4y73GutJB_pA_VCBDl9YtK4PcIJp2wj2rnLVmYi4,7578
-mlrun/model_monitoring/stream_processing.py,sha256=XKj9ToKj7VgF_Yxb6I27r1AoVU64EwflGC1966oIUaQ,48198
-mlrun/model_monitoring/tracking_policy.py,sha256=9P0oRjFMfoqKY7Zv2rv7abKgnKkiepFJfimWx-LOm0M,5283
-mlrun/model_monitoring/writer.py,sha256=IWPzPenoAkfIxlvn0IdcdB19Nxqmg4mjbo3-RnYWw9A,8669
+mlrun/model_monitoring/stream_processing.py,sha256=A2dKK2XJAkGnVWK6MawsSRN4nR_ZgFCKILyHgj8LJhw,49317
+mlrun/model_monitoring/tracking_policy.py,sha256=sQq956akAQpntkrJwIgFWcEq-JpyVcg0FxgNa4h3V70,5502
+mlrun/model_monitoring/writer.py,sha256=wXfGh9_b5huZF-rqOkAnPuxB62aABHHDB2ja9ncd4fk,7309
 mlrun/model_monitoring/applications/__init__.py,sha256=6CsTXAxeLbbf8yfCADTaxmiavqwrLEdYFJ-qc5kgDAY,569
 mlrun/model_monitoring/applications/histogram_data_drift.py,sha256=IG1qRXs316OdjcLLEHeKGH4t6WZabt8o92RLk-iB9e4,11647
+mlrun/model_monitoring/db/__init__.py,sha256=sXYc6CF2I_HMJyUoY_4VueQf3OL-vhEAuWHxQvuoGRs,662
+mlrun/model_monitoring/db/stores/__init__.py,sha256=G3g1ZclwVWfdtFsuTAW1O2A2ndR4ku9xU9TivnIb4yk,4305
+mlrun/model_monitoring/db/stores/base/__init__.py,sha256=JufJETW3BXzPhFwbRa8dMf7BFGGZKceIWIMgr5x9n9c,599
+mlrun/model_monitoring/db/stores/base/store.py,sha256=nOWEwL1zDxYQ09QBALXK57k9FNFIuYg9H0Z_ntW-Xs8,7073
+mlrun/model_monitoring/db/stores/sqldb/__init__.py,sha256=6CsTXAxeLbbf8yfCADTaxmiavqwrLEdYFJ-qc5kgDAY,569
+mlrun/model_monitoring/db/stores/sqldb/sql_store.py,sha256=tTZKprKc975t5KnuF8cTZ5oomxVN8pX8Nr1k27agf6g,27104
+mlrun/model_monitoring/db/stores/sqldb/models/__init__.py,sha256=359IyQfnBqe4MXrKe4wCPAM2-ntqjUYCx1n_djSdNYg,2196
+mlrun/model_monitoring/db/stores/sqldb/models/base.py,sha256=h40tZoHuf0Id7_9gD4D5rcHRT6u7GF74O5tbuNSl3lU,4413
+mlrun/model_monitoring/db/stores/sqldb/models/mysql.py,sha256=IQxnupQAVnAu_J2aENRyKuRJuOc5EcfVtWBRCEpOwzA,2022
+mlrun/model_monitoring/db/stores/sqldb/models/sqlite.py,sha256=S45CfdLSq_XJVKz3ZtdA8imsWWnuKdHb696HjDktLTU,994
+mlrun/model_monitoring/db/stores/v3io_kv/__init__.py,sha256=6CsTXAxeLbbf8yfCADTaxmiavqwrLEdYFJ-qc5kgDAY,569
+mlrun/model_monitoring/db/stores/v3io_kv/kv_store.py,sha256=4xsAUYJau97DoNHIrxpGJpec7r184GLGuOQhlz38UEE,27471
 mlrun/model_monitoring/metrics/__init__.py,sha256=6CsTXAxeLbbf8yfCADTaxmiavqwrLEdYFJ-qc5kgDAY,569
 mlrun/model_monitoring/metrics/histogram_distance.py,sha256=E9_WIl2vd6qNvoHVHoFcnuQk3ekbFWOdi8aU7sHrfk4,4724
-mlrun/model_monitoring/stores/__init__.py,sha256=adU_G07jkD3JUT8__d0jAxs9nNomL7igKmd6uVM9L50,4525
-mlrun/model_monitoring/stores/kv_model_endpoint_store.py,sha256=SVHoaG4cfwntPfQMj6ZEzL5lGDYG67orCIAIb5-G9SE,22222
-mlrun/model_monitoring/stores/model_endpoint_store.py,sha256=stinaLq9W1iq2UJiTbPnk28Mvaeail7gwcJYHbrVjfE,5590
-mlrun/model_monitoring/stores/sql_model_endpoint_store.py,sha256=S5SA2P2BfLeg5lXCrEnMutghFffdmE59SCnQUiEjP7w,16139
-mlrun/model_monitoring/stores/models/__init__.py,sha256=5Djb73mfM9PxWE5EFUzrpLVLkuGaA34APibi_l-lu8k,1111
-mlrun/model_monitoring/stores/models/base.py,sha256=yC2_u8wTNoP9JHHewYQgWgarP400OgzlqYWpS-N1V4s,2801
-mlrun/model_monitoring/stores/models/mysql.py,sha256=9UYG5FuoVJQoAXP_xrCnbwmTVAm8ba6Bu54R9yg5BJs,1131
-mlrun/model_monitoring/stores/models/sqlite.py,sha256=9c5Tw4YuuRiD4GBoQdWGPUzm_6rC-u6zCg962g99lO0,765
 mlrun/package/__init__.py,sha256=uWILzN42bcq5vFRk6ptxEmn1I5uBWAnhaJr7e4H834w,7082
 mlrun/package/context_handler.py,sha256=Z8v7cXAZXa5l3Tgg6IiEVm74Qbp5cOxx30jvkAY3dwo,14589
 mlrun/package/errors.py,sha256=LKF8SSaRIdbkB7JQz6b9U4mZV42Ebnf6ZHu4wKuWqK4,1204
 mlrun/package/packager.py,sha256=xE7U1njB2RXhmiA0kCSmA4i5j84Dd7Bt-H4Fk5OcVLk,15064
 mlrun/package/packagers_manager.py,sha256=POjI_dH6jji8qIg_0mWlPX-jNKzVTC0VXrXuxEn_CoM,37160
 mlrun/package/packagers/__init__.py,sha256=rpxpuATMoxCMgHDaVamm0uwocy71e0CSXm85Q5X9tkU,769
 mlrun/package/packagers/default_packager.py,sha256=QaZyxm03fRTJy5OGBeyVvSpEqnWj3-hSQVbsCjlTpLM,26625
@@ -241,68 +245,68 @@
 mlrun/package/utils/log_hint_utils.py,sha256=40X7oVzCiAIGsTTSON0iYNHj-_1Y4l4SDMThTA85If8,3696
 mlrun/package/utils/type_hint_utils.py,sha256=JYrek6vuN3z7e6MGUD3qBLDfQ03C4puZXNTpDSj-VrM,14695
 mlrun/platforms/__init__.py,sha256=ArWn_iZiEE6qz7hvY_1RqMkFnHGuKjP3k5xYKnfKA58,2352
 mlrun/platforms/iguazio.py,sha256=M89zXuCd1bbcIANSy4ec-9evXIs7nPRVo3D0YhKvEtE,19434
 mlrun/platforms/other.py,sha256=T1BibmEBNggM62YJ6oejRmcVv_1besfH5DDHhCaDkRg,11828
 mlrun/projects/__init__.py,sha256=Lv5rfxyXJrw6WGOWJKhBz66M6t3_zsNMCfUD6waPwx4,1153
 mlrun/projects/operations.py,sha256=SiDHd7cqh9u23AVpETbkJE6WmOnB434zBrwM-StZLQY,18538
-mlrun/projects/pipelines.py,sha256=SMXBmIeuopwPpU0o2VFvaPXgbmaj-2WfCJryN6mZvZY,40124
-mlrun/projects/project.py,sha256=S8nL7it4E92OUWGE6PSjoQQsGNV22Q5bnRsaI2LEL2E,165058
+mlrun/projects/pipelines.py,sha256=icejHghKd5ofmitEZW0hGLiXa69So4-HywseDORTrDs,40567
+mlrun/projects/project.py,sha256=qaHuNVEgWgZCyzc_rE_fTr_aFRWIzEGFHn-tlDMRZLk,165818
 mlrun/runtimes/__init__.py,sha256=tTDfia4cr0gUy2rEtLTj4Nz6M_JJd6utzkFi-ogDvXg,8289
-mlrun/runtimes/base.py,sha256=pXZAuE5kzOwdSBUjscdXzgfjdfzW4PxLq9d3Mf0IQbI,36572
+mlrun/runtimes/base.py,sha256=prqlbGq5fbgQ8atBMjsXhdRY5UqS1egpHtOPaAjhVyI,36683
 mlrun/runtimes/constants.py,sha256=oP3OxdYCpbvadJ3zP1JGkqGBKaBheNkCnJISWha9x58,9513
 mlrun/runtimes/daskjob.py,sha256=xvN8ajs3-_voqxrfz6b3rh_idNw4ypRAkPRWGOnDMGA,19149
 mlrun/runtimes/funcdoc.py,sha256=FHwnLfFzoD6yGlsAJXAl_3VTtudgg4fTrsw_XqLOkC0,10508
 mlrun/runtimes/function_reference.py,sha256=iWKRe4r2GTc5S8FOIASYUNLwwne8NqIui51PFr8Q4mg,4918
 mlrun/runtimes/generators.py,sha256=v28HdNgxdHvj888G1dTnUeQZz-D9iTO0hoGeZbCdiuQ,7241
 mlrun/runtimes/kubejob.py,sha256=UfSm7hiPLAtM0TfIE5nbBdSvrbsKWCZfvKP-SZhGyAk,12500
 mlrun/runtimes/local.py,sha256=u9MhASzF7VRt_yT6_mZPze_hDvAaBxonPk_KafRG3Gg,21783
-mlrun/runtimes/pod.py,sha256=id1mxg6lCIWQA55x0Yk3-fLwtnR9MisRkwRoIW0rWCE,58664
+mlrun/runtimes/pod.py,sha256=tLnsGln3bmPAK-Mmr4fXfZ4P7IJ9R30Z-zaNhxSk-oE,59908
 mlrun/runtimes/remotesparkjob.py,sha256=ORkKmZRz_V3YiNE1NF7JIa_hI_LWbKEyI15Qb6R6g5I,7326
 mlrun/runtimes/utils.py,sha256=G4t29elE2PBT7WQZmrEOTIFAJUmeu6zXGEWwgz533vg,16004
 mlrun/runtimes/databricks_job/__init__.py,sha256=kXGBqhLN0rlAx0kTXhozGzFsIdSqW0uTSKMmsLgq_is,569
 mlrun/runtimes/databricks_job/databricks_cancel_task.py,sha256=sIqIg5DQAf4j0wCPA-G0GoxY6vacRddxCy5KDUZszek,2245
 mlrun/runtimes/databricks_job/databricks_runtime.py,sha256=a9W7A8sboteQov0Z9uVcthEU3FGYFf2cdAsi-vdjH1w,12749
 mlrun/runtimes/databricks_job/databricks_wrapper.py,sha256=-kzz5b3YBit6sGWojjREW_aHHRTx72zzTbxWGxvUplE,8679
 mlrun/runtimes/mpijob/__init__.py,sha256=jZf2uPBv6IB18Jj-dGSQ9NU5_xxni7XS4dnDZGwESFE,1583
 mlrun/runtimes/mpijob/abstract.py,sha256=AqIb-nEKZaRO7x1GxJea6cXg_Tn3Dr4WiWZUz3ywCjU,9161
 mlrun/runtimes/mpijob/v1.py,sha256=_RUlFo_3NcFf7x-QpUNVm8f7qNbRDIdUmPf_ijrv54U,3206
 mlrun/runtimes/mpijob/v1alpha1.py,sha256=w_971wwL03hW_ksgHJXdjTdjhxCs9KJ0zNqHSQ9whIM,1034
 mlrun/runtimes/nuclio/__init__.py,sha256=gx1kizzKv8pGT5TNloN1js1hdbxqDw3rM90sLVYVffY,794
-mlrun/runtimes/nuclio/api_gateway.py,sha256=t4im6F8f-zPYYXrHXCFr46Rw6sGgvydIpxpgxncTUMQ,10277
-mlrun/runtimes/nuclio/function.py,sha256=bCK_EVrLe2NfAelVpKtQrOYVnsPMiT91sB2_aJzLP_o,48990
+mlrun/runtimes/nuclio/api_gateway.py,sha256=5wJaST489LWAr8py_TiMRKnKtybvM3UvxxpmIojfE2A,14855
+mlrun/runtimes/nuclio/function.py,sha256=7Ax0u760z-ex0yRlztJRrUZcKGXeJNvsXcUAJqjc26w,49044
 mlrun/runtimes/nuclio/nuclio.py,sha256=sLK8KdGO1LbftlL3HqPZlFOFTAAuxJACZCVl1c0Ha6E,2942
-mlrun/runtimes/nuclio/serving.py,sha256=hzkXKCVgU6uXLYfO3H15ZWJIQiSbcKY2M_WLybHW1hM,30363
+mlrun/runtimes/nuclio/serving.py,sha256=e0VdJ6zbkurEl9ZlYqGzUaWRUM_US2bE7fpV6RZ83as,29745
 mlrun/runtimes/nuclio/application/__init__.py,sha256=rRs5vasy_G9IyoTpYIjYDafGoL6ifFBKgBtsXn31Atw,614
 mlrun/runtimes/nuclio/application/application.py,sha256=IxBvE7XcQKgtPWJqib32v6ANigxbK0-yfKC3vq0mjG4,9678
 mlrun/runtimes/nuclio/application/reverse_proxy.go,sha256=RDR2BuO7E87Ek9DYjvEaF5manuxcuVaVY7eZX986GFI,2920
 mlrun/runtimes/sparkjob/__init__.py,sha256=_KPvk0qefeLtHO6lxQE_AMOGiMTG_OT48eRCE4Z2ldw,709
 mlrun/runtimes/sparkjob/spark3job.py,sha256=yU-PxEI2pDJK5LHXTTcmrdjmO1Jwrj5Zyf8NwPDnZyA,41189
 mlrun/serving/__init__.py,sha256=_6HRAOuS2Ehjo3vwx5h1aI_-JppxEAsl4VfEERAbGFE,1078
 mlrun/serving/merger.py,sha256=PXLn3A21FiLteJHaDSLm5xKNT-80eTTjfHUJnBX1gKY,6116
 mlrun/serving/remote.py,sha256=jLFjMfgPx_PwJkpRHYbKrB9EQZcD4gZ-iczzHl1o0zs,18010
 mlrun/serving/routers.py,sha256=YN8k6eWWraqWOU3SqYFda7ky-oV_O0--zAuPEGwKdPI,54976
-mlrun/serving/server.py,sha256=42wWLtMb1AWeXtSXzSv0bKfQkxAQreqxs40Q0C_Bc-c,21161
+mlrun/serving/server.py,sha256=gs3FATCkCv6Ngke70vNaCWGhONH6IMI4eiuvRwLLMdY,21055
 mlrun/serving/serving_wrapper.py,sha256=R670-S6PX_d5ER6jiHtRvacuPyFzQH0mEf2K0sBIIOM,836
-mlrun/serving/states.py,sha256=EUkltwQlNNU6mjsUc8f3Rq65SGiAICkCAxbHw2jUqBk,55773
+mlrun/serving/states.py,sha256=7_nvFobvT-PIJoegkfXYrMlDD0CC4T66y8TvUytkEGo,56265
 mlrun/serving/utils.py,sha256=WO0n_YTO0YVPTjp_90zxRl4vey4flDgw5vaOHK5p_qY,3871
 mlrun/serving/v1_serving.py,sha256=by4myxlnwyZ0ijQ5fURilGCK1sUpdQL2Il1VR3Xqpxg,11805
 mlrun/serving/v2_serving.py,sha256=z1jTy0ObRFpV5nxMk-FGL2PoTQf-L01sYjfdA6_NqJc,23559
 mlrun/track/__init__.py,sha256=LWRUHJt8JyFW17FyNPOVyWd-NXTf1iptzsK9KFj5fuY,765
 mlrun/track/tracker.py,sha256=y-UdhC2nzM6r-yHCwvrfiHRr93xsr4JRsZTxDrTTRJo,3541
 mlrun/track/tracker_manager.py,sha256=IYBl99I62IC6VCCmG1yt6JoHNOQXa53C4DURJ2sWgio,5726
 mlrun/track/trackers/__init__.py,sha256=9xft8YjJnblwqt8f05htmOt_eDzVBVQN07RfY_SYLCs,569
 mlrun/track/trackers/mlflow_tracker.py,sha256=HkNO9fENOCl1DgAU72FclowVnFfmyQlZeWlj4GklvMI,23258
 mlrun/utils/__init__.py,sha256=g2pbT3loDw0GWELOC_rBq1NojSMCFnWrD-TYcDgAZiI,826
 mlrun/utils/async_http.py,sha256=EeTPE_iCGIAHWna-ISzxrG76WnRpvjLew2N2gDw7sk8,11092
 mlrun/utils/azure_vault.py,sha256=IEFizrDGDbAaoWwDr1WoA88S_EZ0T--vjYtY-i0cvYQ,3450
 mlrun/utils/clones.py,sha256=mJpx4nyFiY6jlBCvFABsNuyi_mr1mvfPWn81vlafpOU,7361
 mlrun/utils/condition_evaluator.py,sha256=-nGfRmZzivn01rHTroiGY4rqEv8T1irMyhzxEei-sKc,1897
 mlrun/utils/db.py,sha256=KEa-vzicUhzIwo1wBXax2ZuXtYgf5to7wnsY3CYCiOQ,1713
-mlrun/utils/helpers.py,sha256=guQSdMvQT8KdS2_LHXe0C9pTEC56XtsWNMliSI0i5CQ,51162
+mlrun/utils/helpers.py,sha256=k69jVSFghCWS_UyScr76reHl5AxNq1TKBOK7dfnYY7Q,52095
 mlrun/utils/http.py,sha256=mQqnCsdsg9_q2WIbgoEKGQpMesslb0ErvbwYV-htarw,8700
 mlrun/utils/logger.py,sha256=6-XMv1ucg9NqTstLpiji9qb06XHpx2LvNA8JxU1J5Tk,8133
 mlrun/utils/regex.py,sha256=Nd7xnDHU9PEOsse6rFwLNVgU4AaYCyuwMmQ9qgx2-Vw,4581
 mlrun/utils/retryer.py,sha256=BsST2dbGCHcY46wyGG3zWel_O9YquO0c57P3rcBxXU0,7522
 mlrun/utils/singleton.py,sha256=p1Y-X0mPSs_At092GS-pZCA8CTR62HOqPU07_ZH6-To,869
 mlrun/utils/v3io_clients.py,sha256=7eReciHBPLuLW6b5DIc8emnmrjh4D8hXPuqZDooR6HQ,1284
 mlrun/utils/vault.py,sha256=xUiKL17dCXjwQJ33YRzQj0oadUXATlFWPzKKYAESoQk,10447
@@ -312,15 +316,15 @@
 mlrun/utils/notifications/notification/base.py,sha256=gnmhNl59K9h4BGVAk77gVHWw-3kphchRL3Cwm-R0Cp4,2279
 mlrun/utils/notifications/notification/console.py,sha256=leZrjwu3fFA1sCYsTxDXEGZ02SWTUk4GNzp7tT2uaCc,2532
 mlrun/utils/notifications/notification/git.py,sha256=5pJs3LFzuz2h3JO9vAGo3BL00-WZFdUcCaO2XaZh-1I,5221
 mlrun/utils/notifications/notification/ipython.py,sha256=d47s-fW4TgqOJZOSdmzBQvdh2oDHoFw-ENLgNcAQSWU,1955
 mlrun/utils/notifications/notification/slack.py,sha256=5JysqIpUYUZKXPSeeZtbl7qb2L9dj7p2NvnEBcEsZkA,3898
 mlrun/utils/notifications/notification/webhook.py,sha256=QHezCuN5uXkLcroAGxGrhGHaxAdUvkDLIsp27_Yrfd4,2390
 mlrun/utils/version/__init__.py,sha256=7kkrB7hEZ3cLXoWj1kPoDwo4MaswsI2JVOBpbKgPAgc,614
-mlrun/utils/version/version.json,sha256=ILF1rc0HYdLIjaV0EoivXDa8o11QVEm_vR_0HbZkVBA,88
+mlrun/utils/version/version.json,sha256=TnN6nW9a4k4AQnZGiQygqhQeWdt1ELZw03VIFsr4QUk,88
 mlrun/utils/version/version.py,sha256=eEW0tqIAkU9Xifxv8Z9_qsYnNhn3YH7NRAfM-pPLt1g,1878
-mlrun-1.7.0rc6.dist-info/LICENSE,sha256=xx0jnfkXJvxRnG63LTGOxlggYnIysveWIZ6H3PNdCrQ,11357
-mlrun-1.7.0rc6.dist-info/METADATA,sha256=aTGZl-fqFbpXsw_iPz64qD7nl2dBrtDqZuuxItHHQ3Q,18263
-mlrun-1.7.0rc6.dist-info/WHEEL,sha256=GJ7t_kWBFywbagK5eo9IoUwLW6oyOeTKmQ-9iHFVNxQ,92
-mlrun-1.7.0rc6.dist-info/entry_points.txt,sha256=1Owd16eAclD5pfRCoJpYC2ZJSyGNTtUr0nCELMioMmU,46
-mlrun-1.7.0rc6.dist-info/top_level.txt,sha256=NObLzw3maSF9wVrgSeYBv-fgnHkAJ1kEkh12DLdd5KM,6
-mlrun-1.7.0rc6.dist-info/RECORD,,
+mlrun-1.7.0rc7.dist-info/LICENSE,sha256=xx0jnfkXJvxRnG63LTGOxlggYnIysveWIZ6H3PNdCrQ,11357
+mlrun-1.7.0rc7.dist-info/METADATA,sha256=eu82u1btwz6Wl2LRO_7J6tv-8Cl8d6DjbH4uFBJsylg,18719
+mlrun-1.7.0rc7.dist-info/WHEEL,sha256=GJ7t_kWBFywbagK5eo9IoUwLW6oyOeTKmQ-9iHFVNxQ,92
+mlrun-1.7.0rc7.dist-info/entry_points.txt,sha256=1Owd16eAclD5pfRCoJpYC2ZJSyGNTtUr0nCELMioMmU,46
+mlrun-1.7.0rc7.dist-info/top_level.txt,sha256=NObLzw3maSF9wVrgSeYBv-fgnHkAJ1kEkh12DLdd5KM,6
+mlrun-1.7.0rc7.dist-info/RECORD,,
```

